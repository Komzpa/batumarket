<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: callgraph Pages: 1 -->
<svg width="4257pt" height="4024pt"
 viewBox="0.00 0.00 4256.66 4024.40" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 4020.4)">
<title>callgraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-4020.4 4252.66,-4020.4 4252.66,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_cli</title>
<polygon fill="none" stroke="black" points="501,-8 501,-137 1505.85,-137 1505.85,-8 501,-8"/>
<text text-anchor="middle" x="1003.43" y="-121.8" font-family="Times,serif" font-size="14.00">CLI entrypoints</text>
</g>
<!-- telegram_bot:cli -->
<g id="node1" class="node">
<title>telegram_bot:cli</title>
<g id="a_node1"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="594.79" cy="-88" rx="85.59" ry="18"/>
<text text-anchor="middle" x="594.79" y="-84.3" font-family="Times,serif" font-size="14.00">telegram_bot:cli</text>
</a>
</g>
</g>
<!-- tg_client:cli -->
<g id="node2" class="node">
<title>tg_client:cli</title>
<g id="a_node2"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="793.93" cy="-88" rx="64.19" ry="18"/>
<text text-anchor="middle" x="793.93" y="-84.3" font-family="Times,serif" font-size="14.00">tg_client:cli</text>
</a>
</g>
</g>
<!-- telegram_bot:cli&#45;&gt;tg_client:cli -->
<!-- build_site:cli -->
<g id="node3" class="node">
<title>build_site:cli</title>
<g id="a_node3"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="977.46" cy="-88" rx="69.59" ry="18"/>
<text text-anchor="middle" x="977.46" y="-84.3" font-family="Times,serif" font-size="14.00">build_site:cli</text>
</a>
</g>
</g>
<!-- tg_client:cli&#45;&gt;build_site:cli -->
<!-- clean_data:cli -->
<g id="node4" class="node">
<title>clean_data:cli</title>
<g id="a_node4"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="1174.16" cy="-88" rx="73.39" ry="18"/>
<text text-anchor="middle" x="1174.16" y="-84.3" font-family="Times,serif" font-size="14.00">clean_data:cli</text>
</a>
</g>
</g>
<!-- build_site:cli&#45;&gt;clean_data:cli -->
<!-- scan_ontology:cli -->
<g id="node5" class="node">
<title>scan_ontology:cli</title>
<g id="a_node5"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="1408.16" cy="-88" rx="89.88" ry="18"/>
<text text-anchor="middle" x="1408.16" y="-84.3" font-family="Times,serif" font-size="14.00">scan_ontology:cli</text>
</a>
</g>
</g>
<!-- clean_data:cli&#45;&gt;scan_ontology:cli -->
<!-- debug_dump:cli -->
<g id="node6" class="node">
<title>debug_dump:cli</title>
<g id="a_node6"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="594.79" cy="-34" rx="83.69" ry="18"/>
<text text-anchor="middle" x="594.79" y="-30.3" font-family="Times,serif" font-size="14.00">debug_dump:cli</text>
</a>
</g>
</g>
<!-- moderation:cli -->
<g id="node7" class="node">
<title>moderation:cli</title>
<g id="a_node7"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="793.93" cy="-34" rx="77.19" ry="18"/>
<text text-anchor="middle" x="793.93" y="-30.3" font-family="Times,serif" font-size="14.00">moderation:cli</text>
</a>
</g>
</g>
<!-- debug_dump:cli&#45;&gt;moderation:cli -->
<!-- chop:cli -->
<g id="node8" class="node">
<title>chop:cli</title>
<g id="a_node8"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="977.46" cy="-34" rx="46.29" ry="18"/>
<text text-anchor="middle" x="977.46" y="-30.3" font-family="Times,serif" font-size="14.00">chop:cli</text>
</a>
</g>
</g>
<!-- moderation:cli&#45;&gt;chop:cli -->
<!-- embed:cli -->
<g id="node9" class="node">
<title>embed:cli</title>
<g id="a_node9"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="1174.16" cy="-34" rx="55.79" ry="18"/>
<text text-anchor="middle" x="1174.16" y="-30.3" font-family="Times,serif" font-size="14.00">embed:cli</text>
</a>
</g>
</g>
<!-- chop:cli&#45;&gt;embed:cli -->
<!-- caption:cli -->
<g id="node10" class="node">
<title>caption:cli</title>
<g id="a_node10"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="1408.16" cy="-34" rx="58.49" ry="18"/>
<text text-anchor="middle" x="1408.16" y="-30.3" font-family="Times,serif" font-size="14.00">caption:cli</text>
</a>
</g>
</g>
<!-- embed:cli&#45;&gt;caption:cli -->
<!-- post_io._parse_block -->
<g id="node11" class="node">
<title>post_io._parse_block</title>
<g id="a_node11"><a xlink:title="Return metadata dict and remaining body from ``text``.">
<polygon fill="none" stroke="black" points="3941.66,-1260 3779.66,-1260 3779.66,-1224 3941.66,-1224 3941.66,-1260"/>
<text text-anchor="middle" x="3860.66" y="-1238.3" font-family="Times,serif" font-size="14.00">post_io._parse_block</text>
</a>
</g>
</g>
<!-- post_io.get_contact -->
<g id="node12" class="node">
<title>post_io.get_contact</title>
<g id="a_node12"><a xlink:title="Return a contact identifier from ``meta`` or ``None`` when missing.">
<polygon fill="none" stroke="black" points="3329.66,-471 3175.66,-471 3175.66,-435 3329.66,-435 3329.66,-471"/>
<text text-anchor="middle" x="3252.66" y="-449.3" font-family="Times,serif" font-size="14.00">post_io.get_contact</text>
</a>
</g>
</g>
<!-- post_io.get_timestamp -->
<g id="node13" class="node">
<title>post_io.get_timestamp</title>
<g id="a_node13"><a xlink:title="Return ``meta[&#39;date&#39;]`` as a timezone&#45;aware ``datetime``.">
<polygon fill="none" stroke="black" points="3341.66,-525 3163.66,-525 3163.66,-489 3341.66,-489 3341.66,-525"/>
<text text-anchor="middle" x="3252.66" y="-503.3" font-family="Times,serif" font-size="14.00">post_io.get_timestamp</text>
</a>
</g>
</g>
<!-- post_io.read_post -->
<g id="node14" class="node">
<title>post_io.read_post</title>
<g id="a_node14"><a xlink:title="Return metadata dictionary and body text for ``path``.">
<polygon fill="none" stroke="black" points="3630.16,-1260 3489.16,-1260 3489.16,-1224 3630.16,-1224 3630.16,-1260"/>
<text text-anchor="middle" x="3559.66" y="-1238.3" font-family="Times,serif" font-size="14.00">post_io.read_post</text>
</a>
</g>
</g>
<!-- post_io.read_post&#45;&gt;post_io._parse_block -->
<g id="edge1" class="edge">
<title>post_io.read_post&#45;&gt;post_io._parse_block</title>
<path fill="none" stroke="black" d="M3630.38,-1242C3671.77,-1242 3724.69,-1242 3769.25,-1242"/>
<polygon fill="black" stroke="black" points="3769.51,-1245.5 3779.51,-1242 3769.51,-1238.5 3769.51,-1245.5"/>
</g>
<!-- serde_utils.read_md -->
<g id="node15" class="node">
<title>serde_utils.read_md</title>
<g id="a_node15"><a xlink:title="Alias for :func:`read_text` used for Markdown files.">
<polygon fill="none" stroke="black" points="3941.16,-1422 3780.16,-1422 3780.16,-1386 3941.16,-1386 3941.16,-1422"/>
<text text-anchor="middle" x="3860.66" y="-1400.3" font-family="Times,serif" font-size="14.00">serde_utils.read_md</text>
</a>
</g>
</g>
<!-- post_io.read_post&#45;&gt;serde_utils.read_md -->
<g id="edge2" class="edge">
<title>post_io.read_post&#45;&gt;serde_utils.read_md</title>
<path fill="none" stroke="black" d="M3630.22,-1249.02C3652.21,-1253 3676.11,-1259.23 3696.66,-1269 3753.56,-1296.06 3807.36,-1347.43 3836.69,-1378.41"/>
<polygon fill="black" stroke="black" points="3834.22,-1380.9 3843.61,-1385.82 3839.34,-1376.12 3834.22,-1380.9"/>
</g>
<!-- serde_utils.read_text -->
<g id="node24" class="node">
<title>serde_utils.read_text</title>
<g id="a_node24"><a xlink:title="Return file contents as UTF&#45;8 or empty string when missing.">
<polygon fill="none" stroke="black" points="4220.16,-1476 4053.16,-1476 4053.16,-1440 4220.16,-1440 4220.16,-1476"/>
<text text-anchor="middle" x="4136.66" y="-1454.3" font-family="Times,serif" font-size="14.00">serde_utils.read_text</text>
</a>
</g>
</g>
<!-- serde_utils.read_md&#45;&gt;serde_utils.read_text -->
<g id="edge211" class="edge">
<title>serde_utils.read_md&#45;&gt;serde_utils.read_text</title>
<path fill="none" stroke="black" d="M3941.28,-1419.69C3973.07,-1425.96 4009.89,-1433.21 4042.88,-1439.71"/>
<polygon fill="black" stroke="black" points="4042.49,-1443.21 4052.98,-1441.71 4043.85,-1436.34 4042.49,-1443.21"/>
</g>
<!-- post_io.write_post -->
<g id="node16" class="node">
<title>post_io.write_post</title>
<g id="a_node16"><a xlink:title="Write metadata and body as a Markdown post.">
<polygon fill="none" stroke="black" points="3028.16,-563 2882.16,-563 2882.16,-527 3028.16,-527 3028.16,-563"/>
<text text-anchor="middle" x="2955.16" y="-541.3" font-family="Times,serif" font-size="14.00">post_io.write_post</text>
</a>
</g>
</g>
<!-- post_io.write_post&#45;&gt;post_io.get_contact -->
<g id="edge3" class="edge">
<title>post_io.write_post&#45;&gt;post_io.get_contact</title>
<path fill="none" stroke="black" d="M3026.23,-526.96C3045,-521.03 3064.98,-513.68 3082.66,-505 3100.14,-496.41 3100.74,-487.65 3118.66,-480 3133.37,-473.72 3149.64,-468.87 3165.6,-465.13"/>
<polygon fill="black" stroke="black" points="3166.47,-468.52 3175.48,-462.95 3164.96,-461.69 3166.47,-468.52"/>
</g>
<!-- post_io.write_post&#45;&gt;post_io.get_timestamp -->
<g id="edge4" class="edge">
<title>post_io.write_post&#45;&gt;post_io.get_timestamp</title>
<path fill="none" stroke="black" d="M3028.45,-535.7C3066.09,-530.86 3112.68,-524.87 3153.53,-519.62"/>
<polygon fill="black" stroke="black" points="3154.04,-523.08 3163.51,-518.34 3153.15,-516.14 3154.04,-523.08"/>
</g>
<!-- serde_utils.write_md -->
<g id="node17" class="node">
<title>serde_utils.write_md</title>
<g id="a_node17"><a xlink:title="Write ``text`` to ``path`` ensuring a trailing newline.">
<polygon fill="none" stroke="black" points="3335.66,-579 3169.66,-579 3169.66,-543 3335.66,-543 3335.66,-579"/>
<text text-anchor="middle" x="3252.66" y="-557.3" font-family="Times,serif" font-size="14.00">serde_utils.write_md</text>
</a>
</g>
</g>
<!-- post_io.write_post&#45;&gt;serde_utils.write_md -->
<g id="edge5" class="edge">
<title>post_io.write_post&#45;&gt;serde_utils.write_md</title>
<path fill="none" stroke="black" d="M3028.45,-548.91C3067.91,-551.05 3117.2,-553.72 3159.41,-556.01"/>
<polygon fill="black" stroke="black" points="3159.25,-559.5 3169.42,-556.55 3159.62,-552.51 3159.25,-559.5"/>
</g>
<!-- post_io.raw_post_path -->
<g id="node18" class="node">
<title>post_io.raw_post_path</title>
<g id="a_node18"><a xlink:title="Return absolute message path for ``rel`` under ``root``.">
<polygon fill="none" stroke="black" points="3647.16,-1145 3472.16,-1145 3472.16,-1109 3647.16,-1109 3647.16,-1145"/>
<text text-anchor="middle" x="3559.66" y="-1123.3" font-family="Times,serif" font-size="14.00">post_io.raw_post_path</text>
</a>
</g>
</g>
<!-- post_io.raw_post_path_from_lot -->
<g id="node19" class="node">
<title>post_io.raw_post_path_from_lot</title>
<g id="a_node19"><a xlink:title="Return raw post path referenced by ``lot`` or ``None``.">
<polygon fill="none" stroke="black" points="3373.16,-817 3132.16,-817 3132.16,-781 3373.16,-781 3373.16,-817"/>
<text text-anchor="middle" x="3252.66" y="-795.3" font-family="Times,serif" font-size="14.00">post_io.raw_post_path_from_lot</text>
</a>
</g>
</g>
<!-- post_io.raw_post_path_from_lot&#45;&gt;post_io.raw_post_path -->
<g id="edge6" class="edge">
<title>post_io.raw_post_path_from_lot&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M3365.43,-817.13C3373.06,-820.95 3380.25,-825.52 3386.66,-831 3418.47,-858.19 3403.16,-880.97 3422.66,-918 3458.94,-986.91 3511.39,-1062.18 3539.37,-1100.84"/>
<polygon fill="black" stroke="black" points="3536.56,-1102.94 3545.28,-1108.96 3542.22,-1098.82 3536.56,-1102.94"/>
</g>
<!-- telegram_bot._t -->
<g id="node20" class="node">
<title>telegram_bot._t</title>
<g id="a_node20"><a xlink:title="Return ``text`` translated to ``lang`` using gettext files.">
<polygon fill="none" stroke="black" points="3019.16,-81 2891.16,-81 2891.16,-45 3019.16,-45 3019.16,-81"/>
<text text-anchor="middle" x="2955.16" y="-59.3" font-family="Times,serif" font-size="14.00">telegram_bot._t</text>
</a>
</g>
</g>
<!-- telegram_bot.ensure_profile -->
<g id="node21" class="node">
<title>telegram_bot.ensure_profile</title>
<g id="a_node21"><a xlink:title="Return profile for ``uid`` creating one if needed.">
<polygon fill="none" stroke="black" points="3063.66,-135 2846.66,-135 2846.66,-99 3063.66,-99 3063.66,-135"/>
<text text-anchor="middle" x="2955.16" y="-113.3" font-family="Times,serif" font-size="14.00">telegram_bot.ensure_profile</text>
</a>
</g>
</g>
<!-- telegram_bot.save_profiles -->
<g id="node22" class="node">
<title>telegram_bot.save_profiles</title>
<g id="a_node22"><a xlink:title="Write ``profiles`` to disk.">
<polygon fill="none" stroke="black" points="3356.66,-173 3148.66,-173 3148.66,-137 3356.66,-137 3356.66,-173"/>
<text text-anchor="middle" x="3252.66" y="-151.3" font-family="Times,serif" font-size="14.00">telegram_bot.save_profiles</text>
</a>
</g>
</g>
<!-- telegram_bot.ensure_profile&#45;&gt;telegram_bot.save_profiles -->
<g id="edge7" class="edge">
<title>telegram_bot.ensure_profile&#45;&gt;telegram_bot.save_profiles</title>
<path fill="none" stroke="black" d="M3063.68,-130.83C3088.04,-133.96 3113.99,-137.3 3138.58,-140.46"/>
<polygon fill="black" stroke="black" points="3138.29,-143.95 3148.66,-141.75 3139.19,-137.01 3138.29,-143.95"/>
</g>
<!-- telegram_bot.load_profiles -->
<g id="node23" class="node">
<title>telegram_bot.load_profiles</title>
<g id="a_node23"><a xlink:title="Populate the global ``profiles`` mapping.">
<polygon fill="none" stroke="black" points="2781.16,-1549 2575.16,-1549 2575.16,-1513 2781.16,-1513 2781.16,-1549"/>
<text text-anchor="middle" x="2678.16" y="-1527.3" font-family="Times,serif" font-size="14.00">telegram_bot.load_profiles</text>
</a>
</g>
</g>
<!-- telegram_bot.load_profiles&#45;&gt;serde_utils.read_text -->
<g id="edge8" class="edge">
<title>telegram_bot.load_profiles&#45;&gt;serde_utils.read_text</title>
<path fill="none" stroke="black" d="M2692.73,-1512.95C2717.98,-1479.73 2774.46,-1407.19 2827.66,-1351 2933.61,-1239.08 3014.96,-1254.46 3082.66,-1116 3124.88,-1029.66 3047.93,-750.07 3118.66,-685 3154.23,-652.28 3951.43,-654.18 3988.66,-685 4106.63,-782.65 4130.72,-1302.21 4134.88,-1429.73"/>
<polygon fill="black" stroke="black" points="4131.38,-1429.97 4135.19,-1439.86 4138.38,-1429.75 4131.38,-1429.97"/>
</g>
<!-- serde_utils.read_text&#45;&gt;serde_utils.read_text -->
<g id="edge210" class="edge">
<title>serde_utils.read_text&#45;&gt;serde_utils.read_text</title>
<path fill="none" stroke="black" d="M4086.73,-1476.15C4079.05,-1485.54 4095.69,-1494 4136.66,-1494 4161.94,-1494 4177.96,-1490.78 4184.72,-1486.1"/>
<polygon fill="black" stroke="black" points="4188.18,-1486.63 4186.59,-1476.15 4181.3,-1485.33 4188.18,-1486.63"/>
</g>
<!-- telegram_bot.load_state -->
<g id="node25" class="node">
<title>telegram_bot.load_state</title>
<g id="a_node25"><a xlink:title="Populate ``processed_ids`` from ``STATE_PATH``.">
<polygon fill="none" stroke="black" points="2772.16,-1603 2584.16,-1603 2584.16,-1567 2772.16,-1567 2772.16,-1603"/>
<text text-anchor="middle" x="2678.16" y="-1581.3" font-family="Times,serif" font-size="14.00">telegram_bot.load_state</text>
</a>
</g>
</g>
<!-- telegram_bot.load_state&#45;&gt;serde_utils.read_text -->
<g id="edge9" class="edge">
<title>telegram_bot.load_state&#45;&gt;serde_utils.read_text</title>
<path fill="none" stroke="black" d="M2772.34,-1567.28C2779.07,-1564.61 2785.58,-1561.54 2791.66,-1558 2955.26,-1462.78 3007.19,-1420.6 3082.66,-1247 3106.15,-1192.97 3075.61,-758.22 3118.66,-718 3162.18,-677.34 3328.54,-705 3386.66,-718 3535.28,-751.25 3576.21,-770.8 3696.66,-864 3915.12,-1033.03 4076.75,-1338.15 4122.52,-1430.67"/>
<polygon fill="black" stroke="black" points="4119.51,-1432.49 4127.06,-1439.92 4125.8,-1429.41 4119.51,-1432.49"/>
</g>
<!-- telegram_bot.save_state -->
<g id="node26" class="node">
<title>telegram_bot.save_state</title>
<polygon fill="none" stroke="black" points="3050.66,-1741 2859.66,-1741 2859.66,-1705 3050.66,-1705 3050.66,-1741"/>
<text text-anchor="middle" x="2955.16" y="-1719.3" font-family="Times,serif" font-size="14.00">telegram_bot.save_state</text>
</g>
<!-- telegram_bot.scan_embeddings -->
<g id="node27" class="node">
<title>telegram_bot.scan_embeddings</title>
<g id="a_node27"><a xlink:title="Load new embeddings and return list of new lot ids.">
<polygon fill="none" stroke="black" points="3373.66,-2879 3131.66,-2879 3131.66,-2843 3373.66,-2843 3373.66,-2879"/>
<text text-anchor="middle" x="3252.66" y="-2857.3" font-family="Times,serif" font-size="14.00">telegram_bot.scan_embeddings</text>
</a>
</g>
</g>
<!-- similar_utils._load_embeddings -->
<g id="node28" class="node">
<title>similar_utils._load_embeddings</title>
<g id="a_node28"><a xlink:title="Return mapping of lot id to embedding vector.">
<polygon fill="none" stroke="black" points="3679.16,-2879 3440.16,-2879 3440.16,-2843 3679.16,-2843 3679.16,-2879"/>
<text text-anchor="middle" x="3559.66" y="-2857.3" font-family="Times,serif" font-size="14.00">similar_utils._load_embeddings</text>
</a>
</g>
</g>
<!-- telegram_bot.scan_embeddings&#45;&gt;similar_utils._load_embeddings -->
<g id="edge10" class="edge">
<title>telegram_bot.scan_embeddings&#45;&gt;similar_utils._load_embeddings</title>
<path fill="none" stroke="black" d="M3373.76,-2861C3392.05,-2861 3410.99,-2861 3429.46,-2861"/>
<polygon fill="black" stroke="black" points="3429.66,-2864.5 3439.66,-2861 3429.66,-2857.5 3429.66,-2864.5"/>
</g>
<!-- serde_utils.load_json -->
<g id="node76" class="node">
<title>serde_utils.load_json</title>
<g id="a_node76"><a xlink:title="Return parsed JSON or ``None`` when invalid.">
<polygon fill="none" stroke="black" points="3943.16,-2673 3778.16,-2673 3778.16,-2637 3943.16,-2637 3943.16,-2673"/>
<text text-anchor="middle" x="3860.66" y="-2651.3" font-family="Times,serif" font-size="14.00">serde_utils.load_json</text>
</a>
</g>
</g>
<!-- similar_utils._load_embeddings&#45;&gt;serde_utils.load_json -->
<g id="edge234" class="edge">
<title>similar_utils._load_embeddings&#45;&gt;serde_utils.load_json</title>
<path fill="none" stroke="black" d="M3677.82,-2842.92C3684.36,-2840.33 3690.68,-2837.37 3696.66,-2834 3763.21,-2796.42 3817.45,-2721.92 3843.3,-2681.9"/>
<polygon fill="black" stroke="black" points="3846.41,-2683.53 3848.82,-2673.21 3840.5,-2679.78 3846.41,-2683.53"/>
</g>
<!-- telegram_bot._should_suggest -->
<g id="node29" class="node">
<title>telegram_bot._should_suggest</title>
<polygon fill="none" stroke="black" points="3369.16,-1835 3136.16,-1835 3136.16,-1799 3369.16,-1799 3369.16,-1835"/>
<text text-anchor="middle" x="3252.66" y="-1813.3" font-family="Times,serif" font-size="14.00">telegram_bot._should_suggest</text>
</g>
<!-- similar_utils._cos_sim -->
<g id="node30" class="node">
<title>similar_utils._cos_sim</title>
<g id="a_node30"><a xlink:title="Return cosine similarity between two embeddings.">
<polygon fill="none" stroke="black" points="3645.16,-1936 3474.16,-1936 3474.16,-1900 3645.16,-1900 3645.16,-1936"/>
<text text-anchor="middle" x="3559.66" y="-1914.3" font-family="Times,serif" font-size="14.00">similar_utils._cos_sim</text>
</a>
</g>
</g>
<!-- telegram_bot._should_suggest&#45;&gt;similar_utils._cos_sim -->
<g id="edge11" class="edge">
<title>telegram_bot._should_suggest&#45;&gt;similar_utils._cos_sim</title>
<path fill="none" stroke="black" d="M3369.25,-1834.92C3375.32,-1837.56 3381.16,-1840.57 3386.66,-1844 3408.97,-1857.95 3400.32,-1877.1 3422.66,-1891 3435.11,-1898.75 3449.34,-1904.34 3463.8,-1908.36"/>
<polygon fill="black" stroke="black" points="3463.27,-1911.84 3473.83,-1910.9 3464.99,-1905.05 3463.27,-1911.84"/>
</g>
<!-- telegram_bot.enqueue_new_ids -->
<g id="node31" class="node">
<title>telegram_bot.enqueue_new_ids</title>
<polygon fill="none" stroke="black" points="3075.16,-1633 2835.16,-1633 2835.16,-1597 3075.16,-1597 3075.16,-1633"/>
<text text-anchor="middle" x="2955.16" y="-1611.3" font-family="Times,serif" font-size="14.00">telegram_bot.enqueue_new_ids</text>
</g>
<!-- telegram_bot.enqueue_new_ids&#45;&gt;telegram_bot.save_profiles -->
<g id="edge12" class="edge">
<title>telegram_bot.enqueue_new_ids&#45;&gt;telegram_bot.save_profiles</title>
<path fill="none" stroke="black" d="M2962.25,-1596.7C2983.48,-1531.96 3054.47,-1307.43 3082.66,-1116 3109.07,-936.65 3049.49,-468.57 3118.66,-301 3139.62,-250.23 3186.42,-205.83 3218.52,-179.71"/>
<polygon fill="black" stroke="black" points="3221.11,-182.13 3226.74,-173.15 3216.74,-176.65 3221.11,-182.13"/>
</g>
<!-- telegram_bot.enqueue_new_ids&#45;&gt;telegram_bot._should_suggest -->
<g id="edge13" class="edge">
<title>telegram_bot.enqueue_new_ids&#45;&gt;telegram_bot._should_suggest</title>
<path fill="none" stroke="black" d="M3070.46,-1633.04C3074.78,-1635.68 3078.88,-1638.65 3082.66,-1642 3119.57,-1674.73 3086.56,-1709.53 3118.66,-1747 3136.8,-1768.17 3162.96,-1783.87 3187.3,-1794.97"/>
<polygon fill="black" stroke="black" points="3185.95,-1798.2 3196.51,-1799 3188.75,-1791.78 3185.95,-1798.2"/>
</g>
<!-- telegram_bot._send_queue -->
<g id="node32" class="node">
<title>telegram_bot._send_queue</title>
<g id="a_node32"><a xlink:title="Send next lot from each user queue via ``app``.">
<polygon fill="none" stroke="black" points="3058.16,-1687 2852.16,-1687 2852.16,-1651 3058.16,-1651 3058.16,-1687"/>
<text text-anchor="middle" x="2955.16" y="-1665.3" font-family="Times,serif" font-size="14.00">telegram_bot._send_queue</text>
</a>
</g>
</g>
<!-- telegram_bot._send_queue&#45;&gt;telegram_bot.save_profiles -->
<g id="edge14" class="edge">
<title>telegram_bot._send_queue&#45;&gt;telegram_bot.save_profiles</title>
<path fill="none" stroke="black" d="M3058.24,-1660.48C3067.56,-1656.03 3075.98,-1650.03 3082.66,-1642 3130.31,-1584.7 3090.82,-370.13 3118.66,-301 3139.26,-249.84 3186.49,-205.32 3218.75,-179.3"/>
<polygon fill="black" stroke="black" points="3220.92,-182.04 3226.6,-173.1 3216.58,-176.55 3220.92,-182.04"/>
</g>
<!-- lot_io.get_lot -->
<g id="node33" class="node">
<title>lot_io.get_lot</title>
<g id="a_node33"><a xlink:title="Return the lot identified by ``lot_id`` or ``None`` when missing.">
<polygon fill="none" stroke="black" points="3306.66,-2657 3198.66,-2657 3198.66,-2621 3306.66,-2621 3306.66,-2657"/>
<text text-anchor="middle" x="3252.66" y="-2635.3" font-family="Times,serif" font-size="14.00">lot_io.get_lot</text>
</a>
</g>
</g>
<!-- telegram_bot._send_queue&#45;&gt;lot_io.get_lot -->
<g id="edge15" class="edge">
<title>telegram_bot._send_queue&#45;&gt;lot_io.get_lot</title>
<path fill="none" stroke="black" d="M3058.44,-1677.75C3067.66,-1682.16 3076,-1688.1 3082.66,-1696 3148.27,-1773.91 3052.66,-2534.42 3118.66,-2612 3135.64,-2631.96 3162.97,-2639.67 3188.46,-2642.01"/>
<polygon fill="black" stroke="black" points="3188.27,-2645.51 3198.48,-2642.68 3188.73,-2638.52 3188.27,-2645.51"/>
</g>
<!-- lot_io.read_lots -->
<g id="node86" class="node">
<title>lot_io.read_lots</title>
<g id="a_node86"><a xlink:title="Return a list of lots from ``path`` or ``None`` when invalid.">
<polygon fill="none" stroke="black" points="3622.16,-2679 3497.16,-2679 3497.16,-2643 3622.16,-2643 3622.16,-2679"/>
<text text-anchor="middle" x="3559.66" y="-2657.3" font-family="Times,serif" font-size="14.00">lot_io.read_lots</text>
</a>
</g>
</g>
<!-- lot_io.get_lot&#45;&gt;lot_io.read_lots -->
<g id="edge106" class="edge">
<title>lot_io.get_lot&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M3306.79,-2642.83C3356.67,-2646.43 3431.69,-2651.84 3486.89,-2655.82"/>
<polygon fill="black" stroke="black" points="3486.73,-2659.32 3496.95,-2656.55 3487.23,-2652.34 3486.73,-2659.32"/>
</g>
<!-- lot_io.parse_lot_id -->
<g id="node89" class="node">
<title>lot_io.parse_lot_id</title>
<g id="a_node89"><a xlink:title="Return ``(relative_path, index)`` extracted from ``lot_id``.">
<polygon fill="none" stroke="black" points="3933.16,-2478 3788.16,-2478 3788.16,-2442 3933.16,-2442 3933.16,-2478"/>
<text text-anchor="middle" x="3860.66" y="-2456.3" font-family="Times,serif" font-size="14.00">lot_io.parse_lot_id</text>
</a>
</g>
</g>
<!-- lot_io.get_lot&#45;&gt;lot_io.parse_lot_id -->
<g id="edge107" class="edge">
<title>lot_io.get_lot&#45;&gt;lot_io.parse_lot_id</title>
<path fill="none" stroke="black" d="M3306.72,-2629.62C3331.2,-2624.94 3360.56,-2618.82 3386.66,-2612 3537.48,-2572.59 3711.08,-2513.07 3800.14,-2481.47"/>
<polygon fill="black" stroke="black" points="3801.54,-2484.69 3809.79,-2478.04 3799.2,-2478.09 3801.54,-2484.69"/>
</g>
<!-- telegram_bot.send_alert -->
<g id="node34" class="node">
<title>telegram_bot.send_alert</title>
<g id="a_node34"><a xlink:title="Broadcast ``text`` to all registered users.">
<polygon fill="none" stroke="black" points="2512.16,-1591 2322.16,-1591 2322.16,-1555 2512.16,-1555 2512.16,-1591"/>
<text text-anchor="middle" x="2417.16" y="-1569.3" font-family="Times,serif" font-size="14.00">telegram_bot.send_alert</text>
</a>
</g>
</g>
<!-- telegram_bot.send_alert&#45;&gt;telegram_bot.load_profiles -->
<g id="edge16" class="edge">
<title>telegram_bot.send_alert&#45;&gt;telegram_bot.load_profiles</title>
<path fill="none" stroke="black" d="M2512.4,-1557.72C2529.44,-1554.95 2547.37,-1552.05 2564.88,-1549.21"/>
<polygon fill="black" stroke="black" points="2565.81,-1552.6 2575.12,-1547.55 2564.69,-1545.69 2565.81,-1552.6"/>
</g>
<!-- telegram_bot.start_cmd -->
<g id="node35" class="node">
<title>telegram_bot.start_cmd</title>
<g id="a_node35"><a xlink:title="Register the user and confirm startup.">
<polygon fill="none" stroke="black" points="2771.66,-104 2584.66,-104 2584.66,-68 2771.66,-68 2771.66,-104"/>
<text text-anchor="middle" x="2678.16" y="-82.3" font-family="Times,serif" font-size="14.00">telegram_bot.start_cmd</text>
</a>
</g>
</g>
<!-- telegram_bot.start_cmd&#45;&gt;telegram_bot._t -->
<g id="edge17" class="edge">
<title>telegram_bot.start_cmd&#45;&gt;telegram_bot._t</title>
<path fill="none" stroke="black" d="M2771.88,-78.25C2807.35,-75.28 2847.28,-71.94 2880.71,-69.14"/>
<polygon fill="black" stroke="black" points="2881.19,-72.62 2890.86,-68.29 2880.6,-65.64 2881.19,-72.62"/>
</g>
<!-- telegram_bot.start_cmd&#45;&gt;telegram_bot.ensure_profile -->
<g id="edge18" class="edge">
<title>telegram_bot.start_cmd&#45;&gt;telegram_bot.ensure_profile</title>
<path fill="none" stroke="black" d="M2771.88,-96.45C2792.61,-98.79 2814.86,-101.3 2836.45,-103.73"/>
<polygon fill="black" stroke="black" points="2836.32,-107.24 2846.65,-104.88 2837.11,-100.28 2836.32,-107.24"/>
</g>
<!-- telegram_bot.lang_cmd -->
<g id="node36" class="node">
<title>telegram_bot.lang_cmd</title>
<g id="a_node36"><a xlink:title="Set preferred language or list available choices.">
<polygon fill="none" stroke="black" points="2769.66,-158 2586.66,-158 2586.66,-122 2769.66,-122 2769.66,-158"/>
<text text-anchor="middle" x="2678.16" y="-136.3" font-family="Times,serif" font-size="14.00">telegram_bot.lang_cmd</text>
</a>
</g>
</g>
<!-- telegram_bot.lang_cmd&#45;&gt;telegram_bot._t -->
<g id="edge19" class="edge">
<title>telegram_bot.lang_cmd&#45;&gt;telegram_bot._t</title>
<path fill="none" stroke="black" d="M2766.99,-121.96C2775.45,-119.32 2783.8,-116.34 2791.66,-113 2809.13,-105.57 2810.09,-97.21 2827.66,-90 2844.49,-83.09 2863.33,-77.86 2881.23,-73.92"/>
<polygon fill="black" stroke="black" points="2881.98,-77.34 2891.06,-71.87 2880.55,-70.49 2881.98,-77.34"/>
</g>
<!-- telegram_bot.lang_cmd&#45;&gt;telegram_bot.ensure_profile -->
<g id="edge20" class="edge">
<title>telegram_bot.lang_cmd&#45;&gt;telegram_bot.ensure_profile</title>
<path fill="none" stroke="black" d="M2769.97,-132.41C2791.13,-130.64 2813.97,-128.72 2836.12,-126.87"/>
<polygon fill="black" stroke="black" points="2836.57,-130.35 2846.24,-126.03 2835.99,-123.37 2836.57,-130.35"/>
</g>
<!-- telegram_bot.lang_cmd&#45;&gt;telegram_bot.save_profiles -->
<g id="edge21" class="edge">
<title>telegram_bot.lang_cmd&#45;&gt;telegram_bot.save_profiles</title>
<path fill="none" stroke="black" d="M2769.86,-142.46C2788.95,-142.97 2808.97,-143.51 2827.66,-144 2932.88,-146.78 3052.78,-149.89 3138.17,-152.09"/>
<polygon fill="black" stroke="black" points="3138.33,-155.59 3148.41,-152.35 3138.51,-148.59 3138.33,-155.59"/>
</g>
<!-- telegram_bot.vote_callback -->
<g id="node37" class="node">
<title>telegram_bot.vote_callback</title>
<g id="a_node37"><a xlink:title="Handle inline button presses for lot feedback.">
<polygon fill="none" stroke="black" points="2783.66,-50 2572.66,-50 2572.66,-14 2783.66,-14 2783.66,-50"/>
<text text-anchor="middle" x="2678.16" y="-28.3" font-family="Times,serif" font-size="14.00">telegram_bot.vote_callback</text>
</a>
</g>
</g>
<!-- telegram_bot.vote_callback&#45;&gt;telegram_bot._t -->
<g id="edge22" class="edge">
<title>telegram_bot.vote_callback&#45;&gt;telegram_bot._t</title>
<path fill="none" stroke="black" d="M2783.91,-43.81C2816.22,-47.45 2851.1,-51.38 2880.82,-54.73"/>
<polygon fill="black" stroke="black" points="2880.78,-58.25 2891.11,-55.89 2881.56,-51.29 2880.78,-58.25"/>
</g>
<!-- telegram_bot.vote_callback&#45;&gt;telegram_bot.ensure_profile -->
<g id="edge23" class="edge">
<title>telegram_bot.vote_callback&#45;&gt;telegram_bot.ensure_profile</title>
<path fill="none" stroke="black" d="M2770.76,-50.03C2777.99,-52.64 2785.04,-55.61 2791.66,-59 2810.45,-68.62 2808.74,-80.61 2827.66,-90 2831.51,-91.91 2835.48,-93.68 2839.55,-95.33"/>
<polygon fill="black" stroke="black" points="2838.6,-98.71 2849.19,-98.96 2841.06,-92.16 2838.6,-98.71"/>
</g>
<!-- telegram_bot.vote_callback&#45;&gt;telegram_bot.save_profiles -->
<g id="edge24" class="edge">
<title>telegram_bot.vote_callback&#45;&gt;telegram_bot.save_profiles</title>
<path fill="none" stroke="black" d="M2783.86,-16.29C2866.95,-7.76 2984.97,-4.52 3082.66,-36 3140.59,-54.67 3195.95,-100.84 3226.71,-129.88"/>
<polygon fill="black" stroke="black" points="3224.35,-132.46 3233.99,-136.86 3229.2,-127.41 3224.35,-132.46"/>
</g>
<!-- telegram_bot.main -->
<g id="node38" class="node">
<title>telegram_bot.main</title>
<g id="a_node38"><a xlink:title="Run the Telegram recommendation bot.">
<polygon fill="none" stroke="black" points="2492.66,-1668 2341.66,-1668 2341.66,-1632 2492.66,-1632 2492.66,-1668"/>
<text text-anchor="middle" x="2417.16" y="-1646.3" font-family="Times,serif" font-size="14.00">telegram_bot.main</text>
</a>
</g>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot.load_profiles -->
<g id="edge25" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot.load_profiles</title>
<path fill="none" stroke="black" d="M2470.24,-1631.95C2489.62,-1623.86 2511.14,-1613.14 2528.66,-1600 2548.33,-1585.25 2543.68,-1570.83 2564.66,-1558 2567.44,-1556.3 2570.33,-1554.7 2573.29,-1553.21"/>
<polygon fill="black" stroke="black" points="2574.76,-1556.38 2582.37,-1549.02 2571.83,-1550.03 2574.76,-1556.38"/>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot.load_state -->
<g id="edge26" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot.load_state</title>
<path fill="none" stroke="black" d="M2489.96,-1631.98C2522.66,-1623.77 2561.53,-1614.02 2595.36,-1605.53"/>
<polygon fill="black" stroke="black" points="2596.37,-1608.88 2605.22,-1603.05 2594.67,-1602.09 2596.37,-1608.88"/>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot.save_state -->
<g id="edge27" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot.save_state</title>
<path fill="none" stroke="black" d="M2493,-1662.16C2515.97,-1665.79 2541.34,-1669.67 2564.66,-1673 2660.9,-1686.73 2770.78,-1700.68 2849.24,-1710.34"/>
<polygon fill="black" stroke="black" points="2849.26,-1713.87 2859.61,-1711.62 2850.11,-1706.92 2849.26,-1713.87"/>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot.scan_embeddings -->
<g id="edge28" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot.scan_embeddings</title>
<path fill="none" stroke="black" d="M2430.33,-1668.03C2483.19,-1747.27 2694.48,-2073.94 2791.66,-2374 2824.62,-2475.78 2773.15,-2519.95 2827.66,-2612 2910.54,-2751.97 2970.52,-2766.78 3118.66,-2834 3123.12,-2836.02 3127.73,-2837.9 3132.44,-2839.63"/>
<polygon fill="black" stroke="black" points="3131.63,-2843.05 3142.23,-2842.99 3133.91,-2836.43 3131.63,-2843.05"/>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot.enqueue_new_ids -->
<g id="edge29" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot.enqueue_new_ids</title>
<path fill="none" stroke="black" d="M2492.69,-1645.13C2578.43,-1639.53 2720.74,-1630.24 2824.7,-1623.45"/>
<polygon fill="black" stroke="black" points="2825.2,-1626.93 2834.95,-1622.78 2824.75,-1619.94 2825.2,-1626.93"/>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot._send_queue -->
<g id="edge30" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot._send_queue</title>
<path fill="none" stroke="black" d="M2492.69,-1652.64C2583.25,-1655.85 2736.94,-1661.3 2841.86,-1665.02"/>
<polygon fill="black" stroke="black" points="2841.74,-1668.52 2851.86,-1665.37 2841.99,-1661.52 2841.74,-1668.52"/>
</g>
<!-- token_utils.estimate_tokens -->
<g id="node39" class="node">
<title>token_utils.estimate_tokens</title>
<g id="a_node39"><a xlink:title="Return a naive token count approximation.">
<polygon fill="none" stroke="black" points="3360.16,-2295 3145.16,-2295 3145.16,-2259 3360.16,-2259 3360.16,-2295"/>
<text text-anchor="middle" x="3252.66" y="-2273.3" font-family="Times,serif" font-size="14.00">token_utils.estimate_tokens</text>
</a>
</g>
</g>
<!-- tg_client._mark_activity -->
<g id="node40" class="node">
<title>tg_client._mark_activity</title>
<g id="a_node40"><a xlink:title="Update ``_last_event`` to the current time.">
<polygon fill="none" stroke="black" points="2510.16,-917 2324.16,-917 2324.16,-881 2510.16,-881 2510.16,-917"/>
<text text-anchor="middle" x="2417.16" y="-895.3" font-family="Times,serif" font-size="14.00">tg_client._mark_activity</text>
</a>
</g>
</g>
<!-- tg_client._heartbeat -->
<g id="node41" class="node">
<title>tg_client._heartbeat</title>
<g id="a_node41"><a xlink:title="Periodically log a heartbeat and warn if idle for too long.">
<polygon fill="none" stroke="black" points="1253.66,-1411 1094.66,-1411 1094.66,-1375 1253.66,-1375 1253.66,-1411"/>
<text text-anchor="middle" x="1174.16" y="-1389.3" font-family="Times,serif" font-size="14.00">tg_client._heartbeat</text>
</a>
</g>
</g>
<!-- tg_client._progress_logger -->
<g id="node42" class="node">
<title>tg_client._progress_logger</title>
<g id="a_node42"><a xlink:title="Return a progress callback that logs received bytes.">
<polygon fill="none" stroke="black" points="2519.66,-641 2314.66,-641 2314.66,-605 2519.66,-605 2519.66,-641"/>
<text text-anchor="middle" x="2417.16" y="-619.3" font-family="Times,serif" font-size="14.00">tg_client._progress_logger</text>
</a>
</g>
</g>
<!-- tg_client._write_md -->
<g id="node43" class="node">
<title>tg_client._write_md</title>
<g id="a_node43"><a xlink:title="Helper to store a raw post in Markdown format.">
<polygon fill="none" stroke="black" points="2756.16,-567 2600.16,-567 2600.16,-531 2756.16,-531 2756.16,-567"/>
<text text-anchor="middle" x="2678.16" y="-545.3" font-family="Times,serif" font-size="14.00">tg_client._write_md</text>
</a>
</g>
</g>
<!-- tg_client._write_md&#45;&gt;post_io.write_post -->
<g id="edge31" class="edge">
<title>tg_client._write_md&#45;&gt;post_io.write_post</title>
<path fill="none" stroke="black" d="M2756.49,-547.88C2792.51,-547.35 2835.38,-546.73 2871.97,-546.2"/>
<polygon fill="black" stroke="black" points="2872.17,-549.69 2882.12,-546.05 2872.07,-542.69 2872.17,-549.69"/>
</g>
<!-- tg_client._scan_group_cache -->
<g id="node44" class="node">
<title>tg_client._scan_group_cache</title>
<g id="a_node44"><a xlink:title="Build group_id &#45;&gt; Path mapping for ``chat`` quickly.">
<polygon fill="none" stroke="black" points="3361.66,-763 3143.66,-763 3143.66,-727 3361.66,-727 3361.66,-763"/>
<text text-anchor="middle" x="3252.66" y="-741.3" font-family="Times,serif" font-size="14.00">tg_client._scan_group_cache</text>
</a>
</g>
</g>
<!-- tg_client._scan_group_cache&#45;&gt;post_io.raw_post_path -->
<g id="edge32" class="edge">
<title>tg_client._scan_group_cache&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M3361.8,-755.55C3370.94,-759.69 3379.43,-765.07 3386.66,-772 3434.89,-818.27 3396.06,-856.69 3422.66,-918 3453.49,-989.07 3507.68,-1062.92 3537.5,-1100.92"/>
<polygon fill="black" stroke="black" points="3534.88,-1103.25 3543.83,-1108.91 3540.36,-1098.9 3534.88,-1103.25"/>
</g>
<!-- tg_client._find_group_path -->
<g id="node45" class="node">
<title>tg_client._find_group_path</title>
<g id="a_node45"><a xlink:title="Return stored message path for ``group_id`` if known.">
<polygon fill="none" stroke="black" points="3057.16,-748 2853.16,-748 2853.16,-712 3057.16,-712 3057.16,-748"/>
<text text-anchor="middle" x="2955.16" y="-726.3" font-family="Times,serif" font-size="14.00">tg_client._find_group_path</text>
</a>
</g>
</g>
<!-- tg_client._find_group_path&#45;&gt;tg_client._scan_group_cache -->
<g id="edge33" class="edge">
<title>tg_client._find_group_path&#45;&gt;tg_client._scan_group_cache</title>
<path fill="none" stroke="black" d="M3057.44,-735.14C3081.82,-736.38 3108.07,-737.71 3133.15,-738.98"/>
<polygon fill="black" stroke="black" points="3133.28,-742.5 3143.45,-739.51 3133.64,-735.5 3133.28,-742.5"/>
</g>
<!-- tg_client._get_message_path -->
<g id="node46" class="node">
<title>tg_client._get_message_path</title>
<g id="a_node46"><a xlink:title="Return path of stored message ``msg_id`` in ``chat`` if any.">
<polygon fill="none" stroke="black" points="2042.66,-1181 1821.66,-1181 1821.66,-1145 2042.66,-1145 2042.66,-1181"/>
<text text-anchor="middle" x="1932.16" y="-1159.3" font-family="Times,serif" font-size="14.00">tg_client._get_message_path</text>
</a>
</g>
</g>
<!-- tg_client._get_message_path&#45;&gt;post_io.raw_post_path -->
<g id="edge34" class="edge">
<title>tg_client._get_message_path&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M2042.88,-1153.01C2140.7,-1144.97 2287.86,-1135 2416.16,-1135 2416.16,-1135 2416.16,-1135 2679.16,-1135 2874.56,-1135 2923.27,-1125.67 3118.66,-1123 3237.76,-1121.37 3267.56,-1121.62 3386.66,-1123 3411.07,-1123.28 3437.43,-1123.79 3462,-1124.36"/>
<polygon fill="black" stroke="black" points="3461.97,-1127.86 3472.05,-1124.59 3462.13,-1120.86 3461.97,-1127.86"/>
</g>
<!-- tg_client._should_skip_media -->
<g id="node47" class="node">
<title>tg_client._should_skip_media</title>
<g id="a_node47"><a xlink:title="Return reason string if ``msg`` media should be skipped.">
<polygon fill="none" stroke="black" points="2528.66,-695 2305.66,-695 2305.66,-659 2528.66,-659 2528.66,-695"/>
<text text-anchor="middle" x="2417.16" y="-673.3" font-family="Times,serif" font-size="14.00">tg_client._should_skip_media</text>
</a>
</g>
</g>
<!-- tg_client._allowed_topic -->
<g id="node48" class="node">
<title>tg_client._allowed_topic</title>
<g id="a_node48"><a xlink:title="Return ``True`` if ``msg`` belongs to an allowed forum topic.">
<polygon fill="none" stroke="black" points="2771.16,-513 2585.16,-513 2585.16,-477 2771.16,-477 2771.16,-513"/>
<text text-anchor="middle" x="2678.16" y="-491.3" font-family="Times,serif" font-size="14.00">tg_client._allowed_topic</text>
</a>
</g>
</g>
<!-- tg_client._extract_author -->
<g id="node49" class="node">
<title>tg_client._extract_author</title>
<g id="a_node49"><a xlink:title="Return a metadata dictionary describing the message author.">
<polygon fill="none" stroke="black" points="3052.16,-625 2858.16,-625 2858.16,-589 3052.16,-589 3052.16,-625"/>
<text text-anchor="middle" x="2955.16" y="-603.3" font-family="Times,serif" font-size="14.00">tg_client._extract_author</text>
</a>
</g>
</g>
<!-- phone_utils.format_georgian -->
<g id="node50" class="node">
<title>phone_utils.format_georgian</title>
<g id="a_node50"><a xlink:title="Return ``phone`` in ``+995...`` format if possible.">
<polygon fill="none" stroke="black" points="3363.16,-633 3142.16,-633 3142.16,-597 3363.16,-597 3363.16,-633"/>
<text text-anchor="middle" x="3252.66" y="-611.3" font-family="Times,serif" font-size="14.00">phone_utils.format_georgian</text>
</a>
</g>
</g>
<!-- tg_client._extract_author&#45;&gt;phone_utils.format_georgian -->
<g id="edge35" class="edge">
<title>tg_client._extract_author&#45;&gt;phone_utils.format_georgian</title>
<path fill="none" stroke="black" d="M3052.51,-609.61C3077.9,-610.3 3105.6,-611.05 3132.05,-611.76"/>
<polygon fill="black" stroke="black" points="3132.03,-615.26 3142.12,-612.03 3132.22,-608.27 3132.03,-615.26"/>
</g>
<!-- tg_client._schedule_caption -->
<g id="node51" class="node">
<title>tg_client._schedule_caption</title>
<g id="a_node51"><a xlink:title="Run captioning in a separate process so downloads continue.">
<polygon fill="none" stroke="black" points="2784.16,-1316 2572.16,-1316 2572.16,-1280 2784.16,-1280 2784.16,-1316"/>
<text text-anchor="middle" x="2678.16" y="-1294.3" font-family="Times,serif" font-size="14.00">tg_client._schedule_caption</text>
</a>
</g>
</g>
<!-- tg_client._schedule_chop -->
<g id="node52" class="node">
<title>tg_client._schedule_chop</title>
<g id="a_node52"><a xlink:title="Run lot extraction in a separate process.">
<polygon fill="none" stroke="black" points="3656.16,-909 3463.16,-909 3463.16,-873 3656.16,-873 3656.16,-909"/>
<text text-anchor="middle" x="3559.66" y="-887.3" font-family="Times,serif" font-size="14.00">tg_client._schedule_chop</text>
</a>
</g>
</g>
<!-- tg_client._enqueue_chop -->
<g id="node53" class="node">
<title>tg_client._enqueue_chop</title>
<g id="a_node53"><a xlink:title="Queue ``path`` for chopping once captions are available.">
<polygon fill="none" stroke="black" points="2512.66,-825 2321.66,-825 2321.66,-789 2512.66,-789 2512.66,-825"/>
<text text-anchor="middle" x="2417.16" y="-803.3" font-family="Times,serif" font-size="14.00">tg_client._enqueue_chop</text>
</a>
</g>
</g>
<!-- tg_client._start_chop_worker -->
<g id="node54" class="node">
<title>tg_client._start_chop_worker</title>
<g id="a_node54"><a xlink:title="Ensure the chop queue worker task is running.">
<polygon fill="none" stroke="black" points="2788.66,-863 2567.66,-863 2567.66,-827 2788.66,-827 2788.66,-863"/>
<text text-anchor="middle" x="2678.16" y="-841.3" font-family="Times,serif" font-size="14.00">tg_client._start_chop_worker</text>
</a>
</g>
</g>
<!-- tg_client._enqueue_chop&#45;&gt;tg_client._start_chop_worker -->
<g id="edge36" class="edge">
<title>tg_client._enqueue_chop&#45;&gt;tg_client._start_chop_worker</title>
<path fill="none" stroke="black" d="M2512.76,-820.88C2527.2,-823 2542.27,-825.21 2557.17,-827.4"/>
<polygon fill="black" stroke="black" points="2557.05,-830.91 2567.45,-828.9 2558.06,-823.99 2557.05,-830.91"/>
</g>
<!-- caption_io.has_caption -->
<g id="node55" class="node">
<title>caption_io.has_caption</title>
<g id="a_node55"><a xlink:title="Return ``True`` when any caption exists for ``image``.">
<polygon fill="none" stroke="black" points="3648.16,-1790 3471.16,-1790 3471.16,-1754 3648.16,-1754 3648.16,-1790"/>
<text text-anchor="middle" x="3559.66" y="-1768.3" font-family="Times,serif" font-size="14.00">caption_io.has_caption</text>
</a>
</g>
</g>
<!-- tg_client._enqueue_chop&#45;&gt;caption_io.has_caption -->
<g id="edge37" class="edge">
<title>tg_client._enqueue_chop&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M2453.91,-825.11C2476.27,-837.13 2505.18,-853.97 2528.66,-872 2665.75,-977.28 2999.32,-1266.57 3082.66,-1418 3119.06,-1484.14 3063.37,-1532.59 3118.66,-1584 3206.76,-1665.92 3295.06,-1544.01 3386.66,-1622 3427.76,-1657 3383.44,-1700.91 3422.66,-1738 3433.61,-1748.36 3447.22,-1755.69 3461.57,-1760.86"/>
<polygon fill="black" stroke="black" points="3460.49,-1764.19 3471.08,-1763.96 3462.65,-1757.53 3460.49,-1764.19"/>
</g>
<!-- moderation.should_skip_message -->
<g id="node56" class="node">
<title>moderation.should_skip_message</title>
<g id="a_node56"><a xlink:title="Return ``True`` when the raw Telegram message should be ignored.">
<polygon fill="none" stroke="black" points="3687.16,-333 3432.16,-333 3432.16,-297 3687.16,-297 3687.16,-333"/>
<text text-anchor="middle" x="3559.66" y="-311.3" font-family="Times,serif" font-size="14.00">moderation.should_skip_message</text>
</a>
</g>
</g>
<!-- tg_client._enqueue_chop&#45;&gt;moderation.should_skip_message -->
<g id="edge38" class="edge">
<title>tg_client._enqueue_chop&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M2460.27,-788.87C2534.29,-755.41 2689.55,-677.95 2791.66,-576 2813.13,-554.56 2805.48,-538.71 2827.66,-518 2921.39,-430.49 2996.75,-478.2 3082.66,-383 3111.24,-351.32 3083.28,-317.85 3118.66,-294 3170.75,-258.88 3337.2,-277.49 3449.77,-295.33"/>
<polygon fill="black" stroke="black" points="3449.38,-298.81 3459.81,-296.94 3450.49,-291.9 3449.38,-298.81"/>
</g>
<!-- tg_client._chop_worker -->
<g id="node57" class="node">
<title>tg_client._chop_worker</title>
<g id="a_node57"><a xlink:title="Background task processing ``_CHOP_QUEUE``.">
<polygon fill="none" stroke="black" points="3045.16,-863 2865.16,-863 2865.16,-827 3045.16,-827 3045.16,-863"/>
<text text-anchor="middle" x="2955.16" y="-841.3" font-family="Times,serif" font-size="14.00">tg_client._chop_worker</text>
</a>
</g>
</g>
<!-- tg_client._start_chop_worker&#45;&gt;tg_client._chop_worker -->
<g id="edge39" class="edge">
<title>tg_client._start_chop_worker&#45;&gt;tg_client._chop_worker</title>
<path fill="none" stroke="black" d="M2789.03,-845C2810.73,-845 2833.38,-845 2854.71,-845"/>
<polygon fill="black" stroke="black" points="2854.74,-848.5 2864.74,-845 2854.74,-841.5 2854.74,-848.5"/>
</g>
<!-- caption_io.caption_json_path -->
<g id="node68" class="node">
<title>caption_io.caption_json_path</title>
<g id="a_node68"><a xlink:title="Return new&#45;style caption path for ``image``.">
<polygon fill="none" stroke="black" points="3971.16,-2074 3750.16,-2074 3750.16,-2038 3971.16,-2038 3971.16,-2074"/>
<text text-anchor="middle" x="3860.66" y="-2052.3" font-family="Times,serif" font-size="14.00">caption_io.caption_json_path</text>
</a>
</g>
</g>
<!-- caption_io.has_caption&#45;&gt;caption_io.caption_json_path -->
<g id="edge109" class="edge">
<title>caption_io.has_caption&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M3648.31,-1782.24C3665.38,-1787.01 3682.38,-1793.94 3696.66,-1804 3778.91,-1861.96 3829.83,-1975.89 3849.88,-2028.35"/>
<polygon fill="black" stroke="black" points="3846.7,-2029.85 3853.47,-2037.99 3853.26,-2027.4 3846.7,-2029.85"/>
</g>
<!-- caption_io.caption_md_path -->
<g id="node72" class="node">
<title>caption_io.caption_md_path</title>
<g id="a_node72"><a xlink:title="Return legacy Markdown caption path for ``image``.">
<polygon fill="none" stroke="black" points="3967.66,-1790 3753.66,-1790 3753.66,-1754 3967.66,-1754 3967.66,-1790"/>
<text text-anchor="middle" x="3860.66" y="-1768.3" font-family="Times,serif" font-size="14.00">caption_io.caption_md_path</text>
</a>
</g>
</g>
<!-- caption_io.has_caption&#45;&gt;caption_io.caption_md_path -->
<g id="edge110" class="edge">
<title>caption_io.has_caption&#45;&gt;caption_io.caption_md_path</title>
<path fill="none" stroke="black" d="M3648.35,-1772C3678.05,-1772 3711.69,-1772 3743.27,-1772"/>
<polygon fill="black" stroke="black" points="3743.44,-1775.5 3753.44,-1772 3743.44,-1768.5 3743.44,-1775.5"/>
</g>
<!-- moderation.message_skip_reason -->
<g id="node144" class="node">
<title>moderation.message_skip_reason</title>
<g id="a_node144"><a xlink:title="Return the moderation reason for ``meta`` and ``text`` or ``None``.">
<polygon fill="none" stroke="black" points="3988.66,-303 3732.66,-303 3732.66,-267 3988.66,-267 3988.66,-303"/>
<text text-anchor="middle" x="3860.66" y="-281.3" font-family="Times,serif" font-size="14.00">moderation.message_skip_reason</text>
</a>
</g>
</g>
<!-- moderation.should_skip_message&#45;&gt;moderation.message_skip_reason -->
<g id="edge216" class="edge">
<title>moderation.should_skip_message&#45;&gt;moderation.message_skip_reason</title>
<path fill="none" stroke="black" d="M3687.46,-302.28C3698.91,-301.13 3710.54,-299.96 3722.08,-298.8"/>
<polygon fill="black" stroke="black" points="3722.58,-302.27 3732.18,-297.79 3721.88,-295.31 3722.58,-302.27"/>
</g>
<!-- tg_client._process_chop_queue -->
<g id="node58" class="node">
<title>tg_client._process_chop_queue</title>
<g id="a_node58"><a xlink:title="Check queued posts and chop cooled down ones.">
<polygon fill="none" stroke="black" points="3370.16,-909 3135.16,-909 3135.16,-873 3370.16,-873 3370.16,-909"/>
<text text-anchor="middle" x="3252.66" y="-887.3" font-family="Times,serif" font-size="14.00">tg_client._process_chop_queue</text>
</a>
</g>
</g>
<!-- tg_client._chop_worker&#45;&gt;tg_client._process_chop_queue -->
<g id="edge42" class="edge">
<title>tg_client._chop_worker&#45;&gt;tg_client._process_chop_queue</title>
<path fill="none" stroke="black" d="M3045.22,-858.86C3070.65,-862.82 3098.84,-867.21 3126.02,-871.44"/>
<polygon fill="black" stroke="black" points="3125.56,-874.91 3135.98,-872.99 3126.63,-868 3125.56,-874.91"/>
</g>
<!-- tg_client._process_chop_queue&#45;&gt;tg_client._schedule_chop -->
<g id="edge40" class="edge">
<title>tg_client._process_chop_queue&#45;&gt;tg_client._schedule_chop</title>
<path fill="none" stroke="black" d="M3370.27,-891C3397.41,-891 3426.16,-891 3452.8,-891"/>
<polygon fill="black" stroke="black" points="3452.91,-894.5 3462.9,-891 3452.9,-887.5 3452.91,-894.5"/>
</g>
<!-- tg_client._process_chop_queue&#45;&gt;caption_io.has_caption -->
<g id="edge41" class="edge">
<title>tg_client._process_chop_queue&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M3264.6,-909.02C3291.08,-953.68 3358.52,-1073.85 3386.66,-1184 3413.41,-1288.71 3371,-1574.07 3422.66,-1669 3442.05,-1704.64 3479.63,-1731.63 3510.38,-1749.02"/>
<polygon fill="black" stroke="black" points="3508.81,-1752.15 3519.26,-1753.89 3512.17,-1746.01 3508.81,-1752.15"/>
</g>
<!-- tg_client._flush_chop_queue -->
<g id="node59" class="node">
<title>tg_client._flush_chop_queue</title>
<g id="a_node59"><a xlink:title="Run the chop worker until the queue is empty and cancel it.">
<polygon fill="none" stroke="black" points="1515.66,-1057 1300.66,-1057 1300.66,-1021 1515.66,-1021 1515.66,-1057"/>
<text text-anchor="middle" x="1408.16" y="-1035.3" font-family="Times,serif" font-size="14.00">tg_client._flush_chop_queue</text>
</a>
</g>
</g>
<!-- tg_client._flush_chop_queue&#45;&gt;tg_client._process_chop_queue -->
<g id="edge43" class="edge">
<title>tg_client._flush_chop_queue&#45;&gt;tg_client._process_chop_queue</title>
<path fill="none" stroke="black" d="M1515.85,-1030.43C1834.92,-1004.8 2780.97,-928.81 3124.88,-901.18"/>
<polygon fill="black" stroke="black" points="3125.19,-904.67 3134.88,-900.38 3124.63,-897.69 3125.19,-904.67"/>
</g>
<!-- tg_client._get_id_date -->
<g id="node60" class="node">
<title>tg_client._get_id_date</title>
<g id="a_node60"><a xlink:title="Return the stored date for ``msg_id`` in ``chat`` if available.">
<polygon fill="none" stroke="black" points="3338.16,-379 3167.16,-379 3167.16,-343 3338.16,-343 3338.16,-379"/>
<text text-anchor="middle" x="3252.66" y="-357.3" font-family="Times,serif" font-size="14.00">tg_client._get_id_date</text>
</a>
</g>
</g>
<!-- tg_client._get_id_date&#45;&gt;post_io.raw_post_path -->
<g id="edge44" class="edge">
<title>tg_client._get_id_date&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M3338.42,-365C3356.81,-369.92 3374.4,-378.49 3386.66,-393 3462.13,-482.32 3385.58,-807.09 3422.66,-918 3447.1,-991.09 3503.32,-1063.6 3535.3,-1100.99"/>
<polygon fill="black" stroke="black" points="3532.92,-1103.59 3542.12,-1108.86 3538.21,-1099.01 3532.92,-1103.59"/>
</g>
<!-- tg_client._get_id_date&#45;&gt;serde_utils.read_text -->
<g id="edge45" class="edge">
<title>tg_client._get_id_date&#45;&gt;serde_utils.read_text</title>
<path fill="none" stroke="black" d="M3338.29,-367.28C3493.9,-383.69 3824.5,-442.09 3988.66,-647 4089.06,-772.33 4126.41,-1301.35 4134.09,-1429.81"/>
<polygon fill="black" stroke="black" points="4130.6,-1430.22 4134.68,-1440 4137.59,-1429.81 4130.6,-1430.22"/>
</g>
<!-- tg_client._load_progress -->
<g id="node61" class="node">
<title>tg_client._load_progress</title>
<g id="a_node61"><a xlink:title="Return saved resume timestamp for ``chat`` if available.">
<polygon fill="none" stroke="black" points="1502.66,-261 1313.66,-261 1313.66,-225 1502.66,-225 1502.66,-261"/>
<text text-anchor="middle" x="1408.16" y="-239.3" font-family="Times,serif" font-size="14.00">tg_client._load_progress</text>
</a>
</g>
</g>
<!-- tg_client._load_progress&#45;&gt;serde_utils.read_text -->
<g id="edge46" class="edge">
<title>tg_client._load_progress&#45;&gt;serde_utils.read_text</title>
<path fill="none" stroke="black" d="M1502.8,-230.91C1607.13,-218.5 1780.92,-201 1931.16,-201 1931.16,-201 1931.16,-201 3253.66,-201 3454.31,-201 3511.15,-211.54 3696.66,-288 3714.44,-295.33 3716.34,-301.83 3732.66,-312 3844.37,-381.66 3914.87,-351.98 3988.66,-461 4100.13,-625.69 4129.54,-1284.07 4134.73,-1429.48"/>
<polygon fill="black" stroke="black" points="4131.25,-1429.91 4135.09,-1439.78 4138.24,-1429.67 4131.25,-1429.91"/>
</g>
<!-- tg_client._save_progress -->
<g id="node62" class="node">
<title>tg_client._save_progress</title>
<g id="a_node62"><a xlink:title="Persist resume timestamp for ``chat`` to ``STATE_DIR``.">
<polygon fill="none" stroke="black" points="1764.16,-927 1573.16,-927 1573.16,-891 1764.16,-891 1764.16,-927"/>
<text text-anchor="middle" x="1668.66" y="-905.3" font-family="Times,serif" font-size="14.00">tg_client._save_progress</text>
</a>
</g>
</g>
<!-- tg_client.get_first_id -->
<g id="node63" class="node">
<title>tg_client.get_first_id</title>
<g id="a_node63"><a xlink:title="Return the smallest saved message id for ``chat``.">
<polygon fill="none" stroke="black" points="2013.16,-574 1851.16,-574 1851.16,-538 2013.16,-538 2013.16,-574"/>
<text text-anchor="middle" x="1932.16" y="-552.3" font-family="Times,serif" font-size="14.00">tg_client.get_first_id</text>
</a>
</g>
</g>
<!-- tg_client.get_first_id&#45;&gt;post_io.raw_post_path -->
<g id="edge47" class="edge">
<title>tg_client.get_first_id&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M1979.28,-537.9C2048.76,-511.64 2185.01,-464.04 2305.66,-445 2424.32,-426.28 3298.67,-344.21 3386.66,-426 3426.81,-463.32 3405.16,-866.06 3422.66,-918 3447.27,-991.04 3503.42,-1063.57 3535.35,-1100.98"/>
<polygon fill="black" stroke="black" points="3532.96,-1103.57 3542.15,-1108.84 3538.26,-1098.99 3532.96,-1103.57"/>
</g>
<!-- tg_client.get_last_id -->
<g id="node64" class="node">
<title>tg_client.get_last_id</title>
<g id="a_node64"><a xlink:title="Return the highest saved message id for ``chat``.">
<polygon fill="none" stroke="black" points="1487.66,-881 1328.66,-881 1328.66,-845 1487.66,-845 1487.66,-881"/>
<text text-anchor="middle" x="1408.16" y="-859.3" font-family="Times,serif" font-size="14.00">tg_client.get_last_id</text>
</a>
</g>
</g>
<!-- tg_client.get_last_id&#45;&gt;post_io.raw_post_path -->
<g id="edge48" class="edge">
<title>tg_client.get_last_id&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M1487.8,-866.19C1564.01,-869.46 1682.81,-875.06 1785.66,-882 2017.07,-897.62 2074.12,-912.46 2305.66,-926 2425.63,-933.01 3275.97,-914.2 3386.66,-961 3456.13,-990.37 3513.66,-1061.71 3541.18,-1100.62"/>
<polygon fill="black" stroke="black" points="3538.32,-1102.64 3546.9,-1108.86 3544.07,-1098.65 3538.32,-1102.64"/>
</g>
<!-- tg_client._save_message -->
<g id="node65" class="node">
<title>tg_client._save_message</title>
<g id="a_node65"><a xlink:title="Write ``msg`` to disk with metadata and any media references.&#10;&#10;Returns the path of the stored message or ``None`` when skipped.">
<polygon fill="none" stroke="black" points="2269.66,-718 2078.66,-718 2078.66,-682 2269.66,-682 2269.66,-718"/>
<text text-anchor="middle" x="2174.16" y="-696.3" font-family="Times,serif" font-size="14.00">tg_client._save_message</text>
</a>
</g>
</g>
<!-- tg_client._save_message&#45;&gt;post_io.get_contact -->
<g id="edge49" class="edge">
<title>tg_client._save_message&#45;&gt;post_io.get_contact</title>
<path fill="none" stroke="black" d="M2179.36,-681.84C2190.74,-637.33 2226.77,-522.97 2305.66,-476 2378.3,-432.74 2945.82,-444.18 3165.36,-450.32"/>
<polygon fill="black" stroke="black" points="3165.45,-453.83 3175.55,-450.61 3165.65,-446.83 3165.45,-453.83"/>
</g>
<!-- tg_client._save_message&#45;&gt;post_io.read_post -->
<g id="edge50" class="edge">
<title>tg_client._save_message&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M2187.1,-718.28C2207.53,-747.9 2252.19,-805.91 2305.66,-834 2394.66,-880.76 2431.04,-847.95 2528.66,-872 2918,-967.93 3017.4,-994.66 3386.66,-1151 3433.78,-1170.95 3485.35,-1199.15 3519.61,-1218.85"/>
<polygon fill="black" stroke="black" points="3517.96,-1221.94 3528.37,-1223.92 3521.47,-1215.88 3517.96,-1221.94"/>
</g>
<!-- tg_client._save_message&#45;&gt;post_io.raw_post_path -->
<g id="edge51" class="edge">
<title>tg_client._save_message&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M2269.86,-717.3C2281.89,-719.32 2294.05,-721.27 2305.66,-723 2649.76,-774.32 2739.78,-759.08 3082.66,-818 3098.81,-820.78 3102.53,-823.07 3118.66,-826 3237.02,-847.51 3285.13,-799.46 3386.66,-864 3388.14,-864.94 3497.91,-1033.58 3541.29,-1100.29"/>
<polygon fill="black" stroke="black" points="3538.57,-1102.52 3546.96,-1109 3544.44,-1098.71 3538.57,-1102.52"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._mark_activity -->
<g id="edge52" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._mark_activity</title>
<path fill="none" stroke="black" d="M2184.29,-718.14C2202.53,-752.5 2246.83,-827.21 2305.66,-867 2311.16,-870.72 2317.1,-874.02 2323.26,-876.93"/>
<polygon fill="black" stroke="black" points="2321.88,-880.14 2332.44,-880.94 2324.68,-873.73 2321.88,-880.14"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._progress_logger -->
<g id="edge53" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._progress_logger</title>
<path fill="none" stroke="black" d="M2218.18,-681.94C2243.39,-671.76 2276.02,-659.26 2305.66,-650 2312.59,-647.83 2319.81,-645.73 2327.1,-643.72"/>
<polygon fill="black" stroke="black" points="2328.31,-647.02 2337.05,-641.04 2326.48,-640.26 2328.31,-647.02"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._write_md -->
<g id="edge54" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._write_md</title>
<path fill="none" stroke="black" d="M2185.97,-681.51C2205.37,-650.37 2249.36,-588.39 2305.66,-563 2396.03,-522.24 2511.7,-525.35 2589.77,-534.37"/>
<polygon fill="black" stroke="black" points="2589.71,-537.88 2600.06,-535.61 2590.55,-530.93 2589.71,-537.88"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._find_group_path -->
<g id="edge55" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._find_group_path</title>
<path fill="none" stroke="black" d="M2269.9,-703.65C2414.28,-709.21 2688.78,-719.78 2842.59,-725.7"/>
<polygon fill="black" stroke="black" points="2842.87,-729.22 2853,-726.1 2843.14,-722.22 2842.87,-729.22"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._should_skip_media -->
<g id="edge56" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._should_skip_media</title>
<path fill="none" stroke="black" d="M2269.72,-690.98C2278.15,-690.17 2286.77,-689.35 2295.38,-688.53"/>
<polygon fill="black" stroke="black" points="2295.86,-692 2305.49,-687.56 2295.2,-685.03 2295.86,-692"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._allowed_topic -->
<g id="edge57" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._allowed_topic</title>
<path fill="none" stroke="black" d="M2182.47,-681.88C2198.48,-644.86 2240.49,-561.05 2305.66,-525 2387.75,-479.58 2496.02,-475.99 2574.48,-481.41"/>
<polygon fill="black" stroke="black" points="2574.63,-484.93 2584.87,-482.19 2575.16,-477.95 2574.63,-484.93"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._extract_author -->
<g id="edge58" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._extract_author</title>
<path fill="none" stroke="black" d="M2190.56,-681.66C2212.9,-656.65 2256.98,-613.02 2305.66,-596 2402.51,-562.13 2690.13,-582.06 2847.82,-596.35"/>
<polygon fill="black" stroke="black" points="2847.73,-599.86 2858.01,-597.29 2848.37,-592.89 2847.73,-599.86"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._enqueue_chop -->
<g id="edge59" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._enqueue_chop</title>
<path fill="none" stroke="black" d="M2202.17,-718.09C2227.89,-734.7 2268.14,-759.06 2305.66,-775 2314.99,-778.97 2324.97,-782.62 2334.97,-785.92"/>
<polygon fill="black" stroke="black" points="2333.95,-789.27 2344.54,-788.98 2336.08,-782.6 2333.95,-789.27"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._save_message -->
<g id="edge60" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._save_message</title>
<path fill="none" stroke="black" d="M2130.38,-718.15C2123.64,-727.54 2138.24,-736 2174.16,-736 2196.05,-736 2210.02,-732.86 2216.07,-728.28"/>
<polygon fill="black" stroke="black" points="2219.56,-728.62 2217.94,-718.15 2212.68,-727.35 2219.56,-728.62"/>
</g>
<!-- tg_client._save_media -->
<g id="node66" class="node">
<title>tg_client._save_media</title>
<g id="a_node66"><a xlink:title="Store ``data`` and return relative file path.">
<polygon fill="none" stroke="black" points="2503.16,-1316 2331.16,-1316 2331.16,-1280 2503.16,-1280 2503.16,-1316"/>
<text text-anchor="middle" x="2417.16" y="-1294.3" font-family="Times,serif" font-size="14.00">tg_client._save_media</text>
</a>
</g>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._save_media -->
<g id="edge61" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._save_media</title>
<path fill="none" stroke="black" d="M2182.5,-718.22C2217.05,-803.94 2363.43,-1167.17 2405.07,-1270.48"/>
<polygon fill="black" stroke="black" points="2401.89,-1271.95 2408.87,-1279.92 2408.38,-1269.34 2401.89,-1271.95"/>
</g>
<!-- moderation.should_skip_user -->
<g id="node67" class="node">
<title>moderation.should_skip_user</title>
<g id="a_node67"><a xlink:title="Return ``True`` if ``username`` is blacklisted.">
<polygon fill="none" stroke="black" points="4248.66,-330 4024.66,-330 4024.66,-294 4248.66,-294 4248.66,-330"/>
<text text-anchor="middle" x="4136.66" y="-308.3" font-family="Times,serif" font-size="14.00">moderation.should_skip_user</text>
</a>
</g>
</g>
<!-- tg_client._save_message&#45;&gt;moderation.should_skip_user -->
<g id="edge62" class="edge">
<title>tg_client._save_message&#45;&gt;moderation.should_skip_user</title>
<path fill="none" stroke="black" d="M2183.37,-681.81C2208.62,-626.17 2284.7,-461.08 2305.66,-445 2452.26,-332.55 2935.14,-292.38 3118.66,-271 3502.77,-226.24 3621.79,-135.71 3988.66,-258 4007.63,-264.32 4006.57,-276.46 4024.66,-285 4028.75,-286.93 4033,-288.74 4037.34,-290.42"/>
<polygon fill="black" stroke="black" points="4036.38,-293.79 4046.97,-293.91 4038.76,-287.21 4036.38,-293.79"/>
</g>
<!-- tg_client._save_media&#45;&gt;tg_client._schedule_caption -->
<g id="edge63" class="edge">
<title>tg_client._save_media&#45;&gt;tg_client._schedule_caption</title>
<path fill="none" stroke="black" d="M2503.32,-1298C2522.03,-1298 2542.14,-1298 2561.81,-1298"/>
<polygon fill="black" stroke="black" points="2562.05,-1301.5 2572.05,-1298 2562.05,-1294.5 2562.05,-1301.5"/>
</g>
<!-- tg_client._save_media&#45;&gt;caption_io.has_caption -->
<g id="edge65" class="edge">
<title>tg_client._save_media&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M2490.86,-1316.05C2566.94,-1335.76 2689.32,-1369.8 2791.66,-1409 2925.33,-1460.21 2990.44,-1437.53 3082.66,-1547 3121.01,-1592.52 3074.26,-1636.36 3118.66,-1676 3208.64,-1756.35 3272.24,-1680.78 3386.66,-1719 3403.82,-1724.73 3405.76,-1731.54 3422.66,-1738 3435.55,-1742.93 3449.41,-1747.35 3463.18,-1751.23"/>
<polygon fill="black" stroke="black" points="3462.59,-1754.7 3473.16,-1753.97 3464.44,-1747.95 3462.59,-1754.7"/>
</g>
<!-- tg_client._save_media&#45;&gt;caption_io.caption_json_path -->
<g id="edge64" class="edge">
<title>tg_client._save_media&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M2445.28,-1316.13C2474.18,-1335.06 2521.6,-1364.98 2564.66,-1387 2677.62,-1444.76 2709.34,-1452.2 2827.66,-1498 2939.74,-1541.39 3000.02,-1500.73 3082.66,-1588 3121.82,-1629.36 3075.45,-1673.88 3118.66,-1711 3209.82,-1789.32 3284.16,-1684.25 3386.66,-1747 3410.63,-1761.68 3398.72,-1784.27 3422.66,-1799 3527.37,-1863.42 3590.86,-1774.38 3696.66,-1837 3773.93,-1882.73 3826.1,-1980.71 3848.01,-2028.57"/>
<polygon fill="black" stroke="black" points="3844.82,-2030.01 3852.1,-2037.71 3851.21,-2027.15 3844.82,-2030.01"/>
</g>
<!-- image_io.write_image_meta -->
<g id="node69" class="node">
<title>image_io.write_image_meta</title>
<g id="a_node69"><a xlink:title="Write ``meta`` to ``path.with_suffix(&#39;.md&#39;)``.">
<polygon fill="none" stroke="black" points="3062.66,-1107 2847.66,-1107 2847.66,-1071 3062.66,-1071 3062.66,-1107"/>
<text text-anchor="middle" x="2955.16" y="-1085.3" font-family="Times,serif" font-size="14.00">image_io.write_image_meta</text>
</a>
</g>
</g>
<!-- tg_client._save_media&#45;&gt;image_io.write_image_meta -->
<g id="edge66" class="edge">
<title>tg_client._save_media&#45;&gt;image_io.write_image_meta</title>
<path fill="none" stroke="black" d="M2464.32,-1280C2562.57,-1241.69 2792.07,-1152.2 2898.33,-1110.77"/>
<polygon fill="black" stroke="black" points="2899.87,-1113.92 2907.92,-1107.03 2897.33,-1107.4 2899.87,-1113.92"/>
</g>
<!-- image_io.write_image_meta&#45;&gt;serde_utils.write_md -->
<g id="edge251" class="edge">
<title>image_io.write_image_meta&#45;&gt;serde_utils.write_md</title>
<path fill="none" stroke="black" d="M2970.25,-1070.8C2997.15,-1035 3055.56,-951.91 3082.66,-872 3103.09,-811.75 3075.37,-634.62 3118.66,-588 3129.61,-576.2 3144.19,-568.78 3159.68,-564.24"/>
<polygon fill="black" stroke="black" points="3160.59,-567.62 3169.42,-561.77 3158.86,-560.83 3160.59,-567.62"/>
</g>
<!-- tg_client._save_bounded -->
<g id="node70" class="node">
<title>tg_client._save_bounded</title>
<g id="a_node70"><a xlink:title="Run ``_save_message`` under the global semaphore and return path.">
<polygon fill="none" stroke="black" points="2027.16,-812 1837.16,-812 1837.16,-776 2027.16,-776 2027.16,-812"/>
<text text-anchor="middle" x="1932.16" y="-790.3" font-family="Times,serif" font-size="14.00">tg_client._save_bounded</text>
</a>
</g>
</g>
<!-- tg_client._save_bounded&#45;&gt;tg_client._save_message -->
<g id="edge67" class="edge">
<title>tg_client._save_bounded&#45;&gt;tg_client._save_message</title>
<path fill="none" stroke="black" d="M1979.15,-775.99C2018.55,-760.56 2075.4,-738.29 2117.39,-721.84"/>
<polygon fill="black" stroke="black" points="2118.88,-725.02 2126.92,-718.11 2116.33,-718.5 2118.88,-725.02"/>
</g>
<!-- tg_client._remove_local_message -->
<g id="node71" class="node">
<title>tg_client._remove_local_message</title>
<g id="a_node71"><a xlink:title="Delete ``path`` and related media if the post no longer exists.">
<polygon fill="none" stroke="black" points="3378.16,-1575 3127.16,-1575 3127.16,-1539 3378.16,-1539 3378.16,-1575"/>
<text text-anchor="middle" x="3252.66" y="-1553.3" font-family="Times,serif" font-size="14.00">tg_client._remove_local_message</text>
</a>
</g>
</g>
<!-- tg_client._remove_local_message&#45;&gt;post_io.read_post -->
<g id="edge68" class="edge">
<title>tg_client._remove_local_message&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M3376.69,-1538.82C3380.25,-1536.19 3383.59,-1533.26 3386.66,-1530 3466.8,-1444.62 3342.33,-1354.2 3422.66,-1269 3437.27,-1253.5 3458.03,-1245.49 3478.94,-1241.64"/>
<polygon fill="black" stroke="black" points="3479.51,-1245.1 3488.86,-1240.12 3478.45,-1238.18 3479.51,-1245.1"/>
</g>
<!-- tg_client._remove_local_message&#45;&gt;caption_io.caption_json_path -->
<g id="edge69" class="edge">
<title>tg_client._remove_local_message&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M3366.94,-1575.02C3374.08,-1578.87 3380.76,-1583.49 3386.66,-1589 3425.78,-1625.58 3381.97,-1669.17 3422.66,-1704 3516.2,-1784.07 3596.32,-1673.63 3696.66,-1745 3709.58,-1754.19 3809.26,-1954.05 3846.06,-2028.43"/>
<polygon fill="black" stroke="black" points="3843.05,-2030.25 3850.62,-2037.67 3849.33,-2027.15 3843.05,-2030.25"/>
</g>
<!-- tg_client._remove_local_message&#45;&gt;caption_io.caption_md_path -->
<g id="edge70" class="edge">
<title>tg_client._remove_local_message&#45;&gt;caption_io.caption_md_path</title>
<path fill="none" stroke="black" d="M3364.6,-1575.03C3372.51,-1578.86 3379.98,-1583.47 3386.66,-1589 3416.68,-1613.88 3391.66,-1645.35 3422.66,-1669 3520.66,-1743.78 3577.35,-1681 3696.66,-1712 3734.75,-1721.9 3776.36,-1737.29 3808.01,-1750.01"/>
<polygon fill="black" stroke="black" points="3806.91,-1753.35 3817.49,-1753.87 3809.55,-1746.86 3806.91,-1753.35"/>
</g>
<!-- tg_client._download_messages -->
<g id="node73" class="node">
<title>tg_client._download_messages</title>
<g id="a_node73"><a xlink:title="Save ``messages`` with a progress bar and return count saved.">
<polygon fill="none" stroke="black" points="1785.66,-835 1551.66,-835 1551.66,-799 1785.66,-799 1785.66,-835"/>
<text text-anchor="middle" x="1668.66" y="-813.3" font-family="Times,serif" font-size="14.00">tg_client._download_messages</text>
</a>
</g>
</g>
<!-- tg_client._download_messages&#45;&gt;tg_client._save_bounded -->
<g id="edge71" class="edge">
<title>tg_client._download_messages&#45;&gt;tg_client._save_bounded</title>
<path fill="none" stroke="black" d="M1785.88,-806.78C1799.47,-805.58 1813.27,-804.37 1826.68,-803.19"/>
<polygon fill="black" stroke="black" points="1827.2,-806.66 1836.85,-802.29 1826.59,-799.68 1827.2,-806.66"/>
</g>
<!-- tg_client.ensure_chat_access -->
<g id="node74" class="node">
<title>tg_client.ensure_chat_access</title>
<g id="a_node74"><a xlink:title="Join chats listed in ``CHATS`` if not already joined.">
<polygon fill="none" stroke="black" points="1779.66,-173 1557.66,-173 1557.66,-137 1779.66,-137 1779.66,-173"/>
<text text-anchor="middle" x="1668.66" y="-151.3" font-family="Times,serif" font-size="14.00">tg_client.ensure_chat_access</text>
</a>
</g>
</g>
<!-- tg_client.refetch_messages -->
<g id="node75" class="node">
<title>tg_client.refetch_messages</title>
<g id="a_node75"><a xlink:title="Re&#45;fetch posts that failed parsing or are empty.">
<polygon fill="none" stroke="black" points="1773.66,-1238 1563.66,-1238 1563.66,-1202 1773.66,-1202 1773.66,-1238"/>
<text text-anchor="middle" x="1668.66" y="-1216.3" font-family="Times,serif" font-size="14.00">tg_client.refetch_messages</text>
</a>
</g>
</g>
<!-- tg_client.refetch_messages&#45;&gt;post_io.read_post -->
<g id="edge72" class="edge">
<title>tg_client.refetch_messages&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M1773.7,-1229.5C1875.45,-1237.95 2034.82,-1249 2173.16,-1249 2173.16,-1249 2173.16,-1249 2679.16,-1249 2994.93,-1249 3075.06,-1132.88 3386.66,-1184 3428.69,-1190.9 3474.28,-1206.68 3507.96,-1220.04"/>
<polygon fill="black" stroke="black" points="3506.99,-1223.42 3517.57,-1223.92 3509.61,-1216.93 3506.99,-1223.42"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;post_io.raw_post_path -->
<g id="edge73" class="edge">
<title>tg_client.refetch_messages&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M1694.24,-1201.99C1723.12,-1181.92 1773.25,-1150.4 1821.66,-1136 2090.71,-1055.96 2802.6,-1042.97 3082.66,-1062 3214.67,-1070.97 3365.85,-1093.78 3461.76,-1109.84"/>
<polygon fill="black" stroke="black" points="3461.29,-1113.31 3471.73,-1111.52 3462.45,-1106.41 3461.29,-1113.31"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;tg_client._get_message_path -->
<g id="edge74" class="edge">
<title>tg_client.refetch_messages&#45;&gt;tg_client._get_message_path</title>
<path fill="none" stroke="black" d="M1752.4,-1201.96C1779.84,-1195.98 1810.55,-1189.29 1838.68,-1183.16"/>
<polygon fill="black" stroke="black" points="1839.48,-1186.57 1848.51,-1181.02 1837.99,-1179.73 1839.48,-1186.57"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;tg_client._save_bounded -->
<g id="edge75" class="edge">
<title>tg_client.refetch_messages&#45;&gt;tg_client._save_bounded</title>
<path fill="none" stroke="black" d="M1680.73,-1201.97C1721.74,-1135.16 1865.18,-901.49 1914.42,-821.28"/>
<polygon fill="black" stroke="black" points="1917.69,-822.63 1919.94,-812.28 1911.73,-818.97 1917.69,-822.63"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;tg_client._remove_local_message -->
<g id="edge76" class="edge">
<title>tg_client.refetch_messages&#45;&gt;tg_client._remove_local_message</title>
<path fill="none" stroke="black" d="M1674.65,-1238.11C1703.58,-1338.77 1859.55,-1825 2173.16,-1825 2173.16,-1825 2173.16,-1825 2679.16,-1825 2861.56,-1825 2947.98,-1873.02 3082.66,-1750 3126.29,-1710.14 3080.81,-1667.38 3118.66,-1622 3134.5,-1603 3157.23,-1589.1 3179.43,-1579.15"/>
<polygon fill="black" stroke="black" points="3181.06,-1582.26 3188.89,-1575.13 3178.32,-1575.82 3181.06,-1582.26"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;serde_utils.load_json -->
<g id="edge77" class="edge">
<title>tg_client.refetch_messages&#45;&gt;serde_utils.load_json</title>
<path fill="none" stroke="black" d="M1672.21,-1238.23C1682.11,-1304.43 1722.49,-1536.64 1821.66,-1698 2064.04,-2092.41 2150.07,-2222.01 2564.66,-2428 2773.04,-2531.54 2859.16,-2439.26 3082.66,-2504 3099.48,-2508.87 3101.82,-2515.2 3118.66,-2520 3368.05,-2591.14 3457.72,-2499.18 3696.66,-2600 3715.33,-2607.88 3714.28,-2619.45 3732.66,-2628 3743.79,-2633.17 3755.93,-2637.37 3768.14,-2640.77"/>
<polygon fill="black" stroke="black" points="3767.38,-2644.19 3777.94,-2643.32 3769.15,-2637.41 3767.38,-2644.19"/>
</g>
<!-- serde_utils.write_json -->
<g id="node77" class="node">
<title>serde_utils.write_json</title>
<g id="a_node77"><a xlink:title="Serialise ``data`` to ``path`` with standard options.">
<polygon fill="none" stroke="black" points="3646.16,-3101 3473.16,-3101 3473.16,-3065 3646.16,-3065 3646.16,-3101"/>
<text text-anchor="middle" x="3559.66" y="-3079.3" font-family="Times,serif" font-size="14.00">serde_utils.write_json</text>
</a>
</g>
</g>
<!-- tg_client.refetch_messages&#45;&gt;serde_utils.write_json -->
<g id="edge78" class="edge">
<title>tg_client.refetch_messages&#45;&gt;serde_utils.write_json</title>
<path fill="none" stroke="black" d="M1669.42,-1238C1668.13,-1367.09 1666.74,-2151.45 1821.66,-2315 1890.47,-2387.65 1948.35,-2324.54 2042.66,-2358 2150.4,-2396.23 2170.69,-2421.76 2269.66,-2479 2387.19,-2546.97 2414.59,-2567.36 2528.66,-2641 2545.2,-2651.68 3100.16,-3027.26 3118.66,-3034 3179.85,-3056.29 3352.83,-3070.54 3462.79,-3077.63"/>
<polygon fill="black" stroke="black" points="3462.69,-3081.13 3472.9,-3078.27 3463.14,-3074.14 3462.69,-3081.13"/>
</g>
<!-- serde_utils.load_json&#45;&gt;serde_utils.read_text -->
<g id="edge213" class="edge">
<title>serde_utils.load_json&#45;&gt;serde_utils.read_text</title>
<path fill="none" stroke="black" d="M3943.22,-2652.77C3960.33,-2648.51 3976.76,-2640.95 3988.66,-2628 4068.71,-2540.88 4124.06,-1657.02 4134.04,-1486.42"/>
<polygon fill="black" stroke="black" points="4137.54,-1486.41 4134.63,-1476.23 4130.56,-1486.01 4137.54,-1486.41"/>
</g>
<!-- tg_client.fetch_missing -->
<g id="node78" class="node">
<title>tg_client.fetch_missing</title>
<g id="a_node78"><a xlink:title="Pull new messages and back&#45;fill history until fully synced.">
<polygon fill="none" stroke="black" points="1264.66,-858 1083.66,-858 1083.66,-822 1264.66,-822 1264.66,-858"/>
<text text-anchor="middle" x="1174.16" y="-836.3" font-family="Times,serif" font-size="14.00">tg_client.fetch_missing</text>
</a>
</g>
</g>
<!-- tg_client.fetch_missing&#45;&gt;post_io.raw_post_path -->
<g id="edge79" class="edge">
<title>tg_client.fetch_missing&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M1198.11,-858.15C1222.15,-876.05 1261.75,-902.49 1300.66,-915 1407.23,-949.26 1440.03,-927.56 1551.66,-936 2366.75,-997.63 2588.85,-882.04 3386.66,-1060 3430.97,-1069.88 3478.92,-1089.35 3512.9,-1104.76"/>
<polygon fill="black" stroke="black" points="3511.56,-1108 3522.1,-1108.99 3514.48,-1101.64 3511.56,-1108"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client._get_id_date -->
<g id="edge80" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client._get_id_date</title>
<path fill="none" stroke="black" d="M1181.94,-821.88C1217.18,-731.21 1388.53,-331 1667.66,-331 1667.66,-331 1667.66,-331 2679.16,-331 2847.51,-331 3043.32,-344.1 3156.81,-352.98"/>
<polygon fill="black" stroke="black" points="3156.61,-356.48 3166.86,-353.78 3157.16,-349.5 3156.61,-356.48"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client._load_progress -->
<g id="edge81" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client._load_progress</title>
<path fill="none" stroke="black" d="M1175.03,-821.94C1175.37,-750.95 1184.75,-486.6 1300.66,-317 1315.28,-295.61 1338.27,-278.5 1359.15,-266.14"/>
<polygon fill="black" stroke="black" points="1360.99,-269.13 1367.95,-261.14 1357.52,-263.04 1360.99,-269.13"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client._save_progress -->
<g id="edge82" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client._save_progress</title>
<path fill="none" stroke="black" d="M1211.22,-858.04C1235.78,-869.4 1269.38,-883.16 1300.66,-890 1387.57,-909.02 1488.68,-912.95 1562.75,-912.6"/>
<polygon fill="black" stroke="black" points="1563.04,-916.1 1573.01,-912.52 1562.99,-909.1 1563.04,-916.1"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client.get_first_id -->
<g id="edge83" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client.get_first_id</title>
<path fill="none" stroke="black" d="M1223.31,-821.91C1356.52,-771.87 1729.6,-631.72 1873.52,-577.65"/>
<polygon fill="black" stroke="black" points="1874.94,-580.86 1883.07,-574.07 1872.48,-574.31 1874.94,-580.86"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client.get_last_id -->
<g id="edge84" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client.get_last_id</title>
<path fill="none" stroke="black" d="M1264.86,-848.89C1282.44,-850.64 1300.88,-852.46 1318.44,-854.2"/>
<polygon fill="black" stroke="black" points="1318.36,-857.71 1328.66,-855.22 1319.05,-850.75 1318.36,-857.71"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client._download_messages -->
<g id="edge85" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client._download_messages</title>
<path fill="none" stroke="black" d="M1264.92,-835.81C1342.31,-832.19 1454.93,-826.93 1541.4,-822.9"/>
<polygon fill="black" stroke="black" points="1541.72,-826.39 1551.55,-822.42 1541.4,-819.39 1541.72,-826.39"/>
</g>
<!-- tg_client.remove_deleted -->
<g id="node79" class="node">
<title>tg_client.remove_deleted</title>
<g id="a_node79"><a xlink:title="Delete locally stored messages removed from Telegram recently.">
<polygon fill="none" stroke="black" points="3350.66,-1413 3154.66,-1413 3154.66,-1377 3350.66,-1377 3350.66,-1413"/>
<text text-anchor="middle" x="3252.66" y="-1391.3" font-family="Times,serif" font-size="14.00">tg_client.remove_deleted</text>
</a>
</g>
</g>
<!-- tg_client.remove_deleted&#45;&gt;post_io.read_post -->
<g id="edge86" class="edge">
<title>tg_client.remove_deleted&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M3350.7,-1383.49C3363.82,-1378.7 3376.31,-1372.09 3386.66,-1363 3420.27,-1333.48 3388.46,-1297.84 3422.66,-1269 3438.39,-1255.73 3458.79,-1248.31 3478.98,-1244.32"/>
<polygon fill="black" stroke="black" points="3479.59,-1247.77 3488.85,-1242.62 3478.4,-1240.87 3479.59,-1247.77"/>
</g>
<!-- tg_client.remove_deleted&#45;&gt;post_io.raw_post_path -->
<g id="edge87" class="edge">
<title>tg_client.remove_deleted&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M3284.82,-1376.94C3314.21,-1358.63 3357.93,-1327.92 3386.66,-1292 3410.25,-1262.5 3397.84,-1243.48 3422.66,-1215 3446.75,-1187.36 3481.58,-1165.04 3509.96,-1149.8"/>
<polygon fill="black" stroke="black" points="3511.7,-1152.85 3518.93,-1145.11 3508.45,-1146.65 3511.7,-1152.85"/>
</g>
<!-- tg_client.remove_deleted&#45;&gt;caption_io.caption_json_path -->
<g id="edge88" class="edge">
<title>tg_client.remove_deleted&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M3350.98,-1401.18C3364.22,-1405.68 3376.67,-1412.33 3386.66,-1422 3436.53,-1470.29 3371.55,-1527.01 3422.66,-1574 3513.31,-1657.33 3607.67,-1529.9 3696.66,-1615 3756.88,-1672.59 3705.97,-1720.06 3732.66,-1799 3762.41,-1886.99 3816.29,-1983.29 3843.3,-2029.01"/>
<polygon fill="black" stroke="black" points="3840.36,-2030.91 3848.48,-2037.71 3846.37,-2027.33 3840.36,-2030.91"/>
</g>
<!-- tg_client.remove_deleted&#45;&gt;caption_io.caption_md_path -->
<g id="edge89" class="edge">
<title>tg_client.remove_deleted&#45;&gt;caption_io.caption_md_path</title>
<path fill="none" stroke="black" d="M3350.76,-1401.89C3363.96,-1406.31 3376.45,-1412.74 3386.66,-1422 3426.97,-1458.54 3381.54,-1503.37 3422.66,-1539 3515.82,-1619.72 3589,-1521.96 3696.66,-1582 3766.71,-1621.06 3820.47,-1702.54 3845.02,-1744.98"/>
<polygon fill="black" stroke="black" points="3842.11,-1746.94 3850.09,-1753.91 3848.2,-1743.48 3842.11,-1746.94"/>
</g>
<!-- tg_client.main -->
<g id="node80" class="node">
<title>tg_client.main</title>
<g id="a_node80"><a xlink:title="Synchronize configured chats and optional live updates.">
<polygon fill="none" stroke="black" points="1036.46,-1057 918.46,-1057 918.46,-1021 1036.46,-1021 1036.46,-1057"/>
<text text-anchor="middle" x="977.46" y="-1035.3" font-family="Times,serif" font-size="14.00">tg_client.main</text>
</a>
</g>
</g>
<!-- tg_client.main&#45;&gt;tg_client._mark_activity -->
<g id="edge90" class="edge">
<title>tg_client.main&#45;&gt;tg_client._mark_activity</title>
<path fill="none" stroke="black" d="M1036.6,-1033.34C1255.59,-1012.01 2032.44,-936.37 2313.62,-908.99"/>
<polygon fill="black" stroke="black" points="2314.2,-912.45 2323.81,-907.99 2313.52,-905.48 2314.2,-912.45"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client._heartbeat -->
<g id="edge91" class="edge">
<title>tg_client.main&#45;&gt;tg_client._heartbeat</title>
<path fill="none" stroke="black" d="M979.05,-1057.11C981.78,-1110.98 997.13,-1272.05 1083.66,-1361 1086.7,-1364.13 1090.07,-1366.95 1093.66,-1369.5"/>
<polygon fill="black" stroke="black" points="1092.08,-1372.63 1102.41,-1374.96 1095.78,-1366.69 1092.08,-1372.63"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client._flush_chop_queue -->
<g id="edge92" class="edge">
<title>tg_client.main&#45;&gt;tg_client._flush_chop_queue</title>
<path fill="none" stroke="black" d="M1036.73,-1039C1101.56,-1039 1208,-1039 1290.18,-1039"/>
<polygon fill="black" stroke="black" points="1290.33,-1042.5 1300.33,-1039 1290.33,-1035.5 1290.33,-1042.5"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client._save_bounded -->
<g id="edge93" class="edge">
<title>tg_client.main&#45;&gt;tg_client._save_bounded</title>
<path fill="none" stroke="black" d="M980.65,-1020.91C987.1,-976.53 1010.4,-862.28 1083.66,-813 1328.77,-648.13 1710.51,-730.11 1863.95,-773.21"/>
<polygon fill="black" stroke="black" points="1863.15,-776.62 1873.73,-775.99 1865.07,-769.89 1863.15,-776.62"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client.ensure_chat_access -->
<g id="edge94" class="edge">
<title>tg_client.main&#45;&gt;tg_client.ensure_chat_access</title>
<path fill="none" stroke="black" d="M979.32,-1020.81C985.07,-920.99 1026.78,-436.13 1300.66,-216 1369.32,-160.82 1468.97,-147.12 1547.12,-146.36"/>
<polygon fill="black" stroke="black" points="1547.52,-149.86 1557.51,-146.34 1547.5,-142.86 1547.52,-149.86"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client.refetch_messages -->
<g id="edge95" class="edge">
<title>tg_client.main&#45;&gt;tg_client.refetch_messages</title>
<path fill="none" stroke="black" d="M1036.63,-1054.28C1160.31,-1086.76 1449.49,-1162.7 1589.27,-1199.41"/>
<polygon fill="black" stroke="black" points="1588.51,-1202.83 1599.07,-1201.99 1590.28,-1196.06 1588.51,-1202.83"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client.fetch_missing -->
<g id="edge96" class="edge">
<title>tg_client.main&#45;&gt;tg_client.fetch_missing</title>
<path fill="none" stroke="black" d="M996.09,-1020.99C1030.82,-985.49 1108.22,-906.37 1148.2,-865.51"/>
<polygon fill="black" stroke="black" points="1150.95,-867.71 1155.44,-858.11 1145.94,-862.81 1150.95,-867.71"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client.remove_deleted -->
<g id="edge97" class="edge">
<title>tg_client.main&#45;&gt;tg_client.remove_deleted</title>
<path fill="none" stroke="black" d="M990.79,-1057.34C1036.98,-1123.65 1207.38,-1347 1407.16,-1347 1407.16,-1347 1407.16,-1347 2175.16,-1347 2530.33,-1347 2950.77,-1373.4 3144.32,-1387.04"/>
<polygon fill="black" stroke="black" points="3144.27,-1390.55 3154.49,-1387.76 3144.77,-1383.56 3144.27,-1390.55"/>
</g>
<!-- lot_io._clean_lot -->
<g id="node81" class="node">
<title>lot_io._clean_lot</title>
<g id="a_node81"><a xlink:title="Return ``lot`` without empty or null fields.">
<polygon fill="none" stroke="black" points="3925.16,-2998 3796.16,-2998 3796.16,-2962 3925.16,-2962 3925.16,-2998"/>
<text text-anchor="middle" x="3860.66" y="-2976.3" font-family="Times,serif" font-size="14.00">lot_io._clean_lot</text>
</a>
</g>
</g>
<!-- lot_io.valid_lots -->
<g id="node82" class="node">
<title>lot_io.valid_lots</title>
<g id="a_node82"><a xlink:title="Return ``True`` when every lot contains the required translations.">
<polygon fill="none" stroke="black" points="3623.16,-2175 3496.16,-2175 3496.16,-2139 3623.16,-2139 3623.16,-2175"/>
<text text-anchor="middle" x="3559.66" y="-2153.3" font-family="Times,serif" font-size="14.00">lot_io.valid_lots</text>
</a>
</g>
</g>
<!-- lot_io.needs_cleanup -->
<g id="node83" class="node">
<title>lot_io.needs_cleanup</title>
<g id="a_node83"><a xlink:title="Return ``True`` when ``clean_data`` would drop ``lots``.">
<polygon fill="none" stroke="black" points="3641.66,-2121 3477.66,-2121 3477.66,-2085 3641.66,-2085 3641.66,-2121"/>
<text text-anchor="middle" x="3559.66" y="-2099.3" font-family="Times,serif" font-size="14.00">lot_io.needs_cleanup</text>
</a>
</g>
</g>
<!-- lot_io.get_seller -->
<g id="node84" class="node">
<title>lot_io.get_seller</title>
<g id="a_node84"><a xlink:title="Return the seller identifier or ``None`` when missing.">
<polygon fill="none" stroke="black" points="3624.16,-3623 3495.16,-3623 3495.16,-3587 3624.16,-3587 3624.16,-3623"/>
<text text-anchor="middle" x="3559.66" y="-3601.3" font-family="Times,serif" font-size="14.00">lot_io.get_seller</text>
</a>
</g>
</g>
<!-- lot_io.get_timestamp -->
<g id="node85" class="node">
<title>lot_io.get_timestamp</title>
<g id="a_node85"><a xlink:title="Return ``lot[&#39;timestamp&#39;]`` as a timezone&#45;aware ``datetime``.">
<polygon fill="none" stroke="black" points="3642.66,-3507 3476.66,-3507 3476.66,-3471 3642.66,-3471 3642.66,-3507"/>
<text text-anchor="middle" x="3559.66" y="-3485.3" font-family="Times,serif" font-size="14.00">lot_io.get_timestamp</text>
</a>
</g>
</g>
<!-- lot_io.read_lots&#45;&gt;serde_utils.load_json -->
<g id="edge99" class="edge">
<title>lot_io.read_lots&#45;&gt;serde_utils.load_json</title>
<path fill="none" stroke="black" d="M3622.25,-2659.76C3664.22,-2658.92 3720.52,-2657.79 3767.76,-2656.84"/>
<polygon fill="black" stroke="black" points="3768.08,-2660.34 3778,-2656.64 3767.93,-2653.34 3768.08,-2660.34"/>
</g>
<!-- lot_io.read_lots&#45;&gt;lot_io._clean_lot -->
<g id="edge98" class="edge">
<title>lot_io.read_lots&#45;&gt;lot_io._clean_lot</title>
<path fill="none" stroke="black" d="M3615.42,-2679.08C3642.02,-2689.77 3673.21,-2705.31 3696.66,-2726 3771.98,-2792.47 3825.9,-2901.84 3848.23,-2952.57"/>
<polygon fill="black" stroke="black" points="3845.09,-2954.12 3852.28,-2961.91 3851.52,-2951.34 3845.09,-2954.12"/>
</g>
<!-- lot_io.write_lots -->
<g id="node87" class="node">
<title>lot_io.write_lots</title>
<g id="a_node87"><a xlink:title="Write lots to ``path`` using consistent JSON formatting.">
<polygon fill="none" stroke="black" points="3317.66,-3501 3187.66,-3501 3187.66,-3465 3317.66,-3465 3317.66,-3501"/>
<text text-anchor="middle" x="3252.66" y="-3479.3" font-family="Times,serif" font-size="14.00">lot_io.write_lots</text>
</a>
</g>
</g>
<!-- lot_io.write_lots&#45;&gt;serde_utils.write_json -->
<g id="edge103" class="edge">
<title>lot_io.write_lots&#45;&gt;serde_utils.write_json</title>
<path fill="none" stroke="black" d="M3317.78,-3485.33C3342.72,-3482.73 3369.4,-3475.02 3386.66,-3456 3490.58,-3341.52 3318.49,-3224.25 3422.66,-3110 3433.47,-3098.14 3447.87,-3090.63 3463.26,-3086"/>
<polygon fill="black" stroke="black" points="3464.16,-3089.39 3472.95,-3083.48 3462.39,-3082.61 3464.16,-3089.39"/>
</g>
<!-- lot_io.write_lots&#45;&gt;lot_io._clean_lot -->
<g id="edge100" class="edge">
<title>lot_io.write_lots&#45;&gt;lot_io._clean_lot</title>
<path fill="none" stroke="black" d="M3317.82,-3472.05C3433.99,-3451.68 3669.7,-3407.62 3696.66,-3381 3742.68,-3335.56 3710.35,-3300.71 3732.66,-3240 3765.16,-3151.55 3818.22,-3053.13 3844.26,-3006.84"/>
<polygon fill="black" stroke="black" points="3847.36,-3008.46 3849.24,-2998.03 3841.27,-3005.01 3847.36,-3008.46"/>
</g>
<!-- lot_io.write_lots&#45;&gt;lot_io.get_seller -->
<g id="edge101" class="edge">
<title>lot_io.write_lots&#45;&gt;lot_io.get_seller</title>
<path fill="none" stroke="black" d="M3317.67,-3491.92C3339.92,-3496.09 3364.77,-3501.95 3386.66,-3510 3436.62,-3528.38 3489.59,-3559.65 3523.33,-3581.27"/>
<polygon fill="black" stroke="black" points="3521.6,-3584.32 3531.89,-3586.82 3525.4,-3578.44 3521.6,-3584.32"/>
</g>
<!-- lot_io.write_lots&#45;&gt;lot_io.get_timestamp -->
<g id="edge102" class="edge">
<title>lot_io.write_lots&#45;&gt;lot_io.get_timestamp</title>
<path fill="none" stroke="black" d="M3317.97,-3484.27C3361.04,-3485.11 3418.42,-3486.24 3466.35,-3487.18"/>
<polygon fill="black" stroke="black" points="3466.36,-3490.68 3476.43,-3487.38 3466.5,-3483.69 3466.36,-3490.68"/>
</g>
<!-- lot_io.make_lot_id -->
<g id="node88" class="node">
<title>lot_io.make_lot_id</title>
<g id="a_node88"><a xlink:title="Return lot id string for ``rel`` and ``index``.&#10;&#10;``rel`` is the JSON file path relative to the ``data/lots`` directory&#10;without the ``.json`` suffix.">
<polygon fill="none" stroke="black" points="3631.16,-2825 3488.16,-2825 3488.16,-2789 3631.16,-2789 3631.16,-2825"/>
<text text-anchor="middle" x="3559.66" y="-2803.3" font-family="Times,serif" font-size="14.00">lot_io.make_lot_id</text>
</a>
</g>
</g>
<!-- lot_io.lot_json_path -->
<g id="node90" class="node">
<title>lot_io.lot_json_path</title>
<g id="a_node90"><a xlink:title="Return full JSON path for ``lot_id`` given ``root`` directory.">
<polygon fill="none" stroke="black" points="3636.16,-2473 3483.16,-2473 3483.16,-2437 3636.16,-2437 3636.16,-2473"/>
<text text-anchor="middle" x="3559.66" y="-2451.3" font-family="Times,serif" font-size="14.00">lot_io.lot_json_path</text>
</a>
</g>
</g>
<!-- lot_io.lot_json_path&#45;&gt;lot_io.parse_lot_id -->
<g id="edge104" class="edge">
<title>lot_io.lot_json_path&#45;&gt;lot_io.parse_lot_id</title>
<path fill="none" stroke="black" d="M3636.5,-2456.27C3679.67,-2456.99 3733.78,-2457.89 3777.9,-2458.63"/>
<polygon fill="black" stroke="black" points="3777.96,-2462.13 3788.02,-2458.8 3778.08,-2455.14 3777.96,-2462.13"/>
</g>
<!-- lot_io.embedding_path -->
<g id="node91" class="node">
<title>lot_io.embedding_path</title>
<g id="a_node91"><a xlink:title="Return embedding file path for ``lot_path``.">
<polygon fill="none" stroke="black" points="178,-106 0,-106 0,-70 178,-70 178,-106"/>
<text text-anchor="middle" x="89" y="-84.3" font-family="Times,serif" font-size="14.00">lot_io.embedding_path</text>
</a>
</g>
</g>
<!-- testing_mode.apply_testing_mode -->
<g id="node92" class="node">
<title>testing_mode.apply_testing_mode</title>
<g id="a_node92"><a xlink:title="Tweak environment variables when ``TEST_MODE`` is set.">
<polygon fill="none" stroke="black" points="473,-106 214,-106 214,-70 473,-70 473,-106"/>
<text text-anchor="middle" x="343.5" y="-84.3" font-family="Times,serif" font-size="14.00">testing_mode.apply_testing_mode</text>
</a>
</g>
</g>
<!-- lot_io.embedding_path&#45;&gt;testing_mode.apply_testing_mode -->
<!-- testing_mode.apply_testing_mode&#45;&gt;telegram_bot:cli -->
<!-- lot_io.iter_lot_files -->
<g id="node93" class="node">
<title>lot_io.iter_lot_files</title>
<g id="a_node93"><a xlink:title="Return ``*.json`` files under ``root``.&#10;&#10;When ``newest_first`` is ``True`` the result is ordered by modification&#10;time with the most recently changed files first. &#160;Both ``build_site.py`` and&#10;``pending_embed.py`` rely on this helper so they scan the lot directory in&#10;the same order.">
<polygon fill="none" stroke="black" points="3632.66,-1660 3486.66,-1660 3486.66,-1624 3632.66,-1624 3632.66,-1660"/>
<text text-anchor="middle" x="3559.66" y="-1638.3" font-family="Times,serif" font-size="14.00">lot_io.iter_lot_files</text>
</a>
</g>
</g>
<!-- caption_io._get_langs -->
<g id="node94" class="node">
<title>caption_io._get_langs</title>
<g id="a_node94"><a xlink:title="Return configured languages, caching the result.">
<polygon fill="none" stroke="black" points="3944.66,-2619 3776.66,-2619 3776.66,-2583 3944.66,-2583 3944.66,-2619"/>
<text text-anchor="middle" x="3860.66" y="-2597.3" font-family="Times,serif" font-size="14.00">caption_io._get_langs</text>
</a>
</g>
</g>
<!-- config_utils.load_config -->
<g id="node95" class="node">
<title>config_utils.load_config</title>
<g id="a_node95"><a xlink:title="Return the ``config`` module or exit with a helpful message.&#10;&#10;When running the scripts directly from ``src/`` the repository root isn&#39;t on&#10;``sys.path`` and ``config.py`` can&#39;t be imported. &#160;Try adding the parent&#10;directory before failing so the configuration can live alongside&#10;``config.example.py`` in the project root.">
<polygon fill="none" stroke="black" points="4227.66,-3325 4045.66,-3325 4045.66,-3289 4227.66,-3289 4227.66,-3325"/>
<text text-anchor="middle" x="4136.66" y="-3303.3" font-family="Times,serif" font-size="14.00">config_utils.load_config</text>
</a>
</g>
</g>
<!-- caption_io._get_langs&#45;&gt;config_utils.load_config -->
<g id="edge108" class="edge">
<title>caption_io._get_langs&#45;&gt;config_utils.load_config</title>
<path fill="none" stroke="black" d="M3944.71,-2604.6C3961.03,-2608.91 3976.76,-2616.15 3988.66,-2628 4083.33,-2722.32 4124.25,-3162.13 4133.54,-3278.63"/>
<polygon fill="black" stroke="black" points="4130.07,-3279.17 4134.34,-3288.87 4137.05,-3278.62 4130.07,-3279.17"/>
</g>
<!-- caption_io.read_caption -->
<g id="node96" class="node">
<title>caption_io.read_caption</title>
<g id="a_node96"><a xlink:title="Return caption for ``image`` in ``lang`` or empty string when missing.">
<polygon fill="none" stroke="black" points="3652.16,-2229 3467.16,-2229 3467.16,-2193 3652.16,-2193 3652.16,-2229"/>
<text text-anchor="middle" x="3559.66" y="-2207.3" font-family="Times,serif" font-size="14.00">caption_io.read_caption</text>
</a>
</g>
</g>
<!-- caption_io.read_caption&#45;&gt;serde_utils.read_md -->
<g id="edge114" class="edge">
<title>caption_io.read_caption&#45;&gt;serde_utils.read_md</title>
<path fill="none" stroke="black" d="M3652.2,-2209.74C3669.2,-2205.23 3685.19,-2197.31 3696.66,-2184 3751.34,-2120.55 3678.41,-1494.82 3732.66,-1431 3742.39,-1419.56 3755.65,-1412.24 3769.96,-1407.68"/>
<polygon fill="black" stroke="black" points="3771.27,-1410.95 3779.99,-1404.95 3769.43,-1404.2 3771.27,-1410.95"/>
</g>
<!-- caption_io.read_caption&#45;&gt;caption_io.caption_json_path -->
<g id="edge112" class="edge">
<title>caption_io.read_caption&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M3652.51,-2198.9C3667.65,-2195.18 3682.88,-2190.33 3696.66,-2184 3751.88,-2158.62 3805.19,-2111.01 3835.07,-2081.55"/>
<polygon fill="black" stroke="black" points="3837.91,-2083.66 3842.51,-2074.12 3832.96,-2078.71 3837.91,-2083.66"/>
</g>
<!-- caption_io.read_caption&#45;&gt;caption_io.caption_md_path -->
<g id="edge113" class="edge">
<title>caption_io.read_caption&#45;&gt;caption_io.caption_md_path</title>
<path fill="none" stroke="black" d="M3652.19,-2207.61C3668.68,-2203.16 3684.47,-2195.81 3696.66,-2184 3747.47,-2134.8 3708.83,-2095.59 3732.66,-2029 3764.03,-1941.32 3817.39,-1844.52 3843.83,-1798.77"/>
<polygon fill="black" stroke="black" points="3846.9,-1800.46 3848.9,-1790.06 3840.85,-1796.94 3846.9,-1800.46"/>
</g>
<!-- caption_io.read_caption&#45;&gt;serde_utils.load_json -->
<g id="edge115" class="edge">
<title>caption_io.read_caption&#45;&gt;serde_utils.load_json</title>
<path fill="none" stroke="black" d="M3652.31,-2216.31C3669.19,-2221.42 3685.11,-2229.74 3696.66,-2243 3753.09,-2307.8 3675.53,-2563.81 3732.66,-2628 3742.13,-2638.64 3754.65,-2645.67 3768.15,-2650.23"/>
<polygon fill="black" stroke="black" points="3767.55,-2653.69 3778.13,-2653.12 3769.5,-2646.97 3767.55,-2653.69"/>
</g>
<!-- caption_io.read_caption&#45;&gt;caption_io._get_langs -->
<g id="edge111" class="edge">
<title>caption_io.read_caption&#45;&gt;caption_io._get_langs</title>
<path fill="none" stroke="black" d="M3652.47,-2216.59C3669.24,-2221.69 3685.07,-2229.94 3696.66,-2243 3791.66,-2350.04 3640.89,-2453.17 3732.66,-2563 3741.74,-2573.87 3753.8,-2581.71 3766.88,-2587.35"/>
<polygon fill="black" stroke="black" points="3765.96,-2590.75 3776.55,-2591.08 3768.48,-2584.22 3765.96,-2590.75"/>
</g>
<!-- caption_io.write_caption -->
<g id="node97" class="node">
<title>caption_io.write_caption</title>
<g id="a_node97"><a xlink:title="Write ``text`` as ``lang`` caption for ``image``.">
<polygon fill="none" stroke="black" points="3347.66,-2971 3157.66,-2971 3157.66,-2935 3347.66,-2935 3347.66,-2971"/>
<text text-anchor="middle" x="3252.66" y="-2949.3" font-family="Times,serif" font-size="14.00">caption_io.write_caption</text>
</a>
</g>
</g>
<!-- caption_io.write_caption&#45;&gt;caption_io.caption_json_path -->
<g id="edge117" class="edge">
<title>caption_io.write_caption&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M3342.93,-2934.94C3368.6,-2930.05 3396.69,-2925.02 3422.66,-2921 3483.27,-2911.62 3654.57,-2932.61 3696.66,-2888 3741.12,-2840.88 3715.63,-2368.51 3732.66,-2306 3756.42,-2218.77 3812.54,-2126.54 3841.56,-2082.47"/>
<polygon fill="black" stroke="black" points="3844.53,-2084.32 3847.16,-2074.06 3838.7,-2080.45 3844.53,-2084.32"/>
</g>
<!-- caption_io.write_caption&#45;&gt;serde_utils.load_json -->
<g id="edge118" class="edge">
<title>caption_io.write_caption&#45;&gt;serde_utils.load_json</title>
<path fill="none" stroke="black" d="M3347.82,-2964.58C3361.35,-2968.36 3374.71,-2973.37 3386.66,-2980 3407,-2991.28 3401.29,-3008.81 3422.66,-3018 3478.59,-3042.06 3645.54,-3051.08 3696.66,-3018 3712.02,-3008.06 3813.62,-2765.9 3848.17,-2682.74"/>
<polygon fill="black" stroke="black" points="3851.45,-2683.99 3852.05,-2673.41 3844.98,-2681.3 3851.45,-2683.99"/>
</g>
<!-- caption_io.write_caption&#45;&gt;serde_utils.write_json -->
<g id="edge119" class="edge">
<title>caption_io.write_caption&#45;&gt;serde_utils.write_json</title>
<path fill="none" stroke="black" d="M3347.7,-2960.97C3361.69,-2965.2 3375.22,-2971.29 3386.66,-2980 3414.8,-3001.44 3394.85,-3029.13 3422.66,-3051 3434.55,-3060.35 3448.71,-3067.04 3463.34,-3071.82"/>
<polygon fill="black" stroke="black" points="3462.41,-3075.19 3472.99,-3074.69 3464.41,-3068.48 3462.41,-3075.19"/>
</g>
<!-- caption_io.write_caption&#45;&gt;caption_io._get_langs -->
<g id="edge116" class="edge">
<title>caption_io.write_caption&#45;&gt;caption_io._get_langs</title>
<path fill="none" stroke="black" d="M3347.92,-2959.59C3463.01,-2965.42 3648.33,-2966.97 3696.66,-2921 3791.73,-2830.58 3644.02,-2724.73 3732.66,-2628 3741.82,-2618 3753.69,-2611.21 3766.49,-2606.67"/>
<polygon fill="black" stroke="black" points="3767.89,-2609.9 3776.43,-2603.63 3765.84,-2603.21 3767.89,-2609.9"/>
</g>
<!-- build_site._load_ontology -->
<g id="node98" class="node">
<title>build_site._load_ontology</title>
<g id="a_node98"><a xlink:title="Return sorted field list from ``ONTOLOGY`` or empty list when missing.">
<polygon fill="none" stroke="black" points="3052.66,-3285 2857.66,-3285 2857.66,-3249 3052.66,-3249 3052.66,-3285"/>
<text text-anchor="middle" x="2955.16" y="-3263.3" font-family="Times,serif" font-size="14.00">build_site._load_ontology</text>
</a>
</g>
</g>
<!-- build_site._load_ontology&#45;&gt;serde_utils.load_json -->
<g id="edge120" class="edge">
<title>build_site._load_ontology&#45;&gt;serde_utils.load_json</title>
<path fill="none" stroke="black" d="M3053.01,-3263.28C3162.28,-3260.77 3331.91,-3262.46 3386.66,-3294 3411.65,-3308.4 3397.23,-3334.39 3422.66,-3348 3476.34,-3376.73 3651.69,-3389.05 3696.66,-3348 3761.75,-3288.57 3711.12,-3038.47 3732.66,-2953 3759,-2848.49 3817.08,-2733.45 3844.61,-2682.21"/>
<polygon fill="black" stroke="black" points="3847.85,-2683.58 3849.54,-2673.12 3841.7,-2680.25 3847.85,-2683.58"/>
</g>
<!-- build_site._compile_locale -->
<g id="node99" class="node">
<title>build_site._compile_locale</title>
<g id="a_node99"><a xlink:title="Compile ``lang`` gettext catalogue when out of date.">
<polygon fill="none" stroke="black" points="3960.66,-3839 3760.66,-3839 3760.66,-3803 3960.66,-3803 3960.66,-3839"/>
<text text-anchor="middle" x="3860.66" y="-3817.3" font-family="Times,serif" font-size="14.00">build_site._compile_locale</text>
</a>
</g>
</g>
<!-- build_site._env_for_lang -->
<g id="node100" class="node">
<title>build_site._env_for_lang</title>
<g id="a_node100"><a xlink:title="Return Jinja environment configured for ``lang``.">
<polygon fill="none" stroke="black" points="3653.16,-3839 3466.16,-3839 3466.16,-3803 3653.16,-3803 3653.16,-3839"/>
<text text-anchor="middle" x="3559.66" y="-3817.3" font-family="Times,serif" font-size="14.00">build_site._env_for_lang</text>
</a>
</g>
</g>
<!-- build_site._env_for_lang&#45;&gt;build_site._compile_locale -->
<g id="edge121" class="edge">
<title>build_site._env_for_lang&#45;&gt;build_site._compile_locale</title>
<path fill="none" stroke="black" d="M3653.22,-3821C3683.94,-3821 3718.43,-3821 3750.29,-3821"/>
<polygon fill="black" stroke="black" points="3750.54,-3824.5 3760.54,-3821 3750.54,-3817.5 3750.54,-3824.5"/>
</g>
<!-- build_site._iter_lots -->
<g id="node101" class="node">
<title>build_site._iter_lots</title>
<g id="a_node101"><a xlink:title="Return all lots ready for rendering.">
<polygon fill="none" stroke="black" points="3330.16,-1521 3175.16,-1521 3175.16,-1485 3330.16,-1485 3330.16,-1521"/>
<text text-anchor="middle" x="3252.66" y="-1499.3" font-family="Times,serif" font-size="14.00">build_site._iter_lots</text>
</a>
</g>
</g>
<!-- build_site._iter_lots&#45;&gt;post_io.read_post -->
<g id="edge122" class="edge">
<title>build_site._iter_lots&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M3330.26,-1502.84C3351.05,-1499.05 3371.88,-1491.2 3386.66,-1476 3451.75,-1409.05 3357.42,-1335.81 3422.66,-1269 3437.4,-1253.9 3457.99,-1245.98 3478.7,-1242.09"/>
<polygon fill="black" stroke="black" points="3479.52,-1245.5 3488.85,-1240.49 3478.42,-1238.59 3479.52,-1245.5"/>
</g>
<!-- build_site._iter_lots&#45;&gt;post_io.raw_post_path -->
<g id="edge123" class="edge">
<title>build_site._iter_lots&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M3330.25,-1503.23C3351.17,-1499.48 3372.07,-1491.55 3386.66,-1476 3466.8,-1390.62 3359.79,-1313.79 3422.66,-1215 3441.39,-1185.56 3473.91,-1163.99 3502.46,-1149.57"/>
<polygon fill="black" stroke="black" points="3504.1,-1152.66 3511.56,-1145.14 3501.04,-1146.37 3504.1,-1152.66"/>
</g>
<!-- build_site._iter_lots&#45;&gt;moderation.should_skip_message -->
<g id="edge126" class="edge">
<title>build_site._iter_lots&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M3330.33,-1504.05C3351.51,-1500.38 3372.53,-1492.28 3386.66,-1476 3431.3,-1424.55 3412.43,-931.34 3422.66,-864 3453.5,-661 3524.7,-423.33 3549.75,-343.07"/>
<polygon fill="black" stroke="black" points="3553.18,-343.82 3552.83,-333.23 3546.5,-341.73 3553.18,-343.82"/>
</g>
<!-- build_site._iter_lots&#45;&gt;lot_io.read_lots -->
<g id="edge124" class="edge">
<title>build_site._iter_lots&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M3330.2,-1501.7C3351.5,-1505.35 3372.63,-1513.48 3386.66,-1530 3455.19,-1610.68 3386.98,-2382.34 3422.66,-2482 3445.13,-2544.76 3498.16,-2603.46 3530.96,-2635.58"/>
<polygon fill="black" stroke="black" points="3528.81,-2638.36 3538.44,-2642.78 3533.66,-2633.32 3528.81,-2638.36"/>
</g>
<!-- build_site._iter_lots&#45;&gt;lot_io.iter_lot_files -->
<g id="edge125" class="edge">
<title>build_site._iter_lots&#45;&gt;lot_io.iter_lot_files</title>
<path fill="none" stroke="black" d="M3330.43,-1506.1C3350.39,-1510.07 3370.74,-1517.28 3386.66,-1530 3417.12,-1554.34 3392.58,-1585.2 3422.66,-1610 3437.88,-1622.55 3457.15,-1630.35 3476.37,-1635.16"/>
<polygon fill="black" stroke="black" points="3475.87,-1638.64 3486.39,-1637.41 3477.4,-1631.81 3475.87,-1638.64"/>
</g>
<!-- moderation.should_skip_lot -->
<g id="node102" class="node">
<title>moderation.should_skip_lot</title>
<g id="a_node102"><a xlink:title="Return ``True`` when the lot fails additional checks.">
<polygon fill="none" stroke="black" points="3665.66,-1476 3453.66,-1476 3453.66,-1440 3665.66,-1440 3665.66,-1476"/>
<text text-anchor="middle" x="3559.66" y="-1454.3" font-family="Times,serif" font-size="14.00">moderation.should_skip_lot</text>
</a>
</g>
</g>
<!-- build_site._iter_lots&#45;&gt;moderation.should_skip_lot -->
<g id="edge127" class="edge">
<title>build_site._iter_lots&#45;&gt;moderation.should_skip_lot</title>
<path fill="none" stroke="black" d="M3330.23,-1491.7C3364.49,-1486.65 3405.61,-1480.58 3443.47,-1475"/>
<polygon fill="black" stroke="black" points="3444.15,-1478.43 3453.53,-1473.51 3443.13,-1471.51 3444.15,-1478.43"/>
</g>
<!-- moderation.lot_skip_reason -->
<g id="node145" class="node">
<title>moderation.lot_skip_reason</title>
<g id="a_node145"><a xlink:title="Return the moderation reason for ``lot`` or ``None``.">
<polygon fill="none" stroke="black" points="3966.66,-1476 3754.66,-1476 3754.66,-1440 3966.66,-1440 3966.66,-1476"/>
<text text-anchor="middle" x="3860.66" y="-1454.3" font-family="Times,serif" font-size="14.00">moderation.lot_skip_reason</text>
</a>
</g>
</g>
<!-- moderation.should_skip_lot&#45;&gt;moderation.lot_skip_reason -->
<g id="edge217" class="edge">
<title>moderation.should_skip_lot&#45;&gt;moderation.lot_skip_reason</title>
<path fill="none" stroke="black" d="M3666.07,-1458C3691.38,-1458 3718.54,-1458 3744.27,-1458"/>
<polygon fill="black" stroke="black" points="3744.44,-1461.5 3754.44,-1458 3744.44,-1454.5 3744.44,-1461.5"/>
</g>
<!-- build_site._copy_images -->
<g id="node103" class="node">
<title>build_site._copy_images</title>
<g id="a_node103"><a xlink:title="Copy media referenced by ``lots`` into ``VIEWS_DIR``.">
<polygon fill="none" stroke="black" points="3346.66,-3339 3158.66,-3339 3158.66,-3303 3346.66,-3303 3346.66,-3339"/>
<text text-anchor="middle" x="3252.66" y="-3317.3" font-family="Times,serif" font-size="14.00">build_site._copy_images</text>
</a>
</g>
</g>
<!-- build_site._copy_static -->
<g id="node104" class="node">
<title>build_site._copy_static</title>
<g id="a_node104"><a xlink:title="Copy CSS and JS so generated pages are standalone.">
<polygon fill="none" stroke="black" points="2766.16,-3869 2590.16,-3869 2590.16,-3833 2766.16,-3833 2766.16,-3869"/>
<text text-anchor="middle" x="2678.16" y="-3847.3" font-family="Times,serif" font-size="14.00">build_site._copy_static</text>
</a>
</g>
</g>
<!-- build_site._load_state -->
<g id="node105" class="node">
<title>build_site._load_state</title>
<g id="a_node105"><a xlink:title="Return ontology fields, embeddings, lots and similarity cache.">
<polygon fill="none" stroke="black" points="2763.16,-3266 2593.16,-3266 2593.16,-3230 2763.16,-3230 2763.16,-3266"/>
<text text-anchor="middle" x="2678.16" y="-3244.3" font-family="Times,serif" font-size="14.00">build_site._load_state</text>
</a>
</g>
</g>
<!-- build_site._load_state&#45;&gt;similar_utils._load_embeddings -->
<g id="edge131" class="edge">
<title>build_site._load_state&#45;&gt;similar_utils._load_embeddings</title>
<path fill="none" stroke="black" d="M2696.19,-3229.68C2750.88,-3172.27 2929.56,-2995.53 3118.66,-2926 3231.57,-2884.48 3267.68,-2905.77 3386.66,-2888 3402.38,-2885.65 3418.9,-2883.13 3435.23,-2880.6"/>
<polygon fill="black" stroke="black" points="3436.01,-2884.02 3445.36,-2879.03 3434.94,-2877.1 3436.01,-2884.02"/>
</g>
<!-- build_site._load_state&#45;&gt;build_site._load_ontology -->
<g id="edge128" class="edge">
<title>build_site._load_state&#45;&gt;build_site._load_ontology</title>
<path fill="none" stroke="black" d="M2763.16,-3253.8C2789.61,-3255.63 2819.19,-3257.67 2847.01,-3259.6"/>
<polygon fill="black" stroke="black" points="2846.96,-3263.1 2857.18,-3260.3 2847.44,-3256.12 2846.96,-3263.1"/>
</g>
<!-- build_site._load_state&#45;&gt;build_site._iter_lots -->
<g id="edge129" class="edge">
<title>build_site._load_state&#45;&gt;build_site._iter_lots</title>
<path fill="none" stroke="black" d="M2687.3,-3229.86C2709.16,-3180.13 2769,-3036.97 2791.66,-2911 2802.16,-2852.63 2792.92,-1892.08 2827.66,-1844 2898.4,-1746.09 3005.78,-1843.16 3082.66,-1750 3145.72,-1673.58 3049.95,-1601.38 3118.66,-1530 3130.95,-1517.23 3147.51,-1509.63 3164.76,-1505.27"/>
<polygon fill="black" stroke="black" points="3165.93,-1508.6 3174.97,-1503.06 3164.45,-1501.76 3165.93,-1508.6"/>
</g>
<!-- build_site._load_state&#45;&gt;build_site._copy_images -->
<g id="edge130" class="edge">
<title>build_site._load_state&#45;&gt;build_site._copy_images</title>
<path fill="none" stroke="black" d="M2697.82,-3266.1C2724.19,-3290.28 2775.04,-3331.94 2827.66,-3348 2936.05,-3381.09 2969.68,-3356.97 3082.66,-3348 3104.11,-3346.3 3126.94,-3343.4 3148.66,-3340.11"/>
<polygon fill="black" stroke="black" points="3149.21,-3343.57 3158.56,-3338.58 3148.14,-3336.65 3149.21,-3343.57"/>
</g>
<!-- similar_utils._load_similar -->
<g id="node106" class="node">
<title>similar_utils._load_similar</title>
<g id="a_node106"><a xlink:title="Return cached similar lots mapping.">
<polygon fill="none" stroke="black" points="3660.66,-3339 3458.66,-3339 3458.66,-3303 3660.66,-3303 3660.66,-3339"/>
<text text-anchor="middle" x="3559.66" y="-3317.3" font-family="Times,serif" font-size="14.00">similar_utils._load_similar</text>
</a>
</g>
</g>
<!-- build_site._load_state&#45;&gt;similar_utils._load_similar -->
<g id="edge132" class="edge">
<title>build_site._load_state&#45;&gt;similar_utils._load_similar</title>
<path fill="none" stroke="black" d="M2763.34,-3241.71C2925.96,-3230.83 3276.94,-3213.91 3386.66,-3261 3406.6,-3269.56 3403.3,-3284.19 3422.66,-3294 3430.86,-3298.15 3439.64,-3301.67 3448.64,-3304.65"/>
<polygon fill="black" stroke="black" points="3447.9,-3308.08 3458.48,-3307.67 3449.95,-3301.39 3447.9,-3308.08"/>
</g>
<!-- similar_utils._load_similar&#45;&gt;serde_utils.load_json -->
<g id="edge235" class="edge">
<title>similar_utils._load_similar&#45;&gt;serde_utils.load_json</title>
<path fill="none" stroke="black" d="M3660.96,-3316.39C3674.49,-3311.7 3687,-3304.58 3696.66,-3294 3748.04,-3237.73 3713.51,-3026.75 3732.66,-2953 3759.74,-2848.68 3817.45,-2733.54 3844.75,-2682.25"/>
<polygon fill="black" stroke="black" points="3847.99,-2683.61 3849.64,-2673.15 3841.82,-2680.3 3847.99,-2683.61"/>
</g>
<!-- build_site._categorise -->
<g id="node107" class="node">
<title>build_site._categorise</title>
<g id="a_node107"><a xlink:title="Return category info and recent lot list.">
<polygon fill="none" stroke="black" points="3040.66,-3709 2869.66,-3709 2869.66,-3673 3040.66,-3673 3040.66,-3709"/>
<text text-anchor="middle" x="2955.16" y="-3687.3" font-family="Times,serif" font-size="14.00">build_site._categorise</text>
</a>
</g>
</g>
<!-- build_site._categorise&#45;&gt;lot_io.get_seller -->
<g id="edge133" class="edge">
<title>build_site._categorise&#45;&gt;lot_io.get_seller</title>
<path fill="none" stroke="black" d="M3040.86,-3694.22C3128.37,-3695.79 3268.48,-3693.4 3386.66,-3669 3430.15,-3660.02 3477.28,-3641.84 3511.18,-3627.15"/>
<polygon fill="black" stroke="black" points="3512.64,-3630.33 3520.38,-3623.11 3509.82,-3623.92 3512.64,-3630.33"/>
</g>
<!-- build_site._render_site -->
<g id="node108" class="node">
<title>build_site._render_site</title>
<g id="a_node108"><a xlink:title="Render all HTML pages for ``lots`` using cached templates.">
<polygon fill="none" stroke="black" points="3044.16,-3655 2866.16,-3655 2866.16,-3619 3044.16,-3619 3044.16,-3655"/>
<text text-anchor="middle" x="2955.16" y="-3633.3" font-family="Times,serif" font-size="14.00">build_site._render_site</text>
</a>
</g>
</g>
<!-- build_site._render_site&#45;&gt;serde_utils.read_text -->
<g id="edge136" class="edge">
<title>build_site._render_site&#45;&gt;serde_utils.read_text</title>
<path fill="none" stroke="black" d="M3039.94,-3655.03C3071.29,-3661.45 3103.06,-3667.48 3118.66,-3669 3237.21,-3680.56 3267.76,-3676.07 3386.66,-3669 3673.69,-3651.93 3845.21,-3681.21 3988.66,-3432 4039.55,-3343.59 4122.52,-1720.48 4134.26,-1486.11"/>
<polygon fill="black" stroke="black" points="4137.76,-1486.17 4134.77,-1476.01 4130.77,-1485.82 4137.76,-1486.17"/>
</g>
<!-- build_site._render_site&#45;&gt;lot_io.get_seller -->
<g id="edge134" class="edge">
<title>build_site._render_site&#45;&gt;lot_io.get_seller</title>
<path fill="none" stroke="black" d="M3044.38,-3648.22C3131.69,-3657.37 3268.96,-3666.47 3386.66,-3651 3423.46,-3646.16 3463.58,-3635.74 3495.81,-3626.04"/>
<polygon fill="black" stroke="black" points="3497.01,-3629.34 3505.54,-3623.06 3494.96,-3622.64 3497.01,-3629.34"/>
</g>
<!-- build_site.build_page -->
<g id="node109" class="node">
<title>build_site.build_page</title>
<g id="a_node109"><a xlink:title="Render ``lot`` into separate HTML files for every language.">
<polygon fill="none" stroke="black" points="3336.16,-2511 3169.16,-2511 3169.16,-2475 3336.16,-2475 3336.16,-2511"/>
<text text-anchor="middle" x="3252.66" y="-2489.3" font-family="Times,serif" font-size="14.00">build_site.build_page</text>
</a>
</g>
</g>
<!-- build_site._render_site&#45;&gt;build_site.build_page -->
<g id="edge135" class="edge">
<title>build_site._render_site&#45;&gt;build_site.build_page</title>
<path fill="none" stroke="black" d="M2999.81,-3618.94C3028.84,-3604.4 3064.8,-3580.93 3082.66,-3548 3135.14,-3451.25 3058.68,-2650.3 3118.66,-2558 3131.22,-2538.67 3151.32,-2524.9 3172.12,-2515.17"/>
<polygon fill="black" stroke="black" points="3173.63,-2518.33 3181.38,-2511.12 3170.82,-2511.92 3173.63,-2518.33"/>
</g>
<!-- similar_utils._format_vector -->
<g id="node110" class="node">
<title>similar_utils._format_vector</title>
<g id="a_node110"><a xlink:title="Return compact JSON representation for ``vec``.">
<polygon fill="none" stroke="black" points="3667.16,-3009 3452.16,-3009 3452.16,-2973 3667.16,-2973 3667.16,-3009"/>
<text text-anchor="middle" x="3559.66" y="-2987.3" font-family="Times,serif" font-size="14.00">similar_utils._format_vector</text>
</a>
</g>
</g>
<!-- build_site._render_site&#45;&gt;similar_utils._format_vector -->
<g id="edge137" class="edge">
<title>build_site._render_site&#45;&gt;similar_utils._format_vector</title>
<path fill="none" stroke="black" d="M3044.58,-3639.27C3163.48,-3641.39 3362.85,-3641.34 3386.66,-3618 3476.02,-3530.39 3352.57,-3159.68 3422.66,-3056 3435.74,-3036.64 3456.25,-3022.88 3477.4,-3013.17"/>
<polygon fill="black" stroke="black" points="3479.01,-3016.28 3486.81,-3009.11 3476.24,-3009.85 3479.01,-3016.28"/>
</g>
<!-- build_site.build_page&#45;&gt;post_io.read_post -->
<g id="edge138" class="edge">
<title>build_site.build_page&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M3336.17,-2493.23C3355.42,-2489.15 3373.98,-2481.04 3386.66,-2466 3472.41,-2364.25 3336.69,-1370.56 3422.66,-1269 3436.62,-1252.5 3457.52,-1244.26 3478.77,-1240.5"/>
<polygon fill="black" stroke="black" points="3479.47,-1243.94 3488.86,-1239.04 3478.47,-1237.01 3479.47,-1243.94"/>
</g>
<!-- build_site.build_page&#45;&gt;post_io.raw_post_path -->
<g id="edge139" class="edge">
<title>build_site.build_page&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M3336.18,-2493.25C3355.44,-2489.16 3373.99,-2481.05 3386.66,-2466 3476.2,-2359.61 3354.45,-1336.18 3422.66,-1215 3439.52,-1185.03 3471.3,-1163.62 3499.9,-1149.42"/>
<polygon fill="black" stroke="black" points="3501.53,-1152.52 3509.05,-1145.06 3498.52,-1146.2 3501.53,-1152.52"/>
</g>
<!-- build_site.build_page&#45;&gt;caption_io.read_caption -->
<g id="edge140" class="edge">
<title>build_site.build_page&#45;&gt;caption_io.read_caption</title>
<path fill="none" stroke="black" d="M3336.37,-2486.48C3354,-2482.37 3371.77,-2475.95 3386.66,-2466 3409.14,-2450.98 3503.71,-2300.11 3542.23,-2237.75"/>
<polygon fill="black" stroke="black" points="3545.22,-2239.57 3547.49,-2229.22 3539.26,-2235.9 3545.22,-2239.57"/>
</g>
<!-- build_site.build_page&#45;&gt;build_site._env_for_lang -->
<g id="edge141" class="edge">
<title>build_site.build_page&#45;&gt;build_site._env_for_lang</title>
<path fill="none" stroke="black" d="M3323.97,-2511.09C3347.92,-2520.92 3372.27,-2535.78 3386.66,-2558 3451.58,-2658.21 3384.12,-3518.99 3422.66,-3632 3445.34,-3698.52 3499.94,-3761.85 3532.64,-3795.65"/>
<polygon fill="black" stroke="black" points="3530.16,-3798.12 3539.66,-3802.8 3535.15,-3793.22 3530.16,-3798.12"/>
</g>
<!-- build_site.build_page&#45;&gt;similar_utils._format_vector -->
<g id="edge142" class="edge">
<title>build_site.build_page&#45;&gt;similar_utils._format_vector</title>
<path fill="none" stroke="black" d="M3321.7,-2511.12C3345.98,-2521.02 3371.15,-2535.92 3386.66,-2558 3471.47,-2678.72 3349.91,-2759.65 3422.66,-2888 3442.73,-2923.41 3480.45,-2950.49 3511.08,-2967.97"/>
<polygon fill="black" stroke="black" points="3509.48,-2971.09 3519.92,-2972.87 3512.87,-2964.96 3509.48,-2971.09"/>
</g>
<!-- build_site.main -->
<g id="node111" class="node">
<title>build_site.main</title>
<g id="a_node111"><a xlink:title="Build the static site under ``VIEWS_DIR``.">
<polygon fill="none" stroke="black" points="2479.66,-3655 2354.66,-3655 2354.66,-3619 2479.66,-3619 2479.66,-3655"/>
<text text-anchor="middle" x="2417.16" y="-3633.3" font-family="Times,serif" font-size="14.00">build_site.main</text>
</a>
</g>
</g>
<!-- build_site.main&#45;&gt;config_utils.load_config -->
<g id="edge148" class="edge">
<title>build_site.main&#45;&gt;config_utils.load_config</title>
<path fill="none" stroke="black" d="M2421.41,-3655.11C2431.81,-3707.39 2469.31,-3859.47 2564.66,-3933 2704.61,-4040.92 2777.43,-4013 2954.16,-4013 2954.16,-4013 2954.16,-4013 3560.66,-4013 3639.45,-4013 3929.27,-3914.5 3988.66,-3848 4126.37,-3693.8 4136.76,-3423.03 4136.3,-3335.3"/>
<polygon fill="black" stroke="black" points="4139.8,-3335.03 4136.19,-3325.07 4132.8,-3335.1 4139.8,-3335.03"/>
</g>
<!-- build_site.main&#45;&gt;build_site._env_for_lang -->
<g id="edge143" class="edge">
<title>build_site.main&#45;&gt;build_site._env_for_lang</title>
<path fill="none" stroke="black" d="M2423.34,-3655.26C2437.43,-3701.28 2481.13,-3822.34 2564.66,-3878 2870.4,-4081.72 3353.66,-3907.86 3508.9,-3842.97"/>
<polygon fill="black" stroke="black" points="3510.36,-3846.16 3518.21,-3839.05 3507.64,-3839.71 3510.36,-3846.16"/>
</g>
<!-- build_site.main&#45;&gt;build_site._copy_static -->
<g id="edge144" class="edge">
<title>build_site.main&#45;&gt;build_site._copy_static</title>
<path fill="none" stroke="black" d="M2427.02,-3655.22C2446.39,-3693.03 2496.3,-3780.1 2564.66,-3824 2569.64,-3827.2 2574.96,-3830.02 2580.49,-3832.5"/>
<polygon fill="black" stroke="black" points="2579.36,-3835.83 2589.94,-3836.38 2582.02,-3829.35 2579.36,-3835.83"/>
</g>
<!-- build_site.main&#45;&gt;build_site._load_state -->
<g id="edge145" class="edge">
<title>build_site.main&#45;&gt;build_site._load_state</title>
<path fill="none" stroke="black" d="M2428.65,-3618.74C2452,-3578.4 2510.46,-3478.91 2564.66,-3399 2595.06,-3354.19 2633.22,-3304.14 2656.37,-3274.4"/>
<polygon fill="black" stroke="black" points="2659.37,-3276.25 2662.77,-3266.21 2653.85,-3271.94 2659.37,-3276.25"/>
</g>
<!-- build_site.main&#45;&gt;build_site._categorise -->
<g id="edge146" class="edge">
<title>build_site.main&#45;&gt;build_site._categorise</title>
<path fill="none" stroke="black" d="M2479.91,-3643.22C2572.94,-3652.59 2749.78,-3670.41 2859.26,-3681.44"/>
<polygon fill="black" stroke="black" points="2859.01,-3684.93 2869.31,-3682.45 2859.71,-3677.97 2859.01,-3684.93"/>
</g>
<!-- build_site.main&#45;&gt;build_site._render_site -->
<g id="edge147" class="edge">
<title>build_site.main&#45;&gt;build_site._render_site</title>
<path fill="none" stroke="black" d="M2479.91,-3637C2572,-3637 2746.23,-3637 2855.94,-3637"/>
<polygon fill="black" stroke="black" points="2856.02,-3640.5 2866.02,-3637 2856.02,-3633.5 2856.02,-3640.5"/>
</g>
<!-- similar_utils._save_similar -->
<g id="node112" class="node">
<title>similar_utils._save_similar</title>
<g id="a_node112"><a xlink:title="Write ``sim_map`` to ``SIMILAR_DIR`` mirroring ``LOTS_DIR`` layout.">
<polygon fill="none" stroke="black" points="3354.66,-3155 3150.66,-3155 3150.66,-3119 3354.66,-3119 3354.66,-3155"/>
<text text-anchor="middle" x="3252.66" y="-3133.3" font-family="Times,serif" font-size="14.00">similar_utils._save_similar</text>
</a>
</g>
</g>
<!-- build_site.main&#45;&gt;similar_utils._save_similar -->
<g id="edge149" class="edge">
<title>build_site.main&#45;&gt;similar_utils._save_similar</title>
<path fill="none" stroke="black" d="M2418.25,-3618.63C2419.67,-3552.43 2434.21,-3324.54 2564.66,-3221 2655.37,-3149 2967.89,-3179.47 3082.66,-3164 3101.34,-3161.48 3121.14,-3158.55 3140.36,-3155.57"/>
<polygon fill="black" stroke="black" points="3141.01,-3159.01 3150.35,-3154.01 3139.93,-3152.1 3141.01,-3159.01"/>
</g>
<!-- similar_utils._prune_similar -->
<g id="node113" class="node">
<title>similar_utils._prune_similar</title>
<g id="a_node113"><a xlink:title="Drop cache entries referring to ids not in ``valid_ids``.">
<polygon fill="none" stroke="black" points="3359.66,-3609 3145.66,-3609 3145.66,-3573 3359.66,-3573 3359.66,-3609"/>
<text text-anchor="middle" x="3252.66" y="-3587.3" font-family="Times,serif" font-size="14.00">similar_utils._prune_similar</text>
</a>
</g>
</g>
<!-- build_site.main&#45;&gt;similar_utils._prune_similar -->
<g id="edge150" class="edge">
<title>build_site.main&#45;&gt;similar_utils._prune_similar</title>
<path fill="none" stroke="black" d="M2479.88,-3632.52C2560.01,-3626.81 2704.23,-3616.83 2827.66,-3610 2931.59,-3604.25 3049.92,-3599.06 3135.11,-3595.56"/>
<polygon fill="black" stroke="black" points="3135.49,-3599.05 3145.34,-3595.14 3135.2,-3592.06 3135.49,-3599.05"/>
</g>
<!-- similar_utils._calc_similar_nn -->
<g id="node114" class="node">
<title>similar_utils._calc_similar_nn</title>
<g id="a_node114"><a xlink:title="Fill ``sim_map`` for ``new_ids`` using a nearest neighbour search.&#10;&#10;``vec_ids`` lists all lots that have an embedding. &#160;``new_ids`` is a subset&#10;for which we still need recommendations. &#160;We gather vectors for&#10;``vec_ids`` and use ``NearestNeighbors`` from scikit&#45;learn to find the&#10;closest items. &#160;Embeddings of lots without a vector are skipped.">
<polygon fill="none" stroke="black" points="2790.16,-3757 2566.16,-3757 2566.16,-3721 2790.16,-3721 2790.16,-3757"/>
<text text-anchor="middle" x="2678.16" y="-3735.3" font-family="Times,serif" font-size="14.00">similar_utils._calc_similar_nn</text>
</a>
</g>
</g>
<!-- build_site.main&#45;&gt;similar_utils._calc_similar_nn -->
<g id="edge151" class="edge">
<title>build_site.main&#45;&gt;similar_utils._calc_similar_nn</title>
<path fill="none" stroke="black" d="M2458.94,-3655.02C2488.19,-3667.75 2528.62,-3684.98 2564.66,-3699 2580.81,-3705.28 2598.41,-3711.73 2614.78,-3717.56"/>
<polygon fill="black" stroke="black" points="2613.67,-3720.88 2624.27,-3720.91 2616.01,-3714.28 2613.67,-3720.88"/>
</g>
<!-- similar_utils._sync_embeddings -->
<g id="node115" class="node">
<title>similar_utils._sync_embeddings</title>
<g id="a_node115"><a xlink:title="Drop lots or vectors that do not match and return cleaned data.">
<polygon fill="none" stroke="black" points="3076.16,-3431 2834.16,-3431 2834.16,-3395 3076.16,-3395 3076.16,-3431"/>
<text text-anchor="middle" x="2955.16" y="-3409.3" font-family="Times,serif" font-size="14.00">similar_utils._sync_embeddings</text>
</a>
</g>
</g>
<!-- build_site.main&#45;&gt;similar_utils._sync_embeddings -->
<g id="edge152" class="edge">
<title>build_site.main&#45;&gt;similar_utils._sync_embeddings</title>
<path fill="none" stroke="black" d="M2449.19,-3618.88C2516.13,-3580.51 2680.03,-3490.46 2827.66,-3440 2834.15,-3437.78 2840.9,-3435.7 2847.75,-3433.77"/>
<polygon fill="black" stroke="black" points="2849.1,-3437.03 2857.84,-3431.04 2847.27,-3430.28 2849.1,-3437.03"/>
</g>
<!-- similar_utils._similar_by_user -->
<g id="node116" class="node">
<title>similar_utils._similar_by_user</title>
<g id="a_node116"><a xlink:title="Return map of lot id to other lots from the same user.">
<polygon fill="none" stroke="black" points="3366.16,-2349 3139.16,-2349 3139.16,-2313 3366.16,-2313 3366.16,-2349"/>
<text text-anchor="middle" x="3252.66" y="-2327.3" font-family="Times,serif" font-size="14.00">similar_utils._similar_by_user</text>
</a>
</g>
</g>
<!-- build_site.main&#45;&gt;similar_utils._similar_by_user -->
<g id="edge153" class="edge">
<title>build_site.main&#45;&gt;similar_utils._similar_by_user</title>
<path fill="none" stroke="black" d="M2418.58,-3618.83C2421.23,-3530.88 2439.82,-3141.9 2564.66,-2857 2643.18,-2677.8 2677.74,-2629.7 2827.66,-2504 2938.54,-2411.03 2981.89,-2405.25 3118.66,-2358 3125.17,-2355.75 3131.92,-2353.66 3138.79,-2351.73"/>
<polygon fill="black" stroke="black" points="3140.15,-2354.99 3148.9,-2349.01 3138.33,-2348.23 3140.15,-2354.99"/>
</g>
<!-- price_utils.apply_price_model -->
<g id="node117" class="node">
<title>price_utils.apply_price_model</title>
<g id="a_node117"><a xlink:title="Predict prices in USD and guess missing currencies.">
<polygon fill="none" stroke="black" points="2791.66,-3815 2564.66,-3815 2564.66,-3779 2791.66,-3779 2791.66,-3815"/>
<text text-anchor="middle" x="2678.16" y="-3793.3" font-family="Times,serif" font-size="14.00">price_utils.apply_price_model</text>
</a>
</g>
</g>
<!-- build_site.main&#45;&gt;price_utils.apply_price_model -->
<g id="edge154" class="edge">
<title>build_site.main&#45;&gt;price_utils.apply_price_model</title>
<path fill="none" stroke="black" d="M2433.79,-3655.29C2458.68,-3683.27 2510.1,-3736.52 2564.66,-3766 2571.09,-3769.48 2577.95,-3772.59 2584.98,-3775.37"/>
<polygon fill="black" stroke="black" points="2584.06,-3778.76 2594.65,-3778.96 2586.49,-3772.2 2584.06,-3778.76"/>
</g>
<!-- similar_utils._save_similar&#45;&gt;serde_utils.write_json -->
<g id="edge237" class="edge">
<title>similar_utils._save_similar&#45;&gt;serde_utils.write_json</title>
<path fill="none" stroke="black" d="M3354.8,-3119.09C3389.67,-3112.92 3428.61,-3106.02 3463.04,-3099.93"/>
<polygon fill="black" stroke="black" points="3463.85,-3103.34 3473.09,-3098.15 3462.63,-3096.45 3463.85,-3103.34"/>
</g>
<!-- similar_utils._save_similar&#45;&gt;lot_io.lot_json_path -->
<g id="edge236" class="edge">
<title>similar_utils._save_similar&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M3291.43,-3118.92C3322.74,-3101.76 3365.42,-3072.81 3386.66,-3034 3472.36,-2877.42 3358.15,-2800.43 3422.66,-2634 3446.81,-2571.67 3499.52,-2512.62 3531.76,-2480.36"/>
<polygon fill="black" stroke="black" points="3534.43,-2482.65 3539.1,-2473.13 3529.52,-2477.66 3534.43,-2482.65"/>
</g>
<!-- similar_utils._similar_path -->
<g id="node150" class="node">
<title>similar_utils._similar_path</title>
<g id="a_node150"><a xlink:title="Return cache file path for ``lot_path`` under ``SIMILAR_DIR``.">
<polygon fill="none" stroke="black" points="3661.66,-3155 3457.66,-3155 3457.66,-3119 3661.66,-3119 3661.66,-3155"/>
<text text-anchor="middle" x="3559.66" y="-3133.3" font-family="Times,serif" font-size="14.00">similar_utils._similar_path</text>
</a>
</g>
</g>
<!-- similar_utils._save_similar&#45;&gt;similar_utils._similar_path -->
<g id="edge238" class="edge">
<title>similar_utils._save_similar&#45;&gt;similar_utils._similar_path</title>
<path fill="none" stroke="black" d="M3354.8,-3137C3384.47,-3137 3417.09,-3137 3447.37,-3137"/>
<polygon fill="black" stroke="black" points="3447.54,-3140.5 3457.54,-3137 3447.54,-3133.5 3447.54,-3140.5"/>
</g>
<!-- similar_utils._update_reciprocal -->
<g id="node151" class="node">
<title>similar_utils._update_reciprocal</title>
<g id="a_node151"><a xlink:title="Insert ``lot_id`` into caches of lots listed in ``sims`` if closer.">
<polygon fill="none" stroke="black" points="3076.66,-3763 2833.66,-3763 2833.66,-3727 3076.66,-3727 3076.66,-3763"/>
<text text-anchor="middle" x="2955.16" y="-3741.3" font-family="Times,serif" font-size="14.00">similar_utils._update_reciprocal</text>
</a>
</g>
</g>
<!-- similar_utils._calc_similar_nn&#45;&gt;similar_utils._update_reciprocal -->
<g id="edge239" class="edge">
<title>similar_utils._calc_similar_nn&#45;&gt;similar_utils._update_reciprocal</title>
<path fill="none" stroke="black" d="M2790.22,-3741.42C2801.06,-3741.66 2812.13,-3741.9 2823.15,-3742.14"/>
<polygon fill="black" stroke="black" points="2823.16,-3745.64 2833.24,-3742.36 2823.32,-3738.64 2823.16,-3745.64"/>
</g>
<!-- similar_utils._similar_by_user&#45;&gt;similar_utils._cos_sim -->
<g id="edge240" class="edge">
<title>similar_utils._similar_by_user&#45;&gt;similar_utils._cos_sim</title>
<path fill="none" stroke="black" d="M3366.29,-2319.72C3373.88,-2315.63 3380.81,-2310.47 3386.66,-2304 3494.22,-2185.07 3314.84,-2063.7 3422.66,-1945 3433.65,-1932.9 3448.38,-1925.32 3464.09,-1920.71"/>
<polygon fill="black" stroke="black" points="3465.14,-1924.06 3473.97,-1918.21 3463.42,-1917.27 3465.14,-1924.06"/>
</g>
<!-- price_utils.train_price_regression -->
<g id="node164" class="node">
<title>price_utils.train_price_regression</title>
<g id="a_node164"><a xlink:title="Return ``(model, currency_map, counts)`` trained on ``lots``.&#10;&#10;``lots`` must contain ``price`` and ``price:currency`` fields. Only lots with&#10;embeddings present in ``id_to_vec`` are considered. Prices are regressed on&#10;the logarithm scale so coefficients are interpretable as multiplicative&#10;factors. ``USD`` is treated as the base currency so coefficients can be&#10;interpreted as exchange rate multipliers. The returned ``counts`` dictionary&#10;maps each currency to the number of training samples observed.">
<polygon fill="none" stroke="black" points="3082.66,-3855 2827.66,-3855 2827.66,-3819 3082.66,-3819 3082.66,-3855"/>
<text text-anchor="middle" x="2955.16" y="-3833.3" font-family="Times,serif" font-size="14.00">price_utils.train_price_regression</text>
</a>
</g>
</g>
<!-- price_utils.apply_price_model&#45;&gt;price_utils.train_price_regression -->
<g id="edge261" class="edge">
<title>price_utils.apply_price_model&#45;&gt;price_utils.train_price_regression</title>
<path fill="none" stroke="black" d="M2791.81,-3813.38C2801.06,-3814.73 2810.48,-3816.1 2819.87,-3817.47"/>
<polygon fill="black" stroke="black" points="2819.65,-3820.97 2830.05,-3818.95 2820.66,-3814.04 2819.65,-3820.97"/>
</g>
<!-- price_utils.predict_price -->
<g id="node165" class="node">
<title>price_utils.predict_price</title>
<g id="a_node165"><a xlink:title="Return predicted price for ``vec`` in ``currency``.&#10;&#10;When ``model`` is ``None`` or ``vec`` is missing, ``None`` is returned.">
<polygon fill="none" stroke="black" points="3347.16,-3815 3158.16,-3815 3158.16,-3779 3347.16,-3779 3347.16,-3815"/>
<text text-anchor="middle" x="3252.66" y="-3793.3" font-family="Times,serif" font-size="14.00">price_utils.predict_price</text>
</a>
</g>
</g>
<!-- price_utils.apply_price_model&#45;&gt;price_utils.predict_price -->
<g id="edge262" class="edge">
<title>price_utils.apply_price_model&#45;&gt;price_utils.predict_price</title>
<path fill="none" stroke="black" d="M2791.92,-3797C2895.38,-3797 3047.38,-3797 3147.9,-3797"/>
<polygon fill="black" stroke="black" points="3148.07,-3800.5 3158.07,-3797 3148.07,-3793.5 3148.07,-3800.5"/>
</g>
<!-- price_utils.currency_rates -->
<g id="node166" class="node">
<title>price_utils.currency_rates</title>
<g id="a_node166"><a xlink:title="Return estimated currency multipliers relative to the base.&#10;&#10;The regression model learns one coefficient per currency dummy feature. &#160;The&#10;coefficient is the logarithm of the multiplier relative to USD.">
<polygon fill="none" stroke="black" points="3660.66,-3955 3458.66,-3955 3458.66,-3919 3660.66,-3919 3660.66,-3955"/>
<text text-anchor="middle" x="3559.66" y="-3933.3" font-family="Times,serif" font-size="14.00">price_utils.currency_rates</text>
</a>
</g>
</g>
<!-- price_utils.apply_price_model&#45;&gt;price_utils.currency_rates -->
<g id="edge263" class="edge">
<title>price_utils.apply_price_model&#45;&gt;price_utils.currency_rates</title>
<path fill="none" stroke="black" d="M2779.17,-3815.03C2783.61,-3817.65 2787.81,-3820.62 2791.66,-3824 2825.28,-3853.51 2791.13,-3892.17 2827.66,-3918 2924.49,-3986.48 3269.37,-3965.12 3448.64,-3948.58"/>
<polygon fill="black" stroke="black" points="3449,-3952.06 3458.63,-3947.65 3448.34,-3945.09 3449,-3952.06"/>
</g>
<!-- price_utils.guess_currency -->
<g id="node167" class="node">
<title>price_utils.guess_currency</title>
<g id="a_node167"><a xlink:title="Return currency with multiplier closest to ``price/pred_usd``.&#10;&#10;``pred_usd`` is the predicted price in USD. &#160;``price`` is the numeric value&#10;provided by the user without a currency. &#160;The function compares the implied&#10;multiplier ``price / pred_usd`` against the learnt exchange rates and picks&#10;the closest match. &#160;``counts`` may be provided to ignore rarely seen&#10;currencies when guessing. &#160;Any currency with fewer than ``min_samples``&#10;samples in the training set is skipped.">
<polygon fill="none" stroke="black" points="3058.16,-3909 2852.16,-3909 2852.16,-3873 3058.16,-3873 3058.16,-3909"/>
<text text-anchor="middle" x="2955.16" y="-3887.3" font-family="Times,serif" font-size="14.00">price_utils.guess_currency</text>
</a>
</g>
</g>
<!-- price_utils.apply_price_model&#45;&gt;price_utils.guess_currency -->
<g id="edge264" class="edge">
<title>price_utils.apply_price_model&#45;&gt;price_utils.guess_currency</title>
<path fill="none" stroke="black" d="M2773.57,-3815.05C2779.87,-3817.65 2785.96,-3820.61 2791.66,-3824 2812.21,-3836.23 2806.95,-3852.03 2827.66,-3864 2832.4,-3866.74 2837.38,-3869.2 2842.52,-3871.42"/>
<polygon fill="black" stroke="black" points="2841.33,-3874.71 2851.92,-3875.14 2843.91,-3868.2 2841.33,-3874.71"/>
</g>
<!-- message_utils.build_prompt -->
<g id="node118" class="node">
<title>message_utils.build_prompt</title>
<g id="a_node118"><a xlink:title="Return prompt combining message text with captioned file names.">
<polygon fill="none" stroke="black" points="3668.16,-1990 3451.16,-1990 3451.16,-1954 3668.16,-1954 3668.16,-1990"/>
<text text-anchor="middle" x="3559.66" y="-1968.3" font-family="Times,serif" font-size="14.00">message_utils.build_prompt</text>
</a>
</g>
</g>
<!-- message_utils.gather_chop_input -->
<g id="node119" class="node">
<title>message_utils.gather_chop_input</title>
<g id="a_node119"><a xlink:title="Return the exact text fed to the lot parser for ``msg_path``.">
<polygon fill="none" stroke="black" points="3379.66,-2019 3125.66,-2019 3125.66,-1983 3379.66,-1983 3379.66,-2019"/>
<text text-anchor="middle" x="3252.66" y="-1997.3" font-family="Times,serif" font-size="14.00">message_utils.gather_chop_input</text>
</a>
</g>
</g>
<!-- message_utils.gather_chop_input&#45;&gt;post_io.read_post -->
<g id="edge156" class="edge">
<title>message_utils.gather_chop_input&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M3292.06,-1982.93C3323.54,-1965.85 3366.12,-1937.02 3386.66,-1898 3451.87,-1774.11 3330.76,-1374.63 3422.66,-1269 3436.84,-1252.69 3457.81,-1244.51 3479.05,-1240.74"/>
<polygon fill="black" stroke="black" points="3479.74,-1244.18 3489.14,-1239.28 3478.74,-1237.25 3479.74,-1244.18"/>
</g>
<!-- message_utils.gather_chop_input&#45;&gt;caption_io.read_caption -->
<g id="edge157" class="edge">
<title>message_utils.gather_chop_input&#45;&gt;caption_io.read_caption</title>
<path fill="none" stroke="black" d="M3375.74,-2019.15C3379.62,-2021.77 3383.28,-2024.71 3386.66,-2028 3437.64,-2077.64 3371.57,-2134.47 3422.66,-2184 3432.46,-2193.51 3444.6,-2200.13 3457.56,-2204.67"/>
<polygon fill="black" stroke="black" points="3456.52,-2208.01 3467.11,-2207.62 3458.59,-2201.33 3456.52,-2208.01"/>
</g>
<!-- message_utils.gather_chop_input&#45;&gt;message_utils.build_prompt -->
<g id="edge158" class="edge">
<title>message_utils.gather_chop_input&#45;&gt;message_utils.build_prompt</title>
<path fill="none" stroke="black" d="M3379.92,-1989C3400.1,-1987.08 3420.92,-1985.1 3440.9,-1983.2"/>
<polygon fill="black" stroke="black" points="3441.33,-1986.67 3450.95,-1982.24 3440.67,-1979.7 3441.33,-1986.67"/>
</g>
<!-- clean_data._parse_date -->
<g id="node120" class="node">
<title>clean_data._parse_date</title>
<g id="a_node120"><a xlink:title="Return the ``date`` field from a markdown file if present.">
<polygon fill="none" stroke="black" points="3650.66,-1530 3468.66,-1530 3468.66,-1494 3650.66,-1494 3650.66,-1530"/>
<text text-anchor="middle" x="3559.66" y="-1508.3" font-family="Times,serif" font-size="14.00">clean_data._parse_date</text>
</a>
</g>
</g>
<!-- clean_data._parse_date&#45;&gt;serde_utils.read_text -->
<g id="edge159" class="edge">
<title>clean_data._parse_date&#45;&gt;serde_utils.read_text</title>
<path fill="none" stroke="black" d="M3650.71,-1509.42C3737.52,-1506.21 3872.46,-1499.29 3988.66,-1485 4006.37,-1482.82 4025.17,-1479.87 4043.2,-1476.71"/>
<polygon fill="black" stroke="black" points="4043.9,-1480.14 4053.13,-1474.94 4042.67,-1473.25 4043.9,-1480.14"/>
</g>
<!-- clean_data._clean_raw -->
<g id="node121" class="node">
<title>clean_data._clean_raw</title>
<g id="a_node121"><a xlink:title="Delete raw posts older than ``cutoff``.">
<polygon fill="none" stroke="black" points="3340.16,-1283 3165.16,-1283 3165.16,-1247 3340.16,-1247 3340.16,-1283"/>
<text text-anchor="middle" x="3252.66" y="-1261.3" font-family="Times,serif" font-size="14.00">clean_data._clean_raw</text>
</a>
</g>
</g>
<!-- clean_data._clean_raw&#45;&gt;post_io.raw_post_path -->
<g id="edge160" class="edge">
<title>clean_data._clean_raw&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M3340.19,-1252.31C3355.96,-1248.64 3372.04,-1243.95 3386.66,-1238 3387.58,-1237.62 3471.97,-1183.08 3522.18,-1150.6"/>
<polygon fill="black" stroke="black" points="3524.34,-1153.37 3530.83,-1145 3520.54,-1147.5 3524.34,-1153.37"/>
</g>
<!-- clean_data._clean_raw&#45;&gt;clean_data._parse_date -->
<g id="edge161" class="edge">
<title>clean_data._clean_raw&#45;&gt;clean_data._parse_date</title>
<path fill="none" stroke="black" d="M3287.4,-1283.06C3317.58,-1300.87 3360.91,-1330.77 3386.66,-1368 3417.61,-1412.74 3382.27,-1448.55 3422.66,-1485 3432.94,-1494.28 3445.47,-1500.75 3458.72,-1505.21"/>
<polygon fill="black" stroke="black" points="3457.89,-1508.61 3468.47,-1508.11 3459.88,-1501.9 3457.89,-1508.61"/>
</g>
<!-- clean_data._clean_media -->
<g id="node122" class="node">
<title>clean_data._clean_media</title>
<g id="a_node122"><a xlink:title="Remove unused media files older than ``cutoff``.">
<polygon fill="none" stroke="black" points="3348.16,-1667 3157.16,-1667 3157.16,-1631 3348.16,-1631 3348.16,-1667"/>
<text text-anchor="middle" x="3252.66" y="-1645.3" font-family="Times,serif" font-size="14.00">clean_data._clean_media</text>
</a>
</g>
</g>
<!-- clean_data._clean_media&#45;&gt;caption_io.has_caption -->
<g id="edge162" class="edge">
<title>clean_data._clean_media&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M3348.26,-1661.91C3361.94,-1666.5 3375.24,-1672.68 3386.66,-1681 3411.49,-1699.09 3397.78,-1721.98 3422.66,-1740 3434.23,-1748.38 3447.68,-1754.6 3461.52,-1759.21"/>
<polygon fill="black" stroke="black" points="3460.57,-1762.58 3471.15,-1762.15 3462.61,-1755.88 3460.57,-1762.58"/>
</g>
<!-- clean_data._clean_media&#45;&gt;clean_data._parse_date -->
<g id="edge163" class="edge">
<title>clean_data._clean_media&#45;&gt;clean_data._parse_date</title>
<path fill="none" stroke="black" d="M3293.85,-1630.95C3349.28,-1606.05 3449.13,-1561.2 3509.11,-1534.26"/>
<polygon fill="black" stroke="black" points="3510.69,-1537.38 3518.38,-1530.09 3507.83,-1531 3510.69,-1537.38"/>
</g>
<!-- clean_data._clean_lots -->
<g id="node123" class="node">
<title>clean_data._clean_lots</title>
<g id="a_node123"><a xlink:title="Drop lots missing translations or source posts.">
<polygon fill="none" stroke="black" points="3339.66,-2127 3165.66,-2127 3165.66,-2091 3339.66,-2091 3339.66,-2127"/>
<text text-anchor="middle" x="3252.66" y="-2105.3" font-family="Times,serif" font-size="14.00">clean_data._clean_lots</text>
</a>
</g>
</g>
<!-- clean_data._clean_lots&#45;&gt;post_io.raw_post_path -->
<g id="edge164" class="edge">
<title>clean_data._clean_lots&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M3339.85,-2108.28C3357.73,-2103.95 3374.74,-2095.98 3386.66,-2082 3449.21,-2008.63 3374.84,-1298.72 3422.66,-1215 3439.71,-1185.14 3471.5,-1163.73 3500.06,-1149.51"/>
<polygon fill="black" stroke="black" points="3501.68,-1152.61 3509.19,-1145.14 3498.66,-1146.3 3501.68,-1152.61"/>
</g>
<!-- clean_data._clean_lots&#45;&gt;lot_io.needs_cleanup -->
<g id="edge165" class="edge">
<title>clean_data._clean_lots&#45;&gt;lot_io.needs_cleanup</title>
<path fill="none" stroke="black" d="M3339.84,-2107.3C3379.62,-2106.52 3426.89,-2105.59 3467.29,-2104.8"/>
<polygon fill="black" stroke="black" points="3467.48,-2108.29 3477.41,-2104.6 3467.34,-2101.3 3467.48,-2108.29"/>
</g>
<!-- clean_data._clean_lots&#45;&gt;lot_io.read_lots -->
<g id="edge166" class="edge">
<title>clean_data._clean_lots&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M3278.2,-2127.15C3309.03,-2151.43 3361,-2197.56 3386.66,-2250 3432.52,-2343.73 3381.85,-2385.97 3422.66,-2482 3448.8,-2543.52 3500.84,-2602.84 3532.42,-2635.37"/>
<polygon fill="black" stroke="black" points="3530.09,-2637.99 3539.59,-2642.67 3535.08,-2633.08 3530.09,-2637.99"/>
</g>
<!-- clean_data._clean_embeddings -->
<g id="node124" class="node">
<title>clean_data._clean_embeddings</title>
<g id="a_node124"><a xlink:title="Delete embedding files when the matching lot JSON is absent.">
<polygon fill="none" stroke="black" points="3370.16,-1889 3135.16,-1889 3135.16,-1853 3370.16,-1853 3370.16,-1889"/>
<text text-anchor="middle" x="3252.66" y="-1867.3" font-family="Times,serif" font-size="14.00">clean_data._clean_embeddings</text>
</a>
</g>
</g>
<!-- clean_data._remove_empty_dirs -->
<g id="node125" class="node">
<title>clean_data._remove_empty_dirs</title>
<g id="a_node125"><a xlink:title="Recursively remove empty folders under ``root``.">
<polygon fill="none" stroke="black" points="3681.16,-1882 3438.16,-1882 3438.16,-1846 3681.16,-1846 3681.16,-1882"/>
<text text-anchor="middle" x="3559.66" y="-1860.3" font-family="Times,serif" font-size="14.00">clean_data._remove_empty_dirs</text>
</a>
</g>
</g>
<!-- clean_data.main -->
<g id="node126" class="node">
<title>clean_data.main</title>
<g id="a_node126"><a xlink:title="Clean up old or inconsistent files across data directories.">
<polygon fill="none" stroke="black" points="3021.16,-1889 2889.16,-1889 2889.16,-1853 3021.16,-1853 3021.16,-1889"/>
<text text-anchor="middle" x="2955.16" y="-1867.3" font-family="Times,serif" font-size="14.00">clean_data.main</text>
</a>
</g>
</g>
<!-- clean_data.main&#45;&gt;clean_data._clean_raw -->
<g id="edge167" class="edge">
<title>clean_data.main&#45;&gt;clean_data._clean_raw</title>
<path fill="none" stroke="black" d="M2984.87,-1852.98C3015.09,-1832.24 3061.21,-1795.16 3082.66,-1750 3125.99,-1658.78 3053.06,-1373.78 3118.66,-1297 3128.31,-1285.7 3141.19,-1278.02 3155.14,-1272.85"/>
<polygon fill="black" stroke="black" points="3156.51,-1276.08 3164.94,-1269.66 3154.35,-1269.43 3156.51,-1276.08"/>
</g>
<!-- clean_data.main&#45;&gt;clean_data._clean_media -->
<g id="edge168" class="edge">
<title>clean_data.main&#45;&gt;clean_data._clean_media</title>
<path fill="none" stroke="black" d="M3021.22,-1866C3042.74,-1861.56 3065.54,-1853.49 3082.66,-1839 3113.04,-1813.28 3094.53,-1788.66 3118.66,-1757 3144.88,-1722.59 3184.24,-1692.42 3213.35,-1672.77"/>
<polygon fill="black" stroke="black" points="3215.62,-1675.47 3222.02,-1667.02 3211.75,-1669.63 3215.62,-1675.47"/>
</g>
<!-- clean_data.main&#45;&gt;clean_data._clean_lots -->
<g id="edge169" class="edge">
<title>clean_data.main&#45;&gt;clean_data._clean_lots</title>
<path fill="none" stroke="black" d="M2964.52,-1889.23C2984.59,-1930.8 3039.79,-2032.84 3118.66,-2082 3129.89,-2089 3142.6,-2094.23 3155.59,-2098.13"/>
<polygon fill="black" stroke="black" points="3155,-2101.59 3165.57,-2100.86 3156.85,-2094.84 3155,-2101.59"/>
</g>
<!-- clean_data.main&#45;&gt;clean_data._clean_embeddings -->
<g id="edge170" class="edge">
<title>clean_data.main&#45;&gt;clean_data._clean_embeddings</title>
<path fill="none" stroke="black" d="M3021.37,-1871C3051.9,-1871 3089.35,-1871 3125.11,-1871"/>
<polygon fill="black" stroke="black" points="3125.14,-1874.5 3135.14,-1871 3125.14,-1867.5 3125.14,-1874.5"/>
</g>
<!-- clean_data.main&#45;&gt;clean_data._remove_empty_dirs -->
<g id="edge171" class="edge">
<title>clean_data.main&#45;&gt;clean_data._remove_empty_dirs</title>
<path fill="none" stroke="black" d="M3021.17,-1863.43C3042.09,-1858.76 3064.52,-1851.21 3082.66,-1839 3105.08,-1823.91 3094.55,-1802.2 3118.66,-1790 3224.93,-1736.21 3278.44,-1740.23 3386.66,-1790 3408.99,-1800.27 3401.66,-1819.22 3422.66,-1832 3428.93,-1835.81 3435.61,-1839.17 3442.53,-1842.13"/>
<polygon fill="black" stroke="black" points="3441.5,-1845.49 3452.09,-1845.92 3444.08,-1838.98 3441.5,-1845.49"/>
</g>
<!-- notes_utils.collect_notes -->
<g id="node127" class="node">
<title>notes_utils.collect_notes</title>
<g id="a_node127"><a xlink:title="Return combined notes if ``notes/`` exists.">
<polygon fill="none" stroke="black" points="3655.16,-1422 3464.16,-1422 3464.16,-1386 3655.16,-1386 3655.16,-1422"/>
<text text-anchor="middle" x="3559.66" y="-1400.3" font-family="Times,serif" font-size="14.00">notes_utils.collect_notes</text>
</a>
</g>
</g>
<!-- notes_utils.collect_notes&#45;&gt;serde_utils.read_md -->
<g id="edge172" class="edge">
<title>notes_utils.collect_notes&#45;&gt;serde_utils.read_md</title>
<path fill="none" stroke="black" d="M3655.26,-1404C3691.86,-1404 3733.55,-1404 3769.69,-1404"/>
<polygon fill="black" stroke="black" points="3769.73,-1407.5 3779.73,-1404 3769.73,-1400.5 3769.73,-1407.5"/>
</g>
<!-- scan_ontology.collect_ontology -->
<g id="node128" class="node">
<title>scan_ontology.collect_ontology</title>
<g id="a_node128"><a xlink:title="Return counts per field, value counters, misparsed lots and broken metadata.">
<polygon fill="none" stroke="black" points="3072.16,-2549 2838.16,-2549 2838.16,-2513 3072.16,-2513 3072.16,-2549"/>
<text text-anchor="middle" x="2955.16" y="-2527.3" font-family="Times,serif" font-size="14.00">scan_ontology.collect_ontology</text>
</a>
</g>
</g>
<!-- scan_ontology.collect_ontology&#45;&gt;post_io.read_post -->
<g id="edge173" class="edge">
<title>scan_ontology.collect_ontology&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M2965.63,-2512.67C2990.39,-2463.7 3056.91,-2325.06 3082.66,-2201 3101.48,-2110.29 3056.8,-1436.97 3118.66,-1368 3199.11,-1278.3 3286.1,-1393.39 3386.66,-1327 3411.98,-1310.28 3397.72,-1286.27 3422.66,-1269 3439.17,-1257.57 3459.35,-1250.72 3479.07,-1246.68"/>
<polygon fill="black" stroke="black" points="3479.8,-1250.11 3489,-1244.87 3478.54,-1243.22 3479.8,-1250.11"/>
</g>
<!-- scan_ontology.collect_ontology&#45;&gt;post_io.raw_post_path -->
<g id="edge174" class="edge">
<title>scan_ontology.collect_ontology&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M2965.68,-2512.68C2990.58,-2463.74 3057.4,-2325.16 3082.66,-2201 3093.93,-2145.6 3080.59,-1225.8 3118.66,-1184 3163.21,-1135.08 3346.16,-1126.15 3461.66,-1125.57"/>
<polygon fill="black" stroke="black" points="3461.94,-1129.06 3471.93,-1125.53 3461.92,-1122.06 3461.94,-1129.06"/>
</g>
<!-- scan_ontology.collect_ontology&#45;&gt;lot_io.read_lots -->
<g id="edge175" class="edge">
<title>scan_ontology.collect_ontology&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M3070.5,-2549C3074.81,-2551.65 3078.89,-2554.63 3082.66,-2558 3120.37,-2591.73 3077.61,-2636.42 3118.66,-2666 3175.6,-2707.04 3377.51,-2686.59 3486.93,-2671.77"/>
<polygon fill="black" stroke="black" points="3487.47,-2675.23 3496.9,-2670.4 3486.52,-2668.3 3487.47,-2675.23"/>
</g>
<!-- scan_ontology.collect_ontology&#45;&gt;message_utils.gather_chop_input -->
<g id="edge176" class="edge">
<title>scan_ontology.collect_ontology&#45;&gt;message_utils.gather_chop_input</title>
<path fill="none" stroke="black" d="M2964.35,-2512.75C2986.25,-2463.41 3046.87,-2322.86 3082.66,-2201 3104.79,-2125.65 3062.99,-2083.4 3118.66,-2028 3119.6,-2027.07 3120.56,-2026.16 3121.54,-2025.28"/>
<polygon fill="black" stroke="black" points="3123.77,-2027.98 3129.48,-2019.06 3119.45,-2022.47 3123.77,-2027.98"/>
</g>
<!-- moderation.is_misparsed -->
<g id="node129" class="node">
<title>moderation.is_misparsed</title>
<g id="a_node129"><a xlink:title="Return ``True`` for obviously invalid lots or source posts.">
<polygon fill="none" stroke="black" points="3350.66,-3555 3154.66,-3555 3154.66,-3519 3350.66,-3519 3350.66,-3555"/>
<text text-anchor="middle" x="3252.66" y="-3533.3" font-family="Times,serif" font-size="14.00">moderation.is_misparsed</text>
</a>
</g>
</g>
<!-- scan_ontology.collect_ontology&#45;&gt;moderation.is_misparsed -->
<g id="edge177" class="edge">
<title>scan_ontology.collect_ontology&#45;&gt;moderation.is_misparsed</title>
<path fill="none" stroke="black" d="M3072.31,-2548.16C3076.07,-2551.04 3079.55,-2554.3 3082.66,-2558 3150.78,-2639.02 3050.13,-3429.32 3118.66,-3510 3125.9,-3518.52 3135.03,-3524.82 3145.09,-3529.41"/>
<polygon fill="black" stroke="black" points="3143.99,-3532.74 3154.58,-3533.17 3146.57,-3526.23 3143.99,-3532.74"/>
</g>
<!-- moderation.is_misparsed&#45;&gt;lot_io.get_seller -->
<g id="edge218" class="edge">
<title>moderation.is_misparsed&#45;&gt;lot_io.get_seller</title>
<path fill="none" stroke="black" d="M3344.61,-3555.04C3358.7,-3557.96 3373.08,-3561.01 3386.66,-3564 3418.98,-3571.13 3454.58,-3579.53 3484.97,-3586.86"/>
<polygon fill="black" stroke="black" points="3484.52,-3590.35 3495.06,-3589.3 3486.17,-3583.55 3484.52,-3590.35"/>
</g>
<!-- scan_ontology.main -->
<g id="node130" class="node">
<title>scan_ontology.main</title>
<polygon fill="none" stroke="black" points="2755.66,-2902 2600.66,-2902 2600.66,-2866 2755.66,-2866 2755.66,-2902"/>
<text text-anchor="middle" x="2678.16" y="-2880.3" font-family="Times,serif" font-size="14.00">scan_ontology.main</text>
</g>
<!-- scan_ontology.main&#45;&gt;serde_utils.write_json -->
<g id="edge179" class="edge">
<title>scan_ontology.main&#45;&gt;serde_utils.write_json</title>
<path fill="none" stroke="black" d="M2755.66,-2895.26C2768.83,-2899.97 2781.52,-2906.63 2791.66,-2916 2825.42,-2947.22 2792.47,-2983.4 2827.66,-3013 2921.5,-3091.95 3287.15,-3091.77 3463.07,-3086.81"/>
<polygon fill="black" stroke="black" points="3463.21,-3090.3 3473.1,-3086.51 3463,-3083.31 3463.21,-3090.3"/>
</g>
<!-- scan_ontology.main&#45;&gt;scan_ontology.collect_ontology -->
<g id="edge178" class="edge">
<title>scan_ontology.main&#45;&gt;scan_ontology.collect_ontology</title>
<path fill="none" stroke="black" d="M2681.7,-2865.74C2690.49,-2809.95 2724.87,-2640.58 2827.66,-2558 2829.23,-2556.73 2830.86,-2555.52 2832.52,-2554.37"/>
<polygon fill="black" stroke="black" points="2834.49,-2557.26 2841.14,-2549.02 2830.8,-2551.32 2834.49,-2557.26"/>
</g>
<!-- log_utils.install_excepthook -->
<g id="node131" class="node">
<title>log_utils.install_excepthook</title>
<g id="a_node131"><a xlink:title="Redirect uncaught exceptions to ``logger.exception``.">
<polygon fill="none" stroke="black" points="3061.66,-3339 2848.66,-3339 2848.66,-3303 3061.66,-3303 3061.66,-3339"/>
<text text-anchor="middle" x="2955.16" y="-3317.3" font-family="Times,serif" font-size="14.00">log_utils.install_excepthook</text>
</a>
</g>
</g>
<!-- scan_ontology.main&#45;&gt;log_utils.install_excepthook -->
<g id="edge180" class="edge">
<title>scan_ontology.main&#45;&gt;log_utils.install_excepthook</title>
<path fill="none" stroke="black" d="M2685.22,-2902.25C2711.1,-2979.99 2811.77,-3280.15 2827.66,-3294 2831.38,-3297.24 2835.39,-3300.12 2839.62,-3302.69"/>
<polygon fill="black" stroke="black" points="2838.11,-3305.85 2848.58,-3307.51 2841.43,-3299.69 2838.11,-3305.85"/>
</g>
<!-- log_utils._extract_tb_lineno -->
<g id="node152" class="node">
<title>log_utils._extract_tb_lineno</title>
<g id="a_node152"><a xlink:title="Return the last line number from a traceback.">
<polygon fill="none" stroke="black" points="3358.16,-3393 3147.16,-3393 3147.16,-3357 3358.16,-3357 3358.16,-3393"/>
<text text-anchor="middle" x="3252.66" y="-3371.3" font-family="Times,serif" font-size="14.00">log_utils._extract_tb_lineno</text>
</a>
</g>
</g>
<!-- log_utils.install_excepthook&#45;&gt;log_utils._extract_tb_lineno -->
<g id="edge245" class="edge">
<title>log_utils.install_excepthook&#45;&gt;log_utils._extract_tb_lineno</title>
<path fill="none" stroke="black" d="M3054.97,-3339.06C3083.18,-3344.21 3114.08,-3349.86 3142.86,-3355.12"/>
<polygon fill="black" stroke="black" points="3142.48,-3358.61 3152.94,-3356.96 3143.74,-3351.72 3142.48,-3358.61"/>
</g>
<!-- debug_dump.parse_url -->
<g id="node132" class="node">
<title>debug_dump.parse_url</title>
<g id="a_node132"><a xlink:title="Return ``(lot_id, lang)`` extracted from ``url``.">
<polygon fill="none" stroke="black" points="3342.16,-3025 3163.16,-3025 3163.16,-2989 3342.16,-2989 3342.16,-3025"/>
<text text-anchor="middle" x="3252.66" y="-3003.3" font-family="Times,serif" font-size="14.00">debug_dump.parse_url</text>
</a>
</g>
</g>
<!-- debug_dump.guess_source_from_lot -->
<g id="node133" class="node">
<title>debug_dump.guess_source_from_lot</title>
<g id="a_node133"><a xlink:title="Guess ``(chat, message_id)`` directly from ``lot_id``.">
<polygon fill="none" stroke="black" points="3696.66,-2771 3422.66,-2771 3422.66,-2735 3696.66,-2735 3696.66,-2771"/>
<text text-anchor="middle" x="3559.66" y="-2749.3" font-family="Times,serif" font-size="14.00">debug_dump.guess_source_from_lot</text>
</a>
</g>
</g>
<!-- debug_dump.load_source_info -->
<g id="node134" class="node">
<title>debug_dump.load_source_info</title>
<g id="a_node134"><a xlink:title="Return ``(chat, message_id)`` for ``lot_id`` if available.">
<polygon fill="none" stroke="black" points="3367.66,-2603 3137.66,-2603 3137.66,-2567 3367.66,-2567 3367.66,-2603"/>
<text text-anchor="middle" x="3252.66" y="-2581.3" font-family="Times,serif" font-size="14.00">debug_dump.load_source_info</text>
</a>
</g>
</g>
<!-- debug_dump.load_source_info&#45;&gt;serde_utils.load_json -->
<g id="edge182" class="edge">
<title>debug_dump.load_source_info&#45;&gt;serde_utils.load_json</title>
<path fill="none" stroke="black" d="M3368,-2597.08C3457.49,-2606.67 3585.06,-2620.64 3696.66,-2634 3719.73,-2636.76 3744.62,-2639.89 3767.84,-2642.88"/>
<polygon fill="black" stroke="black" points="3767.66,-2646.38 3778.03,-2644.19 3768.56,-2639.44 3767.66,-2646.38"/>
</g>
<!-- debug_dump.load_source_info&#45;&gt;lot_io.lot_json_path -->
<g id="edge181" class="edge">
<title>debug_dump.load_source_info&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M3296.07,-2566.92C3351.22,-2543.41 3447.52,-2502.37 3506.92,-2477.05"/>
<polygon fill="black" stroke="black" points="3508.29,-2480.27 3516.12,-2473.13 3505.55,-2473.83 3508.29,-2480.27"/>
</g>
<!-- debug_dump.run_tg_fetch -->
<g id="node135" class="node">
<title>debug_dump.run_tg_fetch</title>
<g id="a_node135"><a xlink:title="Run ``tg_client.py &#45;&#45;fetch`` and return combined logs.">
<polygon fill="none" stroke="black" points="3961.66,-2554 3759.66,-2554 3759.66,-2518 3961.66,-2518 3961.66,-2554"/>
<text text-anchor="middle" x="3860.66" y="-2532.3" font-family="Times,serif" font-size="14.00">debug_dump.run_tg_fetch</text>
</a>
</g>
</g>
<!-- debug_dump.run_tg_fetch&#45;&gt;serde_utils.read_text -->
<g id="edge183" class="edge">
<title>debug_dump.run_tg_fetch&#45;&gt;serde_utils.read_text</title>
<path fill="none" stroke="black" d="M3945.79,-2517.95C3962.15,-2510.82 3977.62,-2500.87 3988.66,-2487 4116.79,-2326 4133.29,-1635.31 4135.37,-1486.38"/>
<polygon fill="black" stroke="black" points="4138.87,-1486.27 4135.5,-1476.23 4131.87,-1486.18 4138.87,-1486.27"/>
</g>
<!-- debug_dump.collect_files -->
<g id="node136" class="node">
<title>debug_dump.collect_files</title>
<g id="a_node136"><a xlink:title="Return ``[(name, content), ...]`` for files related to ``lot_id``.">
<polygon fill="none" stroke="black" points="3350.16,-2457 3155.16,-2457 3155.16,-2421 3350.16,-2421 3350.16,-2457"/>
<text text-anchor="middle" x="3252.66" y="-2435.3" font-family="Times,serif" font-size="14.00">debug_dump.collect_files</text>
</a>
</g>
</g>
<!-- debug_dump.collect_files&#45;&gt;post_io.raw_post_path -->
<g id="edge184" class="edge">
<title>debug_dump.collect_files&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M3350.48,-2435.34C3364.39,-2430.63 3377.17,-2423.26 3386.66,-2412 3472.41,-2310.25 3357.32,-1330.91 3422.66,-1215 3439.54,-1185.05 3471.32,-1163.63 3499.92,-1149.43"/>
<polygon fill="black" stroke="black" points="3501.54,-1152.53 3509.07,-1145.07 3498.53,-1146.21 3501.54,-1152.53"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;serde_utils.read_text -->
<g id="edge189" class="edge">
<title>debug_dump.collect_files&#45;&gt;serde_utils.read_text</title>
<path fill="none" stroke="black" d="M3350.24,-2431.72C3544.44,-2416.66 3965.75,-2381.69 3988.66,-2360 4119.05,-2236.52 4133.78,-1626.13 4135.45,-1486.49"/>
<polygon fill="black" stroke="black" points="4138.95,-1486.24 4135.56,-1476.2 4131.95,-1486.16 4138.95,-1486.24"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;caption_io.has_caption -->
<g id="edge187" class="edge">
<title>debug_dump.collect_files&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M3350.17,-2435.08C3364.11,-2430.4 3376.99,-2423.1 3386.66,-2412 3470.74,-2315.45 3351.03,-1943.12 3422.66,-1837 3435.73,-1817.63 3456.23,-1803.87 3477.38,-1794.15"/>
<polygon fill="black" stroke="black" points="3478.99,-1797.27 3486.79,-1790.1 3476.22,-1790.84 3478.99,-1797.27"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;caption_io.caption_json_path -->
<g id="edge186" class="edge">
<title>debug_dump.collect_files&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M3350.19,-2423.11C3362.63,-2419.99 3375.06,-2416.31 3386.66,-2412 3423.68,-2398.24 3665.84,-2262.71 3696.66,-2238 3755.94,-2190.46 3812.07,-2120.33 3840.43,-2082.51"/>
<polygon fill="black" stroke="black" points="3843.55,-2084.18 3846.71,-2074.07 3837.93,-2080.01 3843.55,-2084.18"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;serde_utils.load_json -->
<g id="edge190" class="edge">
<title>debug_dump.collect_files&#45;&gt;serde_utils.load_json</title>
<path fill="none" stroke="black" d="M3350.19,-2456.01C3362.57,-2458.94 3374.99,-2462.27 3386.66,-2466 3403.34,-2471.33 3405.87,-2477.04 3422.66,-2482 3540.89,-2516.89 3601.99,-2446.05 3696.66,-2525 3733.9,-2556.06 3696.27,-2595.95 3732.66,-2628 3742.87,-2636.99 3755.32,-2643.24 3768.4,-2647.55"/>
<polygon fill="black" stroke="black" points="3767.42,-2650.91 3778,-2650.35 3769.38,-2644.19 3767.42,-2650.91"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;lot_io.lot_json_path -->
<g id="edge185" class="edge">
<title>debug_dump.collect_files&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M3350.16,-2444.06C3389.57,-2446.13 3434.78,-2448.5 3473,-2450.51"/>
<polygon fill="black" stroke="black" points="3472.9,-2454.01 3483.07,-2451.03 3473.27,-2447.02 3472.9,-2454.01"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;caption_io.read_caption -->
<g id="edge188" class="edge">
<title>debug_dump.collect_files&#45;&gt;caption_io.read_caption</title>
<path fill="none" stroke="black" d="M3350.34,-2432.61C3363.75,-2428.15 3376.41,-2421.57 3386.66,-2412 3430.78,-2370.78 3384.61,-2327.88 3422.66,-2281 3440.09,-2259.52 3465.87,-2243.93 3490.3,-2232.99"/>
<polygon fill="black" stroke="black" points="3491.76,-2236.17 3499.58,-2229.02 3489.01,-2229.74 3491.76,-2236.17"/>
</g>
<!-- debug_dump.delete_files -->
<g id="node137" class="node">
<title>debug_dump.delete_files</title>
<g id="a_node137"><a xlink:title="Remove files related to ``lot_id`` from the filesystem.">
<polygon fill="none" stroke="black" points="3349.16,-2073 3156.16,-2073 3156.16,-2037 3349.16,-2037 3349.16,-2073"/>
<text text-anchor="middle" x="3252.66" y="-2051.3" font-family="Times,serif" font-size="14.00">debug_dump.delete_files</text>
</a>
</g>
</g>
<!-- debug_dump.delete_files&#45;&gt;post_io.raw_post_path -->
<g id="edge191" class="edge">
<title>debug_dump.delete_files&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M3349.34,-2051.56C3363.65,-2046.88 3376.86,-2039.46 3386.66,-2028 3445.42,-1959.27 3377.7,-1293.45 3422.66,-1215 3439.82,-1185.06 3471.78,-1163.6 3500.41,-1149.37"/>
<polygon fill="black" stroke="black" points="3502.04,-1152.47 3509.56,-1145.01 3499.03,-1146.15 3502.04,-1152.47"/>
</g>
<!-- debug_dump.delete_files&#45;&gt;caption_io.caption_json_path -->
<g id="edge193" class="edge">
<title>debug_dump.delete_files&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M3349.35,-2055.16C3455.05,-2055.33 3625.43,-2055.61 3739.91,-2055.8"/>
<polygon fill="black" stroke="black" points="3740.12,-2059.3 3750.12,-2055.82 3740.13,-2052.3 3740.12,-2059.3"/>
</g>
<!-- debug_dump.delete_files&#45;&gt;caption_io.caption_md_path -->
<g id="edge194" class="edge">
<title>debug_dump.delete_files&#45;&gt;caption_io.caption_md_path</title>
<path fill="none" stroke="black" d="M3349.4,-2051.77C3461.7,-2046.46 3639.79,-2032.85 3696.66,-1999 3776.23,-1951.64 3827.75,-1848.73 3848.82,-1799.42"/>
<polygon fill="black" stroke="black" points="3852.12,-1800.6 3852.74,-1790.03 3845.66,-1797.91 3852.12,-1800.6"/>
</g>
<!-- debug_dump.delete_files&#45;&gt;serde_utils.load_json -->
<g id="edge195" class="edge">
<title>debug_dump.delete_files&#45;&gt;serde_utils.load_json</title>
<path fill="none" stroke="black" d="M3349.34,-2060.57C3363.21,-2065.08 3376.28,-2071.89 3386.66,-2082 3437.64,-2131.64 3378.72,-2182.03 3422.66,-2238 3506.85,-2345.25 3617.09,-2265.27 3696.66,-2376 3762.68,-2467.88 3655.41,-2545.34 3732.66,-2628 3742.26,-2638.27 3754.72,-2645.14 3768.07,-2649.65"/>
<polygon fill="black" stroke="black" points="3767.35,-2653.09 3777.93,-2652.54 3769.31,-2646.37 3767.35,-2653.09"/>
</g>
<!-- debug_dump.delete_files&#45;&gt;lot_io.lot_json_path -->
<g id="edge192" class="edge">
<title>debug_dump.delete_files&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M3349.35,-2060.11C3363.3,-2064.67 3376.39,-2071.61 3386.66,-2082 3446.76,-2142.83 3388.39,-2192.66 3422.66,-2271 3450.22,-2334 3502.7,-2395.94 3533.79,-2429.44"/>
<polygon fill="black" stroke="black" points="3531.43,-2432.05 3540.83,-2436.94 3536.54,-2427.25 3531.43,-2432.05"/>
</g>
<!-- debug_dump._message_reason -->
<g id="node138" class="node">
<title>debug_dump._message_reason</title>
<g id="a_node138"><a xlink:title="Return explanation why a message would be skipped.">
<polygon fill="none" stroke="black" points="3677.66,-1314 3441.66,-1314 3441.66,-1278 3677.66,-1278 3677.66,-1314"/>
<text text-anchor="middle" x="3559.66" y="-1292.3" font-family="Times,serif" font-size="14.00">debug_dump._message_reason</text>
</a>
</g>
</g>
<!-- debug_dump._message_reason&#45;&gt;moderation.should_skip_user -->
<g id="edge196" class="edge">
<title>debug_dump._message_reason&#45;&gt;moderation.should_skip_user</title>
<path fill="none" stroke="black" d="M3677.8,-1304.43C3788.75,-1309.69 3944.74,-1309.16 3988.66,-1269 4129.66,-1140.07 4136.16,-485.49 4135.85,-340.47"/>
<polygon fill="black" stroke="black" points="4139.35,-340.18 4135.81,-330.2 4132.35,-340.21 4139.35,-340.18"/>
</g>
<!-- debug_dump._lot_reason -->
<g id="node139" class="node">
<title>debug_dump._lot_reason</title>
<g id="a_node139"><a xlink:title="Return explanation why ``lot`` would be skipped.">
<polygon fill="none" stroke="black" points="3957.16,-2351 3764.16,-2351 3764.16,-2315 3957.16,-2315 3957.16,-2351"/>
<text text-anchor="middle" x="3860.66" y="-2329.3" font-family="Times,serif" font-size="14.00">debug_dump._lot_reason</text>
</a>
</g>
</g>
<!-- debug_dump.moderation_summary -->
<g id="node140" class="node">
<title>debug_dump.moderation_summary</title>
<g id="a_node140"><a xlink:title="Return a multi&#45;line summary of moderation checks for ``lot_id``.">
<polygon fill="none" stroke="black" points="3386.66,-2403 3118.66,-2403 3118.66,-2367 3386.66,-2367 3386.66,-2403"/>
<text text-anchor="middle" x="3252.66" y="-2381.3" font-family="Times,serif" font-size="14.00">debug_dump.moderation_summary</text>
</a>
</g>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;post_io.read_post -->
<g id="edge197" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M3377.41,-2367C3380.74,-2364.32 3383.84,-2361.33 3386.66,-2358 3464.82,-2265.54 3344.3,-1361.29 3422.66,-1269 3436.65,-1252.53 3457.55,-1244.28 3478.8,-1240.53"/>
<polygon fill="black" stroke="black" points="3479.5,-1243.97 3488.89,-1239.07 3478.5,-1237.04 3479.5,-1243.97"/>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;post_io.raw_post_path -->
<g id="edge198" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M3377.69,-2366.79C3380.91,-2364.16 3383.92,-2361.24 3386.66,-2358 3468.61,-2260.9 3360.19,-1325.65 3422.66,-1215 3439.56,-1185.06 3471.34,-1163.64 3499.93,-1149.44"/>
<polygon fill="black" stroke="black" points="3501.56,-1152.54 3509.08,-1145.08 3498.55,-1146.22 3501.56,-1152.54"/>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;serde_utils.load_json -->
<g id="edge202" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;serde_utils.load_json</title>
<path fill="none" stroke="black" d="M3386.93,-2380.84C3500.75,-2380.27 3652.8,-2387.57 3696.66,-2428 3763.07,-2489.21 3669.8,-2563.14 3732.66,-2628 3742.38,-2638.03 3754.83,-2644.79 3768.13,-2649.27"/>
<polygon fill="black" stroke="black" points="3767.35,-2652.69 3777.93,-2652.14 3769.32,-2645.97 3767.35,-2652.69"/>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;lot_io.lot_json_path -->
<g id="edge199" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M3345.35,-2403.06C3359.21,-2405.95 3373.33,-2408.98 3386.66,-2412 3417.14,-2418.9 3450.49,-2427.09 3479.65,-2434.46"/>
<polygon fill="black" stroke="black" points="3478.81,-2437.86 3489.37,-2436.93 3480.53,-2431.07 3478.81,-2437.86"/>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;debug_dump._message_reason -->
<g id="edge200" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;debug_dump._message_reason</title>
<path fill="none" stroke="black" d="M3377.4,-2366.99C3380.74,-2364.31 3383.84,-2361.33 3386.66,-2358 3461.02,-2270.19 3348.11,-1410.65 3422.66,-1323 3425.77,-1319.34 3429.22,-1316.09 3432.94,-1313.2"/>
<polygon fill="black" stroke="black" points="3435.15,-1315.94 3441.49,-1307.45 3431.24,-1310.13 3435.15,-1315.94"/>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;debug_dump._lot_reason -->
<g id="edge201" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;debug_dump._lot_reason</title>
<path fill="none" stroke="black" d="M3351.26,-2366.96C3374.59,-2363.17 3399.45,-2359.55 3422.66,-2357 3535.38,-2344.6 3665.2,-2338.5 3753.87,-2335.57"/>
<polygon fill="black" stroke="black" points="3754.05,-2339.07 3763.93,-2335.25 3753.83,-2332.07 3754.05,-2339.07"/>
</g>
<!-- debug_dump.main -->
<g id="node141" class="node">
<title>debug_dump.main</title>
<g id="a_node141"><a xlink:title="Collect log and data files related to a single lot.">
<polygon fill="none" stroke="black" points="3029.16,-2603 2881.16,-2603 2881.16,-2567 3029.16,-2567 3029.16,-2603"/>
<text text-anchor="middle" x="2955.16" y="-2581.3" font-family="Times,serif" font-size="14.00">debug_dump.main</text>
</a>
</g>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.parse_url -->
<g id="edge203" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.parse_url</title>
<path fill="none" stroke="black" d="M2957.73,-2603.01C2964.24,-2665.94 2994.88,-2877.76 3118.66,-2980 3128.72,-2988.31 3140.65,-2994.29 3153.17,-2998.55"/>
<polygon fill="black" stroke="black" points="3152.26,-3001.93 3162.85,-3001.49 3154.3,-2995.24 3152.26,-3001.93"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.guess_source_from_lot -->
<g id="edge204" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.guess_source_from_lot</title>
<path fill="none" stroke="black" d="M3029.49,-2590.45C3048.81,-2595.13 3068.26,-2603.21 3082.66,-2617 3122.88,-2655.5 3074.6,-2702.96 3118.66,-2737 3163.24,-2771.44 3302.35,-2771.53 3412.36,-2765.4"/>
<polygon fill="black" stroke="black" points="3412.79,-2768.88 3422.57,-2764.81 3412.38,-2761.89 3412.79,-2768.88"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.load_source_info -->
<g id="edge205" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.load_source_info</title>
<path fill="none" stroke="black" d="M3029.2,-2585C3058.79,-2585 3093.79,-2585 3127.17,-2585"/>
<polygon fill="black" stroke="black" points="3127.47,-2588.5 3137.47,-2585 3127.47,-2581.5 3127.47,-2588.5"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.run_tg_fetch -->
<g id="edge206" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.run_tg_fetch</title>
<path fill="none" stroke="black" d="M3029.47,-2592.28C3048.35,-2597.01 3067.58,-2604.67 3082.66,-2617 3111.28,-2640.41 3087.36,-2672.31 3118.66,-2692 3141.86,-2706.6 3683.17,-2698.02 3696.66,-2688 3739.31,-2656.32 3694.8,-2611.29 3732.66,-2574 3738.73,-2568.02 3745.7,-2562.98 3753.18,-2558.72"/>
<polygon fill="black" stroke="black" points="3754.89,-2561.78 3762.18,-2554.08 3751.68,-2555.56 3754.89,-2561.78"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.collect_files -->
<g id="edge207" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.collect_files</title>
<path fill="none" stroke="black" d="M3029.29,-2581.77C3048.39,-2577.82 3067.77,-2570.65 3082.66,-2558 3116.13,-2529.58 3085.05,-2494.25 3118.66,-2466 3126.59,-2459.34 3135.71,-2454.16 3145.39,-2450.17"/>
<polygon fill="black" stroke="black" points="3146.65,-2453.44 3154.82,-2446.69 3144.23,-2446.87 3146.65,-2453.44"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.delete_files -->
<g id="edge208" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.delete_files</title>
<path fill="none" stroke="black" d="M3029.31,-2584.99C3049.34,-2581.25 3069.21,-2573.39 3082.66,-2558 3152.45,-2478.11 3048.47,-2161.54 3118.66,-2082 3126.31,-2073.32 3135.93,-2066.98 3146.47,-2062.4"/>
<polygon fill="black" stroke="black" points="3147.83,-2065.63 3155.94,-2058.81 3145.35,-2059.08 3147.83,-2065.63"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.moderation_summary -->
<g id="edge209" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.moderation_summary</title>
<path fill="none" stroke="black" d="M3029.43,-2583.21C3048.86,-2579.32 3068.39,-2571.83 3082.66,-2558 3130.65,-2511.49 3070.43,-2458.27 3118.66,-2412 3119.64,-2411.06 3120.64,-2410.15 3121.67,-2409.26"/>
<polygon fill="black" stroke="black" points="3124.06,-2411.84 3129.93,-2403.02 3119.84,-2406.26 3124.06,-2411.84"/>
</g>
<!-- serde_utils.parse_md -->
<g id="node142" class="node">
<title>serde_utils.parse_md</title>
<g id="a_node142"><a xlink:title="Return metadata dictionary and body text from ``path``.">
<polygon fill="none" stroke="black" points="3643.66,-1368 3475.66,-1368 3475.66,-1332 3643.66,-1332 3643.66,-1368"/>
<text text-anchor="middle" x="3559.66" y="-1346.3" font-family="Times,serif" font-size="14.00">serde_utils.parse_md</text>
</a>
</g>
</g>
<!-- serde_utils.parse_md&#45;&gt;serde_utils.read_md -->
<g id="edge212" class="edge">
<title>serde_utils.parse_md&#45;&gt;serde_utils.read_md</title>
<path fill="none" stroke="black" d="M3643.95,-1365.04C3683.13,-1372.12 3729.93,-1380.57 3769.9,-1387.79"/>
<polygon fill="black" stroke="black" points="3769.44,-1391.26 3779.91,-1389.6 3770.69,-1384.37 3769.44,-1391.26"/>
</g>
<!-- moderation.should_skip_text -->
<g id="node143" class="node">
<title>moderation.should_skip_text</title>
<g id="a_node143"><a xlink:title="Return ``True`` if ``text`` contains banned phrases.">
<polygon fill="none" stroke="black" points="4247.16,-276 4026.16,-276 4026.16,-240 4247.16,-240 4247.16,-276"/>
<text text-anchor="middle" x="4136.66" y="-254.3" font-family="Times,serif" font-size="14.00">moderation.should_skip_text</text>
</a>
</g>
</g>
<!-- moderation.message_skip_reason&#45;&gt;moderation.should_skip_user -->
<g id="edge215" class="edge">
<title>moderation.message_skip_reason&#45;&gt;moderation.should_skip_user</title>
<path fill="none" stroke="black" d="M3989.03,-297.55C3997.48,-298.38 4005.97,-299.22 4014.39,-300.05"/>
<polygon fill="black" stroke="black" points="4014.31,-303.56 4024.6,-301.06 4014.99,-296.59 4014.31,-303.56"/>
</g>
<!-- moderation.message_skip_reason&#45;&gt;moderation.should_skip_text -->
<g id="edge214" class="edge">
<title>moderation.message_skip_reason&#45;&gt;moderation.should_skip_text</title>
<path fill="none" stroke="black" d="M3989.03,-272.45C3997.97,-271.57 4006.96,-270.68 4015.85,-269.81"/>
<polygon fill="black" stroke="black" points="4016.23,-273.29 4025.84,-268.82 4015.55,-266.32 4016.23,-273.29"/>
</g>
<!-- moderation.apply_to_history -->
<g id="node146" class="node">
<title>moderation.apply_to_history</title>
<g id="a_node146"><a xlink:title="Remove processed lots now failing moderation.">
<polygon fill="none" stroke="black" points="3362.66,-1229 3142.66,-1229 3142.66,-1193 3362.66,-1193 3362.66,-1229"/>
<text text-anchor="middle" x="3252.66" y="-1207.3" font-family="Times,serif" font-size="14.00">moderation.apply_to_history</text>
</a>
</g>
</g>
<!-- moderation.apply_to_history&#45;&gt;post_io.read_post -->
<g id="edge219" class="edge">
<title>moderation.apply_to_history&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M3362.91,-1222.1C3401.18,-1225.99 3443.41,-1230.29 3478.82,-1233.89"/>
<polygon fill="black" stroke="black" points="3478.8,-1237.4 3489.1,-1234.93 3479.51,-1230.44 3478.8,-1237.4"/>
</g>
<!-- moderation.apply_to_history&#45;&gt;post_io.raw_post_path -->
<g id="edge220" class="edge">
<title>moderation.apply_to_history&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M3319.09,-1192.98C3367.25,-1179.72 3432.84,-1161.65 3483.21,-1147.78"/>
<polygon fill="black" stroke="black" points="3484.36,-1151.09 3493.07,-1145.06 3482.5,-1144.34 3484.36,-1151.09"/>
</g>
<!-- moderation.apply_to_history&#45;&gt;moderation.should_skip_message -->
<g id="edge222" class="edge">
<title>moderation.apply_to_history&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M3263.03,-1192.89C3286.24,-1147.52 3347.37,-1024.97 3386.66,-918 3466.28,-701.21 3532.06,-429.61 3552.26,-342.93"/>
<polygon fill="black" stroke="black" points="3555.69,-343.6 3554.54,-333.07 3548.88,-342.02 3555.69,-343.6"/>
</g>
<!-- moderation.apply_to_history&#45;&gt;lot_io.read_lots -->
<g id="edge221" class="edge">
<title>moderation.apply_to_history&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M3362.8,-1219.72C3371.86,-1224.2 3380.06,-1230.16 3386.66,-1238 3431.19,-1290.89 3399.64,-2416.8 3422.66,-2482 3444.85,-2544.86 3497.97,-2603.53 3530.87,-2635.61"/>
<polygon fill="black" stroke="black" points="3528.73,-2638.4 3538.37,-2642.8 3533.57,-2633.35 3528.73,-2638.4"/>
</g>
<!-- moderation.apply_to_history&#45;&gt;moderation.should_skip_lot -->
<g id="edge223" class="edge">
<title>moderation.apply_to_history&#45;&gt;moderation.should_skip_lot</title>
<path fill="none" stroke="black" d="M3362.86,-1221.42C3371.67,-1225.61 3379.8,-1231.03 3386.66,-1238 3447.87,-1300.19 3361.32,-1368.94 3422.66,-1431 3428.99,-1437.41 3436.38,-1442.52 3444.37,-1446.57"/>
<polygon fill="black" stroke="black" points="3443.08,-1449.83 3453.64,-1450.72 3445.94,-1443.44 3443.08,-1449.83"/>
</g>
<!-- chop.process_message -->
<g id="node147" class="node">
<title>chop.process_message</title>
<g id="a_node147"><a xlink:title="Extract lots from ``msg_path`` and save them under ``LOTS_DIR``.">
<polygon fill="none" stroke="black" points="3044.66,-2192 2865.66,-2192 2865.66,-2156 3044.66,-2156 3044.66,-2192"/>
<text text-anchor="middle" x="2955.16" y="-2170.3" font-family="Times,serif" font-size="14.00">chop.process_message</text>
</a>
</g>
</g>
<!-- chop.process_message&#45;&gt;post_io.read_post -->
<g id="edge224" class="edge">
<title>chop.process_message&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M2967.39,-2155.8C2993.24,-2112.85 3056.71,-2000.99 3082.66,-1898 3097.97,-1837.22 3076.49,-1381.38 3118.66,-1335 3199.8,-1245.73 3273.92,-1334.93 3386.66,-1292 3404.4,-1285.24 3405.04,-1276.08 3422.66,-1269 3440.36,-1261.88 3460.14,-1256.59 3479.01,-1252.66"/>
<polygon fill="black" stroke="black" points="3479.94,-1256.05 3489.07,-1250.68 3478.59,-1249.18 3479.94,-1256.05"/>
</g>
<!-- chop.process_message&#45;&gt;token_utils.estimate_tokens -->
<g id="edge225" class="edge">
<title>chop.process_message&#45;&gt;token_utils.estimate_tokens</title>
<path fill="none" stroke="black" d="M2992.54,-2192.1C3025.01,-2207.72 3074.15,-2230.05 3118.66,-2245 3130.95,-2249.13 3144.04,-2252.95 3157.04,-2256.41"/>
<polygon fill="black" stroke="black" points="3156.39,-2259.86 3166.95,-2258.98 3158.15,-2253.08 3156.39,-2259.86"/>
</g>
<!-- chop.process_message&#45;&gt;caption_io.has_caption -->
<g id="edge228" class="edge">
<title>chop.process_message&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M2963.59,-2155.91C2982.42,-2112.56 3036.41,-2002.42 3118.66,-1950 3220.98,-1884.79 3287.53,-1967.97 3386.66,-1898 3412.38,-1879.85 3399.45,-1858.27 3422.66,-1837 3442.76,-1818.58 3469.02,-1804.39 3493.1,-1794.04"/>
<polygon fill="black" stroke="black" points="3494.66,-1797.18 3502.55,-1790.11 3491.98,-1790.71 3494.66,-1797.18"/>
</g>
<!-- chop.process_message&#45;&gt;moderation.should_skip_message -->
<g id="edge231" class="edge">
<title>chop.process_message&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M2967.68,-2155.87C2994.14,-2113.06 3058.82,-2001.5 3082.66,-1898 3102.17,-1813.31 3057.82,-396.07 3118.66,-334 3159.57,-292.26 3308.55,-293.6 3421.92,-301.45"/>
<polygon fill="black" stroke="black" points="3421.86,-304.95 3432.08,-302.17 3422.36,-297.97 3421.86,-304.95"/>
</g>
<!-- chop.process_message&#45;&gt;lot_io.valid_lots -->
<g id="edge226" class="edge">
<title>chop.process_message&#45;&gt;lot_io.valid_lots</title>
<path fill="none" stroke="black" d="M3044.83,-2174.47C3131.9,-2174.58 3268.47,-2173.81 3386.66,-2169 3419.17,-2167.68 3455.09,-2165.31 3485.66,-2163.03"/>
<polygon fill="black" stroke="black" points="3486.1,-2166.51 3495.8,-2162.26 3485.57,-2159.53 3486.1,-2166.51"/>
</g>
<!-- chop.process_message&#45;&gt;lot_io.needs_cleanup -->
<g id="edge227" class="edge">
<title>chop.process_message&#45;&gt;lot_io.needs_cleanup</title>
<path fill="none" stroke="black" d="M3044.68,-2168.82C3131.92,-2163.1 3268.88,-2152.45 3386.66,-2136 3402.69,-2133.76 3435.15,-2127.67 3467.59,-2121.33"/>
<polygon fill="black" stroke="black" points="3468.5,-2124.72 3477.64,-2119.36 3467.15,-2117.85 3468.5,-2124.72"/>
</g>
<!-- chop.process_message&#45;&gt;caption_io.read_caption -->
<g id="edge229" class="edge">
<title>chop.process_message&#45;&gt;caption_io.read_caption</title>
<path fill="none" stroke="black" d="M3044.7,-2180.13C3068.7,-2181.76 3094.67,-2183.48 3118.66,-2185 3234.48,-2192.34 3367.49,-2200.11 3456.67,-2205.22"/>
<polygon fill="black" stroke="black" points="3456.6,-2208.72 3466.79,-2205.8 3457,-2201.73 3456.6,-2208.72"/>
</g>
<!-- chop.process_message&#45;&gt;message_utils.build_prompt -->
<g id="edge230" class="edge">
<title>chop.process_message&#45;&gt;message_utils.build_prompt</title>
<path fill="none" stroke="black" d="M2964.06,-2155.96C2983.36,-2114.48 3037.35,-2012.93 3118.66,-1974 3173.45,-1947.77 3329.97,-1953.36 3440.68,-1961.35"/>
<polygon fill="black" stroke="black" points="3440.68,-1964.86 3450.91,-1962.11 3441.2,-1957.88 3440.68,-1964.86"/>
</g>
<!-- embed.embed_file -->
<g id="node148" class="node">
<title>embed.embed_file</title>
<g id="a_node148"><a xlink:title="Embed ``path`` and write the result beside it under ``EMBED_DIR``.">
<polygon fill="none" stroke="black" points="3325.66,-2825 3179.66,-2825 3179.66,-2789 3325.66,-2789 3325.66,-2825"/>
<text text-anchor="middle" x="3252.66" y="-2803.3" font-family="Times,serif" font-size="14.00">embed.embed_file</text>
</a>
</g>
</g>
<!-- chop.process_message&#45;&gt;embed.embed_file -->
<g id="edge232" class="edge">
<title>chop.process_message&#45;&gt;embed.embed_file</title>
<path fill="none" stroke="black" d="M2964.26,-2192.27C2985.94,-2241.68 3046.05,-2382.38 3082.66,-2504 3103.92,-2574.63 3084.11,-2600.83 3118.66,-2666 3143.83,-2713.49 3189.37,-2756.61 3220.06,-2782.32"/>
<polygon fill="black" stroke="black" points="3217.96,-2785.13 3227.9,-2788.79 3222.41,-2779.73 3217.96,-2785.13"/>
</g>
<!-- embed.embed_file&#45;&gt;serde_utils.write_json -->
<g id="edge248" class="edge">
<title>embed.embed_file&#45;&gt;serde_utils.write_json</title>
<path fill="none" stroke="black" d="M3325.9,-2806.65C3348.03,-2810.14 3370.72,-2817.95 3386.66,-2834 3445.37,-2893.13 3371.63,-2952.12 3422.66,-3018 3437.59,-3037.28 3459.68,-3051.14 3481.72,-3060.96"/>
<polygon fill="black" stroke="black" points="3480.57,-3064.28 3491.15,-3064.93 3483.29,-3057.82 3480.57,-3064.28"/>
</g>
<!-- embed.embed_file&#45;&gt;lot_io.read_lots -->
<g id="edge246" class="edge">
<title>embed.embed_file&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M3291.24,-2788.97C3325.49,-2772.55 3377.46,-2747.63 3422.66,-2726 3452.2,-2711.86 3485.35,-2696.02 3511.53,-2683.51"/>
<polygon fill="black" stroke="black" points="3513.33,-2686.53 3520.84,-2679.06 3510.31,-2680.21 3513.33,-2686.53"/>
</g>
<!-- embed.embed_file&#45;&gt;lot_io.make_lot_id -->
<g id="edge247" class="edge">
<title>embed.embed_file&#45;&gt;lot_io.make_lot_id</title>
<path fill="none" stroke="black" d="M3325.94,-2807C3371.56,-2807 3430.58,-2807 3477.76,-2807"/>
<polygon fill="black" stroke="black" points="3477.95,-2810.5 3487.95,-2807 3477.95,-2803.5 3477.95,-2810.5"/>
</g>
<!-- chop.main -->
<g id="node149" class="node">
<title>chop.main</title>
<g id="a_node149"><a xlink:title="Process a single message file passed on the command line.">
<polygon fill="none" stroke="black" points="2723.16,-2419 2633.16,-2419 2633.16,-2383 2723.16,-2383 2723.16,-2419"/>
<text text-anchor="middle" x="2678.16" y="-2397.3" font-family="Times,serif" font-size="14.00">chop.main</text>
</a>
</g>
</g>
<!-- chop.main&#45;&gt;chop.process_message -->
<g id="edge233" class="edge">
<title>chop.main&#45;&gt;chop.process_message</title>
<path fill="none" stroke="black" d="M2723.38,-2394.75C2745.23,-2390.15 2771.23,-2382.28 2791.66,-2369 2859.66,-2324.78 2913.89,-2243.33 2938.99,-2201.05"/>
<polygon fill="black" stroke="black" points="2942.16,-2202.57 2944.18,-2192.17 2936.11,-2199.04 2942.16,-2202.57"/>
</g>
<!-- log_utils._add_exc_line -->
<g id="node153" class="node">
<title>log_utils._add_exc_line</title>
<g id="a_node153"><a xlink:title="Attach ``line`` from traceback to structured log events.">
<polygon fill="none" stroke="black" points="3044.16,-3485 2866.16,-3485 2866.16,-3449 3044.16,-3449 3044.16,-3485"/>
<text text-anchor="middle" x="2955.16" y="-3463.3" font-family="Times,serif" font-size="14.00">log_utils._add_exc_line</text>
</a>
</g>
</g>
<!-- log_utils._add_exc_line&#45;&gt;log_utils._extract_tb_lineno -->
<g id="edge241" class="edge">
<title>log_utils._add_exc_line&#45;&gt;log_utils._extract_tb_lineno</title>
<path fill="none" stroke="black" d="M3044.41,-3455.35C3057.72,-3451.58 3070.91,-3446.59 3082.66,-3440 3102.95,-3428.62 3098.31,-3413.28 3118.66,-3402 3124.61,-3398.7 3130.91,-3395.8 3137.41,-3393.25"/>
<polygon fill="black" stroke="black" points="3138.84,-3396.46 3147.06,-3389.77 3136.46,-3389.87 3138.84,-3396.46"/>
</g>
<!-- log_utils.init_logger -->
<g id="node154" class="node">
<title>log_utils.init_logger</title>
<g id="a_node154"><a xlink:title="Initialize logger writing to ``LOGFILE``.&#10;&#10;``LOG_LEVEL`` may be set in ``config.py`` or via an environment&#10;variable. &#160;The level accepts ``DEBUG``, ``INFO`` or ``ERROR`` and&#10;defaults to ``INFO``. &#160;The function falls back to the standard&#10;``logging`` module if ``structlog`` isn&#39;t available so the scripts&#10;can still run in minimal environments.">
<polygon fill="none" stroke="black" points="3034.16,-3539 2876.16,-3539 2876.16,-3503 3034.16,-3503 3034.16,-3539"/>
<text text-anchor="middle" x="2955.16" y="-3517.3" font-family="Times,serif" font-size="14.00">log_utils.init_logger</text>
</a>
</g>
</g>
<!-- log_utils.init_logger&#45;&gt;log_utils._extract_tb_lineno -->
<g id="edge242" class="edge">
<title>log_utils.init_logger&#45;&gt;log_utils._extract_tb_lineno</title>
<path fill="none" stroke="black" d="M3034.23,-3516.67C3051.69,-3512.54 3069.05,-3505.56 3082.66,-3494 3116.13,-3465.58 3085.05,-3430.25 3118.66,-3402 3124.42,-3397.15 3130.82,-3393.1 3137.61,-3389.71"/>
<polygon fill="black" stroke="black" points="3139.37,-3392.75 3147.08,-3385.49 3136.52,-3386.36 3139.37,-3392.75"/>
</g>
<!-- log_utils.get_logger -->
<g id="node155" class="node">
<title>log_utils.get_logger</title>
<g id="a_node155"><a xlink:title="Return the singleton logger instance.">
<polygon fill="none" stroke="black" points="3331.16,-3447 3174.16,-3447 3174.16,-3411 3331.16,-3411 3331.16,-3447"/>
<text text-anchor="middle" x="3252.66" y="-3425.3" font-family="Times,serif" font-size="14.00">log_utils.get_logger</text>
</a>
</g>
</g>
<!-- log_utils.init_logger&#45;&gt;log_utils.get_logger -->
<g id="edge243" class="edge">
<title>log_utils.init_logger&#45;&gt;log_utils.get_logger</title>
<path fill="none" stroke="black" d="M3034.42,-3503.18C3051.03,-3498.97 3067.97,-3493.24 3082.66,-3485 3102.95,-3473.62 3098.31,-3458.28 3118.66,-3447 3132.57,-3439.29 3148.38,-3433.77 3164.14,-3429.98"/>
<polygon fill="black" stroke="black" points="3164.9,-3433.4 3173.92,-3427.84 3163.41,-3426.56 3164.9,-3433.4"/>
</g>
<!-- log_utils.get_logger&#45;&gt;log_utils.init_logger -->
<g id="edge244" class="edge">
<title>log_utils.get_logger&#45;&gt;log_utils.init_logger</title>
<path fill="none" stroke="black" d="M3173.92,-3445.26C3155.03,-3449.57 3135.45,-3455.69 3118.66,-3465 3098.31,-3476.28 3102.95,-3491.62 3082.66,-3503 3070.84,-3509.63 3057.56,-3514.64 3044.17,-3518.3"/>
<polygon fill="black" stroke="black" points="3043.28,-3514.91 3034.42,-3520.73 3044.97,-3521.71 3043.28,-3514.91"/>
</g>
<!-- embed.main -->
<g id="node156" class="node">
<title>embed.main</title>
<g id="a_node156"><a xlink:title="Embed the file given on the command line.">
<polygon fill="none" stroke="black" points="646.79,-2929 542.79,-2929 542.79,-2893 646.79,-2893 646.79,-2929"/>
<text text-anchor="middle" x="594.79" y="-2907.3" font-family="Times,serif" font-size="14.00">embed.main</text>
</a>
</g>
</g>
<!-- embed.main&#45;&gt;embed.embed_file -->
<g id="edge249" class="edge">
<title>embed.main&#45;&gt;embed.embed_file</title>
<path fill="none" stroke="black" d="M646.89,-2909.24C719.95,-2906.89 858.47,-2903 976.46,-2903 976.46,-2903 976.46,-2903 2175.16,-2903 2349.47,-2903 2391.13,-2873.55 2564.66,-2857 2782.56,-2836.21 3040.08,-2819.59 3169.16,-2811.8"/>
<polygon fill="black" stroke="black" points="3169.59,-2815.28 3179.37,-2811.19 3169.17,-2808.3 3169.59,-2815.28"/>
</g>
<!-- image_io.read_image_meta -->
<g id="node157" class="node">
<title>image_io.read_image_meta</title>
<g id="a_node157"><a xlink:title="Return metadata from ``path.with_suffix(&#39;.md&#39;)``.">
<polygon fill="none" stroke="black" points="3357.16,-1467 3148.16,-1467 3148.16,-1431 3357.16,-1431 3357.16,-1467"/>
<text text-anchor="middle" x="3252.66" y="-1445.3" font-family="Times,serif" font-size="14.00">image_io.read_image_meta</text>
</a>
</g>
</g>
<!-- image_io.read_image_meta&#45;&gt;serde_utils.parse_md -->
<g id="edge250" class="edge">
<title>image_io.read_image_meta&#45;&gt;serde_utils.parse_md</title>
<path fill="none" stroke="black" d="M3357.33,-1435.47C3367.63,-1431.94 3377.61,-1427.53 3386.66,-1422 3408.52,-1408.65 3400.77,-1390.3 3422.66,-1377 3435.65,-1369.1 3450.51,-1363.46 3465.53,-1359.44"/>
<polygon fill="black" stroke="black" points="3466.52,-1362.8 3475.4,-1357.02 3464.86,-1356 3466.52,-1362.8"/>
</g>
<!-- caption._identify_size -->
<g id="node158" class="node">
<title>caption._identify_size</title>
<g id="a_node158"><a xlink:title="Return ``(width, height)`` for ``path`` using ImageMagick.">
<polygon fill="none" stroke="black" points="3945.66,-3285 3775.66,-3285 3775.66,-3249 3945.66,-3249 3945.66,-3285"/>
<text text-anchor="middle" x="3860.66" y="-3263.3" font-family="Times,serif" font-size="14.00">caption._identify_size</text>
</a>
</g>
</g>
<!-- caption._prepare_image -->
<g id="node159" class="node">
<title>caption._prepare_image</title>
<g id="a_node159"><a xlink:title="Resize ``path`` and return the processed JPEG bytes.">
<polygon fill="none" stroke="black" points="3653.16,-3285 3466.16,-3285 3466.16,-3249 3653.16,-3249 3653.16,-3285"/>
<text text-anchor="middle" x="3559.66" y="-3263.3" font-family="Times,serif" font-size="14.00">caption._prepare_image</text>
</a>
</g>
</g>
<!-- caption._prepare_image&#45;&gt;caption._identify_size -->
<g id="edge252" class="edge">
<title>caption._prepare_image&#45;&gt;caption._identify_size</title>
<path fill="none" stroke="black" d="M3653.22,-3267C3688.73,-3267 3729.28,-3267 3764.99,-3267"/>
<polygon fill="black" stroke="black" points="3765.41,-3270.5 3775.41,-3267 3765.41,-3263.5 3765.41,-3270.5"/>
</g>
<!-- caption._guess_chat -->
<g id="node160" class="node">
<title>caption._guess_chat</title>
<g id="a_node160"><a xlink:title="Return chat name for ``path`` relative to ``MEDIA_DIR``.">
<polygon fill="none" stroke="black" points="3940.16,-3423 3781.16,-3423 3781.16,-3387 3940.16,-3387 3940.16,-3423"/>
<text text-anchor="middle" x="3860.66" y="-3401.3" font-family="Times,serif" font-size="14.00">caption._guess_chat</text>
</a>
</g>
</g>
<!-- caption.caption_file -->
<g id="node161" class="node">
<title>caption.caption_file</title>
<g id="a_node161"><a xlink:title="Caption ``path`` with GPT&#45;4o and save ``.caption.json`` beside it.">
<polygon fill="none" stroke="black" points="3330.16,-3209 3175.16,-3209 3175.16,-3173 3330.16,-3173 3330.16,-3209"/>
<text text-anchor="middle" x="3252.66" y="-3187.3" font-family="Times,serif" font-size="14.00">caption.caption_file</text>
</a>
</g>
</g>
<!-- caption.caption_file&#45;&gt;caption_io.has_caption -->
<g id="edge254" class="edge">
<title>caption.caption_file&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M3330.3,-3192.39C3351.61,-3188.75 3372.71,-3180.6 3386.66,-3164 3481.55,-3051.07 3342.32,-1960.7 3422.66,-1837 3435.26,-1817.6 3455.38,-1803.84 3476.32,-1794.15"/>
<polygon fill="black" stroke="black" points="3477.87,-1797.29 3485.65,-1790.11 3475.09,-1790.87 3477.87,-1797.29"/>
</g>
<!-- caption.caption_file&#45;&gt;caption_io.caption_json_path -->
<g id="edge253" class="edge">
<title>caption.caption_file&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M3330.25,-3191.79C3450.27,-3192.22 3671.63,-3189.51 3696.66,-3164 3763.49,-3095.89 3708.5,-2398.31 3732.66,-2306 3755.55,-2218.54 3812.06,-2126.41 3841.37,-2082.41"/>
<polygon fill="black" stroke="black" points="3844.34,-2084.27 3847.02,-2074.02 3838.53,-2080.36 3844.34,-2084.27"/>
</g>
<!-- caption.caption_file&#45;&gt;serde_utils.load_json -->
<g id="edge255" class="edge">
<title>caption.caption_file&#45;&gt;serde_utils.load_json</title>
<path fill="none" stroke="black" d="M3330.49,-3203.75C3442.68,-3220.47 3643.75,-3242.68 3696.66,-3197 3738.15,-3161.18 3717.79,-3005.75 3732.66,-2953 3761.89,-2849.26 3818.53,-2733.83 3845.16,-2682.36"/>
<polygon fill="black" stroke="black" points="3848.4,-2683.71 3849.92,-2673.22 3842.19,-2680.47 3848.4,-2683.71"/>
</g>
<!-- caption.caption_file&#45;&gt;serde_utils.write_json -->
<g id="edge256" class="edge">
<title>caption.caption_file&#45;&gt;serde_utils.write_json</title>
<path fill="none" stroke="black" d="M3330.5,-3185.83C3350.03,-3181.82 3370.13,-3175.1 3386.66,-3164 3410.6,-3147.92 3398.68,-3126.03 3422.66,-3110 3434.77,-3101.9 3448.76,-3096.12 3463.06,-3092.02"/>
<polygon fill="black" stroke="black" points="3464.19,-3095.34 3472.99,-3089.44 3462.43,-3088.57 3464.19,-3095.34"/>
</g>
<!-- caption.caption_file&#45;&gt;caption._prepare_image -->
<g id="edge257" class="edge">
<title>caption.caption_file&#45;&gt;caption._prepare_image</title>
<path fill="none" stroke="black" d="M3330.26,-3208.25C3348.8,-3212.75 3368.51,-3217.8 3386.66,-3223 3402.87,-3227.64 3406.43,-3230.4 3422.66,-3235 3436.92,-3239.05 3452.12,-3242.98 3467,-3246.63"/>
<polygon fill="black" stroke="black" points="3466.18,-3250.04 3476.72,-3248.99 3467.83,-3243.23 3466.18,-3250.04"/>
</g>
<!-- caption.caption_file&#45;&gt;caption._guess_chat -->
<g id="edge258" class="edge">
<title>caption.caption_file&#45;&gt;caption._guess_chat</title>
<path fill="none" stroke="black" d="M3282.3,-3209.16C3310.82,-3228.12 3354.81,-3259.81 3386.66,-3294 3406.32,-3315.11 3398.16,-3332.77 3422.66,-3348 3528.76,-3413.97 3677.32,-3418.97 3770.99,-3413.94"/>
<polygon fill="black" stroke="black" points="3771.23,-3417.43 3781.01,-3413.35 3770.82,-3410.45 3771.23,-3417.43"/>
</g>
<!-- caption.main -->
<g id="node162" class="node">
<title>caption.main</title>
<g id="a_node162"><a xlink:title="Caption a single image provided on the command line.">
<polygon fill="none" stroke="black" points="3009.66,-3155 2900.66,-3155 2900.66,-3119 3009.66,-3119 3009.66,-3155"/>
<text text-anchor="middle" x="2955.16" y="-3133.3" font-family="Times,serif" font-size="14.00">caption.main</text>
</a>
</g>
</g>
<!-- caption.main&#45;&gt;caption.caption_file -->
<g id="edge259" class="edge">
<title>caption.main&#45;&gt;caption.caption_file</title>
<path fill="none" stroke="black" d="M3009.67,-3146.78C3052.94,-3154.69 3114.71,-3165.97 3165.02,-3175.17"/>
<polygon fill="black" stroke="black" points="3164.45,-3178.62 3174.92,-3176.98 3165.71,-3171.74 3164.45,-3178.62"/>
</g>
<!-- price_utils.canonical_currency -->
<g id="node163" class="node">
<title>price_utils.canonical_currency</title>
<g id="a_node163"><a xlink:title="Return canonical currency code or ``None`` when unknown.">
<polygon fill="none" stroke="black" points="3368.66,-3869 3136.66,-3869 3136.66,-3833 3368.66,-3833 3368.66,-3869"/>
<text text-anchor="middle" x="3252.66" y="-3847.3" font-family="Times,serif" font-size="14.00">price_utils.canonical_currency</text>
</a>
</g>
</g>
<!-- price_utils.train_price_regression&#45;&gt;price_utils.canonical_currency -->
<g id="edge260" class="edge">
<title>price_utils.train_price_regression&#45;&gt;price_utils.canonical_currency</title>
<path fill="none" stroke="black" d="M3082.76,-3843C3097.13,-3843.68 3111.78,-3844.37 3126.13,-3845.05"/>
<polygon fill="black" stroke="black" points="3126.37,-3848.57 3136.53,-3845.55 3126.7,-3841.58 3126.37,-3848.57"/>
</g>
<!-- build_site -->
<g id="node168" class="node">
<title>build_site</title>
<ellipse fill="none" stroke="black" cx="89" cy="-2934" rx="55.79" ry="18"/>
<text text-anchor="middle" x="89" y="-2930.3" font-family="Times,serif" font-size="14.00">build_site</text>
</g>
<!-- build_site&#45;&gt;build_site.main -->
<g id="edge265" class="edge">
<title>build_site:cli&#45;&gt;build_site.main</title>
<path fill="none" stroke="black" d="M99.75,-2951.83C144.62,-3031.27 339.96,-3349 593.79,-3349 593.79,-3349 593.79,-3349 1933.16,-3349 2137.15,-3349 2329.91,-3540.86 2393.88,-3611.39"/>
<polygon fill="black" stroke="black" points="2391.41,-3613.88 2400.7,-3618.98 2396.62,-3609.2 2391.41,-3613.88"/>
</g>
<!-- embed -->
<g id="node169" class="node">
<title>embed</title>
<ellipse fill="none" stroke="black" cx="343.5" cy="-2911" rx="42.49" ry="18"/>
<text text-anchor="middle" x="343.5" y="-2907.3" font-family="Times,serif" font-size="14.00">embed</text>
</g>
<!-- build_site&#45;&gt;embed -->
<!-- embed&#45;&gt;embed.main -->
<g id="edge267" class="edge">
<title>embed:cli&#45;&gt;embed.main</title>
<path fill="none" stroke="black" d="M385.95,-2911C425.98,-2911 487.08,-2911 532.69,-2911"/>
<polygon fill="black" stroke="black" points="532.75,-2914.5 542.75,-2911 532.75,-2907.5 532.75,-2914.5"/>
</g>
<!-- caption -->
<g id="node170" class="node">
<title>caption</title>
<ellipse fill="none" stroke="black" cx="594.79" cy="-2857" rx="44.69" ry="18"/>
<text text-anchor="middle" x="594.79" y="-2853.3" font-family="Times,serif" font-size="14.00">caption</text>
</g>
<!-- embed&#45;&gt;caption -->
<!-- caption&#45;&gt;caption.main -->
<g id="edge269" class="edge">
<title>caption:cli&#45;&gt;caption.main</title>
<path fill="none" stroke="black" d="M639.75,-2858.52C710.61,-2860.84 854.5,-2865 976.46,-2865 976.46,-2865 976.46,-2865 2175.16,-2865 2475.77,-2865 2806.99,-3047.77 2916.65,-3113.67"/>
<polygon fill="black" stroke="black" points="2915,-3116.76 2925.36,-3118.94 2918.62,-3110.77 2915,-3116.76"/>
</g>
<!-- tg_client -->
<g id="node171" class="node">
<title>tg_client</title>
<ellipse fill="none" stroke="black" cx="793.93" cy="-2484" rx="50.89" ry="18"/>
<text text-anchor="middle" x="793.93" y="-2480.3" font-family="Times,serif" font-size="14.00">tg_client</text>
</g>
<!-- caption&#45;&gt;tg_client -->
<!-- tg_client&#45;&gt;tg_client.main -->
<g id="edge271" class="edge">
<title>tg_client:cli&#45;&gt;tg_client.main</title>
<path fill="none" stroke="black" d="M797.19,-2465.99C816.2,-2314.64 949.24,-1255.74 972.88,-1067.56"/>
<polygon fill="black" stroke="black" points="976.38,-1067.73 974.16,-1057.37 969.44,-1066.85 976.38,-1067.73"/>
</g>
<!-- debug_dump -->
<g id="node172" class="node">
<title>debug_dump</title>
<ellipse fill="none" stroke="black" cx="977.46" cy="-2484" rx="70.39" ry="18"/>
<text text-anchor="middle" x="977.46" y="-2480.3" font-family="Times,serif" font-size="14.00">debug_dump</text>
</g>
<!-- tg_client&#45;&gt;debug_dump -->
<!-- debug_dump&#45;&gt;debug_dump.main -->
<g id="edge273" class="edge">
<title>debug_dump:cli&#45;&gt;debug_dump.main</title>
<path fill="none" stroke="black" d="M1044.14,-2489.71C1128.21,-2496.53 1278.4,-2507 1407.16,-2507 1407.16,-2507 1407.16,-2507 2418.16,-2507 2504.56,-2507 2743.13,-2547.2 2870.87,-2569.88"/>
<polygon fill="black" stroke="black" points="2870.54,-2573.37 2881,-2571.68 2871.77,-2566.48 2870.54,-2573.37"/>
</g>
<!-- chop -->
<g id="node173" class="node">
<title>chop</title>
<ellipse fill="none" stroke="black" cx="1174.16" cy="-2461" rx="32.49" ry="18"/>
<text text-anchor="middle" x="1174.16" y="-2457.3" font-family="Times,serif" font-size="14.00">chop</text>
</g>
<!-- debug_dump&#45;&gt;chop -->
<!-- chop&#45;&gt;chop.main -->
<g id="edge275" class="edge">
<title>chop:cli&#45;&gt;chop.main</title>
<path fill="none" stroke="black" d="M1206.85,-2461.87C1285.07,-2463.94 1493.64,-2469 1667.66,-2469 1667.66,-2469 1667.66,-2469 2175.16,-2469 2339.61,-2469 2531.65,-2432.72 2623.24,-2413.16"/>
<polygon fill="black" stroke="black" points="2624.07,-2416.56 2633.11,-2411.03 2622.6,-2409.72 2624.07,-2416.56"/>
</g>
<!-- clean_data -->
<g id="node174" class="node">
<title>clean_data</title>
<ellipse fill="none" stroke="black" cx="1408.16" cy="-2423" rx="59.59" ry="18"/>
<text text-anchor="middle" x="1408.16" y="-2419.3" font-family="Times,serif" font-size="14.00">clean_data</text>
</g>
<!-- chop&#45;&gt;clean_data -->
<!-- clean_data&#45;&gt;clean_data.main -->
<g id="edge277" class="edge">
<title>clean_data:cli&#45;&gt;clean_data.main</title>
<path fill="none" stroke="black" d="M1461.8,-2431C1572.09,-2445.85 1834.46,-2471.08 2042.66,-2412 2428.71,-2302.45 2818.46,-1986.98 2925.48,-1895.9"/>
<polygon fill="black" stroke="black" points="2927.94,-1898.4 2933.27,-1889.24 2923.39,-1893.08 2927.94,-1898.4"/>
</g>
<!-- moderation -->
<g id="node175" class="node">
<title>moderation</title>
<ellipse fill="none" stroke="black" cx="1668.66" cy="-2385" rx="63.89" ry="18"/>
<text text-anchor="middle" x="1668.66" y="-2381.3" font-family="Times,serif" font-size="14.00">moderation</text>
</g>
<!-- clean_data&#45;&gt;moderation -->
<!-- moderation&#45;&gt;moderation.apply_to_history -->
<g id="edge279" class="edge">
<title>moderation:cli&#45;&gt;moderation.apply_to_history</title>
<path fill="none" stroke="black" d="M1670.02,-2366.79C1673.76,-2231.26 1715.4,-1385 2173.16,-1385 2173.16,-1385 2173.16,-1385 2418.16,-1385 2718.43,-1385 2807.09,-1382.26 3082.66,-1263 3100.54,-1255.26 3100.74,-1245.65 3118.66,-1238 3123.48,-1235.94 3128.46,-1234.04 3133.55,-1232.28"/>
<polygon fill="black" stroke="black" points="3135.01,-1235.48 3143.44,-1229.06 3132.85,-1228.82 3135.01,-1235.48"/>
</g>
<!-- scan_ontology -->
<g id="node176" class="node">
<title>scan_ontology</title>
<ellipse fill="none" stroke="black" cx="1932.16" cy="-2385" rx="76.09" ry="18"/>
<text text-anchor="middle" x="1932.16" y="-2381.3" font-family="Times,serif" font-size="14.00">scan_ontology</text>
</g>
<!-- moderation&#45;&gt;scan_ontology -->
<!-- scan_ontology&#45;&gt;scan_ontology.main -->
<g id="edge281" class="edge">
<title>scan_ontology:cli&#45;&gt;scan_ontology.main</title>
<path fill="none" stroke="black" d="M1958.77,-2402.18C2070.17,-2476.89 2512.75,-2773.73 2641.72,-2860.23"/>
<polygon fill="black" stroke="black" points="2639.85,-2863.19 2650.11,-2865.86 2643.75,-2857.38 2639.85,-2863.19"/>
</g>
<!-- telegram_bot -->
<g id="node177" class="node">
<title>telegram_bot</title>
<ellipse fill="none" stroke="black" cx="2174.16" cy="-1650" rx="72.29" ry="18"/>
<text text-anchor="middle" x="2174.16" y="-1646.3" font-family="Times,serif" font-size="14.00">telegram_bot</text>
</g>
<!-- scan_ontology&#45;&gt;telegram_bot -->
<!-- telegram_bot&#45;&gt;telegram_bot.send_alert -->
<g id="edge283" class="edge">
<title>telegram_bot:cli&#45;&gt;telegram_bot.send_alert</title>
<path fill="none" stroke="black" d="M2219.36,-1635.88C2255.84,-1624.22 2308.18,-1607.5 2349.71,-1594.23"/>
<polygon fill="black" stroke="black" points="2351.01,-1597.49 2359.47,-1591.11 2348.88,-1590.82 2351.01,-1597.49"/>
</g>
<!-- telegram_bot&#45;&gt;telegram_bot.main -->
<g id="edge284" class="edge">
<title>telegram_bot:cli&#45;&gt;telegram_bot.main</title>
<path fill="none" stroke="black" d="M2246.49,-1650C2273.07,-1650 2303.5,-1650 2331.18,-1650"/>
<polygon fill="black" stroke="black" points="2331.24,-1653.5 2341.24,-1650 2331.24,-1646.5 2331.24,-1653.5"/>
</g>
</g>
</svg>
