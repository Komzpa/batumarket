<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: callgraph Pages: 1 -->
<svg width="10275pt" height="6092pt"
 viewBox="0.00 0.00 10275.00 6092.03" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 6088.03)">
<title>callgraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-6088.03 10271,-6088.03 10271,4 -4,4"/>
<!-- testing_mode.apply_testing_mode -->
<g id="node1" class="node">
<title>testing_mode.apply_testing_mode</title>
<g id="a_node1"><a xlink:title="Tweak environment variables when ``TEST_MODE`` is set.">
<polygon fill="none" stroke="black" points="282,-64.53 0,-64.53 0,-28.53 282,-28.53 282,-64.53"/>
<text text-anchor="middle" x="141" y="-42.49" font-family="Times,serif" font-size="15.68">testing_mode.apply_testing_mode</text>
</a>
</g>
</g>
<!-- moderation:cli -->
<g id="node2" class="node">
<title>moderation:cli</title>
<g id="a_node2"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="602" cy="-46.53" rx="38.53" ry="18"/>
<text text-anchor="middle" x="602" y="-44.93" font-family="Times,serif" font-size="7.00">moderation:cli</text>
</a>
</g>
</g>
<!-- testing_mode.apply_testing_mode&#45;&gt;moderation:cli -->
<!-- clean_data:cli -->
<g id="node183" class="node">
<title>clean_data:cli</title>
<g id="a_node183"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="1278.5" cy="-46.53" rx="37.29" ry="18"/>
<text text-anchor="middle" x="1278.5" y="-44.93" font-family="Times,serif" font-size="7.00">clean_data:cli</text>
</a>
</g>
</g>
<!-- moderation:cli&#45;&gt;clean_data:cli -->
<!-- token_utils.estimate_tokens -->
<g id="node3" class="node">
<title>token_utils.estimate_tokens</title>
<g id="a_node3"><a xlink:title="Return a naive token count approximation.">
<polygon fill="none" stroke="black" points="7595,-476.53 7359,-476.53 7359,-440.53 7595,-440.53 7595,-476.53"/>
<text text-anchor="middle" x="7477" y="-454.49" font-family="Times,serif" font-size="15.68">token_utils.estimate_tokens</text>
</a>
</g>
</g>
<!-- moderation.should_skip_text -->
<g id="node4" class="node">
<title>moderation.should_skip_text</title>
<g id="a_node4"><a xlink:title="Return ``True`` if ``text`` contains banned phrases.">
<polygon fill="none" stroke="black" points="10143.5,-124.53 9855.5,-124.53 9855.5,-88.53 10143.5,-88.53 10143.5,-124.53"/>
<text text-anchor="middle" x="9999.5" y="-101.75" font-family="Times,serif" font-size="18.48">moderation.should_skip_text</text>
</a>
</g>
</g>
<!-- moderation.should_skip_user -->
<g id="node5" class="node">
<title>moderation.should_skip_user</title>
<g id="a_node5"><a xlink:title="Return ``True`` if ``username`` is blacklisted.">
<polygon fill="none" stroke="black" points="10123.5,-178.53 9875.5,-178.53 9875.5,-142.53 10123.5,-142.53 10123.5,-178.53"/>
<text text-anchor="middle" x="9999.5" y="-156.49" font-family="Times,serif" font-size="15.68">moderation.should_skip_user</text>
</a>
</g>
</g>
<!-- moderation.message_skip_reason -->
<g id="node6" class="node">
<title>moderation.message_skip_reason</title>
<g id="a_node6"><a xlink:title="Return the moderation reason for ``meta`` and ``text`` or ``None``.">
<polygon fill="none" stroke="black" points="9647,-156.03 9057,-156.03 9057,-111.03 9647,-111.03 9647,-156.03"/>
<text text-anchor="middle" x="9352" y="-125.15" font-family="Times,serif" font-size="33.60">moderation.message_skip_reason</text>
</a>
</g>
</g>
<!-- moderation.message_skip_reason&#45;&gt;moderation.should_skip_text -->
<g id="edge2" class="edge">
<title>moderation.message_skip_reason&#45;&gt;moderation.should_skip_text</title>
<path fill="none" stroke="black" d="M9647.42,-121.22C9715.78,-118.36 9785.86,-115.43 9845.24,-112.94"/>
<polygon fill="black" stroke="black" points="9845.59,-116.43 9855.44,-112.52 9845.3,-109.44 9845.59,-116.43"/>
</g>
<!-- moderation.message_skip_reason&#45;&gt;moderation.should_skip_user -->
<g id="edge3" class="edge">
<title>moderation.message_skip_reason&#45;&gt;moderation.should_skip_user</title>
<path fill="none" stroke="black" d="M9647.42,-145.85C9723.64,-149.04 9801.99,-152.31 9865.28,-154.96"/>
<polygon fill="black" stroke="black" points="9865.16,-158.46 9875.3,-155.38 9865.46,-151.47 9865.16,-158.46"/>
</g>
<!-- moderation.should_skip_message -->
<g id="node7" class="node">
<title>moderation.should_skip_message</title>
<g id="a_node7"><a xlink:title="Return ``True`` when the raw Telegram message should be ignored.">
<polygon fill="none" stroke="black" points="8682,-1578.53 8348,-1578.53 8348,-1542.53 8682,-1542.53 8682,-1578.53"/>
<text text-anchor="middle" x="8515" y="-1555.75" font-family="Times,serif" font-size="18.48">moderation.should_skip_message</text>
</a>
</g>
</g>
<!-- moderation.should_skip_message&#45;&gt;moderation.message_skip_reason -->
<g id="edge4" class="edge">
<title>moderation.should_skip_message&#45;&gt;moderation.message_skip_reason</title>
<path fill="none" stroke="black" d="M8682.04,-1571.29C8795.76,-1574.64 8932.82,-1569.37 8972,-1528.53 9068.73,-1427.71 8928.13,-386.18 9008,-271.53 9049.53,-211.92 9121.38,-178.05 9188.63,-158.8"/>
<polygon fill="black" stroke="black" points="9189.81,-162.11 9198.51,-156.07 9187.94,-155.36 9189.81,-162.11"/>
</g>
<!-- moderation.lot_skip_reason -->
<g id="node8" class="node">
<title>moderation.lot_skip_reason</title>
<g id="a_node8"><a xlink:title="Return the moderation reason for ``lot`` or ``None``.">
<polygon fill="none" stroke="black" points="9528.5,-3620.53 9175.5,-3620.53 9175.5,-3584.53 9528.5,-3584.53 9528.5,-3620.53"/>
<text text-anchor="middle" x="9352" y="-3596.66" font-family="Times,serif" font-size="24.22">moderation.lot_skip_reason</text>
</a>
</g>
</g>
<!-- moderation.should_skip_lot -->
<g id="node9" class="node">
<title>moderation.should_skip_lot</title>
<g id="a_node9"><a xlink:title="Return ``True`` when the lot fails additional checks.">
<polygon fill="none" stroke="black" points="8653,-3606.53 8377,-3606.53 8377,-3570.53 8653,-3570.53 8653,-3606.53"/>
<text text-anchor="middle" x="8515" y="-3583.75" font-family="Times,serif" font-size="18.48">moderation.should_skip_lot</text>
</a>
</g>
</g>
<!-- moderation.should_skip_lot&#45;&gt;moderation.lot_skip_reason -->
<g id="edge5" class="edge">
<title>moderation.should_skip_lot&#45;&gt;moderation.lot_skip_reason</title>
<path fill="none" stroke="black" d="M8653.42,-3590.84C8793.05,-3593.18 9010.27,-3596.82 9165.19,-3599.42"/>
<polygon fill="black" stroke="black" points="9165.25,-3602.92 9175.3,-3599.59 9165.36,-3595.92 9165.25,-3602.92"/>
</g>
<!-- moderation.is_misparsed -->
<g id="node10" class="node">
<title>moderation.is_misparsed</title>
<g id="a_node10"><a xlink:title="Return ``True`` for obviously invalid lots or source posts.">
<polygon fill="none" stroke="black" points="7695,-5209.53 7259,-5209.53 7259,-5165.53 7695,-5165.53 7695,-5209.53"/>
<text text-anchor="middle" x="7477" y="-5179.21" font-family="Times,serif" font-size="32.90">moderation.is_misparsed</text>
</a>
</g>
</g>
<!-- lot_io.get_seller -->
<g id="node11" class="node">
<title>lot_io.get_seller</title>
<g id="a_node11"><a xlink:title="Return the seller identifier or ``None`` when missing.">
<polygon fill="none" stroke="black" points="8615.5,-5313.53 8414.5,-5313.53 8414.5,-5277.53 8615.5,-5277.53 8615.5,-5313.53"/>
<text text-anchor="middle" x="8515" y="-5289.94" font-family="Times,serif" font-size="23.24">lot_io.get_seller</text>
</a>
</g>
</g>
<!-- moderation.is_misparsed&#45;&gt;lot_io.get_seller -->
<g id="edge6" class="edge">
<title>moderation.is_misparsed&#45;&gt;lot_io.get_seller</title>
<path fill="none" stroke="black" d="M7649.7,-5209.55C7756.86,-5223.62 7897.6,-5242.71 8022,-5261.53 8038.04,-5263.96 8041.88,-5265.7 8058,-5267.53 8175.74,-5280.92 8311.36,-5288.22 8403.89,-5291.98"/>
<polygon fill="black" stroke="black" points="8403.98,-5295.48 8414.11,-5292.38 8404.26,-5288.49 8403.98,-5295.48"/>
</g>
<!-- moderation.apply_to_history -->
<g id="node12" class="node">
<title>moderation.apply_to_history</title>
<g id="a_node12"><a xlink:title="Remove processed lots now failing moderation.">
<polygon fill="none" stroke="black" points="7737.5,-2426.03 7216.5,-2426.03 7216.5,-2379.03 7737.5,-2379.03 7737.5,-2426.03"/>
<text text-anchor="middle" x="7477" y="-2394.03" font-family="Times,serif" font-size="35.00">moderation.apply_to_history</text>
</a>
</g>
</g>
<!-- moderation.apply_to_history&#45;&gt;moderation.should_skip_message -->
<g id="edge7" class="edge">
<title>moderation.apply_to_history&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M7724.99,-2378.98C7833.32,-2355.28 7951.62,-2308.47 8022,-2216.53 8096.32,-2119.46 7978.97,-1760.82 8058,-1667.53 8125.52,-1587.84 8240.09,-1561.18 8337.5,-1554.4"/>
<polygon fill="black" stroke="black" points="8338.01,-1557.87 8347.77,-1553.75 8337.57,-1550.89 8338.01,-1557.87"/>
</g>
<!-- moderation.apply_to_history&#45;&gt;moderation.should_skip_lot -->
<g id="edge8" class="edge">
<title>moderation.apply_to_history&#45;&gt;moderation.should_skip_lot</title>
<path fill="none" stroke="black" d="M7595.26,-2379C7720.84,-2361.38 7916.26,-2357.27 8022,-2473.53 8098.75,-2557.92 7983.94,-3412.77 8058,-3499.53 8132.18,-3586.44 8263.89,-3604.42 8366.75,-3603.14"/>
<polygon fill="black" stroke="black" points="8366.99,-3606.64 8376.93,-3602.95 8366.86,-3599.64 8366.99,-3606.64"/>
</g>
<!-- oom_utils.prefer_oom_kill -->
<g id="node13" class="node">
<title>oom_utils.prefer_oom_kill</title>
<g id="a_node13"><a xlink:title="Make this process the first OOM victim.">
<polygon fill="none" stroke="black" points="8680,-1463.53 8350,-1463.53 8350,-1427.53 8680,-1427.53 8680,-1463.53"/>
<text text-anchor="middle" x="8515" y="-1439.66" font-family="Times,serif" font-size="24.22">oom_utils.prefer_oom_kill</text>
</a>
</g>
</g>
<!-- moderation.apply_to_history&#45;&gt;oom_utils.prefer_oom_kill -->
<g id="edge9" class="edge">
<title>moderation.apply_to_history&#45;&gt;oom_utils.prefer_oom_kill</title>
<path fill="none" stroke="black" d="M7728.15,-2378.97C7835.96,-2355.22 7952.92,-2308.36 8022,-2216.53 8071.62,-2150.57 8000.07,-1533.34 8058,-1474.53 8158.48,-1372.53 8343.94,-1399.95 8444.61,-1424.99"/>
<polygon fill="black" stroke="black" points="8443.82,-1428.4 8454.38,-1427.48 8445.55,-1421.62 8443.82,-1428.4"/>
</g>
<!-- lot_io.read_lots -->
<g id="node14" class="node">
<title>lot_io.read_lots</title>
<g id="a_node14"><a xlink:title="Return a list of lots from ``path`` or ``None`` when invalid.">
<polygon fill="none" stroke="black" points="8621,-3773.53 8409,-3773.53 8409,-3737.53 8621,-3737.53 8621,-3773.53"/>
<text text-anchor="middle" x="8515" y="-3749.37" font-family="Times,serif" font-size="25.20">lot_io.read_lots</text>
</a>
</g>
</g>
<!-- moderation.apply_to_history&#45;&gt;lot_io.read_lots -->
<g id="edge10" class="edge">
<title>moderation.apply_to_history&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M7594.77,-2379.01C7720.39,-2361.26 7916.31,-2356.91 8022,-2473.53 8107.25,-2567.6 7980.95,-3514.64 8058,-3615.53 8137.13,-3719.14 8291.37,-3748.27 8398.43,-3755.33"/>
<polygon fill="black" stroke="black" points="8398.44,-3758.84 8408.63,-3755.95 8398.86,-3751.85 8398.44,-3758.84"/>
</g>
<!-- post_io.read_post -->
<g id="node15" class="node">
<title>post_io.read_post</title>
<g id="a_node15"><a xlink:title="Return metadata dictionary and body text for ``path``.">
<polygon fill="none" stroke="black" points="8794,-2312.53 8236,-2312.53 8236,-2236.53 8794,-2236.53 8794,-2312.53"/>
<text text-anchor="middle" x="8515" y="-2259.37" font-family="Times,serif" font-size="61.46">post_io.read_post</text>
</a>
</g>
</g>
<!-- moderation.apply_to_history&#45;&gt;post_io.read_post -->
<g id="edge11" class="edge">
<title>moderation.apply_to_history&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7737.65,-2390.3C7827.88,-2384.48 7929.59,-2376.18 8022,-2364.53 8077.04,-2357.6 8199.69,-2335.17 8308.76,-2314.44"/>
<polygon fill="black" stroke="black" points="8309.43,-2317.87 8318.6,-2312.56 8308.12,-2311 8309.43,-2317.87"/>
</g>
<!-- post_io.raw_post_path -->
<g id="node16" class="node">
<title>post_io.raw_post_path</title>
<g id="a_node16"><a xlink:title="Return absolute message path for ``rel`` under ``root``.">
<polygon fill="none" stroke="black" points="8591.5,-2851.53 8438.5,-2851.53 8438.5,-2815.53 8591.5,-2815.53 8591.5,-2851.53"/>
<text text-anchor="middle" x="8515" y="-2830.29" font-family="Times,serif" font-size="12.18">post_io.raw_post_path</text>
</a>
</g>
</g>
<!-- moderation.apply_to_history&#45;&gt;post_io.raw_post_path -->
<g id="edge12" class="edge">
<title>moderation.apply_to_history&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7737.83,-2387.51C7834.48,-2393.84 7940.38,-2416.15 8022,-2473.53 8050.62,-2493.65 8034.42,-2517.69 8058,-2543.53 8177.56,-2674.56 8369.23,-2770.22 8461.29,-2811.29"/>
<polygon fill="black" stroke="black" points="8460.12,-2814.6 8470.69,-2815.45 8462.96,-2808.2 8460.12,-2814.6"/>
</g>
<!-- notes_utils.load_json -->
<g id="node28" class="node">
<title>notes_utils.load_json</title>
<g id="a_node28"><a xlink:title="Return parsed JSON or ``None`` when invalid.">
<polygon fill="none" stroke="black" points="9476,-3485.53 9228,-3485.53 9228,-3449.53 9476,-3449.53 9476,-3485.53"/>
<text text-anchor="middle" x="9352" y="-3461.84" font-family="Times,serif" font-size="22.12">notes_utils.load_json</text>
</a>
</g>
</g>
<!-- lot_io.read_lots&#45;&gt;notes_utils.load_json -->
<g id="edge242" class="edge">
<title>lot_io.read_lots&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M8589.24,-3773.6C8688.28,-3793.33 8864.85,-3811.16 8972,-3720.53 9022.7,-3677.65 8962.52,-3623.91 9008,-3575.53 9062.01,-3518.08 9146.23,-3491.03 9217.69,-3478.37"/>
<polygon fill="black" stroke="black" points="9218.41,-3481.8 9227.68,-3476.68 9217.24,-3474.89 9218.41,-3481.8"/>
</g>
<!-- lot_io._clean_lot -->
<g id="node146" class="node">
<title>lot_io._clean_lot</title>
<g id="a_node146"><a xlink:title="Return ``lot`` without empty or null fields.">
<polygon fill="none" stroke="black" points="9409.5,-3792.53 9294.5,-3792.53 9294.5,-3756.53 9409.5,-3756.53 9409.5,-3792.53"/>
<text text-anchor="middle" x="9352" y="-3771.29" font-family="Times,serif" font-size="12.18">lot_io._clean_lot</text>
</a>
</g>
</g>
<!-- lot_io.read_lots&#45;&gt;lot_io._clean_lot -->
<g id="edge243" class="edge">
<title>lot_io.read_lots&#45;&gt;lot_io._clean_lot</title>
<path fill="none" stroke="black" d="M8621.33,-3757.93C8795.7,-3761.9 9139.44,-3769.72 9284.22,-3773.01"/>
<polygon fill="black" stroke="black" points="9284.22,-3776.51 9294.29,-3773.24 9284.37,-3769.52 9284.22,-3776.51"/>
</g>
<!-- notes_utils.read_md -->
<g id="node119" class="node">
<title>notes_utils.read_md</title>
<g id="a_node119"><a xlink:title="Alias for :func:`read_text` used for Markdown files.">
<polygon fill="none" stroke="black" points="9422,-2166.53 9282,-2166.53 9282,-2130.53 9422,-2130.53 9422,-2166.53"/>
<text text-anchor="middle" x="9352" y="-2145.29" font-family="Times,serif" font-size="12.18">notes_utils.read_md</text>
</a>
</g>
</g>
<!-- post_io.read_post&#45;&gt;notes_utils.read_md -->
<g id="edge251" class="edge">
<title>post_io.read_post&#45;&gt;notes_utils.read_md</title>
<path fill="none" stroke="black" d="M8764.37,-2236.49C8842.35,-2224.6 8928.75,-2211.47 9008,-2199.53 9098.36,-2185.93 9202.15,-2170.53 9271.68,-2160.24"/>
<polygon fill="black" stroke="black" points="9272.3,-2163.69 9281.68,-2158.76 9271.28,-2156.77 9272.3,-2163.69"/>
</g>
<!-- notes_utils._parse_block -->
<g id="node121" class="node">
<title>notes_utils._parse_block</title>
<g id="a_node121"><a xlink:title="Return metadata dict and remaining body from ``text``.">
<polygon fill="none" stroke="black" points="9521,-2246.03 9183,-2246.03 9183,-2209.03 9521,-2209.03 9521,-2246.03"/>
<text text-anchor="middle" x="9352" y="-2221.09" font-family="Times,serif" font-size="26.18">notes_utils._parse_block</text>
</a>
</g>
</g>
<!-- post_io.read_post&#45;&gt;notes_utils._parse_block -->
<g id="edge252" class="edge">
<title>post_io.read_post&#45;&gt;notes_utils._parse_block</title>
<path fill="none" stroke="black" d="M8794.04,-2258.88C8918.83,-2251.86 9062.4,-2243.78 9172.52,-2237.58"/>
<polygon fill="black" stroke="black" points="9172.95,-2241.06 9182.73,-2237 9172.55,-2234.07 9172.95,-2241.06"/>
</g>
<!-- clean_data._parse_date -->
<g id="node17" class="node">
<title>clean_data._parse_date</title>
<g id="a_node17"><a xlink:title="Return the ``date`` field from a markdown file if present.">
<polygon fill="none" stroke="black" points="8654.5,-2404.53 8375.5,-2404.53 8375.5,-2368.53 8654.5,-2368.53 8654.5,-2404.53"/>
<text text-anchor="middle" x="8515" y="-2380.84" font-family="Times,serif" font-size="22.12">clean_data._parse_date</text>
</a>
</g>
</g>
<!-- notes_utils.read_text -->
<g id="node18" class="node">
<title>notes_utils.read_text</title>
<g id="a_node18"><a xlink:title="Return file contents as UTF&#45;8 or empty string when missing.">
<polygon fill="none" stroke="black" points="10106.5,-2381.53 9892.5,-2381.53 9892.5,-2345.53 10106.5,-2345.53 10106.5,-2381.53"/>
<text text-anchor="middle" x="9999.5" y="-2358.75" font-family="Times,serif" font-size="18.48">notes_utils.read_text</text>
</a>
</g>
</g>
<!-- clean_data._parse_date&#45;&gt;notes_utils.read_text -->
<g id="edge13" class="edge">
<title>clean_data._parse_date&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M8654.8,-2384.38C8945.11,-2379.88 9611.83,-2369.53 9881.8,-2365.34"/>
<polygon fill="black" stroke="black" points="9882.08,-2368.84 9892.02,-2365.19 9881.97,-2361.84 9882.08,-2368.84"/>
</g>
<!-- notes_utils.read_text&#45;&gt;notes_utils.read_text -->
<g id="edge184" class="edge">
<title>notes_utils.read_text&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M9892.36,-2378.04C9855.6,-2388.76 9891.31,-2399.53 9999.5,-2399.53 10095.86,-2399.53 10134.73,-2390.99 10116.1,-2381.55"/>
<polygon fill="black" stroke="black" points="10117.23,-2378.23 10106.64,-2378.04 10114.8,-2384.8 10117.23,-2378.23"/>
</g>
<!-- clean_data._clean_raw -->
<g id="node19" class="node">
<title>clean_data._clean_raw</title>
<g id="a_node19"><a xlink:title="Delete raw posts older than ``cutoff``.">
<polygon fill="none" stroke="black" points="7630.5,-2610.53 7323.5,-2610.53 7323.5,-2574.53 7630.5,-2574.53 7630.5,-2610.53"/>
<text text-anchor="middle" x="7477" y="-2586.37" font-family="Times,serif" font-size="25.20">clean_data._clean_raw</text>
</a>
</g>
</g>
<!-- clean_data._clean_raw&#45;&gt;post_io.raw_post_path -->
<g id="edge15" class="edge">
<title>clean_data._clean_raw&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7630.7,-2585.58C7740.87,-2584.06 7892.41,-2589.2 8022,-2619.53 8199.5,-2661.08 8393.15,-2764.17 8474.52,-2810.43"/>
<polygon fill="black" stroke="black" points="8473,-2813.59 8483.42,-2815.52 8476.48,-2807.51 8473,-2813.59"/>
</g>
<!-- clean_data._clean_raw&#45;&gt;clean_data._parse_date -->
<g id="edge14" class="edge">
<title>clean_data._clean_raw&#45;&gt;clean_data._parse_date</title>
<path fill="none" stroke="black" d="M7630.62,-2600.12C7768.74,-2604.06 7959.79,-2601.31 8022,-2560.53 8051.59,-2541.14 8030.09,-2511.28 8058,-2489.53 8145.19,-2421.61 8268.65,-2396.8 8365.13,-2388.46"/>
<polygon fill="black" stroke="black" points="8365.58,-2391.94 8375.27,-2387.64 8365.02,-2384.96 8365.58,-2391.94"/>
</g>
<!-- clean_data._clean_media -->
<g id="node20" class="node">
<title>clean_data._clean_media</title>
<g id="a_node20"><a xlink:title="Remove unused media files older than ``cutoff``.">
<polygon fill="none" stroke="black" points="7667,-1764.53 7287,-1764.53 7287,-1724.53 7667,-1724.53 7667,-1764.53"/>
<text text-anchor="middle" x="7477" y="-1737.46" font-family="Times,serif" font-size="28.84">clean_data._clean_media</text>
</a>
</g>
</g>
<!-- clean_data._clean_media&#45;&gt;clean_data._parse_date -->
<g id="edge16" class="edge">
<title>clean_data._clean_media&#45;&gt;clean_data._parse_date</title>
<path fill="none" stroke="black" d="M7667.2,-1729.05C7804.01,-1722.42 7973.05,-1725.18 8022,-1773.53 8108.83,-1859.3 7975.04,-2232.02 8058,-2321.53 8144.62,-2415 8300.1,-2417.29 8405.14,-2405.7"/>
<polygon fill="black" stroke="black" points="8405.62,-2409.17 8415.15,-2404.54 8404.81,-2402.21 8405.62,-2409.17"/>
</g>
<!-- caption_io.has_caption -->
<g id="node21" class="node">
<title>caption_io.has_caption</title>
<g id="a_node21"><a xlink:title="Return ``True`` when any caption exists for ``image``.">
<polygon fill="none" stroke="black" points="8592.5,-969.53 8437.5,-969.53 8437.5,-933.53 8592.5,-933.53 8592.5,-969.53"/>
<text text-anchor="middle" x="8515" y="-948.29" font-family="Times,serif" font-size="12.18">caption_io.has_caption</text>
</a>
</g>
</g>
<!-- clean_data._clean_media&#45;&gt;caption_io.has_caption -->
<g id="edge17" class="edge">
<title>clean_data._clean_media&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M7667.21,-1745.93C7804.53,-1742.56 7974.24,-1727.82 8022,-1677.53 8099.63,-1595.8 7994.71,-1264.82 8058,-1171.53 8143.1,-1046.11 8320.45,-989.84 8427.16,-966.46"/>
<polygon fill="black" stroke="black" points="8428.22,-969.82 8437.26,-964.3 8426.75,-962.97 8428.22,-969.82"/>
</g>
<!-- caption_io.caption_json_path -->
<g id="node98" class="node">
<title>caption_io.caption_json_path</title>
<g id="a_node98"><a xlink:title="Return new&#45;style caption path for ``image``.">
<polygon fill="none" stroke="black" points="9448.5,-1668.53 9255.5,-1668.53 9255.5,-1632.53 9448.5,-1632.53 9448.5,-1668.53"/>
<text text-anchor="middle" x="9352" y="-1647.29" font-family="Times,serif" font-size="12.18">caption_io.caption_json_path</text>
</a>
</g>
</g>
<!-- caption_io.has_caption&#45;&gt;caption_io.caption_json_path -->
<g id="edge298" class="edge">
<title>caption_io.has_caption&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M8592.89,-944.04C8696.57,-938.69 8878.93,-946.92 8972,-1056.53 9053.71,-1152.78 8919.4,-1533.59 9008,-1623.53 9075.43,-1691.99 9193.56,-1685.08 9272.04,-1670.48"/>
<polygon fill="black" stroke="black" points="9272.74,-1673.91 9281.89,-1668.57 9271.4,-1667.04 9272.74,-1673.91"/>
</g>
<!-- caption_io.caption_md_path -->
<g id="node101" class="node">
<title>caption_io.caption_md_path</title>
<g id="a_node101"><a xlink:title="Return legacy Markdown caption path for ``image``.">
<polygon fill="none" stroke="black" points="9445.5,-1614.53 9258.5,-1614.53 9258.5,-1578.53 9445.5,-1578.53 9445.5,-1614.53"/>
<text text-anchor="middle" x="9352" y="-1593.29" font-family="Times,serif" font-size="12.18">caption_io.caption_md_path</text>
</a>
</g>
</g>
<!-- caption_io.has_caption&#45;&gt;caption_io.caption_md_path -->
<g id="edge299" class="edge">
<title>caption_io.has_caption&#45;&gt;caption_io.caption_md_path</title>
<path fill="none" stroke="black" d="M8592.79,-952.78C8689.12,-957.8 8855.76,-978.27 8972,-1056.53 9175.55,-1193.58 9303.85,-1479.45 9340.29,-1569.06"/>
<polygon fill="black" stroke="black" points="9337.11,-1570.55 9344.09,-1578.52 9343.61,-1567.94 9337.11,-1570.55"/>
</g>
<!-- clean_data._clean_lots -->
<g id="node22" class="node">
<title>clean_data._clean_lots</title>
<g id="a_node22"><a xlink:title="Drop lots missing translations or source posts.">
<polygon fill="none" stroke="black" points="7679,-2674.53 7275,-2674.53 7275,-2628.53 7679,-2628.53 7679,-2674.53"/>
<text text-anchor="middle" x="7477" y="-2643.09" font-family="Times,serif" font-size="34.30">clean_data._clean_lots</text>
</a>
</g>
</g>
<!-- clean_data._clean_lots&#45;&gt;lot_io.read_lots -->
<g id="edge19" class="edge">
<title>clean_data._clean_lots&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M7679.01,-2636.32C7813.89,-2630.99 7975.15,-2635.73 8022,-2683.53 8094.54,-2757.55 7994.81,-3533.4 8058,-3615.53 8137.49,-3718.86 8291.65,-3748.05 8398.59,-3755.21"/>
<polygon fill="black" stroke="black" points="8398.59,-3758.71 8408.79,-3755.83 8399.02,-3751.73 8398.59,-3758.71"/>
</g>
<!-- clean_data._clean_lots&#45;&gt;post_io.raw_post_path -->
<g id="edge20" class="edge">
<title>clean_data._clean_lots&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7679.25,-2652.03C7782.42,-2655.14 7909.67,-2663.4 8022,-2683.53 8184.41,-2712.64 8368.67,-2777.87 8458.64,-2811.92"/>
<polygon fill="black" stroke="black" points="8457.51,-2815.23 8468.1,-2815.51 8459.99,-2808.69 8457.51,-2815.23"/>
</g>
<!-- lot_io.needs_cleanup -->
<g id="node23" class="node">
<title>lot_io.needs_cleanup</title>
<g id="a_node23"><a xlink:title="Return ``True`` when ``clean_data`` would drop ``lots``.">
<polygon fill="none" stroke="black" points="8604.5,-1519.53 8425.5,-1519.53 8425.5,-1483.53 8604.5,-1483.53 8604.5,-1519.53"/>
<text text-anchor="middle" x="8515" y="-1497.49" font-family="Times,serif" font-size="15.68">lot_io.needs_cleanup</text>
</a>
</g>
</g>
<!-- clean_data._clean_lots&#45;&gt;lot_io.needs_cleanup -->
<g id="edge18" class="edge">
<title>clean_data._clean_lots&#45;&gt;lot_io.needs_cleanup</title>
<path fill="none" stroke="black" d="M7679.09,-2666.82C7814.01,-2672.19 7975.28,-2667.47 8022,-2619.53 8106.27,-2533.08 7974.22,-1620.47 8058,-1533.53 8105.49,-1484.26 8295.97,-1486.85 8415.21,-1493.79"/>
<polygon fill="black" stroke="black" points="8415.26,-1497.3 8425.45,-1494.41 8415.68,-1490.31 8415.26,-1497.3"/>
</g>
<!-- clean_data._clean_embeddings -->
<g id="node24" class="node">
<title>clean_data._clean_embeddings</title>
<g id="a_node24"><a xlink:title="Delete embedding files when the matching lot JSON is absent.">
<polygon fill="none" stroke="black" points="7685,-2518.53 7269,-2518.53 7269,-2482.53 7685,-2482.53 7685,-2518.53"/>
<text text-anchor="middle" x="7477" y="-2494.37" font-family="Times,serif" font-size="25.20">clean_data._clean_embeddings</text>
</a>
</g>
</g>
<!-- clean_data._remove_empty_dirs -->
<g id="node25" class="node">
<title>clean_data._remove_empty_dirs</title>
<g id="a_node25"><a xlink:title="Recursively remove empty folders under ``root``.">
<polygon fill="none" stroke="black" points="8728.5,-2534.53 8301.5,-2534.53 8301.5,-2498.53 8728.5,-2498.53 8728.5,-2534.53"/>
<text text-anchor="middle" x="8515" y="-2510.37" font-family="Times,serif" font-size="25.20">clean_data._remove_empty_dirs</text>
</a>
</g>
</g>
<!-- clean_data.main -->
<g id="node26" class="node">
<title>clean_data.main</title>
<g id="a_node26"><a xlink:title="Clean up old or inconsistent files across data directories.">
<polygon fill="none" stroke="black" points="6469,-2598.53 6277,-2598.53 6277,-2562.53 6469,-2562.53 6469,-2598.53"/>
<text text-anchor="middle" x="6373" y="-2575.23" font-family="Times,serif" font-size="21.00">clean_data.main</text>
</a>
</g>
</g>
<!-- clean_data.main&#45;&gt;clean_data._clean_raw -->
<g id="edge21" class="edge">
<title>clean_data.main&#45;&gt;clean_data._clean_raw</title>
<path fill="none" stroke="black" d="M6469.39,-2581.57C6657.83,-2583.62 7079.72,-2588.22 7313.06,-2590.76"/>
<polygon fill="black" stroke="black" points="7313.3,-2594.26 7323.34,-2590.87 7313.37,-2587.26 7313.3,-2594.26"/>
</g>
<!-- clean_data.main&#45;&gt;clean_data._clean_media -->
<g id="edge22" class="edge">
<title>clean_data.main&#45;&gt;clean_data._clean_media</title>
<path fill="none" stroke="black" d="M6469.2,-2590.1C6603.41,-2601.25 6838.37,-2611.48 6896,-2553.53 6957.18,-2492.02 6870.87,-1835.1 6932,-1773.53 6979.34,-1725.86 7141.67,-1722.17 7276.79,-1728.32"/>
<polygon fill="black" stroke="black" points="7276.73,-1731.83 7286.88,-1728.8 7277.06,-1724.83 7276.73,-1731.83"/>
</g>
<!-- clean_data.main&#45;&gt;clean_data._clean_lots -->
<g id="edge23" class="edge">
<title>clean_data.main&#45;&gt;clean_data._clean_lots</title>
<path fill="none" stroke="black" d="M6469.35,-2585.67C6574.08,-2591.61 6747.18,-2602.28 6896,-2615.53 6912.04,-2616.96 6915.96,-2618.17 6932,-2619.53 7041.7,-2628.85 7164.09,-2636.31 7264.95,-2641.67"/>
<polygon fill="black" stroke="black" points="7264.78,-2645.17 7274.95,-2642.2 7265.15,-2638.18 7264.78,-2645.17"/>
</g>
<!-- clean_data.main&#45;&gt;clean_data._clean_embeddings -->
<g id="edge24" class="edge">
<title>clean_data.main&#45;&gt;clean_data._clean_embeddings</title>
<path fill="none" stroke="black" d="M6469.14,-2588.86C6575.55,-2595.17 6751.86,-2596.53 6896,-2553.53 6913.75,-2548.24 6914.27,-2537.89 6932,-2532.53 7036.63,-2500.92 7157.61,-2491.32 7258.88,-2490.31"/>
<polygon fill="black" stroke="black" points="7258.95,-2493.81 7268.93,-2490.24 7258.9,-2486.81 7258.95,-2493.81"/>
</g>
<!-- clean_data.main&#45;&gt;clean_data._remove_empty_dirs -->
<g id="edge25" class="edge">
<title>clean_data.main&#45;&gt;clean_data._remove_empty_dirs</title>
<path fill="none" stroke="black" d="M6469.07,-2587.12C6600.46,-2594.31 6828.96,-2599.38 6896,-2553.53 6928.18,-2531.52 6899.26,-2494.7 6932,-2473.53 7033.7,-2407.77 7902.22,-2455.64 8022,-2473.53 8038.55,-2476.01 8041.55,-2481.48 8058,-2484.53 8133.33,-2498.5 8216.7,-2506.48 8291.32,-2511.01"/>
<polygon fill="black" stroke="black" points="8291.13,-2514.5 8301.32,-2511.6 8291.54,-2507.52 8291.13,-2514.5"/>
</g>
<!-- similar_utils._load_embeddings -->
<g id="node27" class="node">
<title>similar_utils._load_embeddings</title>
<g id="a_node27"><a xlink:title="Return mapping of lot id to embedding vector.&#10;&#10;Vectors are stored as ``numpy.float16`` arrays which halves the&#10;memory footprint compared to ``float32`` and drastically reduces&#10;memory usage compared to plain Python lists.">
<polygon fill="none" stroke="black" points="8818,-4450.03 8212,-4450.03 8212,-4401.03 8818,-4401.03 8818,-4450.03"/>
<text text-anchor="middle" x="8515" y="-4416.35" font-family="Times,serif" font-size="37.10">similar_utils._load_embeddings</text>
</a>
</g>
</g>
<!-- similar_utils._load_embeddings&#45;&gt;notes_utils.load_json -->
<g id="edge26" class="edge">
<title>similar_utils._load_embeddings&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M8818.2,-4423.62C8876.93,-4408.9 8932.45,-4382.31 8972,-4336.53 9027.35,-4272.49 8956.33,-3642.59 9008,-3575.53 9057.04,-3511.89 9143.46,-3484.94 9217.28,-3473.88"/>
<polygon fill="black" stroke="black" points="9218.2,-3477.28 9227.61,-3472.42 9217.22,-3470.35 9218.2,-3477.28"/>
</g>
<!-- notes_utils.load_json&#45;&gt;notes_utils.read_text -->
<g id="edge188" class="edge">
<title>notes_utils.load_json&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M9436.9,-3485.58C9513.1,-3496.79 9624.23,-3499.5 9696,-3440.53 9868.01,-3299.21 9974.53,-2547.33 9994.92,-2391.73"/>
<polygon fill="black" stroke="black" points="9998.42,-2391.94 9996.23,-2381.57 9991.48,-2391.04 9998.42,-2391.94"/>
</g>
<!-- similar_utils._cos_sim -->
<g id="node29" class="node">
<title>similar_utils._cos_sim</title>
<g id="a_node29"><a xlink:title="Return cosine similarity between two embeddings.">
<polygon fill="none" stroke="black" points="7606,-3538.53 7348,-3538.53 7348,-3502.53 7606,-3502.53 7606,-3538.53"/>
<text text-anchor="middle" x="7477" y="-3514.84" font-family="Times,serif" font-size="22.12">similar_utils._cos_sim</text>
</a>
</g>
</g>
<!-- similar_utils._format_vector -->
<g id="node30" class="node">
<title>similar_utils._format_vector</title>
<g id="a_node30"><a xlink:title="Return compact JSON representation for ``vec``.">
<polygon fill="none" stroke="black" points="8679.5,-3955.53 8350.5,-3955.53 8350.5,-3919.53 8679.5,-3919.53 8679.5,-3955.53"/>
<text text-anchor="middle" x="8515" y="-3931.84" font-family="Times,serif" font-size="22.12">similar_utils._format_vector</text>
</a>
</g>
</g>
<!-- similar_utils._similar_path -->
<g id="node31" class="node">
<title>similar_utils._similar_path</title>
<g id="a_node31"><a xlink:title="Return cache file path for ``lot_path`` under ``SIMILAR_DIR``.">
<polygon fill="none" stroke="black" points="8617,-4272.53 8413,-4272.53 8413,-4236.53 8617,-4236.53 8617,-4272.53"/>
<text text-anchor="middle" x="8515" y="-4250.83" font-family="Times,serif" font-size="14.00">similar_utils._similar_path</text>
</a>
</g>
</g>
<!-- similar_utils._more_user_path -->
<g id="node32" class="node">
<title>similar_utils._more_user_path</title>
<g id="a_node32"><a xlink:title="Return cache file path for ``lot_path`` under ``MORE_USER_DIR``.">
<polygon fill="none" stroke="black" points="8630,-4218.53 8400,-4218.53 8400,-4182.53 8630,-4182.53 8630,-4218.53"/>
<text text-anchor="middle" x="8515" y="-4196.83" font-family="Times,serif" font-size="14.00">similar_utils._more_user_path</text>
</a>
</g>
</g>
<!-- similar_utils._load_similar -->
<g id="node33" class="node">
<title>similar_utils._load_similar</title>
<g id="a_node33"><a xlink:title="Return cached similar lots mapping.">
<polygon fill="none" stroke="black" points="7726,-4865.53 7228,-4865.53 7228,-4817.53 7726,-4817.53 7726,-4865.53"/>
<text text-anchor="middle" x="7477" y="-4832.41" font-family="Times,serif" font-size="36.40">similar_utils._load_similar</text>
</a>
</g>
</g>
<!-- similar_utils._load_similar&#45;&gt;notes_utils.load_json -->
<g id="edge27" class="edge">
<title>similar_utils._load_similar&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M7726.11,-4863.21C8071.87,-4877.86 8688.04,-4844.04 8972,-4458.53 9030.23,-4379.47 8948.32,-3653.51 9008,-3575.53 9056.92,-3511.61 9143.57,-3484.68 9217.54,-3473.7"/>
<polygon fill="black" stroke="black" points="9218.47,-3477.1 9227.89,-3472.25 9217.5,-3470.17 9218.47,-3477.1"/>
</g>
<!-- similar_utils._load_more_user -->
<g id="node34" class="node">
<title>similar_utils._load_more_user</title>
<g id="a_node34"><a xlink:title="Return cached per&#45;user lot mapping.">
<polygon fill="none" stroke="black" points="6632,-5081.03 6114,-5081.03 6114,-5036.03 6632,-5036.03 6632,-5081.03"/>
<text text-anchor="middle" x="6373" y="-5050.15" font-family="Times,serif" font-size="33.60">similar_utils._load_more_user</text>
</a>
</g>
</g>
<!-- similar_utils._load_more_user&#45;&gt;notes_utils.load_json -->
<g id="edge28" class="edge">
<title>similar_utils._load_more_user&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M6632.2,-5062.46C7272.91,-5070.95 8890.09,-5084.14 8972,-5002.53 9028.18,-4946.56 8960.29,-3638.88 9008,-3575.53 9056.61,-3510.98 9143.76,-3484.1 9218.04,-3473.29"/>
<polygon fill="black" stroke="black" points="9218.53,-3476.76 9227.96,-3471.93 9217.58,-3469.82 9218.53,-3476.76"/>
</g>
<!-- similar_utils._save_similar -->
<g id="node35" class="node">
<title>similar_utils._save_similar</title>
<g id="a_node35"><a xlink:title="Write ``sim_map`` to ``SIMILAR_DIR`` mirroring ``LOTS_DIR`` layout.">
<polygon fill="none" stroke="black" points="7625,-4272.53 7329,-4272.53 7329,-4236.53 7625,-4236.53 7625,-4272.53"/>
<text text-anchor="middle" x="7477" y="-4249.23" font-family="Times,serif" font-size="21.00">similar_utils._save_similar</text>
</a>
</g>
</g>
<!-- similar_utils._save_similar&#45;&gt;similar_utils._similar_path -->
<g id="edge29" class="edge">
<title>similar_utils._save_similar&#45;&gt;similar_utils._similar_path</title>
<path fill="none" stroke="black" d="M7625.06,-4254.53C7834.66,-4254.53 8214.69,-4254.53 8402.62,-4254.53"/>
<polygon fill="black" stroke="black" points="8402.79,-4258.03 8412.79,-4254.53 8402.79,-4251.03 8402.79,-4258.03"/>
</g>
<!-- notes_utils.write_json -->
<g id="node36" class="node">
<title>notes_utils.write_json</title>
<g id="a_node36"><a xlink:title="Serialise ``data`` to ``path`` with standard options.">
<polygon fill="none" stroke="black" points="8609,-4149.53 8421,-4149.53 8421,-4113.53 8609,-4113.53 8609,-4149.53"/>
<text text-anchor="middle" x="8515" y="-4127.49" font-family="Times,serif" font-size="15.68">notes_utils.write_json</text>
</a>
</g>
</g>
<!-- similar_utils._save_similar&#45;&gt;notes_utils.write_json -->
<g id="edge30" class="edge">
<title>similar_utils._save_similar&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M7625.28,-4261.83C7762.91,-4266.07 7956.67,-4264.61 8022,-4227.53 8047.09,-4213.3 8033.22,-4188.3 8058,-4173.53 8165.36,-4109.57 8312.79,-4108.32 8410.62,-4116.89"/>
<polygon fill="black" stroke="black" points="8410.53,-4120.39 8420.81,-4117.83 8411.18,-4113.42 8410.53,-4120.39"/>
</g>
<!-- lot_io.lot_json_path -->
<g id="node37" class="node">
<title>lot_io.lot_json_path</title>
<g id="a_node37"><a xlink:title="Return full JSON path for ``lot_id`` given ``root`` directory.">
<polygon fill="none" stroke="black" points="8591.5,-1842.53 8438.5,-1842.53 8438.5,-1806.53 8591.5,-1806.53 8591.5,-1842.53"/>
<text text-anchor="middle" x="8515" y="-1820.83" font-family="Times,serif" font-size="14.00">lot_io.lot_json_path</text>
</a>
</g>
</g>
<!-- similar_utils._save_similar&#45;&gt;lot_io.lot_json_path -->
<g id="edge31" class="edge">
<title>similar_utils._save_similar&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M7625.28,-4268.75C7767.56,-4278.83 7969.09,-4282.26 8022,-4227.53 8109.36,-4137.18 7982.6,-2066.09 8058,-1965.53 8143.96,-1850.89 8321.85,-1826.79 8428.26,-1823.22"/>
<polygon fill="black" stroke="black" points="8428.43,-1826.72 8438.33,-1822.94 8428.23,-1819.72 8428.43,-1826.72"/>
</g>
<!-- lot_io.parse_lot_id -->
<g id="node150" class="node">
<title>lot_io.parse_lot_id</title>
<g id="a_node150"><a xlink:title="Return ``(relative_path, index)`` extracted from ``lot_id``.">
<polygon fill="none" stroke="black" points="9477,-1969.53 9227,-1969.53 9227,-1933.53 9477,-1933.53 9477,-1969.53"/>
<text text-anchor="middle" x="9352" y="-1945.37" font-family="Times,serif" font-size="25.20">lot_io.parse_lot_id</text>
</a>
</g>
</g>
<!-- lot_io.lot_json_path&#45;&gt;lot_io.parse_lot_id -->
<g id="edge248" class="edge">
<title>lot_io.lot_json_path&#45;&gt;lot_io.parse_lot_id</title>
<path fill="none" stroke="black" d="M8591.57,-1836.03C8734.52,-1857.77 9045.97,-1905.14 9222.39,-1931.97"/>
<polygon fill="black" stroke="black" points="9222.1,-1935.47 9232.51,-1933.51 9223.15,-1928.55 9222.1,-1935.47"/>
</g>
<!-- similar_utils._save_more_user -->
<g id="node38" class="node">
<title>similar_utils._save_more_user</title>
<g id="a_node38"><a xlink:title="Write ``more_map`` to ``MORE_USER_DIR`` mirroring ``LOTS_DIR`` layout.">
<polygon fill="none" stroke="black" points="7644.5,-4218.53 7309.5,-4218.53 7309.5,-4182.53 7644.5,-4182.53 7644.5,-4218.53"/>
<text text-anchor="middle" x="7477" y="-4195.23" font-family="Times,serif" font-size="21.00">similar_utils._save_more_user</text>
</a>
</g>
</g>
<!-- similar_utils._save_more_user&#45;&gt;similar_utils._more_user_path -->
<g id="edge32" class="edge">
<title>similar_utils._save_more_user&#45;&gt;similar_utils._more_user_path</title>
<path fill="none" stroke="black" d="M7644.74,-4200.53C7852.75,-4200.53 8203.65,-4200.53 8389.62,-4200.53"/>
<polygon fill="black" stroke="black" points="8389.72,-4204.03 8399.72,-4200.53 8389.72,-4197.03 8389.72,-4204.03"/>
</g>
<!-- similar_utils._save_more_user&#45;&gt;notes_utils.write_json -->
<g id="edge33" class="edge">
<title>similar_utils._save_more_user&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M7644.71,-4191.43C7752.39,-4185.38 7895.51,-4177.01 8022,-4168.53 8156.27,-4159.54 8311.04,-4147.65 8410.57,-4139.8"/>
<polygon fill="black" stroke="black" points="8410.93,-4143.29 8420.63,-4139.01 8410.38,-4136.31 8410.93,-4143.29"/>
</g>
<!-- similar_utils._save_more_user&#45;&gt;lot_io.lot_json_path -->
<g id="edge34" class="edge">
<title>similar_utils._save_more_user&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M7644.53,-4206.45C7769.64,-4200.94 7933.99,-4170.46 8022,-4058.53 8093.88,-3967.11 7988.17,-2058.53 8058,-1965.53 8144.04,-1850.95 8321.9,-1826.83 8428.28,-1823.24"/>
<polygon fill="black" stroke="black" points="8428.45,-1826.74 8438.35,-1822.96 8428.25,-1819.74 8428.45,-1826.74"/>
</g>
<!-- similar_utils._update_reciprocal -->
<g id="node39" class="node">
<title>similar_utils._update_reciprocal</title>
<g id="a_node39"><a xlink:title="Insert ``lot_id`` into caches of lots listed in ``sims`` if closer.">
<polygon fill="none" stroke="black" points="9593,-5241.53 9111,-5241.53 9111,-5201.53 9593,-5201.53 9593,-5241.53"/>
<text text-anchor="middle" x="9352" y="-5214.46" font-family="Times,serif" font-size="28.84">similar_utils._update_reciprocal</text>
</a>
</g>
</g>
<!-- similar_utils._prune_similar -->
<g id="node40" class="node">
<title>similar_utils._prune_similar</title>
<g id="a_node40"><a xlink:title="Drop cache entries referring to ids not in ``valid_ids``.">
<polygon fill="none" stroke="black" points="7616,-4550.53 7338,-4550.53 7338,-4514.53 7616,-4514.53 7616,-4550.53"/>
<text text-anchor="middle" x="7477" y="-4527.75" font-family="Times,serif" font-size="18.48">similar_utils._prune_similar</text>
</a>
</g>
</g>
<!-- similar_utils._calc_similar_nn -->
<g id="node41" class="node">
<title>similar_utils._calc_similar_nn</title>
<g id="a_node41"><a xlink:title="Fill ``sim_map`` for ``new_ids`` using a nearest neighbour search.&#10;&#10;``vec_ids`` lists all lots that have an embedding. &#160;``new_ids`` is a subset&#10;for which we still need recommendations. &#160;We gather vectors for&#10;``vec_ids`` and use ``NearestNeighbors`` from scikit&#45;learn to find the&#10;closest items. &#160;Embeddings of lots without a vector are skipped.">
<polygon fill="none" stroke="black" points="8972,-5259.03 8058,-5259.03 8058,-5184.03 8972,-5184.03 8972,-5259.03"/>
<text text-anchor="middle" x="8515" y="-5206.54" font-family="Times,serif" font-size="60.62">similar_utils._calc_similar_nn</text>
</a>
</g>
</g>
<!-- similar_utils._calc_similar_nn&#45;&gt;similar_utils._update_reciprocal -->
<g id="edge35" class="edge">
<title>similar_utils._calc_similar_nn&#45;&gt;similar_utils._update_reciprocal</title>
<path fill="none" stroke="black" d="M8972.29,-5221.53C9016.37,-5221.53 9059.86,-5221.53 9100.79,-5221.53"/>
<polygon fill="black" stroke="black" points="9100.86,-5225.03 9110.86,-5221.53 9100.86,-5218.03 9100.86,-5225.03"/>
</g>
<!-- similar_utils._sync_embeddings -->
<g id="node42" class="node">
<title>similar_utils._sync_embeddings</title>
<g id="a_node42"><a xlink:title="Drop lots or vectors that do not match and return cleaned data.">
<polygon fill="none" stroke="black" points="7715.5,-4608.53 7238.5,-4608.53 7238.5,-4568.53 7715.5,-4568.53 7715.5,-4608.53"/>
<text text-anchor="middle" x="7477" y="-4581.46" font-family="Times,serif" font-size="28.84">similar_utils._sync_embeddings</text>
</a>
</g>
</g>
<!-- similar_utils._similar_by_user -->
<g id="node43" class="node">
<title>similar_utils._similar_by_user</title>
<g id="a_node43"><a xlink:title="Return map of lot id to other lots from the same user.">
<polygon fill="none" stroke="black" points="9696,-5351.03 9008,-5351.03 9008,-5294.03 9696,-5294.03 9696,-5351.03"/>
<text text-anchor="middle" x="9352" y="-5311.19" font-family="Times,serif" font-size="44.80">similar_utils._similar_by_user</text>
</a>
</g>
</g>
<!-- build_site._load_ontology -->
<g id="node44" class="node">
<title>build_site._load_ontology</title>
<g id="a_node44"><a xlink:title="Return sorted field list from ``ONTOLOGY`` or empty list when missing.">
<polygon fill="none" stroke="black" points="8671.5,-4993.53 8358.5,-4993.53 8358.5,-4957.53 8671.5,-4957.53 8671.5,-4993.53"/>
<text text-anchor="middle" x="8515" y="-4969.94" font-family="Times,serif" font-size="23.24">build_site._load_ontology</text>
</a>
</g>
</g>
<!-- build_site._load_ontology&#45;&gt;notes_utils.load_json -->
<g id="edge36" class="edge">
<title>build_site._load_ontology&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M8671.56,-4987.8C8787.13,-4993.11 8931.47,-4990.42 8972,-4948.53 9025.06,-4893.7 8962.07,-3636.46 9008,-3575.53 9056.65,-3511.01 9143.79,-3484.12 9218.06,-3473.31"/>
<polygon fill="black" stroke="black" points="9218.55,-3476.78 9227.98,-3471.95 9217.6,-3469.84 9218.55,-3476.78"/>
</g>
<!-- build_site._load_clusters -->
<g id="node45" class="node">
<title>build_site._load_clusters</title>
<g id="a_node45"><a xlink:title="Return precomputed item clusters.">
<polygon fill="none" stroke="black" points="8692.5,-4939.53 8337.5,-4939.53 8337.5,-4901.53 8692.5,-4901.53 8692.5,-4939.53"/>
<text text-anchor="middle" x="8515" y="-4913.81" font-family="Times,serif" font-size="27.16">build_site._load_clusters</text>
</a>
</g>
</g>
<!-- build_site._load_clusters&#45;&gt;notes_utils.load_json -->
<g id="edge37" class="edge">
<title>build_site._load_clusters&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M8692.61,-4931.18C8804.13,-4933.64 8934.08,-4927.19 8972,-4887.53 9072.78,-4782.13 8920.14,-3691.93 9008,-3575.53 9056.6,-3511.16 9143.5,-3484.25 9217.68,-3473.39"/>
<polygon fill="black" stroke="black" points="9218.16,-3476.86 9227.59,-3472.02 9217.2,-3469.92 9218.16,-3476.86"/>
</g>
<!-- build_site._compile_locale -->
<g id="node46" class="node">
<title>build_site._compile_locale</title>
<g id="a_node46"><a xlink:title="Compile ``lang`` gettext catalogue when out of date.">
<polygon fill="none" stroke="black" points="6540,-5319.53 6206,-5319.53 6206,-5283.53 6540,-5283.53 6540,-5319.53"/>
<text text-anchor="middle" x="6373" y="-5295.66" font-family="Times,serif" font-size="24.22">build_site._compile_locale</text>
</a>
</g>
</g>
<!-- build_site._env_for_lang -->
<g id="node47" class="node">
<title>build_site._env_for_lang</title>
<g id="a_node47"><a xlink:title="Return Jinja environment configured for ``lang``.">
<polygon fill="none" stroke="black" points="5685,-5388.03 5308,-5388.03 5308,-5347.03 5685,-5347.03 5685,-5388.03"/>
<text text-anchor="middle" x="5496.5" y="-5360.29" font-family="Times,serif" font-size="29.68">build_site._env_for_lang</text>
</a>
</g>
</g>
<!-- build_site._env_for_lang&#45;&gt;build_site._compile_locale -->
<g id="edge38" class="edge">
<title>build_site._env_for_lang&#45;&gt;build_site._compile_locale</title>
<path fill="none" stroke="black" d="M5685.14,-5355.14C5727.67,-5351 5772.52,-5345.58 5814,-5338.53 5830.26,-5335.77 5833.69,-5331.99 5850,-5329.53 5964.32,-5312.34 6094.12,-5305.32 6195.68,-5302.61"/>
<polygon fill="black" stroke="black" points="6195.83,-5306.11 6205.73,-5302.36 6195.65,-5299.11 6195.83,-5306.11"/>
</g>
<!-- build_site._iter_lots -->
<g id="node48" class="node">
<title>build_site._iter_lots</title>
<g id="a_node48"><a xlink:title="Return all lots ready for rendering.">
<polygon fill="none" stroke="black" points="7703,-3614.03 7251,-3614.03 7251,-3557.03 7703,-3557.03 7703,-3614.03"/>
<text text-anchor="middle" x="7477" y="-3574.64" font-family="Times,serif" font-size="44.24">build_site._iter_lots</text>
</a>
</g>
</g>
<!-- build_site._iter_lots&#45;&gt;moderation.should_skip_message -->
<g id="edge39" class="edge">
<title>build_site._iter_lots&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M7703.3,-3599.23C7832.94,-3601.67 7978.54,-3593.25 8022,-3547.53 8093.97,-3471.82 7992.34,-1748.78 8058,-1667.53 8124.03,-1585.83 8239.55,-1559.34 8337.78,-1553.14"/>
<polygon fill="black" stroke="black" points="8338.06,-1556.63 8347.84,-1552.58 8337.66,-1549.65 8338.06,-1556.63"/>
</g>
<!-- build_site._iter_lots&#45;&gt;moderation.should_skip_lot -->
<g id="edge40" class="edge">
<title>build_site._iter_lots&#45;&gt;moderation.should_skip_lot</title>
<path fill="none" stroke="black" d="M7703.12,-3586.19C7904.3,-3586.77 8193.27,-3587.6 8366.42,-3588.11"/>
<polygon fill="black" stroke="black" points="8366.62,-3591.61 8376.63,-3588.14 8366.64,-3584.61 8366.62,-3591.61"/>
</g>
<!-- build_site._iter_lots&#45;&gt;lot_io.read_lots -->
<g id="edge41" class="edge">
<title>build_site._iter_lots&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M7703.13,-3590.94C7801.55,-3595.85 7918.02,-3605.12 8022,-3622.53 8179.19,-3648.86 8358.75,-3703.99 8451.39,-3734.35"/>
<polygon fill="black" stroke="black" points="8450.3,-3737.67 8460.89,-3737.48 8452.48,-3731.03 8450.3,-3737.67"/>
</g>
<!-- build_site._iter_lots&#45;&gt;post_io.read_post -->
<g id="edge43" class="edge">
<title>build_site._iter_lots&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7703.12,-3599.07C7832.69,-3601.44 7978.29,-3593.01 8022,-3547.53 8113.52,-3452.33 7972.08,-2459.82 8058,-2359.53 8100.55,-2309.87 8161.99,-2283.16 8226.05,-2269.84"/>
<polygon fill="black" stroke="black" points="8226.8,-2273.26 8235.93,-2267.9 8225.45,-2266.4 8226.8,-2273.26"/>
</g>
<!-- build_site._iter_lots&#45;&gt;post_io.raw_post_path -->
<g id="edge44" class="edge">
<title>build_site._iter_lots&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7703.09,-3595.98C7830.8,-3596.98 7974.4,-3588.19 8022,-3547.53 8076.11,-3501.32 8026.67,-3455.42 8058,-3391.53 8173.31,-3156.42 8404.9,-2932.75 8485.54,-2858.98"/>
<polygon fill="black" stroke="black" points="8488.26,-2861.24 8493.3,-2851.92 8483.55,-2856.06 8488.26,-2861.24"/>
</g>
<!-- lot_io.iter_lot_files -->
<g id="node49" class="node">
<title>lot_io.iter_lot_files</title>
<g id="a_node49"><a xlink:title="Return ``*.json`` files under ``root``.&#10;&#10;When ``newest_first`` is ``True`` the result is ordered by modification&#10;time with the most recently changed files first. &#160;Both ``build_site.py`` and&#10;``pending_embed.py`` rely on this helper so they scan the lot directory in&#10;the same order.">
<polygon fill="none" stroke="black" points="8643.5,-4328.03 8386.5,-4328.03 8386.5,-4291.03 8643.5,-4291.03 8643.5,-4328.03"/>
<text text-anchor="middle" x="8515" y="-4303.09" font-family="Times,serif" font-size="26.18">lot_io.iter_lot_files</text>
</a>
</g>
</g>
<!-- build_site._iter_lots&#45;&gt;lot_io.iter_lot_files -->
<g id="edge42" class="edge">
<title>build_site._iter_lots&#45;&gt;lot_io.iter_lot_files</title>
<path fill="none" stroke="black" d="M7703.09,-3571.92C7832.41,-3569.47 7977.74,-3577.68 8022,-3622.53 8125.01,-3726.93 7954.64,-4177.48 8058,-4281.53 8158.34,-4382.56 8342.2,-4355.66 8443.09,-4330.58"/>
<polygon fill="black" stroke="black" points="8444.06,-4333.94 8452.89,-4328.08 8442.33,-4327.16 8444.06,-4333.94"/>
</g>
<!-- build_site._copy_images -->
<g id="node50" class="node">
<title>build_site._copy_images</title>
<g id="a_node50"><a xlink:title="Copy media referenced by ``lots`` into ``VIEWS_DIR``.">
<polygon fill="none" stroke="black" points="6536.5,-5135.53 6209.5,-5135.53 6209.5,-5099.53 6536.5,-5099.53 6536.5,-5135.53"/>
<text text-anchor="middle" x="6373" y="-5111.37" font-family="Times,serif" font-size="25.20">build_site._copy_images</text>
</a>
</g>
</g>
<!-- build_site._copy_static -->
<g id="node51" class="node">
<title>build_site._copy_static</title>
<g id="a_node51"><a xlink:title="Copy CSS and JS so generated pages are standalone.">
<polygon fill="none" stroke="black" points="6501,-5265.53 6245,-5265.53 6245,-5229.53 6501,-5229.53 6501,-5265.53"/>
<text text-anchor="middle" x="6373" y="-5242.23" font-family="Times,serif" font-size="21.00">build_site._copy_static</text>
</a>
</g>
</g>
<!-- build_site._load_state -->
<g id="node52" class="node">
<title>build_site._load_state</title>
<g id="a_node52"><a xlink:title="Return ontology fields, embeddings, lots and similarity caches.">
<polygon fill="none" stroke="black" points="5687.5,-5011.03 5305.5,-5011.03 5305.5,-4966.03 5687.5,-4966.03 5687.5,-5011.03"/>
<text text-anchor="middle" x="5496.5" y="-4980.15" font-family="Times,serif" font-size="33.60">build_site._load_state</text>
</a>
</g>
</g>
<!-- build_site._load_state&#45;&gt;similar_utils._load_embeddings -->
<g id="edge45" class="edge">
<title>build_site._load_state&#45;&gt;similar_utils._load_embeddings</title>
<path fill="none" stroke="black" d="M5582.2,-4965.98C5656.23,-4941.54 5760.08,-4894.83 5814,-4814.53 5853.03,-4756.41 5798.59,-4549.06 5850,-4501.53 5892.64,-4462.12 7507.33,-4437.78 8201.74,-4429.11"/>
<polygon fill="black" stroke="black" points="8201.94,-4432.61 8211.89,-4428.99 8201.85,-4425.61 8201.94,-4432.61"/>
</g>
<!-- build_site._load_state&#45;&gt;similar_utils._load_similar -->
<g id="edge46" class="edge">
<title>build_site._load_state&#45;&gt;similar_utils._load_similar</title>
<path fill="none" stroke="black" d="M5687.69,-4969.91C5740.25,-4964.99 5797.32,-4959.85 5850,-4955.53 6332.69,-4916.02 6896.7,-4878.39 7217.57,-4857.78"/>
<polygon fill="black" stroke="black" points="7218.18,-4861.25 7227.94,-4857.12 7217.73,-4854.27 7218.18,-4861.25"/>
</g>
<!-- build_site._load_state&#45;&gt;similar_utils._load_more_user -->
<g id="edge47" class="edge">
<title>build_site._load_state&#45;&gt;similar_utils._load_more_user</title>
<path fill="none" stroke="black" d="M5687.69,-5007.13C5740.25,-5012.06 5797.32,-5017.2 5850,-5021.53 5932.27,-5028.3 6021.91,-5034.92 6103.31,-5040.65"/>
<polygon fill="black" stroke="black" points="6103.48,-5044.18 6113.7,-5041.39 6103.97,-5037.19 6103.48,-5044.18"/>
</g>
<!-- build_site._load_state&#45;&gt;build_site._load_ontology -->
<g id="edge48" class="edge">
<title>build_site._load_state&#45;&gt;build_site._load_ontology</title>
<path fill="none" stroke="black" d="M5687.52,-4989.08C6108.16,-4990.1 7149.85,-4991.49 8022,-4983.53 8130.7,-4982.54 8252.9,-4980.56 8348.32,-4978.82"/>
<polygon fill="black" stroke="black" points="8348.41,-4982.32 8358.34,-4978.63 8348.28,-4975.32 8348.41,-4982.32"/>
</g>
<!-- build_site._load_state&#45;&gt;build_site._load_clusters -->
<g id="edge49" class="edge">
<title>build_site._load_state&#45;&gt;build_site._load_clusters</title>
<path fill="none" stroke="black" d="M5687.62,-4984.25C6231.14,-4972 7787.04,-4936.92 8326.85,-4924.75"/>
<polygon fill="black" stroke="black" points="8327.15,-4928.25 8337.07,-4924.52 8326.99,-4921.25 8327.15,-4928.25"/>
</g>
<!-- build_site._load_state&#45;&gt;build_site._iter_lots -->
<g id="edge50" class="edge">
<title>build_site._load_state&#45;&gt;build_site._iter_lots</title>
<path fill="none" stroke="black" d="M5587.1,-4965.95C5661.95,-4941.9 5764.19,-4895.79 5814,-4814.53 5879.88,-4707.06 5762.05,-3770.85 5850,-3680.53 5944.78,-3583.2 6813.55,-3578.46 7240.86,-3582.15"/>
<polygon fill="black" stroke="black" points="7240.84,-3585.65 7250.87,-3582.24 7240.9,-3578.65 7240.84,-3585.65"/>
</g>
<!-- build_site._load_state&#45;&gt;build_site._copy_images -->
<g id="edge51" class="edge">
<title>build_site._load_state&#45;&gt;build_site._copy_images</title>
<path fill="none" stroke="black" d="M5559.87,-5011.05C5629.57,-5035.1 5746.25,-5072.12 5850,-5089.53 5965.42,-5108.91 6097.01,-5115.87 6199.2,-5118.01"/>
<polygon fill="black" stroke="black" points="6199.24,-5121.51 6209.31,-5118.2 6199.38,-5114.51 6199.24,-5121.51"/>
</g>
<!-- build_site._categorise -->
<g id="node53" class="node">
<title>build_site._categorise</title>
<g id="a_node53"><a xlink:title="Return category info and recent lot list.&#10;&#10;Categories are split by ``market:deal``. ``sell_item`` lots are further&#10;grouped by ``clusters`` when available and fall back to ``item:type``.&#10;Stats include price range, last timestamp and embedding centroid so the&#10;sorting logic used on item pages also works for categories.">
<polygon fill="none" stroke="black" points="7966,-5483.53 6988,-5483.53 6988,-5379.53 7966,-5379.53 7966,-5483.53"/>
<text text-anchor="middle" x="7477" y="-5409.65" font-family="Times,serif" font-size="87.36">build_site._categorise</text>
</a>
</g>
</g>
<!-- build_site._categorise&#45;&gt;lot_io.get_seller -->
<g id="edge52" class="edge">
<title>build_site._categorise&#45;&gt;lot_io.get_seller</title>
<path fill="none" stroke="black" d="M7874.47,-5379.49C8064.91,-5354.49 8278.57,-5326.44 8404.42,-5309.92"/>
<polygon fill="black" stroke="black" points="8404.99,-5313.37 8414.45,-5308.6 8404.07,-5306.43 8404.99,-5313.37"/>
</g>
<!-- build_site._render_site -->
<g id="node54" class="node">
<title>build_site._render_site</title>
<g id="a_node54"><a xlink:title="Render all HTML pages for ``lots`` using cached templates.&#10;&#10;``envs`` supplies jinja environments for every language so they are&#10;initialised only once. ``rates`` maps currency codes to multipliers relative&#10;to USD. &#160;The values are embedded into the pages so the front&#45;end can&#10;convert prices on the fly.">
<polygon fill="none" stroke="black" points="6896,-5445.03 5850,-5445.03 5850,-5338.03 6896,-5338.03 6896,-5445.03"/>
<text text-anchor="middle" x="6373" y="-5368.91" font-family="Times,serif" font-size="90.16">build_site._render_site</text>
</a>
</g>
</g>
<!-- build_site._render_site&#45;&gt;lot_io.get_seller -->
<g id="edge56" class="edge">
<title>build_site._render_site&#45;&gt;lot_io.get_seller</title>
<path fill="none" stroke="black" d="M6896.13,-5368.11C7401.26,-5345.45 8129.47,-5312.78 8403.85,-5300.47"/>
<polygon fill="black" stroke="black" points="8404.38,-5303.95 8414.21,-5300.01 8404.06,-5296.96 8404.38,-5303.95"/>
</g>
<!-- build_site._render_site&#45;&gt;notes_utils.read_text -->
<g id="edge55" class="edge">
<title>build_site._render_site&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M6615.79,-5445.05C6713.46,-5464.1 6827.57,-5483.16 6932,-5492.53 7085.04,-5506.27 9588.3,-5503.13 9696,-5393.53 9729.67,-5359.27 9728.06,-4577.41 9732,-4529.53 9804.29,-3650.24 9965.57,-2578.44 9994.13,-2391.87"/>
<polygon fill="black" stroke="black" points="9997.62,-2392.2 9995.68,-2381.78 9990.71,-2391.14 9997.62,-2392.2"/>
</g>
<!-- build_site._render_site&#45;&gt;similar_utils._format_vector -->
<g id="edge53" class="edge">
<title>build_site._render_site&#45;&gt;similar_utils._format_vector</title>
<path fill="none" stroke="black" d="M6885.67,-5337.96C6889.19,-5334.92 6892.63,-5331.78 6896,-5328.53 6969.27,-5257.99 6861.83,-5176.17 6932,-5102.53 7273.43,-4744.23 7702.11,-5252.19 8022,-4874.53 8085.18,-4799.95 7991.9,-4067.55 8058,-3995.53 8147.92,-3897.57 8313.97,-3902.56 8418.95,-3917.98"/>
<polygon fill="black" stroke="black" points="8418.5,-3921.46 8428.91,-3919.51 8419.56,-3914.54 8418.5,-3921.46"/>
</g>
<!-- build_site.build_page -->
<g id="node55" class="node">
<title>build_site.build_page</title>
<g id="a_node55"><a xlink:title="Render ``lot`` into separate HTML files for every language.&#10;&#10;``rates`` provides currency multipliers used by the front&#45;end for dynamic&#10;conversion. ``envs`` preloads jinja environments to avoid expensive&#10;reinitialisation for each page.">
<polygon fill="none" stroke="black" points="7946.5,-3176.53 7007.5,-3176.53 7007.5,-3074.53 7946.5,-3074.53 7946.5,-3176.53"/>
<text text-anchor="middle" x="7477" y="-3103.99" font-family="Times,serif" font-size="85.68">build_site.build_page</text>
</a>
</g>
</g>
<!-- build_site._render_site&#45;&gt;build_site.build_page -->
<g id="edge54" class="edge">
<title>build_site._render_site&#45;&gt;build_site.build_page</title>
<path fill="none" stroke="black" d="M6887.08,-5337.9C6890.12,-5334.88 6893.1,-5331.75 6896,-5328.53 6974.34,-5241.68 6856.22,-3312.63 6932,-3223.53 6951.26,-3200.89 6973.82,-3182.3 6998.6,-3167.1"/>
<polygon fill="black" stroke="black" points="7000.63,-3169.96 7007.46,-3161.86 6997.07,-3163.94 7000.63,-3169.96"/>
</g>
<!-- build_site.build_page&#45;&gt;post_io.read_post -->
<g id="edge58" class="edge">
<title>build_site.build_page&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7674.09,-3074.47C7795.49,-3032 7942.85,-2958.47 8022,-2837.53 8080.34,-2748.4 7986.9,-2438.85 8058,-2359.53 8101.33,-2311.2 8162.59,-2284.87 8226.19,-2271.49"/>
<polygon fill="black" stroke="black" points="8226.88,-2274.92 8236,-2269.53 8225.5,-2268.06 8226.88,-2274.92"/>
</g>
<!-- build_site.build_page&#45;&gt;post_io.raw_post_path -->
<g id="edge59" class="edge">
<title>build_site.build_page&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7946.52,-3079.17C7972.21,-3073.64 7997.52,-3067.46 8022,-3060.53 8199.37,-3010.37 8393.46,-2904.01 8474.76,-2856.87"/>
<polygon fill="black" stroke="black" points="8476.77,-2859.74 8483.65,-2851.69 8473.25,-2853.7 8476.77,-2859.74"/>
</g>
<!-- build_site.build_page&#45;&gt;similar_utils._format_vector -->
<g id="edge57" class="edge">
<title>build_site.build_page&#45;&gt;similar_utils._format_vector</title>
<path fill="none" stroke="black" d="M7946.76,-3163.88C7974.73,-3179.58 8000.28,-3199.19 8022,-3223.53 8104.87,-3316.42 7982.3,-3683.72 8058,-3782.53 8124.31,-3869.09 8241.37,-3907.68 8340.29,-3924.72"/>
<polygon fill="black" stroke="black" points="8339.97,-3928.21 8350.41,-3926.4 8341.12,-3921.31 8339.97,-3928.21"/>
</g>
<!-- caption_io.read_caption -->
<g id="node56" class="node">
<title>caption_io.read_caption</title>
<g id="a_node56"><a xlink:title="Return caption for ``image`` in ``lang`` or empty string when missing.">
<polygon fill="none" stroke="black" points="8680.5,-2012.03 8349.5,-2012.03 8349.5,-1975.03 8680.5,-1975.03 8680.5,-2012.03"/>
<text text-anchor="middle" x="8515" y="-1987.09" font-family="Times,serif" font-size="26.18">caption_io.read_caption</text>
</a>
</g>
</g>
<!-- build_site.build_page&#45;&gt;caption_io.read_caption -->
<g id="edge60" class="edge">
<title>build_site.build_page&#45;&gt;caption_io.read_caption</title>
<path fill="none" stroke="black" d="M7677.71,-3074.45C7799.16,-3032.19 7945.22,-2958.88 8022,-2837.53 8070.23,-2761.31 7995.11,-2091.2 8058,-2026.53 8096.44,-1987.01 8227.46,-1980.66 8339.25,-1983.13"/>
<polygon fill="black" stroke="black" points="8339.24,-1986.63 8349.32,-1983.37 8339.41,-1979.63 8339.24,-1986.63"/>
</g>
<!-- caption_io.read_caption&#45;&gt;notes_utils.load_json -->
<g id="edge301" class="edge">
<title>caption_io.read_caption&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M8680.7,-1984.54C8781.09,-1988.79 8902.95,-2013.31 8972,-2097.53 9066.64,-2212.98 8905.21,-3332.28 9008,-3440.53 9074.76,-3510.84 9194.74,-3502.85 9273.63,-3487.58"/>
<polygon fill="black" stroke="black" points="9274.4,-3491 9283.51,-3485.59 9273.02,-3484.13 9274.4,-3491"/>
</g>
<!-- caption_io.read_caption&#45;&gt;caption_io.caption_json_path -->
<g id="edge303" class="edge">
<title>caption_io.read_caption&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M8680.6,-2002.73C8793.8,-2005.24 8930.84,-1999.46 8972,-1960.53 9063.15,-1874.32 8917.5,-1767.43 9008,-1680.53 9074.75,-1616.45 9186.19,-1618.89 9263.87,-1630.85"/>
<polygon fill="black" stroke="black" points="9263.69,-1634.36 9274.12,-1632.51 9264.81,-1627.45 9263.69,-1634.36"/>
</g>
<!-- caption_io.read_caption&#45;&gt;caption_io.caption_md_path -->
<g id="edge304" class="edge">
<title>caption_io.read_caption&#45;&gt;caption_io.caption_md_path</title>
<path fill="none" stroke="black" d="M8680.56,-1997.74C8779.26,-1990.96 8899.34,-1964.65 8972,-1884.53 9050.66,-1797.79 8922.81,-1703.88 9008,-1623.53 9076.31,-1559.11 9190.05,-1563.62 9267.68,-1576.7"/>
<polygon fill="black" stroke="black" points="9267.45,-1580.22 9277.91,-1578.51 9268.67,-1573.32 9267.45,-1580.22"/>
</g>
<!-- caption_io.read_caption&#45;&gt;notes_utils.read_md -->
<g id="edge300" class="edge">
<title>caption_io.read_caption&#45;&gt;notes_utils.read_md</title>
<path fill="none" stroke="black" d="M8615.89,-2012.08C8783.67,-2043.22 9118.7,-2105.41 9271.61,-2133.8"/>
<polygon fill="black" stroke="black" points="9271.38,-2137.31 9281.85,-2135.7 9272.66,-2130.43 9271.38,-2137.31"/>
</g>
<!-- caption_io._get_langs -->
<g id="node175" class="node">
<title>caption_io._get_langs</title>
<g id="a_node175"><a xlink:title="Return configured languages, caching the result.">
<polygon fill="none" stroke="black" points="9461,-3431.53 9243,-3431.53 9243,-3395.53 9461,-3395.53 9461,-3431.53"/>
<text text-anchor="middle" x="9352" y="-3408.75" font-family="Times,serif" font-size="18.48">caption_io._get_langs</text>
</a>
</g>
</g>
<!-- caption_io.read_caption&#45;&gt;caption_io._get_langs -->
<g id="edge302" class="edge">
<title>caption_io.read_caption&#45;&gt;caption_io._get_langs</title>
<path fill="none" stroke="black" d="M8680.52,-1987.25C8779.2,-1992.84 8899.28,-2017.83 8972,-2097.53 9012.8,-2142.25 8994.51,-2308.52 9008,-2367.53 9102.76,-2782.09 9291.93,-3266.24 9339.79,-3385.81"/>
<polygon fill="black" stroke="black" points="9336.64,-3387.34 9343.61,-3395.32 9343.14,-3384.74 9336.64,-3387.34"/>
</g>
<!-- build_site.main -->
<g id="node57" class="node">
<title>build_site.main</title>
<g id="a_node57"><a xlink:title="Build the static site under ``VIEWS_DIR``.">
<polygon fill="none" stroke="black" points="5107.5,-5424.03 4689.5,-5424.03 4689.5,-5359.03 5107.5,-5359.03 5107.5,-5424.03"/>
<text text-anchor="middle" x="4898.5" y="-5378.48" font-family="Times,serif" font-size="51.94">build_site.main</text>
</a>
</g>
</g>
<!-- build_site.main&#45;&gt;similar_utils._sync_embeddings -->
<g id="edge61" class="edge">
<title>build_site.main&#45;&gt;similar_utils._sync_embeddings</title>
<path fill="none" stroke="black" d="M4902.64,-5358.9C4914.84,-5251.79 4969.48,-4909.36 5179,-4760.53 5343.02,-4644.03 6668.49,-4604.41 7228.12,-4592.79"/>
<polygon fill="black" stroke="black" points="7228.41,-4596.28 7238.34,-4592.57 7228.27,-4589.28 7228.41,-4596.28"/>
</g>
<!-- build_site.main&#45;&gt;build_site._env_for_lang -->
<g id="edge62" class="edge">
<title>build_site.main&#45;&gt;build_site._env_for_lang</title>
<path fill="none" stroke="black" d="M5107.53,-5383.16C5169.25,-5380.67 5236.64,-5377.96 5297.68,-5375.5"/>
<polygon fill="black" stroke="black" points="5297.97,-5378.99 5307.82,-5375.09 5297.69,-5372 5297.97,-5378.99"/>
</g>
<!-- build_site.main&#45;&gt;build_site._copy_static -->
<g id="edge63" class="edge">
<title>build_site.main&#45;&gt;build_site._copy_static</title>
<path fill="none" stroke="black" d="M4954.75,-5359.02C5009.55,-5328.74 5096.97,-5285.63 5179,-5267.53 5376.22,-5224.02 5965.14,-5235.19 6234.64,-5242.99"/>
<polygon fill="black" stroke="black" points="6234.77,-5246.49 6244.87,-5243.29 6234.98,-5239.49 6234.77,-5246.49"/>
</g>
<!-- build_site.main&#45;&gt;build_site._load_state -->
<g id="edge64" class="edge">
<title>build_site.main&#45;&gt;build_site._load_state</title>
<path fill="none" stroke="black" d="M4947.77,-5358.9C5061.77,-5281.81 5346.15,-5089.52 5453.55,-5016.9"/>
<polygon fill="black" stroke="black" points="5455.55,-5019.77 5461.87,-5011.27 5451.63,-5013.97 5455.55,-5019.77"/>
</g>
<!-- build_site.main&#45;&gt;build_site._categorise -->
<g id="edge65" class="edge">
<title>build_site.main&#45;&gt;build_site._categorise</title>
<path fill="none" stroke="black" d="M5107.82,-5406.61C5131.82,-5408.3 5155.94,-5409.97 5179,-5411.53 5477.15,-5431.75 5551.32,-5444.97 5850,-5454.53 6314.65,-5469.41 6431.2,-5463.75 6896,-5454.53 6922.7,-5454 6950.08,-5453.34 6977.72,-5452.57"/>
<polygon fill="black" stroke="black" points="6978.02,-5456.06 6987.92,-5452.28 6977.82,-5449.07 6978.02,-5456.06"/>
</g>
<!-- build_site.main&#45;&gt;build_site._render_site -->
<g id="edge66" class="edge">
<title>build_site.main&#45;&gt;build_site._render_site</title>
<path fill="none" stroke="black" d="M5107.83,-5396.5C5131.83,-5396.92 5155.95,-5397.29 5179,-5397.53 5395.13,-5399.85 5633.28,-5399.28 5839.6,-5397.8"/>
<polygon fill="black" stroke="black" points="5839.74,-5401.3 5849.71,-5397.72 5839.69,-5394.3 5839.74,-5401.3"/>
</g>
<!-- config_utils.load_config -->
<g id="node58" class="node">
<title>config_utils.load_config</title>
<g id="a_node58"><a xlink:title="Return the ``config`` module or exit with a helpful message.&#10;&#10;When running the scripts directly from ``src/`` the repository root isn&#39;t on&#10;``sys.path`` and ``config.py`` can&#39;t be imported. &#160;Try adding the parent&#10;directory before failing so the configuration can live alongside&#10;``config.example.py`` in the project root.">
<polygon fill="none" stroke="black" points="10216,-4586.03 9783,-4586.03 9783,-4539.03 10216,-4539.03 10216,-4586.03"/>
<text text-anchor="middle" x="9999.5" y="-4554.03" font-family="Times,serif" font-size="35.00">config_utils.load_config</text>
</a>
</g>
</g>
<!-- build_site.main&#45;&gt;config_utils.load_config -->
<g id="edge67" class="edge">
<title>build_site.main&#45;&gt;config_utils.load_config</title>
<path fill="none" stroke="black" d="M4915.74,-5424.29C4952.24,-5494.19 5047.92,-5657.97 5179,-5736.53 5408.46,-5874.05 6104.49,-5897.53 6372,-5897.53 6372,-5897.53 6372,-5897.53 8516,-5897.53 9046.92,-5897.53 9314.86,-6081.14 9696,-5711.53 9780.66,-5629.43 9955.47,-4777.06 9991.8,-4596.16"/>
<polygon fill="black" stroke="black" points="9995.27,-4596.65 9993.8,-4586.16 9988.41,-4595.28 9995.27,-4596.65"/>
</g>
<!-- price_utils.canonical_currency -->
<g id="node59" class="node">
<title>price_utils.canonical_currency</title>
<g id="a_node59"><a xlink:title="Return canonical currency code or ``None`` when unknown.">
<polygon fill="none" stroke="black" points="8694.5,-5634.53 8335.5,-5634.53 8335.5,-5598.53 8694.5,-5598.53 8694.5,-5634.53"/>
<text text-anchor="middle" x="8515" y="-5610.84" font-family="Times,serif" font-size="22.12">price_utils.canonical_currency</text>
</a>
</g>
</g>
<!-- build_site.main&#45;&gt;price_utils.canonical_currency -->
<g id="edge68" class="edge">
<title>build_site.main&#45;&gt;price_utils.canonical_currency</title>
<path fill="none" stroke="black" d="M5046.47,-5424.08C5089.03,-5432.37 5135.69,-5440.39 5179,-5445.53 6434.93,-5594.71 6760.15,-5483.86 8022,-5569.53 8127.42,-5576.69 8245.25,-5587.84 8339.17,-5597.48"/>
<polygon fill="black" stroke="black" points="8339.04,-5600.98 8349.34,-5598.53 8339.75,-5594.02 8339.04,-5600.98"/>
</g>
<!-- price_utils.fetch_official_rates -->
<g id="node60" class="node">
<title>price_utils.fetch_official_rates</title>
<g id="a_node60"><a xlink:title="Return currency multipliers relative to USD from NBG.">
<polygon fill="none" stroke="black" points="5814,-5329.03 5179,-5329.03 5179,-5276.03 5814,-5276.03 5814,-5329.03"/>
<text text-anchor="middle" x="5496.5" y="-5292.33" font-family="Times,serif" font-size="40.88">price_utils.fetch_official_rates</text>
</a>
</g>
</g>
<!-- build_site.main&#45;&gt;price_utils.fetch_official_rates -->
<g id="edge69" class="edge">
<title>build_site.main&#45;&gt;price_utils.fetch_official_rates</title>
<path fill="none" stroke="black" d="M5059.88,-5359.01C5098.78,-5351.71 5140.3,-5344.4 5179,-5338.53 5197.83,-5335.68 5217.32,-5332.95 5236.95,-5330.35"/>
<polygon fill="black" stroke="black" points="5237.45,-5333.81 5246.91,-5329.04 5236.54,-5326.87 5237.45,-5333.81"/>
</g>
<!-- price_utils.load_price_model -->
<g id="node61" class="node">
<title>price_utils.load_price_model</title>
<g id="a_node61"><a xlink:title="Return ``(model, currencies, counts)`` loaded from ``path``.">
<polygon fill="none" stroke="black" points="6607.5,-4865.53 6138.5,-4865.53 6138.5,-4823.53 6607.5,-4823.53 6607.5,-4865.53"/>
<text text-anchor="middle" x="6373" y="-4836.45" font-family="Times,serif" font-size="31.36">price_utils.load_price_model</text>
</a>
</g>
</g>
<!-- build_site.main&#45;&gt;price_utils.load_price_model -->
<g id="edge70" class="edge">
<title>build_site.main&#45;&gt;price_utils.load_price_model</title>
<path fill="none" stroke="black" d="M4909.59,-5358.87C4937.23,-5275.49 5022.7,-5054.51 5179,-4956.53 5331.99,-4860.64 5826.04,-4843.29 6128.27,-4842.07"/>
<polygon fill="black" stroke="black" points="6128.51,-4845.57 6138.5,-4842.03 6128.49,-4838.57 6128.51,-4845.57"/>
</g>
<!-- price_utils.apply_price_model -->
<g id="node62" class="node">
<title>price_utils.apply_price_model</title>
<g id="a_node62"><a xlink:title="Predict prices in USD and guess missing currencies.">
<polygon fill="none" stroke="black" points="6733.5,-5713.03 6012.5,-5713.03 6012.5,-5654.03 6733.5,-5654.03 6733.5,-5713.03"/>
<text text-anchor="middle" x="6373" y="-5671.85" font-family="Times,serif" font-size="46.48">price_utils.apply_price_model</text>
</a>
</g>
</g>
<!-- build_site.main&#45;&gt;price_utils.apply_price_model -->
<g id="edge71" class="edge">
<title>build_site.main&#45;&gt;price_utils.apply_price_model</title>
<path fill="none" stroke="black" d="M4939.14,-5424.1C4990.81,-5464.52 5085.62,-5531.97 5179,-5563.53 5444.98,-5653.44 5761.84,-5681.92 6002.14,-5688.74"/>
<polygon fill="black" stroke="black" points="6002.36,-5692.25 6012.45,-5689.02 6002.55,-5685.25 6002.36,-5692.25"/>
</g>
<!-- price_utils.prepare_price_fields -->
<g id="node63" class="node">
<title>price_utils.prepare_price_fields</title>
<g id="a_node63"><a xlink:title="Add display price helpers to ``lots``.&#10;&#10;``rates`` maps currency codes to multipliers relative to USD and&#10;``cur`` is the display currency. ``_display_price`` is a formatted&#10;string in ``cur``. ``_usd_value`` stores the numeric USD value so&#10;the front&#45;end can switch currencies without rebuilding the site.&#10;Prices predicted by AI get ``_price_class`` set to ``ai&#45;price`` for&#10;styling.">
<polygon fill="none" stroke="black" points="7847,-5831.53 7107,-5831.53 7107,-5773.53 7847,-5773.53 7847,-5831.53"/>
<text text-anchor="middle" x="7477" y="-5791.25" font-family="Times,serif" font-size="45.36">price_utils.prepare_price_fields</text>
</a>
</g>
</g>
<!-- build_site.main&#45;&gt;price_utils.prepare_price_fields -->
<g id="edge72" class="edge">
<title>build_site.main&#45;&gt;price_utils.prepare_price_fields</title>
<path fill="none" stroke="black" d="M4925.61,-5424.07C4970.86,-5477.86 5069.54,-5584.29 5179,-5633.53 5890.01,-5953.39 6850.43,-5884.05 7267.88,-5832.83"/>
<polygon fill="black" stroke="black" points="7268.45,-5836.28 7277.95,-5831.58 7267.59,-5829.33 7268.45,-5836.28"/>
</g>
<!-- price_utils.load_price_model&#45;&gt;notes_utils.load_json -->
<g id="edge215" class="edge">
<title>price_utils.load_price_model&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M6607.71,-4859.9C6707.56,-4865.74 6825.44,-4871.67 6932,-4874.53 7416.27,-4887.54 7540.21,-4925.19 8022,-4874.53 8451.3,-4829.4 8694.89,-5003.51 8972,-4672.53 9050.29,-4579.03 8934.26,-3672.67 9008,-3575.53 9056.67,-3511.42 9143.32,-3484.49 9217.35,-3473.55"/>
<polygon fill="black" stroke="black" points="9218.28,-3476.96 9227.71,-3472.12 9217.32,-3470.03 9218.28,-3476.96"/>
</g>
<!-- price_utils.train_price_regression -->
<g id="node134" class="node">
<title>price_utils.train_price_regression</title>
<g id="a_node134"><a xlink:title="Return ``(model, currency_map, counts)`` trained on ``lots``.&#10;&#10;``lots`` must contain ``price`` and ``price:currency`` fields. Only lots with&#10;embeddings present in ``id_to_vec`` are considered. Prices are regressed on&#10;the logarithm scale so coefficients are interpretable as multiplicative&#10;factors. ``USD`` is treated as the base currency so coefficients can be&#10;interpreted as exchange rate multipliers. The returned ``counts`` dictionary&#10;maps each currency to the number of training samples observed.">
<polygon fill="none" stroke="black" points="8022,-5655.03 6932,-5655.03 6932,-5578.03 8022,-5578.03 8022,-5655.03"/>
<text text-anchor="middle" x="7477" y="-5600.63" font-family="Times,serif" font-size="63.00">price_utils.train_price_regression</text>
</a>
</g>
</g>
<!-- price_utils.apply_price_model&#45;&gt;price_utils.train_price_regression -->
<g id="edge217" class="edge">
<title>price_utils.apply_price_model&#45;&gt;price_utils.train_price_regression</title>
<path fill="none" stroke="black" d="M6733.69,-5661.66C6793.9,-5658 6857.59,-5654.13 6921.34,-5650.26"/>
<polygon fill="black" stroke="black" points="6921.8,-5653.73 6931.57,-5649.63 6921.38,-5646.75 6921.8,-5653.73"/>
</g>
<!-- price_utils.predict_price -->
<g id="node136" class="node">
<title>price_utils.predict_price</title>
<g id="a_node136"><a xlink:title="Return predicted price for ``vec`` in ``currency``.&#10;&#10;When ``model`` is ``None`` or ``vec`` is missing, ``None`` is returned.">
<polygon fill="none" stroke="black" points="7682,-5755.03 7272,-5755.03 7272,-5712.03 7682,-5712.03 7682,-5755.03"/>
<text text-anchor="middle" x="7477" y="-5725.39" font-family="Times,serif" font-size="32.06">price_utils.predict_price</text>
</a>
</g>
</g>
<!-- price_utils.apply_price_model&#45;&gt;price_utils.predict_price -->
<g id="edge218" class="edge">
<title>price_utils.apply_price_model&#45;&gt;price_utils.predict_price</title>
<path fill="none" stroke="black" d="M6733.69,-5699.85C6908.19,-5707.77 7111.92,-5717.01 7261.76,-5723.81"/>
<polygon fill="black" stroke="black" points="7261.85,-5727.32 7272,-5724.28 7262.17,-5720.33 7261.85,-5727.32"/>
</g>
<!-- price_utils.currency_rates -->
<g id="node137" class="node">
<title>price_utils.currency_rates</title>
<g id="a_node137"><a xlink:title="Return estimated currency multipliers relative to the base.&#10;&#10;The regression model learns one coefficient per currency dummy feature. &#160;The&#10;coefficient is the logarithm of the multiplier relative to USD.">
<polygon fill="none" stroke="black" points="8708.5,-5869.03 8321.5,-5869.03 8321.5,-5830.03 8708.5,-5830.03 8708.5,-5869.03"/>
<text text-anchor="middle" x="8515" y="-5842.63" font-family="Times,serif" font-size="28.00">price_utils.currency_rates</text>
</a>
</g>
</g>
<!-- price_utils.apply_price_model&#45;&gt;price_utils.currency_rates -->
<g id="edge219" class="edge">
<title>price_utils.apply_price_model&#45;&gt;price_utils.currency_rates</title>
<path fill="none" stroke="black" d="M6453.4,-5713.2C6560.33,-5751.43 6757.36,-5815.93 6932,-5840.53 7192.02,-5877.17 7946.18,-5864.1 8311.26,-5855.14"/>
<polygon fill="black" stroke="black" points="8311.5,-5858.63 8321.41,-5854.89 8311.33,-5851.63 8311.5,-5858.63"/>
</g>
<!-- price_utils._guess_currency_verified -->
<g id="node139" class="node">
<title>price_utils._guess_currency_verified</title>
<g id="a_node139"><a xlink:title="Return currency when both AI and official rates agree.">
<polygon fill="none" stroke="black" points="9608.5,-5702.53 9095.5,-5702.53 9095.5,-5664.53 9608.5,-5664.53 9608.5,-5702.53"/>
<text text-anchor="middle" x="9352" y="-5676.81" font-family="Times,serif" font-size="27.16">price_utils._guess_currency_verified</text>
</a>
</g>
</g>
<!-- price_utils.apply_price_model&#45;&gt;price_utils._guess_currency_verified -->
<g id="edge220" class="edge">
<title>price_utils.apply_price_model&#45;&gt;price_utils._guess_currency_verified</title>
<path fill="none" stroke="black" d="M6733.84,-5683.53C7339.68,-5683.53 8549.56,-5683.53 9085.25,-5683.53"/>
<polygon fill="black" stroke="black" points="9085.43,-5687.03 9095.43,-5683.53 9085.43,-5680.03 9085.43,-5687.03"/>
</g>
<!-- price_utils.prepare_price_fields&#45;&gt;price_utils.canonical_currency -->
<g id="edge221" class="edge">
<title>price_utils.prepare_price_fields&#45;&gt;price_utils.canonical_currency</title>
<path fill="none" stroke="black" d="M7847,-5787.9C7905.81,-5782.37 7965.77,-5774.82 8022,-5764.53 8183.27,-5735.03 8366.59,-5671.6 8457.16,-5638.17"/>
<polygon fill="black" stroke="black" points="8458.52,-5641.39 8466.68,-5634.64 8456.09,-5634.83 8458.52,-5641.39"/>
</g>
<!-- chop.has_misc_deal -->
<g id="node64" class="node">
<title>chop.has_misc_deal</title>
<g id="a_node64"><a xlink:title="Return True when any lot is classified as misc or announcement.">
<polygon fill="none" stroke="black" points="8629,-430.53 8401,-430.53 8401,-394.53 8629,-394.53 8629,-430.53"/>
<text text-anchor="middle" x="8515" y="-407.23" font-family="Times,serif" font-size="21.00">chop.has_misc_deal</text>
</a>
</g>
</g>
<!-- chop.process_message -->
<g id="node65" class="node">
<title>chop.process_message</title>
<g id="a_node65"><a xlink:title="Extract lots from ``msg_path`` and save them under ``LOTS_DIR``.">
<polygon fill="none" stroke="black" points="6874,-669.53 5872,-669.53 5872,-567.53 6874,-567.53 6874,-669.53"/>
<text text-anchor="middle" x="6373" y="-597.21" font-family="Times,serif" font-size="85.40">chop.process_message</text>
</a>
</g>
</g>
<!-- chop.process_message&#45;&gt;token_utils.estimate_tokens -->
<g id="edge73" class="edge">
<title>chop.process_message&#45;&gt;token_utils.estimate_tokens</title>
<path fill="none" stroke="black" d="M6560.77,-567.48C6668.47,-540.12 6806.92,-508.43 6932,-490.53 7073.79,-470.25 7238.14,-462.76 7348.77,-460.03"/>
<polygon fill="black" stroke="black" points="7349.06,-463.53 7358.97,-459.79 7348.89,-456.53 7349.06,-463.53"/>
</g>
<!-- chop.process_message&#45;&gt;moderation.should_skip_message -->
<g id="edge74" class="edge">
<title>chop.process_message&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M6593.07,-669.55C6695.45,-691.27 6819.36,-714.55 6932,-727.53 6992.2,-734.47 7978.93,-724.91 8022,-767.53 8082.17,-827.07 7998.83,-1468 8058,-1528.53 8157.59,-1630.42 8341.75,-1605.14 8442.89,-1580.95"/>
<polygon fill="black" stroke="black" points="8443.83,-1584.32 8452.71,-1578.54 8442.17,-1577.52 8443.83,-1584.32"/>
</g>
<!-- chop.process_message&#45;&gt;post_io.read_post -->
<g id="edge79" class="edge">
<title>chop.process_message&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M6517.2,-669.63C6641.46,-722.35 6813.91,-817.61 6896,-963.53 6947.47,-1055.02 6857.66,-1833.43 6932,-1907.53 7017.83,-1993.08 7932.36,-1863.98 8022,-1945.53 8113.83,-2029.08 7969.53,-2135.44 8058,-2222.53 8102.87,-2266.71 8163.49,-2288.56 8225.86,-2297.67"/>
<polygon fill="black" stroke="black" points="8225.5,-2301.16 8235.88,-2299.03 8226.44,-2294.22 8225.5,-2301.16"/>
</g>
<!-- chop.process_message&#45;&gt;caption_io.has_caption -->
<g id="edge81" class="edge">
<title>chop.process_message&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M6747.76,-567.52C7169.34,-518.14 7822.28,-468.76 8022,-604.53 8057.97,-628.99 8029.39,-662.78 8058,-695.53 8165.95,-819.11 8348.75,-895.8 8446.92,-930.21"/>
<polygon fill="black" stroke="black" points="8445.84,-933.54 8456.44,-933.5 8448.13,-926.92 8445.84,-933.54"/>
</g>
<!-- chop.process_message&#45;&gt;lot_io.needs_cleanup -->
<g id="edge78" class="edge">
<title>chop.process_message&#45;&gt;lot_io.needs_cleanup</title>
<path fill="none" stroke="black" d="M6726.58,-669.58C6794.62,-678.04 6865.44,-685.88 6932,-691.53 6992.39,-696.66 7978.95,-691.88 8022,-734.53 8080.32,-792.31 8000.38,-1414.05 8058,-1472.53 8105.95,-1521.19 8295.78,-1517.51 8414.88,-1509.88"/>
<polygon fill="black" stroke="black" points="8415.36,-1513.36 8425.1,-1509.21 8414.9,-1506.37 8415.36,-1513.36"/>
</g>
<!-- chop.process_message&#45;&gt;caption_io.read_caption -->
<g id="edge82" class="edge">
<title>chop.process_message&#45;&gt;caption_io.read_caption</title>
<path fill="none" stroke="black" d="M6491.25,-669.66C6608.39,-726.15 6786.38,-827.43 6896,-963.53 6923.8,-998.05 6895.89,-1030.83 6932,-1056.53 7030.73,-1126.81 7935.8,-1010.35 8022,-1095.53 8081.81,-1154.65 8006.56,-1785.01 8058,-1851.53 8123.96,-1936.83 8240.56,-1972.11 8339.34,-1986.18"/>
<polygon fill="black" stroke="black" points="8339.07,-1989.67 8349.45,-1987.55 8340.02,-1982.74 8339.07,-1989.67"/>
</g>
<!-- chop.process_message&#45;&gt;chop.has_misc_deal -->
<g id="edge75" class="edge">
<title>chop.process_message&#45;&gt;chop.has_misc_deal</title>
<path fill="none" stroke="black" d="M6490.71,-567.51C6601.74,-521.86 6774.72,-458.16 6932,-431.53 7468.77,-340.67 8122.67,-379.12 8390.57,-401.11"/>
<polygon fill="black" stroke="black" points="8390.46,-404.61 8400.72,-401.95 8391.04,-397.63 8390.46,-404.61"/>
</g>
<!-- message_utils.build_prompt -->
<g id="node66" class="node">
<title>message_utils.build_prompt</title>
<g id="a_node66"><a xlink:title="Return prompt combining message text with captioned file names.">
<polygon fill="none" stroke="black" points="8664.5,-1216.53 8365.5,-1216.53 8365.5,-1180.53 8664.5,-1180.53 8664.5,-1216.53"/>
<text text-anchor="middle" x="8515" y="-1193.74" font-family="Times,serif" font-size="19.74">message_utils.build_prompt</text>
</a>
</g>
</g>
<!-- chop.process_message&#45;&gt;message_utils.build_prompt -->
<g id="edge76" class="edge">
<title>chop.process_message&#45;&gt;message_utils.build_prompt</title>
<path fill="none" stroke="black" d="M6874.19,-591.42C7327.85,-572.08 7938.26,-561.29 8022,-637.53 8078.34,-688.83 8014.15,-916.22 8058,-978.53 8139.55,-1094.42 8299.24,-1151.6 8406.3,-1178.05"/>
<polygon fill="black" stroke="black" points="8405.63,-1181.49 8416.17,-1180.44 8407.27,-1174.68 8405.63,-1181.49"/>
</g>
<!-- lot_io.valid_lots -->
<g id="node67" class="node">
<title>lot_io.valid_lots</title>
<g id="a_node67"><a xlink:title="Return ``True`` when every lot contains the required translations.">
<polygon fill="none" stroke="black" points="9454,-316.53 9250,-316.53 9250,-280.53 9454,-280.53 9454,-316.53"/>
<text text-anchor="middle" x="9352" y="-292.66" font-family="Times,serif" font-size="24.22">lot_io.valid_lots</text>
</a>
</g>
</g>
<!-- chop.process_message&#45;&gt;lot_io.valid_lots -->
<g id="edge77" class="edge">
<title>chop.process_message&#45;&gt;lot_io.valid_lots</title>
<path fill="none" stroke="black" d="M6460.18,-567.46C6566.76,-507.36 6755.76,-410.68 6932,-370.53 7801.88,-172.36 8892.99,-253.41 9239.84,-286.81"/>
<polygon fill="black" stroke="black" points="9239.59,-290.3 9249.88,-287.79 9240.27,-283.34 9239.59,-290.3"/>
</g>
<!-- embed.embed_file -->
<g id="node68" class="node">
<title>embed.embed_file</title>
<g id="a_node68"><a xlink:title="Embed ``path`` and write the result beside it under ``EMBED_DIR``.">
<polygon fill="none" stroke="black" points="7682,-4050.03 7272,-4050.03 7272,-3995.03 7682,-3995.03 7682,-4050.03"/>
<text text-anchor="middle" x="7477" y="-4011.99" font-family="Times,serif" font-size="42.56">embed.embed_file</text>
</a>
</g>
</g>
<!-- chop.process_message&#45;&gt;embed.embed_file -->
<g id="edge80" class="edge">
<title>chop.process_message&#45;&gt;embed.embed_file</title>
<path fill="none" stroke="black" d="M6519.33,-669.64C6644.1,-722.12 6816.09,-817.03 6896,-963.53 6936.2,-1037.23 6874.32,-3924.53 6932,-3985.53 6976.57,-4032.67 7129.34,-4039.94 7261.68,-4036.52"/>
<polygon fill="black" stroke="black" points="7262.08,-4040.01 7271.98,-4036.23 7261.88,-4033.01 7262.08,-4040.01"/>
</g>
<!-- embed.embed_file&#45;&gt;lot_io.read_lots -->
<g id="edge258" class="edge">
<title>embed.embed_file&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M7622.77,-4050.05C7740.39,-4064.21 7905.34,-4064.59 8022,-3985.53 8052.61,-3964.79 8030.34,-3935.07 8058,-3910.53 8153.81,-3825.57 8298.19,-3786.79 8398.73,-3769.34"/>
<polygon fill="black" stroke="black" points="8399.35,-3772.79 8408.62,-3767.67 8398.18,-3765.89 8399.35,-3772.79"/>
</g>
<!-- embed.embed_file&#45;&gt;notes_utils.write_json -->
<g id="edge257" class="edge">
<title>embed.embed_file&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M7682.01,-4035.46C7784.22,-4042.65 7909.79,-4052.57 8022,-4064.53 8156.67,-4078.89 8311.34,-4100.86 8410.75,-4115.69"/>
<polygon fill="black" stroke="black" points="8410.38,-4119.17 8420.79,-4117.19 8411.42,-4112.25 8410.38,-4119.17"/>
</g>
<!-- lot_io.make_lot_id -->
<g id="node149" class="node">
<title>lot_io.make_lot_id</title>
<g id="a_node149"><a xlink:title="Return lot id string for ``rel`` and ``index``.&#10;&#10;``rel`` is the JSON file path relative to the ``data/lots`` directory&#10;without the ``.json`` suffix.">
<polygon fill="none" stroke="black" points="8607.5,-4040.53 8422.5,-4040.53 8422.5,-4004.53 8607.5,-4004.53 8607.5,-4040.53"/>
<text text-anchor="middle" x="8515" y="-4017.75" font-family="Times,serif" font-size="18.48">lot_io.make_lot_id</text>
</a>
</g>
</g>
<!-- embed.embed_file&#45;&gt;lot_io.make_lot_id -->
<g id="edge259" class="edge">
<title>embed.embed_file&#45;&gt;lot_io.make_lot_id</title>
<path fill="none" stroke="black" d="M7682.06,-4022.53C7902.02,-4022.53 8243.22,-4022.53 8412.13,-4022.53"/>
<polygon fill="black" stroke="black" points="8412.27,-4026.03 8422.27,-4022.53 8412.27,-4019.03 8412.27,-4026.03"/>
</g>
<!-- chop.main -->
<g id="node69" class="node">
<title>chop.main</title>
<g id="a_node69"><a xlink:title="Process a single message file passed on the command line.">
<polygon fill="none" stroke="black" points="5572,-454.53 5421,-454.53 5421,-418.53 5572,-418.53 5572,-454.53"/>
<text text-anchor="middle" x="5496.5" y="-430.37" font-family="Times,serif" font-size="25.20">chop.main</text>
</a>
</g>
</g>
<!-- chop.main&#45;&gt;chop.process_message -->
<g id="edge83" class="edge">
<title>chop.main&#45;&gt;chop.process_message</title>
<path fill="none" stroke="black" d="M5572.06,-452.05C5691.36,-476.88 5930.63,-526.68 6116.55,-565.37"/>
<polygon fill="black" stroke="black" points="6115.97,-568.82 6126.48,-567.44 6117.4,-561.97 6115.97,-568.82"/>
</g>
<!-- tg_client._mark_activity -->
<g id="node70" class="node">
<title>tg_client._mark_activity</title>
<g id="a_node70"><a xlink:title="Update ``_last_event`` to the current time.">
<polygon fill="none" stroke="black" points="4991.5,-2790.53 4805.5,-2790.53 4805.5,-2754.53 4991.5,-2754.53 4991.5,-2790.53"/>
<text text-anchor="middle" x="4898.5" y="-2768.83" font-family="Times,serif" font-size="14.00">tg_client._mark_activity</text>
</a>
</g>
</g>
<!-- tg_client._heartbeat -->
<g id="node71" class="node">
<title>tg_client._heartbeat</title>
<g id="a_node71"><a xlink:title="Periodically log a heartbeat and warn if idle for too long.">
<polygon fill="none" stroke="black" points="1393.5,-3057.53 1163.5,-3057.53 1163.5,-3021.53 1393.5,-3021.53 1393.5,-3057.53"/>
<text text-anchor="middle" x="1278.5" y="-3034.23" font-family="Times,serif" font-size="21.00">tg_client._heartbeat</text>
</a>
</g>
</g>
<!-- tg_client._progress_logger -->
<g id="node72" class="node">
<title>tg_client._progress_logger</title>
<g id="a_node72"><a xlink:title="Return a progress callback that logs received bytes.">
<polygon fill="none" stroke="black" points="5082,-2363.03 4715,-2363.03 4715,-2326.03 5082,-2326.03 5082,-2363.03"/>
<text text-anchor="middle" x="4898.5" y="-2338.09" font-family="Times,serif" font-size="26.18">tg_client._progress_logger</text>
</a>
</g>
</g>
<!-- tg_client._write_md -->
<g id="node73" class="node">
<title>tg_client._write_md</title>
<g id="a_node73"><a xlink:title="Helper to store a raw post in Markdown format.">
<polygon fill="none" stroke="black" points="5565,-1168.53 5428,-1168.53 5428,-1132.53 5565,-1132.53 5565,-1168.53"/>
<text text-anchor="middle" x="5496.5" y="-1147.29" font-family="Times,serif" font-size="12.18">tg_client._write_md</text>
</a>
</g>
</g>
<!-- post_io.write_post -->
<g id="node74" class="node">
<title>post_io.write_post</title>
<g id="a_node74"><a xlink:title="Write metadata and body as a Markdown post.">
<polygon fill="none" stroke="black" points="6539,-1189.53 6207,-1189.53 6207,-1143.53 6539,-1143.53 6539,-1189.53"/>
<text text-anchor="middle" x="6373" y="-1158.09" font-family="Times,serif" font-size="34.30">post_io.write_post</text>
</a>
</g>
</g>
<!-- tg_client._write_md&#45;&gt;post_io.write_post -->
<g id="edge84" class="edge">
<title>tg_client._write_md&#45;&gt;post_io.write_post</title>
<path fill="none" stroke="black" d="M5565.03,-1151.77C5699.11,-1154.22 6002.71,-1159.78 6196.92,-1163.33"/>
<polygon fill="black" stroke="black" points="6196.89,-1166.83 6206.95,-1163.51 6197.01,-1159.83 6196.89,-1166.83"/>
</g>
<!-- post_io.get_contact -->
<g id="node96" class="node">
<title>post_io.get_contact</title>
<g id="a_node96"><a xlink:title="Return a contact identifier from ``meta`` or ``None`` when missing.">
<polygon fill="none" stroke="black" points="7576.5,-904.53 7377.5,-904.53 7377.5,-868.53 7576.5,-868.53 7576.5,-904.53"/>
<text text-anchor="middle" x="7477" y="-881.75" font-family="Times,serif" font-size="18.48">post_io.get_contact</text>
</a>
</g>
</g>
<!-- post_io.write_post&#45;&gt;post_io.get_contact -->
<g id="edge254" class="edge">
<title>post_io.write_post&#45;&gt;post_io.get_contact</title>
<path fill="none" stroke="black" d="M6539.07,-1169.51C6653.33,-1162.66 6801.32,-1134.72 6896,-1044.53 6938.17,-1004.37 6886.55,-954.96 6932,-918.53 6996.68,-866.69 7227.72,-870.83 7367.05,-878.6"/>
<polygon fill="black" stroke="black" points="7367.15,-882.11 7377.34,-879.19 7367.55,-875.12 7367.15,-882.11"/>
</g>
<!-- notes_utils.write_md -->
<g id="node120" class="node">
<title>notes_utils.write_md</title>
<g id="a_node120"><a xlink:title="Write ``text`` to ``path`` ensuring a trailing newline.">
<polygon fill="none" stroke="black" points="7590,-1260.53 7364,-1260.53 7364,-1224.53 7590,-1224.53 7590,-1260.53"/>
<text text-anchor="middle" x="7477" y="-1237.74" font-family="Times,serif" font-size="19.74">notes_utils.write_md</text>
</a>
</g>
</g>
<!-- post_io.write_post&#45;&gt;notes_utils.write_md -->
<g id="edge253" class="edge">
<title>post_io.write_post&#45;&gt;notes_utils.write_md</title>
<path fill="none" stroke="black" d="M6539.24,-1173.57C6642.25,-1179.43 6777.33,-1189.78 6896,-1207.53 6912.21,-1209.96 6915.76,-1213.34 6932,-1215.53 7075.92,-1234.95 7242.95,-1240.79 7353.56,-1242.35"/>
<polygon fill="black" stroke="black" points="7353.71,-1245.85 7363.75,-1242.49 7353.8,-1238.86 7353.71,-1245.85"/>
</g>
<!-- post_io.get_timestamp -->
<g id="node153" class="node">
<title>post_io.get_timestamp</title>
<g id="a_node153"><a xlink:title="Return ``meta[&#39;date&#39;]`` as a timezone&#45;aware ``datetime``.">
<polygon fill="none" stroke="black" points="7648.5,-1206.53 7305.5,-1206.53 7305.5,-1166.53 7648.5,-1166.53 7648.5,-1206.53"/>
<text text-anchor="middle" x="7477" y="-1179.46" font-family="Times,serif" font-size="28.84">post_io.get_timestamp</text>
</a>
</g>
</g>
<!-- post_io.write_post&#45;&gt;post_io.get_timestamp -->
<g id="edge255" class="edge">
<title>post_io.write_post&#45;&gt;post_io.get_timestamp</title>
<path fill="none" stroke="black" d="M6539.28,-1169.53C6742.28,-1173.22 7085.43,-1179.45 7295.25,-1183.25"/>
<polygon fill="black" stroke="black" points="7295.39,-1186.76 7305.45,-1183.44 7295.52,-1179.76 7295.39,-1186.76"/>
</g>
<!-- tg_client._scan_group_cache -->
<g id="node75" class="node">
<title>tg_client._scan_group_cache</title>
<g id="a_node75"><a xlink:title="Build group_id &#45;&gt; Path mapping for ``chat`` quickly.">
<polygon fill="none" stroke="black" points="7716.5,-2736.03 7237.5,-2736.03 7237.5,-2693.03 7716.5,-2693.03 7716.5,-2736.03"/>
<text text-anchor="middle" x="7477" y="-2706.39" font-family="Times,serif" font-size="32.06">tg_client._scan_group_cache</text>
</a>
</g>
</g>
<!-- tg_client._scan_group_cache&#45;&gt;post_io.raw_post_path -->
<g id="edge85" class="edge">
<title>tg_client._scan_group_cache&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7716.8,-2725.11C7811.96,-2730.68 7922.35,-2738.86 8022,-2750.53 8165.48,-2767.34 8330.82,-2797.47 8428.65,-2816.44"/>
<polygon fill="black" stroke="black" points="8428,-2819.88 8438.48,-2818.35 8429.34,-2813.01 8428,-2819.88"/>
</g>
<!-- tg_client._find_group_path -->
<g id="node76" class="node">
<title>tg_client._find_group_path</title>
<g id="a_node76"><a xlink:title="Return stored message path for ``group_id`` if known.">
<polygon fill="none" stroke="black" points="6506,-2660.53 6240,-2660.53 6240,-2624.53 6506,-2624.53 6506,-2660.53"/>
<text text-anchor="middle" x="6373" y="-2637.75" font-family="Times,serif" font-size="18.48">tg_client._find_group_path</text>
</a>
</g>
</g>
<!-- tg_client._find_group_path&#45;&gt;tg_client._scan_group_cache -->
<g id="edge86" class="edge">
<title>tg_client._find_group_path&#45;&gt;tg_client._scan_group_cache</title>
<path fill="none" stroke="black" d="M6506.15,-2652.86C6619.19,-2661.54 6786.24,-2674.03 6932,-2683.53 7028.43,-2689.82 7134.52,-2696.03 7227.21,-2701.22"/>
<polygon fill="black" stroke="black" points="7227.11,-2704.72 7237.29,-2701.78 7227.5,-2697.73 7227.11,-2704.72"/>
</g>
<!-- tg_client._get_message_path -->
<g id="node77" class="node">
<title>tg_client._get_message_path</title>
<g id="a_node77"><a xlink:title="Return path of stored message ``msg_id`` in ``chat`` if any.">
<polygon fill="none" stroke="black" points="3283,-2794.53 3044,-2794.53 3044,-2758.53 3283,-2758.53 3283,-2794.53"/>
<text text-anchor="middle" x="3163.5" y="-2772.49" font-family="Times,serif" font-size="15.68">tg_client._get_message_path</text>
</a>
</g>
</g>
<!-- tg_client._get_message_path&#45;&gt;post_io.raw_post_path -->
<g id="edge87" class="edge">
<title>tg_client._get_message_path&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M3283.19,-2781.39C3563.83,-2792.45 4290.32,-2818.53 4897.5,-2818.53 4897.5,-2818.53 4897.5,-2818.53 5497.5,-2818.53 6135.11,-2818.53 6294.4,-2833.31 6932,-2837.53 7416.43,-2840.74 7537.56,-2839.5 8022,-2837.53 8164.31,-2836.96 8329.77,-2835.44 8427.98,-2834.44"/>
<polygon fill="black" stroke="black" points="8428.18,-2837.94 8438.14,-2834.34 8428.11,-2830.94 8428.18,-2837.94"/>
</g>
<!-- tg_client._should_skip_media -->
<g id="node78" class="node">
<title>tg_client._should_skip_media</title>
<g id="a_node78"><a xlink:title="Return reason string if ``msg`` media should be skipped.">
<polygon fill="none" stroke="black" points="5143,-2308.03 4654,-2308.03 4654,-2265.03 5143,-2265.03 5143,-2308.03"/>
<text text-anchor="middle" x="4898.5" y="-2278.39" font-family="Times,serif" font-size="32.06">tg_client._should_skip_media</text>
</a>
</g>
</g>
<!-- tg_client._allowed_topic -->
<g id="node79" class="node">
<title>tg_client._allowed_topic</title>
<g id="a_node79"><a xlink:title="Return ``True`` if ``msg`` belongs to an allowed forum topic.">
<polygon fill="none" stroke="black" points="5708.5,-2208.03 5284.5,-2208.03 5284.5,-2163.03 5708.5,-2163.03 5708.5,-2208.03"/>
<text text-anchor="middle" x="5496.5" y="-2177.15" font-family="Times,serif" font-size="33.60">tg_client._allowed_topic</text>
</a>
</g>
</g>
<!-- tg_client._extract_author -->
<g id="node80" class="node">
<title>tg_client._extract_author</title>
<g id="a_node80"><a xlink:title="Return a metadata dictionary describing the message author.">
<polygon fill="none" stroke="black" points="6736,-1440.53 6010,-1440.53 6010,-1370.53 6736,-1370.53 6736,-1440.53"/>
<text text-anchor="middle" x="6373" y="-1391.73" font-family="Times,serif" font-size="56.00">tg_client._extract_author</text>
</a>
</g>
</g>
<!-- phone_utils.format_georgian -->
<g id="node81" class="node">
<title>phone_utils.format_georgian</title>
<g id="a_node81"><a xlink:title="Return ``phone`` in ``+995...`` format if possible.">
<polygon fill="none" stroke="black" points="7683,-1416.53 7271,-1416.53 7271,-1378.53 7683,-1378.53 7683,-1416.53"/>
<text text-anchor="middle" x="7477" y="-1390.81" font-family="Times,serif" font-size="27.16">phone_utils.format_georgian</text>
</a>
</g>
</g>
<!-- tg_client._extract_author&#45;&gt;phone_utils.format_georgian -->
<g id="edge88" class="edge">
<title>tg_client._extract_author&#45;&gt;phone_utils.format_georgian</title>
<path fill="none" stroke="black" d="M6736.36,-1402.9C6909.75,-1401.64 7111.49,-1400.18 7260.44,-1399.1"/>
<polygon fill="black" stroke="black" points="7260.64,-1402.6 7270.62,-1399.02 7260.59,-1395.6 7260.64,-1402.6"/>
</g>
<!-- tg_client._schedule_caption -->
<g id="node82" class="node">
<title>tg_client._schedule_caption</title>
<g id="a_node82"><a xlink:title="Run captioning in a separate process so downloads continue.">
<polygon fill="none" stroke="black" points="5635.5,-1260.53 5357.5,-1260.53 5357.5,-1224.53 5635.5,-1224.53 5635.5,-1260.53"/>
<text text-anchor="middle" x="5496.5" y="-1237.75" font-family="Times,serif" font-size="18.48">tg_client._schedule_caption</text>
</a>
</g>
</g>
<!-- tg_client._schedule_chop -->
<g id="node83" class="node">
<title>tg_client._schedule_chop</title>
<g id="a_node83"><a xlink:title="Run lot extraction in a separate process.">
<polygon fill="none" stroke="black" points="8663,-156.53 8367,-156.53 8367,-120.53 8663,-120.53 8663,-156.53"/>
<text text-anchor="middle" x="8515" y="-132.84" font-family="Times,serif" font-size="22.12">tg_client._schedule_chop</text>
</a>
</g>
</g>
<!-- tg_client._enqueue_chop -->
<g id="node84" class="node">
<title>tg_client._enqueue_chop</title>
<g id="a_node84"><a xlink:title="Queue ``path`` for chopping once captions are available.">
<polygon fill="none" stroke="black" points="5141,-316.03 4656,-316.03 4656,-267.03 5141,-267.03 5141,-316.03"/>
<text text-anchor="middle" x="4898.5" y="-281.91" font-family="Times,serif" font-size="37.66">tg_client._enqueue_chop</text>
</a>
</g>
</g>
<!-- tg_client._enqueue_chop&#45;&gt;moderation.should_skip_message -->
<g id="edge89" class="edge">
<title>tg_client._enqueue_chop&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M5141.24,-293.51C5856.87,-300.51 7921.2,-329.51 8022,-431.53 8107.72,-518.28 7973.39,-1440.71 8058,-1528.53 8156.98,-1631.27 8341.8,-1605.5 8443.1,-1581.04"/>
<polygon fill="black" stroke="black" points="8444.07,-1584.41 8452.94,-1578.61 8442.39,-1577.61 8444.07,-1584.41"/>
</g>
<!-- tg_client._enqueue_chop&#45;&gt;caption_io.has_caption -->
<g id="edge91" class="edge">
<title>tg_client._enqueue_chop&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M5141.05,-275.81C5837.25,-232.96 7811.82,-129.75 8022,-322.53 8083.37,-378.82 8012.52,-625.77 8058,-695.53 8144.55,-828.29 8325.07,-899.02 8431.18,-930.6"/>
<polygon fill="black" stroke="black" points="8430.31,-933.99 8440.89,-933.44 8432.28,-927.27 8430.31,-933.99"/>
</g>
<!-- tg_client._start_chop_worker -->
<g id="node85" class="node">
<title>tg_client._start_chop_worker</title>
<g id="a_node85"><a xlink:title="Ensure the chop queue worker task is running.">
<polygon fill="none" stroke="black" points="5629.5,-194.53 5363.5,-194.53 5363.5,-158.53 5629.5,-158.53 5629.5,-194.53"/>
<text text-anchor="middle" x="5496.5" y="-172.37" font-family="Times,serif" font-size="17.08">tg_client._start_chop_worker</text>
</a>
</g>
</g>
<!-- tg_client._enqueue_chop&#45;&gt;tg_client._start_chop_worker -->
<g id="edge90" class="edge">
<title>tg_client._enqueue_chop&#45;&gt;tg_client._start_chop_worker</title>
<path fill="none" stroke="black" d="M5026.63,-267C5135.64,-245.97 5290.74,-216.04 5392.23,-196.46"/>
<polygon fill="black" stroke="black" points="5393.03,-199.87 5402.19,-194.54 5391.71,-193 5393.03,-199.87"/>
</g>
<!-- tg_client._chop_worker -->
<g id="node86" class="node">
<title>tg_client._chop_worker</title>
<g id="a_node86"><a xlink:title="Background task processing ``_CHOP_QUEUE``.">
<polygon fill="none" stroke="black" points="6498.5,-156.53 6247.5,-156.53 6247.5,-120.53 6498.5,-120.53 6498.5,-156.53"/>
<text text-anchor="middle" x="6373" y="-133.74" font-family="Times,serif" font-size="19.74">tg_client._chop_worker</text>
</a>
</g>
</g>
<!-- tg_client._start_chop_worker&#45;&gt;tg_client._chop_worker -->
<g id="edge92" class="edge">
<title>tg_client._start_chop_worker&#45;&gt;tg_client._chop_worker</title>
<path fill="none" stroke="black" d="M5629.84,-170.78C5793.88,-163.65 6071.94,-151.57 6237.14,-144.39"/>
<polygon fill="black" stroke="black" points="6237.52,-147.88 6247.36,-143.95 6237.22,-140.89 6237.52,-147.88"/>
</g>
<!-- tg_client._process_chop_queue -->
<g id="node87" class="node">
<title>tg_client._process_chop_queue</title>
<g id="a_node87"><a xlink:title="Check queued posts and chop cooled down ones.">
<polygon fill="none" stroke="black" points="7658.5,-156.53 7295.5,-156.53 7295.5,-120.53 7658.5,-120.53 7658.5,-156.53"/>
<text text-anchor="middle" x="7477" y="-132.84" font-family="Times,serif" font-size="22.12">tg_client._process_chop_queue</text>
</a>
</g>
</g>
<!-- tg_client._chop_worker&#45;&gt;tg_client._process_chop_queue -->
<g id="edge95" class="edge">
<title>tg_client._chop_worker&#45;&gt;tg_client._process_chop_queue</title>
<path fill="none" stroke="black" d="M6498.54,-138.53C6690.32,-138.53 7059.35,-138.53 7285.04,-138.53"/>
<polygon fill="black" stroke="black" points="7285.35,-142.03 7295.35,-138.53 7285.35,-135.03 7285.35,-142.03"/>
</g>
<!-- tg_client._process_chop_queue&#45;&gt;caption_io.has_caption -->
<g id="edge94" class="edge">
<title>tg_client._process_chop_queue&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M7658.6,-122.95C7779.72,-123.24 7932.84,-146.39 8022,-246.53 8088.56,-321.3 8004.02,-611.24 8058,-695.53 8143.35,-828.8 8323.88,-899.27 8430.4,-930.68"/>
<polygon fill="black" stroke="black" points="8429.58,-934.08 8440.16,-933.5 8431.53,-927.36 8429.58,-934.08"/>
</g>
<!-- tg_client._process_chop_queue&#45;&gt;tg_client._schedule_chop -->
<g id="edge93" class="edge">
<title>tg_client._process_chop_queue&#45;&gt;tg_client._schedule_chop</title>
<path fill="none" stroke="black" d="M7658.75,-138.53C7856.05,-138.53 8168.81,-138.53 8356.44,-138.53"/>
<polygon fill="black" stroke="black" points="8356.67,-142.03 8366.67,-138.53 8356.67,-135.03 8356.67,-142.03"/>
</g>
<!-- tg_client._flush_chop_queue -->
<g id="node88" class="node">
<title>tg_client._flush_chop_queue</title>
<g id="a_node88"><a xlink:title="Run the chop worker until the queue is empty and cancel it.">
<polygon fill="none" stroke="black" points="2156,-1116.53 1671,-1116.53 1671,-1072.53 2156,-1072.53 2156,-1116.53"/>
<text text-anchor="middle" x="1913.5" y="-1086.21" font-family="Times,serif" font-size="32.90">tg_client._flush_chop_queue</text>
</a>
</g>
</g>
<!-- tg_client._flush_chop_queue&#45;&gt;tg_client._process_chop_queue -->
<g id="edge96" class="edge">
<title>tg_client._flush_chop_queue&#45;&gt;tg_client._process_chop_queue</title>
<path fill="none" stroke="black" d="M1926.96,-1072.2C2011.27,-924.36 2514.39,-92.53 3162.5,-92.53 3162.5,-92.53 3162.5,-92.53 5497.5,-92.53 6119.11,-92.53 6274.67,-92.86 6896,-111.53 7025.96,-115.44 7172.2,-122.26 7285.32,-128.07"/>
<polygon fill="black" stroke="black" points="7285.3,-131.58 7295.47,-128.6 7285.66,-124.59 7285.3,-131.58"/>
</g>
<!-- tg_client._get_id_date -->
<g id="node89" class="node">
<title>tg_client._get_id_date</title>
<g id="a_node89"><a xlink:title="Return the stored date for ``msg_id`` in ``chat`` if available.">
<polygon fill="none" stroke="black" points="7649,-3977.03 7305,-3977.03 7305,-3936.03 7649,-3936.03 7649,-3977.03"/>
<text text-anchor="middle" x="7477" y="-3949.29" font-family="Times,serif" font-size="29.68">tg_client._get_id_date</text>
</a>
</g>
</g>
<!-- tg_client._get_id_date&#45;&gt;post_io.raw_post_path -->
<g id="edge98" class="edge">
<title>tg_client._get_id_date&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7649.05,-3957.97C7789.15,-3955.18 7972.12,-3941.08 8022,-3888.53 8098.24,-3808.22 8017.06,-3494.42 8058,-3391.53 8154.91,-3148.01 8398.58,-2929.38 8483.91,-2857.98"/>
<polygon fill="black" stroke="black" points="8486.21,-2860.62 8491.67,-2851.53 8481.74,-2855.24 8486.21,-2860.62"/>
</g>
<!-- tg_client._get_id_date&#45;&gt;notes_utils.read_text -->
<g id="edge97" class="edge">
<title>tg_client._get_id_date&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M7649.02,-3944.81C7756.24,-3937.09 7897.28,-3926.27 8022,-3914.53 8038.03,-3913.02 8041.96,-3911.96 8058,-3910.53 8239.69,-3894.4 9558.26,-3921.11 9696,-3801.53 9920.3,-3606.8 9986.83,-2576.53 9997.03,-2391.88"/>
<polygon fill="black" stroke="black" points="10000.53,-2392.04 9997.57,-2381.87 9993.54,-2391.66 10000.53,-2392.04"/>
</g>
<!-- tg_client._load_progress -->
<g id="node90" class="node">
<title>tg_client._load_progress</title>
<g id="a_node90"><a xlink:title="Return saved resume timestamp for ``chat`` if available.">
<polygon fill="none" stroke="black" points="2078.5,-4562.53 1748.5,-4562.53 1748.5,-4526.53 2078.5,-4526.53 2078.5,-4562.53"/>
<text text-anchor="middle" x="1913.5" y="-4538.37" font-family="Times,serif" font-size="25.20">tg_client._load_progress</text>
</a>
</g>
</g>
<!-- tg_client._load_progress&#45;&gt;notes_utils.read_text -->
<g id="edge99" class="edge">
<title>tg_client._load_progress&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M2078.75,-4549.76C2105.03,-4553.55 2131.58,-4559.21 2156,-4567.53 2656.41,-4738.12 2633.82,-5201.53 3162.5,-5201.53 3162.5,-5201.53 3162.5,-5201.53 5497.5,-5201.53 5652.9,-5201.53 6765.46,-5136.21 6896,-5220.53 6927.73,-5241.03 6900.52,-5276.65 6932,-5297.53 7140.65,-5435.98 7807.71,-5333.12 8058,-5340.53 8480.13,-5353.04 8585.71,-5356.09 9008,-5360.53 9084.44,-5361.34 9640.79,-5413.41 9696,-5360.53 9729.37,-5328.57 9728.18,-4575.59 9732,-4529.53 9805.02,-3650.3 9965.7,-2578.45 9994.15,-2391.87"/>
<polygon fill="black" stroke="black" points="9997.64,-2392.2 9995.69,-2381.78 9990.72,-2391.14 9997.64,-2392.2"/>
</g>
<!-- tg_client._save_progress -->
<g id="node91" class="node">
<title>tg_client._save_progress</title>
<g id="a_node91"><a xlink:title="Persist resume timestamp for ``chat`` to ``STATE_DIR``.">
<polygon fill="none" stroke="black" points="2673,-2938.53 2444,-2938.53 2444,-2902.53 2673,-2902.53 2673,-2938.53"/>
<text text-anchor="middle" x="2558.5" y="-2916.37" font-family="Times,serif" font-size="17.08">tg_client._save_progress</text>
</a>
</g>
</g>
<!-- tg_client.get_first_id -->
<g id="node92" class="node">
<title>tg_client.get_first_id</title>
<g id="a_node92"><a xlink:title="Return the smallest saved message id for ``chat``.">
<polygon fill="none" stroke="black" points="3297,-2980.53 3030,-2980.53 3030,-2944.53 3297,-2944.53 3297,-2980.53"/>
<text text-anchor="middle" x="3163.5" y="-2956.66" font-family="Times,serif" font-size="24.22">tg_client.get_first_id</text>
</a>
</g>
</g>
<!-- tg_client.get_first_id&#45;&gt;post_io.raw_post_path -->
<g id="edge100" class="edge">
<title>tg_client.get_first_id&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M3297.11,-2958.67C3587.24,-2950.57 4300.19,-2932.53 4897.5,-2932.53 4897.5,-2932.53 4897.5,-2932.53 6374,-2932.53 7106.52,-2932.53 7291.99,-2969.2 8022,-2908.53 8165.39,-2896.62 8330.43,-2868.47 8428.27,-2850.25"/>
<polygon fill="black" stroke="black" points="8428.92,-2853.68 8438.1,-2848.4 8427.63,-2846.8 8428.92,-2853.68"/>
</g>
<!-- tg_client.get_last_id -->
<g id="node93" class="node">
<title>tg_client.get_last_id</title>
<g id="a_node93"><a xlink:title="Return the highest saved message id for ``chat``.">
<polygon fill="none" stroke="black" points="2044,-3072.53 1783,-3072.53 1783,-3036.53 2044,-3036.53 2044,-3072.53"/>
<text text-anchor="middle" x="1913.5" y="-3048.66" font-family="Times,serif" font-size="24.22">tg_client.get_last_id</text>
</a>
</g>
</g>
<!-- tg_client.get_last_id&#45;&gt;post_io.raw_post_path -->
<g id="edge101" class="edge">
<title>tg_client.get_last_id&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M2044.31,-3053.15C2271.12,-3050.87 2754.35,-3046.53 3162.5,-3046.53 3162.5,-3046.53 3162.5,-3046.53 4899.5,-3046.53 5073.01,-3046.53 7850.68,-3011.97 8022,-2984.53 8186.07,-2958.25 8371.41,-2890.47 8460.53,-2855.35"/>
<polygon fill="black" stroke="black" points="8461.87,-2858.58 8469.88,-2851.64 8459.3,-2852.07 8461.87,-2858.58"/>
</g>
<!-- tg_client._save_message -->
<g id="node94" class="node">
<title>tg_client._save_message</title>
<g id="a_node94"><a xlink:title="Write ``msg`` to disk with metadata and any media references.&#10;&#10;Returns the path of the stored message or ``None`` when skipped.">
<polygon fill="none" stroke="black" points="4618,-2286.03 3402,-2286.03 3402,-2171.03 4618,-2171.03 4618,-2286.03"/>
<text text-anchor="middle" x="4010" y="-2204.42" font-family="Times,serif" font-size="97.02">tg_client._save_message</text>
</a>
</g>
</g>
<!-- tg_client._save_message&#45;&gt;moderation.should_skip_user -->
<g id="edge102" class="edge">
<title>tg_client._save_message&#45;&gt;moderation.should_skip_user</title>
<path fill="none" stroke="black" d="M4010.44,-2170.81C4011.21,-1905.81 4051.41,-795.9 4654,-257.53 4862.16,-71.56 5938.67,-54.53 6372,-54.53 6372,-54.53 6372,-54.53 8516,-54.53 9040.86,-54.53 9209.21,94.72 9696,-101.53 9715.85,-109.54 9712.4,-124.93 9732,-133.53 9773.18,-151.62 9821.28,-159.89 9865.2,-163.19"/>
<polygon fill="black" stroke="black" points="9865.17,-166.69 9875.38,-163.87 9865.64,-159.71 9865.17,-166.69"/>
</g>
<!-- tg_client._save_message&#45;&gt;post_io.read_post -->
<g id="edge114" class="edge">
<title>tg_client._save_message&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M4618.15,-2233.28C4886.98,-2235 5207,-2236.53 5495.5,-2236.53 5495.5,-2236.53 5495.5,-2236.53 6374,-2236.53 7106.52,-2236.53 7289.65,-2244.78 8022,-2260.53 8087.92,-2261.95 8158.8,-2263.79 8225.67,-2265.66"/>
<polygon fill="black" stroke="black" points="8225.84,-2269.16 8235.93,-2265.95 8226.03,-2262.17 8225.84,-2269.16"/>
</g>
<!-- tg_client._save_message&#45;&gt;post_io.raw_post_path -->
<g id="edge115" class="edge">
<title>tg_client._save_message&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M4437.62,-2286.08C4503.44,-2309.72 4566.53,-2342.68 4618,-2388.53 4650.78,-2417.74 4620.38,-2452.3 4654,-2480.53 4836.29,-2633.61 4944.04,-2548.34 5179,-2586.53 5475.6,-2634.75 5550.89,-2640.69 5850,-2669.53 6329.82,-2715.81 6450.62,-2719.25 6932,-2744.53 7416.09,-2769.96 7538.38,-2750.34 8022,-2783.53 8164.7,-2793.33 8330.05,-2811.55 8428.12,-2823.08"/>
<polygon fill="black" stroke="black" points="8427.93,-2826.59 8438.27,-2824.28 8428.75,-2819.63 8427.93,-2826.59"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._mark_activity -->
<g id="edge103" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._mark_activity</title>
<path fill="none" stroke="black" d="M4475.87,-2286.08C4530,-2310.33 4579.52,-2343.47 4618,-2388.53 4669.78,-2449.17 4597.9,-2688.87 4654,-2745.53 4690.05,-2781.94 4746.08,-2790.06 4795.31,-2788.46"/>
<polygon fill="black" stroke="black" points="4795.55,-2791.95 4805.38,-2788 4795.23,-2784.96 4795.55,-2791.95"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._progress_logger -->
<g id="edge104" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._progress_logger</title>
<path fill="none" stroke="black" d="M4421.59,-2286.07C4498.77,-2296.5 4578.82,-2307.07 4654,-2316.53 4675.97,-2319.3 4699.08,-2322.1 4721.95,-2324.8"/>
<polygon fill="black" stroke="black" points="4721.74,-2328.3 4732.08,-2326 4722.55,-2321.35 4721.74,-2328.3"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._write_md -->
<g id="edge105" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._write_md</title>
<path fill="none" stroke="black" d="M4026.97,-2170.76C4080.27,-1990.23 4270.76,-1435.13 4654,-1206.53 4899.78,-1059.93 5260.8,-1104.55 5417.81,-1133.85"/>
<polygon fill="black" stroke="black" points="5417.37,-1137.33 5427.85,-1135.76 5418.68,-1130.45 5417.37,-1137.33"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._find_group_path -->
<g id="edge106" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._find_group_path</title>
<path fill="none" stroke="black" d="M4230.58,-2286.12C4345.94,-2316.45 4489.65,-2354.35 4618,-2388.53 4867.51,-2455 4925.06,-2492.81 5179,-2539.53 5473.8,-2593.78 5551.31,-2582.39 5850,-2607.53 5978.45,-2618.35 6124.91,-2627.93 6229.94,-2634.32"/>
<polygon fill="black" stroke="black" points="6229.77,-2637.81 6239.97,-2634.93 6230.2,-2630.83 6229.77,-2637.81"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._should_skip_media -->
<g id="edge107" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._should_skip_media</title>
<path fill="none" stroke="black" d="M4618.22,-2268.26C4626.85,-2268.83 4635.37,-2269.38 4643.79,-2269.93"/>
<polygon fill="black" stroke="black" points="4643.79,-2273.44 4654,-2270.6 4644.25,-2266.46 4643.79,-2273.44"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._allowed_topic -->
<g id="edge108" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._allowed_topic</title>
<path fill="none" stroke="black" d="M4618.02,-2210.95C4850.27,-2204.22 5100.8,-2196.97 5274.47,-2191.94"/>
<polygon fill="black" stroke="black" points="5274.6,-2195.43 5284.5,-2191.65 5274.4,-2188.44 5274.6,-2195.43"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._extract_author -->
<g id="edge109" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._extract_author</title>
<path fill="none" stroke="black" d="M4115.6,-2170.97C4390.26,-2022.87 5158.53,-1628.14 5850,-1454.53 5897.9,-1442.51 5948.95,-1433.38 5999.65,-1426.46"/>
<polygon fill="black" stroke="black" points="6000.34,-1429.9 6009.78,-1425.1 5999.41,-1422.96 6000.34,-1429.9"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._enqueue_chop -->
<g id="edge110" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._enqueue_chop</title>
<path fill="none" stroke="black" d="M4012.24,-2170.92C4020.95,-1915.94 4091.02,-878.49 4654,-355.53 4670.18,-340.51 4689.45,-328.92 4709.97,-320"/>
<polygon fill="black" stroke="black" points="4711.56,-323.12 4719.48,-316.08 4708.9,-316.65 4711.56,-323.12"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._save_message -->
<g id="edge111" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._save_message</title>
<path fill="none" stroke="black" d="M3860.09,-2286.14C3879.06,-2296.66 3929.04,-2304.03 4010,-2304.03 4080.21,-2304.03 4127.12,-2298.49 4150.71,-2290.15"/>
<polygon fill="black" stroke="black" points="4152.15,-2293.35 4159.91,-2286.14 4149.35,-2286.93 4152.15,-2293.35"/>
</g>
<!-- tg_client._save_media -->
<g id="node95" class="node">
<title>tg_client._save_media</title>
<g id="a_node95"><a xlink:title="Store ``data`` and return relative file path.">
<polygon fill="none" stroke="black" points="5139.5,-1269.53 4657.5,-1269.53 4657.5,-1215.53 5139.5,-1215.53 5139.5,-1269.53"/>
<text text-anchor="middle" x="4898.5" y="-1231.93" font-family="Times,serif" font-size="42.00">tg_client._save_media</text>
</a>
</g>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._save_media -->
<g id="edge112" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._save_media</title>
<path fill="none" stroke="black" d="M4062.82,-2170.9C4227.29,-1987.97 4734.43,-1423.91 4866.04,-1277.53"/>
<polygon fill="black" stroke="black" points="4869.01,-1279.46 4873.09,-1269.68 4863.8,-1274.78 4869.01,-1279.46"/>
</g>
<!-- tg_client._save_message&#45;&gt;post_io.get_contact -->
<g id="edge113" class="edge">
<title>tg_client._save_message&#45;&gt;post_io.get_contact</title>
<path fill="none" stroke="black" d="M4026.03,-2170.72C4077.85,-1983.48 4267.49,-1389.16 4654,-1100.53 5092.31,-773.23 6903.14,-853.4 7367.24,-879.83"/>
<polygon fill="black" stroke="black" points="7367.1,-883.33 7377.29,-880.4 7367.5,-876.34 7367.1,-883.33"/>
</g>
<!-- tg_client._save_media&#45;&gt;caption_io.has_caption -->
<g id="edge119" class="edge">
<title>tg_client._save_media&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M4924.86,-1215.29C5027.52,-1107.15 5427.01,-706.98 5850,-558.53 6306.21,-398.43 7657.76,-113.59 8022,-431.53 8111.21,-509.41 7991.39,-597.62 8058,-695.53 8147.63,-827.29 8328.72,-898.72 8433.71,-930.6"/>
<polygon fill="black" stroke="black" points="8432.73,-933.96 8443.32,-933.48 8434.74,-927.26 8432.73,-933.96"/>
</g>
<!-- tg_client._save_media&#45;&gt;tg_client._schedule_caption -->
<g id="edge116" class="edge">
<title>tg_client._save_media&#45;&gt;tg_client._schedule_caption</title>
<path fill="none" stroke="black" d="M5139.77,-1242.53C5209.89,-1242.53 5284.45,-1242.53 5347.1,-1242.53"/>
<polygon fill="black" stroke="black" points="5347.45,-1246.03 5357.45,-1242.53 5347.45,-1239.03 5347.45,-1246.03"/>
</g>
<!-- image_io.write_image_meta -->
<g id="node97" class="node">
<title>image_io.write_image_meta</title>
<g id="a_node97"><a xlink:title="Write ``meta`` to ``path.with_suffix(&#39;.md&#39;)``.">
<polygon fill="none" stroke="black" points="6490.5,-1252.53 6255.5,-1252.53 6255.5,-1216.53 6490.5,-1216.53 6490.5,-1252.53"/>
<text text-anchor="middle" x="6373" y="-1230.49" font-family="Times,serif" font-size="15.68">image_io.write_image_meta</text>
</a>
</g>
</g>
<!-- tg_client._save_media&#45;&gt;image_io.write_image_meta -->
<g id="edge117" class="edge">
<title>tg_client._save_media&#45;&gt;image_io.write_image_meta</title>
<path fill="none" stroke="black" d="M5139.52,-1217.84C5152.87,-1216.94 5166.1,-1216.16 5179,-1215.53 5567.25,-1196.82 6027.3,-1215.75 6245.3,-1227.19"/>
<polygon fill="black" stroke="black" points="6245.33,-1230.7 6255.5,-1227.73 6245.7,-1223.71 6245.33,-1230.7"/>
</g>
<!-- tg_client._save_media&#45;&gt;caption_io.caption_json_path -->
<g id="edge118" class="edge">
<title>tg_client._save_media&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M5139.54,-1266.98C5152.88,-1267.95 5166.1,-1268.81 5179,-1269.53 5708.45,-1299.27 5841.71,-1288.53 6372,-1288.53 6372,-1288.53 6372,-1288.53 7478,-1288.53 7811.25,-1288.53 8729.67,-1189.76 8972,-1418.53 9039.27,-1482.04 8939.55,-1561.31 9008,-1623.53 9076.63,-1685.92 9188.2,-1682.56 9265.37,-1670.26"/>
<polygon fill="black" stroke="black" points="9266.26,-1673.66 9275.55,-1668.55 9265.1,-1666.75 9266.26,-1673.66"/>
</g>
<!-- image_io.write_image_meta&#45;&gt;notes_utils.write_md -->
<g id="edge272" class="edge">
<title>image_io.write_image_meta&#45;&gt;notes_utils.write_md</title>
<path fill="none" stroke="black" d="M6490.63,-1235.38C6700.57,-1236.9 7140.1,-1240.1 7353.94,-1241.65"/>
<polygon fill="black" stroke="black" points="7353.92,-1245.15 7363.95,-1241.72 7353.97,-1238.15 7353.92,-1245.15"/>
</g>
<!-- tg_client._save_bounded -->
<g id="node99" class="node">
<title>tg_client._save_bounded</title>
<g id="a_node99"><a xlink:title="Run ``_save_message`` under the global semaphore and return path.">
<polygon fill="none" stroke="black" points="3366,-2606.53 2961,-2606.53 2961,-2564.53 3366,-2564.53 3366,-2606.53"/>
<text text-anchor="middle" x="3163.5" y="-2577.45" font-family="Times,serif" font-size="31.36">tg_client._save_bounded</text>
</a>
</g>
</g>
<!-- tg_client._save_bounded&#45;&gt;tg_client._save_message -->
<g id="edge120" class="edge">
<title>tg_client._save_bounded&#45;&gt;tg_client._save_message</title>
<path fill="none" stroke="black" d="M3183.57,-2564.52C3221.3,-2524.24 3309.82,-2435.95 3402,-2388.53 3486.71,-2344.96 3584.33,-2312.49 3676.18,-2288.62"/>
<polygon fill="black" stroke="black" points="3677.1,-2292 3685.91,-2286.12 3675.35,-2285.22 3677.1,-2292"/>
</g>
<!-- tg_client._remove_local_message -->
<g id="node100" class="node">
<title>tg_client._remove_local_message</title>
<g id="a_node100"><a xlink:title="Delete ``path`` and related media if the post no longer exists.">
<polygon fill="none" stroke="black" points="7762,-1668.53 7192,-1668.53 7192,-1624.53 7762,-1624.53 7762,-1668.53"/>
<text text-anchor="middle" x="7477" y="-1638.21" font-family="Times,serif" font-size="32.90">tg_client._remove_local_message</text>
</a>
</g>
</g>
<!-- tg_client._remove_local_message&#45;&gt;post_io.read_post -->
<g id="edge121" class="edge">
<title>tg_client._remove_local_message&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7585.47,-1624.53C7709.76,-1606.03 7911.42,-1598.67 8022,-1715.53 8099.63,-1797.58 7979.85,-2140.98 8058,-2222.53 8101.96,-2268.41 8162.77,-2290.75 8225.67,-2299.77"/>
<polygon fill="black" stroke="black" points="8225.41,-2303.26 8235.78,-2301.1 8226.32,-2296.32 8225.41,-2303.26"/>
</g>
<!-- tg_client._remove_local_message&#45;&gt;caption_io.caption_json_path -->
<g id="edge122" class="edge">
<title>tg_client._remove_local_message&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M7762.21,-1647.14C8185.7,-1648.05 8962.73,-1649.7 9244.98,-1650.31"/>
<polygon fill="black" stroke="black" points="9245.21,-1653.81 9255.22,-1650.33 9245.23,-1646.81 9245.21,-1653.81"/>
</g>
<!-- tg_client._remove_local_message&#45;&gt;caption_io.caption_md_path -->
<g id="edge123" class="edge">
<title>tg_client._remove_local_message&#45;&gt;caption_io.caption_md_path</title>
<path fill="none" stroke="black" d="M7762.21,-1638.95C8187.22,-1627.6 8968.3,-1606.75 9248,-1599.28"/>
<polygon fill="black" stroke="black" points="9248.23,-1602.78 9258.13,-1599.01 9248.04,-1595.78 9248.23,-1602.78"/>
</g>
<!-- tg_client._download_messages -->
<g id="node102" class="node">
<title>tg_client._download_messages</title>
<g id="a_node102"><a xlink:title="Save ``messages`` with a progress bar and return count saved.">
<polygon fill="none" stroke="black" points="2913.5,-2716.03 2203.5,-2716.03 2203.5,-2659.03 2913.5,-2659.03 2913.5,-2716.03"/>
<text text-anchor="middle" x="2558.5" y="-2676.19" font-family="Times,serif" font-size="44.80">tg_client._download_messages</text>
</a>
</g>
</g>
<!-- tg_client._download_messages&#45;&gt;tg_client._save_bounded -->
<g id="edge124" class="edge">
<title>tg_client._download_messages&#45;&gt;tg_client._save_bounded</title>
<path fill="none" stroke="black" d="M2728.27,-2658.99C2823.05,-2642.95 2939.68,-2623.22 3028.2,-2608.25"/>
<polygon fill="black" stroke="black" points="3029.03,-2611.66 3038.31,-2606.54 3027.86,-2604.76 3029.03,-2611.66"/>
</g>
<!-- tg_client.ensure_chat_access -->
<g id="node103" class="node">
<title>tg_client.ensure_chat_access</title>
<g id="a_node103"><a xlink:title="Join chats listed in ``CHATS`` if not already joined.">
<polygon fill="none" stroke="black" points="2729.5,-5265.53 2387.5,-5265.53 2387.5,-5229.53 2729.5,-5229.53 2729.5,-5265.53"/>
<text text-anchor="middle" x="2558.5" y="-5241.84" font-family="Times,serif" font-size="22.12">tg_client.ensure_chat_access</text>
</a>
</g>
</g>
<!-- tg_client.refetch_messages -->
<g id="node104" class="node">
<title>tg_client.refetch_messages</title>
<g id="a_node104"><a xlink:title="Re&#45;fetch posts that failed parsing or are empty.">
<polygon fill="none" stroke="black" points="2925,-2804.03 2192,-2804.03 2192,-2739.03 2925,-2739.03 2925,-2804.03"/>
<text text-anchor="middle" x="2558.5" y="-2758.48" font-family="Times,serif" font-size="51.94">tg_client.refetch_messages</text>
</a>
</g>
</g>
<!-- tg_client.refetch_messages&#45;&gt;post_io.read_post -->
<g id="edge130" class="edge">
<title>tg_client.refetch_messages&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M2925.13,-2747.35C3426.73,-2713.05 4302.06,-2648.84 4618,-2598.53 4854.77,-2560.84 4972.5,-2643.09 5143,-2474.53 5190.22,-2427.85 5127.28,-2371.18 5179,-2329.53 5237.96,-2282.07 7426.28,-2275.45 8225.54,-2274.62"/>
<polygon fill="black" stroke="black" points="8225.75,-2278.12 8235.75,-2274.61 8225.74,-2271.12 8225.75,-2278.12"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;post_io.raw_post_path -->
<g id="edge131" class="edge">
<title>tg_client.refetch_messages&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M2925.15,-2801.49C2937.24,-2802.22 2949.22,-2802.9 2961,-2803.53 3156.79,-2813.99 3205.97,-2811.54 3402,-2815.53 4970.65,-2847.52 5363.04,-2846.01 6932,-2852.53 7416.44,-2854.55 7537.65,-2861.88 8022,-2852.53 8164.39,-2849.79 8329.82,-2842.57 8428,-2837.86"/>
<polygon fill="black" stroke="black" points="8428.35,-2841.35 8438.17,-2837.37 8428.01,-2834.36 8428.35,-2841.35"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;notes_utils.load_json -->
<g id="edge128" class="edge">
<title>tg_client.refetch_messages&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M2793.05,-2804.04C2848.06,-2811.07 2906.54,-2818.03 2961,-2823.53 3944.37,-2922.82 4192.81,-2918.88 5179,-2984.53 5369.71,-2997.23 6742.46,-2974.71 6896,-3088.53 6932.94,-3115.92 6894.71,-3158.62 6932,-3185.53 6981.13,-3220.99 7961.51,-3220.09 8022,-3223.53 8444.85,-3247.58 8648.24,-3025.48 8972,-3298.53 9021.77,-3340.51 8958.23,-3398.56 9008,-3440.53 9076.83,-3498.57 9183.52,-3497.63 9259.62,-3487.03"/>
<polygon fill="black" stroke="black" points="9260.3,-3490.47 9269.68,-3485.55 9259.28,-3483.55 9260.3,-3490.47"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;notes_utils.write_json -->
<g id="edge129" class="edge">
<title>tg_client.refetch_messages&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M2649.95,-2804.1C2730.53,-2831.83 2852.17,-2870.56 2961,-2892.53 3049.72,-2910.45 3293.52,-2881.33 3366,-2935.53 3399.51,-2960.6 3375.96,-2989.78 3402,-3022.53 3827.39,-3557.51 4046.69,-3601.96 4654,-3915.53 4873.43,-4028.84 4935.99,-4053.54 5179,-4097.53 5821.45,-4213.85 7920.06,-4151.62 8410.73,-4135.15"/>
<polygon fill="black" stroke="black" points="8411.1,-4138.64 8420.98,-4134.8 8410.87,-4131.64 8411.1,-4138.64"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;tg_client._get_message_path -->
<g id="edge125" class="edge">
<title>tg_client.refetch_messages&#45;&gt;tg_client._get_message_path</title>
<path fill="none" stroke="black" d="M2925.04,-2774.56C2963.6,-2774.88 3000.68,-2775.19 3033.62,-2775.47"/>
<polygon fill="black" stroke="black" points="3033.68,-2778.97 3043.71,-2775.55 3033.74,-2771.97 3033.68,-2778.97"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;tg_client._save_bounded -->
<g id="edge126" class="edge">
<title>tg_client.refetch_messages&#45;&gt;tg_client._save_bounded</title>
<path fill="none" stroke="black" d="M2905.23,-2738.81C2912.07,-2734.43 2918.67,-2729.68 2925,-2724.53 2962.95,-2693.67 2923.74,-2652.22 2961,-2620.53 2964.6,-2617.47 2968.36,-2614.64 2972.27,-2612.01"/>
<polygon fill="black" stroke="black" points="2974.38,-2614.82 2981.05,-2606.59 2970.7,-2608.87 2974.38,-2614.82"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;tg_client._remove_local_message -->
<g id="edge127" class="edge">
<title>tg_client.refetch_messages&#45;&gt;tg_client._remove_local_message</title>
<path fill="none" stroke="black" d="M2901.17,-2738.95C2909.38,-2734.56 2917.34,-2729.77 2925,-2724.53 2952.58,-2705.68 2933.21,-2677.08 2961,-2658.53 3036.27,-2608.28 3276.16,-2626.47 3366,-2615.53 3761.67,-2567.38 4866.54,-2658.67 5143,-2371.53 5199.38,-2312.98 5124.06,-2067.44 5179,-2007.53 5714.75,-1423.38 6145.33,-1776.61 6932,-1679.53 7012.71,-1669.57 7100.55,-1662.58 7181.62,-1657.69"/>
<polygon fill="black" stroke="black" points="7182.21,-1661.16 7191.99,-1657.07 7181.8,-1654.17 7182.21,-1661.16"/>
</g>
<!-- tg_client.fetch_missing -->
<g id="node105" class="node">
<title>tg_client.fetch_missing</title>
<g id="a_node105"><a xlink:title="Pull new messages and back&#45;fill history until fully synced.">
<polygon fill="none" stroke="black" points="1635,-3003.53 922,-3003.53 922,-2929.53 1635,-2929.53 1635,-3003.53"/>
<text text-anchor="middle" x="1278.5" y="-2951.71" font-family="Times,serif" font-size="59.78">tg_client.fetch_missing</text>
</a>
</g>
</g>
<!-- tg_client.fetch_missing&#45;&gt;post_io.raw_post_path -->
<g id="edge138" class="edge">
<title>tg_client.fetch_missing&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M1635.04,-2978.73C1647.17,-2979.02 1659.19,-2979.29 1671,-2979.53 2244.23,-2991.27 2387.65,-2987.31 2961,-2989.53 3141,-2990.23 3186,-2990.65 3366,-2989.53 4046.71,-2985.31 4216.78,-2970.53 4897.5,-2970.53 4897.5,-2970.53 4897.5,-2970.53 6374,-2970.53 6740.28,-2970.53 7658.19,-2982.99 8022,-2940.53 8172.52,-2922.97 8344.81,-2880.12 8440.35,-2854.29"/>
<polygon fill="black" stroke="black" points="8441.47,-2857.62 8450.2,-2851.62 8439.64,-2850.86 8441.47,-2857.62"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client._get_id_date -->
<g id="edge132" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client._get_id_date</title>
<path fill="none" stroke="black" d="M1621.29,-3003.66C1625.96,-3006.46 1630.53,-3009.42 1635,-3012.53 1663.37,-3032.33 1649.49,-3054.45 1671,-3081.53 1993.92,-3488.17 2038.24,-3842.53 2557.5,-3842.53 2557.5,-3842.53 2557.5,-3842.53 4899.5,-3842.53 5306.03,-3842.53 5456.74,-3667.54 5814,-3861.53 5839.02,-3875.12 5825.01,-3900.88 5850,-3914.53 5973.93,-3982.23 6896.88,-3969.78 7294.56,-3961.1"/>
<polygon fill="black" stroke="black" points="7294.81,-3964.59 7304.73,-3960.87 7294.65,-3957.59 7294.81,-3964.59"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client._load_progress -->
<g id="edge133" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client._load_progress</title>
<path fill="none" stroke="black" d="M1626.2,-3003.64C1629.22,-3006.47 1632.16,-3009.44 1635,-3012.53 1698.45,-3081.7 1653.26,-3764.36 1671,-3856.53 1722.35,-4123.4 1857.41,-4426.5 1899.67,-4517.4"/>
<polygon fill="black" stroke="black" points="1896.51,-4518.9 1903.91,-4526.48 1902.85,-4515.94 1896.51,-4518.9"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client._save_progress -->
<g id="edge134" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client._save_progress</title>
<path fill="none" stroke="black" d="M1635.07,-2953.74C1901.65,-2944.14 2250.77,-2931.57 2433.59,-2924.99"/>
<polygon fill="black" stroke="black" points="2433.91,-2928.48 2443.78,-2924.63 2433.66,-2921.49 2433.91,-2928.48"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client.get_first_id -->
<g id="edge135" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client.get_first_id</title>
<path fill="none" stroke="black" d="M1635.06,-2965.78C2053.26,-2964.89 2727.47,-2963.46 3019.75,-2962.84"/>
<polygon fill="black" stroke="black" points="3019.99,-2966.34 3029.99,-2962.82 3019.98,-2959.34 3019.99,-2966.34"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client.get_last_id -->
<g id="edge136" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client.get_last_id</title>
<path fill="none" stroke="black" d="M1587.29,-3003.59C1603.46,-3006.41 1619.45,-3009.38 1635,-3012.53 1651.28,-3015.83 1654.73,-3019.21 1671,-3022.53 1703.67,-3029.2 1739.13,-3034.8 1772.55,-3039.35"/>
<polygon fill="black" stroke="black" points="1772.48,-3042.87 1782.85,-3040.73 1773.41,-3035.93 1772.48,-3042.87"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client._download_messages -->
<g id="edge137" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client._download_messages</title>
<path fill="none" stroke="black" d="M1400.05,-2929.46C1573.54,-2877.43 1904.38,-2783.14 2192,-2729.53 2215.45,-2725.16 2239.85,-2721.17 2264.4,-2717.55"/>
<polygon fill="black" stroke="black" points="2265.17,-2720.97 2274.56,-2716.07 2264.16,-2714.04 2265.17,-2720.97"/>
</g>
<!-- tg_client.remove_deleted -->
<g id="node106" class="node">
<title>tg_client.remove_deleted</title>
<g id="a_node106"><a xlink:title="Delete locally stored messages removed from Telegram recently.">
<polygon fill="none" stroke="black" points="7793.5,-2208.03 7160.5,-2208.03 7160.5,-2147.03 7793.5,-2147.03 7793.5,-2208.03"/>
<text text-anchor="middle" x="7477" y="-2165.28" font-family="Times,serif" font-size="48.44">tg_client.remove_deleted</text>
</a>
</g>
</g>
<!-- tg_client.remove_deleted&#45;&gt;post_io.read_post -->
<g id="edge139" class="edge">
<title>tg_client.remove_deleted&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7793.81,-2202.43C7868.65,-2208.67 7948.17,-2215.58 8022,-2222.53 8087.88,-2228.74 8158.67,-2235.92 8225.45,-2242.93"/>
<polygon fill="black" stroke="black" points="8225.39,-2246.44 8235.7,-2244 8226.12,-2239.48 8225.39,-2246.44"/>
</g>
<!-- tg_client.remove_deleted&#45;&gt;post_io.raw_post_path -->
<g id="edge140" class="edge">
<title>tg_client.remove_deleted&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7717.85,-2208.06C7825.45,-2233.88 7945.18,-2281.55 8022,-2369.53 8073.94,-2429.02 8013.14,-2478.54 8058,-2543.53 8156.62,-2686.4 8350.9,-2774.24 8451.03,-2811.97"/>
<polygon fill="black" stroke="black" points="8449.83,-2815.25 8460.42,-2815.46 8452.27,-2808.69 8449.83,-2815.25"/>
</g>
<!-- tg_client.remove_deleted&#45;&gt;caption_io.caption_json_path -->
<g id="edge141" class="edge">
<title>tg_client.remove_deleted&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M7793.82,-2188.99C7876.32,-2177.13 7959.52,-2149.89 8022,-2094.53 8066.55,-2055.06 8011.45,-2002.63 8058,-1965.53 8137.51,-1902.17 8896.58,-1990.72 8972,-1922.53 9052.66,-1849.61 8928.82,-1755.07 9008,-1680.53 9074.86,-1617.6 9184.97,-1619.39 9262.36,-1630.89"/>
<polygon fill="black" stroke="black" points="9262.16,-1634.4 9272.58,-1632.49 9263.24,-1627.48 9262.16,-1634.4"/>
</g>
<!-- tg_client.remove_deleted&#45;&gt;caption_io.caption_md_path -->
<g id="edge142" class="edge">
<title>tg_client.remove_deleted&#45;&gt;caption_io.caption_md_path</title>
<path fill="none" stroke="black" d="M7793.6,-2169.58C7876.95,-2152.84 7960.65,-2120.68 8022,-2061.53 8069.18,-2016.05 8007.82,-1960.69 8058,-1918.53 8213.94,-1787.54 8822.11,-1989.41 8972,-1851.53 9047.5,-1782.08 8932.68,-1693.19 9008,-1623.53 9076.51,-1560.17 9189.15,-1564.09 9266.54,-1576.77"/>
<polygon fill="black" stroke="black" points="9266.3,-1580.28 9276.75,-1578.52 9267.48,-1573.38 9266.3,-1580.28"/>
</g>
<!-- tg_client.main -->
<g id="node107" class="node">
<title>tg_client.main</title>
<g id="a_node107"><a xlink:title="Synchronize configured chats and optional live updates.">
<polygon fill="none" stroke="black" points="886,-2720.53 318,-2720.53 318,-2628.53 886,-2628.53 886,-2720.53"/>
<text text-anchor="middle" x="602" y="-2655.49" font-family="Times,serif" font-size="76.30">tg_client.main</text>
</a>
</g>
</g>
<!-- tg_client.main&#45;&gt;tg_client._mark_activity -->
<g id="edge143" class="edge">
<title>tg_client.main&#45;&gt;tg_client._mark_activity</title>
<path fill="none" stroke="black" d="M878.65,-2628.49C1143.04,-2588.35 1553.88,-2536.53 1912.5,-2536.53 1912.5,-2536.53 1912.5,-2536.53 3164.5,-2536.53 3254.45,-2536.53 3276.7,-2544.74 3366,-2555.53 3940.46,-2624.94 4080.13,-2671.41 4654,-2745.53 4700.37,-2751.52 4751.82,-2757.35 4795.44,-2762.04"/>
<polygon fill="black" stroke="black" points="4795.17,-2765.54 4805.48,-2763.12 4795.91,-2758.58 4795.17,-2765.54"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client._heartbeat -->
<g id="edge144" class="edge">
<title>tg_client.main&#45;&gt;tg_client._heartbeat</title>
<path fill="none" stroke="black" d="M630.35,-2720.8C678.37,-2797.17 785.81,-2947.58 922,-3012.53 993.35,-3046.57 1081.99,-3053.36 1152.91,-3051.63"/>
<polygon fill="black" stroke="black" points="1153.36,-3055.11 1163.24,-3051.31 1153.14,-3048.12 1153.36,-3055.11"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client._flush_chop_queue -->
<g id="edge145" class="edge">
<title>tg_client.main&#45;&gt;tg_client._flush_chop_queue</title>
<path fill="none" stroke="black" d="M624.71,-2628.4C671.9,-2530.31 790.2,-2295.68 922,-2120.53 1249.73,-1685.03 1746.26,-1239.83 1878.93,-1123.65"/>
<polygon fill="black" stroke="black" points="1881.56,-1126.01 1886.78,-1116.79 1876.95,-1120.74 1881.56,-1126.01"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client._save_bounded -->
<g id="edge146" class="edge">
<title>tg_client.main&#45;&gt;tg_client._save_bounded</title>
<path fill="none" stroke="black" d="M886.08,-2664.69C1403.56,-2646.7 2491.17,-2608.88 2950.55,-2592.9"/>
<polygon fill="black" stroke="black" points="2950.74,-2596.4 2960.61,-2592.55 2950.5,-2589.4 2950.74,-2596.4"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client.ensure_chat_access -->
<g id="edge147" class="edge">
<title>tg_client.main&#45;&gt;tg_client.ensure_chat_access</title>
<path fill="none" stroke="black" d="M625.35,-2720.66C730.82,-2936.8 1193.57,-3868.39 1671,-4571.53 1877.81,-4876.12 1866.98,-5042.61 2192,-5215.53 2247.8,-5245.22 2315.25,-5256.7 2376.94,-5259.63"/>
<polygon fill="black" stroke="black" points="2377.06,-5263.14 2387.19,-5260.04 2377.34,-5256.14 2377.06,-5263.14"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client.refetch_messages -->
<g id="edge148" class="edge">
<title>tg_client.main&#45;&gt;tg_client.refetch_messages</title>
<path fill="none" stroke="black" d="M886.16,-2688.59C1227.75,-2705.54 1803.2,-2734.1 2181.7,-2752.88"/>
<polygon fill="black" stroke="black" points="2181.56,-2756.38 2191.72,-2753.38 2181.91,-2749.39 2181.56,-2756.38"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client.fetch_missing -->
<g id="edge149" class="edge">
<title>tg_client.main&#45;&gt;tg_client.fetch_missing</title>
<path fill="none" stroke="black" d="M709.5,-2720.64C839.7,-2777.01 1058.05,-2871.53 1182.69,-2925.49"/>
<polygon fill="black" stroke="black" points="1181.3,-2928.7 1191.87,-2929.46 1184.08,-2922.28 1181.3,-2928.7"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client.remove_deleted -->
<g id="edge150" class="edge">
<title>tg_client.main&#45;&gt;tg_client.remove_deleted</title>
<path fill="none" stroke="black" d="M664.63,-2628.49C845.73,-2497.91 1396.08,-2134.53 1912.5,-2134.53 1912.5,-2134.53 1912.5,-2134.53 5497.5,-2134.53 6079.77,-2134.53 6758.21,-2153.38 7150.29,-2166.12"/>
<polygon fill="black" stroke="black" points="7150.26,-2169.62 7160.37,-2166.45 7150.49,-2162.62 7150.26,-2169.62"/>
</g>
<!-- debug_dump.parse_url -->
<g id="node108" class="node">
<title>debug_dump.parse_url</title>
<g id="a_node108"><a xlink:title="Return ``(lot_id, lang)`` extracted from ``url``.">
<polygon fill="none" stroke="black" points="7626.5,-812.53 7327.5,-812.53 7327.5,-776.53 7626.5,-776.53 7626.5,-812.53"/>
<text text-anchor="middle" x="7477" y="-788.66" font-family="Times,serif" font-size="24.22">debug_dump.parse_url</text>
</a>
</g>
</g>
<!-- debug_dump.guess_source_from_lot -->
<g id="node109" class="node">
<title>debug_dump.guess_source_from_lot</title>
<g id="a_node109"><a xlink:title="Guess ``(chat, message_id)`` directly from ``lot_id``.">
<polygon fill="none" stroke="black" points="8736,-522.53 8294,-522.53 8294,-486.53 8736,-486.53 8736,-522.53"/>
<text text-anchor="middle" x="8515" y="-498.94" font-family="Times,serif" font-size="23.24">debug_dump.guess_source_from_lot</text>
</a>
</g>
</g>
<!-- debug_dump.load_source_info -->
<g id="node110" class="node">
<title>debug_dump.load_source_info</title>
<g id="a_node110"><a xlink:title="Return ``(chat, message_id)`` for ``lot_id`` if available.">
<polygon fill="none" stroke="black" points="7731,-1998.03 7223,-1998.03 7223,-1955.03 7731,-1955.03 7731,-1998.03"/>
<text text-anchor="middle" x="7477" y="-1968.39" font-family="Times,serif" font-size="32.06">debug_dump.load_source_info</text>
</a>
</g>
</g>
<!-- debug_dump.load_source_info&#45;&gt;notes_utils.load_json -->
<g id="edge151" class="edge">
<title>debug_dump.load_source_info&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M7731.1,-1960.07C7852.37,-1958.12 7980.23,-1966.79 8022,-2007.53 8092.07,-2075.88 7987.59,-2378.54 8058,-2446.53 8131.13,-2517.16 8900.44,-2417.31 8972,-2489.53 9046.43,-2564.65 8934.77,-3364.26 9008,-3440.53 9074.95,-3510.26 9194.32,-3502.62 9273.08,-3487.57"/>
<polygon fill="black" stroke="black" points="9273.83,-3490.99 9282.96,-3485.6 9272.47,-3484.12 9273.83,-3490.99"/>
</g>
<!-- debug_dump.load_source_info&#45;&gt;lot_io.lot_json_path -->
<g id="edge152" class="edge">
<title>debug_dump.load_source_info&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M7731.03,-1986.72C7827.88,-1980.18 7935.71,-1959.39 8022,-1907.53 8045.78,-1893.24 8033.83,-1870.15 8058,-1856.53 8173.19,-1791.63 8331.58,-1797.65 8428.16,-1809.77"/>
<polygon fill="black" stroke="black" points="8427.81,-1813.25 8438.17,-1811.08 8428.71,-1806.31 8427.81,-1813.25"/>
</g>
<!-- debug_dump.run_tg_fetch -->
<g id="node111" class="node">
<title>debug_dump.run_tg_fetch</title>
<g id="a_node111"><a xlink:title="Run ``tg_client.py &#45;&#45;fetch`` and return combined logs.">
<polygon fill="none" stroke="black" points="9578,-611.53 9126,-611.53 9126,-567.53 9578,-567.53 9578,-611.53"/>
<text text-anchor="middle" x="9352" y="-581.21" font-family="Times,serif" font-size="32.90">debug_dump.run_tg_fetch</text>
</a>
</g>
</g>
<!-- debug_dump.run_tg_fetch&#45;&gt;notes_utils.read_text -->
<g id="edge153" class="edge">
<title>debug_dump.run_tg_fetch&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M9578.14,-575.32C9621.78,-582.98 9663.86,-599.17 9696,-629.53 9956.9,-876.07 9993.7,-2130.4 9997.99,-2335.23"/>
<polygon fill="black" stroke="black" points="9994.5,-2335.53 9998.2,-2345.46 10001.5,-2335.39 9994.5,-2335.53"/>
</g>
<!-- debug_dump.collect_files -->
<g id="node112" class="node">
<title>debug_dump.collect_files</title>
<g id="a_node112"><a xlink:title="Return ``[(name, content), ...]`` for files related to ``lot_id``.">
<polygon fill="none" stroke="black" points="7724,-1048.03 7230,-1048.03 7230,-999.03 7724,-999.03 7724,-1048.03"/>
<text text-anchor="middle" x="7477" y="-1014.35" font-family="Times,serif" font-size="37.10">debug_dump.collect_files</text>
</a>
</g>
</g>
<!-- debug_dump.collect_files&#45;&gt;post_io.raw_post_path -->
<g id="edge157" class="edge">
<title>debug_dump.collect_files&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7603.03,-999.02C7728.99,-982.39 7919,-980.91 8022,-1095.53 8075.78,-1155.39 8018.39,-2473.49 8058,-2543.53 8142.19,-2692.42 8337.73,-2776.32 8443.33,-2812.29"/>
<polygon fill="black" stroke="black" points="8442.35,-2815.66 8452.95,-2815.52 8444.58,-2809.02 8442.35,-2815.66"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;notes_utils.read_text -->
<g id="edge154" class="edge">
<title>debug_dump.collect_files&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M7724.18,-1009.13C8087.37,-990.9 8747.98,-970.12 8972,-1044.53 9349.21,-1169.84 9454.28,-1254 9696,-1569.53 9892.87,-1826.53 9974.51,-2226.42 9993.8,-2335.33"/>
<polygon fill="black" stroke="black" points="9990.41,-2336.26 9995.57,-2345.51 9997.31,-2335.06 9990.41,-2336.26"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;caption_io.has_caption -->
<g id="edge159" class="edge">
<title>debug_dump.collect_files&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M7724.17,-1006.43C7950.71,-990.68 8274.02,-968.21 8427.17,-957.57"/>
<polygon fill="black" stroke="black" points="8427.72,-961.04 8437.45,-956.85 8427.24,-954.06 8427.72,-961.04"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;notes_utils.load_json -->
<g id="edge155" class="edge">
<title>debug_dump.collect_files&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M7604.28,-999.02C7730.07,-982.73 7918.88,-981.83 8022,-1095.53 8100.87,-1182.5 7975.07,-2068.43 8058,-2151.53 8129.79,-2223.46 8900.41,-2112.41 8972,-2184.53 9070.35,-2283.62 8911.77,-3339.38 9008,-3440.53 9074.82,-3510.78 9194.79,-3502.8 9273.65,-3487.56"/>
<polygon fill="black" stroke="black" points="9274.43,-3490.97 9283.54,-3485.57 9273.04,-3484.11 9274.43,-3490.97"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;lot_io.lot_json_path -->
<g id="edge156" class="edge">
<title>debug_dump.collect_files&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M7724.02,-1010.58C7847.74,-1009.88 7980.18,-1020 8022,-1062.53 8124.82,-1167.12 7963.34,-1609.51 8058,-1721.53 8148.11,-1828.17 8323.02,-1838 8428.07,-1832.98"/>
<polygon fill="black" stroke="black" points="8428.53,-1836.46 8438.33,-1832.43 8428.16,-1829.47 8428.53,-1836.46"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;caption_io.read_caption -->
<g id="edge160" class="edge">
<title>debug_dump.collect_files&#45;&gt;caption_io.read_caption</title>
<path fill="none" stroke="black" d="M7724.17,-1010.44C7847.94,-1009.69 7980.37,-1019.81 8022,-1062.53 8083.24,-1125.39 8004.38,-1782.06 8058,-1851.53 8123.87,-1936.89 8240.48,-1972.17 8339.28,-1986.23"/>
<polygon fill="black" stroke="black" points="8339.01,-1989.72 8349.39,-1987.6 8339.96,-1982.79 8339.01,-1989.72"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;caption_io.caption_json_path -->
<g id="edge158" class="edge">
<title>debug_dump.collect_files&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M7724.23,-1030.8C8126.15,-1045.16 8887.18,-1083.71 8972,-1171.53 9042,-1244.01 8936.72,-1552.32 9008,-1623.53 9075.67,-1691.15 9192.91,-1684.73 9271.22,-1670.45"/>
<polygon fill="black" stroke="black" points="9271.87,-1673.89 9281.04,-1668.58 9270.57,-1667.01 9271.87,-1673.89"/>
</g>
<!-- debug_dump.delete_files -->
<g id="node113" class="node">
<title>debug_dump.delete_files</title>
<g id="a_node113"><a xlink:title="Remove files related to ``lot_id`` from the filesystem.">
<polygon fill="none" stroke="black" points="7692.5,-1148.53 7261.5,-1148.53 7261.5,-1104.53 7692.5,-1104.53 7692.5,-1148.53"/>
<text text-anchor="middle" x="7477" y="-1118.21" font-family="Times,serif" font-size="32.90">debug_dump.delete_files</text>
</a>
</g>
</g>
<!-- debug_dump.delete_files&#45;&gt;post_io.raw_post_path -->
<g id="edge163" class="edge">
<title>debug_dump.delete_files&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7692.84,-1110.22C7824.83,-1105.42 7976.98,-1111.09 8022,-1157.53 8075.62,-1212.84 8020.05,-2476.5 8058,-2543.53 8142.27,-2692.38 8337.77,-2776.3 8443.35,-2812.28"/>
<polygon fill="black" stroke="black" points="8442.37,-2815.64 8452.96,-2815.51 8444.6,-2809.01 8442.37,-2815.64"/>
</g>
<!-- debug_dump.delete_files&#45;&gt;notes_utils.load_json -->
<g id="edge161" class="edge">
<title>debug_dump.delete_files&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M7692.71,-1110.35C7824.63,-1105.61 7976.77,-1111.3 8022,-1157.53 8101.85,-1239.15 7977.75,-2103.31 8058,-2184.53 8129.46,-2256.85 8900.74,-2155.02 8972,-2227.53 9066.51,-2323.7 8915.01,-3342.89 9008,-3440.53 9074.86,-3510.74 9194.82,-3502.78 9273.67,-3487.54"/>
<polygon fill="black" stroke="black" points="9274.44,-3490.96 9283.55,-3485.55 9273.06,-3484.1 9274.44,-3490.96"/>
</g>
<!-- debug_dump.delete_files&#45;&gt;lot_io.lot_json_path -->
<g id="edge162" class="edge">
<title>debug_dump.delete_files&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M7549.31,-1104.53C7665.93,-1073.47 7896.99,-1033.38 8022,-1157.53 8111.11,-1246.03 7976.5,-1625.98 8058,-1721.53 8148.6,-1827.76 8323.34,-1837.73 8428.23,-1832.85"/>
<polygon fill="black" stroke="black" points="8428.67,-1836.33 8438.47,-1832.31 8428.3,-1829.34 8428.67,-1836.33"/>
</g>
<!-- debug_dump.delete_files&#45;&gt;caption_io.caption_json_path -->
<g id="edge164" class="edge">
<title>debug_dump.delete_files&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M7579.75,-1104.5C7696.33,-1085.15 7888.44,-1071.85 8022,-1157.53 8050.78,-1176 8029.19,-1207.12 8058,-1225.53 8143.69,-1280.31 8898.34,-1204.41 8972,-1274.53 9028.47,-1328.29 8952.21,-1569.07 9008,-1623.53 9075.91,-1689.82 9191.63,-1684.23 9269.66,-1670.45"/>
<polygon fill="black" stroke="black" points="9270.74,-1673.81 9279.94,-1668.55 9269.47,-1666.93 9270.74,-1673.81"/>
</g>
<!-- debug_dump.delete_files&#45;&gt;caption_io.caption_md_path -->
<g id="edge165" class="edge">
<title>debug_dump.delete_files&#45;&gt;caption_io.caption_md_path</title>
<path fill="none" stroke="black" d="M7692.51,-1112.49C8050.23,-1092.45 8751.15,-1068.55 8972,-1171.53 9160.56,-1259.46 9295.22,-1490.03 9337.18,-1569.3"/>
<polygon fill="black" stroke="black" points="9334.1,-1570.96 9341.83,-1578.2 9340.3,-1567.72 9334.1,-1570.96"/>
</g>
<!-- debug_dump._message_reason -->
<g id="node114" class="node">
<title>debug_dump._message_reason</title>
<g id="a_node114"><a xlink:title="Return explanation why a message would be skipped.">
<polygon fill="none" stroke="black" points="9624.5,-1735.03 9079.5,-1735.03 9079.5,-1690.03 9624.5,-1690.03 9624.5,-1735.03"/>
<text text-anchor="middle" x="9352" y="-1704.15" font-family="Times,serif" font-size="33.60">debug_dump._message_reason</text>
</a>
</g>
</g>
<!-- debug_dump._message_reason&#45;&gt;moderation.should_skip_user -->
<g id="edge166" class="edge">
<title>debug_dump._message_reason&#45;&gt;moderation.should_skip_user</title>
<path fill="none" stroke="black" d="M9624.78,-1718.2C9650.97,-1709.33 9675.4,-1696.26 9696,-1677.53 9927.96,-1466.65 9988.43,-378.7 9997.27,-188.82"/>
<polygon fill="black" stroke="black" points="10000.77,-188.94 9997.73,-178.79 9993.78,-188.62 10000.77,-188.94"/>
</g>
<!-- debug_dump._lot_reason -->
<g id="node115" class="node">
<title>debug_dump._lot_reason</title>
<g id="a_node115"><a xlink:title="Return explanation why ``lot`` would be skipped.">
<polygon fill="none" stroke="black" points="9506,-1796.53 9198,-1796.53 9198,-1760.53 9506,-1760.53 9506,-1796.53"/>
<text text-anchor="middle" x="9352" y="-1772.94" font-family="Times,serif" font-size="23.24">debug_dump._lot_reason</text>
</a>
</g>
</g>
<!-- debug_dump.moderation_summary -->
<g id="node116" class="node">
<title>debug_dump.moderation_summary</title>
<g id="a_node116"><a xlink:title="Return a multi&#45;line summary of moderation checks for ``lot_id``.">
<polygon fill="none" stroke="black" points="7923.5,-1898.53 7030.5,-1898.53 7030.5,-1836.53 7923.5,-1836.53 7923.5,-1898.53"/>
<text text-anchor="middle" x="7477" y="-1855.33" font-family="Times,serif" font-size="49.00">debug_dump.moderation_summary</text>
</a>
</g>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;post_io.read_post -->
<g id="edge171" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7923.73,-1873.85C7967.97,-1882.17 8003.4,-1894.54 8022,-1912.53 8121.69,-2008.98 7959.82,-2124.56 8058,-2222.53 8102.64,-2267.08 8163.25,-2289.05 8225.71,-2298.15"/>
<polygon fill="black" stroke="black" points="8225.37,-2301.64 8235.74,-2299.5 8226.3,-2294.7 8225.37,-2301.64"/>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;post_io.raw_post_path -->
<g id="edge172" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7923.71,-1877.14C7960.6,-1893.24 7994.29,-1915.44 8022,-1945.53 8112.19,-2043.46 7990.44,-2428.82 8058,-2543.53 8145.03,-2691.31 8340.26,-2775.91 8444.81,-2812.21"/>
<polygon fill="black" stroke="black" points="8443.73,-2815.54 8454.33,-2815.46 8446,-2808.91 8443.73,-2815.54"/>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;notes_utils.load_json -->
<g id="edge169" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M7923.52,-1877.76C7960.38,-1893.76 7994.12,-1915.76 8022,-1945.53 8093.3,-2021.67 7982.76,-2341.29 8058,-2413.53 8131.3,-2483.91 8900.14,-2374.68 8972,-2446.53 9050.15,-2524.68 8931.53,-3360.75 9008,-3440.53 9074.99,-3510.42 9194.63,-3502.64 9273.41,-3487.52"/>
<polygon fill="black" stroke="black" points="9274.17,-3490.94 9283.29,-3485.55 9272.79,-3484.08 9274.17,-3490.94"/>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;lot_io.lot_json_path -->
<g id="edge170" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M7923.75,-1849.03C8113.54,-1841.16 8316.53,-1832.73 8428.1,-1828.1"/>
<polygon fill="black" stroke="black" points="8428.43,-1831.59 8438.28,-1827.68 8428.14,-1824.59 8428.43,-1831.59"/>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;debug_dump._message_reason -->
<g id="edge167" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;debug_dump._message_reason</title>
<path fill="none" stroke="black" d="M7923.58,-1871.33C7958.28,-1860.83 7991.59,-1846.56 8022,-1827.53 8049.01,-1810.63 8030.72,-1781.99 8058,-1765.53 8079.39,-1752.63 8695.31,-1732.07 9069.24,-1720.72"/>
<polygon fill="black" stroke="black" points="9069.51,-1724.22 9079.4,-1720.42 9069.3,-1717.22 9069.51,-1724.22"/>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;debug_dump._lot_reason -->
<g id="edge168" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;debug_dump._lot_reason</title>
<path fill="none" stroke="black" d="M7923.79,-1857.74C7957.61,-1850.07 7990.72,-1840.17 8022,-1827.53 8041.31,-1819.73 8038.47,-1804.77 8058,-1797.53 8161.06,-1759.36 8862.93,-1768.47 9187.28,-1774.86"/>
<polygon fill="black" stroke="black" points="9187.64,-1778.37 9197.71,-1775.07 9187.78,-1771.37 9187.64,-1778.37"/>
</g>
<!-- debug_dump.main -->
<g id="node117" class="node">
<title>debug_dump.main</title>
<g id="a_node117"><a xlink:title="Collect log and data files related to a single lot.">
<polygon fill="none" stroke="black" points="6613,-1036.03 6133,-1036.03 6133,-973.03 6613,-973.03 6613,-1036.03"/>
<text text-anchor="middle" x="6373" y="-992.39" font-family="Times,serif" font-size="49.56">debug_dump.main</text>
</a>
</g>
</g>
<!-- debug_dump.main&#45;&gt;oom_utils.prefer_oom_kill -->
<g id="edge180" class="edge">
<title>debug_dump.main&#45;&gt;oom_utils.prefer_oom_kill</title>
<path fill="none" stroke="black" d="M6465.88,-972.95C6575.33,-937.13 6764.46,-880.95 6932,-859.53 6992.07,-851.86 7977.13,-818.86 8022,-859.53 8082.55,-914.42 8011.2,-1158.53 8058,-1225.53 8139.02,-1341.54 8298.45,-1398.64 8405.64,-1425.05"/>
<polygon fill="black" stroke="black" points="8404.99,-1428.49 8415.53,-1427.43 8406.63,-1421.69 8404.99,-1428.49"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.parse_url -->
<g id="edge173" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.parse_url</title>
<path fill="none" stroke="black" d="M6451.42,-973.01C6557.73,-931.31 6755.8,-859.28 6932,-826.53 7060.19,-802.71 7208.03,-795.26 7317.2,-793.46"/>
<polygon fill="black" stroke="black" points="7317.37,-796.96 7327.31,-793.31 7317.26,-789.96 7317.37,-796.96"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.guess_source_from_lot -->
<g id="edge174" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.guess_source_from_lot</title>
<path fill="none" stroke="black" d="M6459.74,-972.98C6575.31,-926.18 6779.95,-827.52 6896,-678.53 6928.13,-637.28 6890.36,-598.15 6932,-566.53 7036.81,-486.94 7870.25,-491.74 8283.43,-499.2"/>
<polygon fill="black" stroke="black" points="8283.65,-502.71 8293.71,-499.39 8283.78,-495.71 8283.65,-502.71"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.load_source_info -->
<g id="edge175" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.load_source_info</title>
<path fill="none" stroke="black" d="M6613.07,-1003.79C6715.99,-1016.8 6828.07,-1051.5 6896,-1134.53 6952.76,-1203.92 6869.29,-1876.47 6932,-1940.53 6971.77,-1981.16 7093.99,-1991.59 7212.53,-1991.21"/>
<polygon fill="black" stroke="black" points="7212.91,-1994.71 7222.89,-1991.15 7212.87,-1987.71 7212.91,-1994.71"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.run_tg_fetch -->
<g id="edge176" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.run_tg_fetch</title>
<path fill="none" stroke="black" d="M6437.01,-972.96C6539.28,-920.08 6745.16,-806.69 6896,-678.53 6914.48,-662.83 6910.01,-647.75 6932,-637.53 7126.18,-547.29 8545.67,-570.35 9115.37,-583.48"/>
<polygon fill="black" stroke="black" points="9115.69,-586.98 9125.77,-583.72 9115.85,-579.99 9115.69,-586.98"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.collect_files -->
<g id="edge177" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.collect_files</title>
<path fill="none" stroke="black" d="M6613.12,-1008.66C6792.13,-1011.74 7036.64,-1015.96 7219.68,-1019.11"/>
<polygon fill="black" stroke="black" points="7219.66,-1022.61 7229.72,-1019.29 7219.78,-1015.62 7219.66,-1022.61"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.delete_files -->
<g id="edge178" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.delete_files</title>
<path fill="none" stroke="black" d="M6552.21,-1036.04C6661.51,-1054.35 6804.49,-1076.51 6932,-1090.53 7036.72,-1102.05 7153.21,-1110.35 7251.44,-1116.07"/>
<polygon fill="black" stroke="black" points="7251.31,-1119.56 7261.5,-1116.65 7251.72,-1112.58 7251.31,-1119.56"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.moderation_summary -->
<g id="edge179" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.moderation_summary</title>
<path fill="none" stroke="black" d="M6613.13,-1004.06C6715.9,-1017.15 6827.84,-1051.83 6896,-1134.53 6945.04,-1194.03 6878.07,-1772.43 6932,-1827.53 7038.01,-1935.85 7224.08,-1924.37 7348.68,-1900.54"/>
<polygon fill="black" stroke="black" points="7349.53,-1903.94 7358.67,-1898.58 7348.18,-1897.07 7349.53,-1903.94"/>
</g>
<!-- message_utils.gather_chop_input -->
<g id="node118" class="node">
<title>message_utils.gather_chop_input</title>
<g id="a_node118"><a xlink:title="Return the exact text fed to the lot parser for ``msg_path``.">
<polygon fill="none" stroke="black" points="7689.5,-1818.53 7264.5,-1818.53 7264.5,-1782.53 7689.5,-1782.53 7689.5,-1818.53"/>
<text text-anchor="middle" x="7477" y="-1794.66" font-family="Times,serif" font-size="24.22">message_utils.gather_chop_input</text>
</a>
</g>
</g>
<!-- message_utils.gather_chop_input&#45;&gt;post_io.read_post -->
<g id="edge182" class="edge">
<title>message_utils.gather_chop_input&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7689.62,-1783.6C7821.64,-1778.07 7975.09,-1782.52 8022,-1827.53 8085.6,-1888.56 7996.38,-2159.51 8058,-2222.53 8102.28,-2267.83 8163.03,-2290.01 8225.76,-2299.06"/>
<polygon fill="black" stroke="black" points="8225.46,-2302.55 8235.84,-2300.4 8226.39,-2295.61 8225.46,-2302.55"/>
</g>
<!-- message_utils.gather_chop_input&#45;&gt;caption_io.read_caption -->
<g id="edge183" class="edge">
<title>message_utils.gather_chop_input&#45;&gt;caption_io.read_caption</title>
<path fill="none" stroke="black" d="M7689.77,-1785.12C7792.44,-1784.11 7916.15,-1792.6 8022,-1827.53 8040.26,-1833.56 8040.64,-1843.26 8058,-1851.53 8177.63,-1908.58 8325.65,-1949.75 8419.96,-1972.63"/>
<polygon fill="black" stroke="black" points="8419.23,-1976.05 8429.77,-1974.99 8420.86,-1969.24 8419.23,-1976.05"/>
</g>
<!-- message_utils.gather_chop_input&#45;&gt;message_utils.build_prompt -->
<g id="edge181" class="edge">
<title>message_utils.gather_chop_input&#45;&gt;message_utils.build_prompt</title>
<path fill="none" stroke="black" d="M7689.83,-1817.33C7821.7,-1822.76 7974.91,-1818.26 8022,-1773.53 8079.49,-1718.93 8012.5,-1483.47 8058,-1418.53 8139.32,-1302.48 8299.06,-1245.35 8406.2,-1218.95"/>
<polygon fill="black" stroke="black" points="8407.18,-1222.31 8416.08,-1216.57 8405.53,-1215.51 8407.18,-1222.31"/>
</g>
<!-- notes_utils.read_md&#45;&gt;notes_utils.read_text -->
<g id="edge185" class="edge">
<title>notes_utils.read_md&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M9422.32,-2151.76C9492.79,-2156.66 9604.35,-2168.94 9696,-2199.53 9799.86,-2234.21 9910.07,-2303.3 9964.29,-2339.75"/>
<polygon fill="black" stroke="black" points="9962.58,-2342.82 9972.82,-2345.53 9966.5,-2337.02 9962.58,-2342.82"/>
</g>
<!-- notes_utils.parse_md -->
<g id="node122" class="node">
<title>notes_utils.parse_md</title>
<g id="a_node122"><a xlink:title="Return metadata dictionary and body text from ``path``.">
<polygon fill="none" stroke="black" points="8598.5,-2142.53 8431.5,-2142.53 8431.5,-2106.53 8598.5,-2106.53 8598.5,-2142.53"/>
<text text-anchor="middle" x="8515" y="-2120.83" font-family="Times,serif" font-size="14.00">notes_utils.parse_md</text>
</a>
</g>
</g>
<!-- notes_utils.parse_md&#45;&gt;notes_utils.read_md -->
<g id="edge186" class="edge">
<title>notes_utils.parse_md&#45;&gt;notes_utils.read_md</title>
<path fill="none" stroke="black" d="M8598.73,-2126.91C8759.78,-2131.54 9113.44,-2141.71 9271.7,-2146.25"/>
<polygon fill="black" stroke="black" points="9271.74,-2149.76 9281.84,-2146.55 9271.95,-2142.76 9271.74,-2149.76"/>
</g>
<!-- notes_utils.parse_md&#45;&gt;notes_utils._parse_block -->
<g id="edge187" class="edge">
<title>notes_utils.parse_md&#45;&gt;notes_utils._parse_block</title>
<path fill="none" stroke="black" d="M8598.9,-2120.21C8691.65,-2117.68 8845.5,-2120.45 8972,-2156.53 8989.4,-2161.5 8990.82,-2169.88 9008,-2175.53 9060.24,-2192.73 9118.86,-2204.28 9172.65,-2212.01"/>
<polygon fill="black" stroke="black" points="9172.25,-2215.49 9182.64,-2213.42 9173.22,-2208.56 9172.25,-2215.49"/>
</g>
<!-- scan_ontology.collect_ontology -->
<g id="node123" class="node">
<title>scan_ontology.collect_ontology</title>
<g id="a_node123"><a xlink:title="Return counts per field, value counters, misparsed lots and broken metadata.">
<polygon fill="none" stroke="black" points="6831,-3223.03 5915,-3223.03 5915,-3152.03 6831,-3152.03 6831,-3223.03"/>
<text text-anchor="middle" x="6373" y="-3172.89" font-family="Times,serif" font-size="57.68">scan_ontology.collect_ontology</text>
</a>
</g>
</g>
<!-- scan_ontology.collect_ontology&#45;&gt;moderation.is_misparsed -->
<g id="edge189" class="edge">
<title>scan_ontology.collect_ontology&#45;&gt;moderation.is_misparsed</title>
<path fill="none" stroke="black" d="M6685.76,-3223.08C6766.77,-3247.97 6845.41,-3289.3 6896,-3357.53 6955.54,-3437.83 6862.63,-5084.56 6932,-5156.53 6975.5,-5201.68 7119.79,-5208.38 7248.84,-5204.35"/>
<polygon fill="black" stroke="black" points="7249.01,-5207.85 7258.89,-5204.02 7248.78,-5200.85 7249.01,-5207.85"/>
</g>
<!-- scan_ontology.collect_ontology&#45;&gt;lot_io.read_lots -->
<g id="edge191" class="edge">
<title>scan_ontology.collect_ontology&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M6674.44,-3223.04C6758.19,-3247.73 6841.16,-3288.96 6896,-3357.53 6949.67,-3424.64 6868.71,-3684.41 6932,-3742.53 6985.82,-3791.96 8043.57,-3768.19 8398.8,-3758.77"/>
<polygon fill="black" stroke="black" points="8398.94,-3762.26 8408.85,-3758.5 8398.76,-3755.27 8398.94,-3762.26"/>
</g>
<!-- scan_ontology.collect_ontology&#45;&gt;post_io.read_post -->
<g id="edge192" class="edge">
<title>scan_ontology.collect_ontology&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M6533.77,-3223.04C6650.76,-3238.77 6804.48,-3236.24 6896,-3142.53 6985.76,-3050.62 6839.92,-2655.12 6932,-2565.53 7018.86,-2481.03 7929.1,-2605.35 8022,-2527.53 8080.54,-2478.5 8003.29,-2412.8 8058,-2359.53 8103.32,-2315.41 8163.76,-2290.36 8225.78,-2276.83"/>
<polygon fill="black" stroke="black" points="8226.66,-2280.22 8235.74,-2274.76 8225.24,-2273.37 8226.66,-2280.22"/>
</g>
<!-- scan_ontology.collect_ontology&#45;&gt;post_io.raw_post_path -->
<g id="edge193" class="edge">
<title>scan_ontology.collect_ontology&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M6831.16,-3177.82C6853.97,-3168.3 6875.77,-3156.66 6896,-3142.53 6926.97,-3120.9 6900.53,-3086.44 6932,-3065.53 7032.95,-2998.46 7903.29,-3046.98 8022,-3022.53 8194.55,-2987 8385.84,-2898.01 8470.09,-2856.07"/>
<polygon fill="black" stroke="black" points="8471.73,-2859.16 8479.11,-2851.56 8468.6,-2852.9 8471.73,-2859.16"/>
</g>
<!-- scan_ontology.collect_ontology&#45;&gt;message_utils.gather_chop_input -->
<g id="edge190" class="edge">
<title>scan_ontology.collect_ontology&#45;&gt;message_utils.gather_chop_input</title>
<path fill="none" stroke="black" d="M6528.33,-3223.05C6646.57,-3240.21 6804.5,-3239.57 6896,-3142.53 6996.28,-3036.19 6829.8,-1932.03 6932,-1827.53 6976.38,-1782.15 7123.83,-1776.95 7254.03,-1782.25"/>
<polygon fill="black" stroke="black" points="7254.03,-1785.76 7264.17,-1782.69 7254.33,-1778.76 7254.03,-1785.76"/>
</g>
<!-- scan_ontology.main -->
<g id="node124" class="node">
<title>scan_ontology.main</title>
<polygon fill="none" stroke="black" points="5726,-3216.03 5267,-3216.03 5267,-3159.03 5726,-3159.03 5726,-3216.03"/>
<text text-anchor="middle" x="5496.5" y="-3176.19" font-family="Times,serif" font-size="44.80">scan_ontology.main</text>
</g>
<!-- scan_ontology.main&#45;&gt;oom_utils.prefer_oom_kill -->
<g id="edge194" class="edge">
<title>scan_ontology.main&#45;&gt;oom_utils.prefer_oom_kill</title>
<path fill="none" stroke="black" d="M5529.21,-3159.01C5595.52,-3097.21 5748.14,-2943.17 5814,-2778.53 5843.04,-2705.94 5793.04,-2482.1 5850,-2428.53 5934.74,-2348.85 6813.68,-2467.71 6896,-2385.53 6962.19,-2319.45 6865.84,-1610.65 6932,-1544.53 7017.74,-1458.84 7906.75,-1536.1 8022,-1498.53 8040.28,-1492.57 8039.78,-1480.69 8058,-1474.53 8147.73,-1444.22 8252.96,-1435.88 8339.7,-1435.6"/>
<polygon fill="black" stroke="black" points="8339.91,-1439.1 8349.91,-1435.61 8339.92,-1432.1 8339.91,-1439.1"/>
</g>
<!-- scan_ontology.main&#45;&gt;notes_utils.write_json -->
<g id="edge195" class="edge">
<title>scan_ontology.main&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M5590.32,-3216.08C5664.5,-3244.18 5764.05,-3294.93 5814,-3376.53 5877.36,-3480.06 5764.66,-3835.22 5850,-3921.53 6013.92,-4087.32 6695.84,-3882.99 6896,-4002.53 6921.4,-4017.7 6906.36,-4043.76 6932,-4058.53 6996.06,-4095.45 8069.72,-4121.87 8410.84,-4129.37"/>
<polygon fill="black" stroke="black" points="8410.89,-4132.87 8420.96,-4129.59 8411.04,-4125.87 8410.89,-4132.87"/>
</g>
<!-- scan_ontology.main&#45;&gt;scan_ontology.collect_ontology -->
<g id="edge196" class="edge">
<title>scan_ontology.main&#45;&gt;scan_ontology.collect_ontology</title>
<path fill="none" stroke="black" d="M5726.12,-3187.53C5781.37,-3187.53 5842.42,-3187.53 5904.29,-3187.53"/>
<polygon fill="black" stroke="black" points="5904.63,-3191.03 5914.63,-3187.53 5904.63,-3184.03 5904.63,-3191.03"/>
</g>
<!-- log_utils.install_excepthook -->
<g id="node125" class="node">
<title>log_utils.install_excepthook</title>
<g id="a_node125"><a xlink:title="Redirect uncaught exceptions to ``logger.exception``.">
<polygon fill="none" stroke="black" points="6559.5,-3779.53 6186.5,-3779.53 6186.5,-3743.53 6559.5,-3743.53 6559.5,-3779.53"/>
<text text-anchor="middle" x="6373" y="-3755.37" font-family="Times,serif" font-size="25.20">log_utils.install_excepthook</text>
</a>
</g>
</g>
<!-- scan_ontology.main&#45;&gt;log_utils.install_excepthook -->
<g id="edge197" class="edge">
<title>scan_ontology.main&#45;&gt;log_utils.install_excepthook</title>
<path fill="none" stroke="black" d="M5588.49,-3216.1C5662.35,-3244.39 5762.41,-3295.39 5814,-3376.53 5856.9,-3444.01 5792.11,-3679.38 5850,-3734.53 5895.98,-3778.33 6047.71,-3782.31 6175.82,-3776.92"/>
<polygon fill="black" stroke="black" points="6176.33,-3780.4 6186.17,-3776.46 6176.02,-3773.41 6176.33,-3780.4"/>
</g>
<!-- log_utils._extract_tb_lineno -->
<g id="node142" class="node">
<title>log_utils._extract_tb_lineno</title>
<g id="a_node142"><a xlink:title="Return the last line number from a traceback.">
<polygon fill="none" stroke="black" points="7592.5,-3825.53 7361.5,-3825.53 7361.5,-3789.53 7592.5,-3789.53 7592.5,-3825.53"/>
<text text-anchor="middle" x="7477" y="-3803.49" font-family="Times,serif" font-size="15.68">log_utils._extract_tb_lineno</text>
</a>
</g>
</g>
<!-- log_utils.install_excepthook&#45;&gt;log_utils._extract_tb_lineno -->
<g id="edge241" class="edge">
<title>log_utils.install_excepthook&#45;&gt;log_utils._extract_tb_lineno</title>
<path fill="none" stroke="black" d="M6559.69,-3769.28C6784.77,-3778.68 7157.86,-3794.25 7351.21,-3802.32"/>
<polygon fill="black" stroke="black" points="7351.28,-3805.83 7361.42,-3802.75 7351.57,-3798.84 7351.28,-3805.83"/>
</g>
<!-- caption._identify_size -->
<g id="node126" class="node">
<title>caption._identify_size</title>
<g id="a_node126"><a xlink:title="Return ``(width, height)`` for ``path`` using ImageMagick.">
<polygon fill="none" stroke="black" points="8643.5,-3490.53 8386.5,-3490.53 8386.5,-3454.53 8643.5,-3454.53 8643.5,-3490.53"/>
<text text-anchor="middle" x="8515" y="-3466.84" font-family="Times,serif" font-size="22.12">caption._identify_size</text>
</a>
</g>
</g>
<!-- caption._prepare_image -->
<g id="node127" class="node">
<title>caption._prepare_image</title>
<g id="a_node127"><a xlink:title="Resize ``path`` and return the processed JPEG bytes.">
<polygon fill="none" stroke="black" points="7694,-3484.53 7260,-3484.53 7260,-3438.53 7694,-3438.53 7694,-3484.53"/>
<text text-anchor="middle" x="7477" y="-3453.09" font-family="Times,serif" font-size="34.30">caption._prepare_image</text>
</a>
</g>
</g>
<!-- caption._prepare_image&#45;&gt;caption._identify_size -->
<g id="edge198" class="edge">
<title>caption._prepare_image&#45;&gt;caption._identify_size</title>
<path fill="none" stroke="black" d="M7694.23,-3463.83C7899.46,-3466.01 8201.73,-3469.22 8376.12,-3471.07"/>
<polygon fill="black" stroke="black" points="8376.1,-3474.57 8386.13,-3471.18 8376.17,-3467.57 8376.1,-3474.57"/>
</g>
<!-- caption._guess_chat -->
<g id="node128" class="node">
<title>caption._guess_chat</title>
<g id="a_node128"><a xlink:title="Return chat name for ``path`` relative to ``MEDIA_DIR``.">
<polygon fill="none" stroke="black" points="8611,-3436.53 8419,-3436.53 8419,-3400.53 8611,-3400.53 8611,-3436.53"/>
<text text-anchor="middle" x="8515" y="-3414.37" font-family="Times,serif" font-size="17.08">caption._guess_chat</text>
</a>
</g>
</g>
<!-- caption.caption_file -->
<g id="node129" class="node">
<title>caption.caption_file</title>
<g id="a_node129"><a xlink:title="Caption ``path`` with GPT&#45;4o and save ``.caption.json`` beside it.">
<polygon fill="none" stroke="black" points="6676,-3440.03 6070,-3440.03 6070,-3367.03 6676,-3367.03 6676,-3440.03"/>
<text text-anchor="middle" x="6373" y="-3388.55" font-family="Times,serif" font-size="59.36">caption.caption_file</text>
</a>
</g>
</g>
<!-- caption.caption_file&#45;&gt;caption_io.has_caption -->
<g id="edge203" class="edge">
<title>caption.caption_file&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M6676.11,-3369.87C6760.59,-3345.03 6843.56,-3302.82 6896,-3231.53 6969.82,-3131.19 6844.27,-1077.97 6932,-989.53 6945.26,-976.16 8097.44,-957.8 8426.91,-952.82"/>
<polygon fill="black" stroke="black" points="8427.4,-956.32 8437.35,-952.67 8427.29,-949.32 8427.4,-956.32"/>
</g>
<!-- caption.caption_file&#45;&gt;notes_utils.load_json -->
<g id="edge199" class="edge">
<title>caption.caption_file&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M6676.26,-3394.8C7339.42,-3376.65 8871.3,-3340.56 8972,-3391.53 8996.11,-3403.74 8984.39,-3427.39 9008,-3440.53 9071.05,-3475.62 9150.97,-3483.61 9217.8,-3482.26"/>
<polygon fill="black" stroke="black" points="9218.08,-3485.75 9227.98,-3481.98 9217.89,-3478.75 9218.08,-3485.75"/>
</g>
<!-- caption.caption_file&#45;&gt;caption_io.caption_json_path -->
<g id="edge202" class="edge">
<title>caption.caption_file&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M6676.06,-3369.13C6760.28,-3344.24 6843.1,-3302.19 6896,-3231.53 6968.89,-3134.18 6847.59,-2225.1 6932,-2137.53 7100.51,-1962.72 7835.27,-2216.74 8022,-2061.53 8071.08,-2020.74 8009.09,-1963.52 8058,-1922.53 8214.15,-1791.69 8818.9,-1985.93 8972,-1851.53 9030.37,-1800.3 8949.88,-1732.05 9008,-1680.53 9075,-1621.15 9181.01,-1620.98 9257.45,-1631.07"/>
<polygon fill="black" stroke="black" points="9257.17,-1634.56 9267.56,-1632.48 9258.14,-1627.63 9257.17,-1634.56"/>
</g>
<!-- caption.caption_file&#45;&gt;caption._prepare_image -->
<g id="edge200" class="edge">
<title>caption.caption_file&#45;&gt;caption._prepare_image</title>
<path fill="none" stroke="black" d="M6676.22,-3419.44C6857.37,-3428.97 7083.94,-3440.9 7249.63,-3449.62"/>
<polygon fill="black" stroke="black" points="7249.79,-3453.13 7259.96,-3450.16 7250.16,-3446.14 7249.79,-3453.13"/>
</g>
<!-- caption.caption_file&#45;&gt;caption._guess_chat -->
<g id="edge201" class="edge">
<title>caption.caption_file&#45;&gt;caption._guess_chat</title>
<path fill="none" stroke="black" d="M6676.07,-3405.65C7162.22,-3409.06 8095.38,-3415.6 8408.57,-3417.79"/>
<polygon fill="black" stroke="black" points="8408.97,-3421.3 8419,-3417.87 8409.02,-3414.3 8408.97,-3421.3"/>
</g>
<!-- caption_io.write_caption -->
<g id="node130" class="node">
<title>caption_io.write_caption</title>
<g id="a_node130"><a xlink:title="Write ``text`` as ``lang`` caption for ``image``.">
<polygon fill="none" stroke="black" points="7643.5,-3733.53 7310.5,-3733.53 7310.5,-3697.53 7643.5,-3697.53 7643.5,-3733.53"/>
<text text-anchor="middle" x="7477" y="-3709.37" font-family="Times,serif" font-size="25.20">caption_io.write_caption</text>
</a>
</g>
</g>
<!-- caption.caption_file&#45;&gt;caption_io.write_caption -->
<g id="edge204" class="edge">
<title>caption.caption_file&#45;&gt;caption_io.write_caption</title>
<path fill="none" stroke="black" d="M6676.27,-3413.69C6756.96,-3430.65 6837.78,-3462.81 6896,-3521.53 6949.15,-3575.15 6874.47,-3638.65 6932,-3687.53 7065.79,-3801.22 7291.62,-3764.74 7405.64,-3736.11"/>
<polygon fill="black" stroke="black" points="7406.83,-3739.42 7415.65,-3733.54 7405.1,-3732.64 7406.83,-3739.42"/>
</g>
<!-- caption_io.write_caption&#45;&gt;notes_utils.load_json -->
<g id="edge305" class="edge">
<title>caption_io.write_caption&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M7643.67,-3715.57C8021.55,-3714.99 8918.77,-3709.6 8972,-3671.53 9009.07,-3645.03 8974.92,-3606.88 9008,-3575.53 9064.58,-3521.91 9147.56,-3494.91 9217.73,-3481.31"/>
<polygon fill="black" stroke="black" points="9218.8,-3484.67 9227.99,-3479.4 9217.52,-3477.79 9218.8,-3484.67"/>
</g>
<!-- caption_io.write_caption&#45;&gt;notes_utils.write_json -->
<g id="edge306" class="edge">
<title>caption_io.write_caption&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M7643.77,-3713.78C7783.88,-3716.06 7969.89,-3729.15 8022,-3780.53 8107.89,-3865.22 7974.64,-3962.35 8058,-4049.53 8147.84,-4143.5 8305.99,-4151.5 8410.39,-4144.63"/>
<polygon fill="black" stroke="black" points="8410.91,-4148.1 8420.64,-4143.9 8410.41,-4141.12 8410.91,-4148.1"/>
</g>
<!-- caption_io.write_caption&#45;&gt;caption_io.caption_json_path -->
<g id="edge308" class="edge">
<title>caption_io.write_caption&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M7643.76,-3730.59C7784.4,-3739.28 7971.21,-3739.8 8022,-3687.53 8083.57,-3624.16 7997.47,-2161.9 8058,-2097.53 8197.64,-1949.05 8826.33,-2163.11 8972,-2020.53 9026.3,-1967.39 8953.79,-1733.77 9008,-1680.53 9074.54,-1615.2 9187.35,-1618.35 9265.33,-1630.78"/>
<polygon fill="black" stroke="black" points="9265.17,-1634.3 9275.61,-1632.51 9266.33,-1627.4 9265.17,-1634.3"/>
</g>
<!-- caption_io.write_caption&#45;&gt;caption_io._get_langs -->
<g id="edge307" class="edge">
<title>caption_io.write_caption&#45;&gt;caption_io._get_langs</title>
<path fill="none" stroke="black" d="M7643.59,-3722.58C7752.54,-3723.43 7897.49,-3717.32 8022,-3687.53 8039.03,-3683.46 8040.99,-3675.69 8058,-3671.53 8156.84,-3647.38 8895.14,-3682.21 8972,-3615.53 9031.98,-3563.5 8948.47,-3493.09 9008,-3440.53 9076.78,-3379.81 9186.51,-3382.24 9263.28,-3393.89"/>
<polygon fill="black" stroke="black" points="9262.99,-3397.39 9273.42,-3395.51 9264.1,-3390.48 9262.99,-3397.39"/>
</g>
<!-- caption.main -->
<g id="node131" class="node">
<title>caption.main</title>
<g id="a_node131"><a xlink:title="Caption a single image provided on the command line.">
<polygon fill="none" stroke="black" points="5589,-3421.53 5404,-3421.53 5404,-3385.53 5589,-3385.53 5589,-3421.53"/>
<text text-anchor="middle" x="5496.5" y="-3397.37" font-family="Times,serif" font-size="25.20">caption.main</text>
</a>
</g>
</g>
<!-- caption.main&#45;&gt;caption.caption_file -->
<g id="edge205" class="edge">
<title>caption.main&#45;&gt;caption.caption_file</title>
<path fill="none" stroke="black" d="M5589.02,-3403.53C5699.92,-3403.53 5892.62,-3403.53 6059.09,-3403.53"/>
<polygon fill="black" stroke="black" points="6059.51,-3407.03 6069.51,-3403.53 6059.51,-3400.03 6059.51,-3407.03"/>
</g>
<!-- price_train._iter_lots -->
<g id="node132" class="node">
<title>price_train._iter_lots</title>
<g id="a_node132"><a xlink:title="Return all lots with generated ids.">
<polygon fill="none" stroke="black" points="7632.5,-4666.03 7321.5,-4666.03 7321.5,-4627.03 7632.5,-4627.03 7632.5,-4666.03"/>
<text text-anchor="middle" x="7477" y="-4639.63" font-family="Times,serif" font-size="28.00">price_train._iter_lots</text>
</a>
</g>
</g>
<!-- price_train._iter_lots&#45;&gt;lot_io.read_lots -->
<g id="edge206" class="edge">
<title>price_train._iter_lots&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M7632.59,-4660.27C7774.07,-4669.08 7969.19,-4670.47 8022,-4617.53 8077.55,-4561.85 8010.59,-3973.29 8058,-3910.53 8137.35,-3805.51 8291.54,-3771.04 8398.52,-3760.06"/>
<polygon fill="black" stroke="black" points="8399.11,-3763.52 8408.73,-3759.07 8398.43,-3756.56 8399.11,-3763.52"/>
</g>
<!-- price_train._iter_lots&#45;&gt;lot_io.iter_lot_files -->
<g id="edge207" class="edge">
<title>price_train._iter_lots&#45;&gt;lot_io.iter_lot_files</title>
<path fill="none" stroke="black" d="M7632.72,-4659.07C7773.19,-4666.86 7966.61,-4667.41 8022,-4617.53 8097.59,-4549.48 7986.8,-4464.17 8058,-4391.53 8139.4,-4308.49 8274.27,-4293.09 8376.28,-4295.42"/>
<polygon fill="black" stroke="black" points="8376.26,-4298.92 8386.35,-4295.7 8376.46,-4291.92 8376.26,-4298.92"/>
</g>
<!-- price_train.main -->
<g id="node133" class="node">
<title>price_train.main</title>
<g id="a_node133"><a xlink:title="Train price regression model and save it.">
<polygon fill="none" stroke="black" points="6488,-4805.53 6258,-4805.53 6258,-4769.53 6488,-4769.53 6488,-4805.53"/>
<text text-anchor="middle" x="6373" y="-4781.37" font-family="Times,serif" font-size="25.20">price_train.main</text>
</a>
</g>
</g>
<!-- price_train.main&#45;&gt;similar_utils._load_embeddings -->
<g id="edge208" class="edge">
<title>price_train.main&#45;&gt;similar_utils._load_embeddings</title>
<path fill="none" stroke="black" d="M6488.25,-4789.72C6851.74,-4796.18 7961.24,-4812.01 8022,-4765.53 8068.26,-4730.15 8020.25,-4683.88 8058,-4639.53 8143.93,-4538.57 8288.02,-4482.14 8391.23,-4452.9"/>
<polygon fill="black" stroke="black" points="8392.4,-4456.21 8401.09,-4450.16 8390.52,-4449.47 8392.4,-4456.21"/>
</g>
<!-- price_train.main&#45;&gt;similar_utils._sync_embeddings -->
<g id="edge209" class="edge">
<title>price_train.main&#45;&gt;similar_utils._sync_embeddings</title>
<path fill="none" stroke="black" d="M6488.06,-4780.35C6599.46,-4768.81 6770.16,-4738.77 6896,-4660.53 6917.17,-4647.37 6909.71,-4628.68 6932,-4617.53 7061.34,-4552.88 7230.22,-4555.11 7345.28,-4567.39"/>
<polygon fill="black" stroke="black" points="7345.22,-4570.91 7355.54,-4568.53 7345.99,-4563.95 7345.22,-4570.91"/>
</g>
<!-- price_train.main&#45;&gt;price_train._iter_lots -->
<g id="edge210" class="edge">
<title>price_train.main&#45;&gt;price_train._iter_lots</title>
<path fill="none" stroke="black" d="M6445.67,-4769.46C6551.33,-4743.63 6755.49,-4696.82 6932,-4674.53 7058.7,-4658.53 7203.09,-4651.62 7311.26,-4648.66"/>
<polygon fill="black" stroke="black" points="7311.38,-4652.16 7321.29,-4648.4 7311.2,-4645.16 7311.38,-4652.16"/>
</g>
<!-- price_train.main&#45;&gt;price_utils.train_price_regression -->
<g id="edge211" class="edge">
<title>price_train.main&#45;&gt;price_utils.train_price_regression</title>
<path fill="none" stroke="black" d="M6488.18,-4776.51C6624.44,-4766.15 6840.82,-4759.43 6896,-4814.53 6949.38,-4867.84 6883.41,-5434.83 6932,-5492.53 6961.65,-5527.74 6999.03,-5554.15 7040.25,-5573.81"/>
<polygon fill="black" stroke="black" points="7038.84,-5577.02 7049.38,-5578.03 7041.77,-5570.66 7038.84,-5577.02"/>
</g>
<!-- price_utils.save_price_model -->
<g id="node135" class="node">
<title>price_utils.save_price_model</title>
<g id="a_node135"><a xlink:title="Write ``model`` parameters to ``path`` as JSON.">
<polygon fill="none" stroke="black" points="7689.5,-4723.03 7264.5,-4723.03 7264.5,-4684.03 7689.5,-4684.03 7689.5,-4723.03"/>
<text text-anchor="middle" x="7477" y="-4696.63" font-family="Times,serif" font-size="28.00">price_utils.save_price_model</text>
</a>
</g>
</g>
<!-- price_train.main&#45;&gt;price_utils.save_price_model -->
<g id="edge212" class="edge">
<title>price_train.main&#45;&gt;price_utils.save_price_model</title>
<path fill="none" stroke="black" d="M6488.04,-4778.84C6668.32,-4765.1 7022.42,-4738.11 7254.07,-4720.45"/>
<polygon fill="black" stroke="black" points="7254.61,-4723.92 7264.32,-4719.67 7254.08,-4716.94 7254.61,-4723.92"/>
</g>
<!-- price_utils.train_price_regression&#45;&gt;price_utils.canonical_currency -->
<g id="edge213" class="edge">
<title>price_utils.train_price_regression&#45;&gt;price_utils.canonical_currency</title>
<path fill="none" stroke="black" d="M8022.17,-5616.53C8131.13,-5616.53 8238.55,-5616.53 8325.06,-5616.53"/>
<polygon fill="black" stroke="black" points="8325.24,-5620.03 8335.24,-5616.53 8325.24,-5613.03 8325.24,-5620.03"/>
</g>
<!-- price_utils.save_price_model&#45;&gt;notes_utils.write_json -->
<g id="edge214" class="edge">
<title>price_utils.save_price_model&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M7689.59,-4719.91C7821.83,-4725.08 7975.56,-4720.13 8022,-4674.53 8101.65,-4596.34 7979.87,-4253.25 8058,-4173.53 8155.07,-4074.49 8331.58,-4090.92 8434.2,-4111.45"/>
<polygon fill="black" stroke="black" points="8433.7,-4114.92 8444.2,-4113.51 8435.11,-4108.06 8433.7,-4114.92"/>
</g>
<!-- price_utils.guess_currency -->
<g id="node138" class="node">
<title>price_utils.guess_currency</title>
<g id="a_node138"><a xlink:title="Return currency with multiplier closest to ``price/pred_usd``.&#10;&#10;``pred_usd`` is the predicted price in USD. &#160;``price`` is the numeric value&#10;provided by the user without a currency. &#160;The function compares the implied&#10;multiplier ``price / pred_usd`` against the learnt exchange rates and picks&#10;the closest match. &#160;``counts`` may be provided to ignore rarely seen&#10;currencies when guessing. &#160;Any currency with fewer than ``min_samples``&#10;samples in the training set is skipped.">
<polygon fill="none" stroke="black" points="10267,-5708.53 9732,-5708.53 9732,-5658.53 10267,-5658.53 10267,-5708.53"/>
<text text-anchor="middle" x="9999.5" y="-5673.85" font-family="Times,serif" font-size="38.36">price_utils.guess_currency</text>
</a>
</g>
</g>
<!-- price_utils._guess_currency_verified&#45;&gt;price_utils.guess_currency -->
<g id="edge216" class="edge">
<title>price_utils._guess_currency_verified&#45;&gt;price_utils.guess_currency</title>
<path fill="none" stroke="black" d="M9608.58,-5683.53C9645.76,-5683.53 9684.19,-5683.53 9721.76,-5683.53"/>
<polygon fill="black" stroke="black" points="9721.81,-5687.03 9731.81,-5683.53 9721.81,-5680.03 9721.81,-5687.03"/>
</g>
<!-- similar._iter_lots -->
<g id="node140" class="node">
<title>similar._iter_lots</title>
<g id="a_node140"><a xlink:title="Return lots filtered by moderation rules.">
<polygon fill="none" stroke="black" points="7631,-3679.03 7323,-3679.03 7323,-3632.03 7631,-3632.03 7631,-3679.03"/>
<text text-anchor="middle" x="7477" y="-3647.03" font-family="Times,serif" font-size="35.00">similar._iter_lots</text>
</a>
</g>
</g>
<!-- similar._iter_lots&#45;&gt;moderation.should_skip_message -->
<g id="edge222" class="edge">
<title>similar._iter_lots&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M7631.03,-3668.32C7773.01,-3676.41 7969.98,-3676.79 8022,-3622.53 8097.18,-3544.12 7989.75,-1752.04 8058,-1667.53 8124,-1585.81 8239.52,-1559.32 8337.76,-1553.13"/>
<polygon fill="black" stroke="black" points="8338.03,-1556.62 8347.82,-1552.56 8337.64,-1549.63 8338.03,-1556.62"/>
</g>
<!-- similar._iter_lots&#45;&gt;moderation.should_skip_lot -->
<g id="edge223" class="edge">
<title>similar._iter_lots&#45;&gt;moderation.should_skip_lot</title>
<path fill="none" stroke="black" d="M7631.02,-3646.6C7740.05,-3640.14 7890.05,-3631.1 8022,-3622.53 8137.84,-3615.02 8268.97,-3605.93 8366.71,-3599.04"/>
<polygon fill="black" stroke="black" points="8367.24,-3602.51 8376.96,-3598.31 8366.74,-3595.53 8367.24,-3602.51"/>
</g>
<!-- similar._iter_lots&#45;&gt;lot_io.read_lots -->
<g id="edge224" class="edge">
<title>similar._iter_lots&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M7631.24,-3661.77C7740.37,-3666.95 7890.41,-3675.6 8022,-3688.53 8151.39,-3701.25 8299.09,-3722.24 8398.62,-3737.34"/>
<polygon fill="black" stroke="black" points="8398.28,-3740.83 8408.7,-3738.87 8399.34,-3733.91 8398.28,-3740.83"/>
</g>
<!-- similar._iter_lots&#45;&gt;post_io.read_post -->
<g id="edge226" class="edge">
<title>similar._iter_lots&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7631.25,-3668.22C7773.11,-3676.21 7969.75,-3676.48 8022,-3622.53 8119.67,-3521.68 7966.76,-2466.23 8058,-2359.53 8100.5,-2309.83 8161.93,-2283.11 8225.99,-2269.79"/>
<polygon fill="black" stroke="black" points="8226.74,-2273.21 8235.87,-2267.84 8225.38,-2266.34 8226.74,-2273.21"/>
</g>
<!-- similar._iter_lots&#45;&gt;post_io.raw_post_path -->
<g id="edge227" class="edge">
<title>similar._iter_lots&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7631.16,-3666.82C7771.84,-3673.63 7966.63,-3672.93 8022,-3622.53 8098.84,-3552.59 8015.64,-3486.41 8058,-3391.53 8164.86,-3152.17 8402.26,-2930.84 8484.93,-2858.36"/>
<polygon fill="black" stroke="black" points="8487.43,-2860.83 8492.67,-2851.62 8482.83,-2855.55 8487.43,-2860.83"/>
</g>
<!-- similar._iter_lots&#45;&gt;lot_io.iter_lot_files -->
<g id="edge225" class="edge">
<title>similar._iter_lots&#45;&gt;lot_io.iter_lot_files</title>
<path fill="none" stroke="black" d="M7631.21,-3643.19C7772.77,-3635.5 7968.93,-3635.47 8022,-3688.53 8115.35,-3781.88 7964.68,-4188.15 8058,-4281.53 8158.51,-4382.12 8341.89,-4355.55 8442.77,-4330.6"/>
<polygon fill="black" stroke="black" points="8443.73,-4333.96 8452.56,-4328.11 8442.01,-4327.18 8443.73,-4333.96"/>
</g>
<!-- similar.main -->
<g id="node141" class="node">
<title>similar.main</title>
<g id="a_node141"><a xlink:title="Update ``data/similar`` using available embeddings.">
<polygon fill="none" stroke="black" points="6483.5,-4554.53 6262.5,-4554.53 6262.5,-4510.53 6483.5,-4510.53 6483.5,-4554.53"/>
<text text-anchor="middle" x="6373" y="-4524.21" font-family="Times,serif" font-size="32.90">similar.main</text>
</a>
</g>
</g>
<!-- similar.main&#45;&gt;similar_utils._load_embeddings -->
<g id="edge228" class="edge">
<title>similar.main&#45;&gt;similar_utils._load_embeddings</title>
<path fill="none" stroke="black" d="M6483.57,-4526.94C6596.08,-4521.27 6776.24,-4512.37 6932,-4505.53 7416.35,-4484.26 7537.97,-4490.27 8022,-4462.53 8080.1,-4459.2 8142.02,-4455.04 8201.64,-4450.71"/>
<polygon fill="black" stroke="black" points="8202.24,-4454.17 8211.96,-4449.96 8201.73,-4447.19 8202.24,-4454.17"/>
</g>
<!-- similar.main&#45;&gt;similar_utils._load_similar -->
<g id="edge229" class="edge">
<title>similar.main&#45;&gt;similar_utils._load_similar</title>
<path fill="none" stroke="black" d="M6427.82,-4554.65C6526.41,-4594.49 6743.22,-4679.08 6932,-4731.53 7060.29,-4767.18 7208.59,-4796.4 7317.91,-4815.74"/>
<polygon fill="black" stroke="black" points="7317.58,-4819.23 7328.04,-4817.52 7318.79,-4812.34 7317.58,-4819.23"/>
</g>
<!-- similar.main&#45;&gt;similar_utils._save_similar -->
<g id="edge230" class="edge">
<title>similar.main&#45;&gt;similar_utils._save_similar</title>
<path fill="none" stroke="black" d="M6410.16,-4510.44C6496.57,-4458.99 6723.38,-4331.74 6932,-4281.53 7059.6,-4250.83 7208.74,-4245.48 7318.56,-4247.02"/>
<polygon fill="black" stroke="black" points="7318.67,-4250.52 7328.73,-4247.18 7318.79,-4243.52 7318.67,-4250.52"/>
</g>
<!-- similar.main&#45;&gt;similar_utils._save_more_user -->
<g id="edge231" class="edge">
<title>similar.main&#45;&gt;similar_utils._save_more_user</title>
<path fill="none" stroke="black" d="M6425.09,-4510.44C6521.12,-4467.91 6733.49,-4369.03 6896,-4258.53 6913.46,-4246.66 6912.39,-4235.37 6932,-4227.53 7054.84,-4178.43 7205.89,-4174.93 7317.62,-4181.86"/>
<polygon fill="black" stroke="black" points="7317.43,-4185.36 7327.63,-4182.52 7317.88,-4178.37 7317.43,-4185.36"/>
</g>
<!-- similar.main&#45;&gt;similar_utils._prune_similar -->
<g id="edge232" class="edge">
<title>similar.main&#45;&gt;similar_utils._prune_similar</title>
<path fill="none" stroke="black" d="M6483.69,-4532.53C6682.61,-4532.53 7102.98,-4532.53 7327.43,-4532.53"/>
<polygon fill="black" stroke="black" points="7327.63,-4536.03 7337.63,-4532.53 7327.63,-4529.03 7327.63,-4536.03"/>
</g>
<!-- similar.main&#45;&gt;similar_utils._calc_similar_nn -->
<g id="edge233" class="edge">
<title>similar.main&#45;&gt;similar_utils._calc_similar_nn</title>
<path fill="none" stroke="black" d="M6483.58,-4547.06C6606.1,-4569.63 6799.93,-4625.6 6896,-4760.53 6955.21,-4843.7 6857.1,-5149.16 6932,-5218.53 6972.81,-5256.34 7595.83,-5247.48 8047.64,-5235.89"/>
<polygon fill="black" stroke="black" points="8048.04,-5239.39 8057.94,-5235.63 8047.86,-5232.39 8048.04,-5239.39"/>
</g>
<!-- similar.main&#45;&gt;similar_utils._sync_embeddings -->
<g id="edge234" class="edge">
<title>similar.main&#45;&gt;similar_utils._sync_embeddings</title>
<path fill="none" stroke="black" d="M6483.69,-4538.11C6656.11,-4546.87 6994.9,-4564.09 7228.27,-4575.94"/>
<polygon fill="black" stroke="black" points="7228.09,-4579.44 7238.26,-4576.45 7228.45,-4572.45 7228.09,-4579.44"/>
</g>
<!-- similar.main&#45;&gt;similar_utils._similar_by_user -->
<g id="edge235" class="edge">
<title>similar.main&#45;&gt;similar_utils._similar_by_user</title>
<path fill="none" stroke="black" d="M6483.68,-4546.98C6606.31,-4569.48 6800.23,-4625.38 6896,-4760.53 6958.61,-4848.9 6855.17,-5170.21 6932,-5246.53 7020.96,-5334.91 7932.68,-5318.31 8058,-5322.53 8375.7,-5333.24 8737.56,-5332.1 8997.51,-5328.95"/>
<polygon fill="black" stroke="black" points="8997.92,-5332.44 9007.88,-5328.82 8997.84,-5325.44 8997.92,-5332.44"/>
</g>
<!-- similar.main&#45;&gt;similar._iter_lots -->
<g id="edge236" class="edge">
<title>similar.main&#45;&gt;similar._iter_lots</title>
<path fill="none" stroke="black" d="M6477.21,-4510.47C6600.16,-4478.2 6800.85,-4405.28 6896,-4258.53 6965.05,-4152.04 6842.14,-3778.17 6932,-3688.53 6983.88,-3636.78 7172.17,-3635.57 7312.78,-3642.69"/>
<polygon fill="black" stroke="black" points="7312.65,-3646.19 7322.82,-3643.22 7313.01,-3639.2 7312.65,-3646.19"/>
</g>
<!-- log_utils._add_exc_line -->
<g id="node143" class="node">
<title>log_utils._add_exc_line</title>
<g id="a_node143"><a xlink:title="Attach ``line`` from traceback to structured log events.">
<polygon fill="none" stroke="black" points="6514.5,-3725.53 6231.5,-3725.53 6231.5,-3689.53 6514.5,-3689.53 6514.5,-3725.53"/>
<text text-anchor="middle" x="6373" y="-3701.94" font-family="Times,serif" font-size="23.24">log_utils._add_exc_line</text>
</a>
</g>
</g>
<!-- log_utils._add_exc_line&#45;&gt;log_utils._extract_tb_lineno -->
<g id="edge237" class="edge">
<title>log_utils._add_exc_line&#45;&gt;log_utils._extract_tb_lineno</title>
<path fill="none" stroke="black" d="M6482.75,-3689.53C6592.75,-3676.57 6764.81,-3671.01 6896,-3734.53 6917.83,-3745.1 6910.21,-3764.89 6932,-3775.53 7064.02,-3840.04 7236.08,-3838.05 7351.01,-3826.51"/>
<polygon fill="black" stroke="black" points="7351.67,-3829.96 7361.25,-3825.44 7350.94,-3823 7351.67,-3829.96"/>
</g>
<!-- log_utils.init_logger -->
<g id="node144" class="node">
<title>log_utils.init_logger</title>
<g id="a_node144"><a xlink:title="Initialize logger writing to ``LOGFILE``.&#10;&#10;``LOG_LEVEL`` may be set in ``config.py`` or via an environment&#10;variable. &#160;The level accepts ``DEBUG``, ``INFO`` or ``ERROR`` and&#10;defaults to ``INFO``. &#160;The function falls back to the standard&#10;``logging`` module if ``structlog`` isn&#39;t available so the scripts&#10;can still run in minimal environments.">
<polygon fill="none" stroke="black" points="6720.5,-3879.53 6025.5,-3879.53 6025.5,-3797.53 6720.5,-3797.53 6720.5,-3879.53"/>
<text text-anchor="middle" x="6373" y="-3821.55" font-family="Times,serif" font-size="67.48">log_utils.init_logger</text>
</a>
</g>
</g>
<!-- log_utils.init_logger&#45;&gt;log_utils._extract_tb_lineno -->
<g id="edge238" class="edge">
<title>log_utils.init_logger&#45;&gt;log_utils._extract_tb_lineno</title>
<path fill="none" stroke="black" d="M6720.79,-3828.78C6935.74,-3822.73 7199,-3815.33 7351.11,-3811.05"/>
<polygon fill="black" stroke="black" points="7351.52,-3814.54 7361.42,-3810.76 7351.32,-3807.54 7351.52,-3814.54"/>
</g>
<!-- log_utils.get_logger -->
<g id="node145" class="node">
<title>log_utils.get_logger</title>
<g id="a_node145"><a xlink:title="Return the singleton logger instance.">
<polygon fill="none" stroke="black" points="7545.5,-3879.53 7408.5,-3879.53 7408.5,-3843.53 7545.5,-3843.53 7545.5,-3879.53"/>
<text text-anchor="middle" x="7477" y="-3858.29" font-family="Times,serif" font-size="12.18">log_utils.get_logger</text>
</a>
</g>
</g>
<!-- log_utils.init_logger&#45;&gt;log_utils.get_logger -->
<g id="edge239" class="edge">
<title>log_utils.init_logger&#45;&gt;log_utils.get_logger</title>
<path fill="none" stroke="black" d="M6720.79,-3839.45C6960.09,-3843.39 7259.25,-3850.52 7398.29,-3856.24"/>
<polygon fill="black" stroke="black" points="7398.29,-3859.74 7408.42,-3856.67 7398.58,-3852.75 7398.29,-3859.74"/>
</g>
<!-- log_utils.get_logger&#45;&gt;log_utils.init_logger -->
<g id="edge240" class="edge">
<title>log_utils.get_logger&#45;&gt;log_utils.init_logger</title>
<path fill="none" stroke="black" d="M7408.42,-3863.58C7276.1,-3863.77 6974.47,-3858.44 6730.88,-3852.35"/>
<polygon fill="black" stroke="black" points="6730.87,-3848.84 6720.79,-3852.09 6730.7,-3855.84 6730.87,-3848.84"/>
</g>
<!-- lot_io.get_timestamp -->
<g id="node147" class="node">
<title>lot_io.get_timestamp</title>
<g id="a_node147"><a xlink:title="Return ``lot[&#39;timestamp&#39;]`` as a timezone&#45;aware ``datetime``.">
<polygon fill="none" stroke="black" points="8674,-5165.53 8356,-5165.53 8356,-5125.53 8674,-5125.53 8674,-5165.53"/>
<text text-anchor="middle" x="8515" y="-5138.46" font-family="Times,serif" font-size="28.84">lot_io.get_timestamp</text>
</a>
</g>
</g>
<!-- lot_io.write_lots -->
<g id="node148" class="node">
<title>lot_io.write_lots</title>
<g id="a_node148"><a xlink:title="Write lots to ``path`` using consistent JSON formatting.">
<polygon fill="none" stroke="black" points="7578.5,-5147.53 7375.5,-5147.53 7375.5,-5111.53 7578.5,-5111.53 7578.5,-5147.53"/>
<text text-anchor="middle" x="7477" y="-5123.94" font-family="Times,serif" font-size="23.24">lot_io.write_lots</text>
</a>
</g>
</g>
<!-- lot_io.write_lots&#45;&gt;lot_io.get_seller -->
<g id="edge246" class="edge">
<title>lot_io.write_lots&#45;&gt;lot_io.get_seller</title>
<path fill="none" stroke="black" d="M7578.67,-5121.37C7716.61,-5112.36 7954.94,-5105.2 8022,-5156.53 8063.18,-5188.06 8017,-5235.77 8058,-5267.53 8110.09,-5307.9 8286.66,-5307.66 8404.18,-5302.52"/>
<polygon fill="black" stroke="black" points="8404.47,-5306.01 8414.3,-5302.06 8404.15,-5299.02 8404.47,-5306.01"/>
</g>
<!-- lot_io.write_lots&#45;&gt;notes_utils.write_json -->
<g id="edge244" class="edge">
<title>lot_io.write_lots&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M7578.65,-5127.57C7705.04,-5119.1 7917.92,-5083.7 8022,-4945.53 8073.67,-4876.95 7998.67,-4235.61 8058,-4173.53 8154.22,-4072.86 8332.26,-4090.29 8435.1,-4111.34"/>
<polygon fill="black" stroke="black" points="8434.61,-4114.81 8445.12,-4113.45 8436.05,-4107.96 8434.61,-4114.81"/>
</g>
<!-- lot_io.write_lots&#45;&gt;lot_io._clean_lot -->
<g id="edge245" class="edge">
<title>lot_io.write_lots&#45;&gt;lot_io._clean_lot</title>
<path fill="none" stroke="black" d="M7578.57,-5127.33C7909.42,-5119.9 8944.49,-5094.98 8972,-5073.53 9186.71,-4906.14 9323.31,-3977.03 9347.23,-3802.72"/>
<polygon fill="black" stroke="black" points="9350.73,-3802.94 9348.61,-3792.56 9343.8,-3802 9350.73,-3802.94"/>
</g>
<!-- lot_io.write_lots&#45;&gt;lot_io.get_timestamp -->
<g id="edge247" class="edge">
<title>lot_io.write_lots&#45;&gt;lot_io.get_timestamp</title>
<path fill="none" stroke="black" d="M7578.75,-5131.09C7756.69,-5133.84 8128.3,-5139.58 8345.71,-5142.93"/>
<polygon fill="black" stroke="black" points="8345.89,-5146.44 8355.94,-5143.09 8346,-5139.44 8345.89,-5146.44"/>
</g>
<!-- lot_io.embedding_path -->
<g id="node151" class="node">
<title>lot_io.embedding_path</title>
<g id="a_node151"><a xlink:title="Return embedding file path for ``lot_path``.">
<polygon fill="none" stroke="black" points="6479.5,-2376.53 6266.5,-2376.53 6266.5,-2340.53 6479.5,-2340.53 6479.5,-2376.53"/>
<text text-anchor="middle" x="6373" y="-2354.37" font-family="Times,serif" font-size="17.08">lot_io.embedding_path</text>
</a>
</g>
</g>
<!-- lot_io.get_lot -->
<g id="node152" class="node">
<title>lot_io.get_lot</title>
<g id="a_node152"><a xlink:title="Return the lot identified by ``lot_id`` or ``None`` when missing.">
<polygon fill="none" stroke="black" points="7549.5,-3268.53 7404.5,-3268.53 7404.5,-3232.53 7549.5,-3232.53 7549.5,-3268.53"/>
<text text-anchor="middle" x="7477" y="-3245.74" font-family="Times,serif" font-size="19.74">lot_io.get_lot</text>
</a>
</g>
</g>
<!-- lot_io.get_lot&#45;&gt;lot_io.read_lots -->
<g id="edge249" class="edge">
<title>lot_io.get_lot&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M7549.6,-3243.15C7681.59,-3231.25 7955.85,-3215.02 8022,-3277.53 8076.9,-3329.42 8009.95,-3557.25 8058,-3615.53 8140.55,-3715.65 8292.89,-3745.66 8398.65,-3753.88"/>
<polygon fill="black" stroke="black" points="8398.51,-3757.37 8408.74,-3754.6 8399.02,-3750.39 8398.51,-3757.37"/>
</g>
<!-- lot_io.get_lot&#45;&gt;lot_io.parse_lot_id -->
<g id="edge250" class="edge">
<title>lot_io.get_lot&#45;&gt;lot_io.parse_lot_id</title>
<path fill="none" stroke="black" d="M7549.61,-3252.95C7682.62,-3255.76 7959.98,-3253.12 8022,-3185.53 8103.78,-3096.41 7974.68,-2185.21 8058,-2097.53 8128.21,-2023.66 8870.97,-2033.95 8972,-2020.53 9068.92,-2007.66 9178.74,-1986.99 9255.12,-1971.62"/>
<polygon fill="black" stroke="black" points="9256.09,-1975 9265.2,-1969.59 9254.7,-1968.14 9256.09,-1975"/>
</g>
<!-- post_io.raw_post_path_from_lot -->
<g id="node154" class="node">
<title>post_io.raw_post_path_from_lot</title>
<g id="a_node154"><a xlink:title="Return raw post path referenced by ``lot`` or ``None``.">
<polygon fill="none" stroke="black" points="7622,-2828.53 7332,-2828.53 7332,-2792.53 7622,-2792.53 7622,-2828.53"/>
<text text-anchor="middle" x="7477" y="-2806.37" font-family="Times,serif" font-size="17.08">post_io.raw_post_path_from_lot</text>
</a>
</g>
</g>
<!-- post_io.raw_post_path_from_lot&#45;&gt;post_io.raw_post_path -->
<g id="edge256" class="edge">
<title>post_io.raw_post_path_from_lot&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7622.05,-2813.73C7841.03,-2818.59 8250.91,-2827.69 8428.42,-2831.63"/>
<polygon fill="black" stroke="black" points="8428.41,-2835.13 8438.49,-2831.86 8428.57,-2828.14 8428.41,-2835.13"/>
</g>
<!-- embed.main -->
<g id="node155" class="node">
<title>embed.main</title>
<g id="a_node155"><a xlink:title="Embed the file given on the command line.">
<polygon fill="none" stroke="black" points="6461,-4047.53 6285,-4047.53 6285,-4011.53 6461,-4011.53 6461,-4047.53"/>
<text text-anchor="middle" x="6373" y="-4023.37" font-family="Times,serif" font-size="25.20">embed.main</text>
</a>
</g>
</g>
<!-- embed.main&#45;&gt;embed.embed_file -->
<g id="edge260" class="edge">
<title>embed.main&#45;&gt;embed.embed_file</title>
<path fill="none" stroke="black" d="M6461.39,-4028.98C6632.99,-4027.89 7018.41,-4025.44 7261.73,-4023.89"/>
<polygon fill="black" stroke="black" points="7261.79,-4027.39 7271.76,-4023.83 7261.74,-4020.39 7261.79,-4027.39"/>
</g>
<!-- cluster_items._iter_lots -->
<g id="node156" class="node">
<title>cluster_items._iter_lots</title>
<g id="a_node156"><a xlink:title="Return all lots with generated ids.">
<polygon fill="none" stroke="black" points="7645.5,-4328.53 7308.5,-4328.53 7308.5,-4290.53 7645.5,-4290.53 7645.5,-4328.53"/>
<text text-anchor="middle" x="7477" y="-4302.81" font-family="Times,serif" font-size="27.16">cluster_items._iter_lots</text>
</a>
</g>
</g>
<!-- cluster_items._iter_lots&#45;&gt;lot_io.read_lots -->
<g id="edge261" class="edge">
<title>cluster_items._iter_lots&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M7645.58,-4323.84C7785.3,-4331.76 7969.66,-4331.56 8022,-4281.53 8081.88,-4224.3 8006.57,-3975.46 8058,-3910.53 8139.48,-3807.67 8292.43,-3772.68 8398.6,-3760.99"/>
<polygon fill="black" stroke="black" points="8399.15,-3764.46 8408.73,-3759.93 8398.42,-3757.49 8399.15,-3764.46"/>
</g>
<!-- cluster_items._iter_lots&#45;&gt;lot_io.iter_lot_files -->
<g id="edge262" class="edge">
<title>cluster_items._iter_lots&#45;&gt;lot_io.iter_lot_files</title>
<path fill="none" stroke="black" d="M7645.6,-4309.53C7848.74,-4309.53 8187.23,-4309.53 8376.02,-4309.53"/>
<polygon fill="black" stroke="black" points="8376.29,-4313.03 8386.29,-4309.53 8376.29,-4306.03 8376.29,-4313.03"/>
</g>
<!-- cluster_items.collect_clusters -->
<g id="node157" class="node">
<title>cluster_items.collect_clusters</title>
<g id="a_node157"><a xlink:title="Return mapping of cluster name to lot ids.">
<polygon fill="none" stroke="black" points="6783.5,-4250.03 5962.5,-4250.03 5962.5,-4183.03 6783.5,-4183.03 6783.5,-4250.03"/>
<text text-anchor="middle" x="6373" y="-4203.03" font-family="Times,serif" font-size="53.76">cluster_items.collect_clusters</text>
</a>
</g>
</g>
<!-- cluster_items.collect_clusters&#45;&gt;similar_utils._load_embeddings -->
<g id="edge263" class="edge">
<title>cluster_items.collect_clusters&#45;&gt;similar_utils._load_embeddings</title>
<path fill="none" stroke="black" d="M6783.51,-4213.04C6823.6,-4224.54 6861.97,-4241.14 6896,-4264.53 6925.81,-4285.02 6901.62,-4317.9 6932,-4337.53 6982.89,-4370.42 7961.55,-4371.41 8022,-4375.53 8110.88,-4381.59 8208.55,-4390.95 8293.27,-4399.95"/>
<polygon fill="black" stroke="black" points="8292.95,-4403.43 8303.27,-4401.01 8293.7,-4396.47 8292.95,-4403.43"/>
</g>
<!-- cluster_items.collect_clusters&#45;&gt;similar_utils._cos_sim -->
<g id="edge264" class="edge">
<title>cluster_items.collect_clusters&#45;&gt;similar_utils._cos_sim</title>
<path fill="none" stroke="black" d="M6691.71,-4182.97C6769.69,-4159.32 6845.25,-4120.33 6896,-4056.53 6966.59,-3967.79 6850.98,-3626.87 6932,-3547.53 6987.46,-3493.22 7195.55,-3497.47 7337.67,-3507.5"/>
<polygon fill="black" stroke="black" points="7337.56,-3511 7347.79,-3508.23 7338.06,-3504.02 7337.56,-3511"/>
</g>
<!-- cluster_items.collect_clusters&#45;&gt;similar_utils._sync_embeddings -->
<g id="edge265" class="edge">
<title>cluster_items.collect_clusters&#45;&gt;similar_utils._sync_embeddings</title>
<path fill="none" stroke="black" d="M6466.99,-4250.19C6579.02,-4294.31 6768.1,-4380.57 6896,-4501.53 6918.04,-4522.38 6905.89,-4544.08 6932,-4559.53 6982.03,-4589.13 7109.43,-4596.99 7228.37,-4597.17"/>
<polygon fill="black" stroke="black" points="7228.38,-4600.67 7238.38,-4597.16 7228.38,-4593.67 7228.38,-4600.67"/>
</g>
<!-- cluster_items.collect_clusters&#45;&gt;cluster_items._iter_lots -->
<g id="edge266" class="edge">
<title>cluster_items.collect_clusters&#45;&gt;cluster_items._iter_lots</title>
<path fill="none" stroke="black" d="M6783.6,-4240.39C6821.92,-4246.75 6859.89,-4254.68 6896,-4264.53 6913.07,-4269.19 6914.84,-4277.22 6932,-4281.53 7051.61,-4311.61 7190.54,-4318.3 7298.06,-4317.64"/>
<polygon fill="black" stroke="black" points="7298.39,-4321.14 7308.36,-4317.55 7298.34,-4314.14 7298.39,-4321.14"/>
</g>
<!-- cluster_items.main -->
<g id="node158" class="node">
<title>cluster_items.main</title>
<g id="a_node158"><a xlink:title="Cluster items and save the result.">
<polygon fill="none" stroke="black" points="5606,-3906.53 5387,-3906.53 5387,-3870.53 5606,-3870.53 5606,-3906.53"/>
<text text-anchor="middle" x="5496.5" y="-3883.23" font-family="Times,serif" font-size="21.00">cluster_items.main</text>
</a>
</g>
</g>
<!-- cluster_items.main&#45;&gt;oom_utils.prefer_oom_kill -->
<g id="edge267" class="edge">
<title>cluster_items.main&#45;&gt;oom_utils.prefer_oom_kill</title>
<path fill="none" stroke="black" d="M5516.19,-3870.23C5573.85,-3812.33 5749.07,-3625.39 5814,-3430.53 5846.73,-3332.32 5778.12,-2574.03 5850,-2499.53 6011.84,-2331.79 6733.65,-2588.79 6896,-2421.53 6958.44,-2357.21 6869.53,-1679.82 6932,-1615.53 7101.26,-1441.36 7815.64,-1663.61 8022,-1535.53 8048.75,-1518.93 8031.17,-1491 8058,-1474.53 8164.7,-1409.03 8313.16,-1413.27 8411.33,-1426.16"/>
<polygon fill="black" stroke="black" points="8410.88,-1429.63 8421.26,-1427.52 8411.83,-1422.69 8410.88,-1429.63"/>
</g>
<!-- cluster_items.main&#45;&gt;notes_utils.write_json -->
<g id="edge268" class="edge">
<title>cluster_items.main&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M5587.49,-3870.5C5657.3,-3862.01 5752.26,-3863.21 5814,-3915.53 5863.34,-3957.35 5799.59,-4016.01 5850,-4056.53 5951.41,-4138.05 7931.83,-4134.21 8410.51,-4132.09"/>
<polygon fill="black" stroke="black" points="8410.87,-4135.59 8420.86,-4132.04 8410.84,-4128.59 8410.87,-4135.59"/>
</g>
<!-- cluster_items.main&#45;&gt;log_utils.install_excepthook -->
<g id="edge269" class="edge">
<title>cluster_items.main&#45;&gt;log_utils.install_excepthook</title>
<path fill="none" stroke="black" d="M5547.47,-3870.5C5615.07,-3847 5739.86,-3806.77 5850,-3788.53 5957,-3770.82 6077.87,-3763.76 6176.34,-3761.27"/>
<polygon fill="black" stroke="black" points="6176.49,-3764.77 6186.4,-3761.03 6176.32,-3757.77 6176.49,-3764.77"/>
</g>
<!-- cluster_items.main&#45;&gt;cluster_items.collect_clusters -->
<g id="edge270" class="edge">
<title>cluster_items.main&#45;&gt;cluster_items.collect_clusters</title>
<path fill="none" stroke="black" d="M5578.81,-3870.5C5650.05,-3859.87 5751.67,-3858.05 5814,-3915.53 5885.22,-3981.22 5781.4,-4062.11 5850,-4130.53 5879.3,-4159.76 5914.46,-4181.36 5952.5,-4197.11"/>
<polygon fill="black" stroke="black" points="5951.65,-4200.54 5962.23,-4201 5954.24,-4194.04 5951.65,-4200.54"/>
</g>
<!-- image_io.read_image_meta -->
<g id="node159" class="node">
<title>image_io.read_image_meta</title>
<g id="a_node159"><a xlink:title="Return metadata from ``path.with_suffix(&#39;.md&#39;)``.">
<polygon fill="none" stroke="black" points="7591.5,-2052.53 7362.5,-2052.53 7362.5,-2016.53 7591.5,-2016.53 7591.5,-2052.53"/>
<text text-anchor="middle" x="7477" y="-2030.49" font-family="Times,serif" font-size="15.68">image_io.read_image_meta</text>
</a>
</g>
</g>
<!-- image_io.read_image_meta&#45;&gt;notes_utils.parse_md -->
<g id="edge271" class="edge">
<title>image_io.read_image_meta&#45;&gt;notes_utils.parse_md</title>
<path fill="none" stroke="black" d="M7591.83,-2044.42C7798.42,-2062.37 8231.22,-2099.97 8421.22,-2116.47"/>
<polygon fill="black" stroke="black" points="8421.19,-2119.98 8431.45,-2117.36 8421.79,-2113.01 8421.19,-2119.98"/>
</g>
<!-- telegram_bot._t -->
<g id="node160" class="node">
<title>telegram_bot._t</title>
<g id="a_node160"><a xlink:title="Return ``text`` translated to ``lang`` using gettext files.">
<polygon fill="none" stroke="black" points="5600.5,-5999.53 5392.5,-5999.53 5392.5,-5963.53 5600.5,-5963.53 5600.5,-5999.53"/>
<text text-anchor="middle" x="5496.5" y="-5975.66" font-family="Times,serif" font-size="24.22">telegram_bot._t</text>
</a>
</g>
</g>
<!-- telegram_bot.ensure_profile -->
<g id="node161" class="node">
<title>telegram_bot.ensure_profile</title>
<g id="a_node161"><a xlink:title="Return profile for ``uid`` creating one if needed.">
<polygon fill="none" stroke="black" points="5647.5,-6053.53 5345.5,-6053.53 5345.5,-6017.53 5647.5,-6017.53 5647.5,-6053.53"/>
<text text-anchor="middle" x="5496.5" y="-6030.74" font-family="Times,serif" font-size="19.74">telegram_bot.ensure_profile</text>
</a>
</g>
</g>
<!-- telegram_bot.save_profiles -->
<g id="node162" class="node">
<title>telegram_bot.save_profiles</title>
<g id="a_node162"><a xlink:title="Write ``profiles`` to disk.">
<polygon fill="none" stroke="black" points="6477,-5961.53 6269,-5961.53 6269,-5925.53 6477,-5925.53 6477,-5961.53"/>
<text text-anchor="middle" x="6373" y="-5939.83" font-family="Times,serif" font-size="14.00">telegram_bot.save_profiles</text>
</a>
</g>
</g>
<!-- telegram_bot.ensure_profile&#45;&gt;telegram_bot.save_profiles -->
<g id="edge273" class="edge">
<title>telegram_bot.ensure_profile&#45;&gt;telegram_bot.save_profiles</title>
<path fill="none" stroke="black" d="M5647.72,-6023.67C5700.34,-6019.27 5759.82,-6014 5814,-6008.53 5968.24,-5992.97 6146.07,-5971.68 6258.73,-5957.77"/>
<polygon fill="black" stroke="black" points="6259.25,-5961.23 6268.75,-5956.53 6258.39,-5954.28 6259.25,-5961.23"/>
</g>
<!-- telegram_bot.load_profiles -->
<g id="node163" class="node">
<title>telegram_bot.load_profiles</title>
<g id="a_node163"><a xlink:title="Populate the global ``profiles`` mapping.">
<polygon fill="none" stroke="black" points="5647.5,-400.53 5345.5,-400.53 5345.5,-364.53 5647.5,-364.53 5647.5,-400.53"/>
<text text-anchor="middle" x="5496.5" y="-377.23" font-family="Times,serif" font-size="21.00">telegram_bot.load_profiles</text>
</a>
</g>
</g>
<!-- telegram_bot.load_profiles&#45;&gt;notes_utils.read_text -->
<g id="edge274" class="edge">
<title>telegram_bot.load_profiles&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M5532.84,-364.36C5595.02,-333.43 5728.9,-271.48 5850,-246.53 6204.16,-173.57 7114.4,-184.53 7476,-184.53 7476,-184.53 7476,-184.53 8516,-184.53 8647.47,-184.53 9599.84,-181.88 9696,-271.53 9855.44,-420.18 9979.5,-2095.03 9996.51,-2334.98"/>
<polygon fill="black" stroke="black" points="9993.04,-2335.58 9997.24,-2345.31 10000.02,-2335.09 9993.04,-2335.58"/>
</g>
<!-- telegram_bot.load_state -->
<g id="node164" class="node">
<title>telegram_bot.load_state</title>
<g id="a_node164"><a xlink:title="Populate ``processed_ids`` from ``STATE_PATH``.">
<polygon fill="none" stroke="black" points="9495.5,-2358.53 9208.5,-2358.53 9208.5,-2322.53 9495.5,-2322.53 9495.5,-2358.53"/>
<text text-anchor="middle" x="9352" y="-2334.84" font-family="Times,serif" font-size="22.12">telegram_bot.load_state</text>
</a>
</g>
</g>
<!-- telegram_bot.load_state&#45;&gt;notes_utils.read_text -->
<g id="edge275" class="edge">
<title>telegram_bot.load_state&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M9495.86,-2345.62C9611.96,-2349.76 9773.71,-2355.52 9882.06,-2359.38"/>
<polygon fill="black" stroke="black" points="9882.25,-2362.89 9892.37,-2359.75 9882.5,-2355.9 9882.25,-2362.89"/>
</g>
<!-- telegram_bot.save_state -->
<g id="node165" class="node">
<title>telegram_bot.save_state</title>
<polygon fill="none" stroke="black" points="6457,-3133.53 6289,-3133.53 6289,-3097.53 6457,-3097.53 6457,-3133.53"/>
<text text-anchor="middle" x="6373" y="-3112.29" font-family="Times,serif" font-size="12.18">telegram_bot.save_state</text>
</g>
<!-- telegram_bot.scan_embeddings -->
<g id="node166" class="node">
<title>telegram_bot.scan_embeddings</title>
<g id="a_node166"><a xlink:title="Load new embeddings and return list of new lot ids.">
<polygon fill="none" stroke="black" points="7623,-4420.53 7331,-4420.53 7331,-4384.53 7623,-4384.53 7623,-4420.53"/>
<text text-anchor="middle" x="7477" y="-4398.37" font-family="Times,serif" font-size="17.08">telegram_bot.scan_embeddings</text>
</a>
</g>
</g>
<!-- telegram_bot.scan_embeddings&#45;&gt;similar_utils._load_embeddings -->
<g id="edge276" class="edge">
<title>telegram_bot.scan_embeddings&#45;&gt;similar_utils._load_embeddings</title>
<path fill="none" stroke="black" d="M7623.14,-4405.76C7772.43,-4409.07 8009.61,-4414.34 8201.72,-4418.6"/>
<polygon fill="black" stroke="black" points="8201.91,-4422.11 8211.99,-4418.83 8202.07,-4415.11 8201.91,-4422.11"/>
</g>
<!-- telegram_bot._should_suggest -->
<g id="node167" class="node">
<title>telegram_bot._should_suggest</title>
<polygon fill="none" stroke="black" points="6534.5,-3566.53 6211.5,-3566.53 6211.5,-3530.53 6534.5,-3530.53 6534.5,-3566.53"/>
<text text-anchor="middle" x="6373" y="-3543.74" font-family="Times,serif" font-size="19.74">telegram_bot._should_suggest</text>
</g>
<!-- telegram_bot._should_suggest&#45;&gt;similar_utils._cos_sim -->
<g id="edge277" class="edge">
<title>telegram_bot._should_suggest&#45;&gt;similar_utils._cos_sim</title>
<path fill="none" stroke="black" d="M6534.54,-3544.45C6751.09,-3538.95 7133.16,-3529.24 7337.66,-3524.05"/>
<polygon fill="black" stroke="black" points="7337.95,-3527.54 7347.86,-3523.79 7337.77,-3520.54 7337.95,-3527.54"/>
</g>
<!-- telegram_bot.enqueue_new_ids -->
<g id="node168" class="node">
<title>telegram_bot.enqueue_new_ids</title>
<polygon fill="none" stroke="black" points="5735,-4088.53 5258,-4088.53 5258,-4048.53 5735,-4048.53 5735,-4088.53"/>
<text text-anchor="middle" x="5496.5" y="-4061.46" font-family="Times,serif" font-size="28.84">telegram_bot.enqueue_new_ids</text>
</g>
<!-- telegram_bot.enqueue_new_ids&#45;&gt;telegram_bot.save_profiles -->
<g id="edge278" class="edge">
<title>telegram_bot.enqueue_new_ids&#45;&gt;telegram_bot.save_profiles</title>
<path fill="none" stroke="black" d="M5519.21,-4088.57C5579.87,-4146.21 5750.89,-4320.2 5814,-4505.53 5857.61,-4633.59 5773.62,-5610.88 5850,-5722.53 5942.51,-5857.77 6135.48,-5910.58 6259.11,-5930.97"/>
<polygon fill="black" stroke="black" points="6258.57,-5934.43 6269,-5932.56 6259.68,-5927.52 6258.57,-5934.43"/>
</g>
<!-- telegram_bot.enqueue_new_ids&#45;&gt;telegram_bot._should_suggest -->
<g id="edge279" class="edge">
<title>telegram_bot.enqueue_new_ids&#45;&gt;telegram_bot._should_suggest</title>
<path fill="none" stroke="black" d="M5589.7,-4088.55C5660.99,-4098.13 5756.87,-4097.11 5814,-4039.53 5881.54,-3971.46 5783.32,-3678.44 5850,-3609.53 5961.44,-3494.38 6165.66,-3508.52 6282.91,-3528.75"/>
<polygon fill="black" stroke="black" points="6282.48,-3532.22 6292.94,-3530.53 6283.7,-3525.33 6282.48,-3532.22"/>
</g>
<!-- telegram_bot._send_queue -->
<g id="node169" class="node">
<title>telegram_bot._send_queue</title>
<g id="a_node169"><a xlink:title="Send next lot from each user queue via ``app``.">
<polygon fill="none" stroke="black" points="5772,-3976.53 5221,-3976.53 5221,-3924.53 5772,-3924.53 5772,-3976.53"/>
<text text-anchor="middle" x="5496.5" y="-3940.84" font-family="Times,serif" font-size="39.62">telegram_bot._send_queue</text>
</a>
</g>
</g>
<!-- telegram_bot._send_queue&#45;&gt;lot_io.get_lot -->
<g id="edge280" class="edge">
<title>telegram_bot._send_queue&#45;&gt;lot_io.get_lot</title>
<path fill="none" stroke="black" d="M5772.33,-3946.42C5787.67,-3938.47 5801.78,-3928.33 5814,-3915.53 5899.83,-3825.69 5762.55,-3445.81 5850,-3357.53 5959.38,-3247.12 7079.13,-3247.42 7394.02,-3249.72"/>
<polygon fill="black" stroke="black" points="7394.41,-3253.22 7404.44,-3249.8 7394.46,-3246.22 7394.41,-3253.22"/>
</g>
<!-- telegram_bot._send_queue&#45;&gt;telegram_bot.save_profiles -->
<g id="edge281" class="edge">
<title>telegram_bot._send_queue&#45;&gt;telegram_bot.save_profiles</title>
<path fill="none" stroke="black" d="M5772.27,-3953.66C5787.73,-3961.82 5801.88,-3972.27 5814,-3985.53 5879.13,-4056.77 5795.86,-5642.63 5850,-5722.53 5941.91,-5858.18 6135.06,-5910.86 6258.89,-5931.12"/>
<polygon fill="black" stroke="black" points="6258.37,-5934.58 6268.79,-5932.7 6259.47,-5927.67 6258.37,-5934.58"/>
</g>
<!-- telegram_bot.send_alert -->
<g id="node170" class="node">
<title>telegram_bot.send_alert</title>
<g id="a_node170"><a xlink:title="Broadcast ``text`` to all registered users.">
<polygon fill="none" stroke="black" points="5063.5,-400.53 4733.5,-400.53 4733.5,-364.53 5063.5,-364.53 5063.5,-400.53"/>
<text text-anchor="middle" x="4898.5" y="-376.37" font-family="Times,serif" font-size="25.20">telegram_bot.send_alert</text>
</a>
</g>
</g>
<!-- telegram_bot.send_alert&#45;&gt;telegram_bot.load_profiles -->
<g id="edge282" class="edge">
<title>telegram_bot.send_alert&#45;&gt;telegram_bot.load_profiles</title>
<path fill="none" stroke="black" d="M5063.54,-382.53C5148.23,-382.53 5251.14,-382.53 5335.27,-382.53"/>
<polygon fill="black" stroke="black" points="5335.43,-386.03 5345.43,-382.53 5335.43,-379.03 5335.43,-386.03"/>
</g>
<!-- telegram_bot.start_cmd -->
<g id="node171" class="node">
<title>telegram_bot.start_cmd</title>
<g id="a_node171"><a xlink:title="Register the user and confirm startup.">
<polygon fill="none" stroke="black" points="5010.5,-6026.53 4786.5,-6026.53 4786.5,-5990.53 5010.5,-5990.53 5010.5,-6026.53"/>
<text text-anchor="middle" x="4898.5" y="-6004.37" font-family="Times,serif" font-size="17.08">telegram_bot.start_cmd</text>
</a>
</g>
</g>
<!-- telegram_bot.start_cmd&#45;&gt;telegram_bot._t -->
<g id="edge283" class="edge">
<title>telegram_bot.start_cmd&#45;&gt;telegram_bot._t</title>
<path fill="none" stroke="black" d="M5010.55,-6003.5C5116.59,-5998.7 5275.59,-5991.5 5382.32,-5986.66"/>
<polygon fill="black" stroke="black" points="5382.66,-5990.15 5392.49,-5986.2 5382.34,-5983.16 5382.66,-5990.15"/>
</g>
<!-- telegram_bot.start_cmd&#45;&gt;telegram_bot.ensure_profile -->
<g id="edge284" class="edge">
<title>telegram_bot.start_cmd&#45;&gt;telegram_bot.ensure_profile</title>
<path fill="none" stroke="black" d="M5010.55,-6013.56C5101.9,-6017.7 5232.55,-6023.62 5335.23,-6028.27"/>
<polygon fill="black" stroke="black" points="5335.24,-6031.78 5345.39,-6028.73 5335.56,-6024.78 5335.24,-6031.78"/>
</g>
<!-- telegram_bot.lang_cmd -->
<g id="node172" class="node">
<title>telegram_bot.lang_cmd</title>
<g id="a_node172"><a xlink:title="Set preferred language or list available choices.">
<polygon fill="none" stroke="black" points="5073,-6084.03 4724,-6084.03 4724,-6045.03 5073,-6045.03 5073,-6084.03"/>
<text text-anchor="middle" x="4898.5" y="-6057.63" font-family="Times,serif" font-size="28.00">telegram_bot.lang_cmd</text>
</a>
</g>
</g>
<!-- telegram_bot.lang_cmd&#45;&gt;telegram_bot._t -->
<g id="edge285" class="edge">
<title>telegram_bot.lang_cmd&#45;&gt;telegram_bot._t</title>
<path fill="none" stroke="black" d="M5073.27,-6055.2C5097.2,-6050.66 5121.07,-6044.32 5143,-6035.53 5161.57,-6028.1 5160.31,-6015.66 5179,-6008.53 5243.31,-5984.01 5320.14,-5976.98 5381.99,-5976.22"/>
<polygon fill="black" stroke="black" points="5382.2,-5979.72 5392.18,-5976.15 5382.15,-5972.72 5382.2,-5979.72"/>
</g>
<!-- telegram_bot.lang_cmd&#45;&gt;telegram_bot.ensure_profile -->
<g id="edge286" class="edge">
<title>telegram_bot.lang_cmd&#45;&gt;telegram_bot.ensure_profile</title>
<path fill="none" stroke="black" d="M5073.09,-6056.09C5155.81,-6052.06 5254.11,-6047.28 5335.06,-6043.34"/>
<polygon fill="black" stroke="black" points="5335.53,-6046.82 5345.35,-6042.84 5335.19,-6039.83 5335.53,-6046.82"/>
</g>
<!-- telegram_bot.lang_cmd&#45;&gt;telegram_bot.save_profiles -->
<g id="edge287" class="edge">
<title>telegram_bot.lang_cmd&#45;&gt;telegram_bot.save_profiles</title>
<path fill="none" stroke="black" d="M5073.27,-6074.85C5257.66,-6083.3 5557.26,-6089.89 5814,-6062.53 5990.28,-6043.75 6192.82,-5993.07 6298.73,-5964.27"/>
<polygon fill="black" stroke="black" points="6299.95,-5967.56 6308.68,-5961.55 6298.11,-5960.81 6299.95,-5967.56"/>
</g>
<!-- telegram_bot.vote_callback -->
<g id="node173" class="node">
<title>telegram_bot.vote_callback</title>
<g id="a_node173"><a xlink:title="Handle inline button presses for lot feedback.">
<polygon fill="none" stroke="black" points="5113.5,-5972.03 4683.5,-5972.03 4683.5,-5931.03 5113.5,-5931.03 5113.5,-5972.03"/>
<text text-anchor="middle" x="4898.5" y="-5944.29" font-family="Times,serif" font-size="29.68">telegram_bot.vote_callback</text>
</a>
</g>
</g>
<!-- telegram_bot.vote_callback&#45;&gt;telegram_bot._t -->
<g id="edge288" class="edge">
<title>telegram_bot.vote_callback&#45;&gt;telegram_bot._t</title>
<path fill="none" stroke="black" d="M5113.83,-5962.32C5204.53,-5966.89 5306.49,-5972.02 5382.2,-5975.83"/>
<polygon fill="black" stroke="black" points="5382.07,-5979.33 5392.23,-5976.34 5382.42,-5972.34 5382.07,-5979.33"/>
</g>
<!-- telegram_bot.vote_callback&#45;&gt;telegram_bot.ensure_profile -->
<g id="edge289" class="edge">
<title>telegram_bot.vote_callback&#45;&gt;telegram_bot.ensure_profile</title>
<path fill="none" stroke="black" d="M5113.62,-5971.38C5123.67,-5974.35 5133.52,-5977.71 5143,-5981.53 5161.55,-5989.01 5160.31,-6001.41 5179,-6008.53 5227.79,-6027.14 5283.79,-6035.67 5334.99,-6039.04"/>
<polygon fill="black" stroke="black" points="5334.97,-6042.55 5345.16,-6039.65 5335.38,-6035.56 5334.97,-6042.55"/>
</g>
<!-- telegram_bot.vote_callback&#45;&gt;telegram_bot.save_profiles -->
<g id="edge290" class="edge">
<title>telegram_bot.vote_callback&#45;&gt;telegram_bot.save_profiles</title>
<path fill="none" stroke="black" d="M5113.61,-5950.37C5430.51,-5948.65 6013.31,-5945.48 6258.53,-5944.15"/>
<polygon fill="black" stroke="black" points="6258.91,-5947.65 6268.89,-5944.09 6258.87,-5940.65 6258.91,-5947.65"/>
</g>
<!-- telegram_bot.main -->
<g id="node174" class="node">
<title>telegram_bot.main</title>
<g id="a_node174"><a xlink:title="Run the Telegram recommendation bot.">
<polygon fill="none" stroke="black" points="5064,-3202.53 4733,-3202.53 4733,-3158.53 5064,-3158.53 5064,-3202.53"/>
<text text-anchor="middle" x="4898.5" y="-3172.21" font-family="Times,serif" font-size="32.90">telegram_bot.main</text>
</a>
</g>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot.load_profiles -->
<g id="edge291" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot.load_profiles</title>
<path fill="none" stroke="black" d="M5064.07,-3191.05C5094.17,-3184.98 5122.5,-3172.51 5143,-3149.53 5244.37,-3035.96 5075.3,-520.98 5179,-409.53 5237.39,-346.78 5341.56,-350.28 5414.39,-362.71"/>
<polygon fill="black" stroke="black" points="5413.99,-366.19 5424.45,-364.52 5415.22,-359.3 5413.99,-366.19"/>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot.load_state -->
<g id="edge292" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot.load_state</title>
<path fill="none" stroke="black" d="M5064.29,-3190.2C5094.09,-3184.11 5122.25,-3171.85 5143,-3149.53 5243.64,-3041.33 5083.84,-2598.59 5179,-2485.53 5376.04,-2251.45 5545.97,-2365.97 5850,-2331.53 6184.89,-2293.6 8567.59,-2328.15 9198.19,-2338.06"/>
<polygon fill="black" stroke="black" points="9198.2,-2341.56 9208.26,-2338.22 9198.31,-2334.57 9198.2,-2341.56"/>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot.save_state -->
<g id="edge293" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot.save_state</title>
<path fill="none" stroke="black" d="M5064.09,-3160.01C5101.79,-3155.94 5141.74,-3152.13 5179,-3149.53 5587.88,-3121.08 6077.17,-3116.3 6278.48,-3115.59"/>
<polygon fill="black" stroke="black" points="6278.73,-3119.09 6288.72,-3115.56 6278.71,-3112.09 6278.73,-3119.09"/>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot.scan_embeddings -->
<g id="edge294" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot.scan_embeddings</title>
<path fill="none" stroke="black" d="M4946.24,-3202.61C5004.15,-3232.79 5100.36,-3292.89 5143,-3376.53 5179.43,-3447.99 5127.78,-4035.8 5179,-4097.53 5451.44,-4425.89 6849.47,-4419.5 7320.71,-4407.66"/>
<polygon fill="black" stroke="black" points="7321.08,-4411.16 7330.98,-4407.4 7320.9,-4404.16 7321.08,-4411.16"/>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot.enqueue_new_ids -->
<g id="edge295" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot.enqueue_new_ids</title>
<path fill="none" stroke="black" d="M4946.19,-3202.64C5004.03,-3232.85 5100.18,-3292.99 5143,-3376.53 5176.65,-3442.19 5127.81,-3986.41 5179,-4039.53 5233.46,-4096.06 5325.13,-4098.72 5395.83,-4089.92"/>
<polygon fill="black" stroke="black" points="5396.66,-4093.34 5406.1,-4088.55 5395.73,-4086.41 5396.66,-4093.34"/>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot._send_queue -->
<g id="edge296" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot._send_queue</title>
<path fill="none" stroke="black" d="M4946.02,-3202.72C5003.69,-3233.02 5099.66,-3293.25 5143,-3376.53 5198.42,-3483.02 5095.98,-3828.83 5179,-3915.53 5188.84,-3925.82 5199.91,-3934.38 5211.85,-3941.48"/>
<polygon fill="black" stroke="black" points="5210.26,-3944.6 5220.7,-3946.39 5213.65,-3938.47 5210.26,-3944.6"/>
</g>
<!-- caption_io._get_langs&#45;&gt;config_utils.load_config -->
<g id="edge297" class="edge">
<title>caption_io._get_langs&#45;&gt;config_utils.load_config</title>
<path fill="none" stroke="black" d="M9435.94,-3395.48C9512.27,-3384.01 9624.2,-3380.91 9696,-3440.53 9872.35,-3586.98 9973.98,-4357.51 9994.58,-4528.78"/>
<polygon fill="black" stroke="black" points="9991.11,-4529.23 9995.77,-4538.74 9998.06,-4528.4 9991.11,-4529.23"/>
</g>
<!-- pending_embed._needs_embedding -->
<g id="node176" class="node">
<title>pending_embed._needs_embedding</title>
<g id="a_node176"><a xlink:title="Return ``True`` when ``emb`` is missing or stale.&#10;&#10;The function also upgrades older vector files stored as a single object and&#10;removes corrupted or mismatched ones so ``embed.py`` always operates on&#10;clean data.">
<polygon fill="none" stroke="black" points="7886,-3344.03 7068,-3344.03 7068,-3287.03 7886,-3287.03 7886,-3344.03"/>
<text text-anchor="middle" x="7477" y="-3304.19" font-family="Times,serif" font-size="44.80">pending_embed._needs_embedding</text>
</a>
</g>
</g>
<!-- pending_embed._needs_embedding&#45;&gt;notes_utils.load_json -->
<g id="edge309" class="edge">
<title>pending_embed._needs_embedding&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M7886.34,-3305.13C8297.69,-3298.16 8883.94,-3299.2 8972,-3358.53 9005.01,-3380.78 8975.56,-3417.48 9008,-3440.53 9073.8,-3487.3 9165.72,-3492.21 9237.84,-3486.43"/>
<polygon fill="black" stroke="black" points="9238.22,-3489.91 9247.88,-3485.54 9237.61,-3482.94 9238.22,-3489.91"/>
</g>
<!-- pending_embed._needs_embedding&#45;&gt;notes_utils.write_json -->
<g id="edge310" class="edge">
<title>pending_embed._needs_embedding&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M7886,-3338.79C7937.98,-3358.34 7985.63,-3387.31 8022,-3429.53 8112.08,-3534.09 7966.44,-3946.27 8058,-4049.53 8144.72,-4147.34 8305.1,-4154.01 8410.67,-4145.84"/>
<polygon fill="black" stroke="black" points="8411.03,-4149.33 8420.71,-4145.01 8410.45,-4142.35 8411.03,-4149.33"/>
</g>
<!-- pending_embed.main -->
<g id="node177" class="node">
<title>pending_embed.main</title>
<polygon fill="none" stroke="black" points="5763,-2769.53 5230,-2769.53 5230,-2709.53 5763,-2709.53 5763,-2769.53"/>
<text text-anchor="middle" x="5496.5" y="-2727.57" font-family="Times,serif" font-size="47.46">pending_embed.main</text>
</g>
<!-- pending_embed.main&#45;&gt;moderation.message_skip_reason -->
<g id="edge311" class="edge">
<title>pending_embed.main&#45;&gt;moderation.message_skip_reason</title>
<path fill="none" stroke="black" d="M5588.88,-2709.51C5664.05,-2679.46 5765.77,-2625.2 5814,-2539.53 5868,-2443.61 5783.17,-646 5850,-558.53 6154.14,-160.44 6437.5,-322.81 6932,-242.53 7827.59,-97.14 8066.37,-220.83 8972,-165.53 9011.5,-163.12 9053.28,-160.09 9094.11,-156.85"/>
<polygon fill="black" stroke="black" points="9094.49,-160.33 9104.18,-156.04 9093.94,-153.35 9094.49,-160.33"/>
</g>
<!-- pending_embed.main&#45;&gt;moderation.lot_skip_reason -->
<g id="edge312" class="edge">
<title>pending_embed.main&#45;&gt;moderation.lot_skip_reason</title>
<path fill="none" stroke="black" d="M5532.38,-2769.63C5601.78,-2832.06 5755.52,-2983.75 5814,-3149.53 5845.89,-3239.93 5783.49,-4805.51 5850,-4874.53 5970.45,-4999.53 8847.51,-5123.51 8972,-5002.53 9022.02,-4953.92 8968.63,-3805.11 9008,-3747.53 9055.32,-3678.33 9142.71,-3642.03 9217.44,-3623.06"/>
<polygon fill="black" stroke="black" points="9218.55,-3626.39 9227.42,-3620.6 9216.88,-3619.59 9218.55,-3626.39"/>
</g>
<!-- pending_embed.main&#45;&gt;oom_utils.prefer_oom_kill -->
<g id="edge313" class="edge">
<title>pending_embed.main&#45;&gt;oom_utils.prefer_oom_kill</title>
<path fill="none" stroke="black" d="M5586.38,-2709.51C5661.03,-2679.2 5763.39,-2624.57 5814,-2539.53 5875.62,-2435.99 5783.25,-2098.84 5850,-1998.53 6147.75,-1551.1 6409.39,-1583.97 6932,-1458.53 7065.61,-1426.47 7956.9,-1436.59 8339.76,-1442.54"/>
<polygon fill="black" stroke="black" points="8339.77,-1446.04 8349.83,-1442.69 8339.88,-1439.04 8339.77,-1446.04"/>
</g>
<!-- pending_embed.main&#45;&gt;lot_io.read_lots -->
<g id="edge314" class="edge">
<title>pending_embed.main&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M5531.99,-2769.77C5600.69,-2832.46 5753.22,-2984.58 5814,-3149.53 5842.42,-3226.67 5790.47,-3831.84 5850,-3888.53 5893.69,-3930.14 7964.42,-3906.56 8022,-3888.53 8040.59,-3882.71 8040.21,-3871.47 8058,-3863.53 8168.32,-3814.3 8304.09,-3785.84 8398.66,-3770.63"/>
<polygon fill="black" stroke="black" points="8399.21,-3774.08 8408.54,-3769.06 8398.12,-3767.17 8399.21,-3774.08"/>
</g>
<!-- pending_embed.main&#45;&gt;post_io.read_post -->
<g id="edge317" class="edge">
<title>pending_embed.main&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M5554.99,-2709.52C5620.97,-2673.69 5730.78,-2609.74 5814,-2539.53 5832.28,-2524.11 5828.71,-2510.44 5850,-2499.53 6266.24,-2286.38 6444.49,-2507.29 6896,-2385.53 6912.91,-2380.98 6914.99,-2373.68 6932,-2369.53 7053.73,-2339.86 7803.11,-2304.32 8225.36,-2286.28"/>
<polygon fill="black" stroke="black" points="8225.74,-2289.77 8235.58,-2285.85 8225.44,-2282.78 8225.74,-2289.77"/>
</g>
<!-- pending_embed.main&#45;&gt;lot_io.iter_lot_files -->
<g id="edge316" class="edge">
<title>pending_embed.main&#45;&gt;lot_io.iter_lot_files</title>
<path fill="none" stroke="black" d="M5532.31,-2769.65C5601.6,-2832.13 5755.14,-2983.88 5814,-3149.53 5840.31,-3223.58 5798.12,-4504.51 5850,-4563.53 6010.65,-4746.29 6689.4,-4712.81 6932,-4731.53 6992.38,-4736.19 7976.98,-4772.04 8022,-4731.53 8078.48,-4680.72 8006.26,-4447.17 8058,-4391.53 8137.52,-4306.03 8273.49,-4291.13 8376.31,-4294.26"/>
<polygon fill="black" stroke="black" points="8376.35,-4297.76 8386.47,-4294.63 8376.6,-4290.76 8376.35,-4297.76"/>
</g>
<!-- pending_embed.main&#45;&gt;lot_io.embedding_path -->
<g id="edge315" class="edge">
<title>pending_embed.main&#45;&gt;lot_io.embedding_path</title>
<path fill="none" stroke="black" d="M5577.95,-2709.39C5650.64,-2678 5755,-2621.8 5814,-2539.53 5853.7,-2484.17 5797.78,-2434.29 5850,-2390.53 5909.3,-2340.84 6121.01,-2343.13 6255.91,-2350.21"/>
<polygon fill="black" stroke="black" points="6256.12,-2353.73 6266.29,-2350.78 6256.5,-2346.74 6256.12,-2353.73"/>
</g>
<!-- pending_embed.main&#45;&gt;post_io.raw_post_path_from_lot -->
<g id="edge318" class="edge">
<title>pending_embed.main&#45;&gt;post_io.raw_post_path_from_lot</title>
<path fill="none" stroke="black" d="M5763.05,-2749.06C6182.4,-2764.11 6984.87,-2792.91 7321.43,-2804.99"/>
<polygon fill="black" stroke="black" points="7321.62,-2808.5 7331.74,-2805.36 7321.87,-2801.5 7321.62,-2808.5"/>
</g>
<!-- pending_embed.main&#45;&gt;pending_embed._needs_embedding -->
<g id="edge319" class="edge">
<title>pending_embed.main&#45;&gt;pending_embed._needs_embedding</title>
<path fill="none" stroke="black" d="M5658.28,-2769.59C6007.34,-2836.24 6810.19,-2997.75 6896,-3088.53 6954.74,-3150.68 6868.06,-3220.75 6932,-3277.53 6954.96,-3297.92 7001.2,-3310.41 7057.45,-3317.71"/>
<polygon fill="black" stroke="black" points="7057.33,-3321.22 7067.69,-3318.97 7058.19,-3314.27 7057.33,-3321.22"/>
</g>
<!-- pending_caption._get_message_path -->
<g id="node178" class="node">
<title>pending_caption._get_message_path</title>
<g id="a_node178"><a xlink:title="Return path of stored message ``msg_id`` in ``chat`` if any.">
<polygon fill="none" stroke="black" points="8665.5,-1712.53 8364.5,-1712.53 8364.5,-1676.53 8665.5,-1676.53 8665.5,-1712.53"/>
<text text-anchor="middle" x="8515" y="-1690.49" font-family="Times,serif" font-size="15.68">pending_caption._get_message_path</text>
</a>
</g>
</g>
<!-- pending_caption.main -->
<g id="node179" class="node">
<title>pending_caption.main</title>
<polygon fill="none" stroke="black" points="6609.5,-2061.03 6136.5,-2061.03 6136.5,-2008.03 6609.5,-2008.03 6609.5,-2061.03"/>
<text text-anchor="middle" x="6373" y="-2024.33" font-family="Times,serif" font-size="40.88">pending_caption.main</text>
</g>
<!-- pending_caption.main&#45;&gt;moderation.should_skip_message -->
<g id="edge320" class="edge">
<title>pending_caption.main&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M6397.57,-2007.86C6468.72,-1929.55 6691.25,-1700.54 6932,-1615.53 7186.35,-1525.73 7980.81,-1541.31 8337.52,-1553.46"/>
<polygon fill="black" stroke="black" points="8337.57,-1556.96 8347.69,-1553.81 8337.81,-1549.97 8337.57,-1556.96"/>
</g>
<!-- pending_caption.main&#45;&gt;oom_utils.prefer_oom_kill -->
<g id="edge321" class="edge">
<title>pending_caption.main&#45;&gt;oom_utils.prefer_oom_kill</title>
<path fill="none" stroke="black" d="M6391.37,-2007.75C6452.27,-1916.64 6666.76,-1618.1 6932,-1506.53 6964.06,-1493.05 7935.2,-1462.73 8339.76,-1450.65"/>
<polygon fill="black" stroke="black" points="8339.9,-1454.14 8349.8,-1450.35 8339.7,-1447.15 8339.9,-1454.14"/>
</g>
<!-- pending_caption.main&#45;&gt;post_io.read_post -->
<g id="edge322" class="edge">
<title>pending_caption.main&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M6609.57,-2046.07C7058.24,-2068.46 7993.58,-2117.4 8022,-2137.53 8055.48,-2161.25 8025.14,-2197.97 8058,-2222.53 8106.29,-2258.63 8165.87,-2277.93 8225.84,-2287.21"/>
<polygon fill="black" stroke="black" points="8225.46,-2290.69 8235.86,-2288.67 8226.47,-2283.76 8225.46,-2290.69"/>
</g>
<!-- pending_caption.main&#45;&gt;caption_io.has_caption -->
<g id="edge324" class="edge">
<title>pending_caption.main&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M6410.88,-2007.77C6510.65,-1932.95 6785.69,-1709.91 6896,-1449.53 6938.85,-1348.39 6851.67,-1031.45 6932,-956.53 6986.94,-905.3 8103.72,-938 8427.02,-948.58"/>
<polygon fill="black" stroke="black" points="8427.16,-952.08 8437.27,-948.91 8427.39,-945.09 8427.16,-952.08"/>
</g>
<!-- pending_caption.main&#45;&gt;image_io.read_image_meta -->
<g id="edge323" class="edge">
<title>pending_caption.main&#45;&gt;image_io.read_image_meta</title>
<path fill="none" stroke="black" d="M6609.73,-2034.53C6837.32,-2034.53 7173.05,-2034.53 7352.39,-2034.53"/>
<polygon fill="black" stroke="black" points="7352.39,-2038.03 7362.39,-2034.53 7352.39,-2031.03 7352.39,-2038.03"/>
</g>
<!-- pending_caption.main&#45;&gt;pending_caption._get_message_path -->
<g id="edge325" class="edge">
<title>pending_caption.main&#45;&gt;pending_caption._get_message_path</title>
<path fill="none" stroke="black" d="M6479.51,-2061.04C6597.37,-2083.72 6785.98,-2098.14 6896,-1993.53 6986.29,-1907.68 6838.97,-1798.4 6932,-1715.53 6984.43,-1668.83 7962.6,-1683.34 8354.05,-1691.07"/>
<polygon fill="black" stroke="black" points="8354.26,-1694.58 8364.32,-1691.28 8354.39,-1687.58 8354.26,-1694.58"/>
</g>
<!-- check_translations.parse_po -->
<g id="node180" class="node">
<title>check_translations.parse_po</title>
<polygon fill="none" stroke="black" points="9644,-690.53 9060,-690.53 9060,-638.53 9644,-638.53 9644,-690.53"/>
<text text-anchor="middle" x="9352" y="-654.84" font-family="Times,serif" font-size="39.62">check_translations.parse_po</text>
</g>
<!-- check_translations.check_translations -->
<g id="node181" class="node">
<title>check_translations.check_translations</title>
<polygon fill="none" stroke="black" points="8847.5,-687.03 8182.5,-687.03 8182.5,-642.03 8847.5,-642.03 8847.5,-687.03"/>
<text text-anchor="middle" x="8515" y="-656.15" font-family="Times,serif" font-size="33.60">check_translations.check_translations</text>
</g>
<!-- check_translations.check_translations&#45;&gt;check_translations.parse_po -->
<g id="edge326" class="edge">
<title>check_translations.check_translations&#45;&gt;check_translations.parse_po</title>
<path fill="none" stroke="black" d="M8847.51,-664.53C8914.3,-664.53 8984.15,-664.53 9049.83,-664.53"/>
<polygon fill="black" stroke="black" points="9049.91,-668.03 9059.91,-664.53 9049.91,-661.03 9049.91,-668.03"/>
</g>
<!-- pending_chop.main -->
<g id="node182" class="node">
<title>pending_chop.main</title>
<polygon fill="none" stroke="black" points="7644.5,-1360.03 7309.5,-1360.03 7309.5,-1317.03 7644.5,-1317.03 7644.5,-1360.03"/>
<text text-anchor="middle" x="7477" y="-1330.39" font-family="Times,serif" font-size="32.06">pending_chop.main</text>
</g>
<!-- pending_chop.main&#45;&gt;moderation.should_skip_message -->
<g id="edge327" class="edge">
<title>pending_chop.main&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M7644.5,-1326.84C7783.24,-1320.83 7966.77,-1322.77 8022,-1369.53 8077.3,-1416.35 8003.01,-1481.35 8058,-1528.53 8099.36,-1564.02 8227.58,-1570.64 8337.56,-1569.15"/>
<polygon fill="black" stroke="black" points="8337.86,-1572.65 8347.81,-1568.99 8337.75,-1565.65 8337.86,-1572.65"/>
</g>
<!-- pending_chop.main&#45;&gt;oom_utils.prefer_oom_kill -->
<g id="edge328" class="edge">
<title>pending_chop.main&#45;&gt;oom_utils.prefer_oom_kill</title>
<path fill="none" stroke="black" d="M7644.7,-1343.87C7752.53,-1348.35 7895.82,-1356.22 8022,-1369.53 8154.75,-1383.54 8306.4,-1408.31 8405.83,-1425.75"/>
<polygon fill="black" stroke="black" points="8405.43,-1429.24 8415.88,-1427.52 8406.64,-1422.34 8405.43,-1429.24"/>
</g>
<!-- pending_chop.main&#45;&gt;post_io.read_post -->
<g id="edge329" class="edge">
<title>pending_chop.main&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7644.6,-1324.63C7785,-1316.97 7970.96,-1317.73 8022,-1369.53 8088.58,-1437.1 7993.36,-2153.11 8058,-2222.53 8101.49,-2269.24 8162.39,-2291.81 8225.57,-2300.78"/>
<polygon fill="black" stroke="black" points="8225.36,-2304.28 8235.72,-2302.1 8226.26,-2297.34 8225.36,-2304.28"/>
</g>
<!-- build_site:cli -->
<g id="node184" class="node">
<title>build_site:cli</title>
<g id="a_node184"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="1913.5" cy="-46.53" rx="34.71" ry="18"/>
<text text-anchor="middle" x="1913.5" y="-44.93" font-family="Times,serif" font-size="7.00">build_site:cli</text>
</a>
</g>
</g>
<!-- clean_data:cli&#45;&gt;build_site:cli -->
<!-- chop:cli -->
<g id="node185" class="node">
<title>chop:cli</title>
<g id="a_node185"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="2558.5" cy="-46.53" rx="27" ry="18"/>
<text text-anchor="middle" x="2558.5" y="-44.93" font-family="Times,serif" font-size="7.00">chop:cli</text>
</a>
</g>
</g>
<!-- build_site:cli&#45;&gt;chop:cli -->
<!-- tg_client:cli -->
<g id="node186" class="node">
<title>tg_client:cli</title>
<g id="a_node186"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="3163.5" cy="-46.53" rx="32.86" ry="18"/>
<text text-anchor="middle" x="3163.5" y="-44.93" font-family="Times,serif" font-size="7.00">tg_client:cli</text>
</a>
</g>
</g>
<!-- chop:cli&#45;&gt;tg_client:cli -->
<!-- debug_dump:cli -->
<g id="node187" class="node">
<title>debug_dump:cli</title>
<g id="a_node187"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="4010" cy="-46.53" rx="41.11" ry="18"/>
<text text-anchor="middle" x="4010" y="-44.93" font-family="Times,serif" font-size="7.00">debug_dump:cli</text>
</a>
</g>
</g>
<!-- tg_client:cli&#45;&gt;debug_dump:cli -->
<!-- scan_ontology:cli -->
<g id="node188" class="node">
<title>scan_ontology:cli</title>
<g id="a_node188"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="141" cy="-5446.53" rx="44.19" ry="18"/>
<text text-anchor="middle" x="141" y="-5444.93" font-family="Times,serif" font-size="7.00">scan_ontology:cli</text>
</a>
</g>
</g>
<!-- caption:cli -->
<g id="node189" class="node">
<title>caption:cli</title>
<g id="a_node189"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="602" cy="-5446.53" rx="30.28" ry="18"/>
<text text-anchor="middle" x="602" y="-5444.93" font-family="Times,serif" font-size="7.00">caption:cli</text>
</a>
</g>
</g>
<!-- scan_ontology:cli&#45;&gt;caption:cli -->
<!-- price_train:cli -->
<g id="node190" class="node">
<title>price_train:cli</title>
<g id="a_node190"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="1278.5" cy="-5446.53" rx="36.68" ry="18"/>
<text text-anchor="middle" x="1278.5" y="-5444.93" font-family="Times,serif" font-size="7.00">price_train:cli</text>
</a>
</g>
</g>
<!-- caption:cli&#45;&gt;price_train:cli -->
<!-- similar:cli -->
<g id="node191" class="node">
<title>similar:cli</title>
<g id="a_node191"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="1913.5" cy="-5446.53" rx="29.05" ry="18"/>
<text text-anchor="middle" x="1913.5" y="-5444.93" font-family="Times,serif" font-size="7.00">similar:cli</text>
</a>
</g>
</g>
<!-- price_train:cli&#45;&gt;similar:cli -->
<!-- embed:cli -->
<g id="node192" class="node">
<title>embed:cli</title>
<g id="a_node192"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="2558.5" cy="-5446.53" rx="29.05" ry="18"/>
<text text-anchor="middle" x="2558.5" y="-5444.93" font-family="Times,serif" font-size="7.00">embed:cli</text>
</a>
</g>
</g>
<!-- similar:cli&#45;&gt;embed:cli -->
<!-- cluster_items:cli -->
<g id="node193" class="node">
<title>cluster_items:cli</title>
<g id="a_node193"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="3163.5" cy="-5446.53" rx="42.34" ry="18"/>
<text text-anchor="middle" x="3163.5" y="-5444.93" font-family="Times,serif" font-size="7.00">cluster_items:cli</text>
</a>
</g>
</g>
<!-- embed:cli&#45;&gt;cluster_items:cli -->
<!-- telegram_bot:cli -->
<g id="node194" class="node">
<title>telegram_bot:cli</title>
<g id="a_node194"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="4010" cy="-5446.53" rx="111.95" ry="19.18"/>
<text text-anchor="middle" x="4010" y="-5442.37" font-family="Times,serif" font-size="17.08">telegram_bot:cli</text>
</a>
</g>
</g>
<!-- cluster_items:cli&#45;&gt;telegram_bot:cli -->
<!-- pending_embed:cli -->
<g id="node195" class="node">
<title>pending_embed:cli</title>
<g id="a_node195"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="141" cy="-5500.53" rx="47.39" ry="18"/>
<text text-anchor="middle" x="141" y="-5498.93" font-family="Times,serif" font-size="7.00">pending_embed:cli</text>
</a>
</g>
</g>
<!-- pending_caption:cli -->
<g id="node196" class="node">
<title>pending_caption:cli</title>
<g id="a_node196"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="602" cy="-5500.53" rx="48.62" ry="18"/>
<text text-anchor="middle" x="602" y="-5498.93" font-family="Times,serif" font-size="7.00">pending_caption:cli</text>
</a>
</g>
</g>
<!-- pending_embed:cli&#45;&gt;pending_caption:cli -->
<!-- check_translations:cli -->
<g id="node197" class="node">
<title>check_translations:cli</title>
<g id="a_node197"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="1278.5" cy="-5500.53" rx="73.67" ry="18"/>
<text text-anchor="middle" x="1278.5" y="-5498.08" font-family="Times,serif" font-size="9.94">check_translations:cli</text>
</a>
</g>
</g>
<!-- pending_caption:cli&#45;&gt;check_translations:cli -->
<!-- pending_chop:cli -->
<g id="node198" class="node">
<title>pending_chop:cli</title>
<g id="a_node198"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="1913.5" cy="-5500.53" rx="42.96" ry="18"/>
<text text-anchor="middle" x="1913.5" y="-5498.93" font-family="Times,serif" font-size="7.00">pending_chop:cli</text>
</a>
</g>
</g>
<!-- check_translations:cli&#45;&gt;pending_chop:cli -->
<!-- build_site -->
<g id="node199" class="node">
<title>build_site</title>
<ellipse fill="none" stroke="black" cx="4010" cy="-5391.53" rx="55.79" ry="18"/>
<text text-anchor="middle" x="4010" y="-5387.83" font-family="Times,serif" font-size="14.00">build_site</text>
</g>
<!-- build_site&#45;&gt;build_site.main -->
<g id="edge344" class="edge">
<title>build_site:cli&#45;&gt;build_site.main</title>
<path fill="none" stroke="black" d="M4066.12,-5391.53C4185.9,-5391.53 4475.52,-5391.53 4679.09,-5391.53"/>
<polygon fill="black" stroke="black" points="4679.32,-5395.03 4689.32,-5391.53 4679.32,-5388.03 4679.32,-5395.03"/>
</g>
<!-- caption -->
<g id="node200" class="node">
<title>caption</title>
<ellipse fill="none" stroke="black" cx="4898.5" cy="-3403.53" rx="44.69" ry="18"/>
<text text-anchor="middle" x="4898.5" y="-3399.83" font-family="Times,serif" font-size="14.00">caption</text>
</g>
<!-- caption&#45;&gt;caption.main -->
<g id="edge345" class="edge">
<title>caption:cli&#45;&gt;caption.main</title>
<path fill="none" stroke="black" d="M4943.81,-3403.53C5038.4,-3403.53 5262.15,-3403.53 5393.81,-3403.53"/>
<polygon fill="black" stroke="black" points="5393.91,-3407.03 5403.91,-3403.53 5393.91,-3400.03 5393.91,-3407.03"/>
</g>
<!-- check_translations -->
<g id="node201" class="node">
<title>check_translations</title>
<ellipse fill="none" stroke="black" cx="7477" cy="-664.53" rx="96.68" ry="18"/>
<text text-anchor="middle" x="7477" y="-660.83" font-family="Times,serif" font-size="14.00">check_translations</text>
</g>
<!-- check_translations&#45;&gt;oom_utils.prefer_oom_kill -->
<g id="edge346" class="edge">
<title>check_translations:cli&#45;&gt;oom_utils.prefer_oom_kill</title>
<path fill="none" stroke="black" d="M7563.76,-656.51C7700.65,-645.77 7959.5,-634.61 8022,-696.53 8105.7,-779.47 7991.99,-1127.93 8058,-1225.53 8136.79,-1342.04 8295.22,-1398.85 8402.97,-1425.07"/>
<polygon fill="black" stroke="black" points="8402.37,-1428.53 8412.9,-1427.44 8403.99,-1421.72 8402.37,-1428.53"/>
</g>
<!-- check_translations&#45;&gt;check_translations.check_translations -->
<g id="edge347" class="edge">
<title>check_translations:cli&#45;&gt;check_translations.check_translations</title>
<path fill="none" stroke="black" d="M7574.07,-664.53C7709.24,-664.53 7962.48,-664.53 8172.07,-664.53"/>
<polygon fill="black" stroke="black" points="8172.33,-668.03 8182.33,-664.53 8172.33,-661.03 8172.33,-668.03"/>
</g>
<!-- chop -->
<g id="node202" class="node">
<title>chop</title>
<ellipse fill="none" stroke="black" cx="4898.5" cy="-436.53" rx="32.49" ry="18"/>
<text text-anchor="middle" x="4898.5" y="-432.83" font-family="Times,serif" font-size="14.00">chop</text>
</g>
<!-- chop&#45;&gt;chop.main -->
<g id="edge348" class="edge">
<title>chop:cli&#45;&gt;chop.main</title>
<path fill="none" stroke="black" d="M4931.12,-436.53C5020.31,-436.53 5276.07,-436.53 5410.54,-436.53"/>
<polygon fill="black" stroke="black" points="5410.8,-440.03 5420.8,-436.53 5410.8,-433.03 5410.8,-440.03"/>
</g>
<!-- clean_data -->
<g id="node203" class="node">
<title>clean_data</title>
<ellipse fill="none" stroke="black" cx="5496.5" cy="-2512.53" rx="59.59" ry="18"/>
<text text-anchor="middle" x="5496.5" y="-2508.83" font-family="Times,serif" font-size="14.00">clean_data</text>
</g>
<!-- clean_data&#45;&gt;clean_data.main -->
<g id="edge349" class="edge">
<title>clean_data:cli&#45;&gt;clean_data.main</title>
<path fill="none" stroke="black" d="M5555.31,-2515.87C5619.02,-2520.12 5724.37,-2528.88 5814,-2544.53 5830.25,-2547.37 5833.69,-2551.1 5850,-2553.53 5993.24,-2574.94 6160.77,-2580.15 6266.63,-2581.04"/>
<polygon fill="black" stroke="black" points="6266.65,-2584.54 6276.67,-2581.11 6266.7,-2577.54 6266.65,-2584.54"/>
</g>
<!-- cluster_items -->
<g id="node204" class="node">
<title>cluster_items</title>
<ellipse fill="none" stroke="black" cx="4898.5" cy="-3888.53" rx="73.39" ry="18"/>
<text text-anchor="middle" x="4898.5" y="-3884.83" font-family="Times,serif" font-size="14.00">cluster_items</text>
</g>
<!-- cluster_items&#45;&gt;cluster_items.main -->
<g id="edge350" class="edge">
<title>cluster_items:cli&#45;&gt;cluster_items.main</title>
<path fill="none" stroke="black" d="M4971.99,-3888.53C5072.69,-3888.53 5256.15,-3888.53 5376.94,-3888.53"/>
<polygon fill="black" stroke="black" points="5376.97,-3892.03 5386.97,-3888.53 5376.97,-3885.03 5376.97,-3892.03"/>
</g>
<!-- debug_dump -->
<g id="node205" class="node">
<title>debug_dump</title>
<ellipse fill="none" stroke="black" cx="5496.5" cy="-1004.53" rx="70.39" ry="18"/>
<text text-anchor="middle" x="5496.5" y="-1000.83" font-family="Times,serif" font-size="14.00">debug_dump</text>
</g>
<!-- debug_dump&#45;&gt;debug_dump.main -->
<g id="edge351" class="edge">
<title>debug_dump:cli&#45;&gt;debug_dump.main</title>
<path fill="none" stroke="black" d="M5566.85,-1004.53C5685.52,-1004.53 5933.04,-1004.53 6122.5,-1004.53"/>
<polygon fill="black" stroke="black" points="6122.62,-1008.03 6132.62,-1004.53 6122.62,-1001.03 6122.62,-1008.03"/>
</g>
<!-- embed -->
<g id="node206" class="node">
<title>embed</title>
<ellipse fill="none" stroke="black" cx="5496.5" cy="-4012.53" rx="42.49" ry="18"/>
<text text-anchor="middle" x="5496.5" y="-4008.83" font-family="Times,serif" font-size="14.00">embed</text>
</g>
<!-- embed&#45;&gt;embed.main -->
<g id="edge352" class="edge">
<title>embed:cli&#45;&gt;embed.main</title>
<path fill="none" stroke="black" d="M5538.8,-4013.34C5670.69,-4015.9 6084.27,-4023.94 6274.5,-4027.64"/>
<polygon fill="black" stroke="black" points="6274.71,-4031.14 6284.77,-4027.84 6274.84,-4024.14 6274.71,-4031.14"/>
</g>
<!-- moderation -->
<g id="node207" class="node">
<title>moderation</title>
<ellipse fill="none" stroke="black" cx="6373" cy="-2526.53" rx="63.89" ry="18"/>
<text text-anchor="middle" x="6373" y="-2522.83" font-family="Times,serif" font-size="14.00">moderation</text>
</g>
<!-- moderation&#45;&gt;moderation.apply_to_history -->
<g id="edge353" class="edge">
<title>moderation:cli&#45;&gt;moderation.apply_to_history</title>
<path fill="none" stroke="black" d="M6436.18,-2529.49C6557.23,-2534.15 6819.36,-2538.62 6896,-2494.53 6921,-2480.15 6907.06,-2455.02 6932,-2440.53 7047.72,-2373.31 7201.51,-2368.74 7316.05,-2378.13"/>
<polygon fill="black" stroke="black" points="7316.04,-2381.64 7326.31,-2379.01 7316.65,-2374.67 7316.04,-2381.64"/>
</g>
<!-- pending_caption -->
<g id="node208" class="node">
<title>pending_caption</title>
<ellipse fill="none" stroke="black" cx="5496.5" cy="-2034.53" rx="87.18" ry="18"/>
<text text-anchor="middle" x="5496.5" y="-2030.83" font-family="Times,serif" font-size="14.00">pending_caption</text>
</g>
<!-- pending_caption&#45;&gt;pending_caption.main -->
<g id="edge354" class="edge">
<title>pending_caption:cli&#45;&gt;pending_caption.main</title>
<path fill="none" stroke="black" d="M5583.74,-2034.53C5708.61,-2034.53 5944.62,-2034.53 6125.98,-2034.53"/>
<polygon fill="black" stroke="black" points="6126.21,-2038.03 6136.21,-2034.53 6126.21,-2031.03 6126.21,-2038.03"/>
</g>
<!-- pending_chop -->
<g id="node209" class="node">
<title>pending_chop</title>
<ellipse fill="none" stroke="black" cx="6373" cy="-1334.53" rx="74.99" ry="18"/>
<text text-anchor="middle" x="6373" y="-1330.83" font-family="Times,serif" font-size="14.00">pending_chop</text>
</g>
<!-- pending_chop&#45;&gt;pending_chop.main -->
<g id="edge355" class="edge">
<title>pending_chop:cli&#45;&gt;pending_chop.main</title>
<path fill="none" stroke="black" d="M6448.02,-1334.8C6620.68,-1335.43 7054.03,-1337 7299.4,-1337.89"/>
<polygon fill="black" stroke="black" points="7299.48,-1341.39 7309.5,-1337.93 7299.51,-1334.39 7299.48,-1341.39"/>
</g>
<!-- pending_embed -->
<g id="node210" class="node">
<title>pending_embed</title>
<ellipse fill="none" stroke="black" cx="4898.5" cy="-2718.53" rx="83.69" ry="18"/>
<text text-anchor="middle" x="4898.5" y="-2714.83" font-family="Times,serif" font-size="14.00">pending_embed</text>
</g>
<!-- pending_embed&#45;&gt;pending_embed.main -->
<g id="edge356" class="edge">
<title>pending_embed:cli&#45;&gt;pending_embed.main</title>
<path fill="none" stroke="black" d="M4981.43,-2721.42C5043.65,-2723.61 5133.03,-2726.76 5219.87,-2729.82"/>
<polygon fill="black" stroke="black" points="5219.78,-2733.32 5229.9,-2730.18 5220.02,-2726.33 5219.78,-2733.32"/>
</g>
<!-- price_train -->
<g id="node211" class="node">
<title>price_train</title>
<ellipse fill="none" stroke="black" cx="5496.5" cy="-4787.53" rx="61.19" ry="18"/>
<text text-anchor="middle" x="5496.5" y="-4783.83" font-family="Times,serif" font-size="14.00">price_train</text>
</g>
<!-- price_train&#45;&gt;price_train.main -->
<g id="edge357" class="edge">
<title>price_train:cli&#45;&gt;price_train.main</title>
<path fill="none" stroke="black" d="M5557.61,-4787.53C5699.39,-4787.53 6057.08,-4787.53 6247.78,-4787.53"/>
<polygon fill="black" stroke="black" points="6247.86,-4791.03 6257.86,-4787.53 6247.86,-4784.03 6247.86,-4791.03"/>
</g>
<!-- scan_ontology -->
<g id="node212" class="node">
<title>scan_ontology</title>
<ellipse fill="none" stroke="black" cx="4898.5" cy="-3122.53" rx="76.09" ry="18"/>
<text text-anchor="middle" x="4898.5" y="-3118.83" font-family="Times,serif" font-size="14.00">scan_ontology</text>
</g>
<!-- scan_ontology&#45;&gt;scan_ontology.main -->
<g id="edge358" class="edge">
<title>scan_ontology:cli&#45;&gt;scan_ontology.main</title>
<path fill="none" stroke="black" d="M4967.87,-3129.99C5038.44,-3137.69 5152.61,-3150.14 5256.72,-3161.49"/>
<polygon fill="black" stroke="black" points="5256.44,-3164.98 5266.77,-3162.59 5257.2,-3158.02 5256.44,-3164.98"/>
</g>
<!-- similar -->
<g id="node213" class="node">
<title>similar</title>
<ellipse fill="none" stroke="black" cx="5496.5" cy="-4532.53" rx="42.79" ry="18"/>
<text text-anchor="middle" x="5496.5" y="-4528.83" font-family="Times,serif" font-size="14.00">similar</text>
</g>
<!-- similar&#45;&gt;similar.main -->
<g id="edge359" class="edge">
<title>similar:cli&#45;&gt;similar.main</title>
<path fill="none" stroke="black" d="M5539.68,-4532.53C5667.53,-4532.53 6054.09,-4532.53 6252.17,-4532.53"/>
<polygon fill="black" stroke="black" points="6252.33,-4536.03 6262.33,-4532.53 6252.33,-4529.03 6252.33,-4536.03"/>
</g>
<!-- telegram_bot -->
<g id="node214" class="node">
<title>telegram_bot</title>
<ellipse fill="none" stroke="black" cx="4010" cy="-2415.53" rx="72.29" ry="18"/>
<text text-anchor="middle" x="4010" y="-2411.83" font-family="Times,serif" font-size="14.00">telegram_bot</text>
</g>
<!-- telegram_bot&#45;&gt;telegram_bot.send_alert -->
<g id="edge360" class="edge">
<title>telegram_bot:cli&#45;&gt;telegram_bot.send_alert</title>
<path fill="none" stroke="black" d="M4067.7,-2426.54C4190.14,-2446.62 4479.39,-2473.53 4618,-2312.53 4686.99,-2232.4 4582.73,-487.65 4654,-409.53 4672.45,-389.32 4697.01,-377.56 4723.44,-371.28"/>
<polygon fill="black" stroke="black" points="4724.19,-374.7 4733.25,-369.21 4722.74,-367.85 4724.19,-374.7"/>
</g>
<!-- telegram_bot&#45;&gt;telegram_bot.main -->
<g id="edge361" class="edge">
<title>telegram_bot:cli&#45;&gt;telegram_bot.main</title>
<path fill="none" stroke="black" d="M4020.16,-2433.44C4069.37,-2527.62 4313.01,-2968.09 4654,-3149.53 4675.24,-3160.84 4698.96,-3168.66 4723.03,-3174"/>
<polygon fill="black" stroke="black" points="4722.5,-3177.46 4733,-3176.06 4723.92,-3170.6 4722.5,-3177.46"/>
</g>
<!-- tg_client -->
<g id="node215" class="node">
<title>tg_client</title>
<ellipse fill="none" stroke="black" cx="141" cy="-2674.53" rx="50.89" ry="18"/>
<text text-anchor="middle" x="141" y="-2670.83" font-family="Times,serif" font-size="14.00">tg_client</text>
</g>
<!-- tg_client&#45;&gt;tg_client.main -->
<g id="edge362" class="edge">
<title>tg_client:cli&#45;&gt;tg_client.main</title>
<path fill="none" stroke="black" d="M191.99,-2674.53C222.07,-2674.53 263.09,-2674.53 307.59,-2674.53"/>
<polygon fill="black" stroke="black" points="307.75,-2678.03 317.75,-2674.53 307.75,-2671.03 307.75,-2678.03"/>
</g>
</g>
</svg>
