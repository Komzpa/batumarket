<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: callgraph Pages: 1 -->
<svg width="9907pt" height="5039pt"
 viewBox="0.00 0.00 9907.00 5039.39" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 5035.39)">
<title>callgraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-5035.39 9903,-5035.39 9903,4 -4,4"/>
<!-- moderation.should_skip_text -->
<g id="node1" class="node">
<title>moderation.should_skip_text</title>
<g id="a_node1"><a xlink:title="Return ``True`` if ``text`` contains banned phrases.">
<polygon fill="none" stroke="black" points="9826.5,-1799.2 9538.5,-1799.2 9538.5,-1763.2 9826.5,-1763.2 9826.5,-1799.2"/>
<text text-anchor="middle" x="9682.5" y="-1776.42" font-family="Times,serif" font-size="18.48">moderation.should_skip_text</text>
</a>
</g>
</g>
<!-- moderation.should_skip_user -->
<g id="node2" class="node">
<title>moderation.should_skip_user</title>
<g id="a_node2"><a xlink:title="Return ``True`` if ``username`` is blacklisted.">
<polygon fill="none" stroke="black" points="9806.5,-4436.2 9558.5,-4436.2 9558.5,-4400.2 9806.5,-4400.2 9806.5,-4436.2"/>
<text text-anchor="middle" x="9682.5" y="-4414.16" font-family="Times,serif" font-size="15.68">moderation.should_skip_user</text>
</a>
</g>
</g>
<!-- moderation.message_skip_reason -->
<g id="node3" class="node">
<title>moderation.message_skip_reason</title>
<g id="a_node3"><a xlink:title="Return the moderation reason for ``meta`` and ``text`` or ``None``.">
<polygon fill="none" stroke="black" points="9430,-1803.7 8840,-1803.7 8840,-1758.7 9430,-1758.7 9430,-1803.7"/>
<text text-anchor="middle" x="9135" y="-1772.82" font-family="Times,serif" font-size="33.60">moderation.message_skip_reason</text>
</a>
</g>
</g>
<!-- moderation.message_skip_reason&#45;&gt;moderation.should_skip_text -->
<g id="edge1" class="edge">
<title>moderation.message_skip_reason&#45;&gt;moderation.should_skip_text</title>
<path fill="none" stroke="black" d="M9430.3,-1781.2C9463.99,-1781.2 9497.23,-1781.2 9527.96,-1781.2"/>
<polygon fill="black" stroke="black" points="9528.28,-1784.7 9538.28,-1781.2 9528.28,-1777.7 9528.28,-1784.7"/>
</g>
<!-- moderation.message_skip_reason&#45;&gt;moderation.should_skip_user -->
<g id="edge2" class="edge">
<title>moderation.message_skip_reason&#45;&gt;moderation.should_skip_user</title>
<path fill="none" stroke="black" d="M9160.47,-1803.96C9220.36,-1861.5 9373.52,-2020.29 9430,-2189.2 9490.61,-2370.49 9426.02,-3722.28 9466,-3909.2 9507.67,-4104.03 9623.49,-4317.64 9665.78,-4391.41"/>
<polygon fill="black" stroke="black" points="9662.77,-4393.19 9670.8,-4400.1 9668.83,-4389.69 9662.77,-4393.19"/>
</g>
<!-- moderation.should_skip_message -->
<g id="node4" class="node">
<title>moderation.should_skip_message</title>
<g id="a_node4"><a xlink:title="Return ``True`` when the raw Telegram message should be ignored.">
<polygon fill="none" stroke="black" points="8426,-1799.2 8092,-1799.2 8092,-1763.2 8426,-1763.2 8426,-1799.2"/>
<text text-anchor="middle" x="8259" y="-1776.42" font-family="Times,serif" font-size="18.48">moderation.should_skip_message</text>
</a>
</g>
</g>
<!-- moderation.should_skip_message&#45;&gt;moderation.message_skip_reason -->
<g id="edge3" class="edge">
<title>moderation.should_skip_message&#45;&gt;moderation.message_skip_reason</title>
<path fill="none" stroke="black" d="M8426.19,-1781.2C8539.96,-1781.2 8694.15,-1781.2 8829.58,-1781.2"/>
<polygon fill="black" stroke="black" points="8829.71,-1784.7 8839.71,-1781.2 8829.71,-1777.7 8829.71,-1784.7"/>
</g>
<!-- moderation.lot_skip_reason -->
<g id="node5" class="node">
<title>moderation.lot_skip_reason</title>
<g id="a_node5"><a xlink:title="Return the moderation reason for ``lot`` or ``None``.">
<polygon fill="none" stroke="black" points="9311.5,-932.2 8958.5,-932.2 8958.5,-896.2 9311.5,-896.2 9311.5,-932.2"/>
<text text-anchor="middle" x="9135" y="-908.33" font-family="Times,serif" font-size="24.22">moderation.lot_skip_reason</text>
</a>
</g>
</g>
<!-- moderation.should_skip_lot -->
<g id="node6" class="node">
<title>moderation.should_skip_lot</title>
<g id="a_node6"><a xlink:title="Return ``True`` when the lot fails additional checks.">
<polygon fill="none" stroke="black" points="8397,-1883.2 8121,-1883.2 8121,-1847.2 8397,-1847.2 8397,-1883.2"/>
<text text-anchor="middle" x="8259" y="-1860.42" font-family="Times,serif" font-size="18.48">moderation.should_skip_lot</text>
</a>
</g>
</g>
<!-- moderation.should_skip_lot&#45;&gt;moderation.lot_skip_reason -->
<g id="edge4" class="edge">
<title>moderation.should_skip_lot&#45;&gt;moderation.lot_skip_reason</title>
<path fill="none" stroke="black" d="M8331.57,-1883.3C8449.12,-1908.24 8682.15,-1936.72 8804,-1808.2 8857.81,-1751.45 8800.94,-1172.97 8840,-1105.2 8890.44,-1017.7 8999.03,-963.38 9069.18,-936"/>
<polygon fill="black" stroke="black" points="9070.72,-939.15 9078.81,-932.31 9068.22,-932.61 9070.72,-939.15"/>
</g>
<!-- moderation.is_misparsed -->
<g id="node7" class="node">
<title>moderation.is_misparsed</title>
<g id="a_node7"><a xlink:title="Return ``True`` for obviously invalid lots or source posts.">
<polygon fill="none" stroke="black" points="7430,-684.2 6994,-684.2 6994,-640.2 7430,-640.2 7430,-684.2"/>
<text text-anchor="middle" x="7212" y="-653.88" font-family="Times,serif" font-size="32.90">moderation.is_misparsed</text>
</a>
</g>
</g>
<!-- lot_io.get_seller -->
<g id="node8" class="node">
<title>lot_io.get_seller</title>
<g id="a_node8"><a xlink:title="Return the seller identifier or ``None`` when missing.">
<polygon fill="none" stroke="black" points="8359.5,-636.2 8158.5,-636.2 8158.5,-600.2 8359.5,-600.2 8359.5,-636.2"/>
<text text-anchor="middle" x="8259" y="-612.61" font-family="Times,serif" font-size="23.24">lot_io.get_seller</text>
</a>
</g>
</g>
<!-- moderation.is_misparsed&#45;&gt;lot_io.get_seller -->
<g id="edge5" class="edge">
<title>moderation.is_misparsed&#45;&gt;lot_io.get_seller</title>
<path fill="none" stroke="black" d="M7430.16,-653.06C7649.19,-643.84 7978.49,-629.97 8148.21,-622.83"/>
<polygon fill="black" stroke="black" points="8148.56,-626.32 8158.41,-622.4 8148.27,-619.32 8148.56,-626.32"/>
</g>
<!-- moderation.apply_to_history -->
<g id="node9" class="node">
<title>moderation.apply_to_history</title>
<g id="a_node9"><a xlink:title="Remove processed lots now failing moderation.">
<polygon fill="none" stroke="black" points="7468,-1958.2 6956,-1958.2 6956,-1912.2 7468,-1912.2 7468,-1958.2"/>
<text text-anchor="middle" x="7212" y="-1926.76" font-family="Times,serif" font-size="34.30">moderation.apply_to_history</text>
</a>
</g>
</g>
<!-- moderation.apply_to_history&#45;&gt;moderation.should_skip_message -->
<g id="edge6" class="edge">
<title>moderation.apply_to_history&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M7352.36,-1958.22C7450.79,-1967.06 7581.77,-1963.16 7678,-1902.2 7705.57,-1884.74 7686.73,-1856.13 7714,-1838.2 7834,-1759.34 8002.05,-1753.76 8119.51,-1762.4"/>
<polygon fill="black" stroke="black" points="8119.41,-1765.9 8129.65,-1763.19 8119.95,-1758.92 8119.41,-1765.9"/>
</g>
<!-- moderation.apply_to_history&#45;&gt;moderation.should_skip_lot -->
<g id="edge7" class="edge">
<title>moderation.apply_to_history&#45;&gt;moderation.should_skip_lot</title>
<path fill="none" stroke="black" d="M7468.3,-1918.1C7669.82,-1904.6 7943.89,-1886.25 8110.48,-1875.09"/>
<polygon fill="black" stroke="black" points="8111.05,-1878.56 8120.8,-1874.4 8110.59,-1871.57 8111.05,-1878.56"/>
</g>
<!-- lot_io.read_lots -->
<g id="node10" class="node">
<title>lot_io.read_lots</title>
<g id="a_node10"><a xlink:title="Return a list of lots from ``path`` or ``None`` when invalid.">
<polygon fill="none" stroke="black" points="8365,-1953.2 8153,-1953.2 8153,-1917.2 8365,-1917.2 8365,-1953.2"/>
<text text-anchor="middle" x="8259" y="-1929.04" font-family="Times,serif" font-size="25.20">lot_io.read_lots</text>
</a>
</g>
</g>
<!-- moderation.apply_to_history&#45;&gt;lot_io.read_lots -->
<g id="edge8" class="edge">
<title>moderation.apply_to_history&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M7468.3,-1935.2C7683.36,-1935.2 7981.06,-1935.2 8142.56,-1935.2"/>
<polygon fill="black" stroke="black" points="8143,-1938.7 8153,-1935.2 8143,-1931.7 8143,-1938.7"/>
</g>
<!-- post_io.read_post -->
<g id="node11" class="node">
<title>post_io.read_post</title>
<g id="a_node11"><a xlink:title="Return metadata dictionary and body text for ``path``.">
<polygon fill="none" stroke="black" points="8538,-2208.2 7980,-2208.2 7980,-2132.2 8538,-2132.2 8538,-2208.2"/>
<text text-anchor="middle" x="8259" y="-2155.04" font-family="Times,serif" font-size="61.46">post_io.read_post</text>
</a>
</g>
</g>
<!-- moderation.apply_to_history&#45;&gt;post_io.read_post -->
<g id="edge9" class="edge">
<title>moderation.apply_to_history&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7468.02,-1943.99C7536.69,-1949.48 7610.59,-1958.25 7678,-1972.2 7852.05,-2008.25 8045.93,-2081.56 8159.64,-2128.16"/>
<polygon fill="black" stroke="black" points="8158.46,-2131.46 8169.04,-2132.03 8161.12,-2124.98 8158.46,-2131.46"/>
</g>
<!-- post_io.raw_post_path -->
<g id="node12" class="node">
<title>post_io.raw_post_path</title>
<g id="a_node12"><a xlink:title="Return absolute message path for ``rel`` under ``root``.">
<polygon fill="none" stroke="black" points="8335.5,-3384.2 8182.5,-3384.2 8182.5,-3348.2 8335.5,-3348.2 8335.5,-3384.2"/>
<text text-anchor="middle" x="8259" y="-3362.96" font-family="Times,serif" font-size="12.18">post_io.raw_post_path</text>
</a>
</g>
</g>
<!-- moderation.apply_to_history&#45;&gt;post_io.raw_post_path -->
<g id="edge10" class="edge">
<title>moderation.apply_to_history&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7468.09,-1957.88C7547.71,-1978.23 7627.76,-2015.1 7678,-2081.2 7750.66,-2176.79 7644.05,-3063.62 7714,-3161.2 7820.23,-3309.41 8047.47,-3350.53 8172.01,-3361.9"/>
<polygon fill="black" stroke="black" points="8172,-3365.41 8182.26,-3362.79 8172.6,-3358.44 8172,-3365.41"/>
</g>
<!-- notes_utils.load_json -->
<g id="node36" class="node">
<title>notes_utils.load_json</title>
<g id="a_node36"><a xlink:title="Return parsed JSON or ``None`` when invalid.">
<polygon fill="none" stroke="black" points="9259,-3432.2 9011,-3432.2 9011,-3396.2 9259,-3396.2 9259,-3432.2"/>
<text text-anchor="middle" x="9135" y="-3408.51" font-family="Times,serif" font-size="22.12">notes_utils.load_json</text>
</a>
</g>
</g>
<!-- lot_io.read_lots&#45;&gt;notes_utils.load_json -->
<g id="edge254" class="edge">
<title>lot_io.read_lots&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M8365.02,-1938.36C8491.87,-1948.41 8701.01,-1986.23 8804,-2123.2 8850.87,-2185.54 8820.19,-2748.77 8840,-2824.2 8901.29,-3057.62 9061.09,-3306.82 9115.53,-3387.43"/>
<polygon fill="black" stroke="black" points="9112.83,-3389.68 9121.34,-3395.98 9118.62,-3385.75 9112.83,-3389.68"/>
</g>
<!-- lot_io._clean_lot -->
<g id="node153" class="node">
<title>lot_io._clean_lot</title>
<g id="a_node153"><a xlink:title="Return ``lot`` without empty or null fields.">
<polygon fill="none" stroke="black" points="9192.5,-1150.2 9077.5,-1150.2 9077.5,-1114.2 9192.5,-1114.2 9192.5,-1150.2"/>
<text text-anchor="middle" x="9135" y="-1128.96" font-family="Times,serif" font-size="12.18">lot_io._clean_lot</text>
</a>
</g>
</g>
<!-- lot_io.read_lots&#45;&gt;lot_io._clean_lot -->
<g id="edge255" class="edge">
<title>lot_io.read_lots&#45;&gt;lot_io._clean_lot</title>
<path fill="none" stroke="black" d="M8322.9,-1953.28C8436.84,-1981.75 8677.31,-2021.41 8804,-1892.2 8898.61,-1795.72 8766.5,-1398.59 8840,-1285.2 8891.38,-1205.93 8997.78,-1165.41 9067.49,-1146.54"/>
<polygon fill="black" stroke="black" points="9068.72,-1149.84 9077.5,-1143.91 9066.94,-1143.07 9068.72,-1149.84"/>
</g>
<!-- notes_utils.read_md -->
<g id="node86" class="node">
<title>notes_utils.read_md</title>
<g id="a_node86"><a xlink:title="Alias for :func:`read_text` used for Markdown files.">
<polygon fill="none" stroke="black" points="9205,-2381.2 9065,-2381.2 9065,-2345.2 9205,-2345.2 9205,-2381.2"/>
<text text-anchor="middle" x="9135" y="-2359.96" font-family="Times,serif" font-size="12.18">notes_utils.read_md</text>
</a>
</g>
</g>
<!-- post_io.read_post&#45;&gt;notes_utils.read_md -->
<g id="edge264" class="edge">
<title>post_io.read_post&#45;&gt;notes_utils.read_md</title>
<path fill="none" stroke="black" d="M8538.21,-2188.38C8624.26,-2197.74 8718.8,-2211.88 8804,-2233.2 8858.71,-2246.9 9004.07,-2307.55 9082.35,-2340.95"/>
<polygon fill="black" stroke="black" points="9081.44,-2344.37 9092.01,-2345.08 9084.19,-2337.93 9081.44,-2344.37"/>
</g>
<!-- notes_utils._parse_block -->
<g id="node88" class="node">
<title>notes_utils._parse_block</title>
<g id="a_node88"><a xlink:title="Return metadata dict and remaining body from ``text``.">
<polygon fill="none" stroke="black" points="9304,-2235.7 8966,-2235.7 8966,-2198.7 9304,-2198.7 9304,-2235.7"/>
<text text-anchor="middle" x="9135" y="-2210.76" font-family="Times,serif" font-size="26.18">notes_utils._parse_block</text>
</a>
</g>
</g>
<!-- post_io.read_post&#45;&gt;notes_utils._parse_block -->
<g id="edge265" class="edge">
<title>post_io.read_post&#45;&gt;notes_utils._parse_block</title>
<path fill="none" stroke="black" d="M8538.04,-2185.16C8674.88,-2192.52 8835.8,-2201.17 8955.91,-2207.63"/>
<polygon fill="black" stroke="black" points="8955.76,-2211.12 8965.94,-2208.17 8956.14,-2204.13 8955.76,-2211.12"/>
</g>
<!-- telegram_bot._t -->
<g id="node13" class="node">
<title>telegram_bot._t</title>
<g id="a_node13"><a xlink:title="Return ``text`` translated to ``lang`` using gettext files.">
<polygon fill="none" stroke="black" points="5500.5,-4688.2 5292.5,-4688.2 5292.5,-4652.2 5500.5,-4652.2 5500.5,-4688.2"/>
<text text-anchor="middle" x="5396.5" y="-4664.33" font-family="Times,serif" font-size="24.22">telegram_bot._t</text>
</a>
</g>
</g>
<!-- telegram_bot.ensure_profile -->
<g id="node14" class="node">
<title>telegram_bot.ensure_profile</title>
<g id="a_node14"><a xlink:title="Return profile for ``uid`` creating one if needed.">
<polygon fill="none" stroke="black" points="5547.5,-4634.2 5245.5,-4634.2 5245.5,-4598.2 5547.5,-4598.2 5547.5,-4634.2"/>
<text text-anchor="middle" x="5396.5" y="-4611.41" font-family="Times,serif" font-size="19.74">telegram_bot.ensure_profile</text>
</a>
</g>
</g>
<!-- telegram_bot.save_profiles -->
<g id="node15" class="node">
<title>telegram_bot.save_profiles</title>
<g id="a_node15"><a xlink:title="Write ``profiles`` to disk.">
<polygon fill="none" stroke="black" points="6313,-4728.2 6105,-4728.2 6105,-4692.2 6313,-4692.2 6313,-4728.2"/>
<text text-anchor="middle" x="6209" y="-4706.5" font-family="Times,serif" font-size="14.00">telegram_bot.save_profiles</text>
</a>
</g>
</g>
<!-- telegram_bot.ensure_profile&#45;&gt;telegram_bot.save_profiles -->
<g id="edge11" class="edge">
<title>telegram_bot.ensure_profile&#45;&gt;telegram_bot.save_profiles</title>
<path fill="none" stroke="black" d="M5547.61,-4612.9C5589.4,-4616.72 5633.78,-4625.46 5672,-4643.2 5692.24,-4652.6 5687.6,-4669.15 5708,-4678.2 5831.81,-4733.14 5990.01,-4733.08 6094.95,-4724.61"/>
<polygon fill="black" stroke="black" points="6095.26,-4728.09 6104.93,-4723.76 6094.67,-4721.12 6095.26,-4728.09"/>
</g>
<!-- telegram_bot.load_profiles -->
<g id="node16" class="node">
<title>telegram_bot.load_profiles</title>
<g id="a_node16"><a xlink:title="Populate the global ``profiles`` mapping.">
<polygon fill="none" stroke="black" points="5547.5,-4320.2 5245.5,-4320.2 5245.5,-4284.2 5547.5,-4284.2 5547.5,-4320.2"/>
<text text-anchor="middle" x="5396.5" y="-4296.9" font-family="Times,serif" font-size="21.00">telegram_bot.load_profiles</text>
</a>
</g>
</g>
<!-- notes_utils.read_text -->
<g id="node17" class="node">
<title>notes_utils.read_text</title>
<g id="a_node17"><a xlink:title="Return file contents as UTF&#45;8 or empty string when missing.">
<polygon fill="none" stroke="black" points="9789.5,-3882.2 9575.5,-3882.2 9575.5,-3846.2 9789.5,-3846.2 9789.5,-3882.2"/>
<text text-anchor="middle" x="9682.5" y="-3859.42" font-family="Times,serif" font-size="18.48">notes_utils.read_text</text>
</a>
</g>
</g>
<!-- telegram_bot.load_profiles&#45;&gt;notes_utils.read_text -->
<g id="edge12" class="edge">
<title>telegram_bot.load_profiles&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M5536.36,-4320.24C5581.12,-4329.37 5629.99,-4342.99 5672,-4363.2 5690.51,-4372.11 5689.01,-4384.36 5708,-4392.2 6136.75,-4569.37 6282.96,-4473.66 6746,-4502.2 7043.66,-4520.55 9191.36,-4683.06 9430,-4504.2 9472.18,-4472.59 9448.01,-4440.75 9466,-4391.2 9536.22,-4197.8 9634.72,-3970.49 9669.09,-3892.28"/>
<polygon fill="black" stroke="black" points="9672.5,-3893.23 9673.32,-3882.67 9666.09,-3890.41 9672.5,-3893.23"/>
</g>
<!-- notes_utils.read_text&#45;&gt;notes_utils.read_text -->
<g id="edge104" class="edge">
<title>notes_utils.read_text&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M9583.72,-3882.36C9568.53,-3891.74 9601.45,-3900.2 9682.5,-3900.2 9733.15,-3900.2 9765.01,-3896.9 9778.07,-3892.13"/>
<polygon fill="black" stroke="black" points="9781.48,-3892.95 9781.28,-3882.36 9774.83,-3890.77 9781.48,-3892.95"/>
</g>
<!-- telegram_bot.load_state -->
<g id="node18" class="node">
<title>telegram_bot.load_state</title>
<g id="a_node18"><a xlink:title="Populate ``processed_ids`` from ``STATE_PATH``.">
<polygon fill="none" stroke="black" points="5540,-4266.2 5253,-4266.2 5253,-4230.2 5540,-4230.2 5540,-4266.2"/>
<text text-anchor="middle" x="5396.5" y="-4242.51" font-family="Times,serif" font-size="22.12">telegram_bot.load_state</text>
</a>
</g>
</g>
<!-- telegram_bot.load_state&#45;&gt;notes_utils.read_text -->
<g id="edge13" class="edge">
<title>telegram_bot.load_state&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M5540.22,-4248.52C5583.57,-4252.23 5630.65,-4259.99 5672,-4275.2 5690.28,-4281.93 5689.9,-4293 5708,-4300.2 6141.53,-4472.87 6281.35,-4415.07 6746,-4458.2 7656.87,-4542.76 7889.73,-4521.84 8804,-4491.2 9082.69,-4481.87 9202.39,-4610.29 9430,-4449.2 9455.02,-4431.5 9625.48,-4005.32 9670.58,-3891.78"/>
<polygon fill="black" stroke="black" points="9673.87,-3892.96 9674.31,-3882.37 9667.37,-3890.38 9673.87,-3892.96"/>
</g>
<!-- telegram_bot.save_state -->
<g id="node19" class="node">
<title>telegram_bot.save_state</title>
<polygon fill="none" stroke="black" points="6293,-3912.2 6125,-3912.2 6125,-3876.2 6293,-3876.2 6293,-3912.2"/>
<text text-anchor="middle" x="6209" y="-3890.96" font-family="Times,serif" font-size="12.18">telegram_bot.save_state</text>
</g>
<!-- telegram_bot.scan_embeddings -->
<g id="node20" class="node">
<title>telegram_bot.scan_embeddings</title>
<g id="a_node20"><a xlink:title="Load new embeddings and return list of new lot ids.">
<polygon fill="none" stroke="black" points="7358,-3004.2 7066,-3004.2 7066,-2968.2 7358,-2968.2 7358,-3004.2"/>
<text text-anchor="middle" x="7212" y="-2982.04" font-family="Times,serif" font-size="17.08">telegram_bot.scan_embeddings</text>
</a>
</g>
</g>
<!-- similar_utils._load_embeddings -->
<g id="node21" class="node">
<title>similar_utils._load_embeddings</title>
<g id="a_node21"><a xlink:title="Return mapping of lot id to embedding vector.">
<polygon fill="none" stroke="black" points="8515,-2996.2 8003,-2996.2 8003,-2954.2 8515,-2954.2 8515,-2996.2"/>
<text text-anchor="middle" x="8259" y="-2967.12" font-family="Times,serif" font-size="31.36">similar_utils._load_embeddings</text>
</a>
</g>
</g>
<!-- telegram_bot.scan_embeddings&#45;&gt;similar_utils._load_embeddings -->
<g id="edge14" class="edge">
<title>telegram_bot.scan_embeddings&#45;&gt;similar_utils._load_embeddings</title>
<path fill="none" stroke="black" d="M7358.03,-2984.68C7521.62,-2982.96 7791.1,-2980.12 7992.61,-2978"/>
<polygon fill="black" stroke="black" points="7992.79,-2981.5 8002.76,-2977.89 7992.72,-2974.5 7992.79,-2981.5"/>
</g>
<!-- similar_utils._load_embeddings&#45;&gt;notes_utils.load_json -->
<g id="edge43" class="edge">
<title>similar_utils._load_embeddings&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M8387.4,-2954.19C8502.72,-2941.44 8673.94,-2938.57 8804,-3005.2 8973.41,-3092 9085.87,-3308.97 9121.69,-3386.29"/>
<polygon fill="black" stroke="black" points="9118.71,-3388.2 9126.05,-3395.84 9125.08,-3385.29 9118.71,-3388.2"/>
</g>
<!-- telegram_bot._should_suggest -->
<g id="node22" class="node">
<title>telegram_bot._should_suggest</title>
<polygon fill="none" stroke="black" points="6370.5,-3966.2 6047.5,-3966.2 6047.5,-3930.2 6370.5,-3930.2 6370.5,-3966.2"/>
<text text-anchor="middle" x="6209" y="-3943.41" font-family="Times,serif" font-size="19.74">telegram_bot._should_suggest</text>
</g>
<!-- similar_utils._cos_sim -->
<g id="node23" class="node">
<title>similar_utils._cos_sim</title>
<g id="a_node23"><a xlink:title="Return cosine similarity between two embeddings.">
<polygon fill="none" stroke="black" points="7328.5,-3682.2 7095.5,-3682.2 7095.5,-3646.2 7328.5,-3646.2 7328.5,-3682.2"/>
<text text-anchor="middle" x="7212" y="-3659.41" font-family="Times,serif" font-size="19.74">similar_utils._cos_sim</text>
</a>
</g>
</g>
<!-- telegram_bot._should_suggest&#45;&gt;similar_utils._cos_sim -->
<g id="edge15" class="edge">
<title>telegram_bot._should_suggest&#45;&gt;similar_utils._cos_sim</title>
<path fill="none" stroke="black" d="M6370.8,-3959.71C6497.23,-3965.15 6660.07,-3963.05 6710,-3921.2 6763.87,-3876.05 6696.01,-3816.62 6746,-3767.2 6834.71,-3679.52 6980.34,-3659.41 7085,-3657.68"/>
<polygon fill="black" stroke="black" points="7085.35,-3661.18 7095.31,-3657.57 7085.28,-3654.18 7085.35,-3661.18"/>
</g>
<!-- telegram_bot.enqueue_new_ids -->
<g id="node24" class="node">
<title>telegram_bot.enqueue_new_ids</title>
<polygon fill="none" stroke="black" points="5635,-3958.2 5158,-3958.2 5158,-3918.2 5635,-3918.2 5635,-3958.2"/>
<text text-anchor="middle" x="5396.5" y="-3931.13" font-family="Times,serif" font-size="28.84">telegram_bot.enqueue_new_ids</text>
</g>
<!-- telegram_bot.enqueue_new_ids&#45;&gt;telegram_bot.save_profiles -->
<g id="edge16" class="edge">
<title>telegram_bot.enqueue_new_ids&#45;&gt;telegram_bot.save_profiles</title>
<path fill="none" stroke="black" d="M5635.02,-3939.93C5648.66,-3946.88 5661.2,-3955.82 5672,-3967.2 5775.87,-4076.64 5605.46,-4534.53 5708,-4645.2 5809.64,-4754.91 5998.3,-4747.14 6112.57,-4729.83"/>
<polygon fill="black" stroke="black" points="6113.37,-4733.25 6122.71,-4728.24 6112.29,-4726.33 6113.37,-4733.25"/>
</g>
<!-- telegram_bot.enqueue_new_ids&#45;&gt;telegram_bot._should_suggest -->
<g id="edge17" class="edge">
<title>telegram_bot.enqueue_new_ids&#45;&gt;telegram_bot._should_suggest</title>
<path fill="none" stroke="black" d="M5635.2,-3941.14C5764.1,-3942.73 5920.45,-3944.66 6037.21,-3946.1"/>
<polygon fill="black" stroke="black" points="6037.28,-3949.6 6047.32,-3946.22 6037.36,-3942.6 6037.28,-3949.6"/>
</g>
<!-- telegram_bot._send_queue -->
<g id="node25" class="node">
<title>telegram_bot._send_queue</title>
<g id="a_node25"><a xlink:title="Send next lot from each user queue via ``app``.">
<polygon fill="none" stroke="black" points="5672,-4028.2 5121,-4028.2 5121,-3976.2 5672,-3976.2 5672,-4028.2"/>
<text text-anchor="middle" x="5396.5" y="-3992.51" font-family="Times,serif" font-size="39.62">telegram_bot._send_queue</text>
</a>
</g>
</g>
<!-- telegram_bot._send_queue&#45;&gt;telegram_bot.save_profiles -->
<g id="edge18" class="edge">
<title>telegram_bot._send_queue&#45;&gt;telegram_bot.save_profiles</title>
<path fill="none" stroke="black" d="M5542.59,-4028.29C5591.41,-4044.5 5641.23,-4070.75 5672,-4113.2 5741.53,-4209.16 5626.84,-4558.87 5708,-4645.2 5810,-4753.7 5997.23,-4746.7 6111.37,-4729.8"/>
<polygon fill="black" stroke="black" points="6112.15,-4733.22 6121.5,-4728.24 6111.09,-4726.3 6112.15,-4733.22"/>
</g>
<!-- lot_io.get_lot -->
<g id="node26" class="node">
<title>lot_io.get_lot</title>
<g id="a_node26"><a xlink:title="Return the lot identified by ``lot_id`` or ``None`` when missing.">
<polygon fill="none" stroke="black" points="7284.5,-3866.2 7139.5,-3866.2 7139.5,-3830.2 7284.5,-3830.2 7284.5,-3866.2"/>
<text text-anchor="middle" x="7212" y="-3843.41" font-family="Times,serif" font-size="19.74">lot_io.get_lot</text>
</a>
</g>
</g>
<!-- telegram_bot._send_queue&#45;&gt;lot_io.get_lot -->
<g id="edge19" class="edge">
<title>telegram_bot._send_queue&#45;&gt;lot_io.get_lot</title>
<path fill="none" stroke="black" d="M5672.31,-4012.9C6032.44,-4024.43 6628.12,-4034.02 6710,-3975.2 6748.37,-3947.65 6708.16,-3903.48 6746,-3875.2 6804.54,-3831.47 7012.19,-3836.03 7129.23,-3842.49"/>
<polygon fill="black" stroke="black" points="7129.04,-3845.99 7139.23,-3843.06 7129.44,-3839 7129.04,-3845.99"/>
</g>
<!-- lot_io.get_lot&#45;&gt;lot_io.read_lots -->
<g id="edge261" class="edge">
<title>lot_io.get_lot&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M7284.7,-3855.24C7401.6,-3864.96 7625.53,-3875.64 7678,-3821.2 7743.48,-3753.27 7658.44,-2199.47 7714,-2123.2 7812.39,-1988.15 8014.36,-1949.32 8142.61,-1938.63"/>
<polygon fill="black" stroke="black" points="8143.16,-1942.09 8152.86,-1937.82 8142.61,-1935.11 8143.16,-1942.09"/>
</g>
<!-- lot_io.parse_lot_id -->
<g id="node156" class="node">
<title>lot_io.parse_lot_id</title>
<g id="a_node156"><a xlink:title="Return ``(relative_path, index)`` extracted from ``lot_id``.">
<polygon fill="none" stroke="black" points="9260,-4004.2 9010,-4004.2 9010,-3968.2 9260,-3968.2 9260,-4004.2"/>
<text text-anchor="middle" x="9135" y="-3980.04" font-family="Times,serif" font-size="25.20">lot_io.parse_lot_id</text>
</a>
</g>
</g>
<!-- lot_io.get_lot&#45;&gt;lot_io.parse_lot_id -->
<g id="edge262" class="edge">
<title>lot_io.get_lot&#45;&gt;lot_io.parse_lot_id</title>
<path fill="none" stroke="black" d="M7284.72,-3851.97C7376.08,-3856.85 7538.82,-3865.86 7678,-3875.2 8165.05,-3907.91 8743.14,-3954.21 8999.78,-3975.16"/>
<polygon fill="black" stroke="black" points="8999.64,-3978.66 9009.89,-3975.98 9000.21,-3971.68 8999.64,-3978.66"/>
</g>
<!-- telegram_bot.send_alert -->
<g id="node27" class="node">
<title>telegram_bot.send_alert</title>
<g id="a_node27"><a xlink:title="Broadcast ``text`` to all registered users.">
<polygon fill="none" stroke="black" points="5005.5,-4217.2 4675.5,-4217.2 4675.5,-4181.2 5005.5,-4181.2 5005.5,-4217.2"/>
<text text-anchor="middle" x="4840.5" y="-4193.04" font-family="Times,serif" font-size="25.20">telegram_bot.send_alert</text>
</a>
</g>
</g>
<!-- telegram_bot.send_alert&#45;&gt;telegram_bot.load_profiles -->
<g id="edge20" class="edge">
<title>telegram_bot.send_alert&#45;&gt;telegram_bot.load_profiles</title>
<path fill="none" stroke="black" d="M4897.08,-4217.28C4953.03,-4234.77 5042.11,-4260.71 5121,-4275.2 5157.75,-4281.96 5197.6,-4287.1 5235.24,-4290.99"/>
<polygon fill="black" stroke="black" points="5234.98,-4294.48 5245.28,-4292.01 5235.68,-4287.52 5234.98,-4294.48"/>
</g>
<!-- telegram_bot.start_cmd -->
<g id="node28" class="node">
<title>telegram_bot.start_cmd</title>
<g id="a_node28"><a xlink:title="Register the user and confirm startup.">
<polygon fill="none" stroke="black" points="4952.5,-4630.2 4728.5,-4630.2 4728.5,-4594.2 4952.5,-4594.2 4952.5,-4630.2"/>
<text text-anchor="middle" x="4840.5" y="-4608.04" font-family="Times,serif" font-size="17.08">telegram_bot.start_cmd</text>
</a>
</g>
</g>
<!-- telegram_bot.start_cmd&#45;&gt;telegram_bot._t -->
<g id="edge21" class="edge">
<title>telegram_bot.start_cmd&#45;&gt;telegram_bot._t</title>
<path fill="none" stroke="black" d="M4952.72,-4624.53C4994.23,-4629.13 5041.78,-4634.41 5085,-4639.2 5101,-4640.98 5104.99,-4641.53 5121,-4643.2 5174.02,-4648.76 5232.84,-4654.59 5282.39,-4659.4"/>
<polygon fill="black" stroke="black" points="5282.2,-4662.9 5292.49,-4660.38 5282.88,-4655.93 5282.2,-4662.9"/>
</g>
<!-- telegram_bot.start_cmd&#45;&gt;telegram_bot.ensure_profile -->
<g id="edge22" class="edge">
<title>telegram_bot.start_cmd&#45;&gt;telegram_bot.ensure_profile</title>
<path fill="none" stroke="black" d="M4952.61,-4613.01C5033.67,-4613.59 5144.74,-4614.39 5235.37,-4615.05"/>
<polygon fill="black" stroke="black" points="5235.45,-4618.55 5245.47,-4615.12 5235.5,-4611.55 5235.45,-4618.55"/>
</g>
<!-- telegram_bot.lang_cmd -->
<g id="node29" class="node">
<title>telegram_bot.lang_cmd</title>
<g id="a_node29"><a xlink:title="Set preferred language or list available choices.">
<polygon fill="none" stroke="black" points="5015,-4575.7 4666,-4575.7 4666,-4536.7 5015,-4536.7 5015,-4575.7"/>
<text text-anchor="middle" x="4840.5" y="-4549.3" font-family="Times,serif" font-size="28.00">telegram_bot.lang_cmd</text>
</a>
</g>
</g>
<!-- telegram_bot.lang_cmd&#45;&gt;telegram_bot._t -->
<g id="edge23" class="edge">
<title>telegram_bot.lang_cmd&#45;&gt;telegram_bot._t</title>
<path fill="none" stroke="black" d="M5015.15,-4557.47C5039.87,-4563.05 5063.99,-4571.83 5085,-4585.2 5110.59,-4601.5 5095.24,-4627.17 5121,-4643.2 5168.46,-4672.74 5229.71,-4680.95 5282.3,-4681.15"/>
<polygon fill="black" stroke="black" points="5282.38,-4684.65 5292.36,-4681.09 5282.34,-4677.65 5282.38,-4684.65"/>
</g>
<!-- telegram_bot.lang_cmd&#45;&gt;telegram_bot.ensure_profile -->
<g id="edge24" class="edge">
<title>telegram_bot.lang_cmd&#45;&gt;telegram_bot.ensure_profile</title>
<path fill="none" stroke="black" d="M5015.27,-4575.02C5085.59,-4582.64 5166.27,-4591.38 5235.16,-4598.84"/>
<polygon fill="black" stroke="black" points="5234.92,-4602.33 5245.24,-4599.93 5235.67,-4595.37 5234.92,-4602.33"/>
</g>
<!-- telegram_bot.lang_cmd&#45;&gt;telegram_bot.save_profiles -->
<g id="edge25" class="edge">
<title>telegram_bot.lang_cmd&#45;&gt;telegram_bot.save_profiles</title>
<path fill="none" stroke="black" d="M5015.03,-4553.2C5242.75,-4550.75 5619.78,-4552.47 5672,-4589.2 5706.9,-4613.76 5673.4,-4653.23 5708,-4678.2 5829.92,-4766.2 6015.15,-4749.95 6122.61,-4730.12"/>
<polygon fill="black" stroke="black" points="6123.27,-4733.55 6132.44,-4728.25 6121.97,-4726.68 6123.27,-4733.55"/>
</g>
<!-- telegram_bot.vote_callback -->
<g id="node30" class="node">
<title>telegram_bot.vote_callback</title>
<g id="a_node30"><a xlink:title="Handle inline button presses for lot feedback.">
<polygon fill="none" stroke="black" points="5055.5,-4689.7 4625.5,-4689.7 4625.5,-4648.7 5055.5,-4648.7 5055.5,-4689.7"/>
<text text-anchor="middle" x="4840.5" y="-4661.96" font-family="Times,serif" font-size="29.68">telegram_bot.vote_callback</text>
</a>
</g>
</g>
<!-- telegram_bot.vote_callback&#45;&gt;telegram_bot._t -->
<g id="edge26" class="edge">
<title>telegram_bot.vote_callback&#45;&gt;telegram_bot._t</title>
<path fill="none" stroke="black" d="M5055.69,-4669.59C5132.86,-4669.73 5216.89,-4669.88 5282.09,-4670"/>
<polygon fill="black" stroke="black" points="5282.38,-4673.5 5292.39,-4670.02 5282.39,-4666.5 5282.38,-4673.5"/>
</g>
<!-- telegram_bot.vote_callback&#45;&gt;telegram_bot.ensure_profile -->
<g id="edge27" class="edge">
<title>telegram_bot.vote_callback&#45;&gt;telegram_bot.ensure_profile</title>
<path fill="none" stroke="black" d="M5055.69,-4648.71C5115.44,-4643 5179.3,-4636.89 5235.34,-4631.53"/>
<polygon fill="black" stroke="black" points="5235.73,-4635.01 5245.35,-4630.57 5235.06,-4628.04 5235.73,-4635.01"/>
</g>
<!-- telegram_bot.vote_callback&#45;&gt;telegram_bot.save_profiles -->
<g id="edge28" class="edge">
<title>telegram_bot.vote_callback&#45;&gt;telegram_bot.save_profiles</title>
<path fill="none" stroke="black" d="M5022.87,-4689.71C5055.5,-4692.74 5089.23,-4695.43 5121,-4697.2 5475.92,-4717.07 5896.99,-4714.74 6094.75,-4712.12"/>
<polygon fill="black" stroke="black" points="6094.91,-4715.62 6104.86,-4711.99 6094.81,-4708.62 6094.91,-4715.62"/>
</g>
<!-- telegram_bot.main -->
<g id="node31" class="node">
<title>telegram_bot.main</title>
<g id="a_node31"><a xlink:title="Run the Telegram recommendation bot.">
<polygon fill="none" stroke="black" points="5006,-4024.2 4675,-4024.2 4675,-3980.2 5006,-3980.2 5006,-4024.2"/>
<text text-anchor="middle" x="4840.5" y="-3993.88" font-family="Times,serif" font-size="32.90">telegram_bot.main</text>
</a>
</g>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot.load_profiles -->
<g id="edge29" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot.load_profiles</title>
<path fill="none" stroke="black" d="M4889.97,-4024.44C4944.68,-4051.85 5032.82,-4103.39 5085,-4172.2 5114.3,-4210.85 5082.88,-4245.23 5121,-4275.2 5153.17,-4300.5 5194.45,-4311.91 5235.17,-4315.9"/>
<polygon fill="black" stroke="black" points="5234.97,-4319.39 5245.23,-4316.73 5235.55,-4312.42 5234.97,-4319.39"/>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot.load_state -->
<g id="edge30" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot.load_state</title>
<path fill="none" stroke="black" d="M4881.12,-4024.32C4931.9,-4053.85 5020.99,-4109.72 5085,-4172.2 5104.34,-4191.08 5097.52,-4207.83 5121,-4221.2 5157.5,-4241.99 5201.22,-4251.7 5242.92,-4255.49"/>
<polygon fill="black" stroke="black" points="5242.66,-4258.98 5252.9,-4256.28 5243.22,-4252 5242.66,-4258.98"/>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot.save_state -->
<g id="edge31" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot.save_state</title>
<path fill="none" stroke="black" d="M4892.06,-3980.12C4947.13,-3957.32 5038.43,-3923.17 5121,-3909.2 5484.18,-3847.8 5925.35,-3871.3 6114.53,-3885.94"/>
<polygon fill="black" stroke="black" points="6114.48,-3889.44 6124.72,-3886.74 6115.02,-3882.47 6114.48,-3889.44"/>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot.scan_embeddings -->
<g id="edge32" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot.scan_embeddings</title>
<path fill="none" stroke="black" d="M4915.26,-3980.11C4972.3,-3958.79 5047.65,-3920.42 5085,-3858.2 5131.2,-3781.25 5057.11,-3114.24 5121,-3051.2 5189.6,-2983.52 6582.7,-2983.4 7055.55,-2985.33"/>
<polygon fill="black" stroke="black" points="7055.85,-2988.83 7065.87,-2985.37 7055.88,-2981.83 7055.85,-2988.83"/>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot.enqueue_new_ids -->
<g id="edge33" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot.enqueue_new_ids</title>
<path fill="none" stroke="black" d="M5006.23,-3981.04C5043.92,-3976.35 5083.84,-3971.49 5121,-3967.2 5143.81,-3964.57 5167.69,-3961.91 5191.45,-3959.32"/>
<polygon fill="black" stroke="black" points="5192.06,-3962.77 5201.62,-3958.22 5191.3,-3955.82 5192.06,-3962.77"/>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot._send_queue -->
<g id="edge34" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot._send_queue</title>
<path fill="none" stroke="black" d="M5006.22,-4002.2C5039.31,-4002.2 5074.97,-4002.2 5110.81,-4002.2"/>
<polygon fill="black" stroke="black" points="5110.92,-4005.7 5120.92,-4002.2 5110.92,-3998.7 5110.92,-4005.7"/>
</g>
<!-- caption._identify_size -->
<g id="node32" class="node">
<title>caption._identify_size</title>
<g id="a_node32"><a xlink:title="Return ``(width, height)`` for ``path`` using ImageMagick.">
<polygon fill="none" stroke="black" points="9263.5,-4255.2 9006.5,-4255.2 9006.5,-4219.2 9263.5,-4219.2 9263.5,-4255.2"/>
<text text-anchor="middle" x="9135" y="-4231.51" font-family="Times,serif" font-size="22.12">caption._identify_size</text>
</a>
</g>
</g>
<!-- caption._prepare_image -->
<g id="node33" class="node">
<title>caption._prepare_image</title>
<g id="a_node33"><a xlink:title="Resize ``path`` and return the processed JPEG bytes.">
<polygon fill="none" stroke="black" points="8476,-4259.2 8042,-4259.2 8042,-4213.2 8476,-4213.2 8476,-4259.2"/>
<text text-anchor="middle" x="8259" y="-4227.76" font-family="Times,serif" font-size="34.30">caption._prepare_image</text>
</a>
</g>
</g>
<!-- caption._prepare_image&#45;&gt;caption._identify_size -->
<g id="edge35" class="edge">
<title>caption._prepare_image&#45;&gt;caption._identify_size</title>
<path fill="none" stroke="black" d="M8476.04,-4236.45C8638.54,-4236.64 8856.35,-4236.89 8995.96,-4237.05"/>
<polygon fill="black" stroke="black" points="8996.29,-4240.55 9006.3,-4237.06 8996.3,-4233.55 8996.29,-4240.55"/>
</g>
<!-- caption._guess_chat -->
<g id="node34" class="node">
<title>caption._guess_chat</title>
<g id="a_node34"><a xlink:title="Return chat name for ``path`` relative to ``MEDIA_DIR``.">
<polygon fill="none" stroke="black" points="9231,-4201.2 9039,-4201.2 9039,-4165.2 9231,-4165.2 9231,-4201.2"/>
<text text-anchor="middle" x="9135" y="-4179.04" font-family="Times,serif" font-size="17.08">caption._guess_chat</text>
</a>
</g>
</g>
<!-- caption.caption_file -->
<g id="node35" class="node">
<title>caption.caption_file</title>
<g id="a_node35"><a xlink:title="Caption ``path`` with GPT&#45;4o and save ``.caption.json`` beside it.">
<polygon fill="none" stroke="black" points="7515,-4185.7 6909,-4185.7 6909,-4112.7 7515,-4112.7 7515,-4185.7"/>
<text text-anchor="middle" x="7212" y="-4134.22" font-family="Times,serif" font-size="59.36">caption.caption_file</text>
</a>
</g>
</g>
<!-- caption.caption_file&#45;&gt;caption._prepare_image -->
<g id="edge36" class="edge">
<title>caption.caption_file&#45;&gt;caption._prepare_image</title>
<path fill="none" stroke="black" d="M7515.1,-4177.81C7569.35,-4183.13 7625.36,-4188.73 7678,-4194.2 7694.01,-4195.87 7697.97,-4196.75 7714,-4198.2 7818.26,-4207.63 7933.95,-4216.01 8031.74,-4222.48"/>
<polygon fill="black" stroke="black" points="8031.54,-4225.97 8041.75,-4223.14 8032,-4218.99 8031.54,-4225.97"/>
</g>
<!-- caption.caption_file&#45;&gt;caption._guess_chat -->
<g id="edge37" class="edge">
<title>caption.caption_file&#45;&gt;caption._guess_chat</title>
<path fill="none" stroke="black" d="M7515.01,-4156.12C7580.61,-4157.54 7649.63,-4158.98 7714,-4160.2 8205.58,-4169.58 8792.93,-4178.31 9028.58,-4181.7"/>
<polygon fill="black" stroke="black" points="9028.8,-4185.21 9038.85,-4181.85 9028.9,-4178.21 9028.8,-4185.21"/>
</g>
<!-- caption.caption_file&#45;&gt;notes_utils.load_json -->
<g id="edge38" class="edge">
<title>caption.caption_file&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M7515.03,-4168.74C7573.88,-4159.59 7631.62,-4140.03 7678,-4103.2 7716.97,-4072.27 7676.02,-4029.34 7714,-3997.2 8088.68,-3680.21 8449.38,-4159.49 8804,-3820.2 8860.75,-3765.91 8798.76,-3714.04 8840,-3647.2 8901.74,-3547.16 9022.58,-3472.36 9088.49,-3436.94"/>
<polygon fill="black" stroke="black" points="9090.22,-3439.98 9097.41,-3432.2 9086.94,-3433.8 9090.22,-3439.98"/>
</g>
<!-- caption_io.caption_json_path -->
<g id="node37" class="node">
<title>caption_io.caption_json_path</title>
<g id="a_node37"><a xlink:title="Return new&#45;style caption path for ``image``.">
<polygon fill="none" stroke="black" points="9231.5,-3692.2 9038.5,-3692.2 9038.5,-3656.2 9231.5,-3656.2 9231.5,-3692.2"/>
<text text-anchor="middle" x="9135" y="-3670.96" font-family="Times,serif" font-size="12.18">caption_io.caption_json_path</text>
</a>
</g>
</g>
<!-- caption.caption_file&#45;&gt;caption_io.caption_json_path -->
<g id="edge39" class="edge">
<title>caption.caption_file&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M7515.25,-4147.9C7947.81,-4143.44 8702.69,-4125.02 8804,-4051.2 8839.49,-4025.35 8815.68,-3995.76 8840,-3959.2 8914.86,-3846.66 9040.72,-3744.07 9100.51,-3698.74"/>
<polygon fill="black" stroke="black" points="9102.95,-3701.28 9108.84,-3692.47 9098.74,-3695.68 9102.95,-3701.28"/>
</g>
<!-- caption_io.has_caption -->
<g id="node38" class="node">
<title>caption_io.has_caption</title>
<g id="a_node38"><a xlink:title="Return ``True`` when any caption exists for ``image``.">
<polygon fill="none" stroke="black" points="8336.5,-3462.2 8181.5,-3462.2 8181.5,-3426.2 8336.5,-3426.2 8336.5,-3462.2"/>
<text text-anchor="middle" x="8259" y="-3440.96" font-family="Times,serif" font-size="12.18">caption_io.has_caption</text>
</a>
</g>
</g>
<!-- caption.caption_file&#45;&gt;caption_io.has_caption -->
<g id="edge40" class="edge">
<title>caption.caption_file&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M7515.19,-4179.09C7576.43,-4170.05 7635.11,-4147.92 7678,-4103.2 7775.37,-4001.68 7614.17,-3570.31 7714,-3471.2 7776.28,-3409.38 8034.21,-3423.01 8171.35,-3435.18"/>
<polygon fill="black" stroke="black" points="8171.14,-3438.68 8181.41,-3436.09 8171.77,-3431.71 8171.14,-3438.68"/>
</g>
<!-- caption_io.write_caption -->
<g id="node39" class="node">
<title>caption_io.write_caption</title>
<g id="a_node39"><a xlink:title="Write ``text`` as ``lang`` caption for ``image``.">
<polygon fill="none" stroke="black" points="8425.5,-3608.2 8092.5,-3608.2 8092.5,-3572.2 8425.5,-3572.2 8425.5,-3608.2"/>
<text text-anchor="middle" x="8259" y="-3584.04" font-family="Times,serif" font-size="25.20">caption_io.write_caption</text>
</a>
</g>
</g>
<!-- caption.caption_file&#45;&gt;caption_io.write_caption -->
<g id="edge41" class="edge">
<title>caption.caption_file&#45;&gt;caption_io.write_caption</title>
<path fill="none" stroke="black" d="M7515.13,-4173.7C7575.01,-4164.53 7633.14,-4143.7 7678,-4103.2 7737.59,-4049.41 7668.07,-3992.05 7714,-3926.2 7834.3,-3753.74 8074.42,-3652.54 8191.17,-3611.57"/>
<polygon fill="black" stroke="black" points="8192.42,-3614.84 8200.72,-3608.25 8190.12,-3608.22 8192.42,-3614.84"/>
</g>
<!-- notes_utils.load_json&#45;&gt;notes_utils.read_text -->
<g id="edge108" class="edge">
<title>notes_utils.load_json&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M9159.51,-3432.3C9209.71,-3471.06 9330.88,-3565.23 9430,-3647.2 9512.38,-3715.34 9607.32,-3798.58 9653.44,-3839.32"/>
<polygon fill="black" stroke="black" points="9651.4,-3842.19 9661.21,-3846.19 9656.04,-3836.94 9651.4,-3842.19"/>
</g>
<!-- caption_io.has_caption&#45;&gt;caption_io.caption_json_path -->
<g id="edge148" class="edge">
<title>caption_io.has_caption&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M8336.86,-3436.25C8444.15,-3427.75 8643.68,-3421.52 8804,-3471.2 8927.14,-3509.37 9050.87,-3604.17 9105.28,-3649.41"/>
<polygon fill="black" stroke="black" points="9103.19,-3652.23 9113.1,-3655.98 9107.69,-3646.87 9103.19,-3652.23"/>
</g>
<!-- caption_io.caption_md_path -->
<g id="node79" class="node">
<title>caption_io.caption_md_path</title>
<g id="a_node79"><a xlink:title="Return legacy Markdown caption path for ``image``.">
<polygon fill="none" stroke="black" points="9228.5,-2761.2 9041.5,-2761.2 9041.5,-2725.2 9228.5,-2725.2 9228.5,-2761.2"/>
<text text-anchor="middle" x="9135" y="-2739.96" font-family="Times,serif" font-size="12.18">caption_io.caption_md_path</text>
</a>
</g>
</g>
<!-- caption_io.has_caption&#45;&gt;caption_io.caption_md_path -->
<g id="edge149" class="edge">
<title>caption_io.has_caption&#45;&gt;caption_io.caption_md_path</title>
<path fill="none" stroke="black" d="M8336.56,-3448.68C8471.01,-3454.72 8741.3,-3458.18 8804,-3393.2 8900.29,-3293.41 8743.62,-2869.91 8840,-2770.2 8891.42,-2717.01 8978.32,-2715.22 9044.34,-2723.77"/>
<polygon fill="black" stroke="black" points="9043.95,-2727.25 9054.34,-2725.17 9044.92,-2720.32 9043.95,-2727.25"/>
</g>
<!-- caption_io.write_caption&#45;&gt;notes_utils.load_json -->
<g id="edge155" class="edge">
<title>caption_io.write_caption&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M8425.56,-3595.46C8534.5,-3595.27 8679.45,-3588.04 8804,-3558.2 8914.15,-3531.82 9033.7,-3470.64 9094.15,-3437.15"/>
<polygon fill="black" stroke="black" points="9095.96,-3440.14 9102.99,-3432.21 9092.55,-3434.03 9095.96,-3440.14"/>
</g>
<!-- caption_io.write_caption&#45;&gt;caption_io.caption_json_path -->
<g id="edge158" class="edge">
<title>caption_io.write_caption&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M8425.51,-3595.75C8533.48,-3600.39 8677.37,-3608.54 8804,-3622.2 8879.26,-3630.33 8963.56,-3643.69 9028.11,-3654.83"/>
<polygon fill="black" stroke="black" points="9027.85,-3658.33 9038.3,-3656.6 9029.05,-3651.44 9027.85,-3658.33"/>
</g>
<!-- notes_utils.write_json -->
<g id="node47" class="node">
<title>notes_utils.write_json</title>
<g id="a_node47"><a xlink:title="Serialise ``data`` to ``path`` with standard options.">
<polygon fill="none" stroke="black" points="9229,-1330.2 9041,-1330.2 9041,-1294.2 9229,-1294.2 9229,-1330.2"/>
<text text-anchor="middle" x="9135" y="-1308.16" font-family="Times,serif" font-size="15.68">notes_utils.write_json</text>
</a>
</g>
</g>
<!-- caption_io.write_caption&#45;&gt;notes_utils.write_json -->
<g id="edge156" class="edge">
<title>caption_io.write_caption&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M8425.82,-3593.33C8567.04,-3592.04 8754.71,-3579.62 8804,-3525.2 8870.26,-3452.07 8810.25,-1843.3 8840,-1749.2 8895.91,-1572.37 9047.78,-1401.43 9108.45,-1338.05"/>
<polygon fill="black" stroke="black" points="9111.3,-1340.14 9115.72,-1330.51 9106.26,-1335.28 9111.3,-1340.14"/>
</g>
<!-- caption_io._get_langs -->
<g id="node102" class="node">
<title>caption_io._get_langs</title>
<g id="a_node102"><a xlink:title="Return configured languages, caching the result.">
<polygon fill="none" stroke="black" points="9244,-2815.2 9026,-2815.2 9026,-2779.2 9244,-2779.2 9244,-2815.2"/>
<text text-anchor="middle" x="9135" y="-2792.42" font-family="Times,serif" font-size="18.48">caption_io._get_langs</text>
</a>
</g>
</g>
<!-- caption_io.write_caption&#45;&gt;caption_io._get_langs -->
<g id="edge157" class="edge">
<title>caption_io.write_caption&#45;&gt;caption_io._get_langs</title>
<path fill="none" stroke="black" d="M8425.67,-3601.73C8564.66,-3607.65 8749.03,-3605.55 8804,-3558.2 8862.85,-3507.52 8814.47,-3460.56 8840,-3387.2 8919.5,-3158.76 9068.13,-2905.37 9117.55,-2823.94"/>
<polygon fill="black" stroke="black" points="9120.6,-2825.66 9122.81,-2815.3 9114.62,-2822.02 9120.6,-2825.66"/>
</g>
<!-- caption.main -->
<g id="node40" class="node">
<title>caption.main</title>
<g id="a_node40"><a xlink:title="Caption a single image provided on the command line.">
<polygon fill="none" stroke="black" points="6301.5,-4163.2 6116.5,-4163.2 6116.5,-4127.2 6301.5,-4127.2 6301.5,-4163.2"/>
<text text-anchor="middle" x="6209" y="-4139.04" font-family="Times,serif" font-size="25.20">caption.main</text>
</a>
</g>
</g>
<!-- caption.main&#45;&gt;caption.caption_file -->
<g id="edge42" class="edge">
<title>caption.main&#45;&gt;caption.caption_file</title>
<path fill="none" stroke="black" d="M6301.93,-4145.57C6436.21,-4146.11 6692.43,-4147.13 6898.72,-4147.96"/>
<polygon fill="black" stroke="black" points="6898.8,-4151.46 6908.81,-4148 6898.83,-4144.46 6898.8,-4151.46"/>
</g>
<!-- token_utils.estimate_tokens -->
<g id="node41" class="node">
<title>token_utils.estimate_tokens</title>
<g id="a_node41"><a xlink:title="Return a naive token count approximation.">
<polygon fill="none" stroke="black" points="7330,-1448.2 7094,-1448.2 7094,-1412.2 7330,-1412.2 7330,-1448.2"/>
<text text-anchor="middle" x="7212" y="-1426.16" font-family="Times,serif" font-size="15.68">token_utils.estimate_tokens</text>
</a>
</g>
</g>
<!-- phone_utils.format_georgian -->
<g id="node42" class="node">
<title>phone_utils.format_georgian</title>
<g id="a_node42"><a xlink:title="Return ``phone`` in ``+995...`` format if possible.">
<polygon fill="none" stroke="black" points="7418,-4812.2 7006,-4812.2 7006,-4774.2 7418,-4774.2 7418,-4812.2"/>
<text text-anchor="middle" x="7212" y="-4786.48" font-family="Times,serif" font-size="27.16">phone_utils.format_georgian</text>
</a>
</g>
</g>
<!-- similar_utils._format_vector -->
<g id="node43" class="node">
<title>similar_utils._format_vector</title>
<g id="a_node43"><a xlink:title="Return compact JSON representation for ``vec``.">
<polygon fill="none" stroke="black" points="8387.5,-1246.2 8130.5,-1246.2 8130.5,-1210.2 8387.5,-1210.2 8387.5,-1246.2"/>
<text text-anchor="middle" x="8259" y="-1224.04" font-family="Times,serif" font-size="17.08">similar_utils._format_vector</text>
</a>
</g>
</g>
<!-- similar_utils._similar_path -->
<g id="node44" class="node">
<title>similar_utils._similar_path</title>
<g id="a_node44"><a xlink:title="Return cache file path for ``lot_path`` under ``SIMILAR_DIR``.">
<polygon fill="none" stroke="black" points="8361,-1100.2 8157,-1100.2 8157,-1064.2 8361,-1064.2 8361,-1100.2"/>
<text text-anchor="middle" x="8259" y="-1078.5" font-family="Times,serif" font-size="14.00">similar_utils._similar_path</text>
</a>
</g>
</g>
<!-- similar_utils._load_similar -->
<g id="node45" class="node">
<title>similar_utils._load_similar</title>
<g id="a_node45"><a xlink:title="Return cached similar lots mapping.">
<polygon fill="none" stroke="black" points="8508,-2476.2 8010,-2476.2 8010,-2428.2 8508,-2428.2 8508,-2476.2"/>
<text text-anchor="middle" x="8259" y="-2443.08" font-family="Times,serif" font-size="36.40">similar_utils._load_similar</text>
</a>
</g>
</g>
<!-- similar_utils._load_similar&#45;&gt;notes_utils.load_json -->
<g id="edge44" class="edge">
<title>similar_utils._load_similar&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M8508.35,-2437.18C8630.81,-2435.54 8761.29,-2444.39 8804,-2485.2 8858.77,-2537.55 8818.77,-2751.48 8840,-2824.2 8907.63,-3055.86 9063.33,-3306.2 9116.12,-3387.26"/>
<polygon fill="black" stroke="black" points="9113.35,-3389.42 9121.75,-3395.87 9119.2,-3385.59 9113.35,-3389.42"/>
</g>
<!-- similar_utils._save_similar -->
<g id="node46" class="node">
<title>similar_utils._save_similar</title>
<g id="a_node46"><a xlink:title="Write ``sim_map`` to ``SIMILAR_DIR`` mirroring ``LOTS_DIR`` layout.">
<polygon fill="none" stroke="black" points="7360,-1092.2 7064,-1092.2 7064,-1056.2 7360,-1056.2 7360,-1092.2"/>
<text text-anchor="middle" x="7212" y="-1068.9" font-family="Times,serif" font-size="21.00">similar_utils._save_similar</text>
</a>
</g>
</g>
<!-- similar_utils._save_similar&#45;&gt;similar_utils._similar_path -->
<g id="edge45" class="edge">
<title>similar_utils._save_similar&#45;&gt;similar_utils._similar_path</title>
<path fill="none" stroke="black" d="M7360.23,-1075.33C7571.73,-1076.95 7956.91,-1079.9 8146.5,-1081.35"/>
<polygon fill="black" stroke="black" points="8146.74,-1084.85 8156.77,-1081.43 8146.79,-1077.85 8146.74,-1084.85"/>
</g>
<!-- similar_utils._save_similar&#45;&gt;notes_utils.write_json -->
<g id="edge46" class="edge">
<title>similar_utils._save_similar&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M7360.01,-1071.3C7452.1,-1071.99 7572.84,-1077.46 7678,-1097.2 7694.58,-1100.32 7697.4,-1106.21 7714,-1109.2 7952.53,-1152.19 8569.12,-1087.42 8804,-1147.2 8863.45,-1162.34 9018.7,-1247.21 9093.1,-1288.98"/>
<polygon fill="black" stroke="black" points="9091.75,-1292.24 9102.18,-1294.09 9095.19,-1286.14 9091.75,-1292.24"/>
</g>
<!-- lot_io.lot_json_path -->
<g id="node48" class="node">
<title>lot_io.lot_json_path</title>
<g id="a_node48"><a xlink:title="Return full JSON path for ``lot_id`` given ``root`` directory.">
<polygon fill="none" stroke="black" points="8335.5,-4042.2 8182.5,-4042.2 8182.5,-4006.2 8335.5,-4006.2 8335.5,-4042.2"/>
<text text-anchor="middle" x="8259" y="-4020.5" font-family="Times,serif" font-size="14.00">lot_io.lot_json_path</text>
</a>
</g>
</g>
<!-- similar_utils._save_similar&#45;&gt;lot_io.lot_json_path -->
<g id="edge47" class="edge">
<title>similar_utils._save_similar&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M7303.65,-1056.18C7410.81,-1040.76 7586.16,-1035.17 7678,-1139.2 7723.56,-1190.81 7682.73,-3555.88 7714,-3617.2 7819.53,-3824.18 8084.69,-3953.59 8201.39,-4002.27"/>
<polygon fill="black" stroke="black" points="8200.29,-4005.61 8210.87,-4006.19 8202.96,-3999.14 8200.29,-4005.61"/>
</g>
<!-- lot_io.lot_json_path&#45;&gt;lot_io.parse_lot_id -->
<g id="edge260" class="edge">
<title>lot_io.lot_json_path&#45;&gt;lot_io.parse_lot_id</title>
<path fill="none" stroke="black" d="M8335.65,-4020.92C8483.77,-4014.48 8813.76,-4000.13 8999.78,-3992.04"/>
<polygon fill="black" stroke="black" points="9000.06,-3995.53 9009.9,-3991.6 8999.76,-3988.54 9000.06,-3995.53"/>
</g>
<!-- similar_utils._update_reciprocal -->
<g id="node49" class="node">
<title>similar_utils._update_reciprocal</title>
<g id="a_node49"><a xlink:title="Insert ``lot_id`` into caches of lots listed in ``sims`` if closer.">
<polygon fill="none" stroke="black" points="8500,-246.2 8018,-246.2 8018,-206.2 8500,-206.2 8500,-246.2"/>
<text text-anchor="middle" x="8259" y="-219.13" font-family="Times,serif" font-size="28.84">similar_utils._update_reciprocal</text>
</a>
</g>
</g>
<!-- similar_utils._prune_similar -->
<g id="node50" class="node">
<title>similar_utils._prune_similar</title>
<g id="a_node50"><a xlink:title="Drop cache entries referring to ids not in ``valid_ids``.">
<polygon fill="none" stroke="black" points="6348,-814.2 6070,-814.2 6070,-778.2 6348,-778.2 6348,-814.2"/>
<text text-anchor="middle" x="6209" y="-791.42" font-family="Times,serif" font-size="18.48">similar_utils._prune_similar</text>
</a>
</g>
</g>
<!-- similar_utils._calc_similar_nn -->
<g id="node51" class="node">
<title>similar_utils._calc_similar_nn</title>
<g id="a_node51"><a xlink:title="Fill ``sim_map`` for ``new_ids`` using a nearest neighbour search.&#10;&#10;``vec_ids`` lists all lots that have an embedding. &#160;``new_ids`` is a subset&#10;for which we still need recommendations. &#160;We gather vectors for&#10;``vec_ids`` and use ``NearestNeighbors`` from scikit&#45;learn to find the&#10;closest items. &#160;Embeddings of lots without a vector are skipped.">
<polygon fill="none" stroke="black" points="7669,-268.7 6755,-268.7 6755,-193.7 7669,-193.7 7669,-268.7"/>
<text text-anchor="middle" x="7212" y="-216.21" font-family="Times,serif" font-size="60.62">similar_utils._calc_similar_nn</text>
</a>
</g>
</g>
<!-- similar_utils._calc_similar_nn&#45;&gt;similar_utils._update_reciprocal -->
<g id="edge48" class="edge">
<title>similar_utils._calc_similar_nn&#45;&gt;similar_utils._update_reciprocal</title>
<path fill="none" stroke="black" d="M7669.07,-229.02C7785.29,-228.47 7905.97,-227.89 8007.6,-227.4"/>
<polygon fill="black" stroke="black" points="8007.7,-230.9 8017.68,-227.35 8007.67,-223.9 8007.7,-230.9"/>
</g>
<!-- similar_utils._sync_embeddings -->
<g id="node52" class="node">
<title>similar_utils._sync_embeddings</title>
<g id="a_node52"><a xlink:title="Drop lots or vectors that do not match and return cleaned data.">
<polygon fill="none" stroke="black" points="8497.5,-700.2 8020.5,-700.2 8020.5,-660.2 8497.5,-660.2 8497.5,-700.2"/>
<text text-anchor="middle" x="8259" y="-673.13" font-family="Times,serif" font-size="28.84">similar_utils._sync_embeddings</text>
</a>
</g>
</g>
<!-- similar_utils._similar_by_user -->
<g id="node53" class="node">
<title>similar_utils._similar_by_user</title>
<g id="a_node53"><a xlink:title="Return map of lot id to other lots from the same user.">
<polygon fill="none" stroke="black" points="6517.5,-3636.2 5900.5,-3636.2 5900.5,-3584.2 6517.5,-3584.2 6517.5,-3636.2"/>
<text text-anchor="middle" x="6209" y="-3600.06" font-family="Times,serif" font-size="40.18">similar_utils._similar_by_user</text>
</a>
</g>
</g>
<!-- similar_utils._similar_by_user&#45;&gt;similar_utils._cos_sim -->
<g id="edge49" class="edge">
<title>similar_utils._similar_by_user&#45;&gt;similar_utils._cos_sim</title>
<path fill="none" stroke="black" d="M6517.82,-3626.81C6708.74,-3637.11 6943.8,-3649.79 7085.3,-3657.42"/>
<polygon fill="black" stroke="black" points="7085.15,-3660.92 7095.32,-3657.96 7085.53,-3653.93 7085.15,-3660.92"/>
</g>
<!-- price_utils.canonical_currency -->
<g id="node54" class="node">
<title>price_utils.canonical_currency</title>
<g id="a_node54"><a xlink:title="Return canonical currency code or ``None`` when unknown.">
<polygon fill="none" stroke="black" points="9314.5,-177.2 8955.5,-177.2 8955.5,-141.2 9314.5,-141.2 9314.5,-177.2"/>
<text text-anchor="middle" x="9135" y="-153.51" font-family="Times,serif" font-size="22.12">price_utils.canonical_currency</text>
</a>
</g>
</g>
<!-- price_utils.fetch_official_rates -->
<g id="node55" class="node">
<title>price_utils.fetch_official_rates</title>
<g id="a_node55"><a xlink:title="Return currency multipliers relative to USD from NBG.">
<polygon fill="none" stroke="black" points="7529.5,-999.7 6894.5,-999.7 6894.5,-946.7 7529.5,-946.7 7529.5,-999.7"/>
<text text-anchor="middle" x="7212" y="-963" font-family="Times,serif" font-size="40.88">price_utils.fetch_official_rates</text>
</a>
</g>
</g>
<!-- price_utils.train_price_regression -->
<g id="node56" class="node">
<title>price_utils.train_price_regression</title>
<g id="a_node56"><a xlink:title="Return ``(model, currency_map, counts)`` trained on ``lots``.&#10;&#10;``lots`` must contain ``price`` and ``price:currency`` fields. Only lots with&#10;embeddings present in ``id_to_vec`` are considered. Prices are regressed on&#10;the logarithm scale so coefficients are interpretable as multiplicative&#10;factors. ``USD`` is treated as the base currency so coefficients can be&#10;interpreted as exchange rate multipliers. The returned ``counts`` dictionary&#10;maps each currency to the number of training samples observed.">
<polygon fill="none" stroke="black" points="8804,-341.7 7714,-341.7 7714,-264.7 8804,-264.7 8804,-341.7"/>
<text text-anchor="middle" x="8259" y="-287.3" font-family="Times,serif" font-size="63.00">price_utils.train_price_regression</text>
</a>
</g>
</g>
<!-- price_utils.train_price_regression&#45;&gt;price_utils.canonical_currency -->
<g id="edge50" class="edge">
<title>price_utils.train_price_regression&#45;&gt;price_utils.canonical_currency</title>
<path fill="none" stroke="black" d="M8748.85,-264.67C8767.51,-261.74 8785.95,-258.59 8804,-255.2 8900.08,-237.17 9008.34,-202.9 9073.84,-180.56"/>
<polygon fill="black" stroke="black" points="9075.26,-183.77 9083.59,-177.22 9072.99,-177.15 9075.26,-183.77"/>
</g>
<!-- price_utils.predict_price -->
<g id="node57" class="node">
<title>price_utils.predict_price</title>
<g id="a_node57"><a xlink:title="Return predicted price for ``vec`` in ``currency``.&#10;&#10;When ``model`` is ``None`` or ``vec`` is missing, ``None`` is returned.">
<polygon fill="none" stroke="black" points="8464,-441.7 8054,-441.7 8054,-398.7 8464,-398.7 8464,-441.7"/>
<text text-anchor="middle" x="8259" y="-412.06" font-family="Times,serif" font-size="32.06">price_utils.predict_price</text>
</a>
</g>
</g>
<!-- price_utils.currency_rates -->
<g id="node58" class="node">
<title>price_utils.currency_rates</title>
<g id="a_node58"><a xlink:title="Return estimated currency multipliers relative to the base.&#10;&#10;The regression model learns one coefficient per currency dummy feature. &#160;The&#10;coefficient is the logarithm of the multiplier relative to USD.">
<polygon fill="none" stroke="black" points="9328.5,-389.7 8941.5,-389.7 8941.5,-350.7 9328.5,-350.7 9328.5,-389.7"/>
<text text-anchor="middle" x="9135" y="-363.3" font-family="Times,serif" font-size="28.00">price_utils.currency_rates</text>
</a>
</g>
</g>
<!-- price_utils.guess_currency -->
<g id="node59" class="node">
<title>price_utils.guess_currency</title>
<g id="a_node59"><a xlink:title="Return currency with multiplier closest to ``price/pred_usd``.&#10;&#10;``pred_usd`` is the predicted price in USD. &#160;``price`` is the numeric value&#10;provided by the user without a currency. &#160;The function compares the implied&#10;multiplier ``price / pred_usd`` against the learnt exchange rates and picks&#10;the closest match. &#160;``counts`` may be provided to ignore rarely seen&#10;currencies when guessing. &#160;Any currency with fewer than ``min_samples``&#10;samples in the training set is skipped.">
<polygon fill="none" stroke="black" points="8526.5,-510.2 7991.5,-510.2 7991.5,-460.2 8526.5,-460.2 8526.5,-510.2"/>
<text text-anchor="middle" x="8259" y="-475.52" font-family="Times,serif" font-size="38.36">price_utils.guess_currency</text>
</a>
</g>
</g>
<!-- price_utils._guess_currency_verified -->
<g id="node60" class="node">
<title>price_utils._guess_currency_verified</title>
<g id="a_node60"><a xlink:title="Return currency when both AI and official rates agree.">
<polygon fill="none" stroke="black" points="7468.5,-474.2 6955.5,-474.2 6955.5,-436.2 7468.5,-436.2 7468.5,-474.2"/>
<text text-anchor="middle" x="7212" y="-448.48" font-family="Times,serif" font-size="27.16">price_utils._guess_currency_verified</text>
</a>
</g>
</g>
<!-- price_utils._guess_currency_verified&#45;&gt;price_utils.guess_currency -->
<g id="edge51" class="edge">
<title>price_utils._guess_currency_verified&#45;&gt;price_utils.guess_currency</title>
<path fill="none" stroke="black" d="M7468.64,-462.54C7623.84,-467 7821.99,-472.69 7980.93,-477.25"/>
<polygon fill="black" stroke="black" points="7981.25,-480.76 7991.34,-477.55 7981.45,-473.76 7981.25,-480.76"/>
</g>
<!-- price_utils.apply_price_model -->
<g id="node61" class="node">
<title>price_utils.apply_price_model</title>
<g id="a_node61"><a xlink:title="Predict prices in USD and guess missing currencies.">
<polygon fill="none" stroke="black" points="6524,-434.7 5894,-434.7 5894,-381.7 6524,-381.7 6524,-434.7"/>
<text text-anchor="middle" x="6209" y="-398" font-family="Times,serif" font-size="40.88">price_utils.apply_price_model</text>
</a>
</g>
</g>
<!-- price_utils.apply_price_model&#45;&gt;price_utils.train_price_regression -->
<g id="edge52" class="edge">
<title>price_utils.apply_price_model&#45;&gt;price_utils.train_price_regression</title>
<path fill="none" stroke="black" d="M6450.55,-381.68C6542.84,-372.34 6649.21,-362.59 6746,-356.2 7062.81,-335.3 7417.55,-322.32 7703.76,-314.45"/>
<polygon fill="black" stroke="black" points="7704.01,-317.94 7713.91,-314.17 7703.82,-310.94 7704.01,-317.94"/>
</g>
<!-- price_utils.apply_price_model&#45;&gt;price_utils.predict_price -->
<g id="edge53" class="edge">
<title>price_utils.apply_price_model&#45;&gt;price_utils.predict_price</title>
<path fill="none" stroke="black" d="M6524.11,-410.05C6945.06,-412.51 7681.12,-416.82 8043.71,-418.95"/>
<polygon fill="black" stroke="black" points="8043.78,-422.45 8053.8,-419.01 8043.82,-415.45 8043.78,-422.45"/>
</g>
<!-- price_utils.apply_price_model&#45;&gt;price_utils.currency_rates -->
<g id="edge54" class="edge">
<title>price_utils.apply_price_model&#45;&gt;price_utils.currency_rates</title>
<path fill="none" stroke="black" d="M6524.31,-404.12C7126.75,-396.29 8428.76,-379.37 8930.83,-372.85"/>
<polygon fill="black" stroke="black" points="8931.13,-376.34 8941.08,-372.71 8931.04,-369.34 8931.13,-376.34"/>
</g>
<!-- price_utils.apply_price_model&#45;&gt;price_utils._guess_currency_verified -->
<g id="edge55" class="edge">
<title>price_utils.apply_price_model&#45;&gt;price_utils._guess_currency_verified</title>
<path fill="none" stroke="black" d="M6524.32,-422.96C6659.53,-429.31 6815.89,-436.65 6945.22,-442.73"/>
<polygon fill="black" stroke="black" points="6945.11,-446.22 6955.27,-443.2 6945.44,-439.23 6945.11,-446.22"/>
</g>
<!-- price_utils.prepare_price_fields -->
<g id="node62" class="node">
<title>price_utils.prepare_price_fields</title>
<g id="a_node62"><a xlink:title="Add display price helpers to ``lots``.&#10;&#10;``rates`` maps currency codes to multipliers relative to USD and&#10;``cur`` is the display currency. ``_display_price`` is a formatted&#10;string in ``cur``. ``_usd_value`` stores the numeric USD value so&#10;the front&#45;end can switch currencies without rebuilding the site.&#10;Prices predicted by AI get ``_price_class`` set to ``ai&#45;price`` for&#10;styling.">
<polygon fill="none" stroke="black" points="8629,-188.2 7889,-188.2 7889,-130.2 8629,-130.2 8629,-188.2"/>
<text text-anchor="middle" x="8259" y="-147.92" font-family="Times,serif" font-size="45.36">price_utils.prepare_price_fields</text>
</a>
</g>
</g>
<!-- price_utils.prepare_price_fields&#45;&gt;price_utils.canonical_currency -->
<g id="edge56" class="edge">
<title>price_utils.prepare_price_fields&#45;&gt;price_utils.canonical_currency</title>
<path fill="none" stroke="black" d="M8629.07,-159.2C8738,-159.2 8852.7,-159.2 8945.21,-159.2"/>
<polygon fill="black" stroke="black" points="8945.23,-162.7 8955.23,-159.2 8945.23,-155.7 8945.23,-162.7"/>
</g>
<!-- embed.embed_file -->
<g id="node63" class="node">
<title>embed.embed_file</title>
<g id="a_node63"><a xlink:title="Embed ``path`` and write the result beside it under ``EMBED_DIR``.">
<polygon fill="none" stroke="black" points="7417,-1203.7 7007,-1203.7 7007,-1148.7 7417,-1148.7 7417,-1203.7"/>
<text text-anchor="middle" x="7212" y="-1165.66" font-family="Times,serif" font-size="42.56">embed.embed_file</text>
</a>
</g>
</g>
<!-- embed.embed_file&#45;&gt;lot_io.read_lots -->
<g id="edge58" class="edge">
<title>embed.embed_file&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M7348.65,-1203.71C7457.02,-1233.35 7602.78,-1292.08 7678,-1403.2 7739.08,-1493.44 7637.16,-1814.95 7714,-1892.2 7837.83,-2016.7 8067.51,-1983.47 8184.86,-1955.64"/>
<polygon fill="black" stroke="black" points="8185.94,-1958.98 8194.83,-1953.22 8184.29,-1952.17 8185.94,-1958.98"/>
</g>
<!-- embed.embed_file&#45;&gt;notes_utils.write_json -->
<g id="edge57" class="edge">
<title>embed.embed_file&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M7417.12,-1164.23C7501.43,-1166.86 7597.96,-1180.07 7678,-1218.2 7698.71,-1228.07 7693.04,-1245.86 7714,-1255.2 7824.71,-1304.55 8682.9,-1293.25 8804,-1298.2 8879.87,-1301.31 8965.54,-1304.95 9030.58,-1307.74"/>
<polygon fill="black" stroke="black" points="9030.69,-1311.25 9040.83,-1308.18 9030.99,-1304.25 9030.69,-1311.25"/>
</g>
<!-- lot_io.make_lot_id -->
<g id="node64" class="node">
<title>lot_io.make_lot_id</title>
<g id="a_node64"><a xlink:title="Return lot id string for ``rel`` and ``index``.&#10;&#10;``rel`` is the JSON file path relative to the ``data/lots`` directory&#10;without the ``.json`` suffix.">
<polygon fill="none" stroke="black" points="8351.5,-1192.2 8166.5,-1192.2 8166.5,-1156.2 8351.5,-1156.2 8351.5,-1192.2"/>
<text text-anchor="middle" x="8259" y="-1169.42" font-family="Times,serif" font-size="18.48">lot_io.make_lot_id</text>
</a>
</g>
</g>
<!-- embed.embed_file&#45;&gt;lot_io.make_lot_id -->
<g id="edge59" class="edge">
<title>embed.embed_file&#45;&gt;lot_io.make_lot_id</title>
<path fill="none" stroke="black" d="M7417.28,-1175.81C7639.53,-1175.39 7985.85,-1174.73 8156.27,-1174.4"/>
<polygon fill="black" stroke="black" points="8156.49,-1177.9 8166.49,-1174.38 8156.48,-1170.9 8156.49,-1177.9"/>
</g>
<!-- embed.main -->
<g id="node65" class="node">
<title>embed.main</title>
<g id="a_node65"><a xlink:title="Embed the file given on the command line.">
<polygon fill="none" stroke="black" points="6297,-1194.2 6121,-1194.2 6121,-1158.2 6297,-1158.2 6297,-1194.2"/>
<text text-anchor="middle" x="6209" y="-1170.04" font-family="Times,serif" font-size="25.20">embed.main</text>
</a>
</g>
</g>
<!-- embed.main&#45;&gt;embed.embed_file -->
<g id="edge60" class="edge">
<title>embed.main&#45;&gt;embed.embed_file</title>
<path fill="none" stroke="black" d="M6297.08,-1176.2C6451.71,-1176.2 6778.43,-1176.2 6996.36,-1176.2"/>
<polygon fill="black" stroke="black" points="6996.65,-1179.7 7006.65,-1176.2 6996.65,-1172.7 6996.65,-1179.7"/>
</g>
<!-- chop.has_misc_deal -->
<g id="node66" class="node">
<title>chop.has_misc_deal</title>
<g id="a_node66"><a xlink:title="Return True when any lot is classified as misc or announcement.">
<polygon fill="none" stroke="black" points="8373,-1414.2 8145,-1414.2 8145,-1378.2 8373,-1378.2 8373,-1414.2"/>
<text text-anchor="middle" x="8259" y="-1390.9" font-family="Times,serif" font-size="21.00">chop.has_misc_deal</text>
</a>
</g>
</g>
<!-- chop.process_message -->
<g id="node67" class="node">
<title>chop.process_message</title>
<g id="a_node67"><a xlink:title="Extract lots from ``msg_path`` and save them under ``LOTS_DIR``.">
<polygon fill="none" stroke="black" points="6710,-1502.2 5708,-1502.2 5708,-1400.2 6710,-1400.2 6710,-1502.2"/>
<text text-anchor="middle" x="6209" y="-1429.88" font-family="Times,serif" font-size="85.40">chop.process_message</text>
</a>
</g>
</g>
<!-- chop.process_message&#45;&gt;moderation.should_skip_message -->
<g id="edge61" class="edge">
<title>chop.process_message&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M6710.08,-1466.38C7120.89,-1481.12 7641.13,-1505.97 7678,-1538.2 7740.74,-1593.05 7652.62,-1665.84 7714,-1722.2 7836.51,-1834.7 8045.89,-1820.92 8166.02,-1800.97"/>
<polygon fill="black" stroke="black" points="8166.67,-1804.41 8175.93,-1799.27 8165.49,-1797.51 8166.67,-1804.41"/>
</g>
<!-- chop.process_message&#45;&gt;post_io.read_post -->
<g id="edge70" class="edge">
<title>chop.process_message&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M6349.92,-1502.29C6465.26,-1551.9 6623.46,-1638.69 6710,-1767.2 6760.45,-1842.12 6679.29,-1906.32 6746,-1967.2 6822.78,-2037.27 7575.18,-2032.98 7678,-2048.2 7818.94,-2069.07 7977.1,-2103.06 8092.61,-2129.87"/>
<polygon fill="black" stroke="black" points="8092.07,-2133.33 8102.6,-2132.19 8093.66,-2126.52 8092.07,-2133.33"/>
</g>
<!-- chop.process_message&#45;&gt;caption_io.has_caption -->
<g id="edge66" class="edge">
<title>chop.process_message&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M6362.79,-1502.23C6480.48,-1550.44 6635.3,-1635.29 6710,-1767.2 6752.22,-1841.77 6687.43,-3246.66 6746,-3309.2 6795.08,-3361.62 7856.64,-3422.64 8171.03,-3439.62"/>
<polygon fill="black" stroke="black" points="8171.27,-3443.14 8181.45,-3440.18 8171.65,-3436.15 8171.27,-3443.14"/>
</g>
<!-- chop.process_message&#45;&gt;token_utils.estimate_tokens -->
<g id="edge62" class="edge">
<title>chop.process_message&#45;&gt;token_utils.estimate_tokens</title>
<path fill="none" stroke="black" d="M6710.13,-1440.71C6848.75,-1437.8 6987.41,-1434.9 7083.57,-1432.88"/>
<polygon fill="black" stroke="black" points="7083.69,-1436.38 7093.62,-1432.67 7083.55,-1429.38 7083.69,-1436.38"/>
</g>
<!-- chop.process_message&#45;&gt;embed.embed_file -->
<g id="edge63" class="edge">
<title>chop.process_message&#45;&gt;embed.embed_file</title>
<path fill="none" stroke="black" d="M6395.64,-1400.2C6602.75,-1343.31 6930.98,-1253.13 7100.92,-1206.45"/>
<polygon fill="black" stroke="black" points="7101.92,-1209.8 7110.64,-1203.78 7100.07,-1203.05 7101.92,-1209.8"/>
</g>
<!-- chop.process_message&#45;&gt;chop.has_misc_deal -->
<g id="edge64" class="edge">
<title>chop.process_message&#45;&gt;chop.has_misc_deal</title>
<path fill="none" stroke="black" d="M6493.88,-1400.2C6575.03,-1387.82 6663.77,-1376.38 6746,-1370.2 7159.06,-1339.17 7263.88,-1360.93 7678,-1370.2 7835.77,-1373.74 8017.49,-1382.67 8134.87,-1389.08"/>
<polygon fill="black" stroke="black" points="8134.79,-1392.58 8144.96,-1389.64 8135.17,-1385.59 8134.79,-1392.58"/>
</g>
<!-- message_utils.build_prompt -->
<g id="node68" class="node">
<title>message_utils.build_prompt</title>
<g id="a_node68"><a xlink:title="Return prompt combining message text with captioned file names.">
<polygon fill="none" stroke="black" points="8408.5,-1713.2 8109.5,-1713.2 8109.5,-1677.2 8408.5,-1677.2 8408.5,-1713.2"/>
<text text-anchor="middle" x="8259" y="-1690.41" font-family="Times,serif" font-size="19.74">message_utils.build_prompt</text>
</a>
</g>
</g>
<!-- chop.process_message&#45;&gt;message_utils.build_prompt -->
<g id="edge65" class="edge">
<title>chop.process_message&#45;&gt;message_utils.build_prompt</title>
<path fill="none" stroke="black" d="M6710.27,-1404.97C6722.29,-1404.32 6734.22,-1403.73 6746,-1403.2 6849.45,-1398.58 7598.58,-1336.75 7678,-1403.2 7747.6,-1461.45 7649.46,-1540.4 7714,-1604.2 7813.68,-1702.75 7977.24,-1718.35 8099.03,-1713.64"/>
<polygon fill="black" stroke="black" points="8099.36,-1717.13 8109.2,-1713.2 8099.05,-1710.14 8099.36,-1717.13"/>
</g>
<!-- caption_io.read_caption -->
<g id="node69" class="node">
<title>caption_io.read_caption</title>
<g id="a_node69"><a xlink:title="Return caption for ``image`` in ``lang`` or empty string when missing.">
<polygon fill="none" stroke="black" points="8424.5,-2409.7 8093.5,-2409.7 8093.5,-2372.7 8424.5,-2372.7 8424.5,-2409.7"/>
<text text-anchor="middle" x="8259" y="-2384.76" font-family="Times,serif" font-size="26.18">caption_io.read_caption</text>
</a>
</g>
</g>
<!-- chop.process_message&#45;&gt;caption_io.read_caption -->
<g id="edge67" class="edge">
<title>chop.process_message&#45;&gt;caption_io.read_caption</title>
<path fill="none" stroke="black" d="M6356.66,-1502.28C6473.25,-1551.13 6629.65,-1636.84 6710,-1767.2 6753.11,-1837.15 6691.91,-2073.35 6746,-2135.2 6918.88,-2332.91 7723.31,-2377.93 8083.19,-2388.18"/>
<polygon fill="black" stroke="black" points="8083.35,-2391.69 8093.44,-2388.47 8083.54,-2384.69 8083.35,-2391.69"/>
</g>
<!-- lot_io.valid_lots -->
<g id="node70" class="node">
<title>lot_io.valid_lots</title>
<g id="a_node70"><a xlink:title="Return ``True`` when every lot contains the required translations.">
<polygon fill="none" stroke="black" points="9237,-806.2 9033,-806.2 9033,-770.2 9237,-770.2 9237,-806.2"/>
<text text-anchor="middle" x="9135" y="-782.33" font-family="Times,serif" font-size="24.22">lot_io.valid_lots</text>
</a>
</g>
</g>
<!-- chop.process_message&#45;&gt;lot_io.valid_lots -->
<g id="edge68" class="edge">
<title>chop.process_message&#45;&gt;lot_io.valid_lots</title>
<path fill="none" stroke="black" d="M6417.13,-1400.16C6522.12,-1363.23 6641.56,-1301.96 6710,-1203.2 6754.91,-1138.39 6688.17,-903.81 6746,-850.2 6830.35,-772.01 8562.21,-782.78 9022.48,-787.05"/>
<polygon fill="black" stroke="black" points="9022.76,-790.55 9032.79,-787.14 9022.82,-783.55 9022.76,-790.55"/>
</g>
<!-- lot_io.needs_cleanup -->
<g id="node71" class="node">
<title>lot_io.needs_cleanup</title>
<g id="a_node71"><a xlink:title="Return ``True`` when ``clean_data`` would drop ``lots``.">
<polygon fill="none" stroke="black" points="8348.5,-2584.2 8169.5,-2584.2 8169.5,-2548.2 8348.5,-2548.2 8348.5,-2584.2"/>
<text text-anchor="middle" x="8259" y="-2562.16" font-family="Times,serif" font-size="15.68">lot_io.needs_cleanup</text>
</a>
</g>
</g>
<!-- chop.process_message&#45;&gt;lot_io.needs_cleanup -->
<g id="edge69" class="edge">
<title>chop.process_message&#45;&gt;lot_io.needs_cleanup</title>
<path fill="none" stroke="black" d="M6358.71,-1502.25C6475.68,-1550.86 6631.58,-1636.27 6710,-1767.2 6767.01,-1862.39 6672.07,-2182.46 6746,-2265.2 7026.75,-2579.43 7357.05,-2166.17 7678,-2439.2 7713.98,-2469.81 7676.04,-2511.09 7714,-2539.2 7782.16,-2589.68 8021.91,-2582.67 8159.31,-2573.96"/>
<polygon fill="black" stroke="black" points="8159.67,-2577.44 8169.43,-2573.3 8159.22,-2570.46 8159.67,-2577.44"/>
</g>
<!-- caption_io.read_caption&#45;&gt;notes_utils.load_json -->
<g id="edge151" class="edge">
<title>caption_io.read_caption&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M8424.61,-2376.98C8564.75,-2368.81 8751.47,-2368.6 8804,-2419.2 8869.07,-2481.89 8815.42,-2737.26 8840,-2824.2 8905.64,-3056.44 9062.63,-3306.41 9115.93,-3387.32"/>
<polygon fill="black" stroke="black" points="9113.18,-3389.5 9121.62,-3395.91 9119.02,-3385.64 9113.18,-3389.5"/>
</g>
<!-- caption_io.read_caption&#45;&gt;caption_io.caption_json_path -->
<g id="edge153" class="edge">
<title>caption_io.read_caption&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M8424.57,-2376.36C8565.23,-2367.71 8752.76,-2367.13 8804,-2419.2 8883.69,-2500.2 8788.75,-3339.79 8840,-3441.2 8892.39,-3544.88 9014.49,-3617.19 9083.73,-3651.52"/>
<polygon fill="black" stroke="black" points="9082.62,-3654.87 9093.14,-3656.11 9085.69,-3648.58 9082.62,-3654.87"/>
</g>
<!-- caption_io.read_caption&#45;&gt;caption_io.caption_md_path -->
<g id="edge154" class="edge">
<title>caption_io.read_caption&#45;&gt;caption_io.caption_md_path</title>
<path fill="none" stroke="black" d="M8391.23,-2372.69C8505.28,-2362.37 8672.39,-2361.4 8804,-2419.2 8953.9,-2485.04 9074.37,-2651.56 9117.19,-2716.6"/>
<polygon fill="black" stroke="black" points="9114.32,-2718.61 9122.71,-2725.08 9120.19,-2714.79 9114.32,-2718.61"/>
</g>
<!-- caption_io.read_caption&#45;&gt;notes_utils.read_md -->
<g id="edge150" class="edge">
<title>caption_io.read_caption&#45;&gt;notes_utils.read_md</title>
<path fill="none" stroke="black" d="M8424.65,-2385.93C8612.71,-2379.91 8912.67,-2370.3 9054.6,-2365.75"/>
<polygon fill="black" stroke="black" points="9055.08,-2369.24 9064.96,-2365.42 9054.85,-2362.24 9055.08,-2369.24"/>
</g>
<!-- caption_io.read_caption&#45;&gt;caption_io._get_langs -->
<g id="edge152" class="edge">
<title>caption_io.read_caption&#45;&gt;caption_io._get_langs</title>
<path fill="none" stroke="black" d="M8424.79,-2377.13C8564.78,-2369.1 8751.18,-2369 8804,-2419.2 8860.83,-2473.22 8784.26,-2715.06 8840,-2770.2 8891.36,-2821.02 8975.3,-2824.06 9040.36,-2816.53"/>
<polygon fill="black" stroke="black" points="9041.15,-2819.96 9050.64,-2815.24 9040.28,-2813.02 9041.15,-2819.96"/>
</g>
<!-- chop.main -->
<g id="node72" class="node">
<title>chop.main</title>
<g id="a_node72"><a xlink:title="Process a single message file passed on the command line.">
<polygon fill="none" stroke="black" points="5472,-1469.2 5321,-1469.2 5321,-1433.2 5472,-1433.2 5472,-1469.2"/>
<text text-anchor="middle" x="5396.5" y="-1445.04" font-family="Times,serif" font-size="25.20">chop.main</text>
</a>
</g>
</g>
<!-- chop.main&#45;&gt;chop.process_message -->
<g id="edge71" class="edge">
<title>chop.main&#45;&gt;chop.process_message</title>
<path fill="none" stroke="black" d="M5472.3,-1451.2C5527.86,-1451.2 5609.07,-1451.2 5697.46,-1451.2"/>
<polygon fill="black" stroke="black" points="5697.71,-1454.7 5707.71,-1451.2 5697.71,-1447.7 5697.71,-1454.7"/>
</g>
<!-- debug_dump.parse_url -->
<g id="node73" class="node">
<title>debug_dump.parse_url</title>
<g id="a_node73"><a xlink:title="Return ``(lot_id, lang)`` extracted from ``url``.">
<polygon fill="none" stroke="black" points="7361.5,-4381.2 7062.5,-4381.2 7062.5,-4345.2 7361.5,-4345.2 7361.5,-4381.2"/>
<text text-anchor="middle" x="7212" y="-4357.33" font-family="Times,serif" font-size="24.22">debug_dump.parse_url</text>
</a>
</g>
</g>
<!-- debug_dump.guess_source_from_lot -->
<g id="node74" class="node">
<title>debug_dump.guess_source_from_lot</title>
<g id="a_node74"><a xlink:title="Guess ``(chat, message_id)`` directly from ``lot_id``.">
<polygon fill="none" stroke="black" points="8480,-4482.2 8038,-4482.2 8038,-4446.2 8480,-4446.2 8480,-4482.2"/>
<text text-anchor="middle" x="8259" y="-4458.61" font-family="Times,serif" font-size="23.24">debug_dump.guess_source_from_lot</text>
</a>
</g>
</g>
<!-- debug_dump.load_source_info -->
<g id="node75" class="node">
<title>debug_dump.load_source_info</title>
<g id="a_node75"><a xlink:title="Return ``(chat, message_id)`` for ``lot_id`` if available.">
<polygon fill="none" stroke="black" points="7466,-4246.7 6958,-4246.7 6958,-4203.7 7466,-4203.7 7466,-4246.7"/>
<text text-anchor="middle" x="7212" y="-4217.06" font-family="Times,serif" font-size="32.06">debug_dump.load_source_info</text>
</a>
</g>
</g>
<!-- debug_dump.load_source_info&#45;&gt;notes_utils.load_json -->
<g id="edge72" class="edge">
<title>debug_dump.load_source_info&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M7466.13,-4232.43C7555.92,-4230.02 7643.31,-4220.35 7678,-4194.2 7715.72,-4165.77 7675.9,-4122.12 7714,-4094.2 7811.77,-4022.57 8716.2,-4134.76 8804,-4051.2 8869.29,-3989.07 8797.2,-3726.53 8840,-3647.2 8895.38,-3544.56 9017.14,-3471.51 9085.32,-3436.87"/>
<polygon fill="black" stroke="black" points="9087.19,-3439.85 9094.57,-3432.24 9084.06,-3433.59 9087.19,-3439.85"/>
</g>
<!-- debug_dump.load_source_info&#45;&gt;lot_io.lot_json_path -->
<g id="edge73" class="edge">
<title>debug_dump.load_source_info&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M7466.11,-4234.02C7556.52,-4231.9 7644.37,-4222.02 7678,-4194.2 7726.84,-4153.8 7665,-4096.41 7714,-4056.2 7781.76,-4000.6 8036.44,-4008.73 8171.94,-4017.46"/>
<polygon fill="black" stroke="black" points="8172.08,-4020.97 8182.28,-4018.14 8172.54,-4013.99 8172.08,-4020.97"/>
</g>
<!-- debug_dump.run_tg_fetch -->
<g id="node76" class="node">
<title>debug_dump.run_tg_fetch</title>
<g id="a_node76"><a xlink:title="Run ``tg_client.py &#45;&#45;fetch`` and return combined logs.">
<polygon fill="none" stroke="black" points="9361,-4371.2 8909,-4371.2 8909,-4327.2 9361,-4327.2 9361,-4371.2"/>
<text text-anchor="middle" x="9135" y="-4340.88" font-family="Times,serif" font-size="32.90">debug_dump.run_tg_fetch</text>
</a>
</g>
</g>
<!-- debug_dump.run_tg_fetch&#45;&gt;notes_utils.read_text -->
<g id="edge74" class="edge">
<title>debug_dump.run_tg_fetch&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M9361.06,-4348.31C9385.56,-4341.7 9409.14,-4332.02 9430,-4318.2 9587.97,-4213.58 9656.12,-3974.51 9675.42,-3892.46"/>
<polygon fill="black" stroke="black" points="9678.85,-3893.13 9677.68,-3882.6 9672.03,-3891.57 9678.85,-3893.13"/>
</g>
<!-- debug_dump.collect_files -->
<g id="node77" class="node">
<title>debug_dump.collect_files</title>
<g id="a_node77"><a xlink:title="Return ``[(name, content), ...]`` for files related to ``lot_id``.">
<polygon fill="none" stroke="black" points="7459,-4031.7 6965,-4031.7 6965,-3982.7 7459,-3982.7 7459,-4031.7"/>
<text text-anchor="middle" x="7212" y="-3998.02" font-family="Times,serif" font-size="37.10">debug_dump.collect_files</text>
</a>
</g>
</g>
<!-- debug_dump.collect_files&#45;&gt;post_io.raw_post_path -->
<g id="edge81" class="edge">
<title>debug_dump.collect_files&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7459.03,-4026C7539.72,-4018.74 7622.76,-3994.42 7678,-3934.2 7755.85,-3849.34 7633.55,-3499.61 7714,-3417.2 7835.34,-3292.93 8061.4,-3320.34 8180.31,-3346.02"/>
<polygon fill="black" stroke="black" points="8179.56,-3349.44 8190.07,-3348.18 8181.07,-3342.61 8179.56,-3349.44"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;notes_utils.read_text -->
<g id="edge75" class="edge">
<title>debug_dump.collect_files&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M7459.12,-3994.55C7868.33,-3973.23 8714.42,-3927.98 9430,-3882.2 9474.18,-3879.38 9522.71,-3875.98 9565.26,-3872.89"/>
<polygon fill="black" stroke="black" points="9565.65,-3876.37 9575.37,-3872.16 9565.14,-3869.39 9565.65,-3876.37"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;notes_utils.load_json -->
<g id="edge76" class="edge">
<title>debug_dump.collect_files&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M7459.04,-4013.48C7552.81,-4010.46 7645.1,-3999.07 7678,-3968.2 7757.31,-3893.81 7635.29,-3801.23 7714,-3726.2 7890.21,-3558.25 8573.36,-3695.07 8804,-3617.2 8925.84,-3576.07 9049.75,-3483.16 9104.68,-3438.74"/>
<polygon fill="black" stroke="black" points="9107.05,-3441.33 9112.59,-3432.3 9102.62,-3435.91 9107.05,-3441.33"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;caption_io.caption_json_path -->
<g id="edge77" class="edge">
<title>debug_dump.collect_files&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M7367.7,-4031.72C7465.21,-4038.71 7589.05,-4031.14 7678,-3968.2 7709.83,-3945.68 7682.91,-3911.73 7714,-3888.2 7909.28,-3740.45 8561.94,-3763.26 8804,-3726.2 8878.96,-3714.73 8963.44,-3701.41 9028.15,-3691.12"/>
<polygon fill="black" stroke="black" points="9029.04,-3694.53 9038.37,-3689.5 9027.94,-3687.61 9029.04,-3694.53"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;caption_io.has_caption -->
<g id="edge78" class="edge">
<title>debug_dump.collect_files&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M7459.22,-4014.67C7553.53,-4011.91 7646.17,-4000.39 7678,-3968.2 7755.85,-3889.46 7634.82,-3548.61 7714,-3471.2 7776.71,-3409.9 8034.13,-3423.26 8171.19,-3435.27"/>
<polygon fill="black" stroke="black" points="8170.97,-3438.76 8181.24,-3436.17 8171.59,-3431.79 8170.97,-3438.76"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;lot_io.lot_json_path -->
<g id="edge80" class="edge">
<title>debug_dump.collect_files&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M7459.33,-4011.21C7688.64,-4014.94 8017.53,-4020.29 8171.86,-4022.8"/>
<polygon fill="black" stroke="black" points="8172.16,-4026.31 8182.22,-4022.97 8172.28,-4019.31 8172.16,-4026.31"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;caption_io.read_caption -->
<g id="edge79" class="edge">
<title>debug_dump.collect_files&#45;&gt;caption_io.read_caption</title>
<path fill="none" stroke="black" d="M7459.07,-4027.53C7540.38,-4020.56 7623.82,-3996.06 7678,-3934.2 7733.48,-3870.88 7655.3,-2479.55 7714,-2419.2 7763.69,-2368.12 7943.46,-2367.48 8082.89,-2375.6"/>
<polygon fill="black" stroke="black" points="8083.09,-2379.12 8093.28,-2376.22 8083.51,-2372.13 8083.09,-2379.12"/>
</g>
<!-- debug_dump.delete_files -->
<g id="node78" class="node">
<title>debug_dump.delete_files</title>
<g id="a_node78"><a xlink:title="Remove files related to ``lot_id`` from the filesystem.">
<polygon fill="none" stroke="black" points="7427.5,-4094.2 6996.5,-4094.2 6996.5,-4050.2 7427.5,-4050.2 7427.5,-4094.2"/>
<text text-anchor="middle" x="7212" y="-4063.88" font-family="Times,serif" font-size="32.90">debug_dump.delete_files</text>
</a>
</g>
</g>
<!-- debug_dump.delete_files&#45;&gt;post_io.raw_post_path -->
<g id="edge86" class="edge">
<title>debug_dump.delete_files&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7427.62,-4083.9C7532.07,-4084.53 7642.65,-4075.95 7678,-4040.2 7775.52,-3941.61 7617.71,-3517 7714,-3417.2 7834.76,-3292.05 8061.58,-3320 8180.6,-3345.95"/>
<polygon fill="black" stroke="black" points="8179.86,-3349.37 8190.38,-3348.13 8181.38,-3342.54 8179.86,-3349.37"/>
</g>
<!-- debug_dump.delete_files&#45;&gt;notes_utils.load_json -->
<g id="edge82" class="edge">
<title>debug_dump.delete_files&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M7427.76,-4080.19C7530.24,-4079.56 7638.93,-4070.95 7678,-4040.2 7719.75,-4007.34 7674.79,-3962.06 7714,-3926.2 8080.04,-3591.42 8373.78,-3933.13 8804,-3686.2 8824.46,-3674.46 8822.7,-3663.25 8840,-3647.2 8929.02,-3564.64 9044.3,-3478.76 9100.39,-3438.18"/>
<polygon fill="black" stroke="black" points="9102.48,-3440.99 9108.54,-3432.3 9098.39,-3435.31 9102.48,-3440.99"/>
</g>
<!-- debug_dump.delete_files&#45;&gt;caption_io.caption_json_path -->
<g id="edge83" class="edge">
<title>debug_dump.delete_files&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M7427.6,-4092.21C7509.81,-4091.18 7602.02,-4078.92 7678,-4040.2 7700.21,-4028.89 7692.44,-4009.71 7714,-3997.2 8139.76,-3750.37 8330.16,-3935.14 8804,-3802.2 8906.71,-3773.39 9021.86,-3724.8 9085.35,-3696.5"/>
<polygon fill="black" stroke="black" points="9087.02,-3699.59 9094.72,-3692.31 9084.16,-3693.2 9087.02,-3699.59"/>
</g>
<!-- debug_dump.delete_files&#45;&gt;lot_io.lot_json_path -->
<g id="edge85" class="edge">
<title>debug_dump.delete_files&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M7427.62,-4062.35C7657.32,-4051.8 8010.42,-4035.58 8171.96,-4028.16"/>
<polygon fill="black" stroke="black" points="8172.49,-4031.64 8182.32,-4027.68 8172.17,-4024.64 8172.49,-4031.64"/>
</g>
<!-- debug_dump.delete_files&#45;&gt;caption_io.caption_md_path -->
<g id="edge84" class="edge">
<title>debug_dump.delete_files&#45;&gt;caption_io.caption_md_path</title>
<path fill="none" stroke="black" d="M7427.69,-4083.66C7531.97,-4084.19 7642.37,-4075.6 7678,-4040.2 7753.41,-3965.29 7637.33,-3636.83 7714,-3563.2 7801.41,-3479.27 8717.76,-3610.35 8804,-3525.2 8863.76,-3466.2 8781.93,-2830.88 8840,-2770.2 8891.41,-2716.49 8978.95,-2714.98 9045.17,-2723.76"/>
<polygon fill="black" stroke="black" points="9044.8,-2727.24 9055.19,-2725.18 9045.78,-2720.31 9044.8,-2727.24"/>
</g>
<!-- debug_dump._message_reason -->
<g id="node80" class="node">
<title>debug_dump._message_reason</title>
<g id="a_node80"><a xlink:title="Return explanation why a message would be skipped.">
<polygon fill="none" stroke="black" points="9407.5,-4440.7 8862.5,-4440.7 8862.5,-4395.7 9407.5,-4395.7 9407.5,-4440.7"/>
<text text-anchor="middle" x="9135" y="-4409.82" font-family="Times,serif" font-size="33.60">debug_dump._message_reason</text>
</a>
</g>
</g>
<!-- debug_dump._message_reason&#45;&gt;moderation.should_skip_user -->
<g id="edge87" class="edge">
<title>debug_dump._message_reason&#45;&gt;moderation.should_skip_user</title>
<path fill="none" stroke="black" d="M9407.55,-4418.2C9456.52,-4418.2 9505.54,-4418.2 9548.29,-4418.2"/>
<polygon fill="black" stroke="black" points="9548.45,-4421.7 9558.45,-4418.2 9548.45,-4414.7 9548.45,-4421.7"/>
</g>
<!-- debug_dump._lot_reason -->
<g id="node81" class="node">
<title>debug_dump._lot_reason</title>
<g id="a_node81"><a xlink:title="Return explanation why ``lot`` would be skipped.">
<polygon fill="none" stroke="black" points="9289,-4309.2 8981,-4309.2 8981,-4273.2 9289,-4273.2 9289,-4309.2"/>
<text text-anchor="middle" x="9135" y="-4285.61" font-family="Times,serif" font-size="23.24">debug_dump._lot_reason</text>
</a>
</g>
</g>
<!-- debug_dump.moderation_summary -->
<g id="node82" class="node">
<title>debug_dump.moderation_summary</title>
<g id="a_node82"><a xlink:title="Return a multi&#45;line summary of moderation checks for ``lot_id``.">
<polygon fill="none" stroke="black" points="7658.5,-4327.2 6765.5,-4327.2 6765.5,-4265.2 7658.5,-4265.2 7658.5,-4327.2"/>
<text text-anchor="middle" x="7212" y="-4284" font-family="Times,serif" font-size="49.00">debug_dump.moderation_summary</text>
</a>
</g>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;post_io.read_post -->
<g id="edge92" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7347.25,-4327.24C7453.09,-4342.93 7596.08,-4343.09 7678,-4255.2 7754.61,-4173.02 7638.52,-2316.43 7714,-2233.2 7778,-2162.64 7875.25,-2137.66 7969.91,-2133.4"/>
<polygon fill="black" stroke="black" points="7970.08,-2136.89 7979.95,-2133.02 7969.82,-2129.9 7970.08,-2136.89"/>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;post_io.raw_post_path -->
<g id="edge93" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7350.42,-4327.22C7455.53,-4342.05 7595.96,-4341.03 7678,-4255.2 7742.4,-4187.84 7649.79,-3484.75 7714,-3417.2 7834.15,-3290.82 8062.26,-3319.65 8181.32,-3345.95"/>
<polygon fill="black" stroke="black" points="8180.58,-3349.37 8191.1,-3348.16 8182.12,-3342.54 8180.58,-3349.37"/>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;notes_utils.load_json -->
<g id="edge90" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M7658.66,-4265.51C7665.23,-4262.27 7671.68,-4258.84 7678,-4255.2 7702.05,-4241.37 7690.08,-4218.27 7714,-4204.2 7924,-4080.73 8633.93,-4261.63 8804,-4087.2 8872.49,-4016.96 8793.73,-3733.71 8840,-3647.2 8894.93,-3544.5 9016.59,-3471.58 9084.94,-3436.96"/>
<polygon fill="black" stroke="black" points="9086.84,-3439.92 9094.22,-3432.32 9083.71,-3433.66 9086.84,-3439.92"/>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;lot_io.lot_json_path -->
<g id="edge91" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M7658.55,-4270.53C7665.26,-4265.78 7671.75,-4260.68 7678,-4255.2 7733.15,-4206.89 7659.82,-4143.61 7714,-4094.2 7839.28,-3979.95 8053.46,-3990.77 8172.27,-4007.95"/>
<polygon fill="black" stroke="black" points="8172,-4011.45 8182.41,-4009.46 8173.04,-4004.52 8172,-4011.45"/>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;debug_dump._message_reason -->
<g id="edge88" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;debug_dump._message_reason</title>
<path fill="none" stroke="black" d="M7658.54,-4324.5C8026.82,-4347.89 8538.49,-4380.38 8852.34,-4400.32"/>
<polygon fill="black" stroke="black" points="8852.29,-4403.82 8862.49,-4400.96 8852.73,-4396.83 8852.29,-4403.82"/>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;debug_dump._lot_reason -->
<g id="edge89" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;debug_dump._lot_reason</title>
<path fill="none" stroke="black" d="M7658.54,-4295.05C8077.94,-4293.95 8683.3,-4292.38 8970.69,-4291.63"/>
<polygon fill="black" stroke="black" points="8970.78,-4295.13 8980.78,-4291.6 8970.77,-4288.13 8970.78,-4295.13"/>
</g>
<!-- debug_dump.main -->
<g id="node83" class="node">
<title>debug_dump.main</title>
<g id="a_node83"><a xlink:title="Collect log and data files related to a single lot.">
<polygon fill="none" stroke="black" points="6447,-4291.2 5971,-4291.2 5971,-4229.2 6447,-4229.2 6447,-4291.2"/>
<text text-anchor="middle" x="6209" y="-4248" font-family="Times,serif" font-size="49.00">debug_dump.main</text>
</a>
</g>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.parse_url -->
<g id="edge94" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.parse_url</title>
<path fill="none" stroke="black" d="M6401.17,-4291.23C6503.26,-4306.81 6631.2,-4324.75 6746,-4336.2 6847.7,-4346.35 6962.32,-4353.06 7052.31,-4357.25"/>
<polygon fill="black" stroke="black" points="7052.18,-4360.75 7062.33,-4357.71 7052.5,-4353.76 7052.18,-4360.75"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.guess_source_from_lot -->
<g id="edge95" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.guess_source_from_lot</title>
<path fill="none" stroke="black" d="M6288.33,-4291.3C6391.37,-4330.51 6578.95,-4396.05 6746,-4423.2 6985.54,-4462.15 7667.36,-4466.23 8027.95,-4465.49"/>
<polygon fill="black" stroke="black" points="8028,-4468.99 8037.99,-4465.47 8027.98,-4461.99 8028,-4468.99"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.load_source_info -->
<g id="edge96" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.load_source_info</title>
<path fill="none" stroke="black" d="M6447.22,-4251.91C6597.71,-4246.65 6792.58,-4239.83 6947.81,-4234.41"/>
<polygon fill="black" stroke="black" points="6948.11,-4237.9 6957.98,-4234.05 6947.86,-4230.9 6948.11,-4237.9"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.run_tg_fetch -->
<g id="edge97" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.run_tg_fetch</title>
<path fill="none" stroke="black" d="M6307.51,-4291.28C6413.95,-4323.46 6590.07,-4371.57 6746,-4390.2 7157.3,-4439.37 8381.18,-4386.82 8898.73,-4361.37"/>
<polygon fill="black" stroke="black" points="8899.12,-4364.86 8908.94,-4360.87 8898.78,-4357.87 8899.12,-4364.86"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.collect_files -->
<g id="edge98" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.collect_files</title>
<path fill="none" stroke="black" d="M6447.21,-4270.25C6539.38,-4262.01 6639.52,-4236.35 6710,-4172.2 6754.65,-4131.56 6699.35,-4079.54 6746,-4041.2 6841.63,-3962.63 6988.92,-3965.79 7092.03,-3981.08"/>
<polygon fill="black" stroke="black" points="7091.77,-3984.58 7102.18,-3982.64 7092.83,-3977.66 7091.77,-3984.58"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.delete_files -->
<g id="edge99" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.delete_files</title>
<path fill="none" stroke="black" d="M6447.13,-4261.72C6536.64,-4251.8 6634.89,-4227.21 6710,-4172.2 6737.91,-4151.77 6717.03,-4122.11 6746,-4103.2 6845.73,-4038.11 6984.51,-4037.63 7084.45,-4048.97"/>
<polygon fill="black" stroke="black" points="7084.27,-4052.47 7094.61,-4050.18 7085.09,-4045.52 7084.27,-4052.47"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.moderation_summary -->
<g id="edge100" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.moderation_summary</title>
<path fill="none" stroke="black" d="M6447.22,-4268.74C6539.5,-4272.05 6648.46,-4275.97 6754.74,-4279.8"/>
<polygon fill="black" stroke="black" points="6754.9,-4283.3 6765.02,-4280.17 6755.15,-4276.31 6754.9,-4283.3"/>
</g>
<!-- config_utils.load_config -->
<g id="node84" class="node">
<title>config_utils.load_config</title>
<g id="a_node84"><a xlink:title="Return the ``config`` module or exit with a helpful message.&#10;&#10;When running the scripts directly from ``src/`` the repository root isn&#39;t on&#10;``sys.path`` and ``config.py`` can&#39;t be imported. &#160;Try adding the parent&#10;directory before failing so the configuration can live alongside&#10;``config.example.py`` in the project root.">
<polygon fill="none" stroke="black" points="9899,-2331.7 9466,-2331.7 9466,-2284.7 9899,-2284.7 9899,-2331.7"/>
<text text-anchor="middle" x="9682.5" y="-2299.7" font-family="Times,serif" font-size="35.00">config_utils.load_config</text>
</a>
</g>
</g>
<!-- message_utils.gather_chop_input -->
<g id="node85" class="node">
<title>message_utils.gather_chop_input</title>
<g id="a_node85"><a xlink:title="Return the exact text fed to the lot parser for ``msg_path``.">
<polygon fill="none" stroke="black" points="7424.5,-2126.2 6999.5,-2126.2 6999.5,-2090.2 7424.5,-2090.2 7424.5,-2126.2"/>
<text text-anchor="middle" x="7212" y="-2102.33" font-family="Times,serif" font-size="24.22">message_utils.gather_chop_input</text>
</a>
</g>
</g>
<!-- message_utils.gather_chop_input&#45;&gt;post_io.read_post -->
<g id="edge103" class="edge">
<title>message_utils.gather_chop_input&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7424.79,-2120.77C7581.6,-2130.07 7797.05,-2142.86 7969.58,-2153.09"/>
<polygon fill="black" stroke="black" points="7969.39,-2156.59 7979.58,-2153.69 7969.81,-2149.6 7969.39,-2156.59"/>
</g>
<!-- message_utils.gather_chop_input&#45;&gt;message_utils.build_prompt -->
<g id="edge101" class="edge">
<title>message_utils.gather_chop_input&#45;&gt;message_utils.build_prompt</title>
<path fill="none" stroke="black" d="M7424.54,-2092.87C7515.07,-2075.32 7614.38,-2039.46 7678,-1967.2 7741.44,-1895.15 7644.13,-1820.05 7714,-1754.2 7835.89,-1639.35 8047.88,-1654.7 8168.08,-1675.4"/>
<polygon fill="black" stroke="black" points="8167.54,-1678.86 8178,-1677.15 8168.76,-1671.97 8167.54,-1678.86"/>
</g>
<!-- message_utils.gather_chop_input&#45;&gt;caption_io.read_caption -->
<g id="edge102" class="edge">
<title>message_utils.gather_chop_input&#45;&gt;caption_io.read_caption</title>
<path fill="none" stroke="black" d="M7398.51,-2126.22C7493.18,-2144.45 7603.71,-2181.01 7678,-2254.2 7714.34,-2290.01 7673.44,-2332.26 7714,-2363.2 7770.21,-2406.08 7946.31,-2408.42 8083.09,-2402.96"/>
<polygon fill="black" stroke="black" points="8083.44,-2406.45 8093.29,-2402.53 8083.15,-2399.45 8083.44,-2406.45"/>
</g>
<!-- notes_utils.read_md&#45;&gt;notes_utils.read_text -->
<g id="edge105" class="edge">
<title>notes_utils.read_md&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M9157,-2381.45C9211.42,-2429.98 9357.79,-2568.63 9430,-2716.2 9631.71,-3128.42 9673.12,-3702.5 9680.2,-3835.79"/>
<polygon fill="black" stroke="black" points="9676.71,-3836.16 9680.72,-3845.97 9683.7,-3835.81 9676.71,-3836.16"/>
</g>
<!-- notes_utils.write_md -->
<g id="node87" class="node">
<title>notes_utils.write_md</title>
<g id="a_node87"><a xlink:title="Write ``text`` to ``path`` ensuring a trailing newline.">
<polygon fill="none" stroke="black" points="7325,-4625.2 7099,-4625.2 7099,-4589.2 7325,-4589.2 7325,-4625.2"/>
<text text-anchor="middle" x="7212" y="-4602.41" font-family="Times,serif" font-size="19.74">notes_utils.write_md</text>
</a>
</g>
</g>
<!-- notes_utils.parse_md -->
<g id="node89" class="node">
<title>notes_utils.parse_md</title>
<g id="a_node89"><a xlink:title="Return metadata dictionary and body text from ``path``.">
<polygon fill="none" stroke="black" points="8342.5,-2354.2 8175.5,-2354.2 8175.5,-2318.2 8342.5,-2318.2 8342.5,-2354.2"/>
<text text-anchor="middle" x="8259" y="-2332.5" font-family="Times,serif" font-size="14.00">notes_utils.parse_md</text>
</a>
</g>
</g>
<!-- notes_utils.parse_md&#45;&gt;notes_utils.read_md -->
<g id="edge106" class="edge">
<title>notes_utils.parse_md&#45;&gt;notes_utils.read_md</title>
<path fill="none" stroke="black" d="M8342.62,-2338.76C8510.59,-2343.95 8889.95,-2355.67 9054.91,-2360.76"/>
<polygon fill="black" stroke="black" points="9054.88,-2364.26 9064.99,-2361.07 9055.1,-2357.27 9054.88,-2364.26"/>
</g>
<!-- notes_utils.parse_md&#45;&gt;notes_utils._parse_block -->
<g id="edge107" class="edge">
<title>notes_utils.parse_md&#45;&gt;notes_utils._parse_block</title>
<path fill="none" stroke="black" d="M8342.61,-2337.51C8449.73,-2337.94 8642.02,-2334.39 8804,-2308.2 8898.73,-2292.89 9005.24,-2260.7 9070.98,-2239.01"/>
<polygon fill="black" stroke="black" points="9072.39,-2242.23 9080.78,-2235.75 9070.18,-2235.58 9072.39,-2242.23"/>
</g>
<!-- build_site._load_ontology -->
<g id="node90" class="node">
<title>build_site._load_ontology</title>
<g id="a_node90"><a xlink:title="Return sorted field list from ``ONTOLOGY`` or empty list when missing.">
<polygon fill="none" stroke="black" points="8415.5,-2530.2 8102.5,-2530.2 8102.5,-2494.2 8415.5,-2494.2 8415.5,-2530.2"/>
<text text-anchor="middle" x="8259" y="-2506.61" font-family="Times,serif" font-size="23.24">build_site._load_ontology</text>
</a>
</g>
</g>
<!-- build_site._load_ontology&#45;&gt;notes_utils.load_json -->
<g id="edge109" class="edge">
<title>build_site._load_ontology&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M8415.71,-2498.62C8556.36,-2490.03 8749.42,-2488.63 8804,-2539.2 8850.82,-2582.6 8821.5,-2763.11 8840,-2824.2 8909.93,-3055.18 9064.14,-3305.96 9116.33,-3387.2"/>
<polygon fill="black" stroke="black" points="9113.54,-3389.32 9121.9,-3395.83 9119.42,-3385.53 9113.54,-3389.32"/>
</g>
<!-- build_site._compile_locale -->
<g id="node91" class="node">
<title>build_site._compile_locale</title>
<g id="a_node91"><a xlink:title="Compile ``lang`` gettext catalogue when out of date.">
<polygon fill="none" stroke="black" points="9302,-752.2 8968,-752.2 8968,-716.2 9302,-716.2 9302,-752.2"/>
<text text-anchor="middle" x="9135" y="-728.33" font-family="Times,serif" font-size="24.22">build_site._compile_locale</text>
</a>
</g>
</g>
<!-- build_site._env_for_lang -->
<g id="node92" class="node">
<title>build_site._env_for_lang</title>
<g id="a_node92"><a xlink:title="Return Jinja environment configured for ``lang``.">
<polygon fill="none" stroke="black" points="8447.5,-759.7 8070.5,-759.7 8070.5,-718.7 8447.5,-718.7 8447.5,-759.7"/>
<text text-anchor="middle" x="8259" y="-731.96" font-family="Times,serif" font-size="29.68">build_site._env_for_lang</text>
</a>
</g>
</g>
<!-- build_site._env_for_lang&#45;&gt;build_site._compile_locale -->
<g id="edge110" class="edge">
<title>build_site._env_for_lang&#45;&gt;build_site._compile_locale</title>
<path fill="none" stroke="black" d="M8447.76,-738.13C8598.92,-737.27 8809.85,-736.06 8957.83,-735.21"/>
<polygon fill="black" stroke="black" points="8957.95,-738.71 8967.93,-735.15 8957.91,-731.71 8957.95,-738.71"/>
</g>
<!-- build_site._iter_lots -->
<g id="node93" class="node">
<title>build_site._iter_lots</title>
<g id="a_node93"><a xlink:title="Return all lots ready for rendering.">
<polygon fill="none" stroke="black" points="7438,-1893.7 6986,-1893.7 6986,-1836.7 7438,-1836.7 7438,-1893.7"/>
<text text-anchor="middle" x="7212" y="-1854.31" font-family="Times,serif" font-size="44.24">build_site._iter_lots</text>
</a>
</g>
</g>
<!-- build_site._iter_lots&#45;&gt;moderation.should_skip_message -->
<g id="edge111" class="edge">
<title>build_site._iter_lots&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M7438.14,-1847.11C7630.88,-1831.61 7904.53,-1809.62 8081.68,-1795.38"/>
<polygon fill="black" stroke="black" points="8082.2,-1798.85 8091.88,-1794.56 8081.63,-1791.87 8082.2,-1798.85"/>
</g>
<!-- build_site._iter_lots&#45;&gt;moderation.should_skip_lot -->
<g id="edge112" class="edge">
<title>build_site._iter_lots&#45;&gt;moderation.should_skip_lot</title>
<path fill="none" stroke="black" d="M7438.14,-1865.2C7641.77,-1865.2 7935.71,-1865.2 8110.74,-1865.2"/>
<polygon fill="black" stroke="black" points="8110.8,-1868.7 8120.8,-1865.2 8110.8,-1861.7 8110.8,-1868.7"/>
</g>
<!-- build_site._iter_lots&#45;&gt;lot_io.read_lots -->
<g id="edge113" class="edge">
<title>build_site._iter_lots&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M7438.14,-1880.29C7654.79,-1894.8 7973.68,-1916.16 8142.82,-1927.49"/>
<polygon fill="black" stroke="black" points="8142.78,-1930.99 8152.99,-1928.17 8143.25,-1924.01 8142.78,-1930.99"/>
</g>
<!-- build_site._iter_lots&#45;&gt;post_io.read_post -->
<g id="edge115" class="edge">
<title>build_site._iter_lots&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7438.12,-1842.84C7518.91,-1844.92 7607.4,-1859.7 7678,-1903.2 7704.15,-1919.32 7690.39,-1942.56 7714,-1962.2 7814.72,-2046.03 7952.88,-2098.29 8064.76,-2129.46"/>
<polygon fill="black" stroke="black" points="8063.9,-2132.85 8074.48,-2132.13 8065.76,-2126.1 8063.9,-2132.85"/>
</g>
<!-- build_site._iter_lots&#45;&gt;post_io.raw_post_path -->
<g id="edge116" class="edge">
<title>build_site._iter_lots&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7438,-1856.12C7539.64,-1857.32 7644.45,-1867.83 7678,-1903.2 7774.23,-2004.66 7632.81,-3047.36 7714,-3161.2 7819.88,-3309.66 8047.26,-3350.68 8171.92,-3361.96"/>
<polygon fill="black" stroke="black" points="8171.92,-3365.48 8182.18,-3362.85 8172.52,-3358.5 8171.92,-3365.48"/>
</g>
<!-- lot_io.iter_lot_files -->
<g id="node94" class="node">
<title>lot_io.iter_lot_files</title>
<g id="a_node94"><a xlink:title="Return ``*.json`` files under ``root``.&#10;&#10;When ``newest_first`` is ``True`` the result is ordered by modification&#10;time with the most recently changed files first. &#160;Both ``build_site.py`` and&#10;``pending_embed.py`` rely on this helper so they scan the lot directory in&#10;the same order.">
<polygon fill="none" stroke="black" points="8387.5,-1595.7 8130.5,-1595.7 8130.5,-1558.7 8387.5,-1558.7 8387.5,-1595.7"/>
<text text-anchor="middle" x="8259" y="-1570.76" font-family="Times,serif" font-size="26.18">lot_io.iter_lot_files</text>
</a>
</g>
</g>
<!-- build_site._iter_lots&#45;&gt;lot_io.iter_lot_files -->
<g id="edge114" class="edge">
<title>build_site._iter_lots&#45;&gt;lot_io.iter_lot_files</title>
<path fill="none" stroke="black" d="M7352.09,-1893.72C7454.27,-1906.12 7590.07,-1903.53 7678,-1827.2 7732.72,-1779.71 7661.33,-1717.96 7714,-1668.2 7821.57,-1566.59 7997.49,-1554.49 8120.05,-1560.87"/>
<polygon fill="black" stroke="black" points="8120.08,-1564.38 8130.26,-1561.45 8120.48,-1557.39 8120.08,-1564.38"/>
</g>
<!-- build_site._copy_images -->
<g id="node95" class="node">
<title>build_site._copy_images</title>
<g id="a_node95"><a xlink:title="Copy media referenced by ``lots`` into ``VIEWS_DIR``.">
<polygon fill="none" stroke="black" points="9298.5,-878.2 8971.5,-878.2 8971.5,-842.2 9298.5,-842.2 9298.5,-878.2"/>
<text text-anchor="middle" x="9135" y="-854.04" font-family="Times,serif" font-size="25.20">build_site._copy_images</text>
</a>
</g>
</g>
<!-- build_site._copy_static -->
<g id="node96" class="node">
<title>build_site._copy_static</title>
<g id="a_node96"><a xlink:title="Copy CSS and JS so generated pages are standalone.">
<polygon fill="none" stroke="black" points="6337,-868.2 6081,-868.2 6081,-832.2 6337,-832.2 6337,-868.2"/>
<text text-anchor="middle" x="6209" y="-844.9" font-family="Times,serif" font-size="21.00">build_site._copy_static</text>
</a>
</g>
</g>
<!-- build_site._load_state -->
<g id="node97" class="node">
<title>build_site._load_state</title>
<g id="a_node97"><a xlink:title="Return ontology fields, embeddings, lots and similarity cache.">
<polygon fill="none" stroke="black" points="6348.5,-2408.2 6069.5,-2408.2 6069.5,-2372.2 6348.5,-2372.2 6348.5,-2408.2"/>
<text text-anchor="middle" x="6209" y="-2384.33" font-family="Times,serif" font-size="24.22">build_site._load_state</text>
</a>
</g>
</g>
<!-- build_site._load_state&#45;&gt;similar_utils._load_embeddings -->
<g id="edge117" class="edge">
<title>build_site._load_state&#45;&gt;similar_utils._load_embeddings</title>
<path fill="none" stroke="black" d="M6348.74,-2379.42C6477.78,-2372.55 6657.75,-2372.06 6710,-2417.2 6771.07,-2469.97 6685.66,-2541.6 6746,-2595.2 6901.36,-2733.21 7478.41,-2613.37 7678,-2671.2 7897.81,-2734.9 8130.55,-2886.39 8219.98,-2948.22"/>
<polygon fill="black" stroke="black" points="8218.22,-2951.26 8228.43,-2954.09 8222.21,-2945.51 8218.22,-2951.26"/>
</g>
<!-- build_site._load_state&#45;&gt;similar_utils._load_similar -->
<g id="edge118" class="edge">
<title>build_site._load_state&#45;&gt;similar_utils._load_similar</title>
<path fill="none" stroke="black" d="M6348.76,-2394.41C6687.54,-2404.66 7561.14,-2431.11 7999.32,-2444.37"/>
<polygon fill="black" stroke="black" points="7999.49,-2447.88 8009.59,-2444.68 7999.7,-2440.88 7999.49,-2447.88"/>
</g>
<!-- build_site._load_state&#45;&gt;build_site._load_ontology -->
<g id="edge119" class="edge">
<title>build_site._load_state&#45;&gt;build_site._load_ontology</title>
<path fill="none" stroke="black" d="M6348.65,-2382.22C6475.88,-2377.61 6652.98,-2378.93 6710,-2417.2 6741.03,-2438.04 6714.54,-2473.02 6746,-2493.2 6801.81,-2529.02 7711.69,-2520.13 8092.47,-2514.8"/>
<polygon fill="black" stroke="black" points="8092.53,-2518.3 8102.48,-2514.66 8092.43,-2511.3 8092.53,-2518.3"/>
</g>
<!-- build_site._load_state&#45;&gt;build_site._iter_lots -->
<g id="edge120" class="edge">
<title>build_site._load_state&#45;&gt;build_site._iter_lots</title>
<path fill="none" stroke="black" d="M6327.53,-2372.2C6444.09,-2347.77 6618.19,-2292.2 6710,-2170.2 6782,-2074.53 6659.14,-1985.62 6746,-1903.2 6832.02,-1821.58 6971.73,-1820.89 7075.59,-1835.26"/>
<polygon fill="black" stroke="black" points="7075.13,-1838.73 7085.53,-1836.69 7076.13,-1831.8 7075.13,-1838.73"/>
</g>
<!-- build_site._load_state&#45;&gt;build_site._copy_images -->
<g id="edge121" class="edge">
<title>build_site._load_state&#45;&gt;build_site._copy_images</title>
<path fill="none" stroke="black" d="M6340.34,-2372.15C6458.75,-2348.15 6627.16,-2293.36 6710,-2170.2 6749.92,-2110.85 6694.96,-933.32 6746,-883.2 6824.77,-805.86 8425.83,-841.31 8961.29,-855.39"/>
<polygon fill="black" stroke="black" points="8961.33,-858.89 8971.42,-855.66 8961.51,-851.9 8961.33,-858.89"/>
</g>
<!-- build_site._categorise -->
<g id="node98" class="node">
<title>build_site._categorise</title>
<g id="a_node98"><a xlink:title="Return category info and recent lot list.&#10;&#10;Categories are split by ``market:deal`` and ``sell_item`` lots are further&#10;grouped by ``item:type``.&#10;Stats include price range, last timestamp and embedding centroid so the&#10;sorting logic used on item pages also works for categories.">
<polygon fill="none" stroke="black" points="7638,-584.2 6786,-584.2 6786,-492.2 7638,-492.2 7638,-584.2"/>
<text text-anchor="middle" x="7212" y="-519.39" font-family="Times,serif" font-size="76.02">build_site._categorise</text>
</a>
</g>
</g>
<!-- build_site._categorise&#45;&gt;lot_io.get_seller -->
<g id="edge122" class="edge">
<title>build_site._categorise&#45;&gt;lot_io.get_seller</title>
<path fill="none" stroke="black" d="M7638.04,-570.74C7823.95,-584.98 8026.92,-600.51 8148.27,-609.8"/>
<polygon fill="black" stroke="black" points="8148.07,-613.3 8158.3,-610.57 8148.6,-606.32 8148.07,-613.3"/>
</g>
<!-- build_site._render_site -->
<g id="node99" class="node">
<title>build_site._render_site</title>
<g id="a_node99"><a xlink:title="Render all HTML pages for ``lots`` using cached templates.&#10;&#10;``rates`` maps currency codes to multipliers relative to USD. &#160;The values&#10;are embedded into the pages so the front&#45;end can convert prices on the fly.">
<polygon fill="none" stroke="black" points="6710,-1072.7 5708,-1072.7 5708,-969.7 6710,-969.7 6710,-1072.7"/>
<text text-anchor="middle" x="6209" y="-999.94" font-family="Times,serif" font-size="85.96">build_site._render_site</text>
</a>
</g>
</g>
<!-- build_site._render_site&#45;&gt;lot_io.get_seller -->
<g id="edge126" class="edge">
<title>build_site._render_site&#45;&gt;lot_io.get_seller</title>
<path fill="none" stroke="black" d="M6576.21,-969.69C6626.98,-948.24 6673.98,-918.45 6710,-877.2 6782.68,-793.98 6662.71,-703.82 6746,-631.2 6798.66,-585.29 7809.56,-606.76 8148.38,-615.28"/>
<polygon fill="black" stroke="black" points="8148.37,-618.78 8158.45,-615.54 8148.54,-611.79 8148.37,-618.78"/>
</g>
<!-- build_site._render_site&#45;&gt;notes_utils.read_text -->
<g id="edge124" class="edge">
<title>build_site._render_site&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M6710.42,-1015.98C7592,-1009.31 9338.04,-1008.47 9430,-1105.2 9477.29,-1154.95 9460.19,-2271.81 9466,-2340.2 9517.72,-2948.64 9648.82,-3685.18 9676.37,-3836.32"/>
<polygon fill="black" stroke="black" points="9672.93,-3836.97 9678.17,-3846.18 9679.82,-3835.71 9672.93,-3836.97"/>
</g>
<!-- build_site._render_site&#45;&gt;similar_utils._format_vector -->
<g id="edge123" class="edge">
<title>build_site._render_site&#45;&gt;similar_utils._format_vector</title>
<path fill="none" stroke="black" d="M6516.49,-1072.74C6591.38,-1083.73 6671.42,-1094.14 6746,-1101.2 6849.18,-1110.98 7589.25,-1085.68 7678,-1139.2 7705.28,-1155.66 7686.79,-1184.63 7714,-1201.2 7779.69,-1241.22 7981.57,-1241.28 8120.02,-1236.01"/>
<polygon fill="black" stroke="black" points="8120.44,-1239.5 8130.29,-1235.6 8120.16,-1232.5 8120.44,-1239.5"/>
</g>
<!-- build_site.build_page -->
<g id="node100" class="node">
<title>build_site.build_page</title>
<g id="a_node100"><a xlink:title="Render ``lot`` into separate HTML files for every language.&#10;&#10;``rates`` provides currency multipliers used by the front&#45;end for dynamic&#10;conversion.">
<polygon fill="none" stroke="black" points="7678,-1682.2 6746,-1682.2 6746,-1580.2 7678,-1580.2 7678,-1682.2"/>
<text text-anchor="middle" x="7212" y="-1610.11" font-family="Times,serif" font-size="85.12">build_site.build_page</text>
</a>
</g>
</g>
<!-- build_site._render_site&#45;&gt;build_site.build_page -->
<g id="edge125" class="edge">
<title>build_site._render_site&#45;&gt;build_site.build_page</title>
<path fill="none" stroke="black" d="M6606.9,-1072.82C6645.88,-1091.69 6681.47,-1116.57 6710,-1149.2 6800.7,-1252.98 6661.01,-1348.71 6746,-1457.2 6789.57,-1512.82 6852.91,-1550.66 6918.9,-1576.41"/>
<polygon fill="black" stroke="black" points="6918.06,-1579.83 6928.65,-1580.12 6920.55,-1573.29 6918.06,-1579.83"/>
</g>
<!-- build_site.build_page&#45;&gt;post_io.read_post -->
<g id="edge130" class="edge">
<title>build_site.build_page&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7553.58,-1682.3C7600.49,-1702.26 7644.11,-1729.67 7678,-1767.2 7737.06,-1832.62 7657.62,-1894.46 7714,-1962.2 7786.44,-2049.25 7899.63,-2099.95 8004.04,-2129.43"/>
<polygon fill="black" stroke="black" points="8003.22,-2132.84 8013.79,-2132.13 8005.09,-2126.09 8003.22,-2132.84"/>
</g>
<!-- build_site.build_page&#45;&gt;post_io.raw_post_path -->
<g id="edge131" class="edge">
<title>build_site.build_page&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7568.66,-1682.32C7611.03,-1702.5 7649.33,-1729.96 7678,-1767.2 7772.51,-1889.98 7624.21,-3034.93 7714,-3161.2 7819.67,-3309.81 8047.14,-3350.77 8171.86,-3362"/>
<polygon fill="black" stroke="black" points="8171.87,-3365.52 8182.13,-3362.88 8172.47,-3358.54 8171.87,-3365.52"/>
</g>
<!-- build_site.build_page&#45;&gt;similar_utils._format_vector -->
<g id="edge127" class="edge">
<title>build_site.build_page&#45;&gt;similar_utils._format_vector</title>
<path fill="none" stroke="black" d="M7460.07,-1580.19C7537.54,-1554.1 7618.3,-1515.12 7678,-1457.2 7708.33,-1427.78 7682.18,-1397.01 7714,-1369.2 7826.74,-1270.71 7999.76,-1239.63 8120.3,-1230.54"/>
<polygon fill="black" stroke="black" points="8120.61,-1234.03 8130.34,-1229.82 8120.11,-1227.04 8120.61,-1234.03"/>
</g>
<!-- build_site.build_page&#45;&gt;caption_io.read_caption -->
<g id="edge129" class="edge">
<title>build_site.build_page&#45;&gt;caption_io.read_caption</title>
<path fill="none" stroke="black" d="M7565.49,-1682.3C7608.82,-1702.43 7648.24,-1729.89 7678,-1767.2 7760.74,-1870.93 7619.76,-2269.8 7714,-2363.2 7764.58,-2413.34 7943.93,-2414.17 8083.03,-2406.37"/>
<polygon fill="black" stroke="black" points="8083.61,-2409.84 8093.39,-2405.76 8083.2,-2402.85 8083.61,-2409.84"/>
</g>
<!-- build_site.build_page&#45;&gt;build_site._env_for_lang -->
<g id="edge128" class="edge">
<title>build_site.build_page&#45;&gt;build_site._env_for_lang</title>
<path fill="none" stroke="black" d="M7501.68,-1580.13C7569.63,-1554.34 7634.77,-1515.55 7678,-1457.2 7754.09,-1354.52 7632.91,-981.99 7714,-883.2 7796.75,-782.4 7941.13,-747.57 8060.36,-737.32"/>
<polygon fill="black" stroke="black" points="8060.67,-740.8 8070.35,-736.51 8060.1,-733.83 8060.67,-740.8"/>
</g>
<!-- build_site.main -->
<g id="node101" class="node">
<title>build_site.main</title>
<g id="a_node101"><a xlink:title="Build the static site under ``VIEWS_DIR``.">
<polygon fill="none" stroke="black" points="5606.5,-783.2 5186.5,-783.2 5186.5,-717.2 5606.5,-717.2 5606.5,-783.2"/>
<text text-anchor="middle" x="5396.5" y="-737.32" font-family="Times,serif" font-size="52.36">build_site.main</text>
</a>
</g>
</g>
<!-- build_site.main&#45;&gt;similar_utils._save_similar -->
<g id="edge132" class="edge">
<title>build_site.main&#45;&gt;similar_utils._save_similar</title>
<path fill="none" stroke="black" d="M5415.74,-783.39C5456.85,-854.28 5564.48,-1019.05 5708,-1081.2 5945.66,-1184.13 6718.46,-1123.22 7053.58,-1090.68"/>
<polygon fill="black" stroke="black" points="7054.25,-1094.13 7063.86,-1089.68 7053.57,-1087.16 7054.25,-1094.13"/>
</g>
<!-- build_site.main&#45;&gt;similar_utils._prune_similar -->
<g id="edge133" class="edge">
<title>build_site.main&#45;&gt;similar_utils._prune_similar</title>
<path fill="none" stroke="black" d="M5606.75,-762.08C5748.66,-770.13 5932.81,-780.59 6059.72,-787.79"/>
<polygon fill="black" stroke="black" points="6059.72,-791.29 6069.9,-788.37 6060.12,-784.31 6059.72,-791.29"/>
</g>
<!-- build_site.main&#45;&gt;similar_utils._calc_similar_nn -->
<g id="edge134" class="edge">
<title>build_site.main&#45;&gt;similar_utils._calc_similar_nn</title>
<path fill="none" stroke="black" d="M5413.18,-717.02C5451.29,-640.58 5556.87,-452.49 5708,-372.2 6078.78,-175.23 6574.07,-169.56 6892.85,-192.91"/>
<polygon fill="black" stroke="black" points="6892.94,-196.42 6903.17,-193.68 6893.46,-189.44 6892.94,-196.42"/>
</g>
<!-- build_site.main&#45;&gt;similar_utils._sync_embeddings -->
<g id="edge135" class="edge">
<title>build_site.main&#45;&gt;similar_utils._sync_embeddings</title>
<path fill="none" stroke="black" d="M5606.69,-744C5640.56,-743.03 5675.25,-742.07 5708,-741.2 6552.54,-718.86 7554.53,-695.94 8010.25,-685.71"/>
<polygon fill="black" stroke="black" points="8010.33,-689.21 8020.25,-685.49 8010.17,-682.22 8010.33,-689.21"/>
</g>
<!-- build_site.main&#45;&gt;similar_utils._similar_by_user -->
<g id="edge136" class="edge">
<title>build_site.main&#45;&gt;similar_utils._similar_by_user</title>
<path fill="none" stroke="black" d="M5430.66,-783.23C5492.26,-847.14 5622.55,-995.09 5672,-1149.2 5738.42,-1356.18 5623.47,-2904.94 5708,-3105.2 5802.85,-3329.91 6049.38,-3508.72 6156.76,-3578.52"/>
<polygon fill="black" stroke="black" points="6155.18,-3581.66 6165.48,-3584.14 6158.98,-3575.78 6155.18,-3581.66"/>
</g>
<!-- build_site.main&#45;&gt;price_utils.canonical_currency -->
<g id="edge137" class="edge">
<title>build_site.main&#45;&gt;price_utils.canonical_currency</title>
<path fill="none" stroke="black" d="M5402.33,-717.04C5419.92,-609.94 5491.29,-272.53 5708,-138.2 5854.2,-47.59 8632.28,-111.35 8804,-121.2 8867.68,-124.86 8937.93,-132.45 8997.19,-139.89"/>
<polygon fill="black" stroke="black" points="8997,-143.4 9007.36,-141.18 8997.88,-136.45 8997,-143.4"/>
</g>
<!-- build_site.main&#45;&gt;price_utils.fetch_official_rates -->
<g id="edge138" class="edge">
<title>build_site.main&#45;&gt;price_utils.fetch_official_rates</title>
<path fill="none" stroke="black" d="M5460.91,-783.3C5522.29,-813.59 5618.89,-856.71 5708,-877.2 5923.59,-926.78 6510.81,-952.76 6884.2,-964.68"/>
<polygon fill="black" stroke="black" points="6884.26,-968.18 6894.36,-965 6884.48,-961.18 6884.26,-968.18"/>
</g>
<!-- build_site.main&#45;&gt;price_utils.apply_price_model -->
<g id="edge139" class="edge">
<title>build_site.main&#45;&gt;price_utils.apply_price_model</title>
<path fill="none" stroke="black" d="M5457.17,-717.18C5518.95,-683.62 5618.76,-631.17 5708,-592.2 5848.22,-530.98 6015.99,-472.06 6117.16,-438.02"/>
<polygon fill="black" stroke="black" points="6118.37,-441.3 6126.74,-434.8 6116.15,-434.67 6118.37,-441.3"/>
</g>
<!-- build_site.main&#45;&gt;price_utils.prepare_price_fields -->
<g id="edge140" class="edge">
<title>build_site.main&#45;&gt;price_utils.prepare_price_fields</title>
<path fill="none" stroke="black" d="M5403.56,-717.09C5424.26,-614.8 5502.63,-303.35 5708,-180.2 5799.21,-125.51 7190.57,-141.1 7878.61,-152.27"/>
<polygon fill="black" stroke="black" points="7878.63,-155.77 7888.68,-152.44 7878.74,-148.77 7878.63,-155.77"/>
</g>
<!-- build_site.main&#45;&gt;config_utils.load_config -->
<g id="edge141" class="edge">
<title>build_site.main&#45;&gt;config_utils.load_config</title>
<path fill="none" stroke="black" d="M5401.09,-716.84C5415.2,-604.08 5478,-235.95 5708,-87.2 5988.49,94.19 6876.96,-64.2 7211,-64.2 7211,-64.2 7211,-64.2 8260,-64.2 8520.44,-64.2 9249.48,55.52 9430,-132.2 9494.55,-199.34 9446.2,-1717.2 9466,-1808.2 9506.55,-1994.59 9617.08,-2197.82 9662.06,-2275.52"/>
<polygon fill="black" stroke="black" points="9659.16,-2277.48 9667.21,-2284.36 9665.2,-2273.96 9659.16,-2277.48"/>
</g>
<!-- build_site.main&#45;&gt;build_site._env_for_lang -->
<g id="edge142" class="edge">
<title>build_site.main&#45;&gt;build_site._env_for_lang</title>
<path fill="none" stroke="black" d="M5606.68,-749.4C6139.09,-747.35 7540.1,-741.97 8060.06,-739.97"/>
<polygon fill="black" stroke="black" points="8060.31,-743.47 8070.29,-739.93 8060.28,-736.47 8060.31,-743.47"/>
</g>
<!-- build_site.main&#45;&gt;build_site._copy_static -->
<g id="edge143" class="edge">
<title>build_site.main&#45;&gt;build_site._copy_static</title>
<path fill="none" stroke="black" d="M5515.99,-783.26C5573.5,-797.97 5643.87,-814.01 5708,-823.2 5829.78,-840.67 5969.71,-847.07 6070.51,-849.31"/>
<polygon fill="black" stroke="black" points="6070.68,-852.82 6080.76,-849.53 6070.83,-845.82 6070.68,-852.82"/>
</g>
<!-- build_site.main&#45;&gt;build_site._load_state -->
<g id="edge144" class="edge">
<title>build_site.main&#45;&gt;build_site._load_state</title>
<path fill="none" stroke="black" d="M5430.42,-783.31C5491.61,-847.35 5621.25,-995.51 5672,-1149.2 5707.59,-1257 5644.3,-2076.25 5708,-2170.2 5789.2,-2289.98 5951.23,-2345.13 6068.89,-2370.14"/>
<polygon fill="black" stroke="black" points="6068.21,-2373.58 6078.71,-2372.18 6069.63,-2366.72 6068.21,-2373.58"/>
</g>
<!-- build_site.main&#45;&gt;build_site._categorise -->
<g id="edge145" class="edge">
<title>build_site.main&#45;&gt;build_site._categorise</title>
<path fill="none" stroke="black" d="M5583.58,-717.18C5624.5,-710.44 5667.66,-703.73 5708,-698.2 6066.61,-649.13 6475.11,-606.49 6775.64,-577.6"/>
<polygon fill="black" stroke="black" points="6776.22,-581.06 6785.84,-576.62 6775.55,-574.09 6776.22,-581.06"/>
</g>
<!-- build_site.main&#45;&gt;build_site._render_site -->
<g id="edge146" class="edge">
<title>build_site.main&#45;&gt;build_site._render_site</title>
<path fill="none" stroke="black" d="M5435.01,-783.32C5490.43,-830.18 5599.38,-914.64 5708,-955.2 5718.79,-959.23 5729.78,-963.02 5740.94,-966.58"/>
<polygon fill="black" stroke="black" points="5740.19,-970.02 5750.78,-969.65 5742.28,-963.33 5740.19,-970.02"/>
</g>
<!-- caption_io._get_langs&#45;&gt;config_utils.load_config -->
<g id="edge147" class="edge">
<title>caption_io._get_langs&#45;&gt;config_utils.load_config</title>
<path fill="none" stroke="black" d="M9244,-2810.83C9303.41,-2812.85 9375.83,-2805.84 9430,-2770.2 9587.44,-2666.62 9654.48,-2429.83 9674.56,-2341.9"/>
<polygon fill="black" stroke="black" points="9678.02,-2342.45 9676.78,-2331.93 9671.19,-2340.93 9678.02,-2342.45"/>
</g>
<!-- clean_data._parse_date -->
<g id="node103" class="node">
<title>clean_data._parse_date</title>
<g id="a_node103"><a xlink:title="Return the ``date`` field from a markdown file if present.">
<polygon fill="none" stroke="black" points="8398.5,-3152.2 8119.5,-3152.2 8119.5,-3116.2 8398.5,-3116.2 8398.5,-3152.2"/>
<text text-anchor="middle" x="8259" y="-3128.51" font-family="Times,serif" font-size="22.12">clean_data._parse_date</text>
</a>
</g>
</g>
<!-- clean_data._parse_date&#45;&gt;notes_utils.read_text -->
<g id="edge159" class="edge">
<title>clean_data._parse_date&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M8398.59,-3126.82C8635.89,-3121.57 9123.96,-3143.92 9430,-3387.2 9584.45,-3509.99 9655.06,-3753.91 9675.18,-3836.29"/>
<polygon fill="black" stroke="black" points="9671.82,-3837.25 9677.54,-3846.16 9678.62,-3835.62 9671.82,-3837.25"/>
</g>
<!-- clean_data._clean_raw -->
<g id="node104" class="node">
<title>clean_data._clean_raw</title>
<g id="a_node104"><a xlink:title="Delete raw posts older than ``cutoff``.">
<polygon fill="none" stroke="black" points="7365.5,-3096.2 7058.5,-3096.2 7058.5,-3060.2 7365.5,-3060.2 7365.5,-3096.2"/>
<text text-anchor="middle" x="7212" y="-3072.04" font-family="Times,serif" font-size="25.20">clean_data._clean_raw</text>
</a>
</g>
</g>
<!-- clean_data._clean_raw&#45;&gt;post_io.raw_post_path -->
<g id="edge161" class="edge">
<title>clean_data._clean_raw&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7306.09,-3060.18C7405.34,-3046.02 7563.66,-3038.41 7678,-3105.2 7703.55,-3120.13 7690.99,-3142.6 7714,-3161.2 7852.08,-3272.85 8057.32,-3327.86 8172.18,-3351.35"/>
<polygon fill="black" stroke="black" points="8171.83,-3354.85 8182.33,-3353.4 8173.21,-3347.99 8171.83,-3354.85"/>
</g>
<!-- clean_data._clean_raw&#45;&gt;clean_data._parse_date -->
<g id="edge160" class="edge">
<title>clean_data._clean_raw&#45;&gt;clean_data._parse_date</title>
<path fill="none" stroke="black" d="M7365.51,-3086.38C7564.85,-3097.06 7911.75,-3115.65 8109.22,-3126.23"/>
<polygon fill="black" stroke="black" points="8109.21,-3129.74 8119.39,-3126.78 8109.59,-3122.75 8109.21,-3129.74"/>
</g>
<!-- clean_data._clean_media -->
<g id="node105" class="node">
<title>clean_data._clean_media</title>
<g id="a_node105"><a xlink:title="Remove unused media files older than ``cutoff``.">
<polygon fill="none" stroke="black" points="7402,-3154.2 7022,-3154.2 7022,-3114.2 7402,-3114.2 7402,-3154.2"/>
<text text-anchor="middle" x="7212" y="-3127.13" font-family="Times,serif" font-size="28.84">clean_data._clean_media</text>
</a>
</g>
</g>
<!-- clean_data._clean_media&#45;&gt;caption_io.has_caption -->
<g id="edge162" class="edge">
<title>clean_data._clean_media&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M7402.18,-3122.81C7512.65,-3120.48 7637.98,-3126.74 7678,-3163.2 7754.48,-3232.89 7638.61,-3322.34 7714,-3393.2 7778.06,-3453.42 8034.56,-3453.17 8171.23,-3448.45"/>
<polygon fill="black" stroke="black" points="8171.39,-3451.95 8181.26,-3448.09 8171.14,-3444.95 8171.39,-3451.95"/>
</g>
<!-- clean_data._clean_media&#45;&gt;clean_data._parse_date -->
<g id="edge163" class="edge">
<title>clean_data._clean_media&#45;&gt;clean_data._parse_date</title>
<path fill="none" stroke="black" d="M7402.24,-3134.2C7605.25,-3134.2 7923.44,-3134.2 8109.27,-3134.2"/>
<polygon fill="black" stroke="black" points="8109.39,-3137.7 8119.39,-3134.2 8109.39,-3130.7 8109.39,-3137.7"/>
</g>
<!-- clean_data._clean_lots -->
<g id="node106" class="node">
<title>clean_data._clean_lots</title>
<g id="a_node106"><a xlink:title="Drop lots missing translations or source posts.">
<polygon fill="none" stroke="black" points="7414,-2586.2 7010,-2586.2 7010,-2540.2 7414,-2540.2 7414,-2586.2"/>
<text text-anchor="middle" x="7212" y="-2554.76" font-family="Times,serif" font-size="34.30">clean_data._clean_lots</text>
</a>
</g>
</g>
<!-- clean_data._clean_lots&#45;&gt;lot_io.read_lots -->
<g id="edge165" class="edge">
<title>clean_data._clean_lots&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M7414.29,-2585.04C7507.27,-2583.5 7611.55,-2563.23 7678,-2493.2 7734.86,-2433.28 7662.86,-2188.08 7714,-2123.2 7816.99,-1992.55 8016.11,-1952.32 8142.76,-1940.16"/>
<polygon fill="black" stroke="black" points="8143.25,-1943.63 8152.89,-1939.24 8142.61,-1936.66 8143.25,-1943.63"/>
</g>
<!-- clean_data._clean_lots&#45;&gt;post_io.raw_post_path -->
<g id="edge166" class="edge">
<title>clean_data._clean_lots&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7414.29,-2558.46C7508.44,-2567.56 7613.73,-2596.12 7678,-2671.2 7749,-2754.15 7648.63,-3073.75 7714,-3161.2 7823.02,-3307.06 8048.59,-3349.15 8172.27,-3361.29"/>
<polygon fill="black" stroke="black" points="8172.17,-3364.8 8182.46,-3362.24 8172.83,-3357.83 8172.17,-3364.8"/>
</g>
<!-- clean_data._clean_lots&#45;&gt;lot_io.needs_cleanup -->
<g id="edge164" class="edge">
<title>clean_data._clean_lots&#45;&gt;lot_io.needs_cleanup</title>
<path fill="none" stroke="black" d="M7414.18,-2563.78C7637.61,-2564.42 7989.2,-2565.43 8159.3,-2565.92"/>
<polygon fill="black" stroke="black" points="8159.49,-2569.42 8169.5,-2565.95 8159.51,-2562.42 8159.49,-2569.42"/>
</g>
<!-- clean_data._clean_embeddings -->
<g id="node107" class="node">
<title>clean_data._clean_embeddings</title>
<g id="a_node107"><a xlink:title="Delete embedding files when the matching lot JSON is absent.">
<polygon fill="none" stroke="black" points="7420,-3208.2 7004,-3208.2 7004,-3172.2 7420,-3172.2 7420,-3208.2"/>
<text text-anchor="middle" x="7212" y="-3184.04" font-family="Times,serif" font-size="25.20">clean_data._clean_embeddings</text>
</a>
</g>
</g>
<!-- clean_data._remove_empty_dirs -->
<g id="node108" class="node">
<title>clean_data._remove_empty_dirs</title>
<g id="a_node108"><a xlink:title="Recursively remove empty folders under ``root``.">
<polygon fill="none" stroke="black" points="8472.5,-3050.2 8045.5,-3050.2 8045.5,-3014.2 8472.5,-3014.2 8472.5,-3050.2"/>
<text text-anchor="middle" x="8259" y="-3026.04" font-family="Times,serif" font-size="25.20">clean_data._remove_empty_dirs</text>
</a>
</g>
</g>
<!-- clean_data.main -->
<g id="node109" class="node">
<title>clean_data.main</title>
<g id="a_node109"><a xlink:title="Clean up old or inconsistent files across data directories.">
<polygon fill="none" stroke="black" points="6305,-3096.2 6113,-3096.2 6113,-3060.2 6305,-3060.2 6305,-3096.2"/>
<text text-anchor="middle" x="6209" y="-3072.9" font-family="Times,serif" font-size="21.00">clean_data.main</text>
</a>
</g>
</g>
<!-- clean_data.main&#45;&gt;clean_data._clean_raw -->
<g id="edge167" class="edge">
<title>clean_data.main&#45;&gt;clean_data._clean_raw</title>
<path fill="none" stroke="black" d="M6305.07,-3078.2C6476.01,-3078.2 6837.05,-3078.2 7048.09,-3078.2"/>
<polygon fill="black" stroke="black" points="7048.33,-3081.7 7058.33,-3078.2 7048.33,-3074.7 7048.33,-3081.7"/>
</g>
<!-- clean_data.main&#45;&gt;clean_data._clean_media -->
<g id="edge168" class="edge">
<title>clean_data.main&#45;&gt;clean_data._clean_media</title>
<path fill="none" stroke="black" d="M6305.07,-3083.52C6466.49,-3092.55 6797.41,-3111.07 7011.48,-3123.04"/>
<polygon fill="black" stroke="black" points="7011.4,-3126.54 7021.58,-3123.61 7011.79,-3119.55 7011.4,-3126.54"/>
</g>
<!-- clean_data.main&#45;&gt;clean_data._clean_lots -->
<g id="edge169" class="edge">
<title>clean_data.main&#45;&gt;clean_data._clean_lots</title>
<path fill="none" stroke="black" d="M6305,-3090.14C6418.9,-3098.6 6607.25,-3092.91 6710,-2982.2 6804.66,-2880.22 6653.32,-2774.99 6746,-2671.2 6809.18,-2600.45 6908.82,-2571.37 6999.69,-2560.85"/>
<polygon fill="black" stroke="black" points="7000.3,-2564.31 7009.87,-2559.75 6999.55,-2557.35 7000.3,-2564.31"/>
</g>
<!-- clean_data.main&#45;&gt;clean_data._clean_embeddings -->
<g id="edge170" class="edge">
<title>clean_data.main&#45;&gt;clean_data._clean_embeddings</title>
<path fill="none" stroke="black" d="M6305.16,-3083.37C6406.99,-3090.73 6572.43,-3107.99 6710,-3147.2 6726.84,-3152 6728.98,-3159.07 6746,-3163.2 6825.51,-3182.5 6914.8,-3190.76 6993.72,-3193.7"/>
<polygon fill="black" stroke="black" points="6993.67,-3197.2 7003.79,-3194.05 6993.91,-3190.2 6993.67,-3197.2"/>
</g>
<!-- clean_data.main&#45;&gt;clean_data._remove_empty_dirs -->
<g id="edge171" class="edge">
<title>clean_data.main&#45;&gt;clean_data._remove_empty_dirs</title>
<path fill="none" stroke="black" d="M6305.33,-3072.31C6412.47,-3065.95 6591.64,-3056.06 6746,-3051.2 7203.85,-3036.8 7740.02,-3033.21 8035.02,-3032.38"/>
<polygon fill="black" stroke="black" points="8035.43,-3035.88 8045.42,-3032.35 8035.41,-3028.88 8035.43,-3035.88"/>
</g>
<!-- tg_client._mark_activity -->
<g id="node110" class="node">
<title>tg_client._mark_activity</title>
<g id="a_node110"><a xlink:title="Update ``_last_event`` to the current time.">
<polygon fill="none" stroke="black" points="4933.5,-4920.2 4747.5,-4920.2 4747.5,-4884.2 4933.5,-4884.2 4933.5,-4920.2"/>
<text text-anchor="middle" x="4840.5" y="-4898.5" font-family="Times,serif" font-size="14.00">tg_client._mark_activity</text>
</a>
</g>
</g>
<!-- tg_client._heartbeat -->
<g id="node111" class="node">
<title>tg_client._heartbeat</title>
<g id="a_node111"><a xlink:title="Periodically log a heartbeat and warn if idle for too long.">
<polygon fill="none" stroke="black" points="1490.5,-4582.2 1260.5,-4582.2 1260.5,-4546.2 1490.5,-4546.2 1490.5,-4582.2"/>
<text text-anchor="middle" x="1375.5" y="-4558.9" font-family="Times,serif" font-size="21.00">tg_client._heartbeat</text>
</a>
</g>
</g>
<!-- tg_client._progress_logger -->
<g id="node112" class="node">
<title>tg_client._progress_logger</title>
<g id="a_node112"><a xlink:title="Return a progress callback that logs received bytes.">
<polygon fill="none" stroke="black" points="5024,-4479.7 4657,-4479.7 4657,-4442.7 5024,-4442.7 5024,-4479.7"/>
<text text-anchor="middle" x="4840.5" y="-4454.76" font-family="Times,serif" font-size="26.18">tg_client._progress_logger</text>
</a>
</g>
</g>
<!-- tg_client._write_md -->
<g id="node113" class="node">
<title>tg_client._write_md</title>
<g id="a_node113"><a xlink:title="Helper to store a raw post in Markdown format.">
<polygon fill="none" stroke="black" points="5465,-4504.2 5328,-4504.2 5328,-4468.2 5465,-4468.2 5465,-4504.2"/>
<text text-anchor="middle" x="5396.5" y="-4482.96" font-family="Times,serif" font-size="12.18">tg_client._write_md</text>
</a>
</g>
</g>
<!-- post_io.write_post -->
<g id="node114" class="node">
<title>post_io.write_post</title>
<g id="a_node114"><a xlink:title="Write metadata and body as a Markdown post.">
<polygon fill="none" stroke="black" points="6375,-4636.2 6043,-4636.2 6043,-4590.2 6375,-4590.2 6375,-4636.2"/>
<text text-anchor="middle" x="6209" y="-4604.76" font-family="Times,serif" font-size="34.30">post_io.write_post</text>
</a>
</g>
</g>
<!-- tg_client._write_md&#45;&gt;post_io.write_post -->
<g id="edge172" class="edge">
<title>tg_client._write_md&#45;&gt;post_io.write_post</title>
<path fill="none" stroke="black" d="M5465.02,-4477.94C5524.38,-4474.2 5610.65,-4477.67 5672,-4518.2 5698.91,-4535.98 5680.64,-4564.14 5708,-4581.2 5816.85,-4649.11 5966.24,-4649.39 6073.33,-4637.43"/>
<polygon fill="black" stroke="black" points="6074.03,-4640.87 6083.56,-4636.24 6073.22,-4633.92 6074.03,-4640.87"/>
</g>
<!-- post_io.write_post&#45;&gt;notes_utils.write_md -->
<g id="edge266" class="edge">
<title>post_io.write_post&#45;&gt;notes_utils.write_md</title>
<path fill="none" stroke="black" d="M6375.01,-4612.22C6575.55,-4611.01 6909.26,-4609.01 7088.4,-4607.94"/>
<polygon fill="black" stroke="black" points="7088.67,-4611.44 7098.65,-4607.88 7088.63,-4604.44 7088.67,-4611.44"/>
</g>
<!-- post_io.get_contact -->
<g id="node135" class="node">
<title>post_io.get_contact</title>
<g id="a_node135"><a xlink:title="Return a contact identifier from ``meta`` or ``None`` when missing.">
<polygon fill="none" stroke="black" points="7311.5,-4737.2 7112.5,-4737.2 7112.5,-4701.2 7311.5,-4701.2 7311.5,-4737.2"/>
<text text-anchor="middle" x="7212" y="-4714.42" font-family="Times,serif" font-size="18.48">post_io.get_contact</text>
</a>
</g>
</g>
<!-- post_io.write_post&#45;&gt;post_io.get_contact -->
<g id="edge267" class="edge">
<title>post_io.write_post&#45;&gt;post_io.get_contact</title>
<path fill="none" stroke="black" d="M6375.25,-4594.39C6476.99,-4590.11 6607.17,-4598.23 6710,-4650.2 6731.94,-4661.3 6723.97,-4681.29 6746,-4692.2 6857.91,-4747.66 7004.03,-4746.03 7102.36,-4736.01"/>
<polygon fill="black" stroke="black" points="7102.75,-4739.49 7112.32,-4734.95 7102,-4732.53 7102.75,-4739.49"/>
</g>
<!-- post_io.get_timestamp -->
<g id="node160" class="node">
<title>post_io.get_timestamp</title>
<g id="a_node160"><a xlink:title="Return ``meta[&#39;date&#39;]`` as a timezone&#45;aware ``datetime``.">
<polygon fill="none" stroke="black" points="7383.5,-4683.2 7040.5,-4683.2 7040.5,-4643.2 7383.5,-4643.2 7383.5,-4683.2"/>
<text text-anchor="middle" x="7212" y="-4656.13" font-family="Times,serif" font-size="28.84">post_io.get_timestamp</text>
</a>
</g>
</g>
<!-- post_io.write_post&#45;&gt;post_io.get_timestamp -->
<g id="edge268" class="edge">
<title>post_io.write_post&#45;&gt;post_io.get_timestamp</title>
<path fill="none" stroke="black" d="M6375.01,-4621.45C6555.44,-4630.46 6843.68,-4644.86 7030.14,-4654.17"/>
<polygon fill="black" stroke="black" points="7030.17,-4657.68 7040.33,-4654.68 7030.52,-4650.69 7030.17,-4657.68"/>
</g>
<!-- tg_client._scan_group_cache -->
<g id="node115" class="node">
<title>tg_client._scan_group_cache</title>
<g id="a_node115"><a xlink:title="Build group_id &#45;&gt; Path mapping for ``chat`` quickly.">
<polygon fill="none" stroke="black" points="7451.5,-3627.7 6972.5,-3627.7 6972.5,-3584.7 7451.5,-3584.7 7451.5,-3627.7"/>
<text text-anchor="middle" x="7212" y="-3598.06" font-family="Times,serif" font-size="32.06">tg_client._scan_group_cache</text>
</a>
</g>
</g>
<!-- tg_client._scan_group_cache&#45;&gt;post_io.raw_post_path -->
<g id="edge173" class="edge">
<title>tg_client._scan_group_cache&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7451.77,-3612.97C7547.33,-3610.61 7643.03,-3600.17 7678,-3570.2 7731.05,-3524.75 7661.32,-3463.09 7714,-3417.2 7841.19,-3306.42 8054.15,-3324.93 8172.36,-3346.57"/>
<polygon fill="black" stroke="black" points="8171.98,-3350.06 8182.45,-3348.47 8173.27,-3343.18 8171.98,-3350.06"/>
</g>
<!-- tg_client._find_group_path -->
<g id="node116" class="node">
<title>tg_client._find_group_path</title>
<g id="a_node116"><a xlink:title="Return stored message path for ``group_id`` if known.">
<polygon fill="none" stroke="black" points="6342,-3728.2 6076,-3728.2 6076,-3692.2 6342,-3692.2 6342,-3728.2"/>
<text text-anchor="middle" x="6209" y="-3705.42" font-family="Times,serif" font-size="18.48">tg_client._find_group_path</text>
</a>
</g>
</g>
<!-- tg_client._find_group_path&#45;&gt;tg_client._scan_group_cache -->
<g id="edge174" class="edge">
<title>tg_client._find_group_path&#45;&gt;tg_client._scan_group_cache</title>
<path fill="none" stroke="black" d="M6342.08,-3696.3C6443.17,-3684.86 6585.85,-3667.02 6710,-3645.2 6726.14,-3642.37 6729.78,-3639.53 6746,-3637.2 6815.75,-3627.19 6891.86,-3620.4 6961.93,-3615.8"/>
<polygon fill="black" stroke="black" points="6962.47,-3619.27 6972.22,-3615.14 6962.02,-3612.29 6962.47,-3619.27"/>
</g>
<!-- tg_client._get_message_path -->
<g id="node117" class="node">
<title>tg_client._get_message_path</title>
<g id="a_node117"><a xlink:title="Return path of stored message ``msg_id`` in ``chat`` if any.">
<polygon fill="none" stroke="black" points="3225,-3392.2 2986,-3392.2 2986,-3356.2 3225,-3356.2 3225,-3392.2"/>
<text text-anchor="middle" x="3105.5" y="-3370.16" font-family="Times,serif" font-size="15.68">tg_client._get_message_path</text>
</a>
</g>
</g>
<!-- tg_client._get_message_path&#45;&gt;post_io.raw_post_path -->
<g id="edge175" class="edge">
<title>tg_client._get_message_path&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M3225.21,-3373.28C3505.9,-3371.17 4232.49,-3366.2 4839.5,-3366.2 4839.5,-3366.2 4839.5,-3366.2 6210,-3366.2 6970.82,-3366.2 7890.63,-3366.2 8172.08,-3366.2"/>
<polygon fill="black" stroke="black" points="8172.22,-3369.7 8182.22,-3366.2 8172.22,-3362.7 8172.22,-3369.7"/>
</g>
<!-- tg_client._should_skip_media -->
<g id="node118" class="node">
<title>tg_client._should_skip_media</title>
<g id="a_node118"><a xlink:title="Return reason string if ``msg`` media should be skipped.">
<polygon fill="none" stroke="black" points="5085,-4789.7 4596,-4789.7 4596,-4746.7 5085,-4746.7 5085,-4789.7"/>
<text text-anchor="middle" x="4840.5" y="-4760.06" font-family="Times,serif" font-size="32.06">tg_client._should_skip_media</text>
</a>
</g>
</g>
<!-- tg_client._allowed_topic -->
<g id="node119" class="node">
<title>tg_client._allowed_topic</title>
<g id="a_node119"><a xlink:title="Return ``True`` if ``msg`` belongs to an allowed forum topic.">
<polygon fill="none" stroke="black" points="5608.5,-4789.7 5184.5,-4789.7 5184.5,-4744.7 5608.5,-4744.7 5608.5,-4789.7"/>
<text text-anchor="middle" x="5396.5" y="-4758.82" font-family="Times,serif" font-size="33.60">tg_client._allowed_topic</text>
</a>
</g>
</g>
<!-- tg_client._extract_author -->
<g id="node120" class="node">
<title>tg_client._extract_author</title>
<g id="a_node120"><a xlink:title="Return a metadata dictionary describing the message author.">
<polygon fill="none" stroke="black" points="6572,-4828.2 5846,-4828.2 5846,-4758.2 6572,-4758.2 6572,-4828.2"/>
<text text-anchor="middle" x="6209" y="-4779.4" font-family="Times,serif" font-size="56.00">tg_client._extract_author</text>
</a>
</g>
</g>
<!-- tg_client._extract_author&#45;&gt;phone_utils.format_georgian -->
<g id="edge176" class="edge">
<title>tg_client._extract_author&#45;&gt;phone_utils.format_georgian</title>
<path fill="none" stroke="black" d="M6572.09,-4793.2C6714.06,-4793.2 6872.15,-4793.2 6995.55,-4793.2"/>
<polygon fill="black" stroke="black" points="6995.88,-4796.7 7005.88,-4793.2 6995.88,-4789.7 6995.88,-4796.7"/>
</g>
<!-- tg_client._schedule_caption -->
<g id="node121" class="node">
<title>tg_client._schedule_caption</title>
<g id="a_node121"><a xlink:title="Run captioning in a separate process so downloads continue.">
<polygon fill="none" stroke="black" points="5535.5,-4450.2 5257.5,-4450.2 5257.5,-4414.2 5535.5,-4414.2 5535.5,-4450.2"/>
<text text-anchor="middle" x="5396.5" y="-4427.42" font-family="Times,serif" font-size="18.48">tg_client._schedule_caption</text>
</a>
</g>
</g>
<!-- tg_client._schedule_chop -->
<g id="node122" class="node">
<title>tg_client._schedule_chop</title>
<g id="a_node122"><a xlink:title="Run lot extraction in a separate process.">
<polygon fill="none" stroke="black" points="8407,-3516.2 8111,-3516.2 8111,-3480.2 8407,-3480.2 8407,-3516.2"/>
<text text-anchor="middle" x="8259" y="-3492.51" font-family="Times,serif" font-size="22.12">tg_client._schedule_chop</text>
</a>
</g>
</g>
<!-- tg_client._enqueue_chop -->
<g id="node123" class="node">
<title>tg_client._enqueue_chop</title>
<g id="a_node123"><a xlink:title="Queue ``path`` for chopping once captions are available.">
<polygon fill="none" stroke="black" points="5083,-3849.7 4598,-3849.7 4598,-3800.7 5083,-3800.7 5083,-3849.7"/>
<text text-anchor="middle" x="4840.5" y="-3815.58" font-family="Times,serif" font-size="37.66">tg_client._enqueue_chop</text>
</a>
</g>
</g>
<!-- tg_client._enqueue_chop&#45;&gt;moderation.should_skip_message -->
<g id="edge177" class="edge">
<title>tg_client._enqueue_chop&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M4845.65,-3800.23C4870.88,-3647.79 5005.23,-2826.85 5085,-2153.2 5090.17,-2109.55 5090.29,-1790.66 5121,-1759.2 5220.5,-1657.28 7566.21,-1482.93 7678,-1571.2 7732.15,-1613.96 7662.24,-1676.59 7714,-1722.2 7837.39,-1830.95 8042.7,-1819.59 8162.69,-1800.84"/>
<polygon fill="black" stroke="black" points="8163.28,-1804.29 8172.6,-1799.25 8162.17,-1797.38 8163.28,-1804.29"/>
</g>
<!-- tg_client._enqueue_chop&#45;&gt;caption_io.has_caption -->
<g id="edge178" class="edge">
<title>tg_client._enqueue_chop&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M5083.13,-3814.59C5095.94,-3814.1 5108.62,-3813.64 5121,-3813.2 5827.05,-3788.5 6004.59,-3809.11 6710,-3770.2 6726.03,-3769.32 6729.98,-3768.24 6746,-3767.2 6797.72,-3763.86 7639.65,-3759.07 7678,-3724.2 7762.04,-3647.81 7630.09,-3547.75 7714,-3471.2 7778.75,-3412.14 8034.94,-3424.45 8171.39,-3435.75"/>
<polygon fill="black" stroke="black" points="8171.14,-3439.24 8181.4,-3436.59 8171.73,-3432.26 8171.14,-3439.24"/>
</g>
<!-- tg_client._start_chop_worker -->
<g id="node124" class="node">
<title>tg_client._start_chop_worker</title>
<g id="a_node124"><a xlink:title="Ensure the chop queue worker task is running.">
<polygon fill="none" stroke="black" points="5529.5,-3858.2 5263.5,-3858.2 5263.5,-3822.2 5529.5,-3822.2 5529.5,-3858.2"/>
<text text-anchor="middle" x="5396.5" y="-3836.04" font-family="Times,serif" font-size="17.08">tg_client._start_chop_worker</text>
</a>
</g>
</g>
<!-- tg_client._enqueue_chop&#45;&gt;tg_client._start_chop_worker -->
<g id="edge179" class="edge">
<title>tg_client._enqueue_chop&#45;&gt;tg_client._start_chop_worker</title>
<path fill="none" stroke="black" d="M5083.28,-3831.75C5141.19,-3833.32 5201.19,-3834.94 5252.93,-3836.34"/>
<polygon fill="black" stroke="black" points="5253.07,-3839.85 5263.16,-3836.62 5253.26,-3832.85 5253.07,-3839.85"/>
</g>
<!-- tg_client._chop_worker -->
<g id="node125" class="node">
<title>tg_client._chop_worker</title>
<g id="a_node125"><a xlink:title="Background task processing ``_CHOP_QUEUE``.">
<polygon fill="none" stroke="black" points="6334.5,-3858.2 6083.5,-3858.2 6083.5,-3822.2 6334.5,-3822.2 6334.5,-3858.2"/>
<text text-anchor="middle" x="6209" y="-3835.41" font-family="Times,serif" font-size="19.74">tg_client._chop_worker</text>
</a>
</g>
</g>
<!-- tg_client._start_chop_worker&#45;&gt;tg_client._chop_worker -->
<g id="edge180" class="edge">
<title>tg_client._start_chop_worker&#45;&gt;tg_client._chop_worker</title>
<path fill="none" stroke="black" d="M5529.52,-3840.2C5679.27,-3840.2 5922.18,-3840.2 6073.1,-3840.2"/>
<polygon fill="black" stroke="black" points="6073.36,-3843.7 6083.36,-3840.2 6073.36,-3836.7 6073.36,-3843.7"/>
</g>
<!-- tg_client._process_chop_queue -->
<g id="node126" class="node">
<title>tg_client._process_chop_queue</title>
<g id="a_node126"><a xlink:title="Check queued posts and chop cooled down ones.">
<polygon fill="none" stroke="black" points="7393.5,-3812.2 7030.5,-3812.2 7030.5,-3776.2 7393.5,-3776.2 7393.5,-3812.2"/>
<text text-anchor="middle" x="7212" y="-3788.51" font-family="Times,serif" font-size="22.12">tg_client._process_chop_queue</text>
</a>
</g>
</g>
<!-- tg_client._chop_worker&#45;&gt;tg_client._process_chop_queue -->
<g id="edge183" class="edge">
<title>tg_client._chop_worker&#45;&gt;tg_client._process_chop_queue</title>
<path fill="none" stroke="black" d="M6334.5,-3834.48C6506.56,-3826.58 6818.58,-3812.24 7020.17,-3802.97"/>
<polygon fill="black" stroke="black" points="7020.46,-3806.46 7030.29,-3802.51 7020.14,-3799.47 7020.46,-3806.46"/>
</g>
<!-- tg_client._process_chop_queue&#45;&gt;caption_io.has_caption -->
<g id="edge181" class="edge">
<title>tg_client._process_chop_queue&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M7393.7,-3804.57C7506.46,-3806.85 7637.61,-3800.46 7678,-3762.2 7772.62,-3672.59 7618.53,-3559.91 7714,-3471.2 7778.21,-3411.55 8034.64,-3424.13 8171.27,-3435.61"/>
<polygon fill="black" stroke="black" points="8171.03,-3439.1 8181.29,-3436.47 8171.63,-3432.13 8171.03,-3439.1"/>
</g>
<!-- tg_client._process_chop_queue&#45;&gt;tg_client._schedule_chop -->
<g id="edge182" class="edge">
<title>tg_client._process_chop_queue&#45;&gt;tg_client._schedule_chop</title>
<path fill="none" stroke="black" d="M7393.63,-3804.17C7506.16,-3806.26 7637.06,-3799.8 7678,-3762.2 7754.86,-3691.63 7636.79,-3600.39 7714,-3530.2 7768.86,-3480.33 7960.47,-3479.53 8100.81,-3486.41"/>
<polygon fill="black" stroke="black" points="8100.66,-3489.91 8110.82,-3486.92 8101.01,-3482.92 8100.66,-3489.91"/>
</g>
<!-- tg_client._flush_chop_queue -->
<g id="node127" class="node">
<title>tg_client._flush_chop_queue</title>
<g id="a_node127"><a xlink:title="Run the chop worker until the queue is empty and cancel it.">
<polygon fill="none" stroke="black" points="4170,-3853.7 3734,-3853.7 3734,-3812.7 4170,-3812.7 4170,-3853.7"/>
<text text-anchor="middle" x="3952" y="-3825.96" font-family="Times,serif" font-size="29.68">tg_client._flush_chop_queue</text>
</a>
</g>
</g>
<!-- tg_client._flush_chop_queue&#45;&gt;tg_client._process_chop_queue -->
<g id="edge184" class="edge">
<title>tg_client._flush_chop_queue&#45;&gt;tg_client._process_chop_queue</title>
<path fill="none" stroke="black" d="M4030.97,-3812.66C4151.23,-3782.07 4389.66,-3725.73 4596,-3703.2 5063.02,-3652.22 6243.01,-3631.94 6710,-3683.2 6726.29,-3684.99 6730,-3687.65 6746,-3691.2 6875.68,-3719.98 7025.72,-3753.2 7119.49,-3773.95"/>
<polygon fill="black" stroke="black" points="7119,-3777.43 7129.52,-3776.17 7120.51,-3770.6 7119,-3777.43"/>
</g>
<!-- tg_client._get_id_date -->
<g id="node128" class="node">
<title>tg_client._get_id_date</title>
<g id="a_node128"><a xlink:title="Return the stored date for ``msg_id`` in ``chat`` if available.">
<polygon fill="none" stroke="black" points="7384,-3925.7 7040,-3925.7 7040,-3884.7 7384,-3884.7 7384,-3925.7"/>
<text text-anchor="middle" x="7212" y="-3897.96" font-family="Times,serif" font-size="29.68">tg_client._get_id_date</text>
</a>
</g>
</g>
<!-- tg_client._get_id_date&#45;&gt;post_io.raw_post_path -->
<g id="edge186" class="edge">
<title>tg_client._get_id_date&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7384.09,-3916.68C7499.24,-3920.33 7637.21,-3915.43 7678,-3875.2 7750.69,-3803.52 7642.36,-3489.94 7714,-3417.2 7835.61,-3293.76 8060.66,-3320.52 8179.61,-3345.98"/>
<polygon fill="black" stroke="black" points="8179.22,-3349.47 8189.73,-3348.2 8180.71,-3342.64 8179.22,-3349.47"/>
</g>
<!-- tg_client._get_id_date&#45;&gt;notes_utils.read_text -->
<g id="edge185" class="edge">
<title>tg_client._get_id_date&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M7384.27,-3898.47C7481.05,-3894.9 7604.26,-3890.74 7714,-3888.2 8416.79,-3872 9261.07,-3866.34 9565.23,-3864.74"/>
<polygon fill="black" stroke="black" points="9565.4,-3868.24 9575.38,-3864.69 9565.36,-3861.24 9565.4,-3868.24"/>
</g>
<!-- tg_client._load_progress -->
<g id="node129" class="node">
<title>tg_client._load_progress</title>
<g id="a_node129"><a xlink:title="Return saved resume timestamp for ``chat`` if available.">
<polygon fill="none" stroke="black" points="2098,-4359.2 1768,-4359.2 1768,-4323.2 2098,-4323.2 2098,-4359.2"/>
<text text-anchor="middle" x="1933" y="-4335.04" font-family="Times,serif" font-size="25.20">tg_client._load_progress</text>
</a>
</g>
</g>
<!-- tg_client._load_progress&#45;&gt;notes_utils.read_text -->
<g id="edge187" class="edge">
<title>tg_client._load_progress&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M2093.18,-4359.24C2633.53,-4421.8 4374.49,-4634.79 4560,-4802.2 4603.55,-4841.51 4549.62,-4893.27 4596,-4929.2 4876.97,-5146.89 5040.07,-4948.2 5395.5,-4948.2 5395.5,-4948.2 5395.5,-4948.2 8260,-4948.2 8807.99,-4948.2 9064.38,-4967.39 9430,-4559.2 9480.95,-4502.33 9443.46,-4464.16 9466,-4391.2 9526.86,-4194.22 9631.6,-3968.38 9668.32,-3891.48"/>
<polygon fill="black" stroke="black" points="9671.49,-3892.97 9672.65,-3882.44 9665.17,-3889.95 9671.49,-3892.97"/>
</g>
<!-- tg_client._save_progress -->
<g id="node130" class="node">
<title>tg_client._save_progress</title>
<g id="a_node130"><a xlink:title="Persist resume timestamp for ``chat`` to ``STATE_DIR``.">
<polygon fill="none" stroke="black" points="2615,-4120.2 2386,-4120.2 2386,-4084.2 2615,-4084.2 2615,-4120.2"/>
<text text-anchor="middle" x="2500.5" y="-4098.04" font-family="Times,serif" font-size="17.08">tg_client._save_progress</text>
</a>
</g>
</g>
<!-- tg_client.get_first_id -->
<g id="node131" class="node">
<title>tg_client.get_first_id</title>
<g id="a_node131"><a xlink:title="Return the smallest saved message id for ``chat``.">
<polygon fill="none" stroke="black" points="3239,-3490.2 2972,-3490.2 2972,-3454.2 3239,-3454.2 3239,-3490.2"/>
<text text-anchor="middle" x="3105.5" y="-3466.33" font-family="Times,serif" font-size="24.22">tg_client.get_first_id</text>
</a>
</g>
</g>
<!-- tg_client.get_first_id&#45;&gt;post_io.raw_post_path -->
<g id="edge188" class="edge">
<title>tg_client.get_first_id&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M3239.12,-3473.23C3529.28,-3475.39 4242.27,-3480.2 4839.5,-3480.2 4839.5,-3480.2 4839.5,-3480.2 6210,-3480.2 6972,-3480.2 7891.01,-3400.56 8172.17,-3374.41"/>
<polygon fill="black" stroke="black" points="8172.67,-3377.88 8182.3,-3373.47 8172.02,-3370.91 8172.67,-3377.88"/>
</g>
<!-- tg_client.get_last_id -->
<g id="node132" class="node">
<title>tg_client.get_last_id</title>
<g id="a_node132"><a xlink:title="Return the highest saved message id for ``chat``.">
<polygon fill="none" stroke="black" points="2063.5,-3768.2 1802.5,-3768.2 1802.5,-3732.2 2063.5,-3732.2 2063.5,-3768.2"/>
<text text-anchor="middle" x="1933" y="-3744.33" font-family="Times,serif" font-size="24.22">tg_client.get_last_id</text>
</a>
</g>
</g>
<!-- tg_client.get_last_id&#45;&gt;post_io.raw_post_path -->
<g id="edge189" class="edge">
<title>tg_client.get_last_id&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M1997.46,-3732.13C2172.33,-3683.97 2676.57,-3556.2 3104.5,-3556.2 3104.5,-3556.2 3104.5,-3556.2 6210,-3556.2 6291.57,-3556.2 7612.67,-3581.04 7678,-3532.2 7720.9,-3500.14 7672.37,-3450.9 7714,-3417.2 7844.75,-3311.37 8055.39,-3327.69 8172.5,-3347.71"/>
<polygon fill="black" stroke="black" points="8172.04,-3351.18 8182.5,-3349.47 8173.25,-3344.29 8172.04,-3351.18"/>
</g>
<!-- tg_client._save_message -->
<g id="node133" class="node">
<title>tg_client._save_message</title>
<g id="a_node133"><a xlink:title="Write ``msg`` to disk with metadata and any media references.&#10;&#10;Returns the path of the stored message or ``None`` when skipped.">
<polygon fill="none" stroke="black" points="4560,-4471.7 3344,-4471.7 3344,-4356.7 4560,-4356.7 4560,-4471.7"/>
<text text-anchor="middle" x="3952" y="-4390.09" font-family="Times,serif" font-size="97.02">tg_client._save_message</text>
</a>
</g>
</g>
<!-- tg_client._save_message&#45;&gt;moderation.should_skip_user -->
<g id="edge190" class="edge">
<title>tg_client._save_message&#45;&gt;moderation.should_skip_user</title>
<path fill="none" stroke="black" d="M4526.97,-4471.73C4538.59,-4480.69 4549.64,-4490.49 4560,-4501.2 4611.13,-4554.07 4542.04,-4780.23 4596,-4830.2 4661.2,-4890.6 5306.62,-4856.2 5395.5,-4856.2 5395.5,-4856.2 5395.5,-4856.2 8260,-4856.2 8796.49,-4856.2 8931.74,-4758.09 9430,-4559.2 9511.24,-4526.78 9598.75,-4472.93 9646.12,-4442.01"/>
<polygon fill="black" stroke="black" points="9648.33,-4444.74 9654.77,-4436.32 9644.49,-4438.89 9648.33,-4444.74"/>
</g>
<!-- tg_client._save_message&#45;&gt;post_io.read_post -->
<g id="edge202" class="edge">
<title>tg_client._save_message&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M4285.87,-4356.64C4389.63,-4321.93 4494.04,-4266.32 4560,-4177.2 4622.85,-4092.3 4571.63,-3805.99 4596,-3703.2 4737.66,-3105.71 4630.66,-2794.85 5121,-2425.2 5348.7,-2253.55 7393.22,-2220.85 7678,-2206.2 7772.9,-2201.33 7876.49,-2195.16 7969.52,-2189.32"/>
<polygon fill="black" stroke="black" points="7969.89,-2192.81 7979.65,-2188.68 7969.45,-2185.82 7969.89,-2192.81"/>
</g>
<!-- tg_client._save_message&#45;&gt;post_io.raw_post_path -->
<g id="edge203" class="edge">
<title>tg_client._save_message&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M4283.01,-4356.65C4387.35,-4321.94 4492.85,-4266.31 4560,-4177.2 4611.85,-4108.4 4533.06,-3850.03 4596,-3791.2 4681.83,-3710.98 6594.54,-3758.94 6710,-3737.2 6726.72,-3734.06 6729.3,-3727.43 6746,-3724.2 6796.87,-3714.37 7639.66,-3726.05 7678,-3691.2 7768.89,-3608.59 7625.55,-3502.43 7714,-3417.2 7837.62,-3298.09 8058.33,-3321.9 8177.07,-3346.09"/>
<polygon fill="black" stroke="black" points="8176.68,-3349.58 8187.19,-3348.2 8178.11,-3342.73 8176.68,-3349.58"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._mark_activity -->
<g id="edge191" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._mark_activity</title>
<path fill="none" stroke="black" d="M4523.76,-4471.83C4536.58,-4481.58 4548.71,-4492.34 4560,-4504.2 4616.35,-4563.4 4539.16,-4811.48 4596,-4870.2 4631.79,-4907.18 4687.95,-4916.4 4737.32,-4915.83"/>
<polygon fill="black" stroke="black" points="4737.51,-4919.32 4747.42,-4915.57 4737.34,-4912.32 4737.51,-4919.32"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._progress_logger -->
<g id="edge192" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._progress_logger</title>
<path fill="none" stroke="black" d="M4560.22,-4446.4C4590.34,-4447.99 4619.28,-4449.53 4646.37,-4450.97"/>
<polygon fill="black" stroke="black" points="4646.49,-4454.48 4656.66,-4451.51 4646.86,-4447.49 4646.49,-4454.48"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._write_md -->
<g id="edge193" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._write_md</title>
<path fill="none" stroke="black" d="M4560.07,-4408.93C4800.04,-4409.78 5031.67,-4415.46 5085,-4433.2 5103.73,-4439.43 5102.54,-4452.22 5121,-4459.2 5184.24,-4483.14 5261.24,-4488.88 5317.57,-4489.22"/>
<polygon fill="black" stroke="black" points="5317.84,-4492.72 5327.84,-4489.23 5317.84,-4485.72 5317.84,-4492.72"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._find_group_path -->
<g id="edge194" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._find_group_path</title>
<path fill="none" stroke="black" d="M4284.73,-4356.65C4388.72,-4321.94 4493.57,-4266.32 4560,-4177.2 4617.97,-4099.44 4525.3,-3808.61 4596,-3742.2 4649.09,-3692.34 5681.6,-3702.41 6065.69,-3707.92"/>
<polygon fill="black" stroke="black" points="6065.7,-3711.42 6075.75,-3708.06 6065.8,-3704.42 6065.7,-3711.42"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._should_skip_media -->
<g id="edge195" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._should_skip_media</title>
<path fill="none" stroke="black" d="M4521.57,-4471.79C4535.13,-4481.53 4547.99,-4492.3 4560,-4504.2 4632.88,-4576.4 4523.1,-4660.02 4596,-4732.2 4598.95,-4735.12 4602.02,-4737.87 4605.21,-4740.46"/>
<polygon fill="black" stroke="black" points="4603.25,-4743.37 4613.35,-4746.57 4607.45,-4737.77 4603.25,-4743.37"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._allowed_topic -->
<g id="edge196" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._allowed_topic</title>
<path fill="none" stroke="black" d="M4520.51,-4471.77C4534.42,-4481.5 4547.63,-4492.28 4560,-4504.2 4623.12,-4565.08 4530.85,-4639.5 4596,-4698.2 4636.49,-4734.69 5030.7,-4732.42 5085,-4737.2 5113.84,-4739.75 5144.17,-4742.54 5174.12,-4745.36"/>
<polygon fill="black" stroke="black" points="5173.97,-4748.86 5184.26,-4746.32 5174.63,-4741.89 5173.97,-4748.86"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._extract_author -->
<g id="edge197" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._extract_author</title>
<path fill="none" stroke="black" d="M4522.76,-4471.72C4535.92,-4481.49 4548.38,-4492.29 4560,-4504.2 4651.9,-4598.46 4497.42,-4710.96 4596,-4798.2 4685.53,-4877.44 5552.45,-4798.76 5672,-4798.2 5724.89,-4797.96 5780.72,-4797.57 5835.57,-4797.13"/>
<polygon fill="black" stroke="black" points="5835.83,-4800.62 5845.8,-4797.04 5835.77,-4793.63 5835.83,-4800.62"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._enqueue_chop -->
<g id="edge198" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._enqueue_chop</title>
<path fill="none" stroke="black" d="M4269.55,-4356.66C4376.54,-4321.86 4487.19,-4266.18 4560,-4177.2 4618.86,-4105.27 4543.38,-4047.82 4596,-3971.2 4634.65,-3914.94 4702.74,-3876.82 4757.11,-3853.68"/>
<polygon fill="black" stroke="black" points="4758.51,-3856.89 4766.4,-3849.82 4755.82,-3850.43 4758.51,-3856.89"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._save_message -->
<g id="edge199" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._save_message</title>
<path fill="none" stroke="black" d="M3802.09,-4471.81C3821.06,-4482.33 3871.04,-4489.7 3952,-4489.7 4022.21,-4489.7 4069.12,-4484.16 4092.71,-4475.83"/>
<polygon fill="black" stroke="black" points="4094.15,-4479.02 4101.91,-4471.81 4091.35,-4472.6 4094.15,-4479.02"/>
</g>
<!-- tg_client._save_media -->
<g id="node134" class="node">
<title>tg_client._save_media</title>
<g id="a_node134"><a xlink:title="Store ``data`` and return relative file path.">
<polygon fill="none" stroke="black" points="5081.5,-4386.2 4599.5,-4386.2 4599.5,-4332.2 5081.5,-4332.2 5081.5,-4386.2"/>
<text text-anchor="middle" x="4840.5" y="-4348.6" font-family="Times,serif" font-size="42.00">tg_client._save_media</text>
</a>
</g>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._save_media -->
<g id="edge200" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._save_media</title>
<path fill="none" stroke="black" d="M4560.22,-4376.53C4570.02,-4375.92 4579.7,-4375.32 4589.22,-4374.73"/>
<polygon fill="black" stroke="black" points="4589.74,-4378.21 4599.5,-4374.09 4589.3,-4371.22 4589.74,-4378.21"/>
</g>
<!-- tg_client._save_message&#45;&gt;post_io.get_contact -->
<g id="edge201" class="edge">
<title>tg_client._save_message&#45;&gt;post_io.get_contact</title>
<path fill="none" stroke="black" d="M4425.43,-4471.74C4482.85,-4477.79 4540.72,-4483.46 4596,-4488.2 4610.91,-4489.48 5659.94,-4540.33 5672,-4549.2 5708.7,-4576.21 5671.05,-4618.54 5708,-4645.2 5798.35,-4710.39 6599.7,-4667.5 6710,-4683.2 6726.33,-4685.53 6729.7,-4689.72 6746,-4692.2 6867.09,-4710.69 7007.69,-4716.75 7102.31,-4718.62"/>
<polygon fill="black" stroke="black" points="7102.41,-4722.12 7112.47,-4718.81 7102.54,-4715.13 7102.41,-4722.12"/>
</g>
<!-- tg_client._save_media&#45;&gt;caption_io.caption_json_path -->
<g id="edge204" class="edge">
<title>tg_client._save_media&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M5081.83,-4359.07C5247.66,-4359.3 5473.23,-4360.23 5672,-4363.2 6020.12,-4368.42 8556.82,-4513.4 8804,-4268.2 8853.08,-4219.52 8809.4,-4021.2 8840,-3959.2 8899.34,-3838.96 9030.85,-3741.18 9095.96,-3698.05"/>
<polygon fill="black" stroke="black" points="9098.25,-3700.74 9104.69,-3692.33 9094.41,-3694.88 9098.25,-3700.74"/>
</g>
<!-- tg_client._save_media&#45;&gt;caption_io.has_caption -->
<g id="edge205" class="edge">
<title>tg_client._save_media&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M4924.67,-4332.13C4977.44,-4310.99 5043.39,-4276.65 5085,-4226.2 5118.54,-4185.54 5078.87,-4144.88 5121,-4113.2 5262.17,-4007.06 6566.38,-4173 6710,-4070.2 6747.39,-4043.44 6708.81,-4000.24 6746,-3973.2 6829.83,-3912.26 7603.41,-4006.17 7678,-3934.2 7752.27,-3862.55 7640.01,-3543.15 7714,-3471.2 7776.87,-3410.07 8034.22,-3423.35 8171.22,-3435.31"/>
<polygon fill="black" stroke="black" points="8171.01,-3438.8 8181.28,-3436.2 8171.63,-3431.83 8171.01,-3438.8"/>
</g>
<!-- tg_client._save_media&#45;&gt;tg_client._schedule_caption -->
<g id="edge206" class="edge">
<title>tg_client._save_media&#45;&gt;tg_client._schedule_caption</title>
<path fill="none" stroke="black" d="M5020.32,-4386.24C5053.75,-4391.07 5088.42,-4395.92 5121,-4400.2 5161.87,-4405.58 5206.22,-4410.96 5247.12,-4415.72"/>
<polygon fill="black" stroke="black" points="5246.83,-4419.21 5257.16,-4416.89 5247.63,-4412.26 5246.83,-4419.21"/>
</g>
<!-- image_io.write_image_meta -->
<g id="node136" class="node">
<title>image_io.write_image_meta</title>
<g id="a_node136"><a xlink:title="Write ``meta`` to ``path.with_suffix(&#39;.md&#39;)``.">
<polygon fill="none" stroke="black" points="6326.5,-4572.2 6091.5,-4572.2 6091.5,-4536.2 6326.5,-4536.2 6326.5,-4572.2"/>
<text text-anchor="middle" x="6209" y="-4550.16" font-family="Times,serif" font-size="15.68">image_io.write_image_meta</text>
</a>
</g>
</g>
<!-- tg_client._save_media&#45;&gt;image_io.write_image_meta -->
<g id="edge207" class="edge">
<title>tg_client._save_media&#45;&gt;image_io.write_image_meta</title>
<path fill="none" stroke="black" d="M5081.5,-4365.83C5318.47,-4373.38 5648.83,-4387.08 5672,-4405.2 5714.85,-4438.73 5665.29,-4488.5 5708,-4522.2 5763.8,-4566.24 5952.17,-4567.09 6081.08,-4561.95"/>
<polygon fill="black" stroke="black" points="6081.57,-4565.43 6091.42,-4561.52 6081.28,-4558.44 6081.57,-4565.43"/>
</g>
<!-- image_io.write_image_meta&#45;&gt;notes_utils.write_md -->
<g id="edge240" class="edge">
<title>image_io.write_image_meta&#45;&gt;notes_utils.write_md</title>
<path fill="none" stroke="black" d="M6326.79,-4560.39C6517.54,-4570.49 6894.16,-4590.43 7088.53,-4600.72"/>
<polygon fill="black" stroke="black" points="7088.62,-4604.23 7098.79,-4601.26 7088.99,-4597.24 7088.62,-4604.23"/>
</g>
<!-- tg_client._save_bounded -->
<g id="node137" class="node">
<title>tg_client._save_bounded</title>
<g id="a_node137"><a xlink:title="Run ``_save_message`` under the global semaphore and return path.">
<polygon fill="none" stroke="black" points="3308,-4390.2 2903,-4390.2 2903,-4348.2 3308,-4348.2 3308,-4390.2"/>
<text text-anchor="middle" x="3105.5" y="-4361.12" font-family="Times,serif" font-size="31.36">tg_client._save_bounded</text>
</a>
</g>
</g>
<!-- tg_client._save_bounded&#45;&gt;tg_client._save_message -->
<g id="edge208" class="edge">
<title>tg_client._save_bounded&#45;&gt;tg_client._save_message</title>
<path fill="none" stroke="black" d="M3308.24,-4379.95C3316.57,-4380.4 3325.06,-4380.85 3333.69,-4381.31"/>
<polygon fill="black" stroke="black" points="3333.7,-4384.82 3343.88,-4381.85 3334.08,-4377.83 3333.7,-4384.82"/>
</g>
<!-- tg_client._remove_local_message -->
<g id="node138" class="node">
<title>tg_client._remove_local_message</title>
<g id="a_node138"><a xlink:title="Delete ``path`` and related media if the post no longer exists.">
<polygon fill="none" stroke="black" points="7497,-2804.2 6927,-2804.2 6927,-2760.2 7497,-2760.2 7497,-2804.2"/>
<text text-anchor="middle" x="7212" y="-2773.88" font-family="Times,serif" font-size="32.90">tg_client._remove_local_message</text>
</a>
</g>
</g>
<!-- tg_client._remove_local_message&#45;&gt;post_io.read_post -->
<g id="edge211" class="edge">
<title>tg_client._remove_local_message&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7497.12,-2792.57C7577.32,-2789.17 7650.34,-2777.84 7678,-2750.2 7759.47,-2668.8 7634.45,-2316.48 7714,-2233.2 7779.26,-2164.88 7875.84,-2140.11 7969.58,-2135.37"/>
<polygon fill="black" stroke="black" points="7969.97,-2138.86 7979.81,-2134.94 7969.67,-2131.87 7969.97,-2138.86"/>
</g>
<!-- tg_client._remove_local_message&#45;&gt;caption_io.caption_json_path -->
<g id="edge209" class="edge">
<title>tg_client._remove_local_message&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M7356.64,-2760.19C7461.73,-2753.02 7599.19,-2763.89 7678,-2851.2 7737.54,-2917.17 7650.28,-3588.26 7714,-3650.2 7807.45,-3741.07 8715.34,-3698.2 9028.46,-3680.53"/>
<polygon fill="black" stroke="black" points="9028.67,-3684.03 9038.45,-3679.96 9028.27,-3677.04 9028.67,-3684.03"/>
</g>
<!-- tg_client._remove_local_message&#45;&gt;caption_io.caption_md_path -->
<g id="edge210" class="edge">
<title>tg_client._remove_local_message&#45;&gt;caption_io.caption_md_path</title>
<path fill="none" stroke="black" d="M7497.23,-2776.43C7932.77,-2767.59 8744.92,-2751.1 9031.03,-2745.3"/>
<polygon fill="black" stroke="black" points="9031.47,-2748.79 9041.4,-2745.08 9031.33,-2741.79 9031.47,-2748.79"/>
</g>
<!-- tg_client._download_messages -->
<g id="node139" class="node">
<title>tg_client._download_messages</title>
<g id="a_node139"><a xlink:title="Save ``messages`` with a progress bar and return count saved.">
<polygon fill="none" stroke="black" points="2855.5,-4352.7 2145.5,-4352.7 2145.5,-4295.7 2855.5,-4295.7 2855.5,-4352.7"/>
<text text-anchor="middle" x="2500.5" y="-4312.86" font-family="Times,serif" font-size="44.80">tg_client._download_messages</text>
</a>
</g>
</g>
<!-- tg_client._download_messages&#45;&gt;tg_client._save_bounded -->
<g id="edge212" class="edge">
<title>tg_client._download_messages&#45;&gt;tg_client._save_bounded</title>
<path fill="none" stroke="black" d="M2855.76,-4350.64C2868.17,-4351.57 2880.47,-4352.49 2892.55,-4353.39"/>
<polygon fill="black" stroke="black" points="2892.42,-4356.89 2902.65,-4354.14 2892.94,-4349.91 2892.42,-4356.89"/>
</g>
<!-- tg_client.ensure_chat_access -->
<g id="node140" class="node">
<title>tg_client.ensure_chat_access</title>
<g id="a_node140"><a xlink:title="Join chats listed in ``CHATS`` if not already joined.">
<polygon fill="none" stroke="black" points="2671.5,-4628.2 2329.5,-4628.2 2329.5,-4592.2 2671.5,-4592.2 2671.5,-4628.2"/>
<text text-anchor="middle" x="2500.5" y="-4604.51" font-family="Times,serif" font-size="22.12">tg_client.ensure_chat_access</text>
</a>
</g>
</g>
<!-- tg_client.refetch_messages -->
<g id="node141" class="node">
<title>tg_client.refetch_messages</title>
<g id="a_node141"><a xlink:title="Re&#45;fetch posts that failed parsing or are empty.">
<polygon fill="none" stroke="black" points="2867,-3314.7 2134,-3314.7 2134,-3249.7 2867,-3249.7 2867,-3314.7"/>
<text text-anchor="middle" x="2500.5" y="-3269.15" font-family="Times,serif" font-size="51.94">tg_client.refetch_messages</text>
</a>
</g>
</g>
<!-- tg_client.refetch_messages&#45;&gt;post_io.read_post -->
<g id="edge218" class="edge">
<title>tg_client.refetch_messages&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M2518.05,-3249.62C2565.59,-3159.12 2711.45,-2902.1 2903,-2760.2 3071.28,-2635.54 3141.59,-2647.95 3344,-2594.2 4814.84,-2203.68 5224.77,-2247.76 6746,-2206.2 7171.79,-2194.57 7665.09,-2183.23 7969.36,-2176.48"/>
<polygon fill="black" stroke="black" points="7969.74,-2179.97 7979.66,-2176.25 7969.58,-2172.97 7969.74,-2179.97"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;post_io.raw_post_path -->
<g id="edge219" class="edge">
<title>tg_client.refetch_messages&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M2867.02,-3300.22C3160.05,-3313.11 3581.83,-3328.2 3951,-3328.2 3951,-3328.2 3951,-3328.2 6210,-3328.2 6970.95,-3328.2 7890.67,-3354.75 8172.09,-3363.47"/>
<polygon fill="black" stroke="black" points="8172.12,-3366.97 8182.23,-3363.78 8172.34,-3359.98 8172.12,-3366.97"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;notes_utils.load_json -->
<g id="edge213" class="edge">
<title>tg_client.refetch_messages&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M2867.02,-3264.19C3160.05,-3251.29 3581.83,-3236.2 3951,-3236.2 3951,-3236.2 3951,-3236.2 7213,-3236.2 7921.59,-3236.2 8103.26,-3234.04 8804,-3339.2 8892.15,-3352.43 8991.72,-3376.32 9058.21,-3393.59"/>
<polygon fill="black" stroke="black" points="9057.62,-3397.06 9068.18,-3396.2 9059.39,-3390.28 9057.62,-3397.06"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;notes_utils.write_json -->
<g id="edge214" class="edge">
<title>tg_client.refetch_messages&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M2507.27,-3249.59C2555.72,-2987.35 2918.5,-1232.2 3951,-1232.2 3951,-1232.2 3951,-1232.2 6210,-1232.2 6536.38,-1232.2 7357.43,-1216.91 7678,-1278.2 7694.71,-1281.4 7697.27,-1288.15 7714,-1291.2 7966.46,-1337.32 8747.34,-1322.32 9030.28,-1315.11"/>
<polygon fill="black" stroke="black" points="9030.64,-1318.6 9040.54,-1314.84 9030.46,-1311.6 9030.64,-1318.6"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;tg_client._get_message_path -->
<g id="edge215" class="edge">
<title>tg_client.refetch_messages&#45;&gt;tg_client._get_message_path</title>
<path fill="none" stroke="black" d="M2714.52,-3314.71C2801.94,-3328.04 2900.25,-3343.04 2976.29,-3354.64"/>
<polygon fill="black" stroke="black" points="2975.98,-3358.14 2986.39,-3356.18 2977.03,-3351.22 2975.98,-3358.14"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;tg_client._save_bounded -->
<g id="edge216" class="edge">
<title>tg_client.refetch_messages&#45;&gt;tg_client._save_bounded</title>
<path fill="none" stroke="black" d="M2519.55,-3314.74C2608.7,-3475.46 3001.31,-4183.2 3087.67,-4338.86"/>
<polygon fill="black" stroke="black" points="3084.77,-4340.85 3092.68,-4347.9 3090.89,-4337.46 3084.77,-4340.85"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;tg_client._remove_local_message -->
<g id="edge217" class="edge">
<title>tg_client.refetch_messages&#45;&gt;tg_client._remove_local_message</title>
<path fill="none" stroke="black" d="M2538.19,-3249.67C2695.44,-3113.74 3332.57,-2598.2 3951,-2598.2 3951,-2598.2 3951,-2598.2 5397.5,-2598.2 6000.63,-2598.2 6145.34,-2695.71 6746,-2750.2 6801.12,-2755.21 6859.97,-2759.82 6916.64,-2763.89"/>
<polygon fill="black" stroke="black" points="6916.6,-2767.4 6926.82,-2764.62 6917.09,-2760.42 6916.6,-2767.4"/>
</g>
<!-- tg_client.fetch_missing -->
<g id="node142" class="node">
<title>tg_client.fetch_missing</title>
<g id="a_node142"><a xlink:title="Pull new messages and back&#45;fill history until fully synced.">
<polygon fill="none" stroke="black" points="1732,-4111.2 1019,-4111.2 1019,-4037.2 1732,-4037.2 1732,-4111.2"/>
<text text-anchor="middle" x="1375.5" y="-4059.38" font-family="Times,serif" font-size="59.78">tg_client.fetch_missing</text>
</a>
</g>
</g>
<!-- tg_client.fetch_missing&#45;&gt;post_io.raw_post_path -->
<g id="edge226" class="edge">
<title>tg_client.fetch_missing&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M1409.97,-4037.04C1473.91,-3967.79 1620.26,-3817.5 1768,-3723.2 2052.61,-3541.56 2161.86,-3518.2 2499.5,-3518.2 2499.5,-3518.2 2499.5,-3518.2 6210,-3518.2 6373.25,-3518.2 7530.28,-3526.7 7678,-3457.2 7699.64,-3447.02 7692.63,-3427.95 7714,-3417.2 7861.53,-3343.06 8059.94,-3346.16 8171.83,-3355.75"/>
<polygon fill="black" stroke="black" points="8171.78,-3359.26 8182.05,-3356.66 8172.41,-3352.28 8171.78,-3359.26"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client._get_id_date -->
<g id="edge220" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client._get_id_date</title>
<path fill="none" stroke="black" d="M1732.1,-4065.59C1952.96,-4060.97 2242.72,-4056.2 2499.5,-4056.2 2499.5,-4056.2 2499.5,-4056.2 5397.5,-4056.2 5543.41,-4056.2 6589.34,-4095.25 6710,-4013.2 6743.25,-3990.6 6712.99,-3953.16 6746,-3930.2 6791.06,-3898.87 6919.1,-3893.74 7029.44,-3895.83"/>
<polygon fill="black" stroke="black" points="7029.65,-3899.34 7039.72,-3896.05 7029.79,-3892.34 7029.65,-3899.34"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client._load_progress -->
<g id="edge221" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client._load_progress</title>
<path fill="none" stroke="black" d="M1453.74,-4111.33C1570.73,-4167.56 1789.35,-4272.64 1885.07,-4318.65"/>
<polygon fill="black" stroke="black" points="1883.69,-4321.87 1894.22,-4323.05 1886.72,-4315.56 1883.69,-4321.87"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client._save_progress -->
<g id="edge222" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client._save_progress</title>
<path fill="none" stroke="black" d="M1732.21,-4083.07C1952.35,-4088.56 2221.46,-4095.27 2375.42,-4099.11"/>
<polygon fill="black" stroke="black" points="2375.77,-4102.62 2385.85,-4099.37 2375.94,-4095.62 2375.77,-4102.62"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client.get_first_id -->
<g id="edge223" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client.get_first_id</title>
<path fill="none" stroke="black" d="M1388.54,-4036.86C1425.18,-3930.19 1546.59,-3624.14 1768,-3504.2 1970.23,-3394.66 2660.35,-3435.55 2961.74,-3459.6"/>
<polygon fill="black" stroke="black" points="2961.61,-3463.1 2971.86,-3460.42 2962.17,-3456.13 2961.61,-3463.1"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client.get_last_id -->
<g id="edge224" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client.get_last_id</title>
<path fill="none" stroke="black" d="M1439.95,-4037.2C1555.5,-3969.8 1797.1,-3828.89 1892.26,-3773.38"/>
<polygon fill="black" stroke="black" points="1894.13,-3776.35 1901,-3768.29 1890.6,-3770.3 1894.13,-3776.35"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client._download_messages -->
<g id="edge225" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client._download_messages</title>
<path fill="none" stroke="black" d="M1542.81,-4111.23C1764.92,-4160.67 2154.39,-4247.38 2361.25,-4293.43"/>
<polygon fill="black" stroke="black" points="2360.75,-4296.9 2371.27,-4295.66 2362.27,-4290.07 2360.75,-4296.9"/>
</g>
<!-- tg_client.remove_deleted -->
<g id="node143" class="node">
<title>tg_client.remove_deleted</title>
<g id="a_node143"><a xlink:title="Delete locally stored messages removed from Telegram recently.">
<polygon fill="none" stroke="black" points="7528.5,-2741.7 6895.5,-2741.7 6895.5,-2680.7 7528.5,-2680.7 7528.5,-2741.7"/>
<text text-anchor="middle" x="7212" y="-2698.95" font-family="Times,serif" font-size="48.44">tg_client.remove_deleted</text>
</a>
</g>
</g>
<!-- tg_client.remove_deleted&#45;&gt;post_io.read_post -->
<g id="edge229" class="edge">
<title>tg_client.remove_deleted&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7528.53,-2687.53C7585.47,-2669.23 7639.03,-2640.29 7678,-2595.2 7730.86,-2534.04 7657.3,-2290.83 7714,-2233.2 7780.03,-2166.1 7876.36,-2141.48 7969.68,-2136.52"/>
<polygon fill="black" stroke="black" points="7970.04,-2140.01 7979.87,-2136.06 7969.72,-2133.02 7970.04,-2140.01"/>
</g>
<!-- tg_client.remove_deleted&#45;&gt;post_io.raw_post_path -->
<g id="edge230" class="edge">
<title>tg_client.remove_deleted&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7350.67,-2680.68C7455.04,-2666.37 7594.35,-2667.7 7678,-2751.2 7742.73,-2815.82 7658.72,-3088.34 7714,-3161.2 7823.91,-3306.09 8048.6,-3348.58 8172.04,-3361.04"/>
<polygon fill="black" stroke="black" points="8171.92,-3364.54 8182.21,-3362.02 8172.59,-3357.57 8171.92,-3364.54"/>
</g>
<!-- tg_client.remove_deleted&#45;&gt;caption_io.caption_json_path -->
<g id="edge227" class="edge">
<title>tg_client.remove_deleted&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M7344.52,-2680.69C7450.23,-2664.73 7594.4,-2663.82 7678,-2751.2 7744.57,-2820.79 7645.52,-3549.49 7714,-3617.2 7757.08,-3659.8 8743.5,-3647.09 8804,-3650.2 8879.01,-3654.07 8963.49,-3660.24 9028.19,-3665.36"/>
<polygon fill="black" stroke="black" points="9028.15,-3668.87 9038.4,-3666.18 9028.71,-3661.89 9028.15,-3668.87"/>
</g>
<!-- tg_client.remove_deleted&#45;&gt;caption_io.caption_md_path -->
<g id="edge228" class="edge">
<title>tg_client.remove_deleted&#45;&gt;caption_io.caption_md_path</title>
<path fill="none" stroke="black" d="M7528.6,-2716.46C7970.85,-2723.83 8752.13,-2736.84 9031.29,-2741.49"/>
<polygon fill="black" stroke="black" points="9031.35,-2745 9041.41,-2741.66 9031.47,-2738 9031.35,-2745"/>
</g>
<!-- tg_client.main -->
<g id="node144" class="node">
<title>tg_client.main</title>
<g id="a_node144"><a xlink:title="Synchronize configured chats and optional live updates.">
<polygon fill="none" stroke="black" points="934.5,-4328.2 366.5,-4328.2 366.5,-4236.2 934.5,-4236.2 934.5,-4328.2"/>
<text text-anchor="middle" x="650.5" y="-4263.16" font-family="Times,serif" font-size="76.30">tg_client.main</text>
</a>
</g>
</g>
<!-- tg_client.main&#45;&gt;tg_client._mark_activity -->
<g id="edge231" class="edge">
<title>tg_client.main&#45;&gt;tg_client._mark_activity</title>
<path fill="none" stroke="black" d="M801.63,-4328.27C1039.13,-4396.95 1517.19,-4518.2 1932,-4518.2 1932,-4518.2 1932,-4518.2 3106.5,-4518.2 3764.72,-4518.2 4031.43,-4409.95 4560,-4802.2 4587.46,-4822.58 4567.92,-4850.69 4596,-4870.2 4636.61,-4898.43 4690.41,-4907.64 4737.11,-4909.28"/>
<polygon fill="black" stroke="black" points="4737.18,-4912.79 4747.26,-4909.53 4737.35,-4905.79 4737.18,-4912.79"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client._heartbeat -->
<g id="edge232" class="edge">
<title>tg_client.main&#45;&gt;tg_client._heartbeat</title>
<path fill="none" stroke="black" d="M700.98,-4328.29C767.52,-4387.17 892.22,-4486.85 1019,-4532.2 1092.82,-4558.62 1180.52,-4566.74 1250.33,-4568.2"/>
<polygon fill="black" stroke="black" points="1250.44,-4571.7 1260.5,-4568.36 1250.56,-4564.7 1250.44,-4571.7"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client._flush_chop_queue -->
<g id="edge233" class="edge">
<title>tg_client.main&#45;&gt;tg_client._flush_chop_queue</title>
<path fill="none" stroke="black" d="M698.47,-4236.05C763.9,-4175.21 889.15,-4070.91 1019,-4028.2 1404.65,-3901.38 1526.03,-4000.2 1932,-4000.2 1932,-4000.2 1932,-4000.2 2501.5,-4000.2 3000.89,-4000.2 3590.74,-3901.17 3835.56,-3855.63"/>
<polygon fill="black" stroke="black" points="3836.36,-3859.04 3845.54,-3853.77 3835.07,-3852.16 3836.36,-3859.04"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client._save_bounded -->
<g id="edge234" class="edge">
<title>tg_client.main&#45;&gt;tg_client._save_bounded</title>
<path fill="none" stroke="black" d="M934.51,-4309.99C1160,-4330.68 1483.89,-4357.17 1768,-4368.2 2165.16,-4383.63 2629.22,-4378.86 2892.82,-4374.01"/>
<polygon fill="black" stroke="black" points="2892.96,-4377.51 2902.89,-4373.83 2892.83,-4370.51 2892.96,-4377.51"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client.ensure_chat_access -->
<g id="edge235" class="edge">
<title>tg_client.main&#45;&gt;tg_client.ensure_chat_access</title>
<path fill="none" stroke="black" d="M687.51,-4328.22C747.25,-4400.39 874.65,-4537.53 1019,-4591.2 1512.46,-4774.69 2163.95,-4676.75 2404.77,-4630.24"/>
<polygon fill="black" stroke="black" points="2405.74,-4633.62 2414.89,-4628.27 2404.41,-4626.74 2405.74,-4633.62"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client.refetch_messages -->
<g id="edge236" class="edge">
<title>tg_client.main&#45;&gt;tg_client.refetch_messages</title>
<path fill="none" stroke="black" d="M695.91,-4236.08C837.37,-4092.17 1295.91,-3648.4 1768,-3437.2 1903.4,-3376.63 2063.67,-3339.25 2199.62,-3316.43"/>
<polygon fill="black" stroke="black" points="2200.49,-3319.83 2209.78,-3314.74 2199.35,-3312.93 2200.49,-3319.83"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client.fetch_missing -->
<g id="edge237" class="edge">
<title>tg_client.main&#45;&gt;tg_client.fetch_missing</title>
<path fill="none" stroke="black" d="M811.51,-4236.17C938.67,-4199.59 1114.7,-4148.95 1235.9,-4114.08"/>
<polygon fill="black" stroke="black" points="1236.99,-4117.41 1245.63,-4111.28 1235.05,-4110.68 1236.99,-4117.41"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client.remove_deleted -->
<g id="edge238" class="edge">
<title>tg_client.main&#45;&gt;tg_client.remove_deleted</title>
<path fill="none" stroke="black" d="M660.35,-4236.07C716.8,-3956.97 1052.5,-2506.2 1932,-2506.2 1932,-2506.2 1932,-2506.2 5397.5,-2506.2 5470.42,-2506.2 6651.91,-2481.12 6710,-2525.2 6755.03,-2559.38 6703.14,-2610.34 6746,-2647.2 6785.54,-2681.21 6834.37,-2702.22 6885.38,-2714.59"/>
<polygon fill="black" stroke="black" points="6884.74,-2718.04 6895.27,-2716.88 6886.31,-2711.22 6884.74,-2718.04"/>
</g>
<!-- image_io.read_image_meta -->
<g id="node145" class="node">
<title>image_io.read_image_meta</title>
<g id="a_node145"><a xlink:title="Return metadata from ``path.with_suffix(&#39;.md&#39;)``.">
<polygon fill="none" stroke="black" points="7326.5,-2484.2 7097.5,-2484.2 7097.5,-2448.2 7326.5,-2448.2 7326.5,-2484.2"/>
<text text-anchor="middle" x="7212" y="-2462.16" font-family="Times,serif" font-size="15.68">image_io.read_image_meta</text>
</a>
</g>
</g>
<!-- image_io.read_image_meta&#45;&gt;notes_utils.parse_md -->
<g id="edge239" class="edge">
<title>image_io.read_image_meta&#45;&gt;notes_utils.parse_md</title>
<path fill="none" stroke="black" d="M7283.37,-2448.18C7379.79,-2424.3 7558.74,-2382.9 7714,-2363.2 7871.45,-2343.23 8056.27,-2337.84 8164.9,-2336.5"/>
<polygon fill="black" stroke="black" points="8165.21,-2340 8175.17,-2336.38 8165.13,-2333 8165.21,-2340"/>
</g>
<!-- scan_ontology.collect_ontology -->
<g id="node146" class="node">
<title>scan_ontology.collect_ontology</title>
<g id="a_node146"><a xlink:title="Return counts per field, value counters, misparsed lots and broken metadata.">
<polygon fill="none" stroke="black" points="6667,-2161.7 5751,-2161.7 5751,-2090.7 6667,-2090.7 6667,-2161.7"/>
<text text-anchor="middle" x="6209" y="-2111.56" font-family="Times,serif" font-size="57.68">scan_ontology.collect_ontology</text>
</a>
</g>
</g>
<!-- scan_ontology.collect_ontology&#45;&gt;moderation.is_misparsed -->
<g id="edge241" class="edge">
<title>scan_ontology.collect_ontology&#45;&gt;moderation.is_misparsed</title>
<path fill="none" stroke="black" d="M6448.48,-2090.66C6545.84,-2063.29 6649.56,-2014.88 6710,-1929.2 6779.15,-1831.19 6677.28,-948.53 6746,-850.2 6810.93,-757.29 6930.07,-710.26 7031.49,-686.47"/>
<polygon fill="black" stroke="black" points="7032.27,-689.88 7041.24,-684.24 7030.72,-683.06 7032.27,-689.88"/>
</g>
<!-- scan_ontology.collect_ontology&#45;&gt;lot_io.read_lots -->
<g id="edge243" class="edge">
<title>scan_ontology.collect_ontology&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M6590.71,-2090.7C7065.2,-2046.45 7849.37,-1973.31 8142.62,-1945.97"/>
<polygon fill="black" stroke="black" points="8143.21,-1949.43 8152.84,-1945.01 8142.56,-1942.46 8143.21,-1949.43"/>
</g>
<!-- scan_ontology.collect_ontology&#45;&gt;post_io.read_post -->
<g id="edge244" class="edge">
<title>scan_ontology.collect_ontology&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M6667.06,-2136.02C7065.48,-2144.58 7631.09,-2156.74 7969.59,-2164.01"/>
<polygon fill="black" stroke="black" points="7969.72,-2167.51 7979.79,-2164.23 7969.87,-2160.51 7969.72,-2167.51"/>
</g>
<!-- scan_ontology.collect_ontology&#45;&gt;post_io.raw_post_path -->
<g id="edge245" class="edge">
<title>scan_ontology.collect_ontology&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M6384.3,-2161.74C6496.56,-2194.29 6635.05,-2254.59 6710,-2363.2 6766.98,-2445.77 6673.69,-2743.67 6746,-2813.2 6820.7,-2885.04 7602.02,-2780.71 7678,-2851.2 7728.84,-2898.37 7671.31,-3106.55 7714,-3161.2 7825.78,-3304.34 8049.19,-3347.54 8172.08,-3360.57"/>
<polygon fill="black" stroke="black" points="8171.89,-3364.07 8182.2,-3361.6 8172.6,-3357.11 8171.89,-3364.07"/>
</g>
<!-- scan_ontology.collect_ontology&#45;&gt;message_utils.gather_chop_input -->
<g id="edge242" class="edge">
<title>scan_ontology.collect_ontology&#45;&gt;message_utils.gather_chop_input</title>
<path fill="none" stroke="black" d="M6667.29,-2117.98C6779.25,-2115.97 6894.12,-2113.9 6989.26,-2112.19"/>
<polygon fill="black" stroke="black" points="6989.35,-2115.69 6999.28,-2112.01 6989.22,-2108.69 6989.35,-2115.69"/>
</g>
<!-- scan_ontology.main -->
<g id="node147" class="node">
<title>scan_ontology.main</title>
<polygon fill="none" stroke="black" points="5624,-2154.7 5169,-2154.7 5169,-2097.7 5624,-2097.7 5624,-2154.7"/>
<text text-anchor="middle" x="5396.5" y="-2115.31" font-family="Times,serif" font-size="44.24">scan_ontology.main</text>
</g>
<!-- scan_ontology.main&#45;&gt;notes_utils.write_json -->
<g id="edge246" class="edge">
<title>scan_ontology.main&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M5438.62,-2097.69C5501.63,-2051.36 5620.21,-1953.14 5672,-1837.2 5712.55,-1746.42 5636.26,-1460.06 5708,-1391.2 5874.55,-1231.36 6515.23,-1356.11 6746,-1350.2 7660.43,-1326.82 7889.61,-1350.93 8804,-1326.2 8879.9,-1324.15 8965.58,-1320.48 9030.6,-1317.41"/>
<polygon fill="black" stroke="black" points="9031.03,-1320.89 9040.86,-1316.92 9030.7,-1313.9 9031.03,-1320.89"/>
</g>
<!-- scan_ontology.main&#45;&gt;scan_ontology.collect_ontology -->
<g id="edge247" class="edge">
<title>scan_ontology.main&#45;&gt;scan_ontology.collect_ontology</title>
<path fill="none" stroke="black" d="M5624.08,-2126.2C5660.99,-2126.2 5700.38,-2126.2 5740.6,-2126.2"/>
<polygon fill="black" stroke="black" points="5740.85,-2129.7 5750.85,-2126.2 5740.85,-2122.7 5740.85,-2129.7"/>
</g>
<!-- log_utils.install_excepthook -->
<g id="node148" class="node">
<title>log_utils.install_excepthook</title>
<g id="a_node148"><a xlink:title="Redirect uncaught exceptions to ``logger.exception``.">
<polygon fill="none" stroke="black" points="6395.5,-2570.2 6022.5,-2570.2 6022.5,-2534.2 6395.5,-2534.2 6395.5,-2570.2"/>
<text text-anchor="middle" x="6209" y="-2546.04" font-family="Times,serif" font-size="25.20">log_utils.install_excepthook</text>
</a>
</g>
</g>
<!-- scan_ontology.main&#45;&gt;log_utils.install_excepthook -->
<g id="edge248" class="edge">
<title>scan_ontology.main&#45;&gt;log_utils.install_excepthook</title>
<path fill="none" stroke="black" d="M5427.84,-2154.88C5481.06,-2206.08 5593.06,-2317.93 5672,-2425.2 5690.89,-2450.87 5681.47,-2469.56 5708,-2487.2 5796.52,-2546.09 5913.59,-2563.73 6012.19,-2566.01"/>
<polygon fill="black" stroke="black" points="6012.22,-2569.51 6022.28,-2566.19 6012.35,-2562.51 6012.22,-2569.51"/>
</g>
<!-- log_utils._extract_tb_lineno -->
<g id="node149" class="node">
<title>log_utils._extract_tb_lineno</title>
<g id="a_node149"><a xlink:title="Return the last line number from a traceback.">
<polygon fill="none" stroke="black" points="7327.5,-2896.2 7096.5,-2896.2 7096.5,-2860.2 7327.5,-2860.2 7327.5,-2896.2"/>
<text text-anchor="middle" x="7212" y="-2874.16" font-family="Times,serif" font-size="15.68">log_utils._extract_tb_lineno</text>
</a>
</g>
</g>
<!-- log_utils.install_excepthook&#45;&gt;log_utils._extract_tb_lineno -->
<g id="edge253" class="edge">
<title>log_utils.install_excepthook&#45;&gt;log_utils._extract_tb_lineno</title>
<path fill="none" stroke="black" d="M6242.57,-2570.31C6356.66,-2633.73 6732.19,-2842.15 6746,-2846.2 6857.82,-2878.99 6990.97,-2885.02 7086.08,-2884.01"/>
<polygon fill="black" stroke="black" points="7086.37,-2887.51 7096.32,-2883.88 7086.28,-2880.51 7086.37,-2887.51"/>
</g>
<!-- log_utils._add_exc_line -->
<g id="node150" class="node">
<title>log_utils._add_exc_line</title>
<g id="a_node150"><a xlink:title="Attach ``line`` from traceback to structured log events.">
<polygon fill="none" stroke="black" points="6350.5,-2873.2 6067.5,-2873.2 6067.5,-2837.2 6350.5,-2837.2 6350.5,-2873.2"/>
<text text-anchor="middle" x="6209" y="-2849.61" font-family="Times,serif" font-size="23.24">log_utils._add_exc_line</text>
</a>
</g>
</g>
<!-- log_utils._add_exc_line&#45;&gt;log_utils._extract_tb_lineno -->
<g id="edge249" class="edge">
<title>log_utils._add_exc_line&#45;&gt;log_utils._extract_tb_lineno</title>
<path fill="none" stroke="black" d="M6350.5,-2858.43C6546.46,-2862.94 6898.8,-2871.03 7086.06,-2875.33"/>
<polygon fill="black" stroke="black" points="7086.15,-2878.84 7096.23,-2875.57 7086.31,-2871.84 7086.15,-2878.84"/>
</g>
<!-- log_utils.init_logger -->
<g id="node151" class="node">
<title>log_utils.init_logger</title>
<g id="a_node151"><a xlink:title="Initialize logger writing to ``LOGFILE``.&#10;&#10;``LOG_LEVEL`` may be set in ``config.py`` or via an environment&#10;variable. &#160;The level accepts ``DEBUG``, ``INFO`` or ``ERROR`` and&#10;defaults to ``INFO``. &#160;The function falls back to the standard&#10;``logging`` module if ``structlog`` isn&#39;t available so the scripts&#10;can still run in minimal environments.">
<polygon fill="none" stroke="black" points="6556.5,-2973.2 5861.5,-2973.2 5861.5,-2891.2 6556.5,-2891.2 6556.5,-2973.2"/>
<text text-anchor="middle" x="6209" y="-2915.22" font-family="Times,serif" font-size="67.48">log_utils.init_logger</text>
</a>
</g>
</g>
<!-- log_utils.init_logger&#45;&gt;log_utils._extract_tb_lineno -->
<g id="edge250" class="edge">
<title>log_utils.init_logger&#45;&gt;log_utils._extract_tb_lineno</title>
<path fill="none" stroke="black" d="M6556.59,-2913.51C6740.06,-2903.61 6954.1,-2892.06 7086.09,-2884.94"/>
<polygon fill="black" stroke="black" points="7086.44,-2888.43 7096.24,-2884.4 7086.07,-2881.44 7086.44,-2888.43"/>
</g>
<!-- log_utils.get_logger -->
<g id="node152" class="node">
<title>log_utils.get_logger</title>
<g id="a_node152"><a xlink:title="Return the singleton logger instance.">
<polygon fill="none" stroke="black" points="7280.5,-2950.2 7143.5,-2950.2 7143.5,-2914.2 7280.5,-2914.2 7280.5,-2950.2"/>
<text text-anchor="middle" x="7212" y="-2928.96" font-family="Times,serif" font-size="12.18">log_utils.get_logger</text>
</a>
</g>
</g>
<!-- log_utils.init_logger&#45;&gt;log_utils.get_logger -->
<g id="edge251" class="edge">
<title>log_utils.init_logger&#45;&gt;log_utils.get_logger</title>
<path fill="none" stroke="black" d="M6556.59,-2925.75C6764.01,-2924.94 7010.49,-2925.81 7133.33,-2928.38"/>
<polygon fill="black" stroke="black" points="7133.32,-2931.88 7143.39,-2928.6 7133.47,-2924.88 7133.32,-2931.88"/>
</g>
<!-- log_utils.get_logger&#45;&gt;log_utils.init_logger -->
<g id="edge252" class="edge">
<title>log_utils.get_logger&#45;&gt;log_utils.init_logger</title>
<path fill="none" stroke="black" d="M7143.39,-2935.81C7026.24,-2938.5 6777.76,-2939.47 6566.62,-2938.7"/>
<polygon fill="black" stroke="black" points="6566.6,-2935.2 6556.59,-2938.66 6566.58,-2942.2 6566.6,-2935.2"/>
</g>
<!-- lot_io.get_timestamp -->
<g id="node154" class="node">
<title>lot_io.get_timestamp</title>
<g id="a_node154"><a xlink:title="Return ``lot[&#39;timestamp&#39;]`` as a timezone&#45;aware ``datetime``.">
<polygon fill="none" stroke="black" points="8418,-932.2 8100,-932.2 8100,-892.2 8418,-892.2 8418,-932.2"/>
<text text-anchor="middle" x="8259" y="-905.13" font-family="Times,serif" font-size="28.84">lot_io.get_timestamp</text>
</a>
</g>
</g>
<!-- lot_io.write_lots -->
<g id="node155" class="node">
<title>lot_io.write_lots</title>
<g id="a_node155"><a xlink:title="Write lots to ``path`` using consistent JSON formatting.">
<polygon fill="none" stroke="black" points="7313.5,-928.2 7110.5,-928.2 7110.5,-892.2 7313.5,-892.2 7313.5,-928.2"/>
<text text-anchor="middle" x="7212" y="-904.61" font-family="Times,serif" font-size="23.24">lot_io.write_lots</text>
</a>
</g>
</g>
<!-- lot_io.write_lots&#45;&gt;lot_io.get_seller -->
<g id="edge258" class="edge">
<title>lot_io.write_lots&#45;&gt;lot_io.get_seller</title>
<path fill="none" stroke="black" d="M7270.92,-892.14C7363.35,-861.44 7547.09,-792.6 7678,-693.2 7697.58,-678.34 7691.99,-662.15 7714,-651.2 7851.55,-582.82 8033.43,-587.9 8148.09,-600.77"/>
<polygon fill="black" stroke="black" points="8147.94,-604.27 8158.28,-601.95 8148.75,-597.32 8147.94,-604.27"/>
</g>
<!-- lot_io.write_lots&#45;&gt;notes_utils.write_json -->
<g id="edge256" class="edge">
<title>lot_io.write_lots&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M7302.78,-892.19C7402.03,-877.26 7563.07,-868.24 7678,-937.2 7704.34,-953.01 7687.63,-980.45 7714,-996.2 7922.25,-1120.61 8610.28,-909.21 8804,-1055.2 8843.06,-1084.64 8808.04,-1122.18 8840,-1159.2 8898.14,-1226.56 8993.32,-1268.37 9059.58,-1290.92"/>
<polygon fill="black" stroke="black" points="9058.54,-1294.27 9069.14,-1294.11 9060.76,-1287.63 9058.54,-1294.27"/>
</g>
<!-- lot_io.write_lots&#45;&gt;lot_io._clean_lot -->
<g id="edge257" class="edge">
<title>lot_io.write_lots&#45;&gt;lot_io._clean_lot</title>
<path fill="none" stroke="black" d="M7313.79,-914.52C7408.05,-918.93 7552.7,-926.61 7678,-937.2 7694.04,-938.56 7697.97,-939.72 7714,-941.2 8197.71,-986.03 8327.71,-926.67 8804,-1022.2 8904.81,-1042.43 9017.5,-1084.41 9081.67,-1110.26"/>
<polygon fill="black" stroke="black" points="9080.58,-1113.59 9091.16,-1114.11 9083.21,-1107.11 9080.58,-1113.59"/>
</g>
<!-- lot_io.write_lots&#45;&gt;lot_io.get_timestamp -->
<g id="edge259" class="edge">
<title>lot_io.write_lots&#45;&gt;lot_io.get_timestamp</title>
<path fill="none" stroke="black" d="M7313.67,-910.4C7493.15,-910.74 7870.1,-911.46 8089.59,-911.88"/>
<polygon fill="black" stroke="black" points="8089.59,-915.38 8099.6,-911.9 8089.61,-908.38 8089.59,-915.38"/>
</g>
<!-- lot_io.embedding_path -->
<g id="node157" class="node">
<title>lot_io.embedding_path</title>
<g id="a_node157"><a xlink:title="Return embedding file path for ``lot_path``.">
<polygon fill="none" stroke="black" points="6315.5,-1866.2 6102.5,-1866.2 6102.5,-1830.2 6315.5,-1830.2 6315.5,-1866.2"/>
<text text-anchor="middle" x="6209" y="-1844.04" font-family="Times,serif" font-size="17.08">lot_io.embedding_path</text>
</a>
</g>
</g>
<!-- testing_mode.apply_testing_mode -->
<g id="node158" class="node">
<title>testing_mode.apply_testing_mode</title>
<g id="a_node158"><a xlink:title="Tweak environment variables when ``TEST_MODE`` is set.">
<polygon fill="none" stroke="black" points="282,-4847.2 0,-4847.2 0,-4811.2 282,-4811.2 282,-4847.2"/>
<text text-anchor="middle" x="141" y="-4825.16" font-family="Times,serif" font-size="15.68">testing_mode.apply_testing_mode</text>
</a>
</g>
</g>
<!-- moderation:cli -->
<g id="node159" class="node">
<title>moderation:cli</title>
<g id="a_node159"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="650.5" cy="-4829.2" rx="38.53" ry="18"/>
<text text-anchor="middle" x="650.5" y="-4827.6" font-family="Times,serif" font-size="7.00">moderation:cli</text>
</a>
</g>
</g>
<!-- testing_mode.apply_testing_mode&#45;&gt;moderation:cli -->
<!-- telegram_bot:cli -->
<g id="node169" class="node">
<title>telegram_bot:cli</title>
<g id="a_node169"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="1375.5" cy="-4829.2" rx="111.95" ry="19.18"/>
<text text-anchor="middle" x="1375.5" y="-4825.04" font-family="Times,serif" font-size="17.08">telegram_bot:cli</text>
</a>
</g>
</g>
<!-- moderation:cli&#45;&gt;telegram_bot:cli -->
<!-- post_io.raw_post_path_from_lot -->
<g id="node161" class="node">
<title>post_io.raw_post_path_from_lot</title>
<g id="a_node161"><a xlink:title="Return raw post path referenced by ``lot`` or ``None``.">
<polygon fill="none" stroke="black" points="7357,-3300.2 7067,-3300.2 7067,-3264.2 7357,-3264.2 7357,-3300.2"/>
<text text-anchor="middle" x="7212" y="-3278.04" font-family="Times,serif" font-size="17.08">post_io.raw_post_path_from_lot</text>
</a>
</g>
</g>
<!-- post_io.raw_post_path_from_lot&#45;&gt;post_io.raw_post_path -->
<g id="edge269" class="edge">
<title>post_io.raw_post_path_from_lot&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7357.06,-3291.35C7448.94,-3297.37 7570.51,-3305.69 7678,-3314.2 7853.6,-3328.12 8058.85,-3347.18 8172.05,-3357.94"/>
<polygon fill="black" stroke="black" points="8171.75,-3361.43 8182.04,-3358.89 8172.42,-3354.46 8171.75,-3361.43"/>
</g>
<!-- pending_chop.main -->
<g id="node162" class="node">
<title>pending_chop.main</title>
<polygon fill="none" stroke="black" points="7375.5,-1818.2 7048.5,-1818.2 7048.5,-1776.2 7375.5,-1776.2 7375.5,-1818.2"/>
<text text-anchor="middle" x="7212" y="-1789.12" font-family="Times,serif" font-size="31.36">pending_chop.main</text>
</g>
<!-- pending_chop.main&#45;&gt;moderation.should_skip_message -->
<g id="edge270" class="edge">
<title>pending_chop.main&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M7375.71,-1794.71C7567.28,-1791.78 7884.29,-1786.93 8081.61,-1783.91"/>
<polygon fill="black" stroke="black" points="8081.84,-1787.4 8091.79,-1783.75 8081.74,-1780.4 8081.84,-1787.4"/>
</g>
<!-- pending_chop.main&#45;&gt;post_io.read_post -->
<g id="edge271" class="edge">
<title>pending_chop.main&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7375.68,-1788.2C7490.99,-1785.36 7632.9,-1790.19 7678,-1827.2 7726,-1866.6 7672.45,-1916.06 7714,-1962.2 7792.16,-2049 7910.55,-2099.82 8016.95,-2129.45"/>
<polygon fill="black" stroke="black" points="8016.31,-2132.91 8026.88,-2132.17 8018.16,-2126.15 8016.31,-2132.91"/>
</g>
<!-- check_translations.parse_po -->
<g id="node163" class="node">
<title>check_translations.parse_po</title>
<polygon fill="none" stroke="black" points="1667.5,-4918.2 1083.5,-4918.2 1083.5,-4866.2 1667.5,-4866.2 1667.5,-4918.2"/>
<text text-anchor="middle" x="1375.5" y="-4882.51" font-family="Times,serif" font-size="39.62">check_translations.parse_po</text>
</g>
<!-- check_translations.check_translations -->
<g id="node164" class="node">
<title>check_translations.check_translations</title>
<polygon fill="none" stroke="black" points="983,-4914.7 318,-4914.7 318,-4869.7 983,-4869.7 983,-4914.7"/>
<text text-anchor="middle" x="650.5" y="-4883.82" font-family="Times,serif" font-size="33.60">check_translations.check_translations</text>
</g>
<!-- check_translations.check_translations&#45;&gt;check_translations.parse_po -->
<g id="edge272" class="edge">
<title>check_translations.check_translations&#45;&gt;check_translations.parse_po</title>
<path fill="none" stroke="black" d="M983.11,-4892.2C1013.14,-4892.2 1043.45,-4892.2 1073.19,-4892.2"/>
<polygon fill="black" stroke="black" points="1073.26,-4895.7 1083.26,-4892.2 1073.26,-4888.7 1073.26,-4895.7"/>
</g>
<!-- pending_caption._get_message_path -->
<g id="node165" class="node">
<title>pending_caption._get_message_path</title>
<g id="a_node165"><a xlink:title="Return path of stored message ``msg_id`` in ``chat`` if any.">
<polygon fill="none" stroke="black" points="8409.5,-2638.2 8108.5,-2638.2 8108.5,-2602.2 8409.5,-2602.2 8409.5,-2638.2"/>
<text text-anchor="middle" x="8259" y="-2616.16" font-family="Times,serif" font-size="15.68">pending_caption._get_message_path</text>
</a>
</g>
</g>
<!-- pending_caption.main -->
<g id="node166" class="node">
<title>pending_caption.main</title>
<polygon fill="none" stroke="black" points="6443,-2478.2 5975,-2478.2 5975,-2426.2 6443,-2426.2 6443,-2478.2"/>
<text text-anchor="middle" x="6209" y="-2442.06" font-family="Times,serif" font-size="40.18">pending_caption.main</text>
</g>
<!-- pending_caption.main&#45;&gt;moderation.should_skip_message -->
<g id="edge273" class="edge">
<title>pending_caption.main&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M6443.21,-2464.54C6554.83,-2464.95 6672.32,-2455.44 6710,-2417.2 6811.55,-2314.17 6640.92,-1866.63 6746,-1767.2 6840.95,-1677.36 7703.49,-1735.8 8081.66,-1766.17"/>
<polygon fill="black" stroke="black" points="8081.64,-1769.68 8091.88,-1766.99 8082.2,-1762.7 8081.64,-1769.68"/>
</g>
<!-- pending_caption.main&#45;&gt;post_io.read_post -->
<g id="edge276" class="edge">
<title>pending_caption.main&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M6443.26,-2441.06C6527.51,-2435.67 6623.21,-2427.97 6710,-2417.2 7143.72,-2363.42 7253.15,-2346.69 7678,-2244.2 7694.26,-2240.28 7697.62,-2236.63 7714,-2233.2 7796.28,-2216.02 7886.6,-2203.19 7969.61,-2193.76"/>
<polygon fill="black" stroke="black" points="7970.15,-2197.22 7979.69,-2192.62 7969.36,-2190.26 7970.15,-2197.22"/>
</g>
<!-- pending_caption.main&#45;&gt;caption_io.has_caption -->
<g id="edge274" class="edge">
<title>pending_caption.main&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M6400.54,-2426.2C6507.42,-2423.16 6634.13,-2440.94 6710,-2525.2 6776.45,-2599 6674.98,-3348.8 6746,-3418.2 6847.94,-3517.82 7864.93,-3467.14 8171.18,-3449.47"/>
<polygon fill="black" stroke="black" points="8171.56,-3452.95 8181.34,-3448.88 8171.15,-3445.97 8171.56,-3452.95"/>
</g>
<!-- pending_caption.main&#45;&gt;image_io.read_image_meta -->
<g id="edge275" class="edge">
<title>pending_caption.main&#45;&gt;image_io.read_image_meta</title>
<path fill="none" stroke="black" d="M6443.11,-2455.47C6644.06,-2458.28 6926.42,-2462.22 7086.8,-2464.47"/>
<polygon fill="black" stroke="black" points="7087.14,-2467.97 7097.19,-2464.61 7087.24,-2460.97 7087.14,-2467.97"/>
</g>
<!-- pending_caption.main&#45;&gt;pending_caption._get_message_path -->
<g id="edge277" class="edge">
<title>pending_caption.main&#45;&gt;pending_caption._get_message_path</title>
<path fill="none" stroke="black" d="M6341.89,-2426.19C6451.67,-2412.39 6606.24,-2412.14 6710,-2492.2 6748.39,-2521.83 6706.69,-2566.81 6746,-2595.2 6853.4,-2672.78 7731.52,-2643.56 8098.14,-2627.73"/>
<polygon fill="black" stroke="black" points="8098.46,-2631.22 8108.3,-2627.29 8098.16,-2624.23 8098.46,-2631.22"/>
</g>
<!-- pending_embed._needs_embedding -->
<g id="node167" class="node">
<title>pending_embed._needs_embedding</title>
<g id="a_node167"><a xlink:title="Return ``True`` when ``emb`` is missing or stale.&#10;&#10;The function also upgrades older vector files stored as a single object and&#10;removes corrupted or mismatched ones so ``embed.py`` always operates on&#10;clean data.">
<polygon fill="none" stroke="black" points="8668,-2299.7 7850,-2299.7 7850,-2242.7 8668,-2242.7 8668,-2299.7"/>
<text text-anchor="middle" x="8259" y="-2259.86" font-family="Times,serif" font-size="44.80">pending_embed._needs_embedding</text>
</a>
</g>
</g>
<!-- pending_embed._needs_embedding&#45;&gt;notes_utils.load_json -->
<g id="edge278" class="edge">
<title>pending_embed._needs_embedding&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M8364.4,-2242.66C8487.64,-2215.99 8690.19,-2195.4 8804,-2309.2 8844.56,-2349.76 8824.92,-2768.86 8840,-2824.2 8903.45,-3057.04 9061.85,-3306.62 9115.73,-3387.37"/>
<polygon fill="black" stroke="black" points="9113,-3389.59 9121.48,-3395.95 9118.82,-3385.69 9113,-3389.59"/>
</g>
<!-- pending_embed._needs_embedding&#45;&gt;notes_utils.write_json -->
<g id="edge279" class="edge">
<title>pending_embed._needs_embedding&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M8668.1,-2264.62C8729.94,-2255.64 8780.86,-2240.87 8804,-2217.2 8876.93,-2142.64 8805.76,-1847.73 8840,-1749.2 8901.03,-1573.61 9050.55,-1401.3 9109.52,-1337.81"/>
<polygon fill="black" stroke="black" points="9112.29,-1339.96 9116.57,-1330.27 9107.18,-1335.18 9112.29,-1339.96"/>
</g>
<!-- pending_embed.main -->
<g id="node168" class="node">
<title>pending_embed.main</title>
<polygon fill="none" stroke="black" points="5658.5,-1828.2 5134.5,-1828.2 5134.5,-1768.2 5658.5,-1768.2 5658.5,-1828.2"/>
<text text-anchor="middle" x="5396.5" y="-1786.68" font-family="Times,serif" font-size="46.90">pending_embed.main</text>
</g>
<!-- pending_embed.main&#45;&gt;moderation.message_skip_reason -->
<g id="edge280" class="edge">
<title>pending_embed.main&#45;&gt;moderation.message_skip_reason</title>
<path fill="none" stroke="black" d="M5490.39,-1768.11C5551.64,-1749.21 5633.94,-1725.58 5708,-1710.2 6163.74,-1615.62 6281.96,-1607.44 6746,-1571.2 7201.97,-1535.6 8367.94,-1411.26 8804,-1549.2 8931.23,-1589.45 9051.87,-1698.31 9105.26,-1751.35"/>
<polygon fill="black" stroke="black" points="9102.8,-1753.84 9112.34,-1758.45 9107.76,-1748.9 9102.8,-1753.84"/>
</g>
<!-- pending_embed.main&#45;&gt;moderation.lot_skip_reason -->
<g id="edge281" class="edge">
<title>pending_embed.main&#45;&gt;moderation.lot_skip_reason</title>
<path fill="none" stroke="black" d="M5435.76,-1768.18C5498.19,-1716.62 5620.2,-1604.5 5672,-1478.2 5715.78,-1371.45 5626.6,-1041.99 5708,-960.2 5805.96,-861.79 8330.97,-857.01 8804,-883.2 8820.07,-884.09 8823.98,-885.58 8840,-887.2 8874.96,-890.75 8912.28,-894.34 8948.19,-897.68"/>
<polygon fill="black" stroke="black" points="8947.99,-901.18 8958.27,-898.62 8948.64,-894.21 8947.99,-901.18"/>
</g>
<!-- pending_embed.main&#45;&gt;lot_io.read_lots -->
<g id="edge282" class="edge">
<title>pending_embed.main&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M5658.68,-1770.24C5675.35,-1769.04 5691.9,-1768.01 5708,-1767.2 5926.62,-1756.32 7503.11,-1635.58 7678,-1767.2 7724.19,-1801.97 7669.21,-1855.64 7714,-1892.2 7844.86,-1999.03 8057.33,-1977.91 8174.25,-1955.25"/>
<polygon fill="black" stroke="black" points="8175.1,-1958.65 8184.22,-1953.26 8173.73,-1951.78 8175.1,-1958.65"/>
</g>
<!-- pending_embed.main&#45;&gt;post_io.read_post -->
<g id="edge285" class="edge">
<title>pending_embed.main&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M5453.74,-1828.23C5514.58,-1859.19 5615.32,-1906.1 5708,-1929.2 6560.08,-2141.61 6804.93,-1986.77 7678,-2081.2 7794.75,-2093.83 7923.97,-2113.13 8030.74,-2130.54"/>
<polygon fill="black" stroke="black" points="8030.24,-2134 8040.67,-2132.16 8031.37,-2127.1 8030.24,-2134"/>
</g>
<!-- pending_embed.main&#45;&gt;lot_io.iter_lot_files -->
<g id="edge284" class="edge">
<title>pending_embed.main&#45;&gt;lot_io.iter_lot_files</title>
<path fill="none" stroke="black" d="M5429.19,-1768.15C5484.49,-1714.33 5599.61,-1596.09 5672,-1478.2 5693.9,-1442.54 5673.46,-1414.83 5708,-1391.2 6088.89,-1130.72 6284.59,-1374.09 6746,-1369.2 7160.2,-1364.82 7312.79,-1173.75 7678,-1369.2 7703.43,-1382.82 7690.68,-1406.23 7714,-1423.2 7834.28,-1510.78 8002.85,-1548.64 8120.35,-1564.95"/>
<polygon fill="black" stroke="black" points="8120.11,-1568.45 8130.49,-1566.33 8121.05,-1561.52 8120.11,-1568.45"/>
</g>
<!-- pending_embed.main&#45;&gt;lot_io.embedding_path -->
<g id="edge283" class="edge">
<title>pending_embed.main&#45;&gt;lot_io.embedding_path</title>
<path fill="none" stroke="black" d="M5658.79,-1817.94C5675.44,-1819.08 5691.95,-1820.18 5708,-1821.2 5839.47,-1829.62 5990.5,-1837.54 6091.87,-1842.59"/>
<polygon fill="black" stroke="black" points="6091.97,-1846.1 6102.13,-1843.1 6092.32,-1839.11 6091.97,-1846.1"/>
</g>
<!-- pending_embed.main&#45;&gt;post_io.raw_post_path_from_lot -->
<g id="edge286" class="edge">
<title>pending_embed.main&#45;&gt;post_io.raw_post_path_from_lot</title>
<path fill="none" stroke="black" d="M5441.63,-1828.3C5506.05,-1875.15 5623.46,-1972.31 5672,-2088.2 5715.68,-2192.5 5631.38,-3022.05 5708,-3105.2 5886.77,-3299.24 6710.06,-3297.77 7056.59,-3288.12"/>
<polygon fill="black" stroke="black" points="7056.81,-3291.62 7066.7,-3287.83 7056.61,-3284.62 7056.81,-3291.62"/>
</g>
<!-- pending_embed.main&#45;&gt;pending_embed._needs_embedding -->
<g id="edge287" class="edge">
<title>pending_embed.main&#45;&gt;pending_embed._needs_embedding</title>
<path fill="none" stroke="black" d="M5433.23,-1828.49C5489.92,-1878.04 5601.28,-1981.63 5672,-2088.2 5694.01,-2121.37 5675.11,-2147.79 5708,-2170.2 5879.15,-2286.88 7160.97,-2286.99 7839.47,-2278.57"/>
<polygon fill="black" stroke="black" points="7839.95,-2282.07 7849.91,-2278.44 7839.86,-2275.07 7839.95,-2282.07"/>
</g>
<!-- caption:cli -->
<g id="node170" class="node">
<title>caption:cli</title>
<g id="a_node170"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="1933" cy="-4829.2" rx="30.28" ry="18"/>
<text text-anchor="middle" x="1933" y="-4827.6" font-family="Times,serif" font-size="7.00">caption:cli</text>
</a>
</g>
</g>
<!-- telegram_bot:cli&#45;&gt;caption:cli -->
<!-- embed:cli -->
<g id="node171" class="node">
<title>embed:cli</title>
<g id="a_node171"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="2500.5" cy="-4829.2" rx="29.05" ry="18"/>
<text text-anchor="middle" x="2500.5" y="-4827.6" font-family="Times,serif" font-size="7.00">embed:cli</text>
</a>
</g>
</g>
<!-- caption:cli&#45;&gt;embed:cli -->
<!-- chop:cli -->
<g id="node172" class="node">
<title>chop:cli</title>
<g id="a_node172"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="3105.5" cy="-4829.2" rx="27" ry="18"/>
<text text-anchor="middle" x="3105.5" y="-4827.6" font-family="Times,serif" font-size="7.00">chop:cli</text>
</a>
</g>
</g>
<!-- embed:cli&#45;&gt;chop:cli -->
<!-- debug_dump:cli -->
<g id="node173" class="node">
<title>debug_dump:cli</title>
<g id="a_node173"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="3952" cy="-4829.2" rx="41.11" ry="18"/>
<text text-anchor="middle" x="3952" y="-4827.6" font-family="Times,serif" font-size="7.00">debug_dump:cli</text>
</a>
</g>
</g>
<!-- chop:cli&#45;&gt;debug_dump:cli -->
<!-- build_site:cli -->
<g id="node174" class="node">
<title>build_site:cli</title>
<g id="a_node174"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="141" cy="-4954.2" rx="34.71" ry="18"/>
<text text-anchor="middle" x="141" y="-4952.6" font-family="Times,serif" font-size="7.00">build_site:cli</text>
</a>
</g>
</g>
<!-- clean_data:cli -->
<g id="node175" class="node">
<title>clean_data:cli</title>
<g id="a_node175"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="650.5" cy="-4954.2" rx="37.29" ry="18"/>
<text text-anchor="middle" x="650.5" y="-4952.6" font-family="Times,serif" font-size="7.00">clean_data:cli</text>
</a>
</g>
</g>
<!-- build_site:cli&#45;&gt;clean_data:cli -->
<!-- tg_client:cli -->
<g id="node176" class="node">
<title>tg_client:cli</title>
<g id="a_node176"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="1375.5" cy="-4954.2" rx="32.86" ry="18"/>
<text text-anchor="middle" x="1375.5" y="-4952.6" font-family="Times,serif" font-size="7.00">tg_client:cli</text>
</a>
</g>
</g>
<!-- clean_data:cli&#45;&gt;tg_client:cli -->
<!-- scan_ontology:cli -->
<g id="node177" class="node">
<title>scan_ontology:cli</title>
<g id="a_node177"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="1933" cy="-4954.2" rx="44.19" ry="18"/>
<text text-anchor="middle" x="1933" y="-4952.6" font-family="Times,serif" font-size="7.00">scan_ontology:cli</text>
</a>
</g>
</g>
<!-- tg_client:cli&#45;&gt;scan_ontology:cli -->
<!-- pending_chop:cli -->
<g id="node178" class="node">
<title>pending_chop:cli</title>
<g id="a_node178"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="2500.5" cy="-4954.2" rx="42.96" ry="18"/>
<text text-anchor="middle" x="2500.5" y="-4952.6" font-family="Times,serif" font-size="7.00">pending_chop:cli</text>
</a>
</g>
</g>
<!-- scan_ontology:cli&#45;&gt;pending_chop:cli -->
<!-- check_translations:cli -->
<g id="node179" class="node">
<title>check_translations:cli</title>
<g id="a_node179"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="3105.5" cy="-4954.2" rx="53.05" ry="18"/>
<text text-anchor="middle" x="3105.5" y="-4952.6" font-family="Times,serif" font-size="7.00">check_translations:cli</text>
</a>
</g>
</g>
<!-- pending_chop:cli&#45;&gt;check_translations:cli -->
<!-- pending_caption:cli -->
<g id="node180" class="node">
<title>pending_caption:cli</title>
<g id="a_node180"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="3952" cy="-4954.2" rx="48.62" ry="18"/>
<text text-anchor="middle" x="3952" y="-4952.6" font-family="Times,serif" font-size="7.00">pending_caption:cli</text>
</a>
</g>
</g>
<!-- check_translations:cli&#45;&gt;pending_caption:cli -->
<!-- pending_embed:cli -->
<g id="node181" class="node">
<title>pending_embed:cli</title>
<g id="a_node181"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="141" cy="-5008.2" rx="47.39" ry="18"/>
<text text-anchor="middle" x="141" y="-5006.6" font-family="Times,serif" font-size="7.00">pending_embed:cli</text>
</a>
</g>
</g>
<!-- build_site -->
<g id="node182" class="node">
<title>build_site</title>
<ellipse fill="none" stroke="black" cx="4840.5" cy="-750.2" rx="55.79" ry="18"/>
<text text-anchor="middle" x="4840.5" y="-746.5" font-family="Times,serif" font-size="14.00">build_site</text>
</g>
<!-- build_site&#45;&gt;build_site.main -->
<g id="edge299" class="edge">
<title>build_site:cli&#45;&gt;build_site.main</title>
<path fill="none" stroke="black" d="M4896.65,-750.2C4961.87,-750.2 5074.45,-750.2 5176.18,-750.2"/>
<polygon fill="black" stroke="black" points="5176.3,-753.7 5186.3,-750.2 5176.3,-746.7 5176.3,-753.7"/>
</g>
<!-- caption -->
<g id="node183" class="node">
<title>caption</title>
<ellipse fill="none" stroke="black" cx="5396.5" cy="-4140.2" rx="44.69" ry="18"/>
<text text-anchor="middle" x="5396.5" y="-4136.5" font-family="Times,serif" font-size="14.00">caption</text>
</g>
<!-- caption&#45;&gt;caption.main -->
<g id="edge300" class="edge">
<title>caption:cli&#45;&gt;caption.main</title>
<path fill="none" stroke="black" d="M5441.36,-4140.48C5566.56,-4141.25 5928,-4143.48 6106.2,-4144.58"/>
<polygon fill="black" stroke="black" points="6106.35,-4148.08 6116.37,-4144.64 6106.39,-4141.08 6106.35,-4148.08"/>
</g>
<!-- check_translations -->
<g id="node184" class="node">
<title>check_translations</title>
<ellipse fill="none" stroke="black" cx="141" cy="-4892.2" rx="96.68" ry="18"/>
<text text-anchor="middle" x="141" y="-4888.5" font-family="Times,serif" font-size="14.00">check_translations</text>
</g>
<!-- check_translations&#45;&gt;check_translations.check_translations -->
<g id="edge301" class="edge">
<title>check_translations:cli&#45;&gt;check_translations.check_translations</title>
<path fill="none" stroke="black" d="M238.05,-4892.2C259.3,-4892.2 282.99,-4892.2 307.97,-4892.2"/>
<polygon fill="black" stroke="black" points="307.99,-4895.7 317.99,-4892.2 307.99,-4888.7 307.99,-4895.7"/>
</g>
<!-- chop -->
<g id="node185" class="node">
<title>chop</title>
<ellipse fill="none" stroke="black" cx="4840.5" cy="-1451.2" rx="32.49" ry="18"/>
<text text-anchor="middle" x="4840.5" y="-1447.5" font-family="Times,serif" font-size="14.00">chop</text>
</g>
<!-- chop&#45;&gt;chop.main -->
<g id="edge302" class="edge">
<title>chop:cli&#45;&gt;chop.main</title>
<path fill="none" stroke="black" d="M4873.28,-1451.2C4956.91,-1451.2 5185.32,-1451.2 5310.56,-1451.2"/>
<polygon fill="black" stroke="black" points="5310.88,-1454.7 5320.88,-1451.2 5310.88,-1447.7 5310.88,-1454.7"/>
</g>
<!-- clean_data -->
<g id="node186" class="node">
<title>clean_data</title>
<ellipse fill="none" stroke="black" cx="5396.5" cy="-3078.2" rx="59.59" ry="18"/>
<text text-anchor="middle" x="5396.5" y="-3074.5" font-family="Times,serif" font-size="14.00">clean_data</text>
</g>
<!-- clean_data&#45;&gt;clean_data.main -->
<g id="edge303" class="edge">
<title>clean_data:cli&#45;&gt;clean_data.main</title>
<path fill="none" stroke="black" d="M5456.44,-3078.2C5592.52,-3078.2 5930.11,-3078.2 6102.72,-3078.2"/>
<polygon fill="black" stroke="black" points="6102.83,-3081.7 6112.83,-3078.2 6102.83,-3074.7 6102.83,-3081.7"/>
</g>
<!-- debug_dump -->
<g id="node187" class="node">
<title>debug_dump</title>
<ellipse fill="none" stroke="black" cx="5396.5" cy="-4194.2" rx="70.39" ry="18"/>
<text text-anchor="middle" x="5396.5" y="-4190.5" font-family="Times,serif" font-size="14.00">debug_dump</text>
</g>
<!-- debug_dump&#45;&gt;debug_dump.main -->
<g id="edge304" class="edge">
<title>debug_dump:cli&#45;&gt;debug_dump.main</title>
<path fill="none" stroke="black" d="M5463.83,-4199.61C5571.29,-4208.36 5788.78,-4226.07 5961.01,-4240.09"/>
<polygon fill="black" stroke="black" points="5960.74,-4243.58 5970.99,-4240.9 5961.31,-4236.6 5960.74,-4243.58"/>
</g>
<!-- embed -->
<g id="node188" class="node">
<title>embed</title>
<ellipse fill="none" stroke="black" cx="5396.5" cy="-1176.2" rx="42.49" ry="18"/>
<text text-anchor="middle" x="5396.5" y="-1172.5" font-family="Times,serif" font-size="14.00">embed</text>
</g>
<!-- embed&#45;&gt;embed.main -->
<g id="edge305" class="edge">
<title>embed:cli&#45;&gt;embed.main</title>
<path fill="none" stroke="black" d="M5438.81,-1176.2C5562.62,-1176.2 5933.03,-1176.2 6110.76,-1176.2"/>
<polygon fill="black" stroke="black" points="6110.89,-1179.7 6120.89,-1176.2 6110.89,-1172.7 6110.89,-1179.7"/>
</g>
<!-- moderation -->
<g id="node189" class="node">
<title>moderation</title>
<ellipse fill="none" stroke="black" cx="6209" cy="-1794.2" rx="63.89" ry="18"/>
<text text-anchor="middle" x="6209" y="-1790.5" font-family="Times,serif" font-size="14.00">moderation</text>
</g>
<!-- moderation&#45;&gt;moderation.apply_to_history -->
<g id="edge306" class="edge">
<title>moderation:cli&#45;&gt;moderation.apply_to_history</title>
<path fill="none" stroke="black" d="M6271.1,-1789.8C6388.58,-1782.55 6640.47,-1773.3 6710,-1821.2 6742.44,-1843.55 6713.75,-1879.58 6746,-1902.2 6843.37,-1970.5 6982.17,-1971.26 7082.76,-1959.52"/>
<polygon fill="black" stroke="black" points="7083.49,-1962.96 7092.99,-1958.27 7082.64,-1956.01 7083.49,-1962.96"/>
</g>
<!-- pending_caption -->
<g id="node190" class="node">
<title>pending_caption</title>
<ellipse fill="none" stroke="black" cx="5396.5" cy="-2452.2" rx="87.18" ry="18"/>
<text text-anchor="middle" x="5396.5" y="-2448.5" font-family="Times,serif" font-size="14.00">pending_caption</text>
</g>
<!-- pending_caption&#45;&gt;pending_caption.main -->
<g id="edge307" class="edge">
<title>pending_caption:cli&#45;&gt;pending_caption.main</title>
<path fill="none" stroke="black" d="M5483.85,-2452.2C5597.52,-2452.2 5801.97,-2452.2 5964.71,-2452.2"/>
<polygon fill="black" stroke="black" points="5964.87,-2455.7 5974.87,-2452.2 5964.87,-2448.7 5964.87,-2455.7"/>
</g>
<!-- pending_chop -->
<g id="node191" class="node">
<title>pending_chop</title>
<ellipse fill="none" stroke="black" cx="6209" cy="-1902.2" rx="74.99" ry="18"/>
<text text-anchor="middle" x="6209" y="-1898.5" font-family="Times,serif" font-size="14.00">pending_chop</text>
</g>
<!-- pending_chop&#45;&gt;pending_chop.main -->
<g id="edge308" class="edge">
<title>pending_chop:cli&#45;&gt;pending_chop.main</title>
<path fill="none" stroke="black" d="M6266.58,-1913.8C6363.76,-1930.67 6565.85,-1952.21 6710,-1875.2 6733.52,-1862.64 6722.55,-1839.89 6746,-1827.2 6838.94,-1776.93 6958.09,-1770.15 7052.51,-1775.56"/>
<polygon fill="black" stroke="black" points="7052.53,-1779.07 7062.73,-1776.2 7052.97,-1772.09 7052.53,-1779.07"/>
</g>
<!-- pending_embed -->
<g id="node192" class="node">
<title>pending_embed</title>
<ellipse fill="none" stroke="black" cx="4840.5" cy="-1798.2" rx="83.69" ry="18"/>
<text text-anchor="middle" x="4840.5" y="-1794.5" font-family="Times,serif" font-size="14.00">pending_embed</text>
</g>
<!-- pending_embed&#45;&gt;pending_embed.main -->
<g id="edge309" class="edge">
<title>pending_embed:cli&#45;&gt;pending_embed.main</title>
<path fill="none" stroke="black" d="M4924.44,-1798.2C4978.13,-1798.2 5051.38,-1798.2 5124.11,-1798.2"/>
<polygon fill="black" stroke="black" points="5124.36,-1801.7 5134.36,-1798.2 5124.36,-1794.7 5124.36,-1801.7"/>
</g>
<!-- scan_ontology -->
<g id="node193" class="node">
<title>scan_ontology</title>
<ellipse fill="none" stroke="black" cx="4840.5" cy="-2126.2" rx="76.09" ry="18"/>
<text text-anchor="middle" x="4840.5" y="-2122.5" font-family="Times,serif" font-size="14.00">scan_ontology</text>
</g>
<!-- scan_ontology&#45;&gt;scan_ontology.main -->
<g id="edge310" class="edge">
<title>scan_ontology:cli&#45;&gt;scan_ontology.main</title>
<path fill="none" stroke="black" d="M4916.79,-2126.2C4979.32,-2126.2 5071.8,-2126.2 5158.85,-2126.2"/>
<polygon fill="black" stroke="black" points="5158.88,-2129.7 5168.88,-2126.2 5158.88,-2122.7 5158.88,-2129.7"/>
</g>
<!-- telegram_bot -->
<g id="node194" class="node">
<title>telegram_bot</title>
<ellipse fill="none" stroke="black" cx="3952" cy="-4150.2" rx="72.29" ry="18"/>
<text text-anchor="middle" x="3952" y="-4146.5" font-family="Times,serif" font-size="14.00">telegram_bot</text>
</g>
<!-- telegram_bot&#45;&gt;telegram_bot.send_alert -->
<g id="edge311" class="edge">
<title>telegram_bot:cli&#45;&gt;telegram_bot.send_alert</title>
<path fill="none" stroke="black" d="M4022.56,-4154.05C4159.77,-4161.63 4468.96,-4178.72 4665.16,-4189.57"/>
<polygon fill="black" stroke="black" points="4665.11,-4193.07 4675.29,-4190.13 4665.5,-4186.08 4665.11,-4193.07"/>
</g>
<!-- telegram_bot&#45;&gt;telegram_bot.main -->
<g id="edge312" class="edge">
<title>telegram_bot:cli&#45;&gt;telegram_bot.main</title>
<path fill="none" stroke="black" d="M4012.54,-4140.26C4151.44,-4117.08 4500.02,-4058.88 4697.42,-4025.93"/>
<polygon fill="black" stroke="black" points="4698.29,-4029.33 4707.57,-4024.23 4697.14,-4022.42 4698.29,-4029.33"/>
</g>
<!-- tg_client -->
<g id="node195" class="node">
<title>tg_client</title>
<ellipse fill="none" stroke="black" cx="141" cy="-4282.2" rx="50.89" ry="18"/>
<text text-anchor="middle" x="141" y="-4278.5" font-family="Times,serif" font-size="14.00">tg_client</text>
</g>
<!-- tg_client&#45;&gt;tg_client.main -->
<g id="edge313" class="edge">
<title>tg_client:cli&#45;&gt;tg_client.main</title>
<path fill="none" stroke="black" d="M192.05,-4282.2C232.34,-4282.2 292.58,-4282.2 356.22,-4282.2"/>
<polygon fill="black" stroke="black" points="356.46,-4285.7 366.46,-4282.2 356.46,-4278.7 356.46,-4285.7"/>
</g>
</g>
</svg>
