<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: callgraph Pages: 1 -->
<svg width="10252pt" height="5728pt"
 viewBox="0.00 0.00 10252.00 5727.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 5723.5)">
<title>callgraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-5723.5 10248,-5723.5 10248,4 -4,4"/>
<!-- config_utils.load_config -->
<g id="node1" class="node">
<title>config_utils.load_config</title>
<g id="a_node1"><a xlink:title="Return the ``config`` module or exit with a helpful message.&#10;&#10;When running the scripts directly from ``src/`` the repository root isn&#39;t on&#10;``sys.path`` and ``config.py`` can&#39;t be imported. &#160;Try adding the parent&#10;directory before failing so the configuration can live alongside&#10;``config.example.py`` in the project root.">
<polygon fill="none" stroke="black" points="10193,-452 9760,-452 9760,-405 10193,-405 10193,-452"/>
<text text-anchor="middle" x="9976.5" y="-420" font-family="Times,serif" font-size="35.00">config_utils.load_config</text>
</a>
</g>
</g>
<!-- price_train._iter_lots -->
<g id="node2" class="node">
<title>price_train._iter_lots</title>
<g id="a_node2"><a xlink:title="Return all lots with generated ids.">
<polygon fill="none" stroke="black" points="7680.5,-2443 7369.5,-2443 7369.5,-2404 7680.5,-2404 7680.5,-2443"/>
<text text-anchor="middle" x="7525" y="-2416.6" font-family="Times,serif" font-size="28.00">price_train._iter_lots</text>
</a>
</g>
</g>
<!-- lot_io.read_lots -->
<g id="node3" class="node">
<title>lot_io.read_lots</title>
<g id="a_node3"><a xlink:title="Return a list of lots from ``path`` or ``None`` when invalid.">
<polygon fill="none" stroke="black" points="8669,-2068.5 8457,-2068.5 8457,-2032.5 8669,-2032.5 8669,-2068.5"/>
<text text-anchor="middle" x="8563" y="-2044.34" font-family="Times,serif" font-size="25.20">lot_io.read_lots</text>
</a>
</g>
</g>
<!-- price_train._iter_lots&#45;&gt;lot_io.read_lots -->
<g id="edge1" class="edge">
<title>price_train._iter_lots&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M7680.66,-2435.62C7820.83,-2443.07 8013.78,-2443.35 8070,-2394.5 8132.9,-2339.84 8051.48,-2273.51 8106,-2210.5 8191.62,-2111.54 8342.17,-2073.78 8446.76,-2059.37"/>
<polygon fill="black" stroke="black" points="8447.28,-2062.83 8456.73,-2058.05 8446.36,-2055.89 8447.28,-2062.83"/>
</g>
<!-- lot_io.iter_lot_files -->
<g id="node4" class="node">
<title>lot_io.iter_lot_files</title>
<g id="a_node4"><a xlink:title="Return ``*.json`` files under ``root``.&#10;&#10;When ``newest_first`` is ``True`` the result is ordered by modification&#10;time with the most recently changed files first. &#160;Both ``build_site.py`` and&#10;``pending_embed.py`` rely on this helper so they scan the lot directory in&#10;the same order.">
<polygon fill="none" stroke="black" points="8691.5,-2014 8434.5,-2014 8434.5,-1977 8691.5,-1977 8691.5,-2014"/>
<text text-anchor="middle" x="8563" y="-1989.06" font-family="Times,serif" font-size="26.18">lot_io.iter_lot_files</text>
</a>
</g>
</g>
<!-- price_train._iter_lots&#45;&gt;lot_io.iter_lot_files -->
<g id="edge2" class="edge">
<title>price_train._iter_lots&#45;&gt;lot_io.iter_lot_files</title>
<path fill="none" stroke="black" d="M7680.73,-2436.74C7821.77,-2445.11 8016.07,-2446.13 8070,-2394.5 8129.83,-2337.22 8046.4,-2081.02 8106,-2023.5 8150.05,-1980.98 8306.8,-1979.56 8424.3,-1985.13"/>
<polygon fill="black" stroke="black" points="8424.31,-1988.64 8434.47,-1985.64 8424.66,-1981.65 8424.31,-1988.64"/>
</g>
<!-- notes_utils.load_json -->
<g id="node27" class="node">
<title>notes_utils.load_json</title>
<g id="a_node27"><a xlink:title="Return parsed JSON or ``None`` when invalid.">
<polygon fill="none" stroke="black" points="9488.5,-3868.5 9240.5,-3868.5 9240.5,-3832.5 9488.5,-3832.5 9488.5,-3868.5"/>
<text text-anchor="middle" x="9364.5" y="-3844.8" font-family="Times,serif" font-size="22.12">notes_utils.load_json</text>
</a>
</g>
</g>
<!-- lot_io.read_lots&#45;&gt;notes_utils.load_json -->
<g id="edge272" class="edge">
<title>lot_io.read_lots&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M8669.03,-2055.08C8776.4,-2065.97 8938.6,-2100.87 9020,-2210.5 9074.23,-2283.54 9037.84,-2939.35 9056,-3028.5 9122.37,-3354.29 9299.01,-3721.92 9349.72,-3823.35"/>
<polygon fill="black" stroke="black" points="9346.61,-3824.96 9354.22,-3832.33 9352.86,-3821.82 9346.61,-3824.96"/>
</g>
<!-- lot_io._clean_lot -->
<g id="node162" class="node">
<title>lot_io._clean_lot</title>
<g id="a_node162"><a xlink:title="Return ``lot`` without empty or null fields.">
<polygon fill="none" stroke="black" points="9422,-1348.5 9307,-1348.5 9307,-1312.5 9422,-1312.5 9422,-1348.5"/>
<text text-anchor="middle" x="9364.5" y="-1327.26" font-family="Times,serif" font-size="12.18">lot_io._clean_lot</text>
</a>
</g>
</g>
<!-- lot_io.read_lots&#45;&gt;lot_io._clean_lot -->
<g id="edge273" class="edge">
<title>lot_io.read_lots&#45;&gt;lot_io._clean_lot</title>
<path fill="none" stroke="black" d="M8623.49,-2068.6C8721.29,-2094.25 8915.58,-2127.28 9020,-2022.5 9117.58,-1924.59 8966.85,-1507.15 9056,-1401.5 9114.26,-1332.45 9225.04,-1322.9 9296.52,-1324.84"/>
<polygon fill="black" stroke="black" points="9296.65,-1328.35 9306.77,-1325.21 9296.9,-1321.35 9296.65,-1328.35"/>
</g>
<!-- price_train.main -->
<g id="node5" class="node">
<title>price_train.main</title>
<g id="a_node5"><a xlink:title="Train price regression model and save it.">
<polygon fill="none" stroke="black" points="6536,-2791.5 6306,-2791.5 6306,-2755.5 6536,-2755.5 6536,-2791.5"/>
<text text-anchor="middle" x="6421" y="-2767.34" font-family="Times,serif" font-size="25.20">price_train.main</text>
</a>
</g>
</g>
<!-- price_train.main&#45;&gt;price_train._iter_lots -->
<g id="edge3" class="edge">
<title>price_train.main&#45;&gt;price_train._iter_lots</title>
<path fill="none" stroke="black" d="M6536.17,-2783.94C6671.84,-2793.64 6887.04,-2799.6 6944,-2746.5 7040.29,-2656.74 6883.78,-2542.34 6980,-2452.5 7033.25,-2402.78 7219.41,-2402.4 7359.23,-2409.98"/>
<polygon fill="black" stroke="black" points="7359.04,-2413.48 7369.22,-2410.54 7359.43,-2406.49 7359.04,-2413.48"/>
</g>
<!-- price_utils.train_price_regression -->
<g id="node6" class="node">
<title>price_utils.train_price_regression</title>
<g id="a_node6"><a xlink:title="Return ``(model, currency_map, counts)`` trained on ``lots``.&#10;&#10;``lots`` must contain ``price`` and ``price:currency`` fields. Only lots with&#10;embeddings present in ``id_to_vec`` are considered. Prices are regressed on&#10;the logarithm scale so coefficients are interpretable as multiplicative&#10;factors. ``USD`` is treated as the base currency so coefficients can be&#10;interpreted as exchange rate multipliers. The returned ``counts`` dictionary&#10;maps each currency to the number of training samples observed.">
<polygon fill="none" stroke="black" points="8070,-311 6980,-311 6980,-234 8070,-234 8070,-311"/>
<text text-anchor="middle" x="7525" y="-256.6" font-family="Times,serif" font-size="63.00">price_utils.train_price_regression</text>
</a>
</g>
</g>
<!-- price_train.main&#45;&gt;price_utils.train_price_regression -->
<g id="edge4" class="edge">
<title>price_train.main&#45;&gt;price_utils.train_price_regression</title>
<path fill="none" stroke="black" d="M6536.23,-2784.84C6672.82,-2795.56 6889.84,-2802.69 6944,-2746.5 7037.54,-2649.45 6888.24,-419.24 6980,-320.5 7069.3,-224.41 7220.98,-218.17 7341.53,-232.72"/>
<polygon fill="black" stroke="black" points="7341.26,-236.21 7351.62,-233.99 7342.13,-229.27 7341.26,-236.21"/>
</g>
<!-- price_utils.save_price_model -->
<g id="node7" class="node">
<title>price_utils.save_price_model</title>
<g id="a_node7"><a xlink:title="Write ``model`` parameters to ``path`` as JSON.">
<polygon fill="none" stroke="black" points="7737.5,-2781 7312.5,-2781 7312.5,-2742 7737.5,-2742 7737.5,-2781"/>
<text text-anchor="middle" x="7525" y="-2754.6" font-family="Times,serif" font-size="28.00">price_utils.save_price_model</text>
</a>
</g>
</g>
<!-- price_train.main&#45;&gt;price_utils.save_price_model -->
<g id="edge5" class="edge">
<title>price_train.main&#45;&gt;price_utils.save_price_model</title>
<path fill="none" stroke="black" d="M6536.04,-2772.26C6716.32,-2770.3 7070.42,-2766.44 7302.07,-2763.92"/>
<polygon fill="black" stroke="black" points="7302.35,-2767.41 7312.32,-2763.81 7302.28,-2760.41 7302.35,-2767.41"/>
</g>
<!-- similar_utils._load_embeddings -->
<g id="node8" class="node">
<title>similar_utils._load_embeddings</title>
<g id="a_node8"><a xlink:title="Return mapping of lot id to embedding vector.">
<polygon fill="none" stroke="black" points="8819,-4422.5 8307,-4422.5 8307,-4380.5 8819,-4380.5 8819,-4422.5"/>
<text text-anchor="middle" x="8563" y="-4393.41" font-family="Times,serif" font-size="31.36">similar_utils._load_embeddings</text>
</a>
</g>
</g>
<!-- price_train.main&#45;&gt;similar_utils._load_embeddings -->
<g id="edge6" class="edge">
<title>price_train.main&#45;&gt;similar_utils._load_embeddings</title>
<path fill="none" stroke="black" d="M6460.34,-2791.59C6560.68,-2841.24 6831.07,-2990.43 6944,-3205.5 6986.52,-3286.48 6913.79,-3552.4 6980,-3615.5 7067.74,-3699.12 7982.27,-3574.87 8070,-3658.5 8136.36,-3721.76 8060.89,-3989.68 8106,-4069.5 8195.83,-4228.44 8396.66,-4331.96 8499.18,-4376.48"/>
<polygon fill="black" stroke="black" points="8497.91,-4379.75 8508.48,-4380.48 8500.68,-4373.32 8497.91,-4379.75"/>
</g>
<!-- similar_utils._sync_embeddings -->
<g id="node9" class="node">
<title>similar_utils._sync_embeddings</title>
<g id="a_node9"><a xlink:title="Drop lots or vectors that do not match and return cleaned data.">
<polygon fill="none" stroke="black" points="7763.5,-2839.5 7286.5,-2839.5 7286.5,-2799.5 7763.5,-2799.5 7763.5,-2839.5"/>
<text text-anchor="middle" x="7525" y="-2812.43" font-family="Times,serif" font-size="28.84">similar_utils._sync_embeddings</text>
</a>
</g>
</g>
<!-- price_train.main&#45;&gt;similar_utils._sync_embeddings -->
<g id="edge7" class="edge">
<title>price_train.main&#45;&gt;similar_utils._sync_embeddings</title>
<path fill="none" stroke="black" d="M6536.04,-2778.26C6709.68,-2785.51 7044.57,-2799.49 7275.98,-2809.15"/>
<polygon fill="black" stroke="black" points="7276.09,-2812.65 7286.23,-2809.57 7276.39,-2805.66 7276.09,-2812.65"/>
</g>
<!-- price_utils.canonical_currency -->
<g id="node60" class="node">
<title>price_utils.canonical_currency</title>
<g id="a_node60"><a xlink:title="Return canonical currency code or ``None`` when unknown.">
<polygon fill="none" stroke="black" points="8742.5,-290.5 8383.5,-290.5 8383.5,-254.5 8742.5,-254.5 8742.5,-290.5"/>
<text text-anchor="middle" x="8563" y="-266.8" font-family="Times,serif" font-size="22.12">price_utils.canonical_currency</text>
</a>
</g>
</g>
<!-- price_utils.train_price_regression&#45;&gt;price_utils.canonical_currency -->
<g id="edge170" class="edge">
<title>price_utils.train_price_regression&#45;&gt;price_utils.canonical_currency</title>
<path fill="none" stroke="black" d="M8070.17,-272.5C8179.13,-272.5 8286.55,-272.5 8373.06,-272.5"/>
<polygon fill="black" stroke="black" points="8373.24,-276 8383.24,-272.5 8373.24,-269 8373.24,-276"/>
</g>
<!-- notes_utils.write_json -->
<g id="node28" class="node">
<title>notes_utils.write_json</title>
<g id="a_node28"><a xlink:title="Serialise ``data`` to ``path`` with standard options.">
<polygon fill="none" stroke="black" points="8657,-2935.5 8469,-2935.5 8469,-2899.5 8657,-2899.5 8657,-2935.5"/>
<text text-anchor="middle" x="8563" y="-2913.46" font-family="Times,serif" font-size="15.68">notes_utils.write_json</text>
</a>
</g>
</g>
<!-- price_utils.save_price_model&#45;&gt;notes_utils.write_json -->
<g id="edge171" class="edge">
<title>price_utils.save_price_model&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M7737.55,-2763C7838.66,-2766.2 7961.1,-2773.71 8070,-2790.5 8225.99,-2814.54 8404.26,-2867.01 8497.47,-2896.43"/>
<polygon fill="black" stroke="black" points="8496.45,-2899.78 8507.04,-2899.47 8498.57,-2893.11 8496.45,-2899.78"/>
</g>
<!-- similar_utils._load_embeddings&#45;&gt;notes_utils.load_json -->
<g id="edge244" class="edge">
<title>similar_utils._load_embeddings&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M8650.26,-4380.48C8746.36,-4354.3 8903.52,-4303.08 9020,-4223.5 9168.87,-4121.79 9299.39,-3944.09 9345.64,-3877.08"/>
<polygon fill="black" stroke="black" points="9348.59,-3878.97 9351.36,-3868.74 9342.82,-3875.01 9348.59,-3878.97"/>
</g>
<!-- similar._iter_lots -->
<g id="node10" class="node">
<title>similar._iter_lots</title>
<g id="a_node10"><a xlink:title="Return lots filtered by moderation rules.">
<polygon fill="none" stroke="black" points="7679,-1703 7371,-1703 7371,-1656 7679,-1656 7679,-1703"/>
<text text-anchor="middle" x="7525" y="-1671" font-family="Times,serif" font-size="35.00">similar._iter_lots</text>
</a>
</g>
</g>
<!-- similar._iter_lots&#45;&gt;lot_io.read_lots -->
<g id="edge10" class="edge">
<title>similar._iter_lots&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M7679.32,-1669.29C7820.41,-1663.5 8015.74,-1665.77 8070,-1717.5 8168.79,-1811.69 8006.81,-1928.73 8106,-2022.5 8209.05,-2119.92 8390.59,-2094.92 8490.71,-2070.98"/>
<polygon fill="black" stroke="black" points="8491.56,-2074.37 8500.44,-2068.59 8489.89,-2067.58 8491.56,-2074.37"/>
</g>
<!-- similar._iter_lots&#45;&gt;lot_io.iter_lot_files -->
<g id="edge11" class="edge">
<title>similar._iter_lots&#45;&gt;lot_io.iter_lot_files</title>
<path fill="none" stroke="black" d="M7679.02,-1672.35C7789.85,-1671.43 7942.05,-1679.03 8070,-1717.5 8259.08,-1774.34 8454.93,-1913.61 8530.05,-1970.59"/>
<polygon fill="black" stroke="black" points="8528.12,-1973.52 8538.19,-1976.8 8532.37,-1967.95 8528.12,-1973.52"/>
</g>
<!-- moderation.should_skip_message -->
<g id="node11" class="node">
<title>moderation.should_skip_message</title>
<g id="a_node11"><a xlink:title="Return ``True`` when the raw Telegram message should be ignored.">
<polygon fill="none" stroke="black" points="8730,-1018.5 8396,-1018.5 8396,-982.5 8730,-982.5 8730,-1018.5"/>
<text text-anchor="middle" x="8563" y="-995.72" font-family="Times,serif" font-size="18.48">moderation.should_skip_message</text>
</a>
</g>
</g>
<!-- similar._iter_lots&#45;&gt;moderation.should_skip_message -->
<g id="edge8" class="edge">
<title>similar._iter_lots&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M7654.54,-1703.03C7779.09,-1717.7 7964.24,-1716.6 8070,-1607.5 8125.5,-1550.25 8061.98,-1316.98 8106,-1250.5 8192.16,-1120.38 8369.86,-1052 8476.21,-1021.31"/>
<polygon fill="black" stroke="black" points="8477.29,-1024.64 8485.95,-1018.54 8475.38,-1017.91 8477.29,-1024.64"/>
</g>
<!-- moderation.should_skip_lot -->
<g id="node12" class="node">
<title>moderation.should_skip_lot</title>
<g id="a_node12"><a xlink:title="Return ``True`` when the lot fails additional checks.">
<polygon fill="none" stroke="black" points="8701,-1403.5 8425,-1403.5 8425,-1367.5 8701,-1367.5 8701,-1403.5"/>
<text text-anchor="middle" x="8563" y="-1380.72" font-family="Times,serif" font-size="18.48">moderation.should_skip_lot</text>
</a>
</g>
</g>
<!-- similar._iter_lots&#45;&gt;moderation.should_skip_lot -->
<g id="edge9" class="edge">
<title>similar._iter_lots&#45;&gt;moderation.should_skip_lot</title>
<path fill="none" stroke="black" d="M7671.63,-1703C7794.06,-1713.89 7965.37,-1706.92 8070,-1607.5 8133.89,-1546.79 8039.96,-1470.86 8106,-1412.5 8150.54,-1373.15 8299.23,-1370.62 8414.85,-1375.29"/>
<polygon fill="black" stroke="black" points="8414.74,-1378.78 8424.88,-1375.71 8415.03,-1371.79 8414.74,-1378.78"/>
</g>
<!-- post_io.read_post -->
<g id="node13" class="node">
<title>post_io.read_post</title>
<g id="a_node13"><a xlink:title="Return metadata dictionary and body text for ``path``.">
<polygon fill="none" stroke="black" points="8842,-1497.5 8284,-1497.5 8284,-1421.5 8842,-1421.5 8842,-1497.5"/>
<text text-anchor="middle" x="8563" y="-1444.33" font-family="Times,serif" font-size="61.46">post_io.read_post</text>
</a>
</g>
</g>
<!-- similar._iter_lots&#45;&gt;post_io.read_post -->
<g id="edge12" class="edge">
<title>similar._iter_lots&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7679.25,-1665.86C7788.87,-1654.49 7939.49,-1635.58 8070,-1607.5 8199.96,-1579.54 8345.36,-1533.98 8444.17,-1500.78"/>
<polygon fill="black" stroke="black" points="8445.52,-1504.02 8453.88,-1497.5 8443.29,-1497.38 8445.52,-1504.02"/>
</g>
<!-- post_io.raw_post_path -->
<g id="node14" class="node">
<title>post_io.raw_post_path</title>
<g id="a_node14"><a xlink:title="Return absolute message path for ``rel`` under ``root``.">
<polygon fill="none" stroke="black" points="8639.5,-4060.5 8486.5,-4060.5 8486.5,-4024.5 8639.5,-4024.5 8639.5,-4060.5"/>
<text text-anchor="middle" x="8563" y="-4039.26" font-family="Times,serif" font-size="12.18">post_io.raw_post_path</text>
</a>
</g>
</g>
<!-- similar._iter_lots&#45;&gt;post_io.raw_post_path -->
<g id="edge13" class="edge">
<title>similar._iter_lots&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7641.08,-1655.99C7766.88,-1637.77 7964.55,-1632.53 8070,-1750.5 8144.65,-1834.02 8050.13,-3669.41 8106,-3766.5 8188.47,-3909.81 8377.95,-3987.52 8484.89,-4021.39"/>
<polygon fill="black" stroke="black" points="8484.07,-4024.8 8494.66,-4024.44 8486.15,-4018.12 8484.07,-4024.8"/>
</g>
<!-- moderation.message_skip_reason -->
<g id="node143" class="node">
<title>moderation.message_skip_reason</title>
<g id="a_node143"><a xlink:title="Return the moderation reason for ``meta`` and ``text`` or ``None``.">
<polygon fill="none" stroke="black" points="9659.5,-425 9069.5,-425 9069.5,-380 9659.5,-380 9659.5,-425"/>
<text text-anchor="middle" x="9364.5" y="-394.12" font-family="Times,serif" font-size="33.60">moderation.message_skip_reason</text>
</a>
</g>
</g>
<!-- moderation.should_skip_message&#45;&gt;moderation.message_skip_reason -->
<g id="edge236" class="edge">
<title>moderation.should_skip_message&#45;&gt;moderation.message_skip_reason</title>
<path fill="none" stroke="black" d="M8644.25,-982.5C8740.41,-958.08 8903.15,-907.47 9020,-822.5 9175.2,-709.64 9300.92,-510.44 9345.79,-433.78"/>
<polygon fill="black" stroke="black" points="9348.86,-435.45 9350.86,-425.05 9342.81,-431.94 9348.86,-435.45"/>
</g>
<!-- moderation.lot_skip_reason -->
<g id="node144" class="node">
<title>moderation.lot_skip_reason</title>
<g id="a_node144"><a xlink:title="Return the moderation reason for ``lot`` or ``None``.">
<polygon fill="none" stroke="black" points="9541,-1207.5 9188,-1207.5 9188,-1171.5 9541,-1171.5 9541,-1207.5"/>
<text text-anchor="middle" x="9364.5" y="-1183.62" font-family="Times,serif" font-size="24.22">moderation.lot_skip_reason</text>
</a>
</g>
</g>
<!-- moderation.should_skip_lot&#45;&gt;moderation.lot_skip_reason -->
<g id="edge237" class="edge">
<title>moderation.should_skip_lot&#45;&gt;moderation.lot_skip_reason</title>
<path fill="none" stroke="black" d="M8660.14,-1403.55C8757.65,-1416.69 8909.53,-1422.52 9020,-1358.5 9045.28,-1343.85 9033.16,-1321.71 9056,-1303.5 9115.7,-1255.89 9197.25,-1226.88 9261.36,-1210.04"/>
<polygon fill="black" stroke="black" points="9262.28,-1213.42 9271.09,-1207.55 9260.54,-1206.64 9262.28,-1213.42"/>
</g>
<!-- notes_utils.read_md -->
<g id="node23" class="node">
<title>notes_utils.read_md</title>
<g id="a_node23"><a xlink:title="Alias for :func:`read_text` used for Markdown files.">
<polygon fill="none" stroke="black" points="9434.5,-1547.5 9294.5,-1547.5 9294.5,-1511.5 9434.5,-1511.5 9434.5,-1547.5"/>
<text text-anchor="middle" x="9364.5" y="-1526.26" font-family="Times,serif" font-size="12.18">notes_utils.read_md</text>
</a>
</g>
</g>
<!-- post_io.read_post&#45;&gt;notes_utils.read_md -->
<g id="edge281" class="edge">
<title>post_io.read_post&#45;&gt;notes_utils.read_md</title>
<path fill="none" stroke="black" d="M8842.22,-1483.86C8998.23,-1497.52 9181.53,-1513.57 9283.93,-1522.53"/>
<polygon fill="black" stroke="black" points="9283.92,-1526.05 9294.19,-1523.43 9284.53,-1519.07 9283.92,-1526.05"/>
</g>
<!-- notes_utils._parse_block -->
<g id="node25" class="node">
<title>notes_utils._parse_block</title>
<g id="a_node25"><a xlink:title="Return metadata dict and remaining body from ``text``.">
<polygon fill="none" stroke="black" points="9533.5,-1448 9195.5,-1448 9195.5,-1411 9533.5,-1411 9533.5,-1448"/>
<text text-anchor="middle" x="9364.5" y="-1423.06" font-family="Times,serif" font-size="26.18">notes_utils._parse_block</text>
</a>
</g>
</g>
<!-- post_io.read_post&#45;&gt;notes_utils._parse_block -->
<g id="edge282" class="edge">
<title>post_io.read_post&#45;&gt;notes_utils._parse_block</title>
<path fill="none" stroke="black" d="M8842.22,-1449.06C8955.96,-1444.79 9084.2,-1439.98 9185.03,-1436.2"/>
<polygon fill="black" stroke="black" points="9185.45,-1439.68 9195.32,-1435.81 9185.19,-1432.69 9185.45,-1439.68"/>
</g>
<!-- similar.main -->
<g id="node15" class="node">
<title>similar.main</title>
<g id="a_node15"><a xlink:title="Update ``data/similar`` using available embeddings.">
<polygon fill="none" stroke="black" points="6526,-4695.5 6316,-4695.5 6316,-4653.5 6526,-4653.5 6526,-4695.5"/>
<text text-anchor="middle" x="6421" y="-4666.41" font-family="Times,serif" font-size="31.36">similar.main</text>
</a>
</g>
</g>
<!-- similar.main&#45;&gt;similar_utils._load_embeddings -->
<g id="edge15" class="edge">
<title>similar.main&#45;&gt;similar_utils._load_embeddings</title>
<path fill="none" stroke="black" d="M6526.03,-4668.02C6631.41,-4661.34 6799.08,-4650.4 6944,-4639.5 6960.01,-4638.3 6963.97,-4637.45 6980,-4636.5 7040.49,-4632.93 8023.4,-4637.23 8070,-4598.5 8126.72,-4551.35 8050.28,-4484.82 8106,-4436.5 8204.11,-4351.42 8362.98,-4360.77 8464.93,-4378.61"/>
<polygon fill="black" stroke="black" points="8464.46,-4382.08 8474.93,-4380.42 8465.71,-4375.2 8464.46,-4382.08"/>
</g>
<!-- similar.main&#45;&gt;similar_utils._sync_embeddings -->
<g id="edge21" class="edge">
<title>similar.main&#45;&gt;similar_utils._sync_embeddings</title>
<path fill="none" stroke="black" d="M6526.1,-4687.57C6647.25,-4696.26 6843.51,-4688.8 6944,-4568.5 7003.92,-4496.77 6917.34,-2955.85 6980,-2886.5 7020.14,-2842.08 7152.27,-2825.14 7276.25,-2819.4"/>
<polygon fill="black" stroke="black" points="7276.47,-2822.89 7286.31,-2818.95 7276.16,-2815.9 7276.47,-2822.89"/>
</g>
<!-- similar.main&#45;&gt;similar._iter_lots -->
<g id="edge14" class="edge">
<title>similar.main&#45;&gt;similar._iter_lots</title>
<path fill="none" stroke="black" d="M6526.01,-4687.7C6647.31,-4696.57 6843.96,-4689.32 6944,-4568.5 7043.86,-4447.91 6875.95,-1867.49 6980,-1750.5 7082.53,-1635.21 7273.12,-1637.4 7399.27,-1654.55"/>
<polygon fill="black" stroke="black" points="7398.99,-1658.04 7409.38,-1655.97 7399.96,-1651.11 7398.99,-1658.04"/>
</g>
<!-- similar_utils._load_similar -->
<g id="node16" class="node">
<title>similar_utils._load_similar</title>
<g id="a_node16"><a xlink:title="Return cached similar lots mapping.">
<polygon fill="none" stroke="black" points="7774,-4389.5 7276,-4389.5 7276,-4341.5 7774,-4341.5 7774,-4389.5"/>
<text text-anchor="middle" x="7525" y="-4356.38" font-family="Times,serif" font-size="36.40">similar_utils._load_similar</text>
</a>
</g>
</g>
<!-- similar.main&#45;&gt;similar_utils._load_similar -->
<g id="edge16" class="edge">
<title>similar.main&#45;&gt;similar_utils._load_similar</title>
<path fill="none" stroke="black" d="M6526,-4683.23C6642.91,-4687.03 6831.09,-4674.2 6944,-4568.5 6988.39,-4526.94 6934.17,-4476.47 6980,-4436.5 7074.33,-4354.24 7215.16,-4337.72 7329.89,-4341.13"/>
<polygon fill="black" stroke="black" points="7330.09,-4344.64 7340.21,-4341.49 7330.34,-4337.64 7330.09,-4344.64"/>
</g>
<!-- similar_utils._save_similar -->
<g id="node17" class="node">
<title>similar_utils._save_similar</title>
<g id="a_node17"><a xlink:title="Write ``sim_map`` to ``SIMILAR_DIR`` mirroring ``LOTS_DIR`` layout.">
<polygon fill="none" stroke="black" points="7673,-4865.5 7377,-4865.5 7377,-4829.5 7673,-4829.5 7673,-4865.5"/>
<text text-anchor="middle" x="7525" y="-4842.2" font-family="Times,serif" font-size="21.00">similar_utils._save_similar</text>
</a>
</g>
</g>
<!-- similar.main&#45;&gt;similar_utils._save_similar -->
<g id="edge17" class="edge">
<title>similar.main&#45;&gt;similar_utils._save_similar</title>
<path fill="none" stroke="black" d="M6485.12,-4695.59C6587.6,-4728.79 6797.15,-4792.35 6980,-4820.5 7109.26,-4840.4 7257.64,-4846.68 7366.74,-4848.25"/>
<polygon fill="black" stroke="black" points="7366.8,-4851.75 7376.85,-4848.38 7366.89,-4844.75 7366.8,-4851.75"/>
</g>
<!-- similar_utils._save_more_user -->
<g id="node18" class="node">
<title>similar_utils._save_more_user</title>
<g id="a_node18"><a xlink:title="Write ``more_map`` to ``MORE_USER_DIR`` mirroring ``LOTS_DIR`` layout.">
<polygon fill="none" stroke="black" points="7692.5,-4811.5 7357.5,-4811.5 7357.5,-4775.5 7692.5,-4775.5 7692.5,-4811.5"/>
<text text-anchor="middle" x="7525" y="-4788.2" font-family="Times,serif" font-size="21.00">similar_utils._save_more_user</text>
</a>
</g>
</g>
<!-- similar.main&#45;&gt;similar_utils._save_more_user -->
<g id="edge18" class="edge">
<title>similar.main&#45;&gt;similar_utils._save_more_user</title>
<path fill="none" stroke="black" d="M6526.16,-4695.32C6637.88,-4716.79 6820.75,-4749.48 6980,-4766.5 7102.17,-4779.56 7240.46,-4786.32 7347.04,-4789.81"/>
<polygon fill="black" stroke="black" points="7347.15,-4793.31 7357.26,-4790.13 7347.37,-4786.32 7347.15,-4793.31"/>
</g>
<!-- similar_utils._prune_similar -->
<g id="node19" class="node">
<title>similar_utils._prune_similar</title>
<g id="a_node19"><a xlink:title="Drop cache entries referring to ids not in ``valid_ids``.">
<polygon fill="none" stroke="black" points="7664,-4589.5 7386,-4589.5 7386,-4553.5 7664,-4553.5 7664,-4589.5"/>
<text text-anchor="middle" x="7525" y="-4566.72" font-family="Times,serif" font-size="18.48">similar_utils._prune_similar</text>
</a>
</g>
</g>
<!-- similar.main&#45;&gt;similar_utils._prune_similar -->
<g id="edge19" class="edge">
<title>similar.main&#45;&gt;similar_utils._prune_similar</title>
<path fill="none" stroke="black" d="M6526.25,-4688.32C6635.5,-4698.17 6809.61,-4700.51 6944,-4639.5 6964.6,-4630.15 6959.36,-4612.77 6980,-4603.5 7105.56,-4547.12 7264.1,-4544.48 7377.58,-4552.72"/>
<polygon fill="black" stroke="black" points="7377.5,-4556.22 7387.73,-4553.49 7378.03,-4549.24 7377.5,-4556.22"/>
</g>
<!-- similar_utils._calc_similar_nn -->
<g id="node20" class="node">
<title>similar_utils._calc_similar_nn</title>
<g id="a_node20"><a xlink:title="Fill ``sim_map`` for ``new_ids`` using a nearest neighbour search.&#10;&#10;``vec_ids`` lists all lots that have an embedding. &#160;``new_ids`` is a subset&#10;for which we still need recommendations. &#160;We gather vectors for&#10;``vec_ids`` and use ``NearestNeighbors`` from scikit&#45;learn to find the&#10;closest items. &#160;Embeddings of lots without a vector are skipped.">
<polygon fill="none" stroke="black" points="9020,-5172 8106,-5172 8106,-5097 9020,-5097 9020,-5172"/>
<text text-anchor="middle" x="8563" y="-5119.5" font-family="Times,serif" font-size="60.62">similar_utils._calc_similar_nn</text>
</a>
</g>
</g>
<!-- similar.main&#45;&gt;similar_utils._calc_similar_nn -->
<g id="edge20" class="edge">
<title>similar.main&#45;&gt;similar_utils._calc_similar_nn</title>
<path fill="none" stroke="black" d="M6465.11,-4695.6C6561.72,-4744.69 6798.46,-4875.18 6944,-5042.5 6966.96,-5068.9 6950.26,-5094.07 6980,-5112.5 7027.2,-5141.75 7646.21,-5142.83 8095.67,-5139.65"/>
<polygon fill="black" stroke="black" points="8095.95,-5143.15 8105.92,-5139.57 8095.9,-5136.15 8095.95,-5143.15"/>
</g>
<!-- similar_utils._similar_by_user -->
<g id="node21" class="node">
<title>similar_utils._similar_by_user</title>
<g id="a_node21"><a xlink:title="Return map of lot id to other lots from the same user.">
<polygon fill="none" stroke="black" points="9673,-5394.5 9056,-5394.5 9056,-5342.5 9673,-5342.5 9673,-5394.5"/>
<text text-anchor="middle" x="9364.5" y="-5358.36" font-family="Times,serif" font-size="40.18">similar_utils._similar_by_user</text>
</a>
</g>
</g>
<!-- similar.main&#45;&gt;similar_utils._similar_by_user -->
<g id="edge22" class="edge">
<title>similar.main&#45;&gt;similar_utils._similar_by_user</title>
<path fill="none" stroke="black" d="M6469.32,-4695.57C6570.71,-4743.02 6810.49,-4867.87 6944,-5042.5 6972.44,-5079.69 6942.25,-5113.8 6980,-5141.5 7028.87,-5177.36 8009.5,-5185.75 8070,-5189.5 8492.76,-5215.71 8622.5,-5119.2 9020,-5265.5 9038.52,-5272.32 9038.11,-5283.18 9056,-5291.5 9101.4,-5312.62 9153.37,-5328.45 9201.5,-5340.09"/>
<polygon fill="black" stroke="black" points="9200.86,-5343.53 9211.39,-5342.44 9202.47,-5336.72 9200.86,-5343.53"/>
</g>
<!-- similar_utils._load_similar&#45;&gt;notes_utils.load_json -->
<g id="edge245" class="edge">
<title>similar_utils._load_similar&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M7774.32,-4358.38C7867.53,-4353.03 7974.08,-4343.71 8070,-4327.5 8501.4,-4254.58 8619.87,-4246.45 9020,-4069.5 9143.92,-4014.7 9274.74,-3919.27 9332.73,-3874.71"/>
<polygon fill="black" stroke="black" points="9334.98,-3877.4 9340.75,-3868.52 9330.7,-3871.86 9334.98,-3877.4"/>
</g>
<!-- similar_utils._save_similar&#45;&gt;notes_utils.write_json -->
<g id="edge247" class="edge">
<title>similar_utils._save_similar&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M7673.22,-4861.65C7815.45,-4871.69 8016.94,-4875.08 8070,-4820.5 8135.31,-4753.32 8055.13,-3213.17 8106,-3134.5 8184.25,-3013.49 8350,-2958.41 8458.63,-2934.49"/>
<polygon fill="black" stroke="black" points="8459.59,-2937.86 8468.64,-2932.34 8458.12,-2931.02 8459.59,-2937.86"/>
</g>
<!-- lot_io.lot_json_path -->
<g id="node133" class="node">
<title>lot_io.lot_json_path</title>
<g id="a_node133"><a xlink:title="Return full JSON path for ``lot_id`` given ``root`` directory.">
<polygon fill="none" stroke="black" points="8639.5,-4796.5 8486.5,-4796.5 8486.5,-4760.5 8639.5,-4760.5 8639.5,-4796.5"/>
<text text-anchor="middle" x="8563" y="-4774.8" font-family="Times,serif" font-size="14.00">lot_io.lot_json_path</text>
</a>
</g>
</g>
<!-- similar_utils._save_similar&#45;&gt;lot_io.lot_json_path -->
<g id="edge249" class="edge">
<title>similar_utils._save_similar&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M7673.02,-4853.78C7783.55,-4855.24 7937.99,-4850.32 8070,-4820.5 8086.91,-4816.68 8089.11,-4809.4 8106,-4805.5 8232.43,-4776.3 8383.52,-4773.4 8476.1,-4775.1"/>
<polygon fill="black" stroke="black" points="8476.19,-4778.61 8486.26,-4775.31 8476.34,-4771.61 8476.19,-4778.61"/>
</g>
<!-- similar_utils._similar_path -->
<g id="node147" class="node">
<title>similar_utils._similar_path</title>
<g id="a_node147"><a xlink:title="Return cache file path for ``lot_path`` under ``SIMILAR_DIR``.">
<polygon fill="none" stroke="black" points="8665,-4850.5 8461,-4850.5 8461,-4814.5 8665,-4814.5 8665,-4850.5"/>
<text text-anchor="middle" x="8563" y="-4828.8" font-family="Times,serif" font-size="14.00">similar_utils._similar_path</text>
</a>
</g>
</g>
<!-- similar_utils._save_similar&#45;&gt;similar_utils._similar_path -->
<g id="edge248" class="edge">
<title>similar_utils._save_similar&#45;&gt;similar_utils._similar_path</title>
<path fill="none" stroke="black" d="M7673.06,-4845.37C7882.66,-4842.34 8262.69,-4836.83 8450.62,-4834.11"/>
<polygon fill="black" stroke="black" points="8450.85,-4837.61 8460.79,-4833.97 8450.74,-4830.61 8450.85,-4837.61"/>
</g>
<!-- similar_utils._save_more_user&#45;&gt;notes_utils.write_json -->
<g id="edge250" class="edge">
<title>similar_utils._save_more_user&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M7692.77,-4808.96C7833.29,-4817.86 8019.31,-4818.6 8070,-4766.5 8133.24,-4701.5 8056.73,-3210.64 8106,-3134.5 8184.29,-3013.51 8350.03,-2958.43 8458.65,-2934.5"/>
<polygon fill="black" stroke="black" points="8459.61,-2937.87 8468.65,-2932.35 8458.14,-2931.03 8459.61,-2937.87"/>
</g>
<!-- similar_utils._save_more_user&#45;&gt;lot_io.lot_json_path -->
<g id="edge252" class="edge">
<title>similar_utils._save_more_user&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M7692.74,-4791.09C7916.18,-4787.85 8304.48,-4782.23 8476.15,-4779.74"/>
<polygon fill="black" stroke="black" points="8476.45,-4783.24 8486.4,-4779.59 8476.35,-4776.24 8476.45,-4783.24"/>
</g>
<!-- similar_utils._more_user_path -->
<g id="node148" class="node">
<title>similar_utils._more_user_path</title>
<g id="a_node148"><a xlink:title="Return cache file path for ``lot_path`` under ``MORE_USER_DIR``.">
<polygon fill="none" stroke="black" points="8678,-4742.5 8448,-4742.5 8448,-4706.5 8678,-4706.5 8678,-4742.5"/>
<text text-anchor="middle" x="8563" y="-4720.8" font-family="Times,serif" font-size="14.00">similar_utils._more_user_path</text>
</a>
</g>
</g>
<!-- similar_utils._save_more_user&#45;&gt;similar_utils._more_user_path -->
<g id="edge251" class="edge">
<title>similar_utils._save_more_user&#45;&gt;similar_utils._more_user_path</title>
<path fill="none" stroke="black" d="M7692.56,-4799.96C7801.28,-4800.59 7945.6,-4794.61 8070,-4766.5 8086.91,-4762.68 8089.11,-4755.4 8106,-4751.5 8216.04,-4726.09 8344.77,-4720.59 8437.34,-4720.72"/>
<polygon fill="black" stroke="black" points="8437.58,-4724.22 8447.59,-4720.76 8437.6,-4717.22 8437.58,-4724.22"/>
</g>
<!-- similar_utils._update_reciprocal -->
<g id="node149" class="node">
<title>similar_utils._update_reciprocal</title>
<g id="a_node149"><a xlink:title="Insert ``lot_id`` into caches of lots listed in ``sims`` if closer.">
<polygon fill="none" stroke="black" points="9605.5,-5154.5 9123.5,-5154.5 9123.5,-5114.5 9605.5,-5114.5 9605.5,-5154.5"/>
<text text-anchor="middle" x="9364.5" y="-5127.43" font-family="Times,serif" font-size="28.84">similar_utils._update_reciprocal</text>
</a>
</g>
</g>
<!-- similar_utils._calc_similar_nn&#45;&gt;similar_utils._update_reciprocal -->
<g id="edge253" class="edge">
<title>similar_utils._calc_similar_nn&#45;&gt;similar_utils._update_reciprocal</title>
<path fill="none" stroke="black" d="M9020.09,-5134.5C9051.89,-5134.5 9083.21,-5134.5 9113.21,-5134.5"/>
<polygon fill="black" stroke="black" points="9113.33,-5138 9123.33,-5134.5 9113.33,-5131 9113.33,-5138"/>
</g>
<!-- similar_utils._cos_sim -->
<g id="node121" class="node">
<title>similar_utils._cos_sim</title>
<g id="a_node121"><a xlink:title="Return cosine similarity between two embeddings.">
<polygon fill="none" stroke="black" points="10093,-5436.5 9860,-5436.5 9860,-5400.5 10093,-5400.5 10093,-5436.5"/>
<text text-anchor="middle" x="9976.5" y="-5413.71" font-family="Times,serif" font-size="19.74">similar_utils._cos_sim</text>
</a>
</g>
</g>
<!-- similar_utils._similar_by_user&#45;&gt;similar_utils._cos_sim -->
<g id="edge254" class="edge">
<title>similar_utils._similar_by_user&#45;&gt;similar_utils._cos_sim</title>
<path fill="none" stroke="black" d="M9673.18,-5393.72C9735.64,-5398.84 9797.95,-5403.95 9849.63,-5408.18"/>
<polygon fill="black" stroke="black" points="9849.57,-5411.69 9859.82,-5409.02 9850.14,-5404.71 9849.57,-5411.69"/>
</g>
<!-- notes_utils.read_text -->
<g id="node22" class="node">
<title>notes_utils.read_text</title>
<g id="a_node22"><a xlink:title="Return file contents as UTF&#45;8 or empty string when missing.">
<polygon fill="none" stroke="black" points="10083.5,-4853.5 9869.5,-4853.5 9869.5,-4817.5 10083.5,-4817.5 10083.5,-4853.5"/>
<text text-anchor="middle" x="9976.5" y="-4830.72" font-family="Times,serif" font-size="18.48">notes_utils.read_text</text>
</a>
</g>
</g>
<!-- notes_utils.read_text&#45;&gt;notes_utils.read_text -->
<g id="edge23" class="edge">
<title>notes_utils.read_text&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M9869.38,-4851.98C9844.57,-4862.01 9880.28,-4871.5 9976.5,-4871.5 10050.17,-4871.5 10088.37,-4865.94 10091.09,-4858.83"/>
<polygon fill="black" stroke="black" points="10093.36,-4856.16 10083.62,-4851.98 10088.63,-4861.31 10093.36,-4856.16"/>
</g>
<!-- notes_utils.read_md&#45;&gt;notes_utils.read_text -->
<g id="edge24" class="edge">
<title>notes_utils.read_md&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M9434.81,-1524.18C9505.95,-1522.9 9614.3,-1533.38 9673,-1600.5 9896.98,-1856.62 9967.46,-4503.37 9974.84,-4807.14"/>
<polygon fill="black" stroke="black" points="9971.34,-4807.41 9975.08,-4817.32 9978.34,-4807.24 9971.34,-4807.41"/>
</g>
<!-- notes_utils.write_md -->
<g id="node24" class="node">
<title>notes_utils.write_md</title>
<g id="a_node24"><a xlink:title="Write ``text`` to ``path`` ensuring a trailing newline.">
<polygon fill="none" stroke="black" points="7638,-3865.5 7412,-3865.5 7412,-3829.5 7638,-3829.5 7638,-3865.5"/>
<text text-anchor="middle" x="7525" y="-3842.71" font-family="Times,serif" font-size="19.74">notes_utils.write_md</text>
</a>
</g>
</g>
<!-- notes_utils.parse_md -->
<g id="node26" class="node">
<title>notes_utils.parse_md</title>
<g id="a_node26"><a xlink:title="Return metadata dictionary and body text from ``path``.">
<polygon fill="none" stroke="black" points="8646.5,-1295.5 8479.5,-1295.5 8479.5,-1259.5 8646.5,-1259.5 8646.5,-1295.5"/>
<text text-anchor="middle" x="8563" y="-1273.8" font-family="Times,serif" font-size="14.00">notes_utils.parse_md</text>
</a>
</g>
</g>
<!-- notes_utils.parse_md&#45;&gt;notes_utils.read_md -->
<g id="edge25" class="edge">
<title>notes_utils.parse_md&#45;&gt;notes_utils.read_md</title>
<path fill="none" stroke="black" d="M8629.78,-1259.41C8727.15,-1236.97 8909.94,-1212.04 9020,-1304.5 9073.16,-1349.15 9006.92,-1407.4 9056,-1456.5 9115.71,-1516.24 9214.79,-1530.53 9284.3,-1532.43"/>
<polygon fill="black" stroke="black" points="9284.27,-1535.93 9294.34,-1532.62 9284.41,-1528.93 9284.27,-1535.93"/>
</g>
<!-- notes_utils.parse_md&#45;&gt;notes_utils._parse_block -->
<g id="edge26" class="edge">
<title>notes_utils.parse_md&#45;&gt;notes_utils._parse_block</title>
<path fill="none" stroke="black" d="M8646.68,-1261.67C8743.02,-1247.68 8903.81,-1238.49 9020,-1304.5 9044.76,-1318.57 9032.53,-1341.37 9056,-1357.5 9094.1,-1383.68 9140.46,-1400.43 9185.5,-1411.11"/>
<polygon fill="black" stroke="black" points="9184.87,-1414.56 9195.39,-1413.37 9186.42,-1407.73 9184.87,-1414.56"/>
</g>
<!-- notes_utils.load_json&#45;&gt;notes_utils.read_text -->
<g id="edge27" class="edge">
<title>notes_utils.load_json&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M9386.18,-3868.5C9439.39,-3915.65 9583.11,-4048.39 9673,-4182.5 9822.51,-4405.58 9934.21,-4714.4 9966.19,-4807.71"/>
<polygon fill="black" stroke="black" points="9962.91,-4808.94 9969.45,-4817.28 9969.54,-4806.69 9962.91,-4808.94"/>
</g>
<!-- clean_data._parse_date -->
<g id="node29" class="node">
<title>clean_data._parse_date</title>
<g id="a_node29"><a xlink:title="Return the ``date`` field from a markdown file if present.">
<polygon fill="none" stroke="black" points="8702.5,-3757.5 8423.5,-3757.5 8423.5,-3721.5 8702.5,-3721.5 8702.5,-3757.5"/>
<text text-anchor="middle" x="8563" y="-3733.8" font-family="Times,serif" font-size="22.12">clean_data._parse_date</text>
</a>
</g>
</g>
<!-- clean_data._parse_date&#45;&gt;notes_utils.read_text -->
<g id="edge28" class="edge">
<title>clean_data._parse_date&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M8596.54,-3757.58C8672.37,-3800.06 8866.13,-3910.59 9020,-4015.5 9321.79,-4221.26 9401.74,-4269.89 9673,-4514.5 9786.01,-4616.41 9905.86,-4753.54 9953.82,-4809.79"/>
<polygon fill="black" stroke="black" points="9951.22,-4812.14 9960.37,-4817.49 9956.56,-4807.6 9951.22,-4812.14"/>
</g>
<!-- clean_data._clean_raw -->
<g id="node30" class="node">
<title>clean_data._clean_raw</title>
<g id="a_node30"><a xlink:title="Delete raw posts older than ``cutoff``.">
<polygon fill="none" stroke="black" points="7678.5,-3757.5 7371.5,-3757.5 7371.5,-3721.5 7678.5,-3721.5 7678.5,-3757.5"/>
<text text-anchor="middle" x="7525" y="-3733.34" font-family="Times,serif" font-size="25.20">clean_data._clean_raw</text>
</a>
</g>
</g>
<!-- clean_data._clean_raw&#45;&gt;post_io.raw_post_path -->
<g id="edge30" class="edge">
<title>clean_data._clean_raw&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7678.55,-3728.63C7789.32,-3725.14 7941.65,-3729.54 8070,-3766.5 8260.3,-3821.31 8456.93,-3961.73 8531.17,-4018.32"/>
<polygon fill="black" stroke="black" points="8529.13,-4021.17 8539.2,-4024.48 8533.39,-4015.62 8529.13,-4021.17"/>
</g>
<!-- clean_data._clean_raw&#45;&gt;clean_data._parse_date -->
<g id="edge29" class="edge">
<title>clean_data._clean_raw&#45;&gt;clean_data._parse_date</title>
<path fill="none" stroke="black" d="M7678.59,-3739.5C7876.02,-3739.5 8217.77,-3739.5 8413.29,-3739.5"/>
<polygon fill="black" stroke="black" points="8413.36,-3743 8423.36,-3739.5 8413.36,-3736 8413.36,-3743"/>
</g>
<!-- clean_data._clean_media -->
<g id="node31" class="node">
<title>clean_data._clean_media</title>
<g id="a_node31"><a xlink:title="Remove unused media files older than ``cutoff``.">
<polygon fill="none" stroke="black" points="7715,-3535.5 7335,-3535.5 7335,-3495.5 7715,-3495.5 7715,-3535.5"/>
<text text-anchor="middle" x="7525" y="-3508.43" font-family="Times,serif" font-size="28.84">clean_data._clean_media</text>
</a>
</g>
</g>
<!-- clean_data._clean_media&#45;&gt;clean_data._parse_date -->
<g id="edge31" class="edge">
<title>clean_data._clean_media&#45;&gt;clean_data._parse_date</title>
<path fill="none" stroke="black" d="M7715.23,-3532.65C7820.45,-3544.15 7953.32,-3561.95 8070,-3587.5 8229.67,-3622.47 8412.23,-3685.02 8503.54,-3717.92"/>
<polygon fill="black" stroke="black" points="8502.56,-3721.29 8513.15,-3721.4 8504.94,-3714.7 8502.56,-3721.29"/>
</g>
<!-- caption_io.has_caption -->
<g id="node32" class="node">
<title>caption_io.has_caption</title>
<g id="a_node32"><a xlink:title="Return ``True`` when any caption exists for ``image``.">
<polygon fill="none" stroke="black" points="8640.5,-2339.5 8485.5,-2339.5 8485.5,-2303.5 8640.5,-2303.5 8640.5,-2339.5"/>
<text text-anchor="middle" x="8563" y="-2318.26" font-family="Times,serif" font-size="12.18">caption_io.has_caption</text>
</a>
</g>
</g>
<!-- clean_data._clean_media&#45;&gt;caption_io.has_caption -->
<g id="edge32" class="edge">
<title>clean_data._clean_media&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M7715.2,-3505.3C7837.14,-3487.86 7987.77,-3443.74 8070,-3334.5 8128.79,-3256.4 8045.84,-2532.54 8106,-2455.5 8193.32,-2343.67 8369.07,-2321.61 8475.06,-2319.18"/>
<polygon fill="black" stroke="black" points="8475.15,-2322.68 8485.09,-2319.01 8475.03,-2315.68 8475.15,-2322.68"/>
</g>
<!-- caption_io.caption_json_path -->
<g id="node94" class="node">
<title>caption_io.caption_json_path</title>
<g id="a_node94"><a xlink:title="Return new&#45;style caption path for ``image``.">
<polygon fill="none" stroke="black" points="9461,-3019.5 9268,-3019.5 9268,-2983.5 9461,-2983.5 9461,-3019.5"/>
<text text-anchor="middle" x="9364.5" y="-2998.26" font-family="Times,serif" font-size="12.18">caption_io.caption_json_path</text>
</a>
</g>
</g>
<!-- caption_io.has_caption&#45;&gt;caption_io.caption_json_path -->
<g id="edge158" class="edge">
<title>caption_io.has_caption&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M8640.7,-2322.83C8741.23,-2328.77 8916.85,-2354.15 9020,-2455.5 9058.2,-2493.04 9032.15,-2522.55 9056,-2570.5 9139.22,-2737.82 9284.2,-2911.21 9340.36,-2975.5"/>
<polygon fill="black" stroke="black" points="9337.83,-2977.94 9347.06,-2983.14 9343.1,-2973.32 9337.83,-2977.94"/>
</g>
<!-- caption_io.caption_md_path -->
<g id="node98" class="node">
<title>caption_io.caption_md_path</title>
<g id="a_node98"><a xlink:title="Return legacy Markdown caption path for ``image``.">
<polygon fill="none" stroke="black" points="9458,-2339.5 9271,-2339.5 9271,-2303.5 9458,-2303.5 9458,-2339.5"/>
<text text-anchor="middle" x="9364.5" y="-2318.26" font-family="Times,serif" font-size="12.18">caption_io.caption_md_path</text>
</a>
</g>
</g>
<!-- caption_io.has_caption&#45;&gt;caption_io.caption_md_path -->
<g id="edge159" class="edge">
<title>caption_io.has_caption&#45;&gt;caption_io.caption_md_path</title>
<path fill="none" stroke="black" d="M8640.66,-2321.5C8785.27,-2321.5 9098.37,-2321.5 9260.91,-2321.5"/>
<polygon fill="black" stroke="black" points="9260.92,-2325 9270.92,-2321.5 9260.92,-2318 9260.92,-2325"/>
</g>
<!-- clean_data._clean_lots -->
<g id="node33" class="node">
<title>clean_data._clean_lots</title>
<g id="a_node33"><a xlink:title="Drop lots missing translations or source posts.">
<polygon fill="none" stroke="black" points="7727,-3185.5 7323,-3185.5 7323,-3139.5 7727,-3139.5 7727,-3185.5"/>
<text text-anchor="middle" x="7525" y="-3154.06" font-family="Times,serif" font-size="34.30">clean_data._clean_lots</text>
</a>
</g>
</g>
<!-- clean_data._clean_lots&#45;&gt;lot_io.read_lots -->
<g id="edge34" class="edge">
<title>clean_data._clean_lots&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M7727.03,-3178.95C7845.23,-3176.69 7987.28,-3150.99 8070,-3054.5 8131.09,-2983.24 8050.1,-2285.9 8106,-2210.5 8184.78,-2104.24 8339.49,-2068.18 8446.71,-2056.15"/>
<polygon fill="black" stroke="black" points="8447.36,-2059.6 8456.94,-2055.06 8446.62,-2052.64 8447.36,-2059.6"/>
</g>
<!-- clean_data._clean_lots&#45;&gt;post_io.raw_post_path -->
<g id="edge35" class="edge">
<title>clean_data._clean_lots&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7727.03,-3146.95C7844.65,-3149.66 7986.08,-3175.52 8070,-3270.5 8143.17,-3353.32 8048.29,-3672.26 8106,-3766.5 8192.82,-3908.27 8382.33,-3986.98 8487.67,-4021.32"/>
<polygon fill="black" stroke="black" points="8486.69,-4024.68 8497.28,-4024.41 8488.83,-4018.02 8486.69,-4024.68"/>
</g>
<!-- lot_io.needs_cleanup -->
<g id="node34" class="node">
<title>lot_io.needs_cleanup</title>
<g id="a_node34"><a xlink:title="Return ``True`` when ``clean_data`` would drop ``lots``.">
<polygon fill="none" stroke="black" points="8652.5,-3179.5 8473.5,-3179.5 8473.5,-3143.5 8652.5,-3143.5 8652.5,-3179.5"/>
<text text-anchor="middle" x="8563" y="-3157.46" font-family="Times,serif" font-size="15.68">lot_io.needs_cleanup</text>
</a>
</g>
</g>
<!-- clean_data._clean_lots&#45;&gt;lot_io.needs_cleanup -->
<g id="edge33" class="edge">
<title>clean_data._clean_lots&#45;&gt;lot_io.needs_cleanup</title>
<path fill="none" stroke="black" d="M7727.29,-3162.31C7948.47,-3162.09 8294.69,-3161.76 8463.21,-3161.6"/>
<polygon fill="black" stroke="black" points="8463.31,-3165.1 8473.31,-3161.59 8463.31,-3158.1 8463.31,-3165.1"/>
</g>
<!-- clean_data._clean_embeddings -->
<g id="node35" class="node">
<title>clean_data._clean_embeddings</title>
<g id="a_node35"><a xlink:title="Delete embedding files when the matching lot JSON is absent.">
<polygon fill="none" stroke="black" points="7733,-3703.5 7317,-3703.5 7317,-3667.5 7733,-3667.5 7733,-3703.5"/>
<text text-anchor="middle" x="7525" y="-3679.34" font-family="Times,serif" font-size="25.20">clean_data._clean_embeddings</text>
</a>
</g>
</g>
<!-- clean_data._remove_empty_dirs -->
<g id="node36" class="node">
<title>clean_data._remove_empty_dirs</title>
<g id="a_node36"><a xlink:title="Recursively remove empty folders under ``root``.">
<polygon fill="none" stroke="black" points="8776.5,-3581.5 8349.5,-3581.5 8349.5,-3545.5 8776.5,-3545.5 8776.5,-3581.5"/>
<text text-anchor="middle" x="8563" y="-3557.34" font-family="Times,serif" font-size="25.20">clean_data._remove_empty_dirs</text>
</a>
</g>
</g>
<!-- clean_data.main -->
<g id="node37" class="node">
<title>clean_data.main</title>
<g id="a_node37"><a xlink:title="Clean up old or inconsistent files across data directories.">
<polygon fill="none" stroke="black" points="6517,-3581.5 6325,-3581.5 6325,-3545.5 6517,-3545.5 6517,-3581.5"/>
<text text-anchor="middle" x="6421" y="-3558.2" font-family="Times,serif" font-size="21.00">clean_data.main</text>
</a>
</g>
</g>
<!-- clean_data.main&#45;&gt;clean_data._clean_raw -->
<g id="edge36" class="edge">
<title>clean_data.main&#45;&gt;clean_data._clean_raw</title>
<path fill="none" stroke="black" d="M6517.13,-3550.51C6630.21,-3540.41 6819.25,-3540.96 6944,-3633.5 6974.99,-3656.49 6948.08,-3690.83 6980,-3712.5 7040.06,-3753.27 7223.75,-3754.85 7361.17,-3749.58"/>
<polygon fill="black" stroke="black" points="7361.55,-3753.07 7371.4,-3749.17 7361.27,-3746.08 7361.55,-3753.07"/>
</g>
<!-- clean_data.main&#45;&gt;clean_data._clean_media -->
<g id="edge37" class="edge">
<title>clean_data.main&#45;&gt;clean_data._clean_media</title>
<path fill="none" stroke="black" d="M6517.39,-3559.35C6696.38,-3551.55 7086.03,-3534.58 7324.61,-3524.18"/>
<polygon fill="black" stroke="black" points="7324.96,-3527.67 7334.8,-3523.74 7324.65,-3520.68 7324.96,-3527.67"/>
</g>
<!-- clean_data.main&#45;&gt;clean_data._clean_lots -->
<g id="edge38" class="edge">
<title>clean_data.main&#45;&gt;clean_data._clean_lots</title>
<path fill="none" stroke="black" d="M6506.24,-3581.5C6621.51,-3600.72 6827.35,-3614.84 6944,-3502.5 7019.16,-3430.12 6907.78,-3345.82 6980,-3270.5 7064.42,-3182.46 7198.49,-3155.1 7312.41,-3149.93"/>
<polygon fill="black" stroke="black" points="7312.82,-3153.42 7322.67,-3149.52 7312.54,-3146.43 7312.82,-3153.42"/>
</g>
<!-- clean_data.main&#45;&gt;clean_data._clean_embeddings -->
<g id="edge39" class="edge">
<title>clean_data.main&#45;&gt;clean_data._clean_embeddings</title>
<path fill="none" stroke="black" d="M6517.25,-3565.68C6623.75,-3570.52 6800.15,-3585.8 6944,-3633.5 6961.37,-3639.26 6962.42,-3648.39 6980,-3653.5 7084.84,-3683.98 7205.71,-3693.48 7306.85,-3694.73"/>
<polygon fill="black" stroke="black" points="7306.86,-3698.23 7316.89,-3694.82 7306.93,-3691.23 7306.86,-3698.23"/>
</g>
<!-- clean_data.main&#45;&gt;clean_data._remove_empty_dirs -->
<g id="edge40" class="edge">
<title>clean_data.main&#45;&gt;clean_data._remove_empty_dirs</title>
<path fill="none" stroke="black" d="M6517.06,-3563.5C6836.68,-3563.5 7878.24,-3563.5 8339.13,-3563.5"/>
<polygon fill="black" stroke="black" points="8339.24,-3567 8349.24,-3563.5 8339.24,-3560 8339.24,-3567"/>
</g>
<!-- chop.has_misc_deal -->
<g id="node38" class="node">
<title>chop.has_misc_deal</title>
<g id="a_node38"><a xlink:title="Return True when any lot is classified as misc or announcement.">
<polygon fill="none" stroke="black" points="7639,-2385.5 7411,-2385.5 7411,-2349.5 7639,-2349.5 7639,-2385.5"/>
<text text-anchor="middle" x="7525" y="-2362.2" font-family="Times,serif" font-size="21.00">chop.has_misc_deal</text>
</a>
</g>
</g>
<!-- chop.process_message -->
<g id="node39" class="node">
<title>chop.process_message</title>
<g id="a_node39"><a xlink:title="Extract lots from ``msg_path`` and save them under ``LOTS_DIR``.">
<polygon fill="none" stroke="black" points="6922,-2505.5 5920,-2505.5 5920,-2403.5 6922,-2403.5 6922,-2505.5"/>
<text text-anchor="middle" x="6421" y="-2433.18" font-family="Times,serif" font-size="85.40">chop.process_message</text>
</a>
</g>
</g>
<!-- chop.process_message&#45;&gt;moderation.should_skip_message -->
<g id="edge45" class="edge">
<title>chop.process_message&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M6834.62,-2403.4C6876.66,-2382.83 6914.62,-2355.26 6944,-2318.5 7020.49,-2222.8 6896.53,-1306.17 6980,-1216.5 7145.94,-1038.24 7829.35,-1139.93 8070,-1102.5 8213.75,-1080.14 8379.01,-1043.62 8476.75,-1020.89"/>
<polygon fill="black" stroke="black" points="8477.63,-1024.27 8486.57,-1018.59 8476.04,-1017.46 8477.63,-1024.27"/>
</g>
<!-- chop.process_message&#45;&gt;post_io.read_post -->
<g id="edge49" class="edge">
<title>chop.process_message&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M6833.65,-2403.43C6875.99,-2382.87 6914.29,-2355.3 6944,-2318.5 7003.24,-2245.12 6912.14,-1535.99 6980,-1470.5 7025.66,-1426.43 7830.13,-1440.27 8273.84,-1451.36"/>
<polygon fill="black" stroke="black" points="8273.84,-1454.86 8283.92,-1451.62 8274.01,-1447.87 8273.84,-1454.86"/>
</g>
<!-- chop.process_message&#45;&gt;caption_io.has_caption -->
<g id="edge43" class="edge">
<title>chop.process_message&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M6918.31,-2403.36C6927.06,-2399.02 6935.63,-2394.41 6944,-2389.5 6967.31,-2375.83 6955.96,-2352.85 6980,-2340.5 7112.94,-2272.2 8163.38,-2306.3 8475.09,-2318.05"/>
<polygon fill="black" stroke="black" points="8475.3,-2321.56 8485.43,-2318.45 8475.56,-2314.57 8475.3,-2321.56"/>
</g>
<!-- chop.process_message&#45;&gt;lot_io.needs_cleanup -->
<g id="edge48" class="edge">
<title>chop.process_message&#45;&gt;lot_io.needs_cleanup</title>
<path fill="none" stroke="black" d="M6658.27,-2505.54C6762.55,-2540.49 6876.55,-2598.24 6944,-2692.5 6991.04,-2758.24 6921.94,-2998.25 6980,-3054.5 6986.7,-3060.99 8118.03,-3133.32 8463.18,-3155.24"/>
<polygon fill="black" stroke="black" points="8463.2,-3158.75 8473.41,-3155.89 8463.65,-3151.76 8463.2,-3158.75"/>
</g>
<!-- chop.process_message&#45;&gt;chop.has_misc_deal -->
<g id="edge41" class="edge">
<title>chop.process_message&#45;&gt;chop.has_misc_deal</title>
<path fill="none" stroke="black" d="M6875.93,-2403.49C6911.12,-2400.21 6946.12,-2397.16 6980,-2394.5 7124.21,-2383.18 7290.32,-2375.75 7400.66,-2371.6"/>
<polygon fill="black" stroke="black" points="7400.97,-2375.09 7410.83,-2371.22 7400.71,-2368.09 7400.97,-2375.09"/>
</g>
<!-- message_utils.build_prompt -->
<g id="node40" class="node">
<title>message_utils.build_prompt</title>
<g id="a_node40"><a xlink:title="Return prompt combining message text with captioned file names.">
<polygon fill="none" stroke="black" points="8712.5,-2500.5 8413.5,-2500.5 8413.5,-2464.5 8712.5,-2464.5 8712.5,-2500.5"/>
<text text-anchor="middle" x="8563" y="-2477.71" font-family="Times,serif" font-size="19.74">message_utils.build_prompt</text>
</a>
</g>
</g>
<!-- chop.process_message&#45;&gt;message_utils.build_prompt -->
<g id="edge42" class="edge">
<title>chop.process_message&#45;&gt;message_utils.build_prompt</title>
<path fill="none" stroke="black" d="M6922.26,-2503.38C6941.75,-2504.57 6961.05,-2505.62 6980,-2506.5 7463.92,-2529 7585.7,-2518.31 8070,-2506.5 8181.37,-2503.79 8306.79,-2497.62 8403.12,-2492.22"/>
<polygon fill="black" stroke="black" points="8403.45,-2495.7 8413.24,-2491.65 8403.06,-2488.72 8403.45,-2495.7"/>
</g>
<!-- caption_io.read_caption -->
<g id="node41" class="node">
<title>caption_io.read_caption</title>
<g id="a_node41"><a xlink:title="Return caption for ``image`` in ``lang`` or empty string when missing.">
<polygon fill="none" stroke="black" points="8728.5,-2562 8397.5,-2562 8397.5,-2525 8728.5,-2525 8728.5,-2562"/>
<text text-anchor="middle" x="8563" y="-2537.06" font-family="Times,serif" font-size="26.18">caption_io.read_caption</text>
</a>
</g>
</g>
<!-- chop.process_message&#45;&gt;caption_io.read_caption -->
<g id="edge44" class="edge">
<title>chop.process_message&#45;&gt;caption_io.read_caption</title>
<path fill="none" stroke="black" d="M6761.43,-2505.51C6833.43,-2514.48 6909.1,-2522.52 6980,-2527.5 7490.25,-2563.33 8095.32,-2555.5 8387.23,-2548.57"/>
<polygon fill="black" stroke="black" points="8387.57,-2552.06 8397.48,-2548.32 8387.4,-2545.06 8387.57,-2552.06"/>
</g>
<!-- embed.embed_file -->
<g id="node42" class="node">
<title>embed.embed_file</title>
<g id="a_node42"><a xlink:title="Embed ``path`` and write the result beside it under ``EMBED_DIR``.">
<polygon fill="none" stroke="black" points="7730,-2685 7320,-2685 7320,-2630 7730,-2630 7730,-2685"/>
<text text-anchor="middle" x="7525" y="-2646.95" font-family="Times,serif" font-size="42.56">embed.embed_file</text>
</a>
</g>
</g>
<!-- chop.process_message&#45;&gt;embed.embed_file -->
<g id="edge46" class="edge">
<title>chop.process_message&#45;&gt;embed.embed_file</title>
<path fill="none" stroke="black" d="M6568.08,-2505.53C6679.53,-2542.27 6837.62,-2589.74 6980,-2615.5 7087.8,-2635 7209.22,-2645.46 7309.96,-2651.06"/>
<polygon fill="black" stroke="black" points="7309.78,-2654.55 7319.95,-2651.6 7310.16,-2647.56 7309.78,-2654.55"/>
</g>
<!-- lot_io.valid_lots -->
<g id="node43" class="node">
<title>lot_io.valid_lots</title>
<g id="a_node43"><a xlink:title="Return ``True`` when every lot contains the required translations.">
<polygon fill="none" stroke="black" points="8665,-2619.5 8461,-2619.5 8461,-2583.5 8665,-2583.5 8665,-2619.5"/>
<text text-anchor="middle" x="8563" y="-2595.62" font-family="Times,serif" font-size="24.22">lot_io.valid_lots</text>
</a>
</g>
</g>
<!-- chop.process_message&#45;&gt;lot_io.valid_lots -->
<g id="edge47" class="edge">
<title>chop.process_message&#45;&gt;lot_io.valid_lots</title>
<path fill="none" stroke="black" d="M6659.14,-2505.53C6757.88,-2524.66 6874.01,-2544.43 6980,-2555.5 7529.47,-2612.89 8191.7,-2608.51 8450.62,-2603.98"/>
<polygon fill="black" stroke="black" points="8450.85,-2607.48 8460.78,-2603.8 8450.72,-2600.48 8450.85,-2607.48"/>
</g>
<!-- token_utils.estimate_tokens -->
<g id="node44" class="node">
<title>token_utils.estimate_tokens</title>
<g id="a_node44"><a xlink:title="Return a naive token count approximation.">
<polygon fill="none" stroke="black" points="9482.5,-1645.5 9246.5,-1645.5 9246.5,-1609.5 9482.5,-1609.5 9482.5,-1645.5"/>
<text text-anchor="middle" x="9364.5" y="-1623.46" font-family="Times,serif" font-size="15.68">token_utils.estimate_tokens</text>
</a>
</g>
</g>
<!-- chop.process_message&#45;&gt;token_utils.estimate_tokens -->
<g id="edge50" class="edge">
<title>chop.process_message&#45;&gt;token_utils.estimate_tokens</title>
<path fill="none" stroke="black" d="M6832.62,-2403.41C6875.29,-2382.88 6913.94,-2355.31 6944,-2318.5 6991.29,-2260.58 6925.94,-1698.16 6980,-1646.5 7021.09,-1607.24 8747.85,-1621.38 9236.1,-1626.17"/>
<polygon fill="black" stroke="black" points="9236.32,-1629.68 9246.36,-1626.27 9236.39,-1622.68 9236.32,-1629.68"/>
</g>
<!-- caption_io.read_caption&#45;&gt;notes_utils.read_md -->
<g id="edge160" class="edge">
<title>caption_io.read_caption&#45;&gt;notes_utils.read_md</title>
<path fill="none" stroke="black" d="M8728.76,-2553.33C8842.66,-2556.16 8980.53,-2550.37 9020,-2509.5 9090.22,-2436.79 8991.52,-1678.35 9056,-1600.5 9110.46,-1534.74 9212.57,-1522.73 9284.13,-1523.4"/>
<polygon fill="black" stroke="black" points="9284.39,-1526.91 9294.45,-1523.59 9284.52,-1519.91 9284.39,-1526.91"/>
</g>
<!-- caption_io.read_caption&#45;&gt;notes_utils.load_json -->
<g id="edge161" class="edge">
<title>caption_io.read_caption&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M8728.52,-2532.97C8842.1,-2529.61 8979.66,-2534.61 9020,-2574.5 9055.98,-2610.08 9045.03,-2979.1 9056,-3028.5 9128.09,-3353.07 9300.7,-3721.56 9350.09,-3823.27"/>
<polygon fill="black" stroke="black" points="9346.95,-3824.82 9354.48,-3832.27 9353.24,-3821.75 9346.95,-3824.82"/>
</g>
<!-- caption_io.read_caption&#45;&gt;caption_io.caption_json_path -->
<g id="edge163" class="edge">
<title>caption_io.read_caption&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M8702.42,-2524.99C8797.07,-2518.79 8922.55,-2523.69 9020,-2574.5 9197.18,-2666.88 9314.83,-2895.07 9351.38,-2974.06"/>
<polygon fill="black" stroke="black" points="9348.29,-2975.71 9355.63,-2983.36 9354.66,-2972.81 9348.29,-2975.71"/>
</g>
<!-- caption_io.read_caption&#45;&gt;caption_io.caption_md_path -->
<g id="edge164" class="edge">
<title>caption_io.read_caption&#45;&gt;caption_io.caption_md_path</title>
<path fill="none" stroke="black" d="M8728.73,-2547.95C8816.78,-2546.18 8926.08,-2537.28 9020,-2509.5 9143.65,-2472.92 9272.63,-2387.35 9331.17,-2345.46"/>
<polygon fill="black" stroke="black" points="9333.23,-2348.29 9339.29,-2339.6 9329.13,-2342.61 9333.23,-2348.29"/>
</g>
<!-- caption_io._get_langs -->
<g id="node105" class="node">
<title>caption_io._get_langs</title>
<g id="a_node105"><a xlink:title="Return configured languages, caching the result.">
<polygon fill="none" stroke="black" points="9473.5,-2561.5 9255.5,-2561.5 9255.5,-2525.5 9473.5,-2525.5 9473.5,-2561.5"/>
<text text-anchor="middle" x="9364.5" y="-2538.72" font-family="Times,serif" font-size="18.48">caption_io._get_langs</text>
</a>
</g>
</g>
<!-- caption_io.read_caption&#45;&gt;caption_io._get_langs -->
<g id="edge162" class="edge">
<title>caption_io.read_caption&#45;&gt;caption_io._get_langs</title>
<path fill="none" stroke="black" d="M8728.69,-2543.5C8882.54,-2543.5 9108.45,-2543.5 9245.19,-2543.5"/>
<polygon fill="black" stroke="black" points="9245.28,-2547 9255.28,-2543.5 9245.28,-2540 9245.28,-2547"/>
</g>
<!-- embed.embed_file&#45;&gt;lot_io.read_lots -->
<g id="edge261" class="edge">
<title>embed.embed_file&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M7730.22,-2654.08C7847.1,-2640.73 7986.65,-2603.36 8070,-2506.5 8156.44,-2406.04 8022.96,-2313.78 8106,-2210.5 8188.38,-2108.04 8340.75,-2071.07 8446.57,-2057.8"/>
<polygon fill="black" stroke="black" points="8447.15,-2061.25 8456.66,-2056.59 8446.32,-2054.3 8447.15,-2061.25"/>
</g>
<!-- embed.embed_file&#45;&gt;notes_utils.write_json -->
<g id="edge260" class="edge">
<title>embed.embed_file&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M7730.15,-2656.93C7833.36,-2660.73 7959.78,-2671.7 8070,-2699.5 8247.29,-2744.22 8441.05,-2847.97 8522.49,-2894.36"/>
<polygon fill="black" stroke="black" points="8520.98,-2897.53 8531.39,-2899.46 8524.45,-2891.45 8520.98,-2897.53"/>
</g>
<!-- lot_io.make_lot_id -->
<g id="node155" class="node">
<title>lot_io.make_lot_id</title>
<g id="a_node155"><a xlink:title="Return lot id string for ``rel`` and ``index``.&#10;&#10;``rel`` is the JSON file path relative to the ``data/lots`` directory&#10;without the ``.json`` suffix.">
<polygon fill="none" stroke="black" points="8655.5,-2675.5 8470.5,-2675.5 8470.5,-2639.5 8655.5,-2639.5 8655.5,-2675.5"/>
<text text-anchor="middle" x="8563" y="-2652.72" font-family="Times,serif" font-size="18.48">lot_io.make_lot_id</text>
</a>
</g>
</g>
<!-- embed.embed_file&#45;&gt;lot_io.make_lot_id -->
<g id="edge262" class="edge">
<title>embed.embed_file&#45;&gt;lot_io.make_lot_id</title>
<path fill="none" stroke="black" d="M7730.06,-2657.5C7950.02,-2657.5 8291.22,-2657.5 8460.13,-2657.5"/>
<polygon fill="black" stroke="black" points="8460.27,-2661 8470.27,-2657.5 8460.27,-2654 8460.27,-2661"/>
</g>
<!-- chop.main -->
<g id="node45" class="node">
<title>chop.main</title>
<g id="a_node45"><a xlink:title="Process a single message file passed on the command line.">
<polygon fill="none" stroke="black" points="5620,-2401.5 5469,-2401.5 5469,-2365.5 5620,-2365.5 5620,-2401.5"/>
<text text-anchor="middle" x="5544.5" y="-2377.34" font-family="Times,serif" font-size="25.20">chop.main</text>
</a>
</g>
</g>
<!-- chop.main&#45;&gt;chop.process_message -->
<g id="edge51" class="edge">
<title>chop.main&#45;&gt;chop.process_message</title>
<path fill="none" stroke="black" d="M5620.06,-2389.55C5688.24,-2395.09 5795.6,-2403.81 5909.79,-2413.08"/>
<polygon fill="black" stroke="black" points="5909.54,-2416.57 5919.79,-2413.89 5910.11,-2409.59 5909.54,-2416.57"/>
</g>
<!-- build_site._load_ontology -->
<g id="node46" class="node">
<title>build_site._load_ontology</title>
<g id="a_node46"><a xlink:title="Return sorted field list from ``ONTOLOGY`` or empty list when missing.">
<polygon fill="none" stroke="black" points="6577.5,-3493.5 6264.5,-3493.5 6264.5,-3457.5 6577.5,-3457.5 6577.5,-3493.5"/>
<text text-anchor="middle" x="6421" y="-3469.91" font-family="Times,serif" font-size="23.24">build_site._load_ontology</text>
</a>
</g>
</g>
<!-- build_site._load_ontology&#45;&gt;notes_utils.load_json -->
<g id="edge52" class="edge">
<title>build_site._load_ontology&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M6577.68,-3474.16C6870.15,-3472.17 7521.61,-3470.25 8070,-3486.5 8281.31,-3492.76 8825,-3454.84 9020,-3536.5 9171.25,-3599.84 9298.58,-3760.1 9344.85,-3823.8"/>
<polygon fill="black" stroke="black" points="9342.16,-3826.05 9350.83,-3832.13 9347.84,-3821.96 9342.16,-3826.05"/>
</g>
<!-- build_site._compile_locale -->
<g id="node47" class="node">
<title>build_site._compile_locale</title>
<g id="a_node47"><a xlink:title="Compile ``lang`` gettext catalogue when out of date.">
<polygon fill="none" stroke="black" points="6588,-481.5 6254,-481.5 6254,-445.5 6588,-445.5 6588,-481.5"/>
<text text-anchor="middle" x="6421" y="-457.62" font-family="Times,serif" font-size="24.22">build_site._compile_locale</text>
</a>
</g>
</g>
<!-- build_site._env_for_lang -->
<g id="node48" class="node">
<title>build_site._env_for_lang</title>
<g id="a_node48"><a xlink:title="Return Jinja environment configured for ``lang``.">
<polygon fill="none" stroke="black" points="5733,-484 5356,-484 5356,-443 5733,-443 5733,-484"/>
<text text-anchor="middle" x="5544.5" y="-456.26" font-family="Times,serif" font-size="29.68">build_site._env_for_lang</text>
</a>
</g>
</g>
<!-- build_site._env_for_lang&#45;&gt;build_site._compile_locale -->
<g id="edge53" class="edge">
<title>build_site._env_for_lang&#45;&gt;build_site._compile_locale</title>
<path fill="none" stroke="black" d="M5733.1,-463.5C5884.33,-463.5 6095.47,-463.5 6243.62,-463.5"/>
<polygon fill="black" stroke="black" points="6243.74,-467 6253.74,-463.5 6243.74,-460 6243.74,-467"/>
</g>
<!-- build_site._iter_lots -->
<g id="node49" class="node">
<title>build_site._iter_lots</title>
<g id="a_node49"><a xlink:title="Return all lots ready for rendering.">
<polygon fill="none" stroke="black" points="7751,-1599 7299,-1599 7299,-1542 7751,-1542 7751,-1599"/>
<text text-anchor="middle" x="7525" y="-1559.61" font-family="Times,serif" font-size="44.24">build_site._iter_lots</text>
</a>
</g>
</g>
<!-- build_site._iter_lots&#45;&gt;lot_io.read_lots -->
<g id="edge56" class="edge">
<title>build_site._iter_lots&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M7751.32,-1542.1C7862.48,-1541.31 7989.62,-1562.56 8070,-1646.5 8128.05,-1707.13 8045.64,-1964.17 8106,-2022.5 8208.39,-2121.45 8391.42,-2095.39 8491.64,-2070.99"/>
<polygon fill="black" stroke="black" points="8492.51,-2074.38 8501.37,-2068.56 8490.82,-2067.59 8492.51,-2074.38"/>
</g>
<!-- build_site._iter_lots&#45;&gt;lot_io.iter_lot_files -->
<g id="edge57" class="edge">
<title>build_site._iter_lots&#45;&gt;lot_io.iter_lot_files</title>
<path fill="none" stroke="black" d="M7751.17,-1577.87C7851.59,-1587.19 7969.62,-1606.65 8070,-1646.5 8270.1,-1725.93 8466.1,-1902.85 8535.55,-1969.46"/>
<polygon fill="black" stroke="black" points="8533.38,-1972.23 8543,-1976.66 8538.24,-1967.2 8533.38,-1972.23"/>
</g>
<!-- build_site._iter_lots&#45;&gt;moderation.should_skip_message -->
<g id="edge54" class="edge">
<title>build_site._iter_lots&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M7751.1,-1582.56C7879.73,-1584.26 8024.31,-1575.65 8070,-1532.5 8161.86,-1445.75 8034.85,-1354.91 8106,-1250.5 8194.12,-1121.17 8371.97,-1052.36 8477.64,-1021.41"/>
<polygon fill="black" stroke="black" points="8478.68,-1024.75 8487.32,-1018.62 8476.74,-1018.03 8478.68,-1024.75"/>
</g>
<!-- build_site._iter_lots&#45;&gt;moderation.should_skip_lot -->
<g id="edge55" class="edge">
<title>build_site._iter_lots&#45;&gt;moderation.should_skip_lot</title>
<path fill="none" stroke="black" d="M7652.19,-1599.04C7772.77,-1618.48 7952.99,-1626.07 8070,-1532.5 8113.49,-1497.72 8062.33,-1447.04 8106,-1412.5 8152.41,-1375.79 8299.69,-1372.7 8414.46,-1376.52"/>
<polygon fill="black" stroke="black" points="8414.64,-1380.02 8424.76,-1376.88 8414.89,-1373.03 8414.64,-1380.02"/>
</g>
<!-- build_site._iter_lots&#45;&gt;post_io.read_post -->
<g id="edge58" class="edge">
<title>build_site._iter_lots&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7751.32,-1558.69C7849.38,-1552.54 7965.53,-1543.88 8070,-1532.5 8152.01,-1523.56 8241.34,-1511.13 8321.09,-1499.06"/>
<polygon fill="black" stroke="black" points="8321.91,-1502.47 8331.27,-1497.51 8320.86,-1495.55 8321.91,-1502.47"/>
</g>
<!-- build_site._iter_lots&#45;&gt;post_io.raw_post_path -->
<g id="edge59" class="edge">
<title>build_site._iter_lots&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7699.84,-1541.99C7822.42,-1532.78 7980.18,-1545.01 8070,-1646.5 8148.07,-1734.71 8047.29,-3664.38 8106,-3766.5 8188.41,-3909.84 8377.91,-3987.54 8484.87,-4021.4"/>
<polygon fill="black" stroke="black" points="8484.06,-4024.81 8494.64,-4024.45 8486.14,-4018.13 8484.06,-4024.81"/>
</g>
<!-- build_site._copy_images -->
<g id="node50" class="node">
<title>build_site._copy_images</title>
<g id="a_node50"><a xlink:title="Copy media referenced by ``lots`` into ``VIEWS_DIR``.">
<polygon fill="none" stroke="black" points="7688.5,-1093.5 7361.5,-1093.5 7361.5,-1057.5 7688.5,-1057.5 7688.5,-1093.5"/>
<text text-anchor="middle" x="7525" y="-1069.34" font-family="Times,serif" font-size="25.20">build_site._copy_images</text>
</a>
</g>
</g>
<!-- build_site._copy_static -->
<g id="node51" class="node">
<title>build_site._copy_static</title>
<g id="a_node51"><a xlink:title="Copy CSS and JS so generated pages are standalone.">
<polygon fill="none" stroke="black" points="6549,-882.5 6293,-882.5 6293,-846.5 6549,-846.5 6549,-882.5"/>
<text text-anchor="middle" x="6421" y="-859.2" font-family="Times,serif" font-size="21.00">build_site._copy_static</text>
</a>
</g>
</g>
<!-- build_site._load_state -->
<g id="node52" class="node">
<title>build_site._load_state</title>
<g id="a_node52"><a xlink:title="Return ontology fields, embeddings, lots and similarity caches.">
<polygon fill="none" stroke="black" points="5694,-3448 5395,-3448 5395,-3411 5694,-3411 5694,-3448"/>
<text text-anchor="middle" x="5544.5" y="-3423.06" font-family="Times,serif" font-size="26.18">build_site._load_state</text>
</a>
</g>
</g>
<!-- build_site._load_state&#45;&gt;similar_utils._load_embeddings -->
<g id="edge63" class="edge">
<title>build_site._load_state&#45;&gt;similar_utils._load_embeddings</title>
<path fill="none" stroke="black" d="M5665.35,-3410.99C5732.95,-3407.87 5813.37,-3417.74 5862,-3470.5 5919.29,-3532.66 5841.49,-4167.62 5898,-4230.5 6223.27,-4592.48 6494.83,-4360.6 6980,-4398.5 7441.85,-4434.58 7981.85,-4424.42 8296.54,-4413.29"/>
<polygon fill="black" stroke="black" points="8296.84,-4416.78 8306.71,-4412.93 8296.59,-4409.78 8296.84,-4416.78"/>
</g>
<!-- build_site._load_state&#45;&gt;similar_utils._load_similar -->
<g id="edge64" class="edge">
<title>build_site._load_state&#45;&gt;similar_utils._load_similar</title>
<path fill="none" stroke="black" d="M5667.97,-3410.98C5734.96,-3408.29 5813.87,-3418.6 5862,-3470.5 5963.54,-3579.98 5796.9,-4031.61 5898,-4141.5 5921.88,-4167.45 6881.53,-4287.26 7315.13,-4340.21"/>
<polygon fill="black" stroke="black" points="7314.92,-4343.72 7325.27,-4341.45 7315.77,-4336.77 7314.92,-4343.72"/>
</g>
<!-- build_site._load_state&#45;&gt;build_site._load_ontology -->
<g id="edge60" class="edge">
<title>build_site._load_state&#45;&gt;build_site._load_ontology</title>
<path fill="none" stroke="black" d="M5694.34,-3437.33C5849.79,-3445.51 6093.02,-3458.3 6254.44,-3466.79"/>
<polygon fill="black" stroke="black" points="6254.3,-3470.29 6264.47,-3467.32 6254.66,-3463.3 6254.3,-3470.29"/>
</g>
<!-- build_site._load_state&#45;&gt;build_site._iter_lots -->
<g id="edge61" class="edge">
<title>build_site._load_state&#45;&gt;build_site._iter_lots</title>
<path fill="none" stroke="black" d="M5694.04,-3424.47C5755.89,-3414.16 5822.39,-3390.65 5862,-3339.5 5913.13,-3273.46 5844.46,-1900.61 5898,-1836.5 6071.98,-1628.15 6881.66,-1582.53 7288.86,-1572.87"/>
<polygon fill="black" stroke="black" points="7289.08,-1576.36 7299,-1572.63 7288.92,-1569.36 7289.08,-1576.36"/>
</g>
<!-- build_site._load_state&#45;&gt;build_site._copy_images -->
<g id="edge62" class="edge">
<title>build_site._load_state&#45;&gt;build_site._copy_images</title>
<path fill="none" stroke="black" d="M5694.23,-3424.62C5756.12,-3414.34 5822.6,-3390.81 5862,-3339.5 5937.97,-3240.57 5809.61,-1182.51 5898,-1094.5 5948.81,-1043.91 6943.15,-1061.65 7351.36,-1071.13"/>
<polygon fill="black" stroke="black" points="7351.4,-1074.63 7361.48,-1071.37 7351.57,-1067.63 7351.4,-1074.63"/>
</g>
<!-- similar_utils._load_more_user -->
<g id="node53" class="node">
<title>similar_utils._load_more_user</title>
<g id="a_node53"><a xlink:title="Return cached per&#45;user lot mapping.">
<polygon fill="none" stroke="black" points="8822,-3465 8304,-3465 8304,-3420 8822,-3420 8822,-3465"/>
<text text-anchor="middle" x="8563" y="-3434.12" font-family="Times,serif" font-size="33.60">similar_utils._load_more_user</text>
</a>
</g>
</g>
<!-- build_site._load_state&#45;&gt;similar_utils._load_more_user -->
<g id="edge65" class="edge">
<title>build_site._load_state&#45;&gt;similar_utils._load_more_user</title>
<path fill="none" stroke="black" d="M5694.06,-3430.14C6172.22,-3432.2 7676.01,-3438.68 8293.4,-3441.34"/>
<polygon fill="black" stroke="black" points="8293.76,-3444.84 8303.77,-3441.39 8293.79,-3437.84 8293.76,-3444.84"/>
</g>
<!-- similar_utils._load_more_user&#45;&gt;notes_utils.load_json -->
<g id="edge246" class="edge">
<title>similar_utils._load_more_user&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M8822.18,-3430.54C8889.23,-3436.12 8959.55,-3450.12 9020,-3479.5 9183.2,-3558.82 9306.81,-3751.95 9348.36,-3823.37"/>
<polygon fill="black" stroke="black" points="9345.43,-3825.3 9353.45,-3832.23 9351.5,-3821.81 9345.43,-3825.3"/>
</g>
<!-- build_site._categorise -->
<g id="node54" class="node">
<title>build_site._categorise</title>
<g id="a_node54"><a xlink:title="Return category info and recent lot list.&#10;&#10;Categories are split by ``market:deal`` and ``sell_item`` lots are further&#10;grouped by ``item:type``.&#10;Stats include price range, last timestamp and embedding centroid so the&#10;sorting logic used on item pages also works for categories.">
<polygon fill="none" stroke="black" points="7995.5,-581.5 7054.5,-581.5 7054.5,-481.5 7995.5,-481.5 7995.5,-581.5"/>
<text text-anchor="middle" x="7525" y="-510.3" font-family="Times,serif" font-size="84.00">build_site._categorise</text>
</a>
</g>
</g>
<!-- lot_io.get_seller -->
<g id="node55" class="node">
<title>lot_io.get_seller</title>
<g id="a_node55"><a xlink:title="Return the seller identifier or ``None`` when missing.">
<polygon fill="none" stroke="black" points="8663.5,-740.5 8462.5,-740.5 8462.5,-704.5 8663.5,-704.5 8663.5,-740.5"/>
<text text-anchor="middle" x="8563" y="-716.91" font-family="Times,serif" font-size="23.24">lot_io.get_seller</text>
</a>
</g>
</g>
<!-- build_site._categorise&#45;&gt;lot_io.get_seller -->
<g id="edge66" class="edge">
<title>build_site._categorise&#45;&gt;lot_io.get_seller</title>
<path fill="none" stroke="black" d="M7729.37,-581.55C7831.83,-607.34 7957.82,-639.94 8070,-671.5 8086.11,-676.03 8089.58,-679.31 8106,-682.5 8222.92,-705.23 8359.24,-715.06 8452.17,-719.3"/>
<polygon fill="black" stroke="black" points="8452.29,-722.81 8462.43,-719.75 8452.6,-715.81 8452.29,-722.81"/>
</g>
<!-- build_site._render_site -->
<g id="node56" class="node">
<title>build_site._render_site</title>
<g id="a_node56"><a xlink:title="Render all HTML pages for ``lots`` using cached templates.&#10;&#10;``envs`` supplies jinja environments for every language so they are&#10;initialised only once. ``rates`` maps currency codes to multipliers relative&#10;to USD. &#160;The values are embedded into the pages so the front&#45;end can&#10;convert prices on the fly.">
<polygon fill="none" stroke="black" points="6944,-1211 5898,-1211 5898,-1104 6944,-1104 6944,-1211"/>
<text text-anchor="middle" x="6421" y="-1134.87" font-family="Times,serif" font-size="90.16">build_site._render_site</text>
</a>
</g>
</g>
<!-- build_site._render_site&#45;&gt;notes_utils.read_text -->
<g id="edge67" class="edge">
<title>build_site._render_site&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M6944.13,-1139.96C7837.94,-1112.49 9575.09,-1071.3 9673,-1162.5 9956.55,-1426.61 9974.34,-4479.87 9975.43,-4807.13"/>
<polygon fill="black" stroke="black" points="9971.93,-4807.23 9975.46,-4817.22 9978.93,-4807.21 9971.93,-4807.23"/>
</g>
<!-- build_site._render_site&#45;&gt;lot_io.get_seller -->
<g id="edge70" class="edge">
<title>build_site._render_site&#45;&gt;lot_io.get_seller</title>
<path fill="none" stroke="black" d="M6858.52,-1103.95C6890.5,-1086.67 6919.69,-1064.88 6944,-1037.5 6993.43,-981.85 6924.61,-754.22 6980,-704.5 7034.65,-655.44 8102.34,-700.93 8452.11,-717.22"/>
<polygon fill="black" stroke="black" points="8452.09,-720.72 8462.24,-717.69 8452.42,-713.73 8452.09,-720.72"/>
</g>
<!-- build_site.build_page -->
<g id="node57" class="node">
<title>build_site.build_page</title>
<g id="a_node57"><a xlink:title="Render ``lot`` into separate HTML files for every language.&#10;&#10;``rates`` provides currency multipliers used by the front&#45;end for dynamic&#10;conversion. ``envs`` preloads jinja environments to avoid expensive&#10;reinitialisation for each page.">
<polygon fill="none" stroke="black" points="7994.5,-1861.5 7055.5,-1861.5 7055.5,-1759.5 7994.5,-1759.5 7994.5,-1861.5"/>
<text text-anchor="middle" x="7525" y="-1788.96" font-family="Times,serif" font-size="85.68">build_site.build_page</text>
</a>
</g>
</g>
<!-- build_site._render_site&#45;&gt;build_site.build_page -->
<g id="edge68" class="edge">
<title>build_site._render_site&#45;&gt;build_site.build_page</title>
<path fill="none" stroke="black" d="M6933.86,-1211.41C6937.32,-1214.66 6940.7,-1218.02 6944,-1221.5 7024.3,-1306.21 6899.57,-1660.92 6980,-1745.5 6999.56,-1766.07 7021.94,-1782.72 7046.23,-1796.1"/>
<polygon fill="black" stroke="black" points="7044.79,-1799.29 7055.27,-1800.88 7048.07,-1793.11 7044.79,-1799.29"/>
</g>
<!-- similar_utils._format_vector -->
<g id="node58" class="node">
<title>similar_utils._format_vector</title>
<g id="a_node58"><a xlink:title="Return compact JSON representation for ``vec``.">
<polygon fill="none" stroke="black" points="8691.5,-1349.5 8434.5,-1349.5 8434.5,-1313.5 8691.5,-1313.5 8691.5,-1349.5"/>
<text text-anchor="middle" x="8563" y="-1327.34" font-family="Times,serif" font-size="17.08">similar_utils._format_vector</text>
</a>
</g>
</g>
<!-- build_site._render_site&#45;&gt;similar_utils._format_vector -->
<g id="edge69" class="edge">
<title>build_site._render_site&#45;&gt;similar_utils._format_vector</title>
<path fill="none" stroke="black" d="M6944.23,-1148.18C7391.94,-1144.76 7978.85,-1152.91 8070,-1216.5 8104.66,-1240.68 8071.63,-1279.92 8106,-1304.5 8155.35,-1339.79 8308.6,-1342.54 8423.93,-1339.04"/>
<polygon fill="black" stroke="black" points="8424.38,-1342.53 8434.26,-1338.71 8424.16,-1335.53 8424.38,-1342.53"/>
</g>
<!-- build_site.build_page&#45;&gt;post_io.read_post -->
<g id="edge73" class="edge">
<title>build_site.build_page&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7890.44,-1759.47C7951.18,-1746.63 8012.95,-1730.83 8070,-1711.5 8229.16,-1657.57 8400.77,-1559.52 8493.34,-1502.94"/>
<polygon fill="black" stroke="black" points="8495.35,-1505.8 8502.05,-1497.59 8491.69,-1499.84 8495.35,-1505.8"/>
</g>
<!-- build_site.build_page&#45;&gt;post_io.raw_post_path -->
<g id="edge74" class="edge">
<title>build_site.build_page&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7994.62,-1813.78C8022.63,-1828.06 8048.22,-1846.64 8070,-1870.5 8141.04,-1948.3 8053.4,-3675.22 8106,-3766.5 8188.55,-3909.76 8378,-3987.49 8484.91,-4021.38"/>
<polygon fill="black" stroke="black" points="8484.09,-4024.79 8494.68,-4024.43 8486.17,-4018.11 8484.09,-4024.79"/>
</g>
<!-- build_site.build_page&#45;&gt;caption_io.read_caption -->
<g id="edge71" class="edge">
<title>build_site.build_page&#45;&gt;caption_io.read_caption</title>
<path fill="none" stroke="black" d="M7994.56,-1815.17C8022.43,-1829.18 8048.02,-1847.31 8070,-1870.5 8167.84,-1973.73 8006.35,-2408.02 8106,-2509.5 8144.64,-2548.85 8275.64,-2555.5 8387.38,-2553.36"/>
<polygon fill="black" stroke="black" points="8387.52,-2556.86 8397.44,-2553.14 8387.37,-2549.86 8387.52,-2556.86"/>
</g>
<!-- build_site.build_page&#45;&gt;similar_utils._format_vector -->
<g id="edge72" class="edge">
<title>build_site.build_page&#45;&gt;similar_utils._format_vector</title>
<path fill="none" stroke="black" d="M7994.71,-1769.83C8022.55,-1754.38 8048.09,-1735.2 8070,-1711.5 8123.53,-1653.6 8049.07,-1413.06 8106,-1358.5 8150.16,-1316.18 8306.66,-1315.06 8424.09,-1320.85"/>
<polygon fill="black" stroke="black" points="8424.09,-1324.35 8434.26,-1321.37 8424.45,-1317.36 8424.09,-1324.35"/>
</g>
<!-- build_site.main -->
<g id="node59" class="node">
<title>build_site.main</title>
<g id="a_node59"><a xlink:title="Build the static site under ``VIEWS_DIR``.">
<polygon fill="none" stroke="black" points="5155.5,-634 4737.5,-634 4737.5,-569 5155.5,-569 5155.5,-634"/>
<text text-anchor="middle" x="4946.5" y="-588.45" font-family="Times,serif" font-size="51.94">build_site.main</text>
</a>
</g>
</g>
<!-- build_site.main&#45;&gt;config_utils.load_config -->
<g id="edge75" class="edge">
<title>build_site.main&#45;&gt;config_utils.load_config</title>
<path fill="none" stroke="black" d="M4959.9,-568.93C4991.11,-492.06 5081.05,-299.85 5227,-220.5 5460.14,-93.75 6154.63,-167.5 6420,-167.5 6420,-167.5 6420,-167.5 8564,-167.5 8690.87,-167.5 9635.57,-354.76 9673,-370.5 9690.96,-378.05 9690.8,-388.55 9709,-395.5 9722.18,-400.54 9735.97,-404.85 9750.04,-408.53"/>
<polygon fill="black" stroke="black" points="9749.27,-411.94 9759.82,-410.97 9750.97,-405.15 9749.27,-411.94"/>
</g>
<!-- build_site.main&#45;&gt;similar_utils._sync_embeddings -->
<g id="edge86" class="edge">
<title>build_site.main&#45;&gt;similar_utils._sync_embeddings</title>
<path fill="none" stroke="black" d="M4955.36,-634.27C4990.37,-781.88 5132.99,-1400.25 5191,-1916.5 5196.49,-1965.34 5191.69,-2766.31 5227,-2800.5 5263.4,-2835.73 6689.77,-2827 7276.16,-2821.9"/>
<polygon fill="black" stroke="black" points="7276.47,-2825.4 7286.44,-2821.81 7276.41,-2818.4 7276.47,-2825.4"/>
</g>
<!-- build_site.main&#45;&gt;build_site._env_for_lang -->
<g id="edge76" class="edge">
<title>build_site.main&#45;&gt;build_site._env_for_lang</title>
<path fill="none" stroke="black" d="M5020.73,-568.93C5076.25,-545.62 5155.02,-515.47 5227,-498.5 5264.95,-489.55 5306,-482.88 5345.58,-477.9"/>
<polygon fill="black" stroke="black" points="5346.11,-481.36 5355.61,-476.67 5345.26,-474.42 5346.11,-481.36"/>
</g>
<!-- build_site.main&#45;&gt;build_site._copy_static -->
<g id="edge77" class="edge">
<title>build_site.main&#45;&gt;build_site._copy_static</title>
<path fill="none" stroke="black" d="M5155.64,-583.37C5392.73,-567.51 5760.48,-559.01 5862,-647.5 5926.79,-703.97 5833.25,-780.98 5898,-837.5 5953.36,-885.82 6147.58,-883.81 6282.81,-875.81"/>
<polygon fill="black" stroke="black" points="6283.08,-879.3 6292.85,-875.2 6282.66,-872.31 6283.08,-879.3"/>
</g>
<!-- build_site.main&#45;&gt;build_site._load_state -->
<g id="edge78" class="edge">
<title>build_site.main&#45;&gt;build_site._load_state</title>
<path fill="none" stroke="black" d="M4955.55,-634.25C4991.37,-781.77 5136.97,-1399.82 5191,-1916.5 5199.22,-1995.15 5178.54,-3277 5227,-3339.5 5264.47,-3387.83 5325.96,-3411.48 5384.81,-3422.64"/>
<polygon fill="black" stroke="black" points="5384.54,-3426.14 5395,-3424.45 5385.76,-3419.25 5384.54,-3426.14"/>
</g>
<!-- build_site.main&#45;&gt;build_site._categorise -->
<g id="edge79" class="edge">
<title>build_site.main&#45;&gt;build_site._categorise</title>
<path fill="none" stroke="black" d="M5155.63,-575.41C5179.67,-573.07 5203.85,-571.01 5227,-569.5 5853.93,-528.52 6579.05,-523.59 7044.13,-525.85"/>
<polygon fill="black" stroke="black" points="7044.37,-529.35 7054.38,-525.9 7044.4,-522.35 7044.37,-529.35"/>
</g>
<!-- build_site.main&#45;&gt;build_site._render_site -->
<g id="edge80" class="edge">
<title>build_site.main&#45;&gt;build_site._render_site</title>
<path fill="none" stroke="black" d="M4957.78,-634.07C4985.75,-716.65 5071.67,-934.36 5227,-1029.5 5421.95,-1148.92 5669.01,-1189.47 5887.68,-1196.83"/>
<polygon fill="black" stroke="black" points="5887.63,-1200.33 5897.74,-1197.14 5887.85,-1193.33 5887.63,-1200.33"/>
</g>
<!-- build_site.main&#45;&gt;price_utils.canonical_currency -->
<g id="edge81" class="edge">
<title>build_site.main&#45;&gt;price_utils.canonical_currency</title>
<path fill="none" stroke="black" d="M4972.05,-568.79C5016.06,-513.05 5114.35,-401.08 5227,-353.5 5809.6,-107.45 7438.32,-193.76 8070,-224.5 8182.6,-229.98 8309.17,-242.47 8405.74,-253.34"/>
<polygon fill="black" stroke="black" points="8405.55,-256.84 8415.88,-254.49 8406.34,-249.88 8405.55,-256.84"/>
</g>
<!-- price_utils.fetch_official_rates -->
<g id="node61" class="node">
<title>price_utils.fetch_official_rates</title>
<g id="a_node61"><a xlink:title="Return currency multipliers relative to USD from NBG.">
<polygon fill="none" stroke="black" points="5862,-710 5227,-710 5227,-657 5862,-657 5862,-710"/>
<text text-anchor="middle" x="5544.5" y="-673.3" font-family="Times,serif" font-size="40.88">price_utils.fetch_official_rates</text>
</a>
</g>
</g>
<!-- build_site.main&#45;&gt;price_utils.fetch_official_rates -->
<g id="edge82" class="edge">
<title>build_site.main&#45;&gt;price_utils.fetch_official_rates</title>
<path fill="none" stroke="black" d="M5155.78,-632.45C5179.79,-635.9 5203.92,-639.31 5227,-642.5 5258.59,-646.86 5291.96,-651.33 5324.73,-655.65"/>
<polygon fill="black" stroke="black" points="5324.51,-659.15 5334.88,-656.98 5325.42,-652.21 5324.51,-659.15"/>
</g>
<!-- price_utils.load_price_model -->
<g id="node62" class="node">
<title>price_utils.load_price_model</title>
<g id="a_node62"><a xlink:title="Return ``(model, currencies, counts)`` loaded from ``path``.">
<polygon fill="none" stroke="black" points="6655.5,-3375.5 6186.5,-3375.5 6186.5,-3333.5 6655.5,-3333.5 6655.5,-3375.5"/>
<text text-anchor="middle" x="6421" y="-3346.41" font-family="Times,serif" font-size="31.36">price_utils.load_price_model</text>
</a>
</g>
</g>
<!-- build_site.main&#45;&gt;price_utils.load_price_model -->
<g id="edge83" class="edge">
<title>build_site.main&#45;&gt;price_utils.load_price_model</title>
<path fill="none" stroke="black" d="M4955.38,-634.27C4990.47,-781.87 5133.37,-1400.2 5191,-1916.5 5196.66,-1967.17 5195.08,-2793.74 5227,-2833.5 5409.68,-3061.06 5670.17,-2780.6 5862,-3000.5 5949.12,-3100.37 5803.81,-3203.28 5898,-3296.5 6006.24,-3403.62 6195.41,-3395.66 6313.85,-3377.18"/>
<polygon fill="black" stroke="black" points="6314.71,-3380.59 6324.03,-3375.54 6313.6,-3373.68 6314.71,-3380.59"/>
</g>
<!-- price_utils.apply_price_model -->
<g id="node63" class="node">
<title>price_utils.apply_price_model</title>
<g id="a_node63"><a xlink:title="Predict prices in USD and guess missing currencies.">
<polygon fill="none" stroke="black" points="6781.5,-139 6060.5,-139 6060.5,-80 6781.5,-80 6781.5,-139"/>
<text text-anchor="middle" x="6421" y="-97.82" font-family="Times,serif" font-size="46.48">price_utils.apply_price_model</text>
</a>
</g>
</g>
<!-- build_site.main&#45;&gt;price_utils.apply_price_model -->
<g id="edge84" class="edge">
<title>build_site.main&#45;&gt;price_utils.apply_price_model</title>
<path fill="none" stroke="black" d="M4956.25,-569C4981.39,-482.82 5062.79,-248.6 5227,-153.5 5568.52,44.29 6062.04,-27.82 6292.48,-77.74"/>
<polygon fill="black" stroke="black" points="6292.06,-81.24 6302.58,-79.95 6293.56,-74.4 6292.06,-81.24"/>
</g>
<!-- price_utils.prepare_price_fields -->
<g id="node64" class="node">
<title>price_utils.prepare_price_fields</title>
<g id="a_node64"><a xlink:title="Add display price helpers to ``lots``.&#10;&#10;``rates`` maps currency codes to multipliers relative to USD and&#10;``cur`` is the display currency. ``_display_price`` is a formatted&#10;string in ``cur``. ``_usd_value`` stores the numeric USD value so&#10;the front&#45;end can switch currencies without rebuilding the site.&#10;Prices predicted by AI get ``_price_class`` set to ``ai&#45;price`` for&#10;styling.">
<polygon fill="none" stroke="black" points="7895,-387.5 7155,-387.5 7155,-329.5 7895,-329.5 7895,-387.5"/>
<text text-anchor="middle" x="7525" y="-347.21" font-family="Times,serif" font-size="45.36">price_utils.prepare_price_fields</text>
</a>
</g>
</g>
<!-- build_site.main&#45;&gt;price_utils.prepare_price_fields -->
<g id="edge85" class="edge">
<title>build_site.main&#45;&gt;price_utils.prepare_price_fields</title>
<path fill="none" stroke="black" d="M4986.97,-568.71C5038.44,-528.2 5133.06,-461.22 5227,-433.5 5574.84,-330.86 6586.97,-336.17 7144.53,-347.88"/>
<polygon fill="black" stroke="black" points="7144.68,-351.38 7154.75,-348.1 7144.83,-344.38 7144.68,-351.38"/>
</g>
<!-- price_utils.load_price_model&#45;&gt;notes_utils.load_json -->
<g id="edge172" class="edge">
<title>price_utils.load_price_model&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M6655.82,-3360.06C6755.69,-3362.41 6873.56,-3365.14 6980,-3367.5 7093.33,-3370.01 8918.65,-3359.72 9020,-3410.5 9202.56,-3501.98 9317.31,-3740.96 9352.19,-3822.65"/>
<polygon fill="black" stroke="black" points="9349.04,-3824.17 9356.14,-3832.03 9355.49,-3821.45 9349.04,-3824.17"/>
</g>
<!-- price_utils.apply_price_model&#45;&gt;price_utils.train_price_regression -->
<g id="edge174" class="edge">
<title>price_utils.apply_price_model&#45;&gt;price_utils.train_price_regression</title>
<path fill="none" stroke="black" d="M6621.56,-139.02C6798.36,-165.17 7058.01,-203.57 7253.46,-232.48"/>
<polygon fill="black" stroke="black" points="7253.19,-235.98 7263.59,-233.98 7254.21,-229.06 7253.19,-235.98"/>
</g>
<!-- price_utils.predict_price -->
<g id="node109" class="node">
<title>price_utils.predict_price</title>
<g id="a_node109"><a xlink:title="Return predicted price for ``vec`` in ``currency``.&#10;&#10;When ``model`` is ``None`` or ``vec`` is missing, ``None`` is returned.">
<polygon fill="none" stroke="black" points="7730,-43 7320,-43 7320,0 7730,0 7730,-43"/>
<text text-anchor="middle" x="7525" y="-13.35" font-family="Times,serif" font-size="32.06">price_utils.predict_price</text>
</a>
</g>
</g>
<!-- price_utils.apply_price_model&#45;&gt;price_utils.predict_price -->
<g id="edge175" class="edge">
<title>price_utils.apply_price_model&#45;&gt;price_utils.predict_price</title>
<path fill="none" stroke="black" d="M6722.68,-79.99C6805.99,-72.22 6896.47,-64.15 6980,-57.5 7088.55,-48.85 7209.41,-40.71 7309.58,-34.36"/>
<polygon fill="black" stroke="black" points="7310.07,-37.83 7319.83,-33.71 7309.63,-30.85 7310.07,-37.83"/>
</g>
<!-- price_utils.currency_rates -->
<g id="node110" class="node">
<title>price_utils.currency_rates</title>
<g id="a_node110"><a xlink:title="Return estimated currency multipliers relative to the base.&#10;&#10;The regression model learns one coefficient per currency dummy feature. &#160;The&#10;coefficient is the logarithm of the multiplier relative to USD.">
<polygon fill="none" stroke="black" points="8756.5,-139 8369.5,-139 8369.5,-100 8756.5,-100 8756.5,-139"/>
<text text-anchor="middle" x="8563" y="-112.6" font-family="Times,serif" font-size="28.00">price_utils.currency_rates</text>
</a>
</g>
</g>
<!-- price_utils.apply_price_model&#45;&gt;price_utils.currency_rates -->
<g id="edge176" class="edge">
<title>price_utils.apply_price_model&#45;&gt;price_utils.currency_rates</title>
<path fill="none" stroke="black" d="M6781.7,-111.18C7234.53,-113.3 7996.92,-116.86 8359.14,-118.55"/>
<polygon fill="black" stroke="black" points="8359.19,-122.05 8369.21,-118.6 8359.22,-115.05 8359.19,-122.05"/>
</g>
<!-- price_utils._guess_currency_verified -->
<g id="node112" class="node">
<title>price_utils._guess_currency_verified</title>
<g id="a_node112"><a xlink:title="Return currency when both AI and official rates agree.">
<polygon fill="none" stroke="black" points="9621,-90.5 9108,-90.5 9108,-52.5 9621,-52.5 9621,-90.5"/>
<text text-anchor="middle" x="9364.5" y="-64.77" font-family="Times,serif" font-size="27.16">price_utils._guess_currency_verified</text>
</a>
</g>
</g>
<!-- price_utils.apply_price_model&#45;&gt;price_utils._guess_currency_verified -->
<g id="edge177" class="edge">
<title>price_utils.apply_price_model&#45;&gt;price_utils._guess_currency_verified</title>
<path fill="none" stroke="black" d="M6781.58,-104.85C7380.31,-97.12 8568.02,-81.78 9097.72,-74.93"/>
<polygon fill="black" stroke="black" points="9097.84,-78.43 9107.79,-74.8 9097.75,-71.43 9097.84,-78.43"/>
</g>
<!-- price_utils.prepare_price_fields&#45;&gt;price_utils.canonical_currency -->
<g id="edge178" class="edge">
<title>price_utils.prepare_price_fields&#45;&gt;price_utils.canonical_currency</title>
<path fill="none" stroke="black" d="M7895.17,-333.22C7953.68,-328.87 8013.5,-324.22 8070,-319.5 8170.45,-311.1 8282.31,-300.52 8373.95,-291.52"/>
<polygon fill="black" stroke="black" points="8374.56,-294.97 8384.17,-290.51 8373.88,-288.01 8374.56,-294.97"/>
</g>
<!-- message_utils.gather_chop_input -->
<g id="node65" class="node">
<title>message_utils.gather_chop_input</title>
<g id="a_node65"><a xlink:title="Return the exact text fed to the lot parser for ``msg_path``.">
<polygon fill="none" stroke="black" points="7737.5,-2497.5 7312.5,-2497.5 7312.5,-2461.5 7737.5,-2461.5 7737.5,-2497.5"/>
<text text-anchor="middle" x="7525" y="-2473.62" font-family="Times,serif" font-size="24.22">message_utils.gather_chop_input</text>
</a>
</g>
</g>
<!-- message_utils.gather_chop_input&#45;&gt;post_io.read_post -->
<g id="edge89" class="edge">
<title>message_utils.gather_chop_input&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7737.53,-2496.25C7869.74,-2501.66 8023.46,-2496.99 8070,-2451.5 8147.13,-2376.11 8063.71,-2066.72 8106,-1967.5 8193.65,-1761.83 8399.73,-1583.43 8502.11,-1503.79"/>
<polygon fill="black" stroke="black" points="8504.42,-1506.42 8510.19,-1497.53 8500.14,-1500.88 8504.42,-1506.42"/>
</g>
<!-- message_utils.gather_chop_input&#45;&gt;message_utils.build_prompt -->
<g id="edge87" class="edge">
<title>message_utils.gather_chop_input&#45;&gt;message_utils.build_prompt</title>
<path fill="none" stroke="black" d="M7737.52,-2480.11C7934.76,-2480.68 8224.57,-2481.52 8402.86,-2482.04"/>
<polygon fill="black" stroke="black" points="8403.1,-2485.54 8413.11,-2482.07 8403.12,-2478.54 8403.1,-2485.54"/>
</g>
<!-- message_utils.gather_chop_input&#45;&gt;caption_io.read_caption -->
<g id="edge88" class="edge">
<title>message_utils.gather_chop_input&#45;&gt;caption_io.read_caption</title>
<path fill="none" stroke="black" d="M7737.52,-2492.57C7929.05,-2504.4 8207.86,-2521.62 8387.1,-2532.7"/>
<polygon fill="black" stroke="black" points="8386.96,-2536.19 8397.15,-2533.32 8387.39,-2529.21 8386.96,-2536.19"/>
</g>
<!-- tg_client._mark_activity -->
<g id="node66" class="node">
<title>tg_client._mark_activity</title>
<g id="a_node66"><a xlink:title="Update ``_last_event`` to the current time.">
<polygon fill="none" stroke="black" points="5039.5,-4171.5 4853.5,-4171.5 4853.5,-4135.5 5039.5,-4135.5 5039.5,-4171.5"/>
<text text-anchor="middle" x="4946.5" y="-4149.8" font-family="Times,serif" font-size="14.00">tg_client._mark_activity</text>
</a>
</g>
</g>
<!-- tg_client._heartbeat -->
<g id="node67" class="node">
<title>tg_client._heartbeat</title>
<g id="a_node67"><a xlink:title="Periodically log a heartbeat and warn if idle for too long.">
<polygon fill="none" stroke="black" points="1490.5,-4396.5 1260.5,-4396.5 1260.5,-4360.5 1490.5,-4360.5 1490.5,-4396.5"/>
<text text-anchor="middle" x="1375.5" y="-4373.2" font-family="Times,serif" font-size="21.00">tg_client._heartbeat</text>
</a>
</g>
</g>
<!-- tg_client._progress_logger -->
<g id="node68" class="node">
<title>tg_client._progress_logger</title>
<g id="a_node68"><a xlink:title="Return a progress callback that logs received bytes.">
<polygon fill="none" stroke="black" points="5130,-3822 4763,-3822 4763,-3785 5130,-3785 5130,-3822"/>
<text text-anchor="middle" x="4946.5" y="-3797.06" font-family="Times,serif" font-size="26.18">tg_client._progress_logger</text>
</a>
</g>
</g>
<!-- tg_client._write_md -->
<g id="node69" class="node">
<title>tg_client._write_md</title>
<g id="a_node69"><a xlink:title="Helper to store a raw post in Markdown format.">
<polygon fill="none" stroke="black" points="5613,-3916.5 5476,-3916.5 5476,-3880.5 5613,-3880.5 5613,-3916.5"/>
<text text-anchor="middle" x="5544.5" y="-3895.26" font-family="Times,serif" font-size="12.18">tg_client._write_md</text>
</a>
</g>
</g>
<!-- post_io.write_post -->
<g id="node70" class="node">
<title>post_io.write_post</title>
<g id="a_node70"><a xlink:title="Write metadata and body as a Markdown post.">
<polygon fill="none" stroke="black" points="6587,-3924.5 6255,-3924.5 6255,-3878.5 6587,-3878.5 6587,-3924.5"/>
<text text-anchor="middle" x="6421" y="-3893.06" font-family="Times,serif" font-size="34.30">post_io.write_post</text>
</a>
</g>
</g>
<!-- tg_client._write_md&#45;&gt;post_io.write_post -->
<g id="edge90" class="edge">
<title>tg_client._write_md&#45;&gt;post_io.write_post</title>
<path fill="none" stroke="black" d="M5613.03,-3898.73C5747.11,-3899.19 6050.71,-3900.23 6244.92,-3900.9"/>
<polygon fill="black" stroke="black" points="6244.94,-3904.4 6254.95,-3900.93 6244.96,-3897.4 6244.94,-3904.4"/>
</g>
<!-- post_io.write_post&#45;&gt;notes_utils.write_md -->
<g id="edge283" class="edge">
<title>post_io.write_post&#45;&gt;notes_utils.write_md</title>
<path fill="none" stroke="black" d="M6587.28,-3893.4C6810.44,-3882.47 7202.99,-3863.23 7401.57,-3853.5"/>
<polygon fill="black" stroke="black" points="7401.94,-3856.99 7411.75,-3853 7401.59,-3849.99 7401.94,-3856.99"/>
</g>
<!-- post_io.get_contact -->
<g id="node93" class="node">
<title>post_io.get_contact</title>
<g id="a_node93"><a xlink:title="Return a contact identifier from ``meta`` or ``None`` when missing.">
<polygon fill="none" stroke="black" points="7624.5,-3919.5 7425.5,-3919.5 7425.5,-3883.5 7624.5,-3883.5 7624.5,-3919.5"/>
<text text-anchor="middle" x="7525" y="-3896.72" font-family="Times,serif" font-size="18.48">post_io.get_contact</text>
</a>
</g>
</g>
<!-- post_io.write_post&#45;&gt;post_io.get_contact -->
<g id="edge284" class="edge">
<title>post_io.write_post&#45;&gt;post_io.get_contact</title>
<path fill="none" stroke="black" d="M6587.28,-3901.5C6815.64,-3901.5 7221.37,-3901.5 7415.13,-3901.5"/>
<polygon fill="black" stroke="black" points="7415.33,-3905 7425.33,-3901.5 7415.33,-3898 7415.33,-3905"/>
</g>
<!-- post_io.get_timestamp -->
<g id="node167" class="node">
<title>post_io.get_timestamp</title>
<g id="a_node167"><a xlink:title="Return ``meta[&#39;date&#39;]`` as a timezone&#45;aware ``datetime``.">
<polygon fill="none" stroke="black" points="7696.5,-3977.5 7353.5,-3977.5 7353.5,-3937.5 7696.5,-3937.5 7696.5,-3977.5"/>
<text text-anchor="middle" x="7525" y="-3950.43" font-family="Times,serif" font-size="28.84">post_io.get_timestamp</text>
</a>
</g>
</g>
<!-- post_io.write_post&#45;&gt;post_io.get_timestamp -->
<g id="edge285" class="edge">
<title>post_io.write_post&#45;&gt;post_io.get_timestamp</title>
<path fill="none" stroke="black" d="M6587.28,-3909.9C6790.28,-3920.21 7133.43,-3937.65 7343.25,-3948.32"/>
<polygon fill="black" stroke="black" points="7343.29,-3951.82 7353.45,-3948.83 7343.64,-3944.83 7343.29,-3951.82"/>
</g>
<!-- tg_client._scan_group_cache -->
<g id="node71" class="node">
<title>tg_client._scan_group_cache</title>
<g id="a_node71"><a xlink:title="Build group_id &#45;&gt; Path mapping for ``chat`` quickly.">
<polygon fill="none" stroke="black" points="7764.5,-4039 7285.5,-4039 7285.5,-3996 7764.5,-3996 7764.5,-4039"/>
<text text-anchor="middle" x="7525" y="-4009.35" font-family="Times,serif" font-size="32.06">tg_client._scan_group_cache</text>
</a>
</g>
</g>
<!-- tg_client._scan_group_cache&#45;&gt;post_io.raw_post_path -->
<g id="edge91" class="edge">
<title>tg_client._scan_group_cache&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7764.65,-4023.26C7991.87,-4028.74 8321.4,-4036.69 8475.93,-4040.42"/>
<polygon fill="black" stroke="black" points="8476.22,-4043.93 8486.3,-4040.67 8476.39,-4036.93 8476.22,-4043.93"/>
</g>
<!-- tg_client._find_group_path -->
<g id="node72" class="node">
<title>tg_client._find_group_path</title>
<g id="a_node72"><a xlink:title="Return stored message path for ``group_id`` if known.">
<polygon fill="none" stroke="black" points="6554,-3990.5 6288,-3990.5 6288,-3954.5 6554,-3954.5 6554,-3990.5"/>
<text text-anchor="middle" x="6421" y="-3967.72" font-family="Times,serif" font-size="18.48">tg_client._find_group_path</text>
</a>
</g>
</g>
<!-- tg_client._find_group_path&#45;&gt;tg_client._scan_group_cache -->
<g id="edge92" class="edge">
<title>tg_client._find_group_path&#45;&gt;tg_client._scan_group_cache</title>
<path fill="none" stroke="black" d="M6554.11,-3977.89C6731.85,-3985.15 7051.47,-3998.2 7275.06,-4007.33"/>
<polygon fill="black" stroke="black" points="7275.16,-4010.84 7285.3,-4007.75 7275.45,-4003.85 7275.16,-4010.84"/>
</g>
<!-- tg_client._get_message_path -->
<g id="node73" class="node">
<title>tg_client._get_message_path</title>
<g id="a_node73"><a xlink:title="Return path of stored message ``msg_id`` in ``chat`` if any.">
<polygon fill="none" stroke="black" points="3331,-4110.5 3092,-4110.5 3092,-4074.5 3331,-4074.5 3331,-4110.5"/>
<text text-anchor="middle" x="3211.5" y="-4088.46" font-family="Times,serif" font-size="15.68">tg_client._get_message_path</text>
</a>
</g>
</g>
<!-- tg_client._get_message_path&#45;&gt;post_io.raw_post_path -->
<g id="edge93" class="edge">
<title>tg_client._get_message_path&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M3331.26,-4094.37C3638.64,-4099.26 4485.58,-4112.96 5191,-4126.5 5505.24,-4132.53 5583.73,-4138.02 5898,-4141.5 6378.86,-4146.82 6499.11,-4142.28 6980,-4142.5 7101.11,-4142.56 7967.82,-4207.52 8070,-4142.5 8101.87,-4122.22 8074.65,-4086.58 8106,-4065.5 8216.82,-3990.99 8379.26,-4004.59 8477.38,-4022.59"/>
<polygon fill="black" stroke="black" points="8476.79,-4026.04 8487.26,-4024.46 8478.09,-4019.16 8476.79,-4026.04"/>
</g>
<!-- tg_client._should_skip_media -->
<g id="node74" class="node">
<title>tg_client._should_skip_media</title>
<g id="a_node74"><a xlink:title="Return reason string if ``msg`` media should be skipped.">
<polygon fill="none" stroke="black" points="5191,-3337 4702,-3337 4702,-3294 5191,-3294 5191,-3337"/>
<text text-anchor="middle" x="4946.5" y="-3307.35" font-family="Times,serif" font-size="32.06">tg_client._should_skip_media</text>
</a>
</g>
</g>
<!-- tg_client._allowed_topic -->
<g id="node75" class="node">
<title>tg_client._allowed_topic</title>
<g id="a_node75"><a xlink:title="Return ``True`` if ``msg`` belongs to an allowed forum topic.">
<polygon fill="none" stroke="black" points="5756.5,-3055 5332.5,-3055 5332.5,-3010 5756.5,-3010 5756.5,-3055"/>
<text text-anchor="middle" x="5544.5" y="-3024.12" font-family="Times,serif" font-size="33.60">tg_client._allowed_topic</text>
</a>
</g>
</g>
<!-- tg_client._extract_author -->
<g id="node76" class="node">
<title>tg_client._extract_author</title>
<g id="a_node76"><a xlink:title="Return a metadata dictionary describing the message author.">
<polygon fill="none" stroke="black" points="6784,-4132.5 6058,-4132.5 6058,-4062.5 6784,-4062.5 6784,-4132.5"/>
<text text-anchor="middle" x="6421" y="-4083.7" font-family="Times,serif" font-size="56.00">tg_client._extract_author</text>
</a>
</g>
</g>
<!-- phone_utils.format_georgian -->
<g id="node77" class="node">
<title>phone_utils.format_georgian</title>
<g id="a_node77"><a xlink:title="Return ``phone`` in ``+995...`` format if possible.">
<polygon fill="none" stroke="black" points="7731,-4133.5 7319,-4133.5 7319,-4095.5 7731,-4095.5 7731,-4133.5"/>
<text text-anchor="middle" x="7525" y="-4107.77" font-family="Times,serif" font-size="27.16">phone_utils.format_georgian</text>
</a>
</g>
</g>
<!-- tg_client._extract_author&#45;&gt;phone_utils.format_georgian -->
<g id="edge94" class="edge">
<title>tg_client._extract_author&#45;&gt;phone_utils.format_georgian</title>
<path fill="none" stroke="black" d="M6784.36,-4103.09C6957.75,-4105.76 7159.49,-4108.88 7308.44,-4111.17"/>
<polygon fill="black" stroke="black" points="7308.57,-4114.68 7318.62,-4111.33 7308.67,-4107.68 7308.57,-4114.68"/>
</g>
<!-- tg_client._schedule_caption -->
<g id="node78" class="node">
<title>tg_client._schedule_caption</title>
<g id="a_node78"><a xlink:title="Run captioning in a separate process so downloads continue.">
<polygon fill="none" stroke="black" points="5683.5,-3515.5 5405.5,-3515.5 5405.5,-3479.5 5683.5,-3479.5 5683.5,-3515.5"/>
<text text-anchor="middle" x="5544.5" y="-3492.72" font-family="Times,serif" font-size="18.48">tg_client._schedule_caption</text>
</a>
</g>
</g>
<!-- tg_client._schedule_chop -->
<g id="node79" class="node">
<title>tg_client._schedule_chop</title>
<g id="a_node79"><a xlink:title="Run lot extraction in a separate process.">
<polygon fill="none" stroke="black" points="8711,-2255.5 8415,-2255.5 8415,-2219.5 8711,-2219.5 8711,-2255.5"/>
<text text-anchor="middle" x="8563" y="-2231.8" font-family="Times,serif" font-size="22.12">tg_client._schedule_chop</text>
</a>
</g>
</g>
<!-- tg_client._enqueue_chop -->
<g id="node80" class="node">
<title>tg_client._enqueue_chop</title>
<g id="a_node80"><a xlink:title="Queue ``path`` for chopping once captions are available.">
<polygon fill="none" stroke="black" points="5189,-2292 4704,-2292 4704,-2243 5189,-2243 5189,-2292"/>
<text text-anchor="middle" x="4946.5" y="-2257.87" font-family="Times,serif" font-size="37.66">tg_client._enqueue_chop</text>
</a>
</g>
</g>
<!-- tg_client._enqueue_chop&#45;&gt;moderation.should_skip_message -->
<g id="edge97" class="edge">
<title>tg_client._enqueue_chop&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M5158.85,-2242.98C5170.88,-2235.59 5181.8,-2226.54 5191,-2215.5 5279.24,-2109.61 5142.43,-1084.34 5227,-975.5 5417.32,-730.56 5590.82,-826.58 5898,-783.5 6358.38,-718.93 6515.73,-602.66 6944,-783.5 6965.14,-792.43 6959.07,-811.09 6980,-820.5 7201.16,-919.92 7853.92,-760.48 8070,-870.5 8092.82,-882.12 8084.03,-902.33 8106,-915.5 8189.88,-965.8 8296.8,-987.5 8386.02,-996.42"/>
<polygon fill="black" stroke="black" points="8385.69,-999.91 8395.98,-997.37 8386.36,-992.94 8385.69,-999.91"/>
</g>
<!-- tg_client._enqueue_chop&#45;&gt;caption_io.has_caption -->
<g id="edge96" class="edge">
<title>tg_client._enqueue_chop&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M5189.17,-2263.78C5711.4,-2255.58 6901.78,-2235.91 6944,-2226.5 6961.09,-2222.69 6962.87,-2214.13 6980,-2210.5 7098.47,-2185.36 7963.22,-2153.35 8070,-2210.5 8095.43,-2224.11 8081.46,-2249.34 8106,-2264.5 8219.07,-2334.38 8378.1,-2337.45 8475.38,-2331.07"/>
<polygon fill="black" stroke="black" points="8475.74,-2334.55 8485.47,-2330.36 8475.25,-2327.57 8475.74,-2334.55"/>
</g>
<!-- tg_client._start_chop_worker -->
<g id="node81" class="node">
<title>tg_client._start_chop_worker</title>
<g id="a_node81"><a xlink:title="Ensure the chop queue worker task is running.">
<polygon fill="none" stroke="black" points="5677.5,-2309.5 5411.5,-2309.5 5411.5,-2273.5 5677.5,-2273.5 5677.5,-2309.5"/>
<text text-anchor="middle" x="5544.5" y="-2287.34" font-family="Times,serif" font-size="17.08">tg_client._start_chop_worker</text>
</a>
</g>
</g>
<!-- tg_client._enqueue_chop&#45;&gt;tg_client._start_chop_worker -->
<g id="edge95" class="edge">
<title>tg_client._enqueue_chop&#45;&gt;tg_client._start_chop_worker</title>
<path fill="none" stroke="black" d="M5189.06,-2277.23C5261.03,-2280.13 5337.57,-2283.21 5401.04,-2285.76"/>
<polygon fill="black" stroke="black" points="5400.97,-2289.26 5411.11,-2286.17 5401.25,-2282.27 5400.97,-2289.26"/>
</g>
<!-- tg_client._chop_worker -->
<g id="node82" class="node">
<title>tg_client._chop_worker</title>
<g id="a_node82"><a xlink:title="Background task processing ``_CHOP_QUEUE``.">
<polygon fill="none" stroke="black" points="6546.5,-2309.5 6295.5,-2309.5 6295.5,-2273.5 6546.5,-2273.5 6546.5,-2309.5"/>
<text text-anchor="middle" x="6421" y="-2286.71" font-family="Times,serif" font-size="19.74">tg_client._chop_worker</text>
</a>
</g>
</g>
<!-- tg_client._start_chop_worker&#45;&gt;tg_client._chop_worker -->
<g id="edge98" class="edge">
<title>tg_client._start_chop_worker&#45;&gt;tg_client._chop_worker</title>
<path fill="none" stroke="black" d="M5677.84,-2291.5C5841.88,-2291.5 6119.94,-2291.5 6285.14,-2291.5"/>
<polygon fill="black" stroke="black" points="6285.36,-2295 6295.36,-2291.5 6285.36,-2288 6285.36,-2295"/>
</g>
<!-- tg_client._process_chop_queue -->
<g id="node83" class="node">
<title>tg_client._process_chop_queue</title>
<g id="a_node83"><a xlink:title="Check queued posts and chop cooled down ones.">
<polygon fill="none" stroke="black" points="7706.5,-2255.5 7343.5,-2255.5 7343.5,-2219.5 7706.5,-2219.5 7706.5,-2255.5"/>
<text text-anchor="middle" x="7525" y="-2231.8" font-family="Times,serif" font-size="22.12">tg_client._process_chop_queue</text>
</a>
</g>
</g>
<!-- tg_client._chop_worker&#45;&gt;tg_client._process_chop_queue -->
<g id="edge101" class="edge">
<title>tg_client._chop_worker&#45;&gt;tg_client._process_chop_queue</title>
<path fill="none" stroke="black" d="M6546.54,-2285.4C6738.32,-2276 7107.35,-2257.92 7333.04,-2246.86"/>
<polygon fill="black" stroke="black" points="7333.53,-2250.34 7343.35,-2246.35 7333.19,-2243.35 7333.53,-2250.34"/>
</g>
<!-- tg_client._process_chop_queue&#45;&gt;caption_io.has_caption -->
<g id="edge100" class="edge">
<title>tg_client._process_chop_queue&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M7706.55,-2246.01C7812.51,-2251.53 7948.96,-2259.55 8070,-2269.5 8212.21,-2281.19 8377.03,-2299.61 8475.23,-2311.09"/>
<polygon fill="black" stroke="black" points="8475.07,-2314.6 8485.41,-2312.29 8475.88,-2307.65 8475.07,-2314.6"/>
</g>
<!-- tg_client._process_chop_queue&#45;&gt;tg_client._schedule_chop -->
<g id="edge99" class="edge">
<title>tg_client._process_chop_queue&#45;&gt;tg_client._schedule_chop</title>
<path fill="none" stroke="black" d="M7706.75,-2237.5C7904.05,-2237.5 8216.81,-2237.5 8404.44,-2237.5"/>
<polygon fill="black" stroke="black" points="8404.67,-2241 8414.67,-2237.5 8404.67,-2234 8404.67,-2241"/>
</g>
<!-- tg_client._flush_chop_queue -->
<g id="node84" class="node">
<title>tg_client._flush_chop_queue</title>
<g id="a_node84"><a xlink:title="Run the chop worker until the queue is empty and cancel it.">
<polygon fill="none" stroke="black" points="2204,-3177 1768,-3177 1768,-3136 2204,-3136 2204,-3177"/>
<text text-anchor="middle" x="1986" y="-3149.26" font-family="Times,serif" font-size="29.68">tg_client._flush_chop_queue</text>
</a>
</g>
</g>
<!-- tg_client._flush_chop_queue&#45;&gt;tg_client._process_chop_queue -->
<g id="edge102" class="edge">
<title>tg_client._flush_chop_queue&#45;&gt;tg_client._process_chop_queue</title>
<path fill="none" stroke="black" d="M2001.91,-3135.85C2095.59,-3008.69 2618.12,-2337.5 3210.5,-2337.5 3210.5,-2337.5 3210.5,-2337.5 5545.5,-2337.5 5623.2,-2337.5 6875.25,-2354.72 6944,-2318.5 6968.55,-2305.57 6955.73,-2280.94 6980,-2267.5 7039.03,-2234.82 7201.2,-2229.25 7333.23,-2230.72"/>
<polygon fill="black" stroke="black" points="7333.44,-2234.22 7343.49,-2230.85 7333.53,-2227.22 7333.44,-2234.22"/>
</g>
<!-- tg_client._get_id_date -->
<g id="node85" class="node">
<title>tg_client._get_id_date</title>
<g id="a_node85"><a xlink:title="Return the stored date for ``msg_id`` in ``chat`` if available.">
<polygon fill="none" stroke="black" points="7697,-5043 7353,-5043 7353,-5002 7697,-5002 7697,-5043"/>
<text text-anchor="middle" x="7525" y="-5015.26" font-family="Times,serif" font-size="29.68">tg_client._get_id_date</text>
</a>
</g>
</g>
<!-- tg_client._get_id_date&#45;&gt;post_io.raw_post_path -->
<g id="edge104" class="edge">
<title>tg_client._get_id_date&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7697.19,-5036.8C7836.86,-5044.32 8019.1,-5043.26 8070,-4992.5 8118.94,-4943.7 8072.75,-4432.09 8106,-4371.5 8195.17,-4209 8402.92,-4106.56 8504.29,-4064.49"/>
<polygon fill="black" stroke="black" points="8505.84,-4067.63 8513.76,-4060.6 8503.18,-4061.16 8505.84,-4067.63"/>
</g>
<!-- tg_client._get_id_date&#45;&gt;notes_utils.read_text -->
<g id="edge103" class="edge">
<title>tg_client._get_id_date&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M7697.34,-5030.84C8173.04,-5053.14 9487.33,-5108.54 9673,-5049.5 9791.42,-5011.85 9903.36,-4909.17 9951.18,-4861.04"/>
<polygon fill="black" stroke="black" points="9953.78,-4863.39 9958.29,-4853.8 9948.79,-4858.48 9953.78,-4863.39"/>
</g>
<!-- tg_client._load_progress -->
<g id="node86" class="node">
<title>tg_client._load_progress</title>
<g id="a_node86"><a xlink:title="Return saved resume timestamp for ``chat`` if available.">
<polygon fill="none" stroke="black" points="2151,-5263.5 1821,-5263.5 1821,-5227.5 2151,-5227.5 2151,-5263.5"/>
<text text-anchor="middle" x="1986" y="-5239.34" font-family="Times,serif" font-size="25.20">tg_client._load_progress</text>
</a>
</g>
</g>
<!-- tg_client._load_progress&#45;&gt;notes_utils.read_text -->
<g id="edge105" class="edge">
<title>tg_client._load_progress&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M2151.2,-5262.09C2169.03,-5264.13 2186.91,-5266.29 2204,-5268.5 2652.8,-5326.59 2757.96,-5422.5 3210.5,-5422.5 3210.5,-5422.5 3210.5,-5422.5 8564,-5422.5 8687.24,-5422.5 9567.89,-5467.84 9673,-5403.5 9878.76,-5277.55 9952.63,-4959.97 9970.71,-4863.64"/>
<polygon fill="black" stroke="black" points="9974.21,-4863.97 9972.56,-4853.51 9967.32,-4862.72 9974.21,-4863.97"/>
</g>
<!-- tg_client._save_progress -->
<g id="node87" class="node">
<title>tg_client._save_progress</title>
<g id="a_node87"><a xlink:title="Persist resume timestamp for ``chat`` to ``STATE_DIR``.">
<polygon fill="none" stroke="black" points="2721,-4323.5 2492,-4323.5 2492,-4287.5 2721,-4287.5 2721,-4323.5"/>
<text text-anchor="middle" x="2606.5" y="-4301.34" font-family="Times,serif" font-size="17.08">tg_client._save_progress</text>
</a>
</g>
</g>
<!-- tg_client.get_first_id -->
<g id="node88" class="node">
<title>tg_client.get_first_id</title>
<g id="a_node88"><a xlink:title="Return the smallest saved message id for ``chat``.">
<polygon fill="none" stroke="black" points="3345,-4415.5 3078,-4415.5 3078,-4379.5 3345,-4379.5 3345,-4415.5"/>
<text text-anchor="middle" x="3211.5" y="-4391.62" font-family="Times,serif" font-size="24.22">tg_client.get_first_id</text>
</a>
</g>
</g>
<!-- tg_client.get_first_id&#45;&gt;post_io.raw_post_path -->
<g id="edge106" class="edge">
<title>tg_client.get_first_id&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M3345.12,-4396.47C3635.28,-4394.31 4348.27,-4389.5 4945.5,-4389.5 4945.5,-4389.5 4945.5,-4389.5 5545.5,-4389.5 6167.15,-4389.5 6366.6,-4595.82 6944,-4365.5 6964.16,-4357.46 6959.93,-4340.77 6980,-4332.5 7092.07,-4286.34 7979.31,-4369.92 8070,-4289.5 8145.44,-4222.6 8030.92,-4132.81 8106,-4065.5 8211.85,-3970.6 8393.18,-3997.38 8492.29,-4021.92"/>
<polygon fill="black" stroke="black" points="8491.65,-4025.37 8502.21,-4024.44 8493.38,-4018.59 8491.65,-4025.37"/>
</g>
<!-- tg_client.get_last_id -->
<g id="node89" class="node">
<title>tg_client.get_last_id</title>
<g id="a_node89"><a xlink:title="Return the highest saved message id for ``chat``.">
<polygon fill="none" stroke="black" points="2116.5,-4369.5 1855.5,-4369.5 1855.5,-4333.5 2116.5,-4333.5 2116.5,-4369.5"/>
<text text-anchor="middle" x="1986" y="-4345.62" font-family="Times,serif" font-size="24.22">tg_client.get_last_id</text>
</a>
</g>
</g>
<!-- tg_client.get_last_id&#45;&gt;post_io.raw_post_path -->
<g id="edge107" class="edge">
<title>tg_client.get_last_id&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M2116.93,-4351.5C2340.4,-4351.5 2811.96,-4351.5 3210.5,-4351.5 3210.5,-4351.5 3210.5,-4351.5 5545.5,-4351.5 6183.65,-4351.5 6342.34,-4314.39 6980,-4289.5 7040.55,-4287.14 8023.94,-4290.87 8070,-4251.5 8134.01,-4196.79 8042.42,-4120.7 8106,-4065.5 8212.76,-3972.8 8392.13,-3998.12 8491.09,-4021.99"/>
<polygon fill="black" stroke="black" points="8490.45,-4025.44 8501,-4024.44 8492.13,-4018.64 8490.45,-4025.44"/>
</g>
<!-- tg_client._save_message -->
<g id="node90" class="node">
<title>tg_client._save_message</title>
<g id="a_node90"><a xlink:title="Write ``msg`` to disk with metadata and any media references.&#10;&#10;Returns the path of the stored message or ``None`` when skipped.">
<polygon fill="none" stroke="black" points="4666,-3885 3450,-3885 3450,-3770 4666,-3770 4666,-3885"/>
<text text-anchor="middle" x="4058" y="-3803.38" font-family="Times,serif" font-size="97.02">tg_client._save_message</text>
</a>
</g>
</g>
<!-- tg_client._save_message&#45;&gt;post_io.read_post -->
<g id="edge120" class="edge">
<title>tg_client._save_message&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M4061.98,-3769.99C4078.04,-3517.37 4174.56,-2493.14 4702,-1916.5 5093.8,-1488.15 5331.27,-1517.26 5898,-1391.5 6133.62,-1339.21 7853.03,-1260.79 8070,-1366.5 8093.34,-1377.87 8083.28,-1399.95 8106,-1412.5 8156.79,-1440.56 8215.63,-1456.45 8273.83,-1464.82"/>
<polygon fill="black" stroke="black" points="8273.54,-1468.32 8283.92,-1466.2 8274.48,-1461.38 8273.54,-1468.32"/>
</g>
<!-- tg_client._save_message&#45;&gt;post_io.raw_post_path -->
<g id="edge121" class="edge">
<title>tg_client._save_message&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M4421.82,-3885C4513.1,-3898.08 4611,-3910.93 4702,-3920.5 6191.73,-4077.2 6572.07,-4055.11 8070,-4047.5 8212.31,-4046.78 8377.77,-4044.88 8475.98,-4043.64"/>
<polygon fill="black" stroke="black" points="8476.19,-4047.14 8486.15,-4043.51 8476.1,-4040.14 8476.19,-4047.14"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._mark_activity -->
<g id="edge108" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._mark_activity</title>
<path fill="none" stroke="black" d="M4192.41,-3885.11C4321.46,-3939.75 4523.22,-4022.38 4702,-4083.5 4756.22,-4102.04 4818.32,-4119.83 4866.23,-4132.85"/>
<polygon fill="black" stroke="black" points="4865.36,-4136.24 4875.92,-4135.47 4867.18,-4129.48 4865.36,-4136.24"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._progress_logger -->
<g id="edge109" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._progress_logger</title>
<path fill="none" stroke="black" d="M4666.22,-3811.06C4696.34,-3810.25 4725.28,-3809.46 4752.37,-3808.73"/>
<polygon fill="black" stroke="black" points="4752.75,-3812.22 4762.66,-3808.45 4752.57,-3805.22 4752.75,-3812.22"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._write_md -->
<g id="edge110" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._write_md</title>
<path fill="none" stroke="black" d="M4666.06,-3862.71C4678.14,-3863.32 4690.13,-3863.92 4702,-3864.5 4982.95,-3878.26 5316.87,-3890.54 5465.48,-3895.79"/>
<polygon fill="black" stroke="black" points="5465.74,-3899.3 5475.86,-3896.16 5465.98,-3892.31 5465.74,-3899.3"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._find_group_path -->
<g id="edge111" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._find_group_path</title>
<path fill="none" stroke="black" d="M4648.91,-3885.03C4666.81,-3886.56 4684.54,-3888.06 4702,-3889.5 4935.09,-3908.73 4993.46,-3912.9 5227,-3925.5 5606.41,-3945.98 6054.14,-3961.23 6277.83,-3968.24"/>
<polygon fill="black" stroke="black" points="6277.88,-3971.74 6287.98,-3968.55 6278.1,-3964.74 6277.88,-3971.74"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._should_skip_media -->
<g id="edge112" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._should_skip_media</title>
<path fill="none" stroke="black" d="M4114.16,-3769.94C4218.1,-3665.54 4454.84,-3446.49 4702,-3346.5 4707.57,-3344.25 4713.26,-3342.15 4719.05,-3340.19"/>
<polygon fill="black" stroke="black" points="4720.42,-3343.43 4728.87,-3337.04 4718.28,-3336.77 4720.42,-3343.43"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._allowed_topic -->
<g id="edge113" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._allowed_topic</title>
<path fill="none" stroke="black" d="M4114.49,-3769.92C4220.36,-3662.65 4462.1,-3429.93 4702,-3284.5 4917.62,-3153.79 4982.86,-3132.5 5227,-3069.5 5257.46,-3061.64 5290.01,-3055.45 5322.21,-3050.57"/>
<polygon fill="black" stroke="black" points="5322.81,-3054.02 5332.19,-3049.09 5321.79,-3047.09 5322.81,-3054.02"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._extract_author -->
<g id="edge114" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._extract_author</title>
<path fill="none" stroke="black" d="M4190.79,-3885.09C4318.66,-3937.85 4519.59,-4012.58 4702,-4045.5 4950.57,-4090.36 5621.69,-4098.63 6047.79,-4099.08"/>
<polygon fill="black" stroke="black" points="6047.81,-4102.58 6057.81,-4099.09 6047.81,-4095.58 6047.81,-4102.58"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._enqueue_chop -->
<g id="edge115" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._enqueue_chop</title>
<path fill="none" stroke="black" d="M4067.67,-3769.66C4103.24,-3552.09 4257.8,-2774.12 4702,-2356.5 4732.23,-2328.08 4772.27,-2308.59 4811.12,-2295.28"/>
<polygon fill="black" stroke="black" points="4812.57,-2298.48 4820.97,-2292.02 4810.38,-2291.84 4812.57,-2298.48"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._save_message -->
<g id="edge116" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._save_message</title>
<path fill="none" stroke="black" d="M3908.09,-3885.11C3927.06,-3895.62 3977.04,-3903 4058,-3903 4128.21,-3903 4175.12,-3897.45 4198.71,-3889.12"/>
<polygon fill="black" stroke="black" points="4200.15,-3892.31 4207.91,-3885.11 4197.35,-3885.9 4200.15,-3892.31"/>
</g>
<!-- tg_client._save_media -->
<g id="node91" class="node">
<title>tg_client._save_media</title>
<g id="a_node91"><a xlink:title="Store ``data`` and return relative file path.">
<polygon fill="none" stroke="black" points="5187.5,-3524.5 4705.5,-3524.5 4705.5,-3470.5 5187.5,-3470.5 5187.5,-3524.5"/>
<text text-anchor="middle" x="4946.5" y="-3486.9" font-family="Times,serif" font-size="42.00">tg_client._save_media</text>
</a>
</g>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._save_media -->
<g id="edge117" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._save_media</title>
<path fill="none" stroke="black" d="M4213.67,-3769.92C4402.66,-3699.57 4715.47,-3583.13 4863.29,-3528.1"/>
<polygon fill="black" stroke="black" points="4864.63,-3531.34 4872.78,-3524.57 4862.19,-3524.78 4864.63,-3531.34"/>
</g>
<!-- moderation.should_skip_user -->
<g id="node92" class="node">
<title>moderation.should_skip_user</title>
<g id="a_node92"><a xlink:title="Return ``True`` if ``username`` is blacklisted.">
<polygon fill="none" stroke="black" points="10100.5,-506.5 9852.5,-506.5 9852.5,-470.5 10100.5,-470.5 10100.5,-506.5"/>
<text text-anchor="middle" x="9976.5" y="-484.46" font-family="Times,serif" font-size="15.68">moderation.should_skip_user</text>
</a>
</g>
</g>
<!-- tg_client._save_message&#45;&gt;moderation.should_skip_user -->
<g id="edge118" class="edge">
<title>tg_client._save_message&#45;&gt;moderation.should_skip_user</title>
<path fill="none" stroke="black" d="M4058.47,-3769.96C4058.82,-3415 4113.51,-1520.35 5227,-975.5 5495.65,-844.05 5599.35,-940.55 5898,-924.5 5956.06,-921.38 6901.79,-931.48 6944,-891.5 7011.85,-827.23 6911.15,-535.69 6980,-472.5 7158.46,-308.72 7827.78,-471.48 8070,-472.5 8735.26,-475.29 9531.13,-483.57 9841.93,-486.99"/>
<polygon fill="black" stroke="black" points="9842.3,-490.5 9852.33,-487.11 9842.37,-483.5 9842.3,-490.5"/>
</g>
<!-- tg_client._save_message&#45;&gt;post_io.get_contact -->
<g id="edge119" class="edge">
<title>tg_client._save_message&#45;&gt;post_io.get_contact</title>
<path fill="none" stroke="black" d="M4666.24,-3832.34C5445.76,-3839.18 6724.47,-3852.72 6944,-3869.5 6960.11,-3870.73 6963.92,-3872.99 6980,-3874.5 7130.41,-3888.65 7304.95,-3895.65 7414.93,-3898.92"/>
<polygon fill="black" stroke="black" points="7414.94,-3902.42 7425.04,-3899.22 7415.15,-3895.43 7414.94,-3902.42"/>
</g>
<!-- tg_client._save_media&#45;&gt;caption_io.has_caption -->
<g id="edge124" class="edge">
<title>tg_client._save_media&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M5090.85,-3470.4C5129.37,-3456.04 5166.96,-3434.08 5191,-3400.5 5282.7,-3272.4 5137.81,-2822.36 5227,-2692.5 5227,-2692.5 5898,-2394.5 5898,-2394.5 6011.27,-2368.02 6842.59,-2408.48 6944,-2351.5 6969.15,-2337.37 6954.57,-2311.11 6980,-2297.5 7086.78,-2240.35 7948.92,-2294.55 8070,-2297.5 8212.02,-2300.96 8376.9,-2310.04 8475.17,-2315.98"/>
<polygon fill="black" stroke="black" points="8475.15,-2319.49 8485.34,-2316.6 8475.57,-2312.5 8475.15,-2319.49"/>
</g>
<!-- tg_client._save_media&#45;&gt;tg_client._schedule_caption -->
<g id="edge122" class="edge">
<title>tg_client._save_media&#45;&gt;tg_client._schedule_caption</title>
<path fill="none" stroke="black" d="M5187.77,-3497.5C5257.89,-3497.5 5332.45,-3497.5 5395.1,-3497.5"/>
<polygon fill="black" stroke="black" points="5395.45,-3501 5405.45,-3497.5 5395.45,-3494 5395.45,-3501"/>
</g>
<!-- tg_client._save_media&#45;&gt;caption_io.caption_json_path -->
<g id="edge123" class="edge">
<title>tg_client._save_media&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M5074.41,-3470.41C5116.36,-3455.86 5160.14,-3433.79 5191,-3400.5 5227.41,-3361.22 5185.8,-3319.72 5227,-3285.5 5458.05,-3093.62 5598.99,-3233.67 5898,-3205.5 7281.73,-3075.14 7632.69,-3109.66 9020,-3025.5 9099.6,-3020.67 9189.52,-3014.36 9257.38,-3009.42"/>
<polygon fill="black" stroke="black" points="9257.94,-3012.89 9267.66,-3008.67 9257.43,-3005.91 9257.94,-3012.89"/>
</g>
<!-- image_io.write_image_meta -->
<g id="node95" class="node">
<title>image_io.write_image_meta</title>
<g id="a_node95"><a xlink:title="Write ``meta`` to ``path.with_suffix(&#39;.md&#39;)``.">
<polygon fill="none" stroke="black" points="6538.5,-3785.5 6303.5,-3785.5 6303.5,-3749.5 6538.5,-3749.5 6538.5,-3785.5"/>
<text text-anchor="middle" x="6421" y="-3763.46" font-family="Times,serif" font-size="15.68">image_io.write_image_meta</text>
</a>
</g>
</g>
<!-- tg_client._save_media&#45;&gt;image_io.write_image_meta -->
<g id="edge125" class="edge">
<title>tg_client._save_media&#45;&gt;image_io.write_image_meta</title>
<path fill="none" stroke="black" d="M5017.45,-3524.55C5073.4,-3545.26 5154.25,-3573.14 5227,-3590.5 5609.67,-3681.82 6073.27,-3734.44 6292.87,-3755.97"/>
<polygon fill="black" stroke="black" points="6292.84,-3759.49 6303.14,-3756.97 6293.52,-3752.52 6292.84,-3759.49"/>
</g>
<!-- image_io.write_image_meta&#45;&gt;notes_utils.write_md -->
<g id="edge233" class="edge">
<title>image_io.write_image_meta&#45;&gt;notes_utils.write_md</title>
<path fill="none" stroke="black" d="M6538.63,-3780.12C6651.43,-3791.97 6827.26,-3809.46 6980,-3820.5 7124.73,-3830.96 7291.43,-3838.58 7401.74,-3843.01"/>
<polygon fill="black" stroke="black" points="7401.78,-3846.51 7411.91,-3843.41 7402.06,-3839.52 7401.78,-3846.51"/>
</g>
<!-- tg_client._save_bounded -->
<g id="node96" class="node">
<title>tg_client._save_bounded</title>
<g id="a_node96"><a xlink:title="Run ``_save_message`` under the global semaphore and return path.">
<polygon fill="none" stroke="black" points="3414,-4051.5 3009,-4051.5 3009,-4009.5 3414,-4009.5 3414,-4051.5"/>
<text text-anchor="middle" x="3211.5" y="-4022.41" font-family="Times,serif" font-size="31.36">tg_client._save_bounded</text>
</a>
</g>
</g>
<!-- tg_client._save_bounded&#45;&gt;tg_client._save_message -->
<g id="edge126" class="edge">
<title>tg_client._save_bounded&#45;&gt;tg_client._save_message</title>
<path fill="none" stroke="black" d="M3300.09,-4009.45C3418.98,-3980.87 3636.27,-3928.63 3807.63,-3887.44"/>
<polygon fill="black" stroke="black" points="3808.66,-3890.8 3817.56,-3885.06 3807.02,-3883.99 3808.66,-3890.8"/>
</g>
<!-- tg_client._remove_local_message -->
<g id="node97" class="node">
<title>tg_client._remove_local_message</title>
<g id="a_node97"><a xlink:title="Delete ``path`` and related media if the post no longer exists.">
<polygon fill="none" stroke="black" points="7810,-1523.5 7240,-1523.5 7240,-1479.5 7810,-1479.5 7810,-1523.5"/>
<text text-anchor="middle" x="7525" y="-1493.18" font-family="Times,serif" font-size="32.90">tg_client._remove_local_message</text>
</a>
</g>
</g>
<!-- tg_client._remove_local_message&#45;&gt;post_io.read_post -->
<g id="edge129" class="edge">
<title>tg_client._remove_local_message&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7810.12,-1489.98C7954.18,-1484.14 8128.78,-1477.06 8273.45,-1471.2"/>
<polygon fill="black" stroke="black" points="8273.97,-1474.68 8283.82,-1470.78 8273.68,-1467.69 8273.97,-1474.68"/>
</g>
<!-- tg_client._remove_local_message&#45;&gt;caption_io.caption_json_path -->
<g id="edge127" class="edge">
<title>tg_client._remove_local_message&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M7810.14,-1498.37C7894.69,-1502.6 7986.91,-1512.38 8070,-1532.5 8087.02,-1536.62 8089.86,-1541.71 8106,-1548.5 8508.9,-1717.96 8764.74,-1556.7 9020,-1911.5 9062.83,-1971.03 9031.74,-2501.3 9056,-2570.5 9117.65,-2746.38 9274.54,-2914.02 9337.13,-2976.15"/>
<polygon fill="black" stroke="black" points="9334.7,-2978.67 9344.28,-2983.2 9339.62,-2973.68 9334.7,-2978.67"/>
</g>
<!-- tg_client._remove_local_message&#45;&gt;caption_io.caption_md_path -->
<g id="edge128" class="edge">
<title>tg_client._remove_local_message&#45;&gt;caption_io.caption_md_path</title>
<path fill="none" stroke="black" d="M7810.28,-1504.3C8230.12,-1509.58 8971.88,-1523.78 9020,-1558.5 9056.95,-1585.16 9038.45,-1612.45 9056,-1654.5 9161.31,-1906.84 9305.95,-2204.44 9350.14,-2294.42"/>
<polygon fill="black" stroke="black" points="9347.01,-2295.99 9354.57,-2303.41 9353.3,-2292.9 9347.01,-2295.99"/>
</g>
<!-- tg_client._download_messages -->
<g id="node99" class="node">
<title>tg_client._download_messages</title>
<g id="a_node99"><a xlink:title="Save ``messages`` with a progress bar and return count saved.">
<polygon fill="none" stroke="black" points="2961.5,-4193 2251.5,-4193 2251.5,-4136 2961.5,-4136 2961.5,-4193"/>
<text text-anchor="middle" x="2606.5" y="-4153.16" font-family="Times,serif" font-size="44.80">tg_client._download_messages</text>
</a>
</g>
</g>
<!-- tg_client._download_messages&#45;&gt;tg_client._save_bounded -->
<g id="edge130" class="edge">
<title>tg_client._download_messages&#45;&gt;tg_client._save_bounded</title>
<path fill="none" stroke="black" d="M2956.92,-4135.99C2962.4,-4133.02 2967.77,-4129.86 2973,-4126.5 2999.49,-4109.5 2983.1,-4083.4 3009,-4065.5 3013.96,-4062.07 3019.15,-4058.95 3024.51,-4056.09"/>
<polygon fill="black" stroke="black" points="3026.28,-4059.12 3033.69,-4051.55 3023.18,-4052.85 3026.28,-4059.12"/>
</g>
<!-- tg_client.ensure_chat_access -->
<g id="node100" class="node">
<title>tg_client.ensure_chat_access</title>
<g id="a_node100"><a xlink:title="Join chats listed in ``CHATS`` if not already joined.">
<polygon fill="none" stroke="black" points="2777.5,-5486.5 2435.5,-5486.5 2435.5,-5450.5 2777.5,-5450.5 2777.5,-5486.5"/>
<text text-anchor="middle" x="2606.5" y="-5462.8" font-family="Times,serif" font-size="22.12">tg_client.ensure_chat_access</text>
</a>
</g>
</g>
<!-- tg_client.refetch_messages -->
<g id="node101" class="node">
<title>tg_client.refetch_messages</title>
<g id="a_node101"><a xlink:title="Re&#45;fetch posts that failed parsing or are empty.">
<polygon fill="none" stroke="black" points="2973,-4118 2240,-4118 2240,-4053 2973,-4053 2973,-4118"/>
<text text-anchor="middle" x="2606.5" y="-4072.45" font-family="Times,serif" font-size="51.94">tg_client.refetch_messages</text>
</a>
</g>
</g>
<!-- tg_client.refetch_messages&#45;&gt;post_io.read_post -->
<g id="edge136" class="edge">
<title>tg_client.refetch_messages&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M2608.5,-4052.76C2619.86,-3740.49 2750.5,-1299.5 4057,-1299.5 4057,-1299.5 4057,-1299.5 6422,-1299.5 6513.56,-1299.5 7995.23,-1260.65 8070,-1313.5 8108.23,-1340.52 8069.08,-1383.71 8106,-1412.5 8153.78,-1449.76 8213.47,-1469.02 8273.77,-1477.68"/>
<polygon fill="black" stroke="black" points="8273.47,-1481.17 8283.84,-1479.03 8274.4,-1474.24 8273.47,-1481.17"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;post_io.raw_post_path -->
<g id="edge137" class="edge">
<title>tg_client.refetch_messages&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M2973.15,-4117.22C2985.24,-4118.02 2997.22,-4118.79 3009,-4119.5 4133.96,-4187.36 4416.49,-4199.5 5543.5,-4199.5 5543.5,-4199.5 5543.5,-4199.5 6422,-4199.5 6513.57,-4199.5 7996.02,-4225.46 8070,-4171.5 8110.2,-4142.18 8066.3,-4095.49 8106,-4065.5 8215.77,-3982.59 8386.26,-4001.52 8484.71,-4022.32"/>
<polygon fill="black" stroke="black" points="8484.08,-4025.76 8494.59,-4024.46 8485.56,-4018.92 8484.08,-4025.76"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;notes_utils.load_json -->
<g id="edge131" class="edge">
<title>tg_client.refetch_messages&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M2943.15,-4118.11C2953.26,-4120.7 2963.24,-4123.49 2973,-4126.5 2990.29,-4131.82 2992.1,-4139.03 3009,-4145.5 3958.11,-4508.85 4225.72,-4527.57 5227,-4701.5 6474.22,-4918.15 6804.15,-4884.49 8070,-4874.5 8122.78,-4874.08 8981.07,-4895.14 9020,-4859.5 9076.86,-4807.45 9035.53,-4588.81 9056,-4514.5 9128.11,-4252.75 9294.13,-3965.27 9347,-3877.44"/>
<polygon fill="black" stroke="black" points="9350.14,-3879.01 9352.32,-3868.65 9344.15,-3875.39 9350.14,-3879.01"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;notes_utils.write_json -->
<g id="edge132" class="edge">
<title>tg_client.refetch_messages&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M2627.36,-4052.76C2741.12,-3869.73 3330.63,-2981.5 4057,-2981.5 4057,-2981.5 4057,-2981.5 6422,-2981.5 6605.12,-2981.5 7893.51,-3010.36 8070,-2961.5 8087.85,-2956.56 8088.25,-2945.78 8106,-2940.5 8223.1,-2905.65 8364.5,-2904.43 8458.48,-2908.97"/>
<polygon fill="black" stroke="black" points="8458.4,-2912.47 8468.56,-2909.49 8458.76,-2905.48 8458.4,-2912.47"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;tg_client._get_message_path -->
<g id="edge133" class="edge">
<title>tg_client.refetch_messages&#45;&gt;tg_client._get_message_path</title>
<path fill="none" stroke="black" d="M2973.04,-4089.74C3011.6,-4090.19 3048.68,-4090.62 3081.62,-4091"/>
<polygon fill="black" stroke="black" points="3081.67,-4094.5 3091.71,-4091.12 3081.75,-4087.51 3081.67,-4094.5"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;tg_client._save_bounded -->
<g id="edge134" class="edge">
<title>tg_client.refetch_messages&#45;&gt;tg_client._save_bounded</title>
<path fill="none" stroke="black" d="M2963.93,-4052.99C2975.65,-4051.92 2987.25,-4050.86 2998.67,-4049.82"/>
<polygon fill="black" stroke="black" points="2999.01,-4053.3 3008.65,-4048.91 2998.37,-4046.33 2999.01,-4053.3"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;tg_client._remove_local_message -->
<g id="edge135" class="edge">
<title>tg_client.refetch_messages&#45;&gt;tg_client._remove_local_message</title>
<path fill="none" stroke="black" d="M2611.32,-4052.87C2629.58,-3909.35 2719.49,-3325.51 3009,-2967.5 3565.89,-2278.85 3911.69,-2316.22 4702,-1916.5 5212.97,-1658.07 5335.75,-1545.9 5898,-1437.5 6354.48,-1349.49 6479.81,-1411.97 6944,-1437.5 7083.69,-1445.18 7241.45,-1463.2 7357.14,-1478.17"/>
<polygon fill="black" stroke="black" points="7356.78,-1481.65 7367.15,-1479.47 7357.68,-1474.71 7356.78,-1481.65"/>
</g>
<!-- tg_client.fetch_missing -->
<g id="node102" class="node">
<title>tg_client.fetch_missing</title>
<g id="a_node102"><a xlink:title="Pull new messages and back&#45;fill history until fully synced.">
<polygon fill="none" stroke="black" points="1732,-4342.5 1019,-4342.5 1019,-4268.5 1732,-4268.5 1732,-4342.5"/>
<text text-anchor="middle" x="1375.5" y="-4290.68" font-family="Times,serif" font-size="59.78">tg_client.fetch_missing</text>
</a>
</g>
</g>
<!-- tg_client.fetch_missing&#45;&gt;post_io.raw_post_path -->
<g id="edge144" class="edge">
<title>tg_client.fetch_missing&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M1732.33,-4285.14C1977.64,-4272.83 2311.25,-4259.5 2605.5,-4259.5 2605.5,-4259.5 2605.5,-4259.5 3212.5,-4259.5 3279.97,-4259.5 8016.85,-4245.06 8070,-4203.5 8119.94,-4164.46 8056.83,-4105.5 8106,-4065.5 8214.34,-3977.35 8389.56,-3999.65 8488.28,-4022.11"/>
<polygon fill="black" stroke="black" points="8487.64,-4025.56 8498.17,-4024.43 8489.23,-4018.74 8487.64,-4025.56"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client._get_id_date -->
<g id="edge138" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client._get_id_date</title>
<path fill="none" stroke="black" d="M1719.41,-4342.66C1723.7,-4345.46 1727.9,-4348.4 1732,-4351.5 1764.4,-4375.99 1741.81,-4404.45 1768,-4435.5 2053.85,-4774.42 2162.13,-4977.5 2605.5,-4977.5 2605.5,-4977.5 2605.5,-4977.5 5545.5,-4977.5 6207.66,-4977.5 6994.15,-5003 7342.49,-5015.61"/>
<polygon fill="black" stroke="black" points="7342.55,-5019.12 7352.67,-5015.98 7342.81,-5012.12 7342.55,-5019.12"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client._load_progress -->
<g id="edge139" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client._load_progress</title>
<path fill="none" stroke="black" d="M1723.14,-4342.66C1726.18,-4345.48 1729.14,-4348.42 1732,-4351.5 1780.5,-4403.65 1741.48,-4925.4 1768,-4991.5 1808,-5091.18 1903.69,-5179.56 1953.56,-5220.83"/>
<polygon fill="black" stroke="black" points="1951.49,-5223.66 1961.44,-5227.28 1955.92,-5218.24 1951.49,-5223.66"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client._save_progress -->
<g id="edge140" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client._save_progress</title>
<path fill="none" stroke="black" d="M1732.39,-4305.5C1984.51,-4305.5 2307.68,-4305.5 2481.52,-4305.5"/>
<polygon fill="black" stroke="black" points="2481.73,-4309 2491.73,-4305.5 2481.73,-4302 2481.73,-4309"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client.get_first_id -->
<g id="edge141" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client.get_first_id</title>
<path fill="none" stroke="black" d="M1708.19,-4342.61C1716.27,-4345.38 1724.22,-4348.34 1732,-4351.5 1750.53,-4359.03 1749.07,-4372.05 1768,-4378.5 2245.96,-4541.32 2865.73,-4459.48 3107.53,-4417.35"/>
<polygon fill="black" stroke="black" points="3108.47,-4420.73 3117.72,-4415.56 3107.26,-4413.84 3108.47,-4420.73"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client.get_last_id -->
<g id="edge142" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client.get_last_id</title>
<path fill="none" stroke="black" d="M1732.23,-4332.39C1772,-4335.4 1810.55,-4338.31 1845.08,-4340.92"/>
<polygon fill="black" stroke="black" points="1844.95,-4344.42 1855.18,-4341.69 1845.48,-4337.44 1844.95,-4344.42"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client._download_messages -->
<g id="edge143" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client._download_messages</title>
<path fill="none" stroke="black" d="M1603.66,-4268.5C1657.46,-4260.34 1714.69,-4252.16 1768,-4245.5 1927.85,-4225.54 2105.39,-4207.74 2255.73,-4193.95"/>
<polygon fill="black" stroke="black" points="2256.4,-4197.4 2266.04,-4193.01 2255.77,-4190.43 2256.4,-4197.4"/>
</g>
<!-- tg_client.remove_deleted -->
<g id="node103" class="node">
<title>tg_client.remove_deleted</title>
<g id="a_node103"><a xlink:title="Delete locally stored messages removed from Telegram recently.">
<polygon fill="none" stroke="black" points="7841.5,-1941 7208.5,-1941 7208.5,-1880 7841.5,-1880 7841.5,-1941"/>
<text text-anchor="middle" x="7525" y="-1898.25" font-family="Times,serif" font-size="48.44">tg_client.remove_deleted</text>
</a>
</g>
</g>
<!-- tg_client.remove_deleted&#45;&gt;post_io.read_post -->
<g id="edge147" class="edge">
<title>tg_client.remove_deleted&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7841.76,-1920.3C7918.58,-1913.81 7999.01,-1899.24 8070,-1870.5 8270.54,-1789.32 8450.2,-1594.46 8525.07,-1505.36"/>
<polygon fill="black" stroke="black" points="8527.83,-1507.51 8531.56,-1497.59 8522.46,-1503.02 8527.83,-1507.51"/>
</g>
<!-- tg_client.remove_deleted&#45;&gt;post_io.raw_post_path -->
<g id="edge148" class="edge">
<title>tg_client.remove_deleted&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7841.82,-1908.34C7928.39,-1924.25 8013.79,-1958.49 8070,-2026.5 8131.6,-2101.03 8057.66,-3682.77 8106,-3766.5 8188.67,-3909.69 8378.07,-3987.45 8484.95,-4021.36"/>
<polygon fill="black" stroke="black" points="8484.12,-4024.77 8494.71,-4024.41 8486.21,-4018.09 8484.12,-4024.77"/>
</g>
<!-- tg_client.remove_deleted&#45;&gt;caption_io.caption_json_path -->
<g id="edge145" class="edge">
<title>tg_client.remove_deleted&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M7841.59,-1911.86C8267.59,-1915.24 8978.58,-1926.96 9020,-1967.5 9067.97,-2014.45 9033.64,-2507.22 9056,-2570.5 9118.09,-2746.22 9274.72,-2913.96 9337.19,-2976.13"/>
<polygon fill="black" stroke="black" points="9334.75,-2978.64 9344.33,-2983.18 9339.67,-2973.66 9334.75,-2978.64"/>
</g>
<!-- tg_client.remove_deleted&#45;&gt;caption_io.caption_md_path -->
<g id="edge146" class="edge">
<title>tg_client.remove_deleted&#45;&gt;caption_io.caption_md_path</title>
<path fill="none" stroke="black" d="M7841.61,-1886.23C8216.93,-1862.42 8818,-1841.74 9020,-1934.5 9189.94,-2012.53 9310.62,-2219.53 9349.8,-2294.18"/>
<polygon fill="black" stroke="black" points="9346.87,-2296.14 9354.58,-2303.41 9353.09,-2292.92 9346.87,-2296.14"/>
</g>
<!-- tg_client.main -->
<g id="node104" class="node">
<title>tg_client.main</title>
<g id="a_node104"><a xlink:title="Synchronize configured chats and optional live updates.">
<polygon fill="none" stroke="black" points="934.5,-4224.5 366.5,-4224.5 366.5,-4132.5 934.5,-4132.5 934.5,-4224.5"/>
<text text-anchor="middle" x="650.5" y="-4159.46" font-family="Times,serif" font-size="76.30">tg_client.main</text>
</a>
</g>
</g>
<!-- tg_client.main&#45;&gt;tg_client._mark_activity -->
<g id="edge149" class="edge">
<title>tg_client.main&#45;&gt;tg_client._mark_activity</title>
<path fill="none" stroke="black" d="M934.64,-4192.92C1204.52,-4205.42 1622.35,-4221.5 1985,-4221.5 1985,-4221.5 1985,-4221.5 2607.5,-4221.5 3472.44,-4221.5 4516.6,-4174.43 4842.98,-4158.61"/>
<polygon fill="black" stroke="black" points="4843.54,-4162.09 4853.35,-4158.11 4843.2,-4155.1 4843.54,-4162.09"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client._heartbeat -->
<g id="edge150" class="edge">
<title>tg_client.main&#45;&gt;tg_client._heartbeat</title>
<path fill="none" stroke="black" d="M727.92,-4224.62C800.16,-4265.71 912.97,-4323.53 1019,-4351.5 1094.16,-4371.32 1181.12,-4378.2 1250.22,-4380.05"/>
<polygon fill="black" stroke="black" points="1250.2,-4383.55 1260.28,-4380.29 1250.37,-4376.55 1250.2,-4383.55"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client._flush_chop_queue -->
<g id="edge151" class="edge">
<title>tg_client.main&#45;&gt;tg_client._flush_chop_queue</title>
<path fill="none" stroke="black" d="M711.82,-4132.27C943.17,-3954.96 1769.77,-3321.45 1950.1,-3183.25"/>
<polygon fill="black" stroke="black" points="1952.38,-3185.91 1958.19,-3177.05 1948.12,-3180.35 1952.38,-3185.91"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client._save_bounded -->
<g id="edge152" class="edge">
<title>tg_client.main&#45;&gt;tg_client._save_bounded</title>
<path fill="none" stroke="black" d="M934.61,-4134.59C963.08,-4130.87 991.59,-4127.42 1019,-4124.5 1559.8,-4066.92 1696.57,-4065.15 2240,-4043.5 2501.07,-4033.1 2801.91,-4030.53 2998.58,-4030.12"/>
<polygon fill="black" stroke="black" points="2998.75,-4033.62 3008.74,-4030.1 2998.74,-4026.62 2998.75,-4033.62"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client.ensure_chat_access -->
<g id="edge153" class="edge">
<title>tg_client.main&#45;&gt;tg_client.ensure_chat_access</title>
<path fill="none" stroke="black" d="M686.05,-4224.76C812.21,-4390.6 1266.87,-4961.92 1768,-5272.5 1956.77,-5389.49 2022.84,-5390.02 2240,-5436.5 2299.62,-5449.26 2365.75,-5456.95 2425.18,-5461.58"/>
<polygon fill="black" stroke="black" points="2425.2,-5465.09 2435.43,-5462.36 2425.72,-5458.11 2425.2,-5465.09"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client.refetch_messages -->
<g id="edge154" class="edge">
<title>tg_client.main&#45;&gt;tg_client.refetch_messages</title>
<path fill="none" stroke="black" d="M934.58,-4165.03C1276.09,-4148.77 1851.4,-4121.39 2229.8,-4103.38"/>
<polygon fill="black" stroke="black" points="2229.99,-4106.88 2239.81,-4102.9 2229.66,-4099.88 2229.99,-4106.88"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client.fetch_missing -->
<g id="edge155" class="edge">
<title>tg_client.main&#45;&gt;tg_client.fetch_missing</title>
<path fill="none" stroke="black" d="M913.54,-4224.53C992.25,-4238.35 1077.77,-4253.38 1153.54,-4266.69"/>
<polygon fill="black" stroke="black" points="1153.23,-4270.19 1163.69,-4268.47 1154.44,-4263.29 1153.23,-4270.19"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client.remove_deleted -->
<g id="edge156" class="edge">
<title>tg_client.main&#45;&gt;tg_client.remove_deleted</title>
<path fill="none" stroke="black" d="M651.85,-4132.31C657.21,-3773.96 739.94,-1451.5 1985,-1451.5 1985,-1451.5 1985,-1451.5 5545.5,-1451.5 5860.93,-1451.5 6717.66,-1474.79 6944,-1694.5 7001.29,-1750.11 6920.04,-1817.78 6980,-1870.5 7014.86,-1901.15 7102.79,-1914.19 7198.04,-1918.62"/>
<polygon fill="black" stroke="black" points="7198.04,-1922.12 7208.18,-1919.05 7198.34,-1915.12 7198.04,-1922.12"/>
</g>
<!-- caption_io._get_langs&#45;&gt;config_utils.load_config -->
<g id="edge157" class="edge">
<title>caption_io._get_langs&#45;&gt;config_utils.load_config</title>
<path fill="none" stroke="black" d="M9424.29,-2525.47C9497.45,-2499.52 9619.31,-2443.96 9673,-2348.5 9724.4,-2257.11 9638.82,-539.4 9709,-461.5 9720.8,-448.4 9734.94,-438.45 9750.46,-431"/>
<polygon fill="black" stroke="black" points="9752.01,-434.14 9759.75,-426.91 9749.18,-427.74 9752.01,-434.14"/>
</g>
<!-- caption_io.write_caption -->
<g id="node106" class="node">
<title>caption_io.write_caption</title>
<g id="a_node106"><a xlink:title="Write ``text`` as ``lang`` caption for ``image``.">
<polygon fill="none" stroke="black" points="7691.5,-3045.5 7358.5,-3045.5 7358.5,-3009.5 7691.5,-3009.5 7691.5,-3045.5"/>
<text text-anchor="middle" x="7525" y="-3021.34" font-family="Times,serif" font-size="25.20">caption_io.write_caption</text>
</a>
</g>
</g>
<!-- caption_io.write_caption&#45;&gt;notes_utils.load_json -->
<g id="edge165" class="edge">
<title>caption_io.write_caption&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M7623.87,-3009.49C7737.23,-2993.47 7926.74,-2981.96 8070,-3050.5 8091.88,-3060.97 8084.15,-3080.98 8106,-3091.5 8289.21,-3179.69 8850.5,-3022.18 9020,-3134.5 9273.03,-3302.18 9344.9,-3711.03 9360.07,-3822.2"/>
<polygon fill="black" stroke="black" points="9356.62,-3822.84 9361.4,-3832.3 9363.56,-3821.92 9356.62,-3822.84"/>
</g>
<!-- caption_io.write_caption&#45;&gt;notes_utils.write_json -->
<g id="edge166" class="edge">
<title>caption_io.write_caption&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M7629.37,-3045.51C7744.02,-3060.24 7931.11,-3068.3 8070,-2995.5 8092.99,-2983.45 8083.07,-2961.68 8106,-2949.5 8215.65,-2891.24 8361.61,-2892.24 8458.53,-2901.83"/>
<polygon fill="black" stroke="black" points="8458.32,-2905.32 8468.63,-2902.87 8459.04,-2898.36 8458.32,-2905.32"/>
</g>
<!-- caption_io.write_caption&#45;&gt;caption_io.caption_json_path -->
<g id="edge168" class="edge">
<title>caption_io.write_caption&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M7691.9,-3025.15C8062.99,-3019.9 8951.47,-3007.33 9257.66,-3003"/>
<polygon fill="black" stroke="black" points="9257.92,-3006.49 9267.87,-3002.85 9257.82,-2999.5 9257.92,-3006.49"/>
</g>
<!-- caption_io.write_caption&#45;&gt;caption_io._get_langs -->
<g id="edge167" class="edge">
<title>caption_io.write_caption&#45;&gt;caption_io._get_langs</title>
<path fill="none" stroke="black" d="M7691.68,-3020C8074.57,-3002.44 8990.55,-2959.05 9020,-2944.5 9191.46,-2859.77 9311.59,-2646.81 9350.18,-2570.9"/>
<polygon fill="black" stroke="black" points="9353.53,-2572.04 9354.88,-2561.53 9347.27,-2568.9 9353.53,-2572.04"/>
</g>
<!-- testing_mode.apply_testing_mode -->
<g id="node107" class="node">
<title>testing_mode.apply_testing_mode</title>
<g id="a_node107"><a xlink:title="Tweak environment variables when ``TEST_MODE`` is set.">
<polygon fill="none" stroke="black" points="282,-5540.5 0,-5540.5 0,-5504.5 282,-5504.5 282,-5540.5"/>
<text text-anchor="middle" x="141" y="-5518.46" font-family="Times,serif" font-size="15.68">testing_mode.apply_testing_mode</text>
</a>
</g>
</g>
<!-- price_train:cli -->
<g id="node108" class="node">
<title>price_train:cli</title>
<g id="a_node108"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="650.5" cy="-5522.5" rx="36.68" ry="18"/>
<text text-anchor="middle" x="650.5" y="-5520.9" font-family="Times,serif" font-size="7.00">price_train:cli</text>
</a>
</g>
</g>
<!-- testing_mode.apply_testing_mode&#45;&gt;price_train:cli -->
<!-- similar:cli -->
<g id="node178" class="node">
<title>similar:cli</title>
<g id="a_node178"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="1375.5" cy="-5522.5" rx="29.05" ry="18"/>
<text text-anchor="middle" x="1375.5" y="-5520.9" font-family="Times,serif" font-size="7.00">similar:cli</text>
</a>
</g>
</g>
<!-- price_train:cli&#45;&gt;similar:cli -->
<!-- price_utils.guess_currency -->
<g id="node111" class="node">
<title>price_utils.guess_currency</title>
<g id="a_node111"><a xlink:title="Return currency with multiplier closest to ``price/pred_usd``.&#10;&#10;``pred_usd`` is the predicted price in USD. &#160;``price`` is the numeric value&#10;provided by the user without a currency. &#160;The function compares the implied&#10;multiplier ``price / pred_usd`` against the learnt exchange rates and picks&#10;the closest match. &#160;``counts`` may be provided to ignore rarely seen&#10;currencies when guessing. &#160;Any currency with fewer than ``min_samples``&#10;samples in the training set is skipped.">
<polygon fill="none" stroke="black" points="10244,-96.5 9709,-96.5 9709,-46.5 10244,-46.5 10244,-96.5"/>
<text text-anchor="middle" x="9976.5" y="-61.81" font-family="Times,serif" font-size="38.36">price_utils.guess_currency</text>
</a>
</g>
</g>
<!-- price_utils._guess_currency_verified&#45;&gt;price_utils.guess_currency -->
<g id="edge173" class="edge">
<title>price_utils._guess_currency_verified&#45;&gt;price_utils.guess_currency</title>
<path fill="none" stroke="black" d="M9621.1,-71.5C9646.74,-71.5 9672.85,-71.5 9698.69,-71.5"/>
<polygon fill="black" stroke="black" points="9698.96,-75 9708.96,-71.5 9698.96,-68 9698.96,-75"/>
</g>
<!-- telegram_bot._t -->
<g id="node113" class="node">
<title>telegram_bot._t</title>
<g id="a_node113"><a xlink:title="Return ``text`` translated to ``lang`` using gettext files.">
<polygon fill="none" stroke="black" points="5648.5,-5582.5 5440.5,-5582.5 5440.5,-5546.5 5648.5,-5546.5 5648.5,-5582.5"/>
<text text-anchor="middle" x="5544.5" y="-5558.62" font-family="Times,serif" font-size="24.22">telegram_bot._t</text>
</a>
</g>
</g>
<!-- telegram_bot.ensure_profile -->
<g id="node114" class="node">
<title>telegram_bot.ensure_profile</title>
<g id="a_node114"><a xlink:title="Return profile for ``uid`` creating one if needed.">
<polygon fill="none" stroke="black" points="5695.5,-5636.5 5393.5,-5636.5 5393.5,-5600.5 5695.5,-5600.5 5695.5,-5636.5"/>
<text text-anchor="middle" x="5544.5" y="-5613.71" font-family="Times,serif" font-size="19.74">telegram_bot.ensure_profile</text>
</a>
</g>
</g>
<!-- telegram_bot.save_profiles -->
<g id="node115" class="node">
<title>telegram_bot.save_profiles</title>
<g id="a_node115"><a xlink:title="Write ``profiles`` to disk.">
<polygon fill="none" stroke="black" points="6525,-5536.5 6317,-5536.5 6317,-5500.5 6525,-5500.5 6525,-5536.5"/>
<text text-anchor="middle" x="6421" y="-5514.8" font-family="Times,serif" font-size="14.00">telegram_bot.save_profiles</text>
</a>
</g>
</g>
<!-- telegram_bot.ensure_profile&#45;&gt;telegram_bot.save_profiles -->
<g id="edge179" class="edge">
<title>telegram_bot.ensure_profile&#45;&gt;telegram_bot.save_profiles</title>
<path fill="none" stroke="black" d="M5695.76,-5607.07C5748.39,-5602.7 5807.86,-5597.35 5862,-5591.5 6016.4,-5574.82 6194.19,-5550.71 6306.79,-5534.83"/>
<polygon fill="black" stroke="black" points="6307.4,-5538.28 6316.81,-5533.41 6306.42,-5531.35 6307.4,-5538.28"/>
</g>
<!-- telegram_bot.load_profiles -->
<g id="node116" class="node">
<title>telegram_bot.load_profiles</title>
<g id="a_node116"><a xlink:title="Populate the global ``profiles`` mapping.">
<polygon fill="none" stroke="black" points="5695.5,-5394.5 5393.5,-5394.5 5393.5,-5358.5 5695.5,-5358.5 5695.5,-5394.5"/>
<text text-anchor="middle" x="5544.5" y="-5371.2" font-family="Times,serif" font-size="21.00">telegram_bot.load_profiles</text>
</a>
</g>
</g>
<!-- telegram_bot.load_profiles&#45;&gt;notes_utils.read_text -->
<g id="edge180" class="edge">
<title>telegram_bot.load_profiles&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M5695.86,-5380.84C6275.49,-5396.69 8365.11,-5445.41 9020,-5344.5 9036.54,-5341.95 9039.55,-5336.53 9056,-5333.5 9191.15,-5308.59 9554.18,-5360.56 9673,-5291.5 9846.29,-5190.78 9939.41,-4946.36 9966.8,-4863.51"/>
<polygon fill="black" stroke="black" points="9970.2,-4864.38 9969.96,-4853.79 9963.54,-4862.22 9970.2,-4864.38"/>
</g>
<!-- telegram_bot.load_state -->
<g id="node117" class="node">
<title>telegram_bot.load_state</title>
<g id="a_node117"><a xlink:title="Populate ``processed_ids`` from ``STATE_PATH``.">
<polygon fill="none" stroke="black" points="9508,-5282.5 9221,-5282.5 9221,-5246.5 9508,-5246.5 9508,-5282.5"/>
<text text-anchor="middle" x="9364.5" y="-5258.8" font-family="Times,serif" font-size="22.12">telegram_bot.load_state</text>
</a>
</g>
</g>
<!-- telegram_bot.load_state&#45;&gt;notes_utils.read_text -->
<g id="edge181" class="edge">
<title>telegram_bot.load_state&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M9508.22,-5270.8C9562.77,-5267.49 9623.67,-5256.46 9673,-5228.5 9828.24,-5140.51 9930.39,-4937.41 9963.66,-4863.25"/>
<polygon fill="black" stroke="black" points="9967.05,-4864.23 9967.89,-4853.67 9960.65,-4861.4 9967.05,-4864.23"/>
</g>
<!-- telegram_bot.save_state -->
<g id="node118" class="node">
<title>telegram_bot.save_state</title>
<polygon fill="none" stroke="black" points="6505,-4559.5 6337,-4559.5 6337,-4523.5 6505,-4523.5 6505,-4559.5"/>
<text text-anchor="middle" x="6421" y="-4538.26" font-family="Times,serif" font-size="12.18">telegram_bot.save_state</text>
</g>
<!-- telegram_bot.scan_embeddings -->
<g id="node119" class="node">
<title>telegram_bot.scan_embeddings</title>
<g id="a_node119"><a xlink:title="Load new embeddings and return list of new lot ids.">
<polygon fill="none" stroke="black" points="7671,-4481.5 7379,-4481.5 7379,-4445.5 7671,-4445.5 7671,-4481.5"/>
<text text-anchor="middle" x="7525" y="-4459.34" font-family="Times,serif" font-size="17.08">telegram_bot.scan_embeddings</text>
</a>
</g>
</g>
<!-- telegram_bot.scan_embeddings&#45;&gt;similar_utils._load_embeddings -->
<g id="edge182" class="edge">
<title>telegram_bot.scan_embeddings&#45;&gt;similar_utils._load_embeddings</title>
<path fill="none" stroke="black" d="M7671.18,-4455.04C7780.77,-4448.64 7934.83,-4439.6 8070,-4431.5 8143.53,-4427.1 8223.23,-4422.26 8296.65,-4417.78"/>
<polygon fill="black" stroke="black" points="8297.2,-4421.26 8306.97,-4417.16 8296.77,-4414.27 8297.2,-4421.26"/>
</g>
<!-- telegram_bot._should_suggest -->
<g id="node120" class="node">
<title>telegram_bot._should_suggest</title>
<polygon fill="none" stroke="black" points="9526,-5487.5 9203,-5487.5 9203,-5451.5 9526,-5451.5 9526,-5487.5"/>
<text text-anchor="middle" x="9364.5" y="-5464.71" font-family="Times,serif" font-size="19.74">telegram_bot._should_suggest</text>
</g>
<!-- telegram_bot._should_suggest&#45;&gt;similar_utils._cos_sim -->
<g id="edge183" class="edge">
<title>telegram_bot._should_suggest&#45;&gt;similar_utils._cos_sim</title>
<path fill="none" stroke="black" d="M9526.17,-5456.07C9627.32,-5447.61 9756,-5436.85 9849.7,-5429.02"/>
<polygon fill="black" stroke="black" points="9850.13,-5432.49 9859.8,-5428.17 9849.55,-5425.52 9850.13,-5432.49"/>
</g>
<!-- telegram_bot.enqueue_new_ids -->
<g id="node122" class="node">
<title>telegram_bot.enqueue_new_ids</title>
<polygon fill="none" stroke="black" points="5783,-5490.5 5306,-5490.5 5306,-5450.5 5783,-5450.5 5783,-5490.5"/>
<text text-anchor="middle" x="5544.5" y="-5463.43" font-family="Times,serif" font-size="28.84">telegram_bot.enqueue_new_ids</text>
</g>
<!-- telegram_bot.enqueue_new_ids&#45;&gt;telegram_bot.save_profiles -->
<g id="edge184" class="edge">
<title>telegram_bot.enqueue_new_ids&#45;&gt;telegram_bot.save_profiles</title>
<path fill="none" stroke="black" d="M5783.02,-5483.54C5953.21,-5492.88 6174.82,-5505.04 6306.76,-5512.28"/>
<polygon fill="black" stroke="black" points="6306.71,-5515.79 6316.88,-5512.84 6307.09,-5508.8 6306.71,-5515.79"/>
</g>
<!-- telegram_bot.enqueue_new_ids&#45;&gt;telegram_bot._should_suggest -->
<g id="edge185" class="edge">
<title>telegram_bot.enqueue_new_ids&#45;&gt;telegram_bot._should_suggest</title>
<path fill="none" stroke="black" d="M5783.25,-5470.44C6492.17,-5470.25 8580.1,-5469.71 9192.7,-5469.54"/>
<polygon fill="black" stroke="black" points="9192.93,-5473.04 9202.93,-5469.54 9192.93,-5466.04 9192.93,-5473.04"/>
</g>
<!-- telegram_bot._send_queue -->
<g id="node123" class="node">
<title>telegram_bot._send_queue</title>
<g id="a_node123"><a xlink:title="Send next lot from each user queue via ``app``.">
<polygon fill="none" stroke="black" points="5820,-5302.5 5269,-5302.5 5269,-5250.5 5820,-5250.5 5820,-5302.5"/>
<text text-anchor="middle" x="5544.5" y="-5266.8" font-family="Times,serif" font-size="39.62">telegram_bot._send_queue</text>
</a>
</g>
</g>
<!-- telegram_bot._send_queue&#45;&gt;telegram_bot.save_profiles -->
<g id="edge186" class="edge">
<title>telegram_bot._send_queue&#45;&gt;telegram_bot.save_profiles</title>
<path fill="none" stroke="black" d="M5666.96,-5302.5C5726.05,-5315.66 5797.97,-5332.44 5862,-5349.5 6042.03,-5397.47 6251.64,-5463.82 6355.22,-5497.33"/>
<polygon fill="black" stroke="black" points="6354.32,-5500.71 6364.91,-5500.47 6356.48,-5494.05 6354.32,-5500.71"/>
</g>
<!-- lot_io.get_lot -->
<g id="node124" class="node">
<title>lot_io.get_lot</title>
<g id="a_node124"><a xlink:title="Return the lot identified by ``lot_id`` or ``None`` when missing.">
<polygon fill="none" stroke="black" points="7597.5,-4535.5 7452.5,-4535.5 7452.5,-4499.5 7597.5,-4499.5 7597.5,-4535.5"/>
<text text-anchor="middle" x="7525" y="-4512.71" font-family="Times,serif" font-size="19.74">lot_io.get_lot</text>
</a>
</g>
</g>
<!-- telegram_bot._send_queue&#45;&gt;lot_io.get_lot -->
<g id="edge187" class="edge">
<title>telegram_bot._send_queue&#45;&gt;lot_io.get_lot</title>
<path fill="none" stroke="black" d="M5649.46,-5250.38C5721.8,-5226.4 5813.64,-5183.1 5862,-5109.5 5918.91,-5022.88 5823.4,-4716.45 5898,-4644.5 5981.73,-4563.75 6843.3,-4659.73 6944,-4601.5 6969.94,-4586.5 6954.13,-4559.61 6980,-4544.5 7056.15,-4500.03 7310.11,-4506.03 7442.36,-4512.56"/>
<polygon fill="black" stroke="black" points="7442.27,-4516.06 7452.44,-4513.07 7442.63,-4509.07 7442.27,-4516.06"/>
</g>
<!-- lot_io.get_lot&#45;&gt;lot_io.read_lots -->
<g id="edge279" class="edge">
<title>lot_io.get_lot&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M7597.61,-4525.37C7730.3,-4538.18 8006.66,-4556.02 8070,-4490.5 8158.05,-4399.42 8031.92,-2313.27 8106,-2210.5 8183.47,-2103.03 8338.86,-2067.26 8446.57,-2055.63"/>
<polygon fill="black" stroke="black" points="8447.25,-2059.08 8456.85,-2054.58 8446.54,-2052.12 8447.25,-2059.08"/>
</g>
<!-- lot_io.parse_lot_id -->
<g id="node165" class="node">
<title>lot_io.parse_lot_id</title>
<g id="a_node165"><a xlink:title="Return ``(relative_path, index)`` extracted from ``lot_id``.">
<polygon fill="none" stroke="black" points="9489.5,-4559.5 9239.5,-4559.5 9239.5,-4523.5 9489.5,-4523.5 9489.5,-4559.5"/>
<text text-anchor="middle" x="9364.5" y="-4535.34" font-family="Times,serif" font-size="25.20">lot_io.parse_lot_id</text>
</a>
</g>
</g>
<!-- lot_io.get_lot&#45;&gt;lot_io.parse_lot_id -->
<g id="edge280" class="edge">
<title>lot_io.get_lot&#45;&gt;lot_io.parse_lot_id</title>
<path fill="none" stroke="black" d="M7597.75,-4518.44C7873.27,-4522.04 8866.09,-4535 9229.24,-4539.75"/>
<polygon fill="black" stroke="black" points="9229.23,-4543.25 9239.27,-4539.88 9229.32,-4536.25 9229.23,-4543.25"/>
</g>
<!-- telegram_bot.send_alert -->
<g id="node125" class="node">
<title>telegram_bot.send_alert</title>
<g id="a_node125"><a xlink:title="Broadcast ``text`` to all registered users.">
<polygon fill="none" stroke="black" points="5111.5,-5394.5 4781.5,-5394.5 4781.5,-5358.5 5111.5,-5358.5 5111.5,-5394.5"/>
<text text-anchor="middle" x="4946.5" y="-5370.34" font-family="Times,serif" font-size="25.20">telegram_bot.send_alert</text>
</a>
</g>
</g>
<!-- telegram_bot.send_alert&#45;&gt;telegram_bot.load_profiles -->
<g id="edge188" class="edge">
<title>telegram_bot.send_alert&#45;&gt;telegram_bot.load_profiles</title>
<path fill="none" stroke="black" d="M5111.54,-5376.5C5196.23,-5376.5 5299.14,-5376.5 5383.27,-5376.5"/>
<polygon fill="black" stroke="black" points="5383.43,-5380 5393.43,-5376.5 5383.43,-5373 5383.43,-5380"/>
</g>
<!-- telegram_bot.start_cmd -->
<g id="node126" class="node">
<title>telegram_bot.start_cmd</title>
<g id="a_node126"><a xlink:title="Register the user and confirm startup.">
<polygon fill="none" stroke="black" points="5058.5,-5609.5 4834.5,-5609.5 4834.5,-5573.5 5058.5,-5573.5 5058.5,-5609.5"/>
<text text-anchor="middle" x="4946.5" y="-5587.34" font-family="Times,serif" font-size="17.08">telegram_bot.start_cmd</text>
</a>
</g>
</g>
<!-- telegram_bot.start_cmd&#45;&gt;telegram_bot._t -->
<g id="edge189" class="edge">
<title>telegram_bot.start_cmd&#45;&gt;telegram_bot._t</title>
<path fill="none" stroke="black" d="M5058.55,-5586.47C5164.59,-5581.67 5323.59,-5574.46 5430.32,-5569.63"/>
<polygon fill="black" stroke="black" points="5430.66,-5573.12 5440.49,-5569.17 5430.34,-5566.12 5430.66,-5573.12"/>
</g>
<!-- telegram_bot.start_cmd&#45;&gt;telegram_bot.ensure_profile -->
<g id="edge190" class="edge">
<title>telegram_bot.start_cmd&#45;&gt;telegram_bot.ensure_profile</title>
<path fill="none" stroke="black" d="M5058.55,-5596.53C5149.9,-5600.67 5280.55,-5606.59 5383.23,-5611.24"/>
<polygon fill="black" stroke="black" points="5383.24,-5614.74 5393.39,-5611.7 5383.56,-5607.75 5383.24,-5614.74"/>
</g>
<!-- telegram_bot.lang_cmd -->
<g id="node127" class="node">
<title>telegram_bot.lang_cmd</title>
<g id="a_node127"><a xlink:title="Set preferred language or list available choices.">
<polygon fill="none" stroke="black" points="5121,-5667 4772,-5667 4772,-5628 5121,-5628 5121,-5667"/>
<text text-anchor="middle" x="4946.5" y="-5640.6" font-family="Times,serif" font-size="28.00">telegram_bot.lang_cmd</text>
</a>
</g>
</g>
<!-- telegram_bot.lang_cmd&#45;&gt;telegram_bot._t -->
<g id="edge191" class="edge">
<title>telegram_bot.lang_cmd&#45;&gt;telegram_bot._t</title>
<path fill="none" stroke="black" d="M5121.27,-5638.17C5145.2,-5633.63 5169.07,-5627.29 5191,-5618.5 5209.57,-5611.06 5208.31,-5598.63 5227,-5591.5 5291.31,-5566.98 5368.14,-5559.95 5429.99,-5559.18"/>
<polygon fill="black" stroke="black" points="5430.2,-5562.68 5440.18,-5559.11 5430.15,-5555.68 5430.2,-5562.68"/>
</g>
<!-- telegram_bot.lang_cmd&#45;&gt;telegram_bot.ensure_profile -->
<g id="edge192" class="edge">
<title>telegram_bot.lang_cmd&#45;&gt;telegram_bot.ensure_profile</title>
<path fill="none" stroke="black" d="M5121.09,-5639.05C5203.81,-5635.03 5302.11,-5630.25 5383.06,-5626.31"/>
<polygon fill="black" stroke="black" points="5383.53,-5629.79 5393.35,-5625.81 5383.19,-5622.8 5383.53,-5629.79"/>
</g>
<!-- telegram_bot.lang_cmd&#45;&gt;telegram_bot.save_profiles -->
<g id="edge193" class="edge">
<title>telegram_bot.lang_cmd&#45;&gt;telegram_bot.save_profiles</title>
<path fill="none" stroke="black" d="M5121.35,-5658.51C5305.8,-5667.54 5605.45,-5674.61 5862,-5645.5 6041.07,-5625.18 6246.54,-5569.89 6351.08,-5539.39"/>
<polygon fill="black" stroke="black" points="6352.27,-5542.69 6360.88,-5536.52 6350.3,-5535.97 6352.27,-5542.69"/>
</g>
<!-- telegram_bot.vote_callback -->
<g id="node128" class="node">
<title>telegram_bot.vote_callback</title>
<g id="a_node128"><a xlink:title="Handle inline button presses for lot feedback.">
<polygon fill="none" stroke="black" points="5161.5,-5555 4731.5,-5555 4731.5,-5514 5161.5,-5514 5161.5,-5555"/>
<text text-anchor="middle" x="4946.5" y="-5527.26" font-family="Times,serif" font-size="29.68">telegram_bot.vote_callback</text>
</a>
</g>
</g>
<!-- telegram_bot.vote_callback&#45;&gt;telegram_bot._t -->
<g id="edge194" class="edge">
<title>telegram_bot.vote_callback&#45;&gt;telegram_bot._t</title>
<path fill="none" stroke="black" d="M5161.83,-5545.29C5252.53,-5549.85 5354.49,-5554.99 5430.2,-5558.8"/>
<polygon fill="black" stroke="black" points="5430.07,-5562.29 5440.23,-5559.3 5430.42,-5555.3 5430.07,-5562.29"/>
</g>
<!-- telegram_bot.vote_callback&#45;&gt;telegram_bot.ensure_profile -->
<g id="edge195" class="edge">
<title>telegram_bot.vote_callback&#45;&gt;telegram_bot.ensure_profile</title>
<path fill="none" stroke="black" d="M5161.62,-5554.34C5171.67,-5557.31 5181.52,-5560.68 5191,-5564.5 5209.55,-5571.97 5208.31,-5584.37 5227,-5591.5 5275.79,-5610.11 5331.79,-5618.64 5382.99,-5622.01"/>
<polygon fill="black" stroke="black" points="5382.97,-5625.52 5393.16,-5622.62 5383.38,-5618.53 5382.97,-5625.52"/>
</g>
<!-- telegram_bot.vote_callback&#45;&gt;telegram_bot.save_profiles -->
<g id="edge196" class="edge">
<title>telegram_bot.vote_callback&#45;&gt;telegram_bot.save_profiles</title>
<path fill="none" stroke="black" d="M5161.61,-5532.17C5478.51,-5528.73 6061.31,-5522.4 6306.53,-5519.73"/>
<polygon fill="black" stroke="black" points="6306.93,-5523.23 6316.89,-5519.62 6306.85,-5516.23 6306.93,-5523.23"/>
</g>
<!-- telegram_bot.main -->
<g id="node129" class="node">
<title>telegram_bot.main</title>
<g id="a_node129"><a xlink:title="Run the Telegram recommendation bot.">
<polygon fill="none" stroke="black" points="5112,-5340.5 4781,-5340.5 4781,-5296.5 5112,-5296.5 5112,-5340.5"/>
<text text-anchor="middle" x="4946.5" y="-5310.18" font-family="Times,serif" font-size="32.90">telegram_bot.main</text>
</a>
</g>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot.load_profiles -->
<g id="edge197" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot.load_profiles</title>
<path fill="none" stroke="black" d="M5112.33,-5334.54C5196.84,-5342.76 5299.33,-5352.74 5383.18,-5360.9"/>
<polygon fill="black" stroke="black" points="5383.02,-5364.4 5393.31,-5361.88 5383.7,-5357.43 5383.02,-5364.4"/>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot.load_state -->
<g id="edge198" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot.load_state</title>
<path fill="none" stroke="black" d="M5112.33,-5318.57C5580.81,-5318.77 6960.29,-5319.32 8106,-5319.5 8309.11,-5319.53 8822.85,-5368.33 9020,-5319.5 9037.56,-5315.15 9038.72,-5305.87 9056,-5300.5 9105.21,-5285.22 9160.68,-5276.34 9210.82,-5271.2"/>
<polygon fill="black" stroke="black" points="9211.17,-5274.68 9220.78,-5270.22 9210.48,-5267.72 9211.17,-5274.68"/>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot.save_state -->
<g id="edge199" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot.save_state</title>
<path fill="none" stroke="black" d="M4947.67,-5296.31C4949.8,-5192.69 4973.91,-4753.93 5227,-4573.5 5582.69,-4319.92 6161.68,-4462.32 6354.91,-4520.46"/>
<polygon fill="black" stroke="black" points="6354.05,-4523.85 6364.64,-4523.41 6356.09,-4517.16 6354.05,-4523.85"/>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot.scan_embeddings -->
<g id="edge200" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot.scan_embeddings</title>
<path fill="none" stroke="black" d="M4948.81,-5296.43C4955.87,-5199.82 4998.08,-4811.72 5227,-4647.5 5469.89,-4473.26 5599.45,-4616.44 5898,-4601.5 5956.07,-4598.59 6895.53,-4600.6 6944,-4568.5 6975.83,-4547.42 6948.36,-4511.87 6980,-4490.5 7041.26,-4449.13 7230.58,-4448.22 7368.7,-4453.78"/>
<polygon fill="black" stroke="black" points="7368.84,-4457.29 7378.97,-4454.21 7369.13,-4450.3 7368.84,-4457.29"/>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot.enqueue_new_ids -->
<g id="edge201" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot.enqueue_new_ids</title>
<path fill="none" stroke="black" d="M5112.24,-5320.09C5139.96,-5325.66 5167.36,-5334.85 5191,-5349.5 5215.52,-5364.69 5203.12,-5387.32 5227,-5403.5 5256.43,-5423.45 5290.65,-5437.63 5325.51,-5447.67"/>
<polygon fill="black" stroke="black" points="5324.78,-5451.1 5335.35,-5450.4 5326.64,-5444.36 5324.78,-5451.1"/>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot._send_queue -->
<g id="edge202" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot._send_queue</title>
<path fill="none" stroke="black" d="M5112.33,-5306.88C5157.87,-5303.67 5208.64,-5300.1 5258.9,-5296.56"/>
<polygon fill="black" stroke="black" points="5259.21,-5300.04 5268.94,-5295.85 5258.72,-5293.06 5259.21,-5300.04"/>
</g>
<!-- debug_dump.parse_url -->
<g id="node130" class="node">
<title>debug_dump.parse_url</title>
<g id="a_node130"><a xlink:title="Return ``(lot_id, lang)`` extracted from ``url``.">
<polygon fill="none" stroke="black" points="7674.5,-5234.5 7375.5,-5234.5 7375.5,-5198.5 7674.5,-5198.5 7674.5,-5234.5"/>
<text text-anchor="middle" x="7525" y="-5210.62" font-family="Times,serif" font-size="24.22">debug_dump.parse_url</text>
</a>
</g>
</g>
<!-- debug_dump.guess_source_from_lot -->
<g id="node131" class="node">
<title>debug_dump.guess_source_from_lot</title>
<g id="a_node131"><a xlink:title="Guess ``(chat, message_id)`` directly from ``lot_id``.">
<polygon fill="none" stroke="black" points="8784,-5310.5 8342,-5310.5 8342,-5274.5 8784,-5274.5 8784,-5310.5"/>
<text text-anchor="middle" x="8563" y="-5286.91" font-family="Times,serif" font-size="23.24">debug_dump.guess_source_from_lot</text>
</a>
</g>
</g>
<!-- debug_dump.load_source_info -->
<g id="node132" class="node">
<title>debug_dump.load_source_info</title>
<g id="a_node132"><a xlink:title="Return ``(chat, message_id)`` for ``lot_id`` if available.">
<polygon fill="none" stroke="black" points="7779,-5104 7271,-5104 7271,-5061 7779,-5061 7779,-5104"/>
<text text-anchor="middle" x="7525" y="-5074.35" font-family="Times,serif" font-size="32.06">debug_dump.load_source_info</text>
</a>
</g>
</g>
<!-- debug_dump.load_source_info&#45;&gt;notes_utils.load_json -->
<g id="edge203" class="edge">
<title>debug_dump.load_source_info&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M7779.16,-5074.14C8182.9,-5058.24 8935.91,-5017.12 9020,-4929.5 9084.09,-4862.71 9032.19,-4603.95 9056,-4514.5 9125.83,-4252.13 9293.37,-3965.07 9346.82,-3877.39"/>
<polygon fill="black" stroke="black" points="9349.96,-3878.97 9352.19,-3868.61 9343.99,-3875.31 9349.96,-3878.97"/>
</g>
<!-- debug_dump.load_source_info&#45;&gt;lot_io.lot_json_path -->
<g id="edge204" class="edge">
<title>debug_dump.load_source_info&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M7779.18,-5097.9C7899.83,-5099.47 8027.09,-5090.78 8070,-5051.5 8151.51,-4976.89 8024.57,-4880.2 8106,-4805.5 8158.17,-4757.64 8359.38,-4763.41 8476.36,-4771.28"/>
<polygon fill="black" stroke="black" points="8476.15,-4774.77 8486.37,-4771.97 8476.63,-4767.79 8476.15,-4774.77"/>
</g>
<!-- lot_io.lot_json_path&#45;&gt;lot_io.parse_lot_id -->
<g id="edge278" class="edge">
<title>lot_io.lot_json_path&#45;&gt;lot_io.parse_lot_id</title>
<path fill="none" stroke="black" d="M8639.85,-4785.04C8732.02,-4790.51 8891.17,-4791.91 9020,-4751.5 9148.72,-4711.13 9278.6,-4612.26 9334.72,-4566.05"/>
<polygon fill="black" stroke="black" points="9337,-4568.71 9342.46,-4559.63 9332.53,-4563.33 9337,-4568.71"/>
</g>
<!-- debug_dump.run_tg_fetch -->
<g id="node134" class="node">
<title>debug_dump.run_tg_fetch</title>
<g id="a_node134"><a xlink:title="Run ``tg_client.py &#45;&#45;fetch`` and return combined logs.">
<polygon fill="none" stroke="black" points="9590.5,-5219.5 9138.5,-5219.5 9138.5,-5175.5 9590.5,-5175.5 9590.5,-5219.5"/>
<text text-anchor="middle" x="9364.5" y="-5189.18" font-family="Times,serif" font-size="32.90">debug_dump.run_tg_fetch</text>
</a>
</g>
</g>
<!-- debug_dump.run_tg_fetch&#45;&gt;notes_utils.read_text -->
<g id="edge205" class="edge">
<title>debug_dump.run_tg_fetch&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M9590.59,-5191.58C9619.26,-5185.41 9647.47,-5176.4 9673,-5163.5 9813.36,-5092.56 9921.34,-4927.86 9960.03,-4862.72"/>
<polygon fill="black" stroke="black" points="9963.19,-4864.25 9965.23,-4853.85 9957.15,-4860.71 9963.19,-4864.25"/>
</g>
<!-- debug_dump.collect_files -->
<g id="node135" class="node">
<title>debug_dump.collect_files</title>
<g id="a_node135"><a xlink:title="Return ``[(name, content), ...]`` for files related to ``lot_id``.">
<polygon fill="none" stroke="black" points="7772,-4695 7278,-4695 7278,-4646 7772,-4646 7772,-4695"/>
<text text-anchor="middle" x="7525" y="-4661.32" font-family="Times,serif" font-size="37.10">debug_dump.collect_files</text>
</a>
</g>
</g>
<!-- debug_dump.collect_files&#45;&gt;post_io.raw_post_path -->
<g id="edge212" class="edge">
<title>debug_dump.collect_files&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7676.24,-4695.02C7798.77,-4705.8 7967.75,-4698.16 8070,-4598.5 8143.15,-4527.2 8052.47,-4458.5 8106,-4371.5 8203.65,-4212.78 8409.22,-4107.83 8507.47,-4064.72"/>
<polygon fill="black" stroke="black" points="8509.14,-4067.81 8516.92,-4060.62 8506.35,-4061.39 8509.14,-4067.81"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;notes_utils.read_text -->
<g id="edge206" class="edge">
<title>debug_dump.collect_files&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M7772.2,-4667.25C8068.61,-4665.11 8581.34,-4667.08 9020,-4697.5 9311.64,-4717.72 9384.23,-4730.93 9673,-4776.5 9743.2,-4787.58 9821.98,-4803.04 9881.54,-4815.36"/>
<polygon fill="black" stroke="black" points="9881.18,-4818.86 9891.68,-4817.46 9882.6,-4812 9881.18,-4818.86"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;notes_utils.load_json -->
<g id="edge207" class="edge">
<title>debug_dump.collect_files&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M7772.32,-4693.12C7869.7,-4692.04 7979.69,-4677.68 8070,-4631.5 8092.19,-4620.15 8084.18,-4600.54 8106,-4588.5 8464.91,-4390.41 8681.15,-4695.22 9020,-4464.5 9239.18,-4315.26 9333.64,-3977.6 9357.3,-3878.4"/>
<polygon fill="black" stroke="black" points="9360.74,-3879.06 9359.6,-3868.53 9353.92,-3877.47 9360.74,-3879.06"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;caption_io.has_caption -->
<g id="edge209" class="edge">
<title>debug_dump.collect_files&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M7650.05,-4695.03C7776.15,-4711.94 7967.15,-4713.89 8070,-4598.5 8149.23,-4509.61 8033.85,-2550.23 8106,-2455.5 8192.09,-2342.46 8368.68,-2320.87 8475.07,-2318.84"/>
<polygon fill="black" stroke="black" points="8475.19,-2322.34 8485.14,-2318.7 8475.09,-2315.34 8475.19,-2322.34"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;caption_io.read_caption -->
<g id="edge210" class="edge">
<title>debug_dump.collect_files&#45;&gt;caption_io.read_caption</title>
<path fill="none" stroke="black" d="M7650.03,-4695.01C7776.11,-4711.9 7967.09,-4713.84 8070,-4598.5 8144.87,-4514.58 8028.49,-2655.99 8106,-2574.5 8144.02,-2534.52 8275.28,-2528.83 8387.26,-2531.97"/>
<polygon fill="black" stroke="black" points="8387.24,-2535.47 8397.35,-2532.28 8387.46,-2528.47 8387.24,-2535.47"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;caption_io.caption_json_path -->
<g id="edge208" class="edge">
<title>debug_dump.collect_files&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M7772.09,-4680.8C7894.31,-4680.53 8025.27,-4670.34 8070,-4631.5 8127.33,-4581.72 8047.79,-4513.26 8106,-4464.5 8183.9,-4399.24 8947.32,-4502.52 9020,-4431.5 9068.4,-4384.2 9041.99,-3889.71 9056,-3823.5 9124.84,-3498.22 9299.74,-3130.23 9349.88,-3028.68"/>
<polygon fill="black" stroke="black" points="9353.03,-3030.21 9354.33,-3019.7 9346.75,-3027.1 9353.03,-3030.21"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;lot_io.lot_json_path -->
<g id="edge211" class="edge">
<title>debug_dump.collect_files&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M7697.67,-4646C7810,-4638.14 7956.44,-4643.96 8070,-4704.5 8093.22,-4716.88 8082.76,-4739.16 8106,-4751.5 8222.52,-4813.38 8380.17,-4806.23 8476.29,-4793.65"/>
<polygon fill="black" stroke="black" points="8476.82,-4797.11 8486.26,-4792.29 8475.88,-4790.17 8476.82,-4797.11"/>
</g>
<!-- debug_dump.delete_files -->
<g id="node136" class="node">
<title>debug_dump.delete_files</title>
<g id="a_node136"><a xlink:title="Remove files related to ``lot_id`` from the filesystem.">
<polygon fill="none" stroke="black" points="7740.5,-4757.5 7309.5,-4757.5 7309.5,-4713.5 7740.5,-4713.5 7740.5,-4757.5"/>
<text text-anchor="middle" x="7525" y="-4727.18" font-family="Times,serif" font-size="32.90">debug_dump.delete_files</text>
</a>
</g>
</g>
<!-- debug_dump.delete_files&#45;&gt;post_io.raw_post_path -->
<g id="edge217" class="edge">
<title>debug_dump.delete_files&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7740.73,-4750.2C7871.95,-4754.15 8023.27,-4747.98 8070,-4703.5 8123.75,-4652.33 8068.68,-4435.65 8106,-4371.5 8199.57,-4210.67 8406.58,-4106.95 8506.25,-4064.45"/>
<polygon fill="black" stroke="black" points="8507.69,-4067.64 8515.55,-4060.53 8504.97,-4061.19 8507.69,-4067.64"/>
</g>
<!-- debug_dump.delete_files&#45;&gt;notes_utils.load_json -->
<g id="edge213" class="edge">
<title>debug_dump.delete_files&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M7740.57,-4728.15C7840.86,-4723.36 7961.76,-4715.67 8070,-4703.5 8086.12,-4701.69 8089.87,-4699.22 8106,-4697.5 8207.1,-4686.74 8941.14,-4718.67 9020,-4654.5 9069.83,-4613.95 9034.41,-4575.01 9056,-4514.5 9147.33,-4258.5 9300.79,-3966.61 9348.73,-3877.63"/>
<polygon fill="black" stroke="black" points="9351.87,-3879.19 9353.54,-3868.73 9345.71,-3875.86 9351.87,-3879.19"/>
</g>
<!-- debug_dump.delete_files&#45;&gt;caption_io.caption_json_path -->
<g id="edge214" class="edge">
<title>debug_dump.delete_files&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M7655.87,-4757.51C7771.69,-4770.54 7942.21,-4772.98 8070,-4703.5 8093.74,-4690.59 8082.98,-4668.65 8106,-4654.5 8456.86,-4438.91 8745.54,-4809.5 9020,-4502.5 9070.35,-4446.18 9040.59,-3897.46 9056,-3823.5 9123.84,-3498.01 9299.44,-3130.17 9349.81,-3028.67"/>
<polygon fill="black" stroke="black" points="9352.96,-3030.2 9354.29,-3019.69 9346.69,-3027.08 9352.96,-3030.2"/>
</g>
<!-- debug_dump.delete_files&#45;&gt;caption_io.caption_md_path -->
<g id="edge215" class="edge">
<title>debug_dump.delete_files&#45;&gt;caption_io.caption_md_path</title>
<path fill="none" stroke="black" d="M7740.82,-4749.16C7871.37,-4752.58 8021.9,-4746.22 8070,-4703.5 8137.86,-4643.24 8038.71,-4563.4 8106,-4502.5 8257.05,-4365.8 8880.24,-4579.72 9020,-4431.5 9093,-4354.08 9003.85,-2609.25 9056,-2516.5 9107.37,-2425.14 9221.19,-2370.32 9295.02,-2343.04"/>
<polygon fill="black" stroke="black" points="9296.5,-2346.22 9304.71,-2339.53 9294.11,-2339.64 9296.5,-2346.22"/>
</g>
<!-- debug_dump.delete_files&#45;&gt;lot_io.lot_json_path -->
<g id="edge216" class="edge">
<title>debug_dump.delete_files&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M7740.66,-4744.41C7968.14,-4753.85 8316.14,-4768.3 8476.12,-4774.94"/>
<polygon fill="black" stroke="black" points="8476.24,-4778.44 8486.38,-4775.36 8476.53,-4771.45 8476.24,-4778.44"/>
</g>
<!-- debug_dump._message_reason -->
<g id="node137" class="node">
<title>debug_dump._message_reason</title>
<g id="a_node137"><a xlink:title="Return explanation why a message would be skipped.">
<polygon fill="none" stroke="black" points="9637,-4831 9092,-4831 9092,-4786 9637,-4786 9637,-4831"/>
<text text-anchor="middle" x="9364.5" y="-4800.12" font-family="Times,serif" font-size="33.60">debug_dump._message_reason</text>
</a>
</g>
</g>
<!-- debug_dump._message_reason&#45;&gt;moderation.should_skip_user -->
<g id="edge218" class="edge">
<title>debug_dump._message_reason&#45;&gt;moderation.should_skip_user</title>
<path fill="none" stroke="black" d="M9415.81,-4785.88C9487.21,-4750.77 9615.6,-4675.85 9673,-4568.5 9876.35,-4188.2 9966.12,-857.47 9974.8,-516.63"/>
<polygon fill="black" stroke="black" points="9978.3,-516.67 9975.05,-506.59 9971.3,-516.5 9978.3,-516.67"/>
</g>
<!-- debug_dump._lot_reason -->
<g id="node138" class="node">
<title>debug_dump._lot_reason</title>
<g id="a_node138"><a xlink:title="Return explanation why ``lot`` would be skipped.">
<polygon fill="none" stroke="black" points="9518.5,-5040.5 9210.5,-5040.5 9210.5,-5004.5 9518.5,-5004.5 9518.5,-5040.5"/>
<text text-anchor="middle" x="9364.5" y="-5016.91" font-family="Times,serif" font-size="23.24">debug_dump._lot_reason</text>
</a>
</g>
</g>
<!-- debug_dump.moderation_summary -->
<g id="node139" class="node">
<title>debug_dump.moderation_summary</title>
<g id="a_node139"><a xlink:title="Return a multi&#45;line summary of moderation checks for ``lot_id``.">
<polygon fill="none" stroke="black" points="7971.5,-4983.5 7078.5,-4983.5 7078.5,-4921.5 7971.5,-4921.5 7971.5,-4983.5"/>
<text text-anchor="middle" x="7525" y="-4940.3" font-family="Times,serif" font-size="49.00">debug_dump.moderation_summary</text>
</a>
</g>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;post_io.read_post -->
<g id="edge223" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7971.62,-4944.97C8008.84,-4928.54 8042.62,-4905.69 8070,-4874.5 8123.27,-4813.81 8076.65,-2042.73 8106,-1967.5 8187.04,-1759.76 8395.28,-1582.97 8499.97,-1503.86"/>
<polygon fill="black" stroke="black" points="8502.35,-1506.45 8508.24,-1497.64 8498.14,-1500.85 8502.35,-1506.45"/>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;post_io.raw_post_path -->
<g id="edge224" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7971.68,-4942.43C8008.51,-4926.4 8042.2,-4904.35 8070,-4874.5 8146.38,-4792.5 8051.43,-4469.38 8106,-4371.5 8196.38,-4209.4 8404.01,-4106.61 8504.9,-4064.45"/>
<polygon fill="black" stroke="black" points="8506.41,-4067.61 8514.32,-4060.55 8503.74,-4061.14 8506.41,-4067.61"/>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;notes_utils.load_json -->
<g id="edge219" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M7971.64,-4941.56C8404.96,-4929.89 9000.87,-4910.61 9020,-4892.5 9081.28,-4834.49 9033.96,-4595.95 9056,-4514.5 9126.93,-4252.43 9293.74,-3965.17 9346.91,-3877.42"/>
<polygon fill="black" stroke="black" points="9350.05,-3878.99 9352.26,-3868.63 9344.07,-3875.35 9350.05,-3878.99"/>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;lot_io.lot_json_path -->
<g id="edge222" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M7971.53,-4925.36C8006.54,-4912.44 8039.92,-4895.8 8070,-4874.5 8098.23,-4854.51 8076.96,-4824.3 8106,-4805.5 8165.05,-4767.27 8361.23,-4769.06 8476.13,-4773.76"/>
<polygon fill="black" stroke="black" points="8476.17,-4777.27 8486.3,-4774.19 8476.46,-4770.27 8476.17,-4777.27"/>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;debug_dump._message_reason -->
<g id="edge220" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;debug_dump._message_reason</title>
<path fill="none" stroke="black" d="M7969.25,-4983.51C8268.43,-4995.29 8670.87,-4993.31 9020,-4930.5 9124.48,-4911.7 9239.53,-4865.16 9306.43,-4835.3"/>
<polygon fill="black" stroke="black" points="9308.26,-4838.31 9315.95,-4831.02 9305.39,-4831.93 9308.26,-4838.31"/>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;debug_dump._lot_reason -->
<g id="edge221" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;debug_dump._lot_reason</title>
<path fill="none" stroke="black" d="M7971.81,-4974.4C8005.21,-4979.36 8038.25,-4985.33 8070,-4992.5 8086.75,-4996.28 8089.15,-5003.23 8106,-5006.5 8310.47,-5046.21 8908.68,-5035.61 9200.13,-5027.64"/>
<polygon fill="black" stroke="black" points="9200.47,-5031.13 9210.37,-5027.36 9200.28,-5024.14 9200.47,-5031.13"/>
</g>
<!-- debug_dump.main -->
<g id="node140" class="node">
<title>debug_dump.main</title>
<g id="a_node140"><a xlink:title="Collect log and data files related to a single lot.">
<polygon fill="none" stroke="black" points="6659,-5113.5 6183,-5113.5 6183,-5051.5 6659,-5051.5 6659,-5113.5"/>
<text text-anchor="middle" x="6421" y="-5070.3" font-family="Times,serif" font-size="49.00">debug_dump.main</text>
</a>
</g>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.parse_url -->
<g id="edge225" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.parse_url</title>
<path fill="none" stroke="black" d="M6564.62,-5113.54C6676.94,-5136.77 6837.74,-5167.38 6980,-5184.5 7109.11,-5200.04 7256.42,-5208.12 7365.15,-5212.27"/>
<polygon fill="black" stroke="black" points="7365.09,-5215.77 7375.22,-5212.64 7365.35,-5208.77 7365.09,-5215.77"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.guess_source_from_lot -->
<g id="edge226" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.guess_source_from_lot</title>
<path fill="none" stroke="black" d="M6488.4,-5113.54C6591.09,-5159.71 6795.85,-5244.44 6980,-5276.5 7232.4,-5320.44 7957.02,-5308.84 8331.6,-5299.31"/>
<polygon fill="black" stroke="black" points="8331.85,-5302.8 8341.76,-5299.05 8331.67,-5295.8 8331.85,-5302.8"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.load_source_info -->
<g id="edge227" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.load_source_info</title>
<path fill="none" stroke="black" d="M6659.08,-5082.5C6835.96,-5082.5 7077.59,-5082.5 7260.51,-5082.5"/>
<polygon fill="black" stroke="black" points="7260.54,-5086 7270.54,-5082.5 7260.54,-5079 7260.54,-5086"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.run_tg_fetch -->
<g id="edge228" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.run_tg_fetch</title>
<path fill="none" stroke="black" d="M6502.68,-5113.57C6609.81,-5153.01 6805.79,-5218.87 6980,-5243.5 7389.27,-5301.36 8610.85,-5240.93 9128.03,-5211.57"/>
<polygon fill="black" stroke="black" points="9128.44,-5215.06 9138.23,-5210.99 9128.05,-5208.07 9128.44,-5215.06"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.collect_files -->
<g id="edge229" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.collect_files</title>
<path fill="none" stroke="black" d="M6454.05,-5051.31C6534.43,-4975.38 6754.37,-4781.51 6980,-4704.5 7070.84,-4673.5 7175.09,-4661.72 7267.87,-4658.81"/>
<polygon fill="black" stroke="black" points="7268.07,-4662.31 7277.96,-4658.53 7267.87,-4655.31 7268.07,-4662.31"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.delete_files -->
<g id="edge230" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.delete_files</title>
<path fill="none" stroke="black" d="M6461.72,-5051.27C6549.28,-4984.51 6767.99,-4828.87 6980,-4766.5 7082.11,-4736.46 7199.54,-4726.84 7299.1,-4725.49"/>
<polygon fill="black" stroke="black" points="7299.34,-4728.99 7309.3,-4725.38 7299.26,-4721.99 7299.34,-4728.99"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.moderation_summary -->
<g id="edge231" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.moderation_summary</title>
<path fill="none" stroke="black" d="M6590.26,-5051.47C6700.72,-5032.06 6848.55,-5007.9 6980,-4992.5 7008.73,-4989.13 7038.35,-4986 7068.24,-4983.09"/>
<polygon fill="black" stroke="black" points="7068.77,-4986.56 7078.38,-4982.12 7068.09,-4979.59 7068.77,-4986.56"/>
</g>
<!-- image_io.read_image_meta -->
<g id="node141" class="node">
<title>image_io.read_image_meta</title>
<g id="a_node141"><a xlink:title="Return metadata from ``path.with_suffix(&#39;.md&#39;)``.">
<polygon fill="none" stroke="black" points="7639.5,-1001.5 7410.5,-1001.5 7410.5,-965.5 7639.5,-965.5 7639.5,-1001.5"/>
<text text-anchor="middle" x="7525" y="-979.46" font-family="Times,serif" font-size="15.68">image_io.read_image_meta</text>
</a>
</g>
</g>
<!-- image_io.read_image_meta&#45;&gt;notes_utils.parse_md -->
<g id="edge232" class="edge">
<title>image_io.read_image_meta&#45;&gt;notes_utils.parse_md</title>
<path fill="none" stroke="black" d="M7639.54,-976.24C7751.23,-972.32 7925.53,-974.89 8070,-1015.5 8165.76,-1042.42 8425.01,-1195.07 8523.41,-1254.15"/>
<polygon fill="black" stroke="black" points="8521.77,-1257.25 8532.15,-1259.4 8525.38,-1251.25 8521.77,-1257.25"/>
</g>
<!-- moderation.should_skip_text -->
<g id="node142" class="node">
<title>moderation.should_skip_text</title>
<g id="a_node142"><a xlink:title="Return ``True`` if ``text`` contains banned phrases.">
<polygon fill="none" stroke="black" points="10120.5,-386.5 9832.5,-386.5 9832.5,-350.5 10120.5,-350.5 10120.5,-386.5"/>
<text text-anchor="middle" x="9976.5" y="-363.72" font-family="Times,serif" font-size="18.48">moderation.should_skip_text</text>
</a>
</g>
</g>
<!-- moderation.message_skip_reason&#45;&gt;moderation.should_skip_user -->
<g id="edge235" class="edge">
<title>moderation.message_skip_reason&#45;&gt;moderation.should_skip_user</title>
<path fill="none" stroke="black" d="M9621.1,-425.05C9638.85,-429.12 9656.31,-433.9 9673,-439.5 9690.56,-445.4 9691.4,-454.74 9709,-460.5 9751.15,-474.3 9798.86,-481.7 9842.14,-485.56"/>
<polygon fill="black" stroke="black" points="9841.92,-489.05 9852.17,-486.4 9842.5,-482.08 9841.92,-489.05"/>
</g>
<!-- moderation.message_skip_reason&#45;&gt;moderation.should_skip_text -->
<g id="edge234" class="edge">
<title>moderation.message_skip_reason&#45;&gt;moderation.should_skip_text</title>
<path fill="none" stroke="black" d="M9659.78,-386.1C9715.93,-382.97 9772.57,-379.81 9822.06,-377.05"/>
<polygon fill="black" stroke="black" points="9822.4,-380.54 9832.19,-376.49 9822.01,-373.55 9822.4,-380.54"/>
</g>
<!-- moderation.is_misparsed -->
<g id="node145" class="node">
<title>moderation.is_misparsed</title>
<g id="a_node145"><a xlink:title="Return ``True`` for obviously invalid lots or source posts.">
<polygon fill="none" stroke="black" points="7743,-757.5 7307,-757.5 7307,-713.5 7743,-713.5 7743,-757.5"/>
<text text-anchor="middle" x="7525" y="-727.18" font-family="Times,serif" font-size="32.90">moderation.is_misparsed</text>
</a>
</g>
</g>
<!-- moderation.is_misparsed&#45;&gt;lot_io.get_seller -->
<g id="edge238" class="edge">
<title>moderation.is_misparsed&#45;&gt;lot_io.get_seller</title>
<path fill="none" stroke="black" d="M7743.18,-732.77C7959.92,-730.06 8284.18,-725.99 8452.22,-723.88"/>
<polygon fill="black" stroke="black" points="8452.37,-727.38 8462.32,-723.75 8452.28,-720.38 8452.37,-727.38"/>
</g>
<!-- moderation.apply_to_history -->
<g id="node146" class="node">
<title>moderation.apply_to_history</title>
<g id="a_node146"><a xlink:title="Remove processed lots now failing moderation.">
<polygon fill="none" stroke="black" points="7781,-1271.5 7269,-1271.5 7269,-1225.5 7781,-1225.5 7781,-1271.5"/>
<text text-anchor="middle" x="7525" y="-1240.06" font-family="Times,serif" font-size="34.30">moderation.apply_to_history</text>
</a>
</g>
</g>
<!-- moderation.apply_to_history&#45;&gt;lot_io.read_lots -->
<g id="edge241" class="edge">
<title>moderation.apply_to_history&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M7703.52,-1271.51C7827.5,-1297.62 7985.41,-1353.07 8070,-1470.5 8141.85,-1570.24 8018.91,-1935.74 8106,-2022.5 8207.42,-2123.53 8392.5,-2096.02 8492.86,-2071"/>
<polygon fill="black" stroke="black" points="8493.77,-2074.38 8502.59,-2068.51 8492.04,-2067.6 8493.77,-2074.38"/>
</g>
<!-- moderation.apply_to_history&#45;&gt;moderation.should_skip_message -->
<g id="edge239" class="edge">
<title>moderation.apply_to_history&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M7769.99,-1225.46C7864.49,-1213.79 7973.05,-1196.97 8070,-1173.5 8234.93,-1133.56 8422.07,-1059.38 8510.5,-1022.5"/>
<polygon fill="black" stroke="black" points="8511.9,-1025.71 8519.77,-1018.62 8509.19,-1019.25 8511.9,-1025.71"/>
</g>
<!-- moderation.apply_to_history&#45;&gt;moderation.should_skip_lot -->
<g id="edge240" class="edge">
<title>moderation.apply_to_history&#45;&gt;moderation.should_skip_lot</title>
<path fill="none" stroke="black" d="M7639.28,-1225.48C7757.17,-1208.06 7942.1,-1199.82 8070,-1285.5 8100.05,-1305.63 8075.86,-1338.5 8106,-1358.5 8155.11,-1391.09 8300.92,-1394.94 8414.58,-1392.43"/>
<polygon fill="black" stroke="black" points="8414.86,-1395.93 8424.78,-1392.19 8414.7,-1388.93 8414.86,-1395.93"/>
</g>
<!-- moderation.apply_to_history&#45;&gt;post_io.read_post -->
<g id="edge242" class="edge">
<title>moderation.apply_to_history&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7781.34,-1238.42C7900.27,-1239.09 8025.28,-1249.25 8070,-1285.5 8115.57,-1322.45 8061.08,-1374.77 8106,-1412.5 8152.9,-1451.9 8212.82,-1471.85 8273.69,-1480.5"/>
<polygon fill="black" stroke="black" points="8273.49,-1484 8283.86,-1481.84 8274.4,-1477.06 8273.49,-1484"/>
</g>
<!-- moderation.apply_to_history&#45;&gt;post_io.raw_post_path -->
<g id="edge243" class="edge">
<title>moderation.apply_to_history&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7711.23,-1271.52C7835.11,-1297.55 7989.64,-1352.91 8070,-1470.5 8141.98,-1575.82 8042.49,-3655.86 8106,-3766.5 8188.31,-3909.9 8377.85,-3987.57 8484.85,-4021.42"/>
<polygon fill="black" stroke="black" points="8484.03,-4024.83 8494.62,-4024.46 8486.11,-4018.14 8484.03,-4024.83"/>
</g>
<!-- log_utils._extract_tb_lineno -->
<g id="node150" class="node">
<title>log_utils._extract_tb_lineno</title>
<g id="a_node150"><a xlink:title="Return the last line number from a traceback.">
<polygon fill="none" stroke="black" points="7640.5,-2125.5 7409.5,-2125.5 7409.5,-2089.5 7640.5,-2089.5 7640.5,-2125.5"/>
<text text-anchor="middle" x="7525" y="-2103.46" font-family="Times,serif" font-size="15.68">log_utils._extract_tb_lineno</text>
</a>
</g>
</g>
<!-- log_utils._add_exc_line -->
<g id="node151" class="node">
<title>log_utils._add_exc_line</title>
<g id="a_node151"><a xlink:title="Attach ``line`` from traceback to structured log events.">
<polygon fill="none" stroke="black" points="6562.5,-2071.5 6279.5,-2071.5 6279.5,-2035.5 6562.5,-2035.5 6562.5,-2071.5"/>
<text text-anchor="middle" x="6421" y="-2047.91" font-family="Times,serif" font-size="23.24">log_utils._add_exc_line</text>
</a>
</g>
</g>
<!-- log_utils._add_exc_line&#45;&gt;log_utils._extract_tb_lineno -->
<g id="edge255" class="edge">
<title>log_utils._add_exc_line&#45;&gt;log_utils._extract_tb_lineno</title>
<path fill="none" stroke="black" d="M6562.69,-2060.39C6779.63,-2071.02 7192.34,-2091.25 7399.23,-2101.39"/>
<polygon fill="black" stroke="black" points="7399.07,-2104.88 7409.23,-2101.88 7399.41,-2097.89 7399.07,-2104.88"/>
</g>
<!-- log_utils.init_logger -->
<g id="node152" class="node">
<title>log_utils.init_logger</title>
<g id="a_node152"><a xlink:title="Initialize logger writing to ``LOGFILE``.&#10;&#10;``LOG_LEVEL`` may be set in ``config.py`` or via an environment&#10;variable. &#160;The level accepts ``DEBUG``, ``INFO`` or ``ERROR`` and&#10;defaults to ``INFO``. &#160;The function falls back to the standard&#10;``logging`` module if ``structlog`` isn&#39;t available so the scripts&#10;can still run in minimal environments.">
<polygon fill="none" stroke="black" points="6768.5,-2017.5 6073.5,-2017.5 6073.5,-1935.5 6768.5,-1935.5 6768.5,-2017.5"/>
<text text-anchor="middle" x="6421" y="-1959.52" font-family="Times,serif" font-size="67.48">log_utils.init_logger</text>
</a>
</g>
</g>
<!-- log_utils.init_logger&#45;&gt;log_utils._extract_tb_lineno -->
<g id="edge256" class="edge">
<title>log_utils.init_logger&#45;&gt;log_utils._extract_tb_lineno</title>
<path fill="none" stroke="black" d="M6768.83,-1966.64C6830.28,-1976.63 6891.36,-1995.01 6944,-2026.5 6968.75,-2041.31 6954.91,-2066.26 6980,-2080.5 7048.95,-2119.63 7260.96,-2119.08 7399.05,-2114.05"/>
<polygon fill="black" stroke="black" points="7399.41,-2117.54 7409.27,-2113.66 7399.15,-2110.54 7399.41,-2117.54"/>
</g>
<!-- log_utils.get_logger -->
<g id="node153" class="node">
<title>log_utils.get_logger</title>
<g id="a_node153"><a xlink:title="Return the singleton logger instance.">
<polygon fill="none" stroke="black" points="7593.5,-2071.5 7456.5,-2071.5 7456.5,-2035.5 7593.5,-2035.5 7593.5,-2071.5"/>
<text text-anchor="middle" x="7525" y="-2050.26" font-family="Times,serif" font-size="12.18">log_utils.get_logger</text>
</a>
</g>
</g>
<!-- log_utils.init_logger&#45;&gt;log_utils.get_logger -->
<g id="edge257" class="edge">
<title>log_utils.init_logger&#45;&gt;log_utils.get_logger</title>
<path fill="none" stroke="black" d="M6768.68,-1996.82C6838.62,-2002.18 6911.65,-2007.73 6980,-2012.5 7145.78,-2024.06 7340.17,-2034.82 7445.86,-2043.35"/>
<polygon fill="black" stroke="black" points="7445.87,-2046.86 7456.12,-2044.19 7446.44,-2039.88 7445.87,-2046.86"/>
</g>
<!-- log_utils.get_logger&#45;&gt;log_utils.init_logger -->
<g id="edge258" class="edge">
<title>log_utils.get_logger&#45;&gt;log_utils.init_logger</title>
<path fill="none" stroke="black" d="M7456.12,-2055.77C7353.15,-2053.54 7151.3,-2042.44 6980,-2030.5 6914.98,-2025.97 6845.74,-2020.72 6778.95,-2015.28"/>
<polygon fill="black" stroke="black" points="6778.94,-2011.77 6768.68,-2014.45 6778.37,-2018.75 6778.94,-2011.77"/>
</g>
<!-- log_utils.install_excepthook -->
<g id="node154" class="node">
<title>log_utils.install_excepthook</title>
<g id="a_node154"><a xlink:title="Redirect uncaught exceptions to ``logger.exception``.">
<polygon fill="none" stroke="black" points="6607.5,-2217.5 6234.5,-2217.5 6234.5,-2181.5 6607.5,-2181.5 6607.5,-2217.5"/>
<text text-anchor="middle" x="6421" y="-2193.34" font-family="Times,serif" font-size="25.20">log_utils.install_excepthook</text>
</a>
</g>
</g>
<!-- log_utils.install_excepthook&#45;&gt;log_utils._extract_tb_lineno -->
<g id="edge259" class="edge">
<title>log_utils.install_excepthook&#45;&gt;log_utils._extract_tb_lineno</title>
<path fill="none" stroke="black" d="M6607.69,-2184C6832.77,-2165.21 7205.86,-2134.06 7399.21,-2117.92"/>
<polygon fill="black" stroke="black" points="7399.74,-2121.39 7409.42,-2117.07 7399.16,-2114.41 7399.74,-2121.39"/>
</g>
<!-- embed.main -->
<g id="node156" class="node">
<title>embed.main</title>
<g id="a_node156"><a xlink:title="Embed the file given on the command line.">
<polygon fill="none" stroke="black" points="6509,-2737.5 6333,-2737.5 6333,-2701.5 6509,-2701.5 6509,-2737.5"/>
<text text-anchor="middle" x="6421" y="-2713.34" font-family="Times,serif" font-size="25.20">embed.main</text>
</a>
</g>
</g>
<!-- embed.main&#45;&gt;embed.embed_file -->
<g id="edge263" class="edge">
<title>embed.main&#45;&gt;embed.embed_file</title>
<path fill="none" stroke="black" d="M6509.39,-2714.58C6680.99,-2704.93 7066.41,-2683.24 7309.73,-2669.56"/>
<polygon fill="black" stroke="black" points="7309.98,-2673.05 7319.76,-2668.99 7309.58,-2666.06 7309.98,-2673.05"/>
</g>
<!-- caption._identify_size -->
<g id="node157" class="node">
<title>caption._identify_size</title>
<g id="a_node157"><a xlink:title="Return ``(width, height)`` for ``path`` using ImageMagick.">
<polygon fill="none" stroke="black" points="8691.5,-3325.5 8434.5,-3325.5 8434.5,-3289.5 8691.5,-3289.5 8691.5,-3325.5"/>
<text text-anchor="middle" x="8563" y="-3301.8" font-family="Times,serif" font-size="22.12">caption._identify_size</text>
</a>
</g>
</g>
<!-- caption._prepare_image -->
<g id="node158" class="node">
<title>caption._prepare_image</title>
<g id="a_node158"><a xlink:title="Resize ``path`` and return the processed JPEG bytes.">
<polygon fill="none" stroke="black" points="7742,-3325.5 7308,-3325.5 7308,-3279.5 7742,-3279.5 7742,-3325.5"/>
<text text-anchor="middle" x="7525" y="-3294.06" font-family="Times,serif" font-size="34.30">caption._prepare_image</text>
</a>
</g>
</g>
<!-- caption._prepare_image&#45;&gt;caption._identify_size -->
<g id="edge264" class="edge">
<title>caption._prepare_image&#45;&gt;caption._identify_size</title>
<path fill="none" stroke="black" d="M7742.23,-3303.54C7947.46,-3304.53 8249.73,-3305.99 8424.12,-3306.83"/>
<polygon fill="black" stroke="black" points="8424.12,-3310.33 8434.13,-3306.88 8424.15,-3303.33 8424.12,-3310.33"/>
</g>
<!-- caption._guess_chat -->
<g id="node159" class="node">
<title>caption._guess_chat</title>
<g id="a_node159"><a xlink:title="Return chat name for ``path`` relative to ``MEDIA_DIR``.">
<polygon fill="none" stroke="black" points="8659,-3271.5 8467,-3271.5 8467,-3235.5 8659,-3235.5 8659,-3271.5"/>
<text text-anchor="middle" x="8563" y="-3249.34" font-family="Times,serif" font-size="17.08">caption._guess_chat</text>
</a>
</g>
</g>
<!-- caption.caption_file -->
<g id="node160" class="node">
<title>caption.caption_file</title>
<g id="a_node160"><a xlink:title="Caption ``path`` with GPT&#45;4o and save ``.caption.json`` beside it.">
<polygon fill="none" stroke="black" points="6724,-3288 6118,-3288 6118,-3215 6724,-3215 6724,-3288"/>
<text text-anchor="middle" x="6421" y="-3236.51" font-family="Times,serif" font-size="59.36">caption.caption_file</text>
</a>
</g>
</g>
<!-- caption.caption_file&#45;&gt;notes_utils.load_json -->
<g id="edge265" class="edge">
<title>caption.caption_file&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M6724.05,-3286.84C6796.42,-3297.2 6873.22,-3309.79 6944,-3324.5 6960.26,-3327.88 6963.57,-3332.12 6980,-3334.5 7092.18,-3350.74 8919.68,-3315.74 9020,-3368.5 9213.58,-3470.3 9322.72,-3736.02 9354.01,-3822.71"/>
<polygon fill="black" stroke="black" points="9350.8,-3824.12 9357.44,-3832.37 9357.39,-3821.77 9350.8,-3824.12"/>
</g>
<!-- caption.caption_file&#45;&gt;caption_io.has_caption -->
<g id="edge267" class="edge">
<title>caption.caption_file&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M6460.98,-3214.75C6546.66,-3136.69 6761.24,-2955.87 6980,-2886.5 7037.76,-2868.19 8025.96,-2890.12 8070,-2848.5 8133.74,-2788.26 8050.3,-2523.24 8106,-2455.5 8195.9,-2346.17 8370.06,-2323.19 8475.2,-2319.93"/>
<polygon fill="black" stroke="black" points="8475.56,-2323.42 8485.47,-2319.67 8475.38,-2316.43 8475.56,-2323.42"/>
</g>
<!-- caption.caption_file&#45;&gt;caption_io.caption_json_path -->
<g id="edge266" class="edge">
<title>caption.caption_file&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M6724.3,-3247.97C7385.68,-3239.72 8911,-3217.66 9020,-3188.5 9144.72,-3155.14 9273.68,-3068.17 9331.77,-3025.63"/>
<polygon fill="black" stroke="black" points="9333.85,-3028.45 9339.81,-3019.69 9329.69,-3022.81 9333.85,-3028.45"/>
</g>
<!-- caption.caption_file&#45;&gt;caption_io.write_caption -->
<g id="edge268" class="edge">
<title>caption.caption_file&#45;&gt;caption_io.write_caption</title>
<path fill="none" stroke="black" d="M6585.05,-3214.96C6696.19,-3190.34 6846.79,-3157.55 6980,-3130.5 7130.27,-3099.99 7304.49,-3067.51 7414.47,-3047.36"/>
<polygon fill="black" stroke="black" points="7415.37,-3050.75 7424.58,-3045.51 7414.11,-3043.87 7415.37,-3050.75"/>
</g>
<!-- caption.caption_file&#45;&gt;caption._prepare_image -->
<g id="edge269" class="edge">
<title>caption.caption_file&#45;&gt;caption._prepare_image</title>
<path fill="none" stroke="black" d="M6724.22,-3265.49C6905.37,-3273.87 7131.94,-3284.36 7297.63,-3292.02"/>
<polygon fill="black" stroke="black" points="7297.81,-3295.54 7307.96,-3292.5 7298.13,-3288.54 7297.81,-3295.54"/>
</g>
<!-- caption.caption_file&#45;&gt;caption._guess_chat -->
<g id="edge270" class="edge">
<title>caption.caption_file&#45;&gt;caption._guess_chat</title>
<path fill="none" stroke="black" d="M6724.07,-3251.78C7210.22,-3252.24 8143.38,-3253.11 8456.57,-3253.4"/>
<polygon fill="black" stroke="black" points="8457,-3256.9 8467,-3253.41 8457,-3249.9 8457,-3256.9"/>
</g>
<!-- caption.main -->
<g id="node161" class="node">
<title>caption.main</title>
<g id="a_node161"><a xlink:title="Caption a single image provided on the command line.">
<polygon fill="none" stroke="black" points="5637,-3330.5 5452,-3330.5 5452,-3294.5 5637,-3294.5 5637,-3330.5"/>
<text text-anchor="middle" x="5544.5" y="-3306.34" font-family="Times,serif" font-size="25.20">caption.main</text>
</a>
</g>
</g>
<!-- caption.main&#45;&gt;caption.caption_file -->
<g id="edge271" class="edge">
<title>caption.main&#45;&gt;caption.caption_file</title>
<path fill="none" stroke="black" d="M5637.02,-3306.12C5747.92,-3298.38 5940.62,-3284.94 6107.09,-3273.33"/>
<polygon fill="black" stroke="black" points="6107.78,-3276.79 6117.51,-3272.6 6107.29,-3269.8 6107.78,-3276.79"/>
</g>
<!-- lot_io.get_timestamp -->
<g id="node163" class="node">
<title>lot_io.get_timestamp</title>
<g id="a_node163"><a xlink:title="Return ``lot[&#39;timestamp&#39;]`` as a timezone&#45;aware ``datetime``.">
<polygon fill="none" stroke="black" points="8722,-813.5 8404,-813.5 8404,-773.5 8722,-773.5 8722,-813.5"/>
<text text-anchor="middle" x="8563" y="-786.43" font-family="Times,serif" font-size="28.84">lot_io.get_timestamp</text>
</a>
</g>
</g>
<!-- lot_io.write_lots -->
<g id="node164" class="node">
<title>lot_io.write_lots</title>
<g id="a_node164"><a xlink:title="Write lots to ``path`` using consistent JSON formatting.">
<polygon fill="none" stroke="black" points="7626.5,-811.5 7423.5,-811.5 7423.5,-775.5 7626.5,-775.5 7626.5,-811.5"/>
<text text-anchor="middle" x="7525" y="-787.91" font-family="Times,serif" font-size="23.24">lot_io.write_lots</text>
</a>
</g>
</g>
<!-- lot_io.write_lots&#45;&gt;notes_utils.write_json -->
<g id="edge274" class="edge">
<title>lot_io.write_lots&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M7626.61,-778.92C7751.94,-767.12 7962.63,-769.52 8070,-896.5 8134.15,-972.37 8053.29,-2600.28 8106,-2684.5 8183.65,-2808.55 8349.98,-2869.4 8458.84,-2897.05"/>
<polygon fill="black" stroke="black" points="8458.31,-2900.52 8468.86,-2899.54 8460,-2893.73 8458.31,-2900.52"/>
</g>
<!-- lot_io.write_lots&#45;&gt;lot_io.get_seller -->
<g id="edge276" class="edge">
<title>lot_io.write_lots&#45;&gt;lot_io.get_seller</title>
<path fill="none" stroke="black" d="M7626.58,-789.7C7735.82,-785.3 7915.41,-777.24 8070,-766.5 8201.51,-757.36 8352.48,-743.33 8452.13,-733.58"/>
<polygon fill="black" stroke="black" points="8452.6,-737.05 8462.21,-732.59 8451.91,-730.09 8452.6,-737.05"/>
</g>
<!-- lot_io.write_lots&#45;&gt;lot_io._clean_lot -->
<g id="edge275" class="edge">
<title>lot_io.write_lots&#45;&gt;lot_io._clean_lot</title>
<path fill="none" stroke="black" d="M7626.5,-796.53C7735.86,-800.5 7915.72,-808.98 8070,-825.5 8282.44,-848.24 8869.49,-821.86 9020,-973.5 9096.91,-1050.99 8987.23,-1131.7 9056,-1216.5 9115.05,-1289.31 9225.35,-1315.62 9296.54,-1325.13"/>
<polygon fill="black" stroke="black" points="9296.39,-1328.63 9306.75,-1326.41 9297.26,-1321.69 9296.39,-1328.63"/>
</g>
<!-- lot_io.write_lots&#45;&gt;lot_io.get_timestamp -->
<g id="edge277" class="edge">
<title>lot_io.write_lots&#45;&gt;lot_io.get_timestamp</title>
<path fill="none" stroke="black" d="M7626.75,-793.5C7804.69,-793.5 8176.3,-793.5 8393.71,-793.5"/>
<polygon fill="black" stroke="black" points="8393.94,-797 8403.94,-793.5 8393.94,-790 8393.94,-797"/>
</g>
<!-- lot_io.embedding_path -->
<g id="node166" class="node">
<title>lot_io.embedding_path</title>
<g id="a_node166"><a xlink:title="Return embedding file path for ``lot_path``.">
<polygon fill="none" stroke="black" points="6527.5,-2125.5 6314.5,-2125.5 6314.5,-2089.5 6527.5,-2089.5 6527.5,-2125.5"/>
<text text-anchor="middle" x="6421" y="-2103.34" font-family="Times,serif" font-size="17.08">lot_io.embedding_path</text>
</a>
</g>
</g>
<!-- post_io.raw_post_path_from_lot -->
<g id="node168" class="node">
<title>post_io.raw_post_path_from_lot</title>
<g id="a_node168"><a xlink:title="Return raw post path referenced by ``lot`` or ``None``.">
<polygon fill="none" stroke="black" points="7670,-3811.5 7380,-3811.5 7380,-3775.5 7670,-3775.5 7670,-3811.5"/>
<text text-anchor="middle" x="7525" y="-3789.34" font-family="Times,serif" font-size="17.08">post_io.raw_post_path_from_lot</text>
</a>
</g>
</g>
<!-- post_io.raw_post_path_from_lot&#45;&gt;post_io.raw_post_path -->
<g id="edge286" class="edge">
<title>post_io.raw_post_path_from_lot&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7670.1,-3786.17C7780.97,-3783.98 7937.17,-3788.45 8070,-3820.5 8249.16,-3863.72 8443.42,-3971.56 8523.84,-4019.22"/>
<polygon fill="black" stroke="black" points="8522.24,-4022.34 8532.62,-4024.46 8525.83,-4016.33 8522.24,-4022.34"/>
</g>
<!-- scan_ontology.collect_ontology -->
<g id="node169" class="node">
<title>scan_ontology.collect_ontology</title>
<g id="a_node169"><a xlink:title="Return counts per field, value counters, misparsed lots and broken metadata.">
<polygon fill="none" stroke="black" points="6879,-1917 5963,-1917 5963,-1846 6879,-1846 6879,-1917"/>
<text text-anchor="middle" x="6421" y="-1866.86" font-family="Times,serif" font-size="57.68">scan_ontology.collect_ontology</text>
</a>
</g>
</g>
<!-- scan_ontology.collect_ontology&#45;&gt;lot_io.read_lots -->
<g id="edge289" class="edge">
<title>scan_ontology.collect_ontology&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M6879.05,-1895.06C6901.69,-1903.65 6923.51,-1914.03 6944,-1926.5 6969.6,-1942.08 6954.05,-1968.52 6980,-1983.5 7032.49,-2013.79 8009.46,-2023.83 8070,-2026.5 8199.06,-2032.19 8347.12,-2039.52 8446.82,-2044.58"/>
<polygon fill="black" stroke="black" points="8446.76,-2048.08 8456.92,-2045.09 8447.11,-2041.09 8446.76,-2048.08"/>
</g>
<!-- scan_ontology.collect_ontology&#45;&gt;post_io.read_post -->
<g id="edge290" class="edge">
<title>scan_ontology.collect_ontology&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M6450.81,-1845.95C6526.2,-1756.13 6740.11,-1521.29 6980,-1437.5 7210.5,-1356.98 7883.81,-1398.91 8273.73,-1432.04"/>
<polygon fill="black" stroke="black" points="8273.49,-1435.53 8283.75,-1432.9 8274.09,-1428.56 8273.49,-1435.53"/>
</g>
<!-- scan_ontology.collect_ontology&#45;&gt;post_io.raw_post_path -->
<g id="edge291" class="edge">
<title>scan_ontology.collect_ontology&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M6575.56,-1845.99C6693.97,-1828.62 6852.51,-1828.99 6944,-1926.5 7005.52,-1992.07 6917.8,-3479.58 6980,-3544.5 7147.93,-3719.77 7884.49,-3458.96 8070,-3615.5 8122.73,-3659.99 8065.34,-3710.76 8106,-3766.5 8205.59,-3903.02 8395.13,-3985.21 8495.61,-4021.11"/>
<polygon fill="black" stroke="black" points="8494.46,-4024.42 8505.05,-4024.45 8496.79,-4017.82 8494.46,-4024.42"/>
</g>
<!-- scan_ontology.collect_ontology&#45;&gt;message_utils.gather_chop_input -->
<g id="edge287" class="edge">
<title>scan_ontology.collect_ontology&#45;&gt;message_utils.gather_chop_input</title>
<path fill="none" stroke="black" d="M6582.82,-1845.99C6699.57,-1830.53 6852.51,-1833.4 6944,-1926.5 7025.96,-2009.91 6896.61,-2369.52 6980,-2451.5 7025.23,-2495.96 7172.4,-2501.52 7302.28,-2496.73"/>
<polygon fill="black" stroke="black" points="7302.53,-2500.23 7312.39,-2496.34 7302.26,-2493.23 7302.53,-2500.23"/>
</g>
<!-- scan_ontology.collect_ontology&#45;&gt;moderation.is_misparsed -->
<g id="edge288" class="edge">
<title>scan_ontology.collect_ontology&#45;&gt;moderation.is_misparsed</title>
<path fill="none" stroke="black" d="M6468.41,-1845.97C6575.21,-1761.09 6837.41,-1534.2 6944,-1275.5 6987.2,-1170.66 6899.27,-846.13 6980,-766.5 7024.55,-722.55 7168.35,-715.75 7296.92,-719.44"/>
<polygon fill="black" stroke="black" points="7296.83,-722.94 7306.93,-719.75 7297.04,-715.94 7296.83,-722.94"/>
</g>
<!-- scan_ontology.main -->
<g id="node170" class="node">
<title>scan_ontology.main</title>
<polygon fill="none" stroke="black" points="5772,-2217 5317,-2217 5317,-2160 5772,-2160 5772,-2217"/>
<text text-anchor="middle" x="5544.5" y="-2177.61" font-family="Times,serif" font-size="44.24">scan_ontology.main</text>
</g>
<!-- scan_ontology.main&#45;&gt;notes_utils.write_json -->
<g id="edge292" class="edge">
<title>scan_ontology.main&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M5772.24,-2207.8C5806.18,-2219.94 5837.83,-2237.98 5862,-2264.5 5937.62,-2347.47 5819.46,-2434.3 5898,-2514.5 6068.52,-2688.62 6737.5,-2669.2 6980,-2693.5 7221.17,-2717.66 7832.34,-2684.89 8070,-2732.5 8241.63,-2766.88 8432.27,-2853.6 8517.08,-2894.92"/>
<polygon fill="black" stroke="black" points="8515.65,-2898.12 8526.17,-2899.37 8518.73,-2891.83 8515.65,-2898.12"/>
</g>
<!-- scan_ontology.main&#45;&gt;log_utils.install_excepthook -->
<g id="edge293" class="edge">
<title>scan_ontology.main&#45;&gt;log_utils.install_excepthook</title>
<path fill="none" stroke="black" d="M5772.13,-2191.35C5912.08,-2193.11 6089.86,-2195.35 6223.77,-2197.03"/>
<polygon fill="black" stroke="black" points="6224.1,-2200.54 6234.14,-2197.16 6224.19,-2193.54 6224.1,-2200.54"/>
</g>
<!-- scan_ontology.main&#45;&gt;scan_ontology.collect_ontology -->
<g id="edge294" class="edge">
<title>scan_ontology.main&#45;&gt;scan_ontology.collect_ontology</title>
<path fill="none" stroke="black" d="M5604.45,-2159.9C5672.3,-2124.91 5784.34,-2060.6 5862,-1982.5 5882.86,-1961.52 5872.66,-1941.78 5898,-1926.5 5915.57,-1915.9 5934.1,-1906.82 5953.28,-1899.08"/>
<polygon fill="black" stroke="black" points="5954.7,-1902.28 5962.74,-1895.38 5952.16,-1895.76 5954.7,-1902.28"/>
</g>
<!-- pending_chop.main -->
<g id="node171" class="node">
<title>pending_chop.main</title>
<polygon fill="none" stroke="black" points="7688.5,-947.5 7361.5,-947.5 7361.5,-905.5 7688.5,-905.5 7688.5,-947.5"/>
<text text-anchor="middle" x="7525" y="-918.41" font-family="Times,serif" font-size="31.36">pending_chop.main</text>
</g>
<!-- pending_chop.main&#45;&gt;moderation.should_skip_message -->
<g id="edge295" class="edge">
<title>pending_chop.main&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M7688.55,-934.01C7796.72,-939.37 7941.93,-947.24 8070,-956.5 8174.81,-964.07 8292.01,-974.48 8385.72,-983.27"/>
<polygon fill="black" stroke="black" points="8385.58,-986.77 8395.87,-984.22 8386.24,-979.8 8385.58,-986.77"/>
</g>
<!-- pending_chop.main&#45;&gt;post_io.read_post -->
<g id="edge296" class="edge">
<title>pending_chop.main&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7688.72,-912.91C7829.19,-905.09 8017.55,-905.28 8070,-956.5 8142.72,-1027.52 8034.99,-1339.77 8106,-1412.5 8150.2,-1457.77 8210.92,-1479.46 8273.64,-1487.84"/>
<polygon fill="black" stroke="black" points="8273.37,-1491.33 8283.72,-1489.07 8274.22,-1484.39 8273.37,-1491.33"/>
</g>
<!-- pending_caption._get_message_path -->
<g id="node172" class="node">
<title>pending_caption._get_message_path</title>
<g id="a_node172"><a xlink:title="Return path of stored message ``msg_id`` in ``chat`` if any.">
<polygon fill="none" stroke="black" points="8713.5,-673.5 8412.5,-673.5 8412.5,-637.5 8713.5,-637.5 8713.5,-673.5"/>
<text text-anchor="middle" x="8563" y="-651.46" font-family="Times,serif" font-size="15.68">pending_caption._get_message_path</text>
</a>
</g>
</g>
<!-- pending_caption.main -->
<g id="node173" class="node">
<title>pending_caption.main</title>
<polygon fill="none" stroke="black" points="6655,-1028.5 6187,-1028.5 6187,-976.5 6655,-976.5 6655,-1028.5"/>
<text text-anchor="middle" x="6421" y="-992.36" font-family="Times,serif" font-size="40.18">pending_caption.main</text>
</g>
<!-- pending_caption.main&#45;&gt;moderation.should_skip_message -->
<g id="edge299" class="edge">
<title>pending_caption.main&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M6588.63,-1028.5C6698.07,-1036.77 6839.72,-1029.93 6944,-962.5 6972.06,-944.36 6951.27,-913.56 6980,-896.5 7032.07,-865.59 8016.49,-868.16 8070,-896.5 8095.16,-909.83 8081.62,-934.79 8106,-949.5 8189.09,-999.62 8296.35,-1013.59 8385.96,-1014.46"/>
<polygon fill="black" stroke="black" points="8385.95,-1017.96 8395.96,-1014.51 8385.98,-1010.96 8385.95,-1017.96"/>
</g>
<!-- pending_caption.main&#45;&gt;post_io.read_post -->
<g id="edge300" class="edge">
<title>pending_caption.main&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M6655.08,-1007.05C7106.51,-1016.12 8057.23,-1036.6 8070,-1048.5 8129.47,-1103.91 8048.64,-1354.91 8106,-1412.5 8150.51,-1457.2 8211.17,-1478.72 8273.71,-1487.14"/>
<polygon fill="black" stroke="black" points="8273.41,-1490.63 8283.77,-1488.38 8274.27,-1483.68 8273.41,-1490.63"/>
</g>
<!-- pending_caption.main&#45;&gt;caption_io.has_caption -->
<g id="edge297" class="edge">
<title>pending_caption.main&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M6655.25,-983.38C6758.71,-988.29 6872.88,-1014.59 6944,-1094.5 7035.32,-1197.09 6881.8,-1615.48 6980,-1711.5 7066.65,-1796.22 7982.86,-1666.28 8070,-1750.5 8152.34,-1830.07 8027.27,-2181.36 8106,-2264.5 8199.71,-2363.45 8371.38,-2355.73 8475.25,-2339.64"/>
<polygon fill="black" stroke="black" points="8476.08,-2343.05 8485.4,-2338 8474.97,-2336.14 8476.08,-2343.05"/>
</g>
<!-- pending_caption.main&#45;&gt;image_io.read_image_meta -->
<g id="edge298" class="edge">
<title>pending_caption.main&#45;&gt;image_io.read_image_meta</title>
<path fill="none" stroke="black" d="M6655.03,-998.48C6882.54,-994.56 7220.01,-988.74 7400.12,-985.64"/>
<polygon fill="black" stroke="black" points="7400.23,-989.13 7410.17,-985.46 7400.11,-982.14 7400.23,-989.13"/>
</g>
<!-- pending_caption.main&#45;&gt;pending_caption._get_message_path -->
<g id="edge301" class="edge">
<title>pending_caption.main&#45;&gt;pending_caption._get_message_path</title>
<path fill="none" stroke="black" d="M6523.39,-1028.53C6640.98,-1052.02 6832.88,-1068.55 6944,-962.5 7038.27,-872.52 6882.79,-758.3 6980,-671.5 7032.37,-624.74 8010.58,-642.47 8402.04,-651.5"/>
<polygon fill="black" stroke="black" points="8402.24,-655.01 8412.32,-651.74 8402.4,-648.01 8402.24,-655.01"/>
</g>
<!-- check_translations.parse_po -->
<g id="node174" class="node">
<title>check_translations.parse_po</title>
<polygon fill="none" stroke="black" points="1667.5,-5610.5 1083.5,-5610.5 1083.5,-5558.5 1667.5,-5558.5 1667.5,-5610.5"/>
<text text-anchor="middle" x="1375.5" y="-5574.8" font-family="Times,serif" font-size="39.62">check_translations.parse_po</text>
</g>
<!-- check_translations.check_translations -->
<g id="node175" class="node">
<title>check_translations.check_translations</title>
<polygon fill="none" stroke="black" points="983,-5607 318,-5607 318,-5562 983,-5562 983,-5607"/>
<text text-anchor="middle" x="650.5" y="-5576.12" font-family="Times,serif" font-size="33.60">check_translations.check_translations</text>
</g>
<!-- check_translations.check_translations&#45;&gt;check_translations.parse_po -->
<g id="edge302" class="edge">
<title>check_translations.check_translations&#45;&gt;check_translations.parse_po</title>
<path fill="none" stroke="black" d="M983.11,-5584.5C1013.14,-5584.5 1043.45,-5584.5 1073.19,-5584.5"/>
<polygon fill="black" stroke="black" points="1073.26,-5588 1083.26,-5584.5 1073.26,-5581 1073.26,-5588"/>
</g>
<!-- pending_embed._needs_embedding -->
<g id="node176" class="node">
<title>pending_embed._needs_embedding</title>
<g id="a_node176"><a xlink:title="Return ``True`` when ``emb`` is missing or stale.&#10;&#10;The function also upgrades older vector files stored as a single object and&#10;removes corrupted or mismatched ones so ``embed.py`` always operates on&#10;clean data.">
<polygon fill="none" stroke="black" points="7934,-2953 7116,-2953 7116,-2896 7934,-2896 7934,-2953"/>
<text text-anchor="middle" x="7525" y="-2913.16" font-family="Times,serif" font-size="44.80">pending_embed._needs_embedding</text>
</a>
</g>
</g>
<!-- pending_embed._needs_embedding&#45;&gt;notes_utils.load_json -->
<g id="edge303" class="edge">
<title>pending_embed._needs_embedding&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M7934.05,-2949.42C8346,-2977.86 8933.54,-3028.65 9020,-3091.5 9278.41,-3279.34 9346.62,-3708.05 9360.47,-3822.16"/>
<polygon fill="black" stroke="black" points="9357.01,-3822.68 9361.64,-3832.21 9363.96,-3821.87 9357.01,-3822.68"/>
</g>
<!-- pending_embed._needs_embedding&#45;&gt;notes_utils.write_json -->
<g id="edge304" class="edge">
<title>pending_embed._needs_embedding&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M7934.34,-2921.74C8124.98,-2920.45 8336.39,-2919.02 8458.77,-2918.2"/>
<polygon fill="black" stroke="black" points="8458.9,-2921.7 8468.87,-2918.13 8458.85,-2914.7 8458.9,-2921.7"/>
</g>
<!-- pending_embed.main -->
<g id="node177" class="node">
<title>pending_embed.main</title>
<polygon fill="none" stroke="black" points="5806.5,-1973.5 5282.5,-1973.5 5282.5,-1913.5 5806.5,-1913.5 5806.5,-1973.5"/>
<text text-anchor="middle" x="5544.5" y="-1931.98" font-family="Times,serif" font-size="46.90">pending_embed.main</text>
</g>
<!-- pending_embed.main&#45;&gt;lot_io.read_lots -->
<g id="edge307" class="edge">
<title>pending_embed.main&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M5621.02,-1913.47C5691.4,-1887.21 5799.94,-1851.05 5898,-1836.5 6357.85,-1768.24 6568.68,-1562.17 6944,-1836.5 6986.55,-1867.6 6937.94,-1917.74 6980,-1949.5 7076.7,-2022.52 7959.77,-1933.18 8070,-1983.5 8091.46,-1993.3 8084.69,-2012.38 8106,-2022.5 8213.26,-2073.43 8351.01,-2074.37 8446.91,-2066.37"/>
<polygon fill="black" stroke="black" points="8447.27,-2069.85 8456.93,-2065.49 8446.66,-2062.88 8447.27,-2069.85"/>
</g>
<!-- pending_embed.main&#45;&gt;lot_io.iter_lot_files -->
<g id="edge309" class="edge">
<title>pending_embed.main&#45;&gt;lot_io.iter_lot_files</title>
<path fill="none" stroke="black" d="M5585.02,-1973.6C5647.46,-2019.05 5774.53,-2103.2 5898,-2134.5 6014.97,-2164.15 7972.4,-2205.45 8070,-2134.5 8111.95,-2104 8065,-2055.27 8106,-2023.5 8212.68,-1940.83 8379,-1955.69 8478.55,-1974.95"/>
<polygon fill="black" stroke="black" points="8478.07,-1978.42 8488.57,-1976.94 8479.44,-1971.56 8478.07,-1978.42"/>
</g>
<!-- pending_embed.main&#45;&gt;post_io.read_post -->
<g id="edge310" class="edge">
<title>pending_embed.main&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M5579.51,-1913.37C5639.65,-1861.55 5770.51,-1755.28 5898,-1694.5 6349,-1479.49 6485.08,-1457.92 6980,-1389.5 7099.97,-1372.91 7953.75,-1355.53 8070,-1389.5 8088.22,-1394.82 8088.07,-1406.25 8106,-1412.5 8158.81,-1430.92 8217,-1442.77 8273.62,-1450.27"/>
<polygon fill="black" stroke="black" points="8273.44,-1453.77 8283.8,-1451.57 8274.33,-1446.83 8273.44,-1453.77"/>
</g>
<!-- pending_embed.main&#45;&gt;moderation.message_skip_reason -->
<g id="edge305" class="edge">
<title>pending_embed.main&#45;&gt;moderation.message_skip_reason</title>
<path fill="none" stroke="black" d="M5558.29,-1913.36C5605.95,-1799.77 5775.02,-1385.96 5862,-1029.5 5875.1,-975.83 5861.51,-824.98 5898,-783.5 6216.88,-421.02 6493.61,-664.35 6944,-490.5 6960.69,-484.06 6962.65,-476.87 6980,-472.5 7176.14,-423.15 8461.84,-408.35 9059.27,-404.11"/>
<polygon fill="black" stroke="black" points="9059.35,-407.61 9069.33,-404.04 9059.3,-400.61 9059.35,-407.61"/>
</g>
<!-- pending_embed.main&#45;&gt;moderation.lot_skip_reason -->
<g id="edge306" class="edge">
<title>pending_embed.main&#45;&gt;moderation.lot_skip_reason</title>
<path fill="none" stroke="black" d="M5555.31,-1913.45C5607.98,-1752.44 5856.48,-997.94 5898,-967.5 5991.81,-898.72 6858.38,-1003.24 6944,-924.5 7038.63,-837.48 6883.95,-722.94 6980,-637.5 7022.34,-599.84 8970.56,-600.8 9020,-628.5 9235.11,-749.02 9331.71,-1065.29 9356.69,-1161.4"/>
<polygon fill="black" stroke="black" points="9353.34,-1162.43 9359.2,-1171.26 9360.13,-1160.7 9353.34,-1162.43"/>
</g>
<!-- pending_embed.main&#45;&gt;lot_io.embedding_path -->
<g id="edge308" class="edge">
<title>pending_embed.main&#45;&gt;lot_io.embedding_path</title>
<path fill="none" stroke="black" d="M5605.43,-1973.62C5674.15,-2006.53 5791.11,-2057.58 5898,-2080.5 6035.32,-2109.94 6197.38,-2113.65 6304.08,-2111.98"/>
<polygon fill="black" stroke="black" points="6304.29,-2115.48 6314.23,-2111.81 6304.17,-2108.48 6304.29,-2115.48"/>
</g>
<!-- pending_embed.main&#45;&gt;post_io.raw_post_path_from_lot -->
<g id="edge311" class="edge">
<title>pending_embed.main&#45;&gt;post_io.raw_post_path_from_lot</title>
<path fill="none" stroke="black" d="M5632.03,-1973.53C5707.57,-2004.84 5812.63,-2061.89 5862,-2150.5 5900.95,-2220.41 5844.83,-3530.69 5898,-3590.5 6054.01,-3766 6726.28,-3652.54 6944,-3740.5 6962.3,-3747.89 6961.38,-3759.96 6980,-3766.5 7105.89,-3810.68 7258.26,-3814.37 7369.68,-3808.77"/>
<polygon fill="black" stroke="black" points="7370.2,-3812.25 7380,-3808.22 7369.82,-3805.26 7370.2,-3812.25"/>
</g>
<!-- pending_embed.main&#45;&gt;pending_embed._needs_embedding -->
<g id="edge312" class="edge">
<title>pending_embed.main&#45;&gt;pending_embed._needs_embedding</title>
<path fill="none" stroke="black" d="M5630.67,-1973.58C5705.83,-2005.07 5811.13,-2062.36 5862,-2150.5 5898.16,-2213.15 5847.39,-2748.82 5898,-2800.5 6060.15,-2966.06 6679.88,-2970.58 7105.63,-2952.32"/>
<polygon fill="black" stroke="black" points="7105.81,-2955.82 7115.65,-2951.89 7105.5,-2948.83 7105.81,-2955.82"/>
</g>
<!-- clean_data:cli -->
<g id="node179" class="node">
<title>clean_data:cli</title>
<g id="a_node179"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="1986" cy="-5522.5" rx="37.29" ry="18"/>
<text text-anchor="middle" x="1986" y="-5520.9" font-family="Times,serif" font-size="7.00">clean_data:cli</text>
</a>
</g>
</g>
<!-- similar:cli&#45;&gt;clean_data:cli -->
<!-- chop:cli -->
<g id="node180" class="node">
<title>chop:cli</title>
<g id="a_node180"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="2606.5" cy="-5522.5" rx="27" ry="18"/>
<text text-anchor="middle" x="2606.5" y="-5520.9" font-family="Times,serif" font-size="7.00">chop:cli</text>
</a>
</g>
</g>
<!-- clean_data:cli&#45;&gt;chop:cli -->
<!-- build_site:cli -->
<g id="node181" class="node">
<title>build_site:cli</title>
<g id="a_node181"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="3211.5" cy="-5522.5" rx="34.71" ry="18"/>
<text text-anchor="middle" x="3211.5" y="-5520.9" font-family="Times,serif" font-size="7.00">build_site:cli</text>
</a>
</g>
</g>
<!-- chop:cli&#45;&gt;build_site:cli -->
<!-- tg_client:cli -->
<g id="node182" class="node">
<title>tg_client:cli</title>
<g id="a_node182"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="4058" cy="-5522.5" rx="32.86" ry="18"/>
<text text-anchor="middle" x="4058" y="-5520.9" font-family="Times,serif" font-size="7.00">tg_client:cli</text>
</a>
</g>
</g>
<!-- build_site:cli&#45;&gt;tg_client:cli -->
<!-- telegram_bot:cli -->
<g id="node183" class="node">
<title>telegram_bot:cli</title>
<g id="a_node183"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="141" cy="-5646.5" rx="111.95" ry="19.18"/>
<text text-anchor="middle" x="141" y="-5642.34" font-family="Times,serif" font-size="17.08">telegram_bot:cli</text>
</a>
</g>
</g>
<!-- debug_dump:cli -->
<g id="node184" class="node">
<title>debug_dump:cli</title>
<g id="a_node184"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="650.5" cy="-5646.5" rx="41.11" ry="18"/>
<text text-anchor="middle" x="650.5" y="-5644.9" font-family="Times,serif" font-size="7.00">debug_dump:cli</text>
</a>
</g>
</g>
<!-- telegram_bot:cli&#45;&gt;debug_dump:cli -->
<!-- moderation:cli -->
<g id="node185" class="node">
<title>moderation:cli</title>
<g id="a_node185"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="1375.5" cy="-5646.5" rx="38.53" ry="18"/>
<text text-anchor="middle" x="1375.5" y="-5644.9" font-family="Times,serif" font-size="7.00">moderation:cli</text>
</a>
</g>
</g>
<!-- debug_dump:cli&#45;&gt;moderation:cli -->
<!-- embed:cli -->
<g id="node186" class="node">
<title>embed:cli</title>
<g id="a_node186"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="1986" cy="-5646.5" rx="29.05" ry="18"/>
<text text-anchor="middle" x="1986" y="-5644.9" font-family="Times,serif" font-size="7.00">embed:cli</text>
</a>
</g>
</g>
<!-- moderation:cli&#45;&gt;embed:cli -->
<!-- caption:cli -->
<g id="node187" class="node">
<title>caption:cli</title>
<g id="a_node187"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="2606.5" cy="-5646.5" rx="30.28" ry="18"/>
<text text-anchor="middle" x="2606.5" y="-5644.9" font-family="Times,serif" font-size="7.00">caption:cli</text>
</a>
</g>
</g>
<!-- embed:cli&#45;&gt;caption:cli -->
<!-- scan_ontology:cli -->
<g id="node188" class="node">
<title>scan_ontology:cli</title>
<g id="a_node188"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="3211.5" cy="-5646.5" rx="44.19" ry="18"/>
<text text-anchor="middle" x="3211.5" y="-5644.9" font-family="Times,serif" font-size="7.00">scan_ontology:cli</text>
</a>
</g>
</g>
<!-- caption:cli&#45;&gt;scan_ontology:cli -->
<!-- pending_chop:cli -->
<g id="node189" class="node">
<title>pending_chop:cli</title>
<g id="a_node189"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="4058" cy="-5646.5" rx="42.96" ry="18"/>
<text text-anchor="middle" x="4058" y="-5644.9" font-family="Times,serif" font-size="7.00">pending_chop:cli</text>
</a>
</g>
</g>
<!-- scan_ontology:cli&#45;&gt;pending_chop:cli -->
<!-- pending_caption:cli -->
<g id="node190" class="node">
<title>pending_caption:cli</title>
<g id="a_node190"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="141" cy="-5701.5" rx="48.62" ry="18"/>
<text text-anchor="middle" x="141" y="-5699.9" font-family="Times,serif" font-size="7.00">pending_caption:cli</text>
</a>
</g>
</g>
<!-- check_translations:cli -->
<g id="node191" class="node">
<title>check_translations:cli</title>
<g id="a_node191"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="650.5" cy="-5701.5" rx="53.05" ry="18"/>
<text text-anchor="middle" x="650.5" y="-5699.9" font-family="Times,serif" font-size="7.00">check_translations:cli</text>
</a>
</g>
</g>
<!-- pending_caption:cli&#45;&gt;check_translations:cli -->
<!-- pending_embed:cli -->
<g id="node192" class="node">
<title>pending_embed:cli</title>
<g id="a_node192"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="1375.5" cy="-5701.5" rx="47.39" ry="18"/>
<text text-anchor="middle" x="1375.5" y="-5699.9" font-family="Times,serif" font-size="7.00">pending_embed:cli</text>
</a>
</g>
</g>
<!-- check_translations:cli&#45;&gt;pending_embed:cli -->
<!-- build_site -->
<g id="node193" class="node">
<title>build_site</title>
<ellipse fill="none" stroke="black" cx="4058" cy="-601.5" rx="55.79" ry="18"/>
<text text-anchor="middle" x="4058" y="-597.8" font-family="Times,serif" font-size="14.00">build_site</text>
</g>
<!-- build_site&#45;&gt;build_site.main -->
<g id="edge326" class="edge">
<title>build_site:cli&#45;&gt;build_site.main</title>
<path fill="none" stroke="black" d="M4114.12,-601.5C4233.9,-601.5 4523.52,-601.5 4727.09,-601.5"/>
<polygon fill="black" stroke="black" points="4727.32,-605 4737.32,-601.5 4727.32,-598 4727.32,-605"/>
</g>
<!-- caption -->
<g id="node194" class="node">
<title>caption</title>
<ellipse fill="none" stroke="black" cx="4946.5" cy="-3373.5" rx="44.69" ry="18"/>
<text text-anchor="middle" x="4946.5" y="-3369.8" font-family="Times,serif" font-size="14.00">caption</text>
</g>
<!-- caption&#45;&gt;caption.main -->
<g id="edge327" class="edge">
<title>caption:cli&#45;&gt;caption.main</title>
<path fill="none" stroke="black" d="M4990.36,-3369.11C5084.08,-3359.52 5309.37,-3336.46 5441.72,-3322.92"/>
<polygon fill="black" stroke="black" points="5442.28,-3326.38 5451.87,-3321.88 5441.57,-3319.41 5442.28,-3326.38"/>
</g>
<!-- check_translations -->
<g id="node195" class="node">
<title>check_translations</title>
<ellipse fill="none" stroke="black" cx="141" cy="-5584.5" rx="96.68" ry="18"/>
<text text-anchor="middle" x="141" y="-5580.8" font-family="Times,serif" font-size="14.00">check_translations</text>
</g>
<!-- check_translations&#45;&gt;check_translations.check_translations -->
<g id="edge328" class="edge">
<title>check_translations:cli&#45;&gt;check_translations.check_translations</title>
<path fill="none" stroke="black" d="M238.05,-5584.5C259.3,-5584.5 282.99,-5584.5 307.97,-5584.5"/>
<polygon fill="black" stroke="black" points="307.99,-5588 317.99,-5584.5 307.99,-5581 307.99,-5588"/>
</g>
<!-- chop -->
<g id="node196" class="node">
<title>chop</title>
<ellipse fill="none" stroke="black" cx="4946.5" cy="-2383.5" rx="32.49" ry="18"/>
<text text-anchor="middle" x="4946.5" y="-2379.8" font-family="Times,serif" font-size="14.00">chop</text>
</g>
<!-- chop&#45;&gt;chop.main -->
<g id="edge329" class="edge">
<title>chop:cli&#45;&gt;chop.main</title>
<path fill="none" stroke="black" d="M4979.12,-2383.5C5068.31,-2383.5 5324.07,-2383.5 5458.54,-2383.5"/>
<polygon fill="black" stroke="black" points="5458.8,-2387 5468.8,-2383.5 5458.8,-2380 5458.8,-2387"/>
</g>
<!-- clean_data -->
<g id="node197" class="node">
<title>clean_data</title>
<ellipse fill="none" stroke="black" cx="5544.5" cy="-3563.5" rx="59.59" ry="18"/>
<text text-anchor="middle" x="5544.5" y="-3559.8" font-family="Times,serif" font-size="14.00">clean_data</text>
</g>
<!-- clean_data&#45;&gt;clean_data.main -->
<g id="edge330" class="edge">
<title>clean_data:cli&#45;&gt;clean_data.main</title>
<path fill="none" stroke="black" d="M5604.58,-3563.5C5750.48,-3563.5 6129.43,-3563.5 6314.79,-3563.5"/>
<polygon fill="black" stroke="black" points="6314.83,-3567 6324.83,-3563.5 6314.83,-3560 6314.83,-3567"/>
</g>
<!-- debug_dump -->
<g id="node198" class="node">
<title>debug_dump</title>
<ellipse fill="none" stroke="black" cx="5544.5" cy="-5082.5" rx="70.39" ry="18"/>
<text text-anchor="middle" x="5544.5" y="-5078.8" font-family="Times,serif" font-size="14.00">debug_dump</text>
</g>
<!-- debug_dump&#45;&gt;debug_dump.main -->
<g id="edge331" class="edge">
<title>debug_dump:cli&#45;&gt;debug_dump.main</title>
<path fill="none" stroke="black" d="M5614.85,-5082.5C5733.92,-5082.5 5982.7,-5082.5 6172.4,-5082.5"/>
<polygon fill="black" stroke="black" points="6172.53,-5086 6182.53,-5082.5 6172.53,-5079 6172.53,-5086"/>
</g>
<!-- embed -->
<g id="node199" class="node">
<title>embed</title>
<ellipse fill="none" stroke="black" cx="5544.5" cy="-2719.5" rx="42.49" ry="18"/>
<text text-anchor="middle" x="5544.5" y="-2715.8" font-family="Times,serif" font-size="14.00">embed</text>
</g>
<!-- embed&#45;&gt;embed.main -->
<g id="edge332" class="edge">
<title>embed:cli&#45;&gt;embed.main</title>
<path fill="none" stroke="black" d="M5586.8,-2719.5C5718.69,-2719.5 6132.27,-2719.5 6322.5,-2719.5"/>
<polygon fill="black" stroke="black" points="6322.77,-2723 6332.77,-2719.5 6322.77,-2716 6322.77,-2723"/>
</g>
<!-- moderation -->
<g id="node200" class="node">
<title>moderation</title>
<ellipse fill="none" stroke="black" cx="6421" cy="-1248.5" rx="63.89" ry="18"/>
<text text-anchor="middle" x="6421" y="-1244.8" font-family="Times,serif" font-size="14.00">moderation</text>
</g>
<!-- moderation&#45;&gt;moderation.apply_to_history -->
<g id="edge333" class="edge">
<title>moderation:cli&#45;&gt;moderation.apply_to_history</title>
<path fill="none" stroke="black" d="M6484.81,-1248.5C6631.16,-1248.5 7001.91,-1248.5 7258.52,-1248.5"/>
<polygon fill="black" stroke="black" points="7258.74,-1252 7268.74,-1248.5 7258.74,-1245 7258.74,-1252"/>
</g>
<!-- pending_caption -->
<g id="node201" class="node">
<title>pending_caption</title>
<ellipse fill="none" stroke="black" cx="5544.5" cy="-1002.5" rx="87.18" ry="18"/>
<text text-anchor="middle" x="5544.5" y="-998.8" font-family="Times,serif" font-size="14.00">pending_caption</text>
</g>
<!-- pending_caption&#45;&gt;pending_caption.main -->
<g id="edge334" class="edge">
<title>pending_caption:cli&#45;&gt;pending_caption.main</title>
<path fill="none" stroke="black" d="M5631.74,-1002.5C5757.24,-1002.5 5995.02,-1002.5 6176.74,-1002.5"/>
<polygon fill="black" stroke="black" points="6176.98,-1006 6186.98,-1002.5 6176.98,-999 6176.98,-1006"/>
</g>
<!-- pending_chop -->
<g id="node202" class="node">
<title>pending_chop</title>
<ellipse fill="none" stroke="black" cx="6421" cy="-810.5" rx="74.99" ry="18"/>
<text text-anchor="middle" x="6421" y="-806.8" font-family="Times,serif" font-size="14.00">pending_chop</text>
</g>
<!-- pending_chop&#45;&gt;pending_chop.main -->
<g id="edge335" class="edge">
<title>pending_chop:cli&#45;&gt;pending_chop.main</title>
<path fill="none" stroke="black" d="M6493.67,-806.04C6595.37,-801.54 6786.69,-799.84 6944,-837.5 6961.03,-841.58 6963.15,-848.73 6980,-853.5 7101.59,-887.91 7243.18,-906.26 7351.43,-915.95"/>
<polygon fill="black" stroke="black" points="7351.2,-919.45 7361.47,-916.84 7351.81,-912.47 7351.2,-919.45"/>
</g>
<!-- pending_embed -->
<g id="node203" class="node">
<title>pending_embed</title>
<ellipse fill="none" stroke="black" cx="4946.5" cy="-1943.5" rx="83.69" ry="18"/>
<text text-anchor="middle" x="4946.5" y="-1939.8" font-family="Times,serif" font-size="14.00">pending_embed</text>
</g>
<!-- pending_embed&#45;&gt;pending_embed.main -->
<g id="edge336" class="edge">
<title>pending_embed:cli&#45;&gt;pending_embed.main</title>
<path fill="none" stroke="black" d="M5030.37,-1943.5C5093.58,-1943.5 5184.45,-1943.5 5272.21,-1943.5"/>
<polygon fill="black" stroke="black" points="5272.34,-1947 5282.34,-1943.5 5272.34,-1940 5272.34,-1947"/>
</g>
<!-- price_train -->
<g id="node204" class="node">
<title>price_train</title>
<ellipse fill="none" stroke="black" cx="5544.5" cy="-2773.5" rx="61.19" ry="18"/>
<text text-anchor="middle" x="5544.5" y="-2769.8" font-family="Times,serif" font-size="14.00">price_train</text>
</g>
<!-- price_train&#45;&gt;price_train.main -->
<g id="edge337" class="edge">
<title>price_train:cli&#45;&gt;price_train.main</title>
<path fill="none" stroke="black" d="M5605.61,-2773.5C5747.39,-2773.5 6105.08,-2773.5 6295.78,-2773.5"/>
<polygon fill="black" stroke="black" points="6295.86,-2777 6305.86,-2773.5 6295.86,-2770 6295.86,-2777"/>
</g>
<!-- scan_ontology -->
<g id="node205" class="node">
<title>scan_ontology</title>
<ellipse fill="none" stroke="black" cx="4946.5" cy="-2188.5" rx="76.09" ry="18"/>
<text text-anchor="middle" x="4946.5" y="-2184.8" font-family="Times,serif" font-size="14.00">scan_ontology</text>
</g>
<!-- scan_ontology&#45;&gt;scan_ontology.main -->
<g id="edge338" class="edge">
<title>scan_ontology:cli&#45;&gt;scan_ontology.main</title>
<path fill="none" stroke="black" d="M5022.68,-2188.5C5094.08,-2188.5 5205.26,-2188.5 5306.6,-2188.5"/>
<polygon fill="black" stroke="black" points="5306.69,-2192 5316.69,-2188.5 5306.69,-2185 5306.69,-2192"/>
</g>
<!-- similar -->
<g id="node206" class="node">
<title>similar</title>
<ellipse fill="none" stroke="black" cx="5544.5" cy="-4674.5" rx="42.79" ry="18"/>
<text text-anchor="middle" x="5544.5" y="-4670.8" font-family="Times,serif" font-size="14.00">similar</text>
</g>
<!-- similar&#45;&gt;similar.main -->
<g id="edge339" class="edge">
<title>similar:cli&#45;&gt;similar.main</title>
<path fill="none" stroke="black" d="M5587.68,-4674.5C5716.7,-4674.5 6109.21,-4674.5 6305.58,-4674.5"/>
<polygon fill="black" stroke="black" points="6305.64,-4678 6315.64,-4674.5 6305.64,-4671 6305.64,-4678"/>
</g>
<!-- telegram_bot -->
<g id="node207" class="node">
<title>telegram_bot</title>
<ellipse fill="none" stroke="black" cx="4058" cy="-5347.5" rx="72.29" ry="18"/>
<text text-anchor="middle" x="4058" y="-5343.8" font-family="Times,serif" font-size="14.00">telegram_bot</text>
</g>
<!-- telegram_bot&#45;&gt;telegram_bot.send_alert -->
<g id="edge340" class="edge">
<title>telegram_bot:cli&#45;&gt;telegram_bot.send_alert</title>
<path fill="none" stroke="black" d="M4129.67,-5349.81C4267.46,-5354.32 4575.61,-5364.4 4771.27,-5370.8"/>
<polygon fill="black" stroke="black" points="4771.27,-5374.3 4781.37,-5371.13 4771.49,-5367.31 4771.27,-5374.3"/>
</g>
<!-- telegram_bot&#45;&gt;telegram_bot.main -->
<g id="edge341" class="edge">
<title>telegram_bot:cli&#45;&gt;telegram_bot.main</title>
<path fill="none" stroke="black" d="M4129.67,-5345.19C4267.36,-5340.68 4575.16,-5330.61 4770.84,-5324.21"/>
<polygon fill="black" stroke="black" points="4771.07,-5327.71 4780.95,-5323.88 4770.84,-5320.71 4771.07,-5327.71"/>
</g>
<!-- tg_client -->
<g id="node208" class="node">
<title>tg_client</title>
<ellipse fill="none" stroke="black" cx="141" cy="-4178.5" rx="50.89" ry="18"/>
<text text-anchor="middle" x="141" y="-4174.8" font-family="Times,serif" font-size="14.00">tg_client</text>
</g>
<!-- tg_client&#45;&gt;tg_client.main -->
<g id="edge342" class="edge">
<title>tg_client:cli&#45;&gt;tg_client.main</title>
<path fill="none" stroke="black" d="M192.05,-4178.5C232.34,-4178.5 292.58,-4178.5 356.22,-4178.5"/>
<polygon fill="black" stroke="black" points="356.46,-4182 366.46,-4178.5 356.46,-4175 356.46,-4182"/>
</g>
</g>
</svg>
