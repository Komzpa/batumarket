<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: callgraph Pages: 1 -->
<svg width="9995pt" height="4916pt"
 viewBox="0.00 0.00 9995.00 4915.78" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 4911.78)">
<title>callgraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-4911.78 9991,-4911.78 9991,4 -4,4"/>
<!-- telegram_bot._t -->
<g id="node1" class="node">
<title>telegram_bot._t</title>
<g id="a_node1"><a xlink:title="Return ``text`` translated to ``lang`` using gettext files.">
<polygon fill="none" stroke="black" points="5606.5,-3029.3 5398.5,-3029.3 5398.5,-2993.3 5606.5,-2993.3 5606.5,-3029.3"/>
<text text-anchor="middle" x="5502.5" y="-3005.43" font-family="Times,serif" font-size="24.22">telegram_bot._t</text>
</a>
</g>
</g>
<!-- telegram_bot.ensure_profile -->
<g id="node2" class="node">
<title>telegram_bot.ensure_profile</title>
<g id="a_node2"><a xlink:title="Return profile for ``uid`` creating one if needed.">
<polygon fill="none" stroke="black" points="5653.5,-2975.3 5351.5,-2975.3 5351.5,-2939.3 5653.5,-2939.3 5653.5,-2975.3"/>
<text text-anchor="middle" x="5502.5" y="-2952.51" font-family="Times,serif" font-size="19.74">telegram_bot.ensure_profile</text>
</a>
</g>
</g>
<!-- telegram_bot.save_profiles -->
<g id="node3" class="node">
<title>telegram_bot.save_profiles</title>
<g id="a_node3"><a xlink:title="Write ``profiles`` to disk.">
<polygon fill="none" stroke="black" points="6419,-2929.3 6211,-2929.3 6211,-2893.3 6419,-2893.3 6419,-2929.3"/>
<text text-anchor="middle" x="6315" y="-2907.6" font-family="Times,serif" font-size="14.00">telegram_bot.save_profiles</text>
</a>
</g>
</g>
<!-- telegram_bot.ensure_profile&#45;&gt;telegram_bot.save_profiles -->
<g id="edge1" class="edge">
<title>telegram_bot.ensure_profile&#45;&gt;telegram_bot.save_profiles</title>
<path fill="none" stroke="black" d="M5653.58,-2948.79C5811.88,-2939.8 6057.77,-2925.85 6200.61,-2917.74"/>
<polygon fill="black" stroke="black" points="6200.93,-2921.23 6210.72,-2917.17 6200.54,-2914.24 6200.93,-2921.23"/>
</g>
<!-- telegram_bot.load_profiles -->
<g id="node4" class="node">
<title>telegram_bot.load_profiles</title>
<g id="a_node4"><a xlink:title="Populate the global ``profiles`` mapping.">
<polygon fill="none" stroke="black" points="5653.5,-929.3 5351.5,-929.3 5351.5,-893.3 5653.5,-893.3 5653.5,-929.3"/>
<text text-anchor="middle" x="5502.5" y="-906" font-family="Times,serif" font-size="21.00">telegram_bot.load_profiles</text>
</a>
</g>
</g>
<!-- notes_utils.read_text -->
<g id="node5" class="node">
<title>notes_utils.read_text</title>
<g id="a_node5"><a xlink:title="Return file contents as UTF&#45;8 or empty string when missing.">
<polygon fill="none" stroke="black" points="9877.5,-1298.3 9663.5,-1298.3 9663.5,-1262.3 9877.5,-1262.3 9877.5,-1298.3"/>
<text text-anchor="middle" x="9770.5" y="-1275.52" font-family="Times,serif" font-size="18.48">notes_utils.read_text</text>
</a>
</g>
</g>
<!-- telegram_bot.load_profiles&#45;&gt;notes_utils.read_text -->
<g id="edge2" class="edge">
<title>telegram_bot.load_profiles&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M5535.73,-893.14C5590.74,-863.25 5707.18,-804.77 5814,-782.3 6138.97,-713.97 6975.93,-751.3 7308,-751.3 7308,-751.3 7308,-751.3 8348,-751.3 8478.02,-751.3 9408.15,-699.76 9518,-769.3 9563.68,-798.22 9714.88,-1150.72 9757.96,-1252.79"/>
<polygon fill="black" stroke="black" points="9754.78,-1254.27 9761.89,-1262.13 9761.24,-1251.55 9754.78,-1254.27"/>
</g>
<!-- notes_utils.read_text&#45;&gt;notes_utils.read_text -->
<g id="edge235" class="edge">
<title>notes_utils.read_text&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M9671.72,-1298.46C9656.53,-1307.84 9689.45,-1316.3 9770.5,-1316.3 9821.15,-1316.3 9853.01,-1313 9866.07,-1308.23"/>
<polygon fill="black" stroke="black" points="9869.48,-1309.05 9869.28,-1298.46 9862.83,-1306.87 9869.48,-1309.05"/>
</g>
<!-- telegram_bot.load_state -->
<g id="node6" class="node">
<title>telegram_bot.load_state</title>
<g id="a_node6"><a xlink:title="Populate ``processed_ids`` from ``STATE_PATH``.">
<polygon fill="none" stroke="black" points="5646,-983.3 5359,-983.3 5359,-947.3 5646,-947.3 5646,-983.3"/>
<text text-anchor="middle" x="5502.5" y="-959.61" font-family="Times,serif" font-size="22.12">telegram_bot.load_state</text>
</a>
</g>
</g>
<!-- telegram_bot.load_state&#45;&gt;notes_utils.read_text -->
<g id="edge3" class="edge">
<title>telegram_bot.load_state&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M5646.05,-978.46C5691.81,-975.95 5740.34,-965.49 5778,-938.3 5809.94,-915.24 5781.46,-879.52 5814,-857.3 5951.24,-763.61 7141.83,-789.3 7308,-789.3 7308,-789.3 7308,-789.3 8348,-789.3 8478.02,-789.3 9407.07,-740.49 9518,-808.3 9685.89,-910.95 9748.17,-1167.14 9764.63,-1252.29"/>
<polygon fill="black" stroke="black" points="9761.22,-1253.07 9766.5,-1262.25 9768.1,-1251.78 9761.22,-1253.07"/>
</g>
<!-- telegram_bot.save_state -->
<g id="node7" class="node">
<title>telegram_bot.save_state</title>
<polygon fill="none" stroke="black" points="6399,-1714.3 6231,-1714.3 6231,-1678.3 6399,-1678.3 6399,-1714.3"/>
<text text-anchor="middle" x="6315" y="-1693.06" font-family="Times,serif" font-size="12.18">telegram_bot.save_state</text>
</g>
<!-- telegram_bot.scan_embeddings -->
<g id="node8" class="node">
<title>telegram_bot.scan_embeddings</title>
<g id="a_node8"><a xlink:title="Load new embeddings and return list of new lot ids.">
<polygon fill="none" stroke="black" points="7455,-1005.3 7163,-1005.3 7163,-969.3 7455,-969.3 7455,-1005.3"/>
<text text-anchor="middle" x="7309" y="-983.14" font-family="Times,serif" font-size="17.08">telegram_bot.scan_embeddings</text>
</a>
</g>
</g>
<!-- similar_utils._load_embeddings -->
<g id="node9" class="node">
<title>similar_utils._load_embeddings</title>
<g id="a_node9"><a xlink:title="Return mapping of lot id to embedding vector.">
<polygon fill="none" stroke="black" points="8603,-1017.3 8091,-1017.3 8091,-975.3 8603,-975.3 8603,-1017.3"/>
<text text-anchor="middle" x="8347" y="-988.22" font-family="Times,serif" font-size="31.36">similar_utils._load_embeddings</text>
</a>
</g>
</g>
<!-- telegram_bot.scan_embeddings&#45;&gt;similar_utils._load_embeddings -->
<g id="edge4" class="edge">
<title>telegram_bot.scan_embeddings&#45;&gt;similar_utils._load_embeddings</title>
<path fill="none" stroke="black" d="M7455.14,-988.57C7616.9,-989.97 7881.85,-992.27 8080.84,-994"/>
<polygon fill="black" stroke="black" points="8080.83,-997.5 8090.86,-994.09 8080.89,-990.5 8080.83,-997.5"/>
</g>
<!-- notes_utils.load_json -->
<g id="node25" class="node">
<title>notes_utils.load_json</title>
<g id="a_node25"><a xlink:title="Return parsed JSON or ``None`` when invalid.">
<polygon fill="none" stroke="black" points="9347,-1767.3 9099,-1767.3 9099,-1731.3 9347,-1731.3 9347,-1767.3"/>
<text text-anchor="middle" x="9223" y="-1743.61" font-family="Times,serif" font-size="22.12">notes_utils.load_json</text>
</a>
</g>
</g>
<!-- similar_utils._load_embeddings&#45;&gt;notes_utils.load_json -->
<g id="edge29" class="edge">
<title>similar_utils._load_embeddings&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M8603.34,-995.27C8708.49,-1008.92 8821.88,-1044.58 8892,-1128.3 8975.34,-1227.82 8839.34,-1616.5 8928,-1711.3 8968.21,-1754.3 9031.18,-1766.46 9088.55,-1766.76"/>
<polygon fill="black" stroke="black" points="9088.84,-1770.25 9098.81,-1766.68 9088.79,-1763.25 9088.84,-1770.25"/>
</g>
<!-- telegram_bot._should_suggest -->
<g id="node10" class="node">
<title>telegram_bot._should_suggest</title>
<polygon fill="none" stroke="black" points="6476.5,-1768.3 6153.5,-1768.3 6153.5,-1732.3 6476.5,-1732.3 6476.5,-1768.3"/>
<text text-anchor="middle" x="6315" y="-1745.51" font-family="Times,serif" font-size="19.74">telegram_bot._should_suggest</text>
</g>
<!-- similar_utils._cos_sim -->
<g id="node11" class="node">
<title>similar_utils._cos_sim</title>
<g id="a_node11"><a xlink:title="Return cosine similarity between two embeddings.">
<polygon fill="none" stroke="black" points="7425.5,-1406.3 7192.5,-1406.3 7192.5,-1370.3 7425.5,-1370.3 7425.5,-1406.3"/>
<text text-anchor="middle" x="7309" y="-1383.51" font-family="Times,serif" font-size="19.74">similar_utils._cos_sim</text>
</a>
</g>
</g>
<!-- telegram_bot._should_suggest&#45;&gt;similar_utils._cos_sim -->
<g id="edge5" class="edge">
<title>telegram_bot._should_suggest&#45;&gt;similar_utils._cos_sim</title>
<path fill="none" stroke="black" d="M6476.79,-1763.16C6604.17,-1769.55 6768.36,-1768.06 6816,-1723.3 6916.45,-1628.94 6751.8,-1509.93 6852,-1415.3 6897.98,-1371.89 7063.63,-1372.09 7182.02,-1378.41"/>
<polygon fill="black" stroke="black" points="7182.06,-1381.92 7192.24,-1378.98 7182.45,-1374.93 7182.06,-1381.92"/>
</g>
<!-- telegram_bot.enqueue_new_ids -->
<g id="node12" class="node">
<title>telegram_bot.enqueue_new_ids</title>
<polygon fill="none" stroke="black" points="5741,-1794.3 5264,-1794.3 5264,-1754.3 5741,-1754.3 5741,-1794.3"/>
<text text-anchor="middle" x="5502.5" y="-1767.23" font-family="Times,serif" font-size="28.84">telegram_bot.enqueue_new_ids</text>
</g>
<!-- telegram_bot.enqueue_new_ids&#45;&gt;telegram_bot.save_profiles -->
<g id="edge6" class="edge">
<title>telegram_bot.enqueue_new_ids&#45;&gt;telegram_bot.save_profiles</title>
<path fill="none" stroke="black" d="M5741.25,-1775.81C5754.84,-1782.81 5767.3,-1791.83 5778,-1803.3 5855.41,-1886.33 5739.42,-2738.73 5814,-2824.3 5908.22,-2932.41 6084.74,-2938.22 6200.82,-2928.11"/>
<polygon fill="black" stroke="black" points="6201.18,-2931.59 6210.82,-2927.19 6200.54,-2924.62 6201.18,-2931.59"/>
</g>
<!-- telegram_bot.enqueue_new_ids&#45;&gt;telegram_bot._should_suggest -->
<g id="edge7" class="edge">
<title>telegram_bot.enqueue_new_ids&#45;&gt;telegram_bot._should_suggest</title>
<path fill="none" stroke="black" d="M5741.2,-1767.27C5870.1,-1763.45 6026.45,-1758.82 6143.21,-1755.36"/>
<polygon fill="black" stroke="black" points="6143.43,-1758.86 6153.32,-1755.06 6143.22,-1751.86 6143.43,-1758.86"/>
</g>
<!-- telegram_bot._send_queue -->
<g id="node13" class="node">
<title>telegram_bot._send_queue</title>
<g id="a_node13"><a xlink:title="Send next lot from each user queue via ``app``.">
<polygon fill="none" stroke="black" points="5778,-1864.3 5227,-1864.3 5227,-1812.3 5778,-1812.3 5778,-1864.3"/>
<text text-anchor="middle" x="5502.5" y="-1828.61" font-family="Times,serif" font-size="39.62">telegram_bot._send_queue</text>
</a>
</g>
</g>
<!-- telegram_bot._send_queue&#45;&gt;telegram_bot.save_profiles -->
<g id="edge8" class="edge">
<title>telegram_bot._send_queue&#45;&gt;telegram_bot.save_profiles</title>
<path fill="none" stroke="black" d="M5520.65,-1864.58C5570.72,-1942.83 5717.01,-2182.66 5778,-2404.3 5802.85,-2494.62 5750.7,-2755.26 5814,-2824.3 5910.52,-2929.59 6085.29,-2936.42 6200.51,-2927.27"/>
<polygon fill="black" stroke="black" points="6201.11,-2930.73 6210.78,-2926.4 6200.52,-2923.75 6201.11,-2930.73"/>
</g>
<!-- lot_io.get_lot -->
<g id="node14" class="node">
<title>lot_io.get_lot</title>
<g id="a_node14"><a xlink:title="Return the lot identified by ``lot_id`` or ``None`` when missing.">
<polygon fill="none" stroke="black" points="7381.5,-1714.3 7236.5,-1714.3 7236.5,-1678.3 7381.5,-1678.3 7381.5,-1714.3"/>
<text text-anchor="middle" x="7309" y="-1691.51" font-family="Times,serif" font-size="19.74">lot_io.get_lot</text>
</a>
</g>
</g>
<!-- telegram_bot._send_queue&#45;&gt;lot_io.get_lot -->
<g id="edge9" class="edge">
<title>telegram_bot._send_queue&#45;&gt;lot_io.get_lot</title>
<path fill="none" stroke="black" d="M5778.17,-1817.42C5790.28,-1816.67 5802.26,-1815.96 5814,-1815.3 5925.24,-1809.08 6718.78,-1831.73 6816,-1777.3 6841.17,-1763.21 6826.98,-1737.66 6852,-1723.3 6968.42,-1656.49 7130.24,-1666.23 7226.52,-1680.49"/>
<polygon fill="black" stroke="black" points="7226.08,-1683.97 7236.49,-1682.02 7227.14,-1677.05 7226.08,-1683.97"/>
</g>
<!-- lot_io.read_lots -->
<g id="node22" class="node">
<title>lot_io.read_lots</title>
<g id="a_node22"><a xlink:title="Return a list of lots from ``path`` or ``None`` when invalid.">
<polygon fill="none" stroke="black" points="8453,-3688.3 8241,-3688.3 8241,-3652.3 8453,-3652.3 8453,-3688.3"/>
<text text-anchor="middle" x="8347" y="-3664.14" font-family="Times,serif" font-size="25.20">lot_io.read_lots</text>
</a>
</g>
</g>
<!-- lot_io.get_lot&#45;&gt;lot_io.read_lots -->
<g id="edge267" class="edge">
<title>lot_io.get_lot&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M7381.71,-1689.36C7496.76,-1679.99 7714.84,-1670.04 7766,-1723.3 7839.78,-1800.13 7728.06,-3563.63 7802,-3640.3 7858.99,-3699.4 8088.81,-3692.15 8230.88,-3681.35"/>
<polygon fill="black" stroke="black" points="8231.25,-3684.83 8240.95,-3680.57 8230.71,-3677.86 8231.25,-3684.83"/>
</g>
<!-- lot_io.parse_lot_id -->
<g id="node159" class="node">
<title>lot_io.parse_lot_id</title>
<g id="a_node159"><a xlink:title="Return ``(relative_path, index)`` extracted from ``lot_id``.">
<polygon fill="none" stroke="black" points="9348,-1702.3 9098,-1702.3 9098,-1666.3 9348,-1666.3 9348,-1702.3"/>
<text text-anchor="middle" x="9223" y="-1678.14" font-family="Times,serif" font-size="25.20">lot_io.parse_lot_id</text>
</a>
</g>
</g>
<!-- lot_io.get_lot&#45;&gt;lot_io.parse_lot_id -->
<g id="edge268" class="edge">
<title>lot_io.get_lot&#45;&gt;lot_io.parse_lot_id</title>
<path fill="none" stroke="black" d="M7381.75,-1695.85C7665.7,-1694.07 8713.47,-1687.5 9087.9,-1685.15"/>
<polygon fill="black" stroke="black" points="9087.99,-1688.65 9097.97,-1685.08 9087.94,-1681.65 9087.99,-1688.65"/>
</g>
<!-- telegram_bot.send_alert -->
<g id="node15" class="node">
<title>telegram_bot.send_alert</title>
<g id="a_node15"><a xlink:title="Broadcast ``text`` to all registered users.">
<polygon fill="none" stroke="black" points="5111.5,-950.3 4781.5,-950.3 4781.5,-914.3 5111.5,-914.3 5111.5,-950.3"/>
<text text-anchor="middle" x="4946.5" y="-926.14" font-family="Times,serif" font-size="25.20">telegram_bot.send_alert</text>
</a>
</g>
</g>
<!-- telegram_bot.send_alert&#45;&gt;telegram_bot.load_profiles -->
<g id="edge10" class="edge">
<title>telegram_bot.send_alert&#45;&gt;telegram_bot.load_profiles</title>
<path fill="none" stroke="black" d="M5111.84,-926.07C5184.36,-923.33 5269.29,-920.11 5341.31,-917.38"/>
<polygon fill="black" stroke="black" points="5341.53,-920.87 5351.39,-916.99 5341.26,-913.88 5341.53,-920.87"/>
</g>
<!-- telegram_bot.start_cmd -->
<g id="node16" class="node">
<title>telegram_bot.start_cmd</title>
<g id="a_node16"><a xlink:title="Register the user and confirm startup.">
<polygon fill="none" stroke="black" points="5058.5,-3026.3 4834.5,-3026.3 4834.5,-2990.3 5058.5,-2990.3 5058.5,-3026.3"/>
<text text-anchor="middle" x="4946.5" y="-3004.14" font-family="Times,serif" font-size="17.08">telegram_bot.start_cmd</text>
</a>
</g>
</g>
<!-- telegram_bot.start_cmd&#45;&gt;telegram_bot._t -->
<g id="edge11" class="edge">
<title>telegram_bot.start_cmd&#45;&gt;telegram_bot._t</title>
<path fill="none" stroke="black" d="M5058.61,-3008.91C5154.25,-3009.42 5291.66,-3010.17 5387.99,-3010.69"/>
<polygon fill="black" stroke="black" points="5388.04,-3014.19 5398.06,-3010.74 5388.08,-3007.19 5388.04,-3014.19"/>
</g>
<!-- telegram_bot.start_cmd&#45;&gt;telegram_bot.ensure_profile -->
<g id="edge12" class="edge">
<title>telegram_bot.start_cmd&#45;&gt;telegram_bot.ensure_profile</title>
<path fill="none" stroke="black" d="M5058.61,-2998.08C5139.67,-2990.61 5250.74,-2980.39 5341.37,-2972.05"/>
<polygon fill="black" stroke="black" points="5341.84,-2975.52 5351.47,-2971.12 5341.19,-2968.55 5341.84,-2975.52"/>
</g>
<!-- telegram_bot.lang_cmd -->
<g id="node17" class="node">
<title>telegram_bot.lang_cmd</title>
<g id="a_node17"><a xlink:title="Set preferred language or list available choices.">
<polygon fill="none" stroke="black" points="5121,-3083.8 4772,-3083.8 4772,-3044.8 5121,-3044.8 5121,-3083.8"/>
<text text-anchor="middle" x="4946.5" y="-3057.4" font-family="Times,serif" font-size="28.00">telegram_bot.lang_cmd</text>
</a>
</g>
</g>
<!-- telegram_bot.lang_cmd&#45;&gt;telegram_bot._t -->
<g id="edge13" class="edge">
<title>telegram_bot.lang_cmd&#45;&gt;telegram_bot._t</title>
<path fill="none" stroke="black" d="M5121.27,-3047.68C5208.28,-3039.36 5311.14,-3029.52 5387.92,-3022.17"/>
<polygon fill="black" stroke="black" points="5388.48,-3025.63 5398.11,-3021.2 5387.82,-3018.66 5388.48,-3025.63"/>
</g>
<!-- telegram_bot.lang_cmd&#45;&gt;telegram_bot.ensure_profile -->
<g id="edge14" class="edge">
<title>telegram_bot.lang_cmd&#45;&gt;telegram_bot.ensure_profile</title>
<path fill="none" stroke="black" d="M5121.1,-3061.78C5145.69,-3056.34 5169.79,-3047.94 5191,-3035.3 5214.83,-3021.1 5203.02,-2998.26 5227,-2984.3 5261.15,-2964.43 5301.8,-2954.56 5341.21,-2950.31"/>
<polygon fill="black" stroke="black" points="5341.58,-2953.8 5351.2,-2949.35 5340.91,-2946.83 5341.58,-2953.8"/>
</g>
<!-- telegram_bot.lang_cmd&#45;&gt;telegram_bot.save_profiles -->
<g id="edge15" class="edge">
<title>telegram_bot.lang_cmd&#45;&gt;telegram_bot.save_profiles</title>
<path fill="none" stroke="black" d="M5121.15,-3080.05C5332.78,-3095.66 5674.91,-3108.29 5778,-3038.3 5811.27,-3015.72 5781.38,-2978.82 5814,-2955.3 5929.84,-2871.79 6102.28,-2877.17 6211.37,-2891.85"/>
<polygon fill="black" stroke="black" points="6211.01,-2895.34 6221.4,-2893.25 6211.98,-2888.41 6211.01,-2895.34"/>
</g>
<!-- telegram_bot.vote_callback -->
<g id="node18" class="node">
<title>telegram_bot.vote_callback</title>
<g id="a_node18"><a xlink:title="Handle inline button presses for lot feedback.">
<polygon fill="none" stroke="black" points="5161.5,-2971.8 4731.5,-2971.8 4731.5,-2930.8 5161.5,-2930.8 5161.5,-2971.8"/>
<text text-anchor="middle" x="4946.5" y="-2944.06" font-family="Times,serif" font-size="29.68">telegram_bot.vote_callback</text>
</a>
</g>
</g>
<!-- telegram_bot.vote_callback&#45;&gt;telegram_bot._t -->
<g id="edge16" class="edge">
<title>telegram_bot.vote_callback&#45;&gt;telegram_bot._t</title>
<path fill="none" stroke="black" d="M5116.67,-2971.82C5153.05,-2976.08 5191.3,-2980.44 5227,-2984.3 5280,-2990.04 5338.82,-2995.89 5388.37,-3000.68"/>
<polygon fill="black" stroke="black" points="5388.18,-3004.17 5398.47,-3001.65 5388.86,-2997.21 5388.18,-3004.17"/>
</g>
<!-- telegram_bot.vote_callback&#45;&gt;telegram_bot.ensure_profile -->
<g id="edge17" class="edge">
<title>telegram_bot.vote_callback&#45;&gt;telegram_bot.ensure_profile</title>
<path fill="none" stroke="black" d="M5161.69,-2953.62C5221.44,-2954.27 5285.3,-2954.96 5341.34,-2955.57"/>
<polygon fill="black" stroke="black" points="5341.31,-2959.07 5351.35,-2955.68 5341.39,-2952.07 5341.31,-2959.07"/>
</g>
<!-- telegram_bot.vote_callback&#45;&gt;telegram_bot.save_profiles -->
<g id="edge18" class="edge">
<title>telegram_bot.vote_callback&#45;&gt;telegram_bot.save_profiles</title>
<path fill="none" stroke="black" d="M5161.82,-2933.94C5183.83,-2932.53 5205.86,-2931.28 5227,-2930.3 5582.12,-2913.87 6003.1,-2911.34 6200.79,-2911.14"/>
<polygon fill="black" stroke="black" points="6200.9,-2914.64 6210.9,-2911.13 6200.9,-2907.64 6200.9,-2914.64"/>
</g>
<!-- telegram_bot.main -->
<g id="node19" class="node">
<title>telegram_bot.main</title>
<g id="a_node19"><a xlink:title="Run the Telegram recommendation bot.">
<polygon fill="none" stroke="black" points="5112,-1033.3 4781,-1033.3 4781,-989.3 5112,-989.3 5112,-1033.3"/>
<text text-anchor="middle" x="4946.5" y="-1002.98" font-family="Times,serif" font-size="32.90">telegram_bot.main</text>
</a>
</g>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot.load_profiles -->
<g id="edge19" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot.load_profiles</title>
<path fill="none" stroke="black" d="M5087.83,-989.27C5122.2,-981.73 5158.45,-971.9 5191,-959.3 5208.27,-952.62 5209.38,-944.01 5227,-938.3 5263.07,-926.63 5303.09,-919.59 5341.16,-915.44"/>
<polygon fill="black" stroke="black" points="5341.72,-918.9 5351.31,-914.4 5341.01,-911.94 5341.72,-918.9"/>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot.load_state -->
<g id="edge20" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot.load_state</title>
<path fill="none" stroke="black" d="M5112.22,-997.63C5187.16,-991.4 5275.29,-984.09 5348.73,-977.99"/>
<polygon fill="black" stroke="black" points="5349.32,-981.45 5358.99,-977.14 5348.74,-974.48 5349.32,-981.45"/>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot.save_state -->
<g id="edge21" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot.save_state</title>
<path fill="none" stroke="black" d="M4950.93,-1033.42C4965.62,-1119.88 5031.57,-1437.36 5227,-1580.3 5384.07,-1695.19 5987.05,-1700.45 6220.72,-1698"/>
<polygon fill="black" stroke="black" points="6220.94,-1701.5 6230.9,-1697.88 6220.86,-1694.5 6220.94,-1701.5"/>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot.scan_embeddings -->
<g id="edge22" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot.scan_embeddings</title>
<path fill="none" stroke="black" d="M5112.08,-1009.63C5547.94,-1005.2 6727.77,-993.2 7152.77,-988.88"/>
<polygon fill="black" stroke="black" points="7153.02,-992.38 7162.98,-988.78 7152.94,-985.38 7153.02,-992.38"/>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot.enqueue_new_ids -->
<g id="edge23" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot.enqueue_new_ids</title>
<path fill="none" stroke="black" d="M4948.14,-1033.43C4952.36,-1134.87 4984.44,-1558.56 5227,-1745.3 5235.65,-1751.96 5244.93,-1757.67 5254.67,-1762.53"/>
<polygon fill="black" stroke="black" points="5253.19,-1765.7 5263.73,-1766.77 5256.15,-1759.36 5253.19,-1765.7"/>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot._send_queue -->
<g id="edge24" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot._send_queue</title>
<path fill="none" stroke="black" d="M4947.56,-1033.56C4949.17,-1139.57 4971.16,-1596.76 5227,-1803.3 5228.23,-1804.29 5229.47,-1805.27 5230.72,-1806.22"/>
<polygon fill="black" stroke="black" points="5229,-1809.28 5239.18,-1812.22 5233.05,-1803.58 5229,-1809.28"/>
</g>
<!-- embed.embed_file -->
<g id="node20" class="node">
<title>embed.embed_file</title>
<g id="a_node20"><a xlink:title="Embed ``path`` and write the result beside it under ``EMBED_DIR``.">
<polygon fill="none" stroke="black" points="7514,-4835.8 7104,-4835.8 7104,-4780.8 7514,-4780.8 7514,-4835.8"/>
<text text-anchor="middle" x="7309" y="-4797.76" font-family="Times,serif" font-size="42.56">embed.embed_file</text>
</a>
</g>
</g>
<!-- notes_utils.write_json -->
<g id="node21" class="node">
<title>notes_utils.write_json</title>
<g id="a_node21"><a xlink:title="Serialise ``data`` to ``path`` with standard options.">
<polygon fill="none" stroke="black" points="9317,-4650.3 9129,-4650.3 9129,-4614.3 9317,-4614.3 9317,-4650.3"/>
<text text-anchor="middle" x="9223" y="-4628.26" font-family="Times,serif" font-size="15.68">notes_utils.write_json</text>
</a>
</g>
</g>
<!-- embed.embed_file&#45;&gt;notes_utils.write_json -->
<g id="edge25" class="edge">
<title>embed.embed_file&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M7514.11,-4812.36C7911.53,-4819.51 8761.81,-4830.76 8892,-4799.3 9008.65,-4771.12 9130.88,-4695.07 9188.35,-4656.07"/>
<polygon fill="black" stroke="black" points="9190.41,-4658.91 9196.68,-4650.37 9186.45,-4653.13 9190.41,-4658.91"/>
</g>
<!-- embed.embed_file&#45;&gt;lot_io.read_lots -->
<g id="edge26" class="edge">
<title>embed.embed_file&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M7514.09,-4810.04C7605.4,-4799.33 7705.82,-4769.36 7766,-4695.3 7834.44,-4611.09 7727.32,-3798.04 7802,-3719.3 7858.64,-3659.59 8088.58,-3658.33 8230.77,-3663.7"/>
<polygon fill="black" stroke="black" points="8230.72,-3667.2 8240.85,-3664.1 8230.99,-3660.21 8230.72,-3667.2"/>
</g>
<!-- lot_io.make_lot_id -->
<g id="node23" class="node">
<title>lot_io.make_lot_id</title>
<g id="a_node23"><a xlink:title="Return lot id string for ``rel`` and ``index``.&#10;&#10;``rel`` is the JSON file path relative to the ``data/lots`` directory&#10;without the ``.json`` suffix.">
<polygon fill="none" stroke="black" points="8439.5,-4790.3 8254.5,-4790.3 8254.5,-4754.3 8439.5,-4754.3 8439.5,-4790.3"/>
<text text-anchor="middle" x="8347" y="-4767.52" font-family="Times,serif" font-size="18.48">lot_io.make_lot_id</text>
</a>
</g>
</g>
<!-- embed.embed_file&#45;&gt;lot_io.make_lot_id -->
<g id="edge27" class="edge">
<title>embed.embed_file&#45;&gt;lot_io.make_lot_id</title>
<path fill="none" stroke="black" d="M7514.06,-4801.21C7734.02,-4793.57 8075.22,-4781.71 8244.13,-4775.84"/>
<polygon fill="black" stroke="black" points="8244.39,-4779.34 8254.27,-4775.49 8244.15,-4772.34 8244.39,-4779.34"/>
</g>
<!-- lot_io.read_lots&#45;&gt;notes_utils.load_json -->
<g id="edge260" class="edge">
<title>lot_io.read_lots&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M8453.04,-3680.56C8594.04,-3691.74 8833.61,-3700.79 8892,-3640.3 8962.12,-3567.66 8865.14,-1902.32 8928,-1823.3 8966.02,-1775.51 9029.98,-1755.84 9088.55,-1748.62"/>
<polygon fill="black" stroke="black" points="9089.1,-1752.08 9098.65,-1747.48 9088.33,-1745.12 9089.1,-1752.08"/>
</g>
<!-- lot_io._clean_lot -->
<g id="node156" class="node">
<title>lot_io._clean_lot</title>
<g id="a_node156"><a xlink:title="Return ``lot`` without empty or null fields.">
<polygon fill="none" stroke="black" points="9280.5,-3902.3 9165.5,-3902.3 9165.5,-3866.3 9280.5,-3866.3 9280.5,-3902.3"/>
<text text-anchor="middle" x="9223" y="-3881.06" font-family="Times,serif" font-size="12.18">lot_io._clean_lot</text>
</a>
</g>
</g>
<!-- lot_io.read_lots&#45;&gt;lot_io._clean_lot -->
<g id="edge261" class="edge">
<title>lot_io.read_lots&#45;&gt;lot_io._clean_lot</title>
<path fill="none" stroke="black" d="M8453.18,-3662.14C8565.94,-3657.34 8748.14,-3661.18 8892,-3719.3 8911.05,-3727 8910.55,-3737.47 8928,-3748.3 9005.78,-3796.6 9103.52,-3838.47 9164.39,-3862.55"/>
<polygon fill="black" stroke="black" points="9163.24,-3865.86 9173.83,-3866.26 9165.8,-3859.35 9163.24,-3865.86"/>
</g>
<!-- embed.main -->
<g id="node24" class="node">
<title>embed.main</title>
<g id="a_node24"><a xlink:title="Embed the file given on the command line.">
<polygon fill="none" stroke="black" points="6403,-4826.3 6227,-4826.3 6227,-4790.3 6403,-4790.3 6403,-4826.3"/>
<text text-anchor="middle" x="6315" y="-4802.14" font-family="Times,serif" font-size="25.20">embed.main</text>
</a>
</g>
</g>
<!-- embed.main&#45;&gt;embed.embed_file -->
<g id="edge28" class="edge">
<title>embed.main&#45;&gt;embed.embed_file</title>
<path fill="none" stroke="black" d="M6403.16,-4808.3C6556.4,-4808.3 6878.21,-4808.3 7093.77,-4808.3"/>
<polygon fill="black" stroke="black" points="7093.96,-4811.8 7103.96,-4808.3 7093.96,-4804.8 7093.96,-4811.8"/>
</g>
<!-- notes_utils.load_json&#45;&gt;notes_utils.read_text -->
<g id="edge239" class="edge">
<title>notes_utils.load_json&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M9347.33,-1757.23C9403.5,-1755.15 9468.35,-1744.23 9518,-1711.3 9668.98,-1611.18 9741.12,-1387.05 9762.47,-1308.31"/>
<polygon fill="black" stroke="black" points="9765.87,-1309.17 9765.05,-1298.61 9759.1,-1307.37 9765.87,-1309.17"/>
</g>
<!-- similar_utils._format_vector -->
<g id="node26" class="node">
<title>similar_utils._format_vector</title>
<g id="a_node26"><a xlink:title="Return compact JSON representation for ``vec``.">
<polygon fill="none" stroke="black" points="8475.5,-1309.3 8218.5,-1309.3 8218.5,-1273.3 8475.5,-1273.3 8475.5,-1309.3"/>
<text text-anchor="middle" x="8347" y="-1287.14" font-family="Times,serif" font-size="17.08">similar_utils._format_vector</text>
</a>
</g>
</g>
<!-- similar_utils._similar_path -->
<g id="node27" class="node">
<title>similar_utils._similar_path</title>
<g id="a_node27"><a xlink:title="Return cache file path for ``lot_path`` under ``SIMILAR_DIR``.">
<polygon fill="none" stroke="black" points="8449,-1173.3 8245,-1173.3 8245,-1137.3 8449,-1137.3 8449,-1173.3"/>
<text text-anchor="middle" x="8347" y="-1151.6" font-family="Times,serif" font-size="14.00">similar_utils._similar_path</text>
</a>
</g>
</g>
<!-- similar_utils._load_similar -->
<g id="node28" class="node">
<title>similar_utils._load_similar</title>
<g id="a_node28"><a xlink:title="Return cached similar lots mapping.">
<polygon fill="none" stroke="black" points="8596,-957.3 8098,-957.3 8098,-909.3 8596,-909.3 8596,-957.3"/>
<text text-anchor="middle" x="8347" y="-924.18" font-family="Times,serif" font-size="36.40">similar_utils._load_similar</text>
</a>
</g>
</g>
<!-- similar_utils._load_similar&#45;&gt;notes_utils.load_json -->
<g id="edge30" class="edge">
<title>similar_utils._load_similar&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M8596.18,-917.35C8719.25,-915.34 8850.36,-924.15 8892,-966.3 8950.24,-1025.26 8871.8,-1650.4 8928,-1711.3 8968.01,-1754.66 9031.12,-1766.81 9088.64,-1767"/>
<polygon fill="black" stroke="black" points="9088.96,-1770.5 9098.93,-1766.91 9088.9,-1763.5 9088.96,-1770.5"/>
</g>
<!-- similar_utils._save_similar -->
<g id="node29" class="node">
<title>similar_utils._save_similar</title>
<g id="a_node29"><a xlink:title="Write ``sim_map`` to ``SIMILAR_DIR`` mirroring ``LOTS_DIR`` layout.">
<polygon fill="none" stroke="black" points="7457,-1173.3 7161,-1173.3 7161,-1137.3 7457,-1137.3 7457,-1173.3"/>
<text text-anchor="middle" x="7309" y="-1150" font-family="Times,serif" font-size="21.00">similar_utils._save_similar</text>
</a>
</g>
</g>
<!-- similar_utils._save_similar&#45;&gt;notes_utils.write_json -->
<g id="edge32" class="edge">
<title>similar_utils._save_similar&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M7367.56,-1137.25C7465.19,-1110.64 7662.68,-1074.81 7766,-1182.3 7836.89,-1256.06 7736.44,-2944.77 7802,-3023.3 8118.71,-3402.7 8572.49,-2866.26 8892,-3243.3 8967.33,-3332.19 8885.55,-4182.8 8928,-4291.3 8983.6,-4433.42 9125.39,-4557.1 9189.57,-4607.81"/>
<polygon fill="black" stroke="black" points="9187.7,-4610.79 9197.73,-4614.19 9192.01,-4605.27 9187.7,-4610.79"/>
</g>
<!-- similar_utils._save_similar&#45;&gt;similar_utils._similar_path -->
<g id="edge31" class="edge">
<title>similar_utils._save_similar&#45;&gt;similar_utils._similar_path</title>
<path fill="none" stroke="black" d="M7457.06,-1155.3C7666.66,-1155.3 8046.69,-1155.3 8234.62,-1155.3"/>
<polygon fill="black" stroke="black" points="8234.79,-1158.8 8244.79,-1155.3 8234.79,-1151.8 8234.79,-1158.8"/>
</g>
<!-- lot_io.lot_json_path -->
<g id="node30" class="node">
<title>lot_io.lot_json_path</title>
<g id="a_node30"><a xlink:title="Return full JSON path for ``lot_id`` given ``root`` directory.">
<polygon fill="none" stroke="black" points="8423.5,-1670.3 8270.5,-1670.3 8270.5,-1634.3 8423.5,-1634.3 8423.5,-1670.3"/>
<text text-anchor="middle" x="8347" y="-1648.6" font-family="Times,serif" font-size="14.00">lot_io.lot_json_path</text>
</a>
</g>
</g>
<!-- similar_utils._save_similar&#45;&gt;lot_io.lot_json_path -->
<g id="edge33" class="edge">
<title>similar_utils._save_similar&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M7457.27,-1144.07C7573.61,-1138.72 7723.25,-1140.8 7766,-1182.3 7830.83,-1245.24 7739.08,-1522.45 7802,-1587.3 7863.63,-1650.82 8123.12,-1656.34 8260.24,-1654.62"/>
<polygon fill="black" stroke="black" points="8260.35,-1658.12 8270.3,-1654.48 8260.26,-1651.12 8260.35,-1658.12"/>
</g>
<!-- lot_io.lot_json_path&#45;&gt;lot_io.parse_lot_id -->
<g id="edge266" class="edge">
<title>lot_io.lot_json_path&#45;&gt;lot_io.parse_lot_id</title>
<path fill="none" stroke="black" d="M8423.65,-1655.07C8571.77,-1660.5 8901.76,-1672.58 9087.78,-1679.39"/>
<polygon fill="black" stroke="black" points="9087.78,-1682.89 9097.9,-1679.76 9088.04,-1675.9 9087.78,-1682.89"/>
</g>
<!-- similar_utils._update_reciprocal -->
<g id="node31" class="node">
<title>similar_utils._update_reciprocal</title>
<g id="a_node31"><a xlink:title="Insert ``lot_id`` into caches of lots listed in ``sims`` if closer.">
<polygon fill="none" stroke="black" points="8588,-614.3 8106,-614.3 8106,-574.3 8588,-574.3 8588,-614.3"/>
<text text-anchor="middle" x="8347" y="-587.23" font-family="Times,serif" font-size="28.84">similar_utils._update_reciprocal</text>
</a>
</g>
</g>
<!-- similar_utils._prune_similar -->
<g id="node32" class="node">
<title>similar_utils._prune_similar</title>
<g id="a_node32"><a xlink:title="Drop cache entries referring to ids not in ``valid_ids``.">
<polygon fill="none" stroke="black" points="6454,-606.3 6176,-606.3 6176,-570.3 6454,-570.3 6454,-606.3"/>
<text text-anchor="middle" x="6315" y="-583.52" font-family="Times,serif" font-size="18.48">similar_utils._prune_similar</text>
</a>
</g>
</g>
<!-- similar_utils._calc_similar_nn -->
<g id="node33" class="node">
<title>similar_utils._calc_similar_nn</title>
<g id="a_node33"><a xlink:title="Fill ``sim_map`` for ``new_ids`` using a nearest neighbour search.&#10;&#10;``vec_ids`` lists all lots that have an embedding. &#160;``new_ids`` is a subset&#10;for which we still need recommendations. &#160;We gather vectors for&#10;``vec_ids`` and use ``NearestNeighbors`` from scikit&#45;learn to find the&#10;closest items. &#160;Embeddings of lots without a vector are skipped.">
<polygon fill="none" stroke="black" points="7766,-613.8 6852,-613.8 6852,-538.8 7766,-538.8 7766,-613.8"/>
<text text-anchor="middle" x="7309" y="-561.31" font-family="Times,serif" font-size="60.62">similar_utils._calc_similar_nn</text>
</a>
</g>
</g>
<!-- similar_utils._calc_similar_nn&#45;&gt;similar_utils._update_reciprocal -->
<g id="edge34" class="edge">
<title>similar_utils._calc_similar_nn&#45;&gt;similar_utils._update_reciprocal</title>
<path fill="none" stroke="black" d="M7766.29,-584.23C7879.48,-586.2 7996.66,-588.23 8095.79,-589.96"/>
<polygon fill="black" stroke="black" points="8095.88,-593.46 8105.94,-590.13 8096,-586.46 8095.88,-593.46"/>
</g>
<!-- similar_utils._sync_embeddings -->
<g id="node34" class="node">
<title>similar_utils._sync_embeddings</title>
<g id="a_node34"><a xlink:title="Drop lots or vectors that do not match and return cleaned data.">
<polygon fill="none" stroke="black" points="8585.5,-195.3 8108.5,-195.3 8108.5,-155.3 8585.5,-155.3 8585.5,-195.3"/>
<text text-anchor="middle" x="8347" y="-168.23" font-family="Times,serif" font-size="28.84">similar_utils._sync_embeddings</text>
</a>
</g>
</g>
<!-- similar_utils._similar_by_user -->
<g id="node35" class="node">
<title>similar_utils._similar_by_user</title>
<g id="a_node35"><a xlink:title="Return map of lot id to other lots from the same user.">
<polygon fill="none" stroke="black" points="6623.5,-1320.3 6006.5,-1320.3 6006.5,-1268.3 6623.5,-1268.3 6623.5,-1320.3"/>
<text text-anchor="middle" x="6315" y="-1284.16" font-family="Times,serif" font-size="40.18">similar_utils._similar_by_user</text>
</a>
</g>
</g>
<!-- similar_utils._similar_by_user&#45;&gt;similar_utils._cos_sim -->
<g id="edge35" class="edge">
<title>similar_utils._similar_by_user&#45;&gt;similar_utils._cos_sim</title>
<path fill="none" stroke="black" d="M6504.22,-1320.34C6606.86,-1333.81 6736.23,-1349.63 6852,-1360.3 6963.34,-1370.57 7090.32,-1378.02 7181.97,-1382.64"/>
<polygon fill="black" stroke="black" points="7181.96,-1386.14 7192.12,-1383.15 7182.31,-1379.15 7181.96,-1386.14"/>
</g>
<!-- image_io.read_image_meta -->
<g id="node36" class="node">
<title>image_io.read_image_meta</title>
<g id="a_node36"><a xlink:title="Return metadata from ``path.with_suffix(&#39;.md&#39;)``.">
<polygon fill="none" stroke="black" points="7423.5,-2234.3 7194.5,-2234.3 7194.5,-2198.3 7423.5,-2198.3 7423.5,-2234.3"/>
<text text-anchor="middle" x="7309" y="-2212.26" font-family="Times,serif" font-size="15.68">image_io.read_image_meta</text>
</a>
</g>
</g>
<!-- notes_utils.parse_md -->
<g id="node37" class="node">
<title>notes_utils.parse_md</title>
<g id="a_node37"><a xlink:title="Return metadata dictionary and body text from ``path``.">
<polygon fill="none" stroke="black" points="8430.5,-2202.3 8263.5,-2202.3 8263.5,-2166.3 8430.5,-2166.3 8430.5,-2202.3"/>
<text text-anchor="middle" x="8347" y="-2180.6" font-family="Times,serif" font-size="14.00">notes_utils.parse_md</text>
</a>
</g>
</g>
<!-- image_io.read_image_meta&#45;&gt;notes_utils.parse_md -->
<g id="edge36" class="edge">
<title>image_io.read_image_meta&#45;&gt;notes_utils.parse_md</title>
<path fill="none" stroke="black" d="M7423.83,-2212.79C7630.42,-2206.41 8063.22,-2193.04 8253.22,-2187.17"/>
<polygon fill="black" stroke="black" points="8253.57,-2190.66 8263.45,-2186.85 8253.35,-2183.66 8253.57,-2190.66"/>
</g>
<!-- notes_utils.read_md -->
<g id="node79" class="node">
<title>notes_utils.read_md</title>
<g id="a_node79"><a xlink:title="Alias for :func:`read_text` used for Markdown files.">
<polygon fill="none" stroke="black" points="9293,-2173.3 9153,-2173.3 9153,-2137.3 9293,-2137.3 9293,-2173.3"/>
<text text-anchor="middle" x="9223" y="-2152.06" font-family="Times,serif" font-size="12.18">notes_utils.read_md</text>
</a>
</g>
</g>
<!-- notes_utils.parse_md&#45;&gt;notes_utils.read_md -->
<g id="edge237" class="edge">
<title>notes_utils.parse_md&#45;&gt;notes_utils.read_md</title>
<path fill="none" stroke="black" d="M8430.62,-2181.56C8598.59,-2175.99 8977.95,-2163.4 9142.91,-2157.93"/>
<polygon fill="black" stroke="black" points="9143.11,-2161.42 9152.99,-2157.59 9142.88,-2154.43 9143.11,-2161.42"/>
</g>
<!-- notes_utils._parse_block -->
<g id="node124" class="node">
<title>notes_utils._parse_block</title>
<g id="a_node124"><a xlink:title="Return metadata dict and remaining body from ``text``.">
<polygon fill="none" stroke="black" points="9392,-2280.8 9054,-2280.8 9054,-2243.8 9392,-2243.8 9392,-2280.8"/>
<text text-anchor="middle" x="9223" y="-2255.86" font-family="Times,serif" font-size="26.18">notes_utils._parse_block</text>
</a>
</g>
</g>
<!-- notes_utils.parse_md&#45;&gt;notes_utils._parse_block -->
<g id="edge238" class="edge">
<title>notes_utils.parse_md&#45;&gt;notes_utils._parse_block</title>
<path fill="none" stroke="black" d="M8430.65,-2187.11C8537.4,-2191.21 8728.89,-2200.16 8892,-2216.3 8959.48,-2222.98 9034.35,-2233.19 9095.7,-2242.29"/>
<polygon fill="black" stroke="black" points="9095.41,-2245.79 9105.82,-2243.8 9096.45,-2238.87 9095.41,-2245.79"/>
</g>
<!-- image_io.write_image_meta -->
<g id="node38" class="node">
<title>image_io.write_image_meta</title>
<g id="a_node38"><a xlink:title="Write ``meta`` to ``path.with_suffix(&#39;.md&#39;)``.">
<polygon fill="none" stroke="black" points="6432.5,-2625.3 6197.5,-2625.3 6197.5,-2589.3 6432.5,-2589.3 6432.5,-2625.3"/>
<text text-anchor="middle" x="6315" y="-2603.26" font-family="Times,serif" font-size="15.68">image_io.write_image_meta</text>
</a>
</g>
</g>
<!-- notes_utils.write_md -->
<g id="node39" class="node">
<title>notes_utils.write_md</title>
<g id="a_node39"><a xlink:title="Write ``text`` to ``path`` ensuring a trailing newline.">
<polygon fill="none" stroke="black" points="7422,-2632.3 7196,-2632.3 7196,-2596.3 7422,-2596.3 7422,-2632.3"/>
<text text-anchor="middle" x="7309" y="-2609.51" font-family="Times,serif" font-size="19.74">notes_utils.write_md</text>
</a>
</g>
</g>
<!-- image_io.write_image_meta&#45;&gt;notes_utils.write_md -->
<g id="edge37" class="edge">
<title>image_io.write_image_meta&#45;&gt;notes_utils.write_md</title>
<path fill="none" stroke="black" d="M6432.71,-2608.13C6621.77,-2609.46 6993.21,-2612.08 7185.76,-2613.44"/>
<polygon fill="black" stroke="black" points="7185.9,-2616.94 7195.92,-2613.51 7185.95,-2609.94 7185.9,-2616.94"/>
</g>
<!-- chop.process_message -->
<g id="node40" class="node">
<title>chop.process_message</title>
<g id="a_node40"><a xlink:title="Extract lots from ``msg_path`` and save them under ``LOTS_DIR``.">
<polygon fill="none" stroke="black" points="6816,-4581.3 5814,-4581.3 5814,-4479.3 6816,-4479.3 6816,-4581.3"/>
<text text-anchor="middle" x="6315" y="-4508.98" font-family="Times,serif" font-size="85.40">chop.process_message</text>
</a>
</g>
</g>
<!-- chop.process_message&#45;&gt;embed.embed_file -->
<g id="edge38" class="edge">
<title>chop.process_message&#45;&gt;embed.embed_file</title>
<path fill="none" stroke="black" d="M6605.1,-4581.34C6676.65,-4600.7 6751.3,-4626.95 6816,-4662.3 6835.05,-4672.71 6832.87,-4685.04 6852,-4695.3 6926.95,-4735.52 7016.52,-4761.72 7096.34,-4778.65"/>
<polygon fill="black" stroke="black" points="7096.03,-4782.16 7106.53,-4780.78 7097.46,-4775.31 7096.03,-4782.16"/>
</g>
<!-- moderation.should_skip_message -->
<g id="node41" class="node">
<title>moderation.should_skip_message</title>
<g id="a_node41"><a xlink:title="Return ``True`` when the raw Telegram message should be ignored.">
<polygon fill="none" stroke="black" points="8514,-4176.3 8180,-4176.3 8180,-4140.3 8514,-4140.3 8514,-4176.3"/>
<text text-anchor="middle" x="8347" y="-4153.52" font-family="Times,serif" font-size="18.48">moderation.should_skip_message</text>
</a>
</g>
</g>
<!-- chop.process_message&#45;&gt;moderation.should_skip_message -->
<g id="edge39" class="edge">
<title>chop.process_message&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M6816.48,-4537.53C7221.49,-4540.93 7730.44,-4538.63 7766,-4506.3 7872.22,-4409.73 7697.38,-4283.62 7802,-4185.3 7853.64,-4136.78 8031.27,-4135.82 8169.67,-4143.36"/>
<polygon fill="black" stroke="black" points="8169.8,-4146.87 8179.98,-4143.94 8170.2,-4139.88 8169.8,-4146.87"/>
</g>
<!-- caption_io.has_caption -->
<g id="node42" class="node">
<title>caption_io.has_caption</title>
<g id="a_node42"><a xlink:title="Return ``True`` when any caption exists for ``image``.">
<polygon fill="none" stroke="black" points="8424.5,-3864.3 8269.5,-3864.3 8269.5,-3828.3 8424.5,-3828.3 8424.5,-3864.3"/>
<text text-anchor="middle" x="8347" y="-3843.06" font-family="Times,serif" font-size="12.18">caption_io.has_caption</text>
</a>
</g>
</g>
<!-- chop.process_message&#45;&gt;caption_io.has_caption -->
<g id="edge40" class="edge">
<title>chop.process_message&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M6728.3,-4479.28C6770.04,-4475.12 6811.83,-4471.35 6852,-4468.3 6902.67,-4464.47 7729.5,-4470.65 7766,-4435.3 7850.17,-4353.8 7721.12,-3994.07 7802,-3909.3 7919.3,-3786.36 8137.97,-3804.38 8259.29,-3826.45"/>
<polygon fill="black" stroke="black" points="8258.81,-3829.93 8269.28,-3828.32 8260.1,-3823.04 8258.81,-3829.93"/>
</g>
<!-- caption_io.read_caption -->
<g id="node43" class="node">
<title>caption_io.read_caption</title>
<g id="a_node43"><a xlink:title="Return caption for ``image`` in ``lang`` or empty string when missing.">
<polygon fill="none" stroke="black" points="8512.5,-2147.8 8181.5,-2147.8 8181.5,-2110.8 8512.5,-2110.8 8512.5,-2147.8"/>
<text text-anchor="middle" x="8347" y="-2122.86" font-family="Times,serif" font-size="26.18">caption_io.read_caption</text>
</a>
</g>
</g>
<!-- chop.process_message&#45;&gt;caption_io.read_caption -->
<g id="edge41" class="edge">
<title>chop.process_message&#45;&gt;caption_io.read_caption</title>
<path fill="none" stroke="black" d="M6710.91,-4479.18C6751.3,-4459.27 6787.77,-4432.67 6816,-4397.3 6884.73,-4311.18 6775.71,-3485.8 6852,-3406.3 6993.06,-3259.31 7625.37,-3482.7 7766,-3335.3 7856.4,-3240.56 7710.38,-2250.86 7802,-2157.3 7851.87,-2106.38 8031.6,-2105.72 8170.98,-2113.78"/>
<polygon fill="black" stroke="black" points="8171.18,-2117.3 8181.37,-2114.4 8171.59,-2110.31 8171.18,-2117.3"/>
</g>
<!-- post_io.read_post -->
<g id="node44" class="node">
<title>post_io.read_post</title>
<g id="a_node44"><a xlink:title="Return metadata dictionary and body text for ``path``.">
<polygon fill="none" stroke="black" points="8626,-3014.3 8068,-3014.3 8068,-2938.3 8626,-2938.3 8626,-3014.3"/>
<text text-anchor="middle" x="8347" y="-2961.14" font-family="Times,serif" font-size="61.46">post_io.read_post</text>
</a>
</g>
</g>
<!-- chop.process_message&#45;&gt;post_io.read_post -->
<g id="edge42" class="edge">
<title>chop.process_message&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M6710.55,-4479.28C6751.07,-4459.36 6787.68,-4432.74 6816,-4397.3 6881.82,-4314.97 6777.8,-3524.18 6852,-3449.3 6923.56,-3377.09 7691.8,-3475.81 7766,-3406.3 7818.07,-3357.54 7753.85,-3139.94 7802,-3087.3 7866.88,-3016.38 7963.76,-2983.87 8057.86,-2970.61"/>
<polygon fill="black" stroke="black" points="8058.4,-2974.07 8067.84,-2969.27 8057.47,-2967.13 8058.4,-2974.07"/>
</g>
<!-- token_utils.estimate_tokens -->
<g id="node45" class="node">
<title>token_utils.estimate_tokens</title>
<g id="a_node45"><a xlink:title="Return a naive token count approximation.">
<polygon fill="none" stroke="black" points="7427,-4686.3 7191,-4686.3 7191,-4650.3 7427,-4650.3 7427,-4686.3"/>
<text text-anchor="middle" x="7309" y="-4664.26" font-family="Times,serif" font-size="15.68">token_utils.estimate_tokens</text>
</a>
</g>
</g>
<!-- chop.process_message&#45;&gt;token_utils.estimate_tokens -->
<g id="edge43" class="edge">
<title>chop.process_message&#45;&gt;token_utils.estimate_tokens</title>
<path fill="none" stroke="black" d="M6652.48,-4581.34C6707.72,-4593.19 6763.91,-4607.42 6816,-4624.3 6832.83,-4629.76 6834.86,-4636.92 6852,-4641.3 6960.5,-4669.03 7088.04,-4674.38 7180.61,-4673.61"/>
<polygon fill="black" stroke="black" points="7180.91,-4677.11 7190.87,-4673.5 7180.83,-4670.11 7180.91,-4677.11"/>
</g>
<!-- message_utils.build_prompt -->
<g id="node46" class="node">
<title>message_utils.build_prompt</title>
<g id="a_node46"><a xlink:title="Return prompt combining message text with captioned file names.">
<polygon fill="none" stroke="black" points="8496.5,-4122.3 8197.5,-4122.3 8197.5,-4086.3 8496.5,-4086.3 8496.5,-4122.3"/>
<text text-anchor="middle" x="8347" y="-4099.51" font-family="Times,serif" font-size="19.74">message_utils.build_prompt</text>
</a>
</g>
</g>
<!-- chop.process_message&#45;&gt;message_utils.build_prompt -->
<g id="edge44" class="edge">
<title>chop.process_message&#45;&gt;message_utils.build_prompt</title>
<path fill="none" stroke="black" d="M6816,-4507.86C6828.12,-4507.34 6840.13,-4506.82 6852,-4506.3 6902.77,-4504.11 7728.92,-4503.06 7766,-4468.3 7820.95,-4416.8 7747.25,-4183.03 7802,-4131.3 7855.74,-4080.53 8046.8,-4081.71 8187.37,-4090.32"/>
<polygon fill="black" stroke="black" points="8187.2,-4093.82 8197.4,-4090.95 8187.64,-4086.83 8187.2,-4093.82"/>
</g>
<!-- lot_io.valid_lots -->
<g id="node47" class="node">
<title>lot_io.valid_lots</title>
<g id="a_node47"><a xlink:title="Return ``True`` when every lot contains the required translations.">
<polygon fill="none" stroke="black" points="8449,-4882.3 8245,-4882.3 8245,-4846.3 8449,-4846.3 8449,-4882.3"/>
<text text-anchor="middle" x="8347" y="-4858.43" font-family="Times,serif" font-size="24.22">lot_io.valid_lots</text>
</a>
</g>
</g>
<!-- chop.process_message&#45;&gt;lot_io.valid_lots -->
<g id="edge45" class="edge">
<title>chop.process_message&#45;&gt;lot_io.valid_lots</title>
<path fill="none" stroke="black" d="M6697.31,-4581.39C6741.79,-4600.87 6782.98,-4627.11 6816,-4662.3 6872.71,-4722.76 6788.32,-4792.24 6852,-4845.3 6904.88,-4889.37 7897.45,-4873.42 8234.84,-4866.69"/>
<polygon fill="black" stroke="black" points="8234.94,-4870.18 8244.87,-4866.48 8234.8,-4863.19 8234.94,-4870.18"/>
</g>
<!-- lot_io.needs_cleanup -->
<g id="node48" class="node">
<title>lot_io.needs_cleanup</title>
<g id="a_node48"><a xlink:title="Return ``True`` when ``clean_data`` would drop ``lots``.">
<polygon fill="none" stroke="black" points="8436.5,-4426.3 8257.5,-4426.3 8257.5,-4390.3 8436.5,-4390.3 8436.5,-4426.3"/>
<text text-anchor="middle" x="8347" y="-4404.26" font-family="Times,serif" font-size="15.68">lot_io.needs_cleanup</text>
</a>
</g>
</g>
<!-- chop.process_message&#45;&gt;lot_io.needs_cleanup -->
<g id="edge46" class="edge">
<title>chop.process_message&#45;&gt;lot_io.needs_cleanup</title>
<path fill="none" stroke="black" d="M6816.36,-4543.79C6828.35,-4543.98 6840.25,-4544.15 6852,-4544.3 6953.55,-4545.63 7683.7,-4603.8 7766,-4544.3 7807.35,-4514.42 7761.41,-4466.21 7802,-4435.3 7869.48,-4383.93 8109.51,-4391.3 8247.13,-4400.31"/>
<polygon fill="black" stroke="black" points="8247.05,-4403.81 8257.26,-4400.99 8247.52,-4396.83 8247.05,-4403.81"/>
</g>
<!-- moderation.message_skip_reason -->
<g id="node52" class="node">
<title>moderation.message_skip_reason</title>
<g id="a_node52"><a xlink:title="Return the moderation reason for ``meta`` and ``text`` or ``None``.">
<polygon fill="none" stroke="black" points="9518,-4282.8 8928,-4282.8 8928,-4237.8 9518,-4237.8 9518,-4282.8"/>
<text text-anchor="middle" x="9223" y="-4251.92" font-family="Times,serif" font-size="33.60">moderation.message_skip_reason</text>
</a>
</g>
</g>
<!-- moderation.should_skip_message&#45;&gt;moderation.message_skip_reason -->
<g id="edge50" class="edge">
<title>moderation.should_skip_message&#45;&gt;moderation.message_skip_reason</title>
<path fill="none" stroke="black" d="M8514.15,-4159.08C8622.23,-4161.42 8766,-4167.99 8892,-4185.3 8973.8,-4196.54 9065.24,-4218.04 9131.08,-4235.15"/>
<polygon fill="black" stroke="black" points="9130.46,-4238.61 9141.02,-4237.75 9132.23,-4231.84 9130.46,-4238.61"/>
</g>
<!-- caption_io.caption_json_path -->
<g id="node77" class="node">
<title>caption_io.caption_json_path</title>
<g id="a_node77"><a xlink:title="Return new&#45;style caption path for ``image``.">
<polygon fill="none" stroke="black" points="9319.5,-2362.3 9126.5,-2362.3 9126.5,-2326.3 9319.5,-2326.3 9319.5,-2362.3"/>
<text text-anchor="middle" x="9223" y="-2341.06" font-family="Times,serif" font-size="12.18">caption_io.caption_json_path</text>
</a>
</g>
</g>
<!-- caption_io.has_caption&#45;&gt;caption_io.caption_json_path -->
<g id="edge98" class="edge">
<title>caption_io.has_caption&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M8424.57,-3862.89C8543.84,-3883.72 8772.66,-3902.7 8892,-3774.3 8938.6,-3724.17 8914.24,-3226.36 8928,-3159.3 8993.89,-2838.1 9160.75,-2472.97 9208.84,-2371.62"/>
<polygon fill="black" stroke="black" points="9212.1,-2372.92 9213.24,-2362.39 9205.78,-2369.91 9212.1,-2372.92"/>
</g>
<!-- caption_io.caption_md_path -->
<g id="node78" class="node">
<title>caption_io.caption_md_path</title>
<g id="a_node78"><a xlink:title="Return legacy Markdown caption path for ``image``.">
<polygon fill="none" stroke="black" points="9316.5,-3204.3 9129.5,-3204.3 9129.5,-3168.3 9316.5,-3168.3 9316.5,-3204.3"/>
<text text-anchor="middle" x="9223" y="-3183.06" font-family="Times,serif" font-size="12.18">caption_io.caption_md_path</text>
</a>
</g>
</g>
<!-- caption_io.has_caption&#45;&gt;caption_io.caption_md_path -->
<g id="edge99" class="edge">
<title>caption_io.has_caption&#45;&gt;caption_io.caption_md_path</title>
<path fill="none" stroke="black" d="M8424.63,-3857.84C8538.41,-3870.6 8753.48,-3877.39 8892,-3774.3 8923.28,-3751.03 8910.21,-3729 8928,-3694.3 9024.74,-3505.61 9158.48,-3288.01 9205.13,-3213.19"/>
<polygon fill="black" stroke="black" points="9208.3,-3214.72 9210.63,-3204.38 9202.37,-3211.01 9208.3,-3214.72"/>
</g>
<!-- caption_io.read_caption&#45;&gt;notes_utils.load_json -->
<g id="edge104" class="edge">
<title>caption_io.read_caption&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M8512.81,-2143.07C8652.55,-2150.85 8838.56,-2150.77 8892,-2101.3 8983.44,-2016.68 8845.24,-1916.43 8928,-1823.3 8968.16,-1778.12 9031.46,-1758.58 9089.06,-1750.77"/>
<polygon fill="black" stroke="black" points="9089.5,-1754.25 9098.99,-1749.53 9088.63,-1747.3 9089.5,-1754.25"/>
</g>
<!-- caption_io._get_langs -->
<g id="node76" class="node">
<title>caption_io._get_langs</title>
<g id="a_node76"><a xlink:title="Return configured languages, caching the result.">
<polygon fill="none" stroke="black" points="9332,-2092.3 9114,-2092.3 9114,-2056.3 9332,-2056.3 9332,-2092.3"/>
<text text-anchor="middle" x="9223" y="-2069.52" font-family="Times,serif" font-size="18.48">caption_io._get_langs</text>
</a>
</g>
</g>
<!-- caption_io.read_caption&#45;&gt;caption_io._get_langs -->
<g id="edge100" class="edge">
<title>caption_io.read_caption&#45;&gt;caption_io._get_langs</title>
<path fill="none" stroke="black" d="M8512.63,-2122.13C8620.57,-2117.1 8764.73,-2109.78 8892,-2101.3 8962.22,-2096.63 9040.76,-2090.25 9103.59,-2084.86"/>
<polygon fill="black" stroke="black" points="9104.27,-2088.32 9113.94,-2083.97 9103.67,-2081.34 9104.27,-2088.32"/>
</g>
<!-- caption_io.read_caption&#45;&gt;caption_io.caption_json_path -->
<g id="edge101" class="edge">
<title>caption_io.read_caption&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M8512.61,-2117.28C8651.15,-2110.78 8835.47,-2111.78 8892,-2157.3 8939.36,-2195.45 8883.29,-2248.09 8928,-2289.3 8978.09,-2335.48 9054.06,-2348.77 9116.22,-2350.76"/>
<polygon fill="black" stroke="black" points="9116.39,-2354.26 9126.47,-2350.99 9116.55,-2347.26 9116.39,-2354.26"/>
</g>
<!-- caption_io.read_caption&#45;&gt;caption_io.caption_md_path -->
<g id="edge102" class="edge">
<title>caption_io.read_caption&#45;&gt;caption_io.caption_md_path</title>
<path fill="none" stroke="black" d="M8512.71,-2116.01C8652.11,-2108.57 8837.67,-2108.9 8892,-2157.3 8928.01,-2189.38 8915.77,-2324.66 8928,-2371.3 9011.17,-2688.48 9165.87,-3056.44 9209.98,-3158.72"/>
<polygon fill="black" stroke="black" points="9206.83,-3160.25 9214.01,-3168.04 9213.26,-3157.47 9206.83,-3160.25"/>
</g>
<!-- caption_io.read_caption&#45;&gt;notes_utils.read_md -->
<g id="edge103" class="edge">
<title>caption_io.read_caption&#45;&gt;notes_utils.read_md</title>
<path fill="none" stroke="black" d="M8512.65,-2134.2C8700.71,-2139.8 9000.67,-2148.72 9142.6,-2152.94"/>
<polygon fill="black" stroke="black" points="9142.86,-2156.45 9152.96,-2153.25 9143.07,-2149.45 9142.86,-2156.45"/>
</g>
<!-- post_io.read_post&#45;&gt;notes_utils.read_md -->
<g id="edge189" class="edge">
<title>post_io.read_post&#45;&gt;notes_utils.read_md</title>
<path fill="none" stroke="black" d="M8539.82,-2938.23C8661.67,-2903.39 8811.17,-2838.67 8892,-2721.3 8953.55,-2631.93 8858.84,-2317.93 8928,-2234.3 8979.58,-2171.94 9074.66,-2155.91 9142.73,-2153.11"/>
<polygon fill="black" stroke="black" points="9143.11,-2156.6 9152.99,-2152.78 9142.89,-2149.6 9143.11,-2156.6"/>
</g>
<!-- post_io.read_post&#45;&gt;notes_utils._parse_block -->
<g id="edge190" class="edge">
<title>post_io.read_post&#45;&gt;notes_utils._parse_block</title>
<path fill="none" stroke="black" d="M8537.91,-2938.22C8659.75,-2903.29 8809.99,-2838.48 8892,-2721.3 8943.68,-2647.46 8867.4,-2384.02 8928,-2317.3 8957.78,-2284.52 9000.36,-2267.47 9043.89,-2259.32"/>
<polygon fill="black" stroke="black" points="9044.52,-2262.76 9053.78,-2257.62 9043.33,-2255.87 9044.52,-2262.76"/>
</g>
<!-- chop.main -->
<g id="node49" class="node">
<title>chop.main</title>
<g id="a_node49"><a xlink:title="Process a single message file passed on the command line.">
<polygon fill="none" stroke="black" points="5578,-4548.3 5427,-4548.3 5427,-4512.3 5578,-4512.3 5578,-4548.3"/>
<text text-anchor="middle" x="5502.5" y="-4524.14" font-family="Times,serif" font-size="25.20">chop.main</text>
</a>
</g>
</g>
<!-- chop.main&#45;&gt;chop.process_message -->
<g id="edge47" class="edge">
<title>chop.main&#45;&gt;chop.process_message</title>
<path fill="none" stroke="black" d="M5578.3,-4530.3C5633.86,-4530.3 5715.07,-4530.3 5803.46,-4530.3"/>
<polygon fill="black" stroke="black" points="5803.71,-4533.8 5813.71,-4530.3 5803.71,-4526.8 5803.71,-4533.8"/>
</g>
<!-- moderation.should_skip_text -->
<g id="node50" class="node">
<title>moderation.should_skip_text</title>
<g id="a_node50"><a xlink:title="Return ``True`` if ``text`` contains banned phrases.">
<polygon fill="none" stroke="black" points="9914.5,-4305.3 9626.5,-4305.3 9626.5,-4269.3 9914.5,-4269.3 9914.5,-4305.3"/>
<text text-anchor="middle" x="9770.5" y="-4282.52" font-family="Times,serif" font-size="18.48">moderation.should_skip_text</text>
</a>
</g>
</g>
<!-- moderation.should_skip_user -->
<g id="node51" class="node">
<title>moderation.should_skip_user</title>
<g id="a_node51"><a xlink:title="Return ``True`` if ``username`` is blacklisted.">
<polygon fill="none" stroke="black" points="9894.5,-4251.3 9646.5,-4251.3 9646.5,-4215.3 9894.5,-4215.3 9894.5,-4251.3"/>
<text text-anchor="middle" x="9770.5" y="-4229.26" font-family="Times,serif" font-size="15.68">moderation.should_skip_user</text>
</a>
</g>
</g>
<!-- moderation.message_skip_reason&#45;&gt;moderation.should_skip_text -->
<g id="edge48" class="edge">
<title>moderation.message_skip_reason&#45;&gt;moderation.should_skip_text</title>
<path fill="none" stroke="black" d="M9518.3,-4274.87C9551.99,-4276.54 9585.23,-4278.18 9615.96,-4279.7"/>
<polygon fill="black" stroke="black" points="9616.12,-4283.22 9626.28,-4280.22 9616.46,-4276.23 9616.12,-4283.22"/>
</g>
<!-- moderation.message_skip_reason&#45;&gt;moderation.should_skip_user -->
<g id="edge49" class="edge">
<title>moderation.message_skip_reason&#45;&gt;moderation.should_skip_user</title>
<path fill="none" stroke="black" d="M9518.3,-4245.74C9559.59,-4243.69 9600.21,-4241.68 9636.35,-4239.89"/>
<polygon fill="black" stroke="black" points="9636.61,-4243.39 9646.42,-4239.4 9636.26,-4236.39 9636.61,-4243.39"/>
</g>
<!-- moderation.lot_skip_reason -->
<g id="node53" class="node">
<title>moderation.lot_skip_reason</title>
<g id="a_node53"><a xlink:title="Return the moderation reason for ``lot`` or ``None``.">
<polygon fill="none" stroke="black" points="9399.5,-3739.3 9046.5,-3739.3 9046.5,-3703.3 9399.5,-3703.3 9399.5,-3739.3"/>
<text text-anchor="middle" x="9223" y="-3715.43" font-family="Times,serif" font-size="24.22">moderation.lot_skip_reason</text>
</a>
</g>
</g>
<!-- moderation.should_skip_lot -->
<g id="node54" class="node">
<title>moderation.should_skip_lot</title>
<g id="a_node54"><a xlink:title="Return ``True`` when the lot fails additional checks.">
<polygon fill="none" stroke="black" points="8485,-3631.3 8209,-3631.3 8209,-3595.3 8485,-3595.3 8485,-3631.3"/>
<text text-anchor="middle" x="8347" y="-3608.52" font-family="Times,serif" font-size="18.48">moderation.should_skip_lot</text>
</a>
</g>
</g>
<!-- moderation.should_skip_lot&#45;&gt;moderation.lot_skip_reason -->
<g id="edge51" class="edge">
<title>moderation.should_skip_lot&#45;&gt;moderation.lot_skip_reason</title>
<path fill="none" stroke="black" d="M8485.04,-3614.17C8595.44,-3616.47 8754.39,-3623.41 8892,-3643.3 8982.2,-3656.35 9083.98,-3682.14 9150.35,-3700.49"/>
<polygon fill="black" stroke="black" points="9149.71,-3703.94 9160.29,-3703.25 9151.59,-3697.2 9149.71,-3703.94"/>
</g>
<!-- moderation.is_misparsed -->
<g id="node55" class="node">
<title>moderation.is_misparsed</title>
<g id="a_node55"><a xlink:title="Return ``True`` for obviously invalid lots or source posts.">
<polygon fill="none" stroke="black" points="7527,-2938.3 7091,-2938.3 7091,-2894.3 7527,-2894.3 7527,-2938.3"/>
<text text-anchor="middle" x="7309" y="-2907.98" font-family="Times,serif" font-size="32.90">moderation.is_misparsed</text>
</a>
</g>
</g>
<!-- lot_io.get_seller -->
<g id="node56" class="node">
<title>lot_io.get_seller</title>
<g id="a_node56"><a xlink:title="Return the seller identifier or ``None`` when missing.">
<polygon fill="none" stroke="black" points="8447.5,-2712.3 8246.5,-2712.3 8246.5,-2676.3 8447.5,-2676.3 8447.5,-2712.3"/>
<text text-anchor="middle" x="8347" y="-2688.71" font-family="Times,serif" font-size="23.24">lot_io.get_seller</text>
</a>
</g>
</g>
<!-- moderation.is_misparsed&#45;&gt;lot_io.get_seller -->
<g id="edge52" class="edge">
<title>moderation.is_misparsed&#45;&gt;lot_io.get_seller</title>
<path fill="none" stroke="black" d="M7527.12,-2909.44C7603.19,-2904.33 7688.86,-2895.5 7766,-2880.3 7965.01,-2841.09 8191.41,-2756.22 8292.43,-2716.12"/>
<polygon fill="black" stroke="black" points="8293.81,-2719.34 8301.81,-2712.39 8291.22,-2712.84 8293.81,-2719.34"/>
</g>
<!-- moderation.apply_to_history -->
<g id="node57" class="node">
<title>moderation.apply_to_history</title>
<g id="a_node57"><a xlink:title="Remove processed lots now failing moderation.">
<polygon fill="none" stroke="black" points="7565,-3566.3 7053,-3566.3 7053,-3520.3 7565,-3520.3 7565,-3566.3"/>
<text text-anchor="middle" x="7309" y="-3534.86" font-family="Times,serif" font-size="34.30">moderation.apply_to_history</text>
</a>
</g>
</g>
<!-- moderation.apply_to_history&#45;&gt;lot_io.read_lots -->
<g id="edge57" class="edge">
<title>moderation.apply_to_history&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M7448.06,-3520.3C7544.49,-3511.6 7672.23,-3515.53 7766,-3575.3 7793.85,-3593.06 7774.02,-3622.76 7802,-3640.3 7940.86,-3727.37 8140.96,-3710.32 8255.79,-3690.21"/>
<polygon fill="black" stroke="black" points="8256.72,-3693.6 8265.95,-3688.38 8255.48,-3686.71 8256.72,-3693.6"/>
</g>
<!-- moderation.apply_to_history&#45;&gt;moderation.should_skip_message -->
<g id="edge53" class="edge">
<title>moderation.apply_to_history&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M7565.03,-3532.66C7652.67,-3534.82 7736.27,-3545.41 7766,-3575.3 7853.31,-3663.09 7713.79,-4044.42 7802,-4131.3 7852.52,-4181.07 8030.6,-4181.79 8169.41,-4173.85"/>
<polygon fill="black" stroke="black" points="8169.98,-4177.32 8179.76,-4173.24 8169.57,-4170.33 8169.98,-4177.32"/>
</g>
<!-- moderation.apply_to_history&#45;&gt;post_io.read_post -->
<g id="edge55" class="edge">
<title>moderation.apply_to_history&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7565.23,-3552.85C7652.27,-3550.47 7735.4,-3540.02 7766,-3511.3 7853.63,-3429.06 7731.78,-3340.83 7802,-3243.3 7888.19,-3123.6 8043.14,-3054.93 8165.68,-3017.3"/>
<polygon fill="black" stroke="black" points="8167.01,-3020.55 8175.57,-3014.31 8164.98,-3013.85 8167.01,-3020.55"/>
</g>
<!-- moderation.apply_to_history&#45;&gt;moderation.should_skip_lot -->
<g id="edge54" class="edge">
<title>moderation.apply_to_history&#45;&gt;moderation.should_skip_lot</title>
<path fill="none" stroke="black" d="M7565.09,-3560.54C7764.18,-3573.99 8033.78,-3592.21 8198.5,-3603.34"/>
<polygon fill="black" stroke="black" points="8198.5,-3606.85 8208.71,-3604.03 8198.97,-3599.86 8198.5,-3606.85"/>
</g>
<!-- post_io.raw_post_path -->
<g id="node58" class="node">
<title>post_io.raw_post_path</title>
<g id="a_node58"><a xlink:title="Return absolute message path for ``rel`` under ``root``.">
<polygon fill="none" stroke="black" points="8423.5,-2408.3 8270.5,-2408.3 8270.5,-2372.3 8423.5,-2372.3 8423.5,-2408.3"/>
<text text-anchor="middle" x="8347" y="-2387.06" font-family="Times,serif" font-size="12.18">post_io.raw_post_path</text>
</a>
</g>
</g>
<!-- moderation.apply_to_history&#45;&gt;post_io.raw_post_path -->
<g id="edge56" class="edge">
<title>moderation.apply_to_history&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7565.06,-3554.29C7652.86,-3552.19 7736.56,-3541.56 7766,-3511.3 7831.45,-3444.03 7751.25,-2746.27 7802,-2667.3 7905.77,-2505.84 8134.95,-2434.2 8260.19,-2406.1"/>
<polygon fill="black" stroke="black" points="8261.11,-2409.48 8270.13,-2403.91 8259.61,-2402.64 8261.11,-2409.48"/>
</g>
<!-- build_site._load_ontology -->
<g id="node59" class="node">
<title>build_site._load_ontology</title>
<g id="a_node59"><a xlink:title="Return sorted field list from ``ONTOLOGY`` or empty list when missing.">
<polygon fill="none" stroke="black" points="8503.5,-891.3 8190.5,-891.3 8190.5,-855.3 8503.5,-855.3 8503.5,-891.3"/>
<text text-anchor="middle" x="8347" y="-867.71" font-family="Times,serif" font-size="23.24">build_site._load_ontology</text>
</a>
</g>
</g>
<!-- build_site._load_ontology&#45;&gt;notes_utils.load_json -->
<g id="edge58" class="edge">
<title>build_site._load_ontology&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M8503.64,-858.82C8645.06,-849.46 8839.4,-847.43 8892,-900.3 8955.61,-964.25 8866.96,-1644.9 8928,-1711.3 8967.92,-1754.73 9031.03,-1766.89 9088.56,-1767.07"/>
<polygon fill="black" stroke="black" points="9088.89,-1770.57 9098.86,-1766.98 9088.82,-1763.57 9088.89,-1770.57"/>
</g>
<!-- build_site._compile_locale -->
<g id="node60" class="node">
<title>build_site._compile_locale</title>
<g id="a_node60"><a xlink:title="Compile ``lang`` gettext catalogue when out of date.">
<polygon fill="none" stroke="black" points="9390,-378.3 9056,-378.3 9056,-342.3 9390,-342.3 9390,-378.3"/>
<text text-anchor="middle" x="9223" y="-354.43" font-family="Times,serif" font-size="24.22">build_site._compile_locale</text>
</a>
</g>
</g>
<!-- build_site._env_for_lang -->
<g id="node61" class="node">
<title>build_site._env_for_lang</title>
<g id="a_node61"><a xlink:title="Return Jinja environment configured for ``lang``.">
<polygon fill="none" stroke="black" points="8535.5,-387.8 8158.5,-387.8 8158.5,-346.8 8535.5,-346.8 8535.5,-387.8"/>
<text text-anchor="middle" x="8347" y="-360.06" font-family="Times,serif" font-size="29.68">build_site._env_for_lang</text>
</a>
</g>
</g>
<!-- build_site._env_for_lang&#45;&gt;build_site._compile_locale -->
<g id="edge59" class="edge">
<title>build_site._env_for_lang&#45;&gt;build_site._compile_locale</title>
<path fill="none" stroke="black" d="M8535.76,-365.8C8686.92,-364.59 8897.85,-362.9 9045.83,-361.72"/>
<polygon fill="black" stroke="black" points="9045.96,-365.21 9055.93,-361.63 9045.91,-358.21 9045.96,-365.21"/>
</g>
<!-- build_site._iter_lots -->
<g id="node62" class="node">
<title>build_site._iter_lots</title>
<g id="a_node62"><a xlink:title="Return all lots ready for rendering.">
<polygon fill="none" stroke="black" points="7535,-3641.8 7083,-3641.8 7083,-3584.8 7535,-3584.8 7535,-3641.8"/>
<text text-anchor="middle" x="7309" y="-3602.41" font-family="Times,serif" font-size="44.24">build_site._iter_lots</text>
</a>
</g>
</g>
<!-- build_site._iter_lots&#45;&gt;lot_io.read_lots -->
<g id="edge64" class="edge">
<title>build_site._iter_lots&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M7535.12,-3625.69C7749.46,-3637.48 8063.47,-3654.76 8230.88,-3663.97"/>
<polygon fill="black" stroke="black" points="8230.78,-3667.47 8240.96,-3664.52 8231.17,-3660.48 8230.78,-3667.47"/>
</g>
<!-- build_site._iter_lots&#45;&gt;moderation.should_skip_message -->
<g id="edge60" class="edge">
<title>build_site._iter_lots&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M7535.12,-3596.37C7619.09,-3602.55 7708.01,-3626.24 7766,-3689.3 7832.7,-3761.85 7731.22,-4062.73 7802,-4131.3 7852.94,-4180.65 8030.94,-4181.44 8169.62,-4173.63"/>
<polygon fill="black" stroke="black" points="8170.18,-4177.11 8179.96,-4173.03 8169.77,-4170.12 8170.18,-4177.11"/>
</g>
<!-- build_site._iter_lots&#45;&gt;post_io.read_post -->
<g id="edge62" class="edge">
<title>build_site._iter_lots&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7435.15,-3641.84C7538.09,-3657.25 7680.49,-3658.72 7766,-3575.3 7819.12,-3523.49 7759.41,-3304.08 7802,-3243.3 7886.14,-3123.24 8039.87,-3054.78 8162.5,-3017.31"/>
<polygon fill="black" stroke="black" points="8163.82,-3020.57 8172.39,-3014.33 8161.8,-3013.86 8163.82,-3020.57"/>
</g>
<!-- build_site._iter_lots&#45;&gt;moderation.should_skip_lot -->
<g id="edge61" class="edge">
<title>build_site._iter_lots&#45;&gt;moderation.should_skip_lot</title>
<path fill="none" stroke="black" d="M7535.12,-3613.3C7736.3,-3613.3 8025.27,-3613.3 8198.42,-3613.3"/>
<polygon fill="black" stroke="black" points="8198.63,-3616.8 8208.63,-3613.3 8198.63,-3609.8 8198.63,-3616.8"/>
</g>
<!-- build_site._iter_lots&#45;&gt;post_io.raw_post_path -->
<g id="edge63" class="edge">
<title>build_site._iter_lots&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7427.67,-3641.85C7532.12,-3659.43 7680.98,-3664.1 7766,-3575.3 7835.83,-3502.37 7747.54,-2752.32 7802,-2667.3 7905.53,-2505.69 8134.81,-2434.11 8260.13,-2406.06"/>
<polygon fill="black" stroke="black" points="8261.06,-2409.44 8270.07,-2403.88 8259.55,-2402.6 8261.06,-2409.44"/>
</g>
<!-- lot_io.iter_lot_files -->
<g id="node63" class="node">
<title>lot_io.iter_lot_files</title>
<g id="a_node63"><a xlink:title="Return ``*.json`` files under ``root``.&#10;&#10;When ``newest_first`` is ``True`` the result is ordered by modification&#10;time with the most recently changed files first. &#160;Both ``build_site.py`` and&#10;``pending_embed.py`` rely on this helper so they scan the lot directory in&#10;the same order.">
<polygon fill="none" stroke="black" points="8475.5,-3765.8 8218.5,-3765.8 8218.5,-3728.8 8475.5,-3728.8 8475.5,-3765.8"/>
<text text-anchor="middle" x="8347" y="-3740.86" font-family="Times,serif" font-size="26.18">lot_io.iter_lot_files</text>
</a>
</g>
</g>
<!-- build_site._iter_lots&#45;&gt;lot_io.iter_lot_files -->
<g id="edge65" class="edge">
<title>build_site._iter_lots&#45;&gt;lot_io.iter_lot_files</title>
<path fill="none" stroke="black" d="M7494.83,-3641.81C7577.91,-3655.21 7677.07,-3672.03 7766,-3689.3 7782.09,-3692.43 7785.81,-3694.77 7802,-3697.3 7939.44,-3718.8 8097.96,-3732.08 8208.29,-3739.5"/>
<polygon fill="black" stroke="black" points="8208.27,-3743 8218.48,-3740.18 8208.74,-3736.02 8208.27,-3743"/>
</g>
<!-- build_site._copy_images -->
<g id="node64" class="node">
<title>build_site._copy_images</title>
<g id="a_node64"><a xlink:title="Copy media referenced by ``lots`` into ``VIEWS_DIR``.">
<polygon fill="none" stroke="black" points="9386.5,-853.3 9059.5,-853.3 9059.5,-817.3 9386.5,-817.3 9386.5,-853.3"/>
<text text-anchor="middle" x="9223" y="-829.14" font-family="Times,serif" font-size="25.20">build_site._copy_images</text>
</a>
</g>
</g>
<!-- build_site._copy_static -->
<g id="node65" class="node">
<title>build_site._copy_static</title>
<g id="a_node65"><a xlink:title="Copy CSS and JS so generated pages are standalone.">
<polygon fill="none" stroke="black" points="7437,-350.3 7181,-350.3 7181,-314.3 7437,-314.3 7437,-350.3"/>
<text text-anchor="middle" x="7309" y="-327" font-family="Times,serif" font-size="21.00">build_site._copy_static</text>
</a>
</g>
</g>
<!-- build_site._convert_prices -->
<g id="node66" class="node">
<title>build_site._convert_prices</title>
<g id="a_node66"><a xlink:title="Add `_display_price` and `_price_class` fields converted to `cur`.">
<polygon fill="none" stroke="black" points="8602.5,-136.8 8091.5,-136.8 8091.5,-87.8 8602.5,-87.8 8602.5,-136.8"/>
<text text-anchor="middle" x="8347" y="-102.68" font-family="Times,serif" font-size="37.66">build_site._convert_prices</text>
</a>
</g>
</g>
<!-- price_utils.canonical_currency -->
<g id="node67" class="node">
<title>price_utils.canonical_currency</title>
<g id="a_node67"><a xlink:title="Return canonical currency code or ``None`` when unknown.">
<polygon fill="none" stroke="black" points="9402.5,-130.3 9043.5,-130.3 9043.5,-94.3 9402.5,-94.3 9402.5,-130.3"/>
<text text-anchor="middle" x="9223" y="-106.61" font-family="Times,serif" font-size="22.12">price_utils.canonical_currency</text>
</a>
</g>
</g>
<!-- build_site._convert_prices&#45;&gt;price_utils.canonical_currency -->
<g id="edge66" class="edge">
<title>build_site._convert_prices&#45;&gt;price_utils.canonical_currency</title>
<path fill="none" stroke="black" d="M8602.56,-112.3C8740.18,-112.3 8907.23,-112.3 9033.16,-112.3"/>
<polygon fill="black" stroke="black" points="9033.3,-115.8 9043.3,-112.3 9033.3,-108.8 9033.3,-115.8"/>
</g>
<!-- build_site._load_state -->
<g id="node68" class="node">
<title>build_site._load_state</title>
<g id="a_node68"><a xlink:title="Return ontology fields, embeddings, lots and similarity cache.">
<polygon fill="none" stroke="black" points="6454.5,-902.3 6175.5,-902.3 6175.5,-866.3 6454.5,-866.3 6454.5,-902.3"/>
<text text-anchor="middle" x="6315" y="-878.43" font-family="Times,serif" font-size="24.22">build_site._load_state</text>
</a>
</g>
</g>
<!-- build_site._load_state&#45;&gt;similar_utils._load_embeddings -->
<g id="edge67" class="edge">
<title>build_site._load_state&#45;&gt;similar_utils._load_embeddings</title>
<path fill="none" stroke="black" d="M6454.75,-895.26C6562.92,-903.53 6716.94,-914.71 6852,-922.3 7257.93,-945.13 7361.6,-918.36 7766,-960.3 7782.13,-961.98 7785.88,-964.52 7802,-966.3 7892.53,-976.31 7991.91,-983.04 8080.69,-987.53"/>
<polygon fill="black" stroke="black" points="8080.75,-991.04 8090.91,-988.04 8081.09,-984.05 8080.75,-991.04"/>
</g>
<!-- build_site._load_state&#45;&gt;similar_utils._load_similar -->
<g id="edge68" class="edge">
<title>build_site._load_state&#45;&gt;similar_utils._load_similar</title>
<path fill="none" stroke="black" d="M6454.73,-887.65C6790.83,-895.77 7652.91,-916.57 8087.43,-927.06"/>
<polygon fill="black" stroke="black" points="8087.53,-930.57 8097.61,-927.31 8087.7,-923.57 8087.53,-930.57"/>
</g>
<!-- build_site._load_state&#45;&gt;build_site._load_ontology -->
<g id="edge69" class="edge">
<title>build_site._load_state&#45;&gt;build_site._load_ontology</title>
<path fill="none" stroke="black" d="M6454.73,-883.55C6816.75,-881.59 7789.02,-876.32 8179.91,-874.2"/>
<polygon fill="black" stroke="black" points="8180.19,-877.7 8190.17,-874.15 8180.15,-870.7 8180.19,-877.7"/>
</g>
<!-- build_site._load_state&#45;&gt;build_site._iter_lots -->
<g id="edge70" class="edge">
<title>build_site._load_state&#45;&gt;build_site._iter_lots</title>
<path fill="none" stroke="black" d="M6454.78,-889.74C6572.08,-902.53 6733.78,-941.22 6816,-1054.3 6898.37,-1167.59 6756.42,-3472.91 6852,-3575.3 6934.05,-3663.21 7078.49,-3660.45 7182.86,-3643.5"/>
<polygon fill="black" stroke="black" points="7183.55,-3646.94 7192.83,-3641.82 7182.39,-3640.03 7183.55,-3646.94"/>
</g>
<!-- build_site._load_state&#45;&gt;build_site._copy_images -->
<g id="edge71" class="edge">
<title>build_site._load_state&#45;&gt;build_site._copy_images</title>
<path fill="none" stroke="black" d="M6454.53,-879.94C6717.26,-871.84 7306.09,-854.57 7802,-846.3 8251.78,-838.81 8781.79,-836.41 9049.16,-835.65"/>
<polygon fill="black" stroke="black" points="9049.35,-839.15 9059.34,-835.62 9049.33,-832.15 9049.35,-839.15"/>
</g>
<!-- build_site._categorise -->
<g id="node69" class="node">
<title>build_site._categorise</title>
<g id="a_node69"><a xlink:title="Return category info and recent lot list.">
<polygon fill="none" stroke="black" points="6569.5,-1659.8 6060.5,-1659.8 6060.5,-1602.8 6569.5,-1602.8 6569.5,-1659.8"/>
<text text-anchor="middle" x="6315" y="-1619.96" font-family="Times,serif" font-size="44.80">build_site._categorise</text>
</a>
</g>
</g>
<!-- build_site._categorise&#45;&gt;lot_io.get_seller -->
<g id="edge72" class="edge">
<title>build_site._categorise&#45;&gt;lot_io.get_seller</title>
<path fill="none" stroke="black" d="M6569.57,-1620.73C6674.78,-1622.22 6780.57,-1633.4 6816,-1669.3 6905.77,-1760.27 6762.55,-2152.02 6852,-2243.3 6994.64,-2388.88 7603.85,-2195.82 7766,-2319.3 7802.92,-2347.42 7771.2,-2382.6 7802,-2417.3 7928.77,-2560.12 8146.58,-2639.12 8264.48,-2673.39"/>
<polygon fill="black" stroke="black" points="8263.6,-2676.78 8274.18,-2676.17 8265.53,-2670.05 8263.6,-2676.78"/>
</g>
<!-- build_site._render_site -->
<g id="node70" class="node">
<title>build_site._render_site</title>
<g id="a_node70"><a xlink:title="Render all HTML pages for ``lots`` using cached templates.">
<polygon fill="none" stroke="black" points="6752.5,-1154.8 5877.5,-1154.8 5877.5,-1063.8 6752.5,-1063.8 6752.5,-1154.8"/>
<text text-anchor="middle" x="6315" y="-1090.77" font-family="Times,serif" font-size="75.04">build_site._render_site</text>
</a>
</g>
</g>
<!-- build_site._render_site&#45;&gt;notes_utils.read_text -->
<g id="edge75" class="edge">
<title>build_site._render_site&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M6735.95,-1063.8C6775.14,-1060.76 6814.29,-1058.16 6852,-1056.3 7304.79,-1033.97 8439.69,-1032.75 8892,-1063.3 9171.9,-1082.21 9251.02,-1058.14 9518,-1144.3 9600.99,-1171.09 9688.51,-1225.16 9735.27,-1256.45"/>
<polygon fill="black" stroke="black" points="9733.54,-1259.51 9743.79,-1262.2 9737.46,-1253.71 9733.54,-1259.51"/>
</g>
<!-- build_site._render_site&#45;&gt;similar_utils._format_vector -->
<g id="edge73" class="edge">
<title>build_site._render_site&#45;&gt;similar_utils._format_vector</title>
<path fill="none" stroke="black" d="M6752.69,-1071.15C7115.08,-1047.42 7597.35,-1036.62 7766,-1128.3 7791.34,-1142.08 7778.04,-1166.25 7802,-1182.3 7923.11,-1263.44 8091.14,-1286.74 8208.3,-1292.23"/>
<polygon fill="black" stroke="black" points="8208.27,-1295.73 8218.41,-1292.66 8208.57,-1288.74 8208.27,-1295.73"/>
</g>
<!-- build_site._render_site&#45;&gt;lot_io.get_seller -->
<g id="edge76" class="edge">
<title>build_site._render_site&#45;&gt;lot_io.get_seller</title>
<path fill="none" stroke="black" d="M6666.19,-1154.9C6723.98,-1177.65 6777.49,-1210.9 6816,-1259.3 6892.95,-1356.02 6763.65,-1727.88 6852,-1814.3 6924.67,-1885.38 7693.37,-1782.19 7766,-1853.3 7855.74,-1941.17 7732.99,-2312.38 7802,-2417.3 7902.54,-2570.16 8114.85,-2642.82 8242.48,-2673.94"/>
<polygon fill="black" stroke="black" points="8241.74,-2677.36 8252.28,-2676.29 8243.37,-2670.55 8241.74,-2677.36"/>
</g>
<!-- build_site.build_page -->
<g id="node71" class="node">
<title>build_site.build_page</title>
<g id="a_node71"><a xlink:title="Render ``lot`` into separate HTML files for every language.">
<polygon fill="none" stroke="black" points="7763,-1351.8 6855,-1351.8 6855,-1252.8 7763,-1252.8 7763,-1351.8"/>
<text text-anchor="middle" x="7309" y="-1281.28" font-family="Times,serif" font-size="83.16">build_site.build_page</text>
</a>
</g>
</g>
<!-- build_site._render_site&#45;&gt;build_site.build_page -->
<g id="edge74" class="edge">
<title>build_site._render_site&#45;&gt;build_site.build_page</title>
<path fill="none" stroke="black" d="M6477.35,-1154.85C6583.19,-1183.44 6725,-1219.3 6852,-1243.3 6866.1,-1245.97 6880.47,-1248.55 6895,-1251.05"/>
<polygon fill="black" stroke="black" points="6894.64,-1254.54 6905.08,-1252.76 6895.81,-1247.64 6894.64,-1254.54"/>
</g>
<!-- build_site.build_page&#45;&gt;similar_utils._format_vector -->
<g id="edge77" class="edge">
<title>build_site.build_page&#45;&gt;similar_utils._format_vector</title>
<path fill="none" stroke="black" d="M7763.27,-1297.49C7924.28,-1295.78 8093.77,-1293.98 8208.18,-1292.77"/>
<polygon fill="black" stroke="black" points="8208.43,-1296.27 8218.39,-1292.66 8208.35,-1289.27 8208.43,-1296.27"/>
</g>
<!-- build_site.build_page&#45;&gt;caption_io.read_caption -->
<g id="edge79" class="edge">
<title>build_site.build_page&#45;&gt;caption_io.read_caption</title>
<path fill="none" stroke="black" d="M7756.82,-1351.96C7759.96,-1354.96 7763.02,-1358.08 7766,-1361.3 7821.83,-1421.8 7743.87,-2043.01 7802,-2101.3 7852.28,-2151.73 8031.68,-2152.52 8170.88,-2144.62"/>
<polygon fill="black" stroke="black" points="8171.47,-2148.09 8181.25,-2144.01 8171.06,-2141.1 8171.47,-2148.09"/>
</g>
<!-- build_site.build_page&#45;&gt;post_io.read_post -->
<g id="edge80" class="edge">
<title>build_site.build_page&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7756.93,-1351.86C7760.03,-1354.9 7763.06,-1358.05 7766,-1361.3 7816.64,-1417.41 7760.61,-2658.06 7802,-2721.3 7877.07,-2836.02 8018.46,-2900.16 8138.28,-2935.42"/>
<polygon fill="black" stroke="black" points="8137.39,-2938.8 8147.97,-2938.22 8139.33,-2932.08 8137.39,-2938.8"/>
</g>
<!-- build_site.build_page&#45;&gt;post_io.raw_post_path -->
<g id="edge81" class="edge">
<title>build_site.build_page&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7756.85,-1351.93C7759.98,-1354.94 7763.03,-1358.07 7766,-1361.3 7829.9,-1430.97 7744.97,-2135.92 7802,-2211.3 7910.23,-2354.37 8136.12,-2384.69 8260.06,-2390.12"/>
<polygon fill="black" stroke="black" points="8260.14,-2393.63 8270.27,-2390.52 8260.41,-2386.63 8260.14,-2393.63"/>
</g>
<!-- build_site.build_page&#45;&gt;build_site._env_for_lang -->
<g id="edge78" class="edge">
<title>build_site.build_page&#45;&gt;build_site._env_for_lang</title>
<path fill="none" stroke="black" d="M7756.84,-1252.67C7759.97,-1249.66 7763.03,-1246.54 7766,-1243.3 7826.82,-1177.14 7741.04,-501.33 7802,-435.3 7848.1,-385.37 8012.04,-369.99 8148.01,-366.14"/>
<polygon fill="black" stroke="black" points="8148.26,-369.64 8158.16,-365.88 8148.07,-362.64 8148.26,-369.64"/>
</g>
<!-- build_site.main -->
<g id="node72" class="node">
<title>build_site.main</title>
<g id="a_node72"><a xlink:title="Build the static site under ``VIEWS_DIR``.">
<polygon fill="none" stroke="black" points="5707.5,-574.3 5297.5,-574.3 5297.5,-510.3 5707.5,-510.3 5707.5,-574.3"/>
<text text-anchor="middle" x="5502.5" y="-529.54" font-family="Times,serif" font-size="50.96">build_site.main</text>
</a>
</g>
</g>
<!-- build_site.main&#45;&gt;similar_utils._save_similar -->
<g id="edge82" class="edge">
<title>build_site.main&#45;&gt;similar_utils._save_similar</title>
<path fill="none" stroke="black" d="M5528.38,-574.44C5595.18,-660.34 5775.98,-890.21 5814,-911.3 6207.36,-1129.54 6372.8,-977.26 6816,-1054.3 6956.99,-1078.81 7119.41,-1113.41 7217.84,-1135.08"/>
<polygon fill="black" stroke="black" points="7217.23,-1138.53 7227.75,-1137.27 7218.74,-1131.7 7217.23,-1138.53"/>
</g>
<!-- build_site.main&#45;&gt;similar_utils._prune_similar -->
<g id="edge83" class="edge">
<title>build_site.main&#45;&gt;similar_utils._prune_similar</title>
<path fill="none" stroke="black" d="M5707.5,-553.88C5850.06,-561.97 6037.16,-572.59 6165.64,-579.88"/>
<polygon fill="black" stroke="black" points="6165.77,-583.4 6175.95,-580.47 6166.16,-576.41 6165.77,-583.4"/>
</g>
<!-- build_site.main&#45;&gt;similar_utils._calc_similar_nn -->
<g id="edge84" class="edge">
<title>build_site.main&#45;&gt;similar_utils._calc_similar_nn</title>
<path fill="none" stroke="black" d="M5707.56,-544.25C5965.69,-546.94 6423.85,-552.49 6816,-561.3 6824.52,-561.5 6833.12,-561.7 6841.79,-561.9"/>
<polygon fill="black" stroke="black" points="6841.91,-565.41 6851.99,-562.15 6842.08,-558.41 6841.91,-565.41"/>
</g>
<!-- build_site.main&#45;&gt;similar_utils._sync_embeddings -->
<g id="edge85" class="edge">
<title>build_site.main&#45;&gt;similar_utils._sync_embeddings</title>
<path fill="none" stroke="black" d="M5521.13,-510.13C5561.79,-439.72 5669.81,-273.16 5814,-209.3 6018.76,-118.63 7501.57,-150.76 8098.26,-167.64"/>
<polygon fill="black" stroke="black" points="8098.19,-171.14 8108.29,-167.93 8098.39,-164.15 8098.19,-171.14"/>
</g>
<!-- build_site.main&#45;&gt;similar_utils._similar_by_user -->
<g id="edge86" class="edge">
<title>build_site.main&#45;&gt;similar_utils._similar_by_user</title>
<path fill="none" stroke="black" d="M5539.94,-574.45C5600.83,-630.55 5722.1,-752.95 5778,-884.3 5826.96,-999.35 5731.42,-1069.43 5814,-1163.3 5861.27,-1217.04 5927.6,-1250.01 5996.55,-1269.93"/>
<polygon fill="black" stroke="black" points="5995.72,-1273.33 6006.29,-1272.66 5997.6,-1266.59 5995.72,-1273.33"/>
</g>
<!-- build_site.main&#45;&gt;build_site._env_for_lang -->
<g id="edge87" class="edge">
<title>build_site.main&#45;&gt;build_site._env_for_lang</title>
<path fill="none" stroke="black" d="M5535.17,-510.02C5587.59,-459.11 5698.15,-362.08 5814,-324.3 6252.68,-181.26 6390.61,-309.53 6852,-305.3 7258.21,-301.59 7386.3,-160.94 7766,-305.3 7786.01,-312.91 7782.21,-329.15 7802,-337.3 7910.55,-382.03 8041.72,-390.44 8148.06,-387.23"/>
<polygon fill="black" stroke="black" points="8148.4,-390.72 8158.27,-386.89 8148.16,-383.73 8148.4,-390.72"/>
</g>
<!-- build_site.main&#45;&gt;build_site._copy_static -->
<g id="edge88" class="edge">
<title>build_site.main&#45;&gt;build_site._copy_static</title>
<path fill="none" stroke="black" d="M5572.39,-510.29C5634.21,-483.15 5728.16,-445.78 5814,-427.3 6304.74,-321.69 6905.39,-321.36 7170.77,-327.57"/>
<polygon fill="black" stroke="black" points="7170.76,-331.07 7180.84,-327.81 7170.93,-324.07 7170.76,-331.07"/>
</g>
<!-- build_site.main&#45;&gt;build_site._convert_prices -->
<g id="edge89" class="edge">
<title>build_site.main&#45;&gt;build_site._convert_prices</title>
<path fill="none" stroke="black" d="M5516.65,-510.13C5551.26,-430.32 5653.45,-223.94 5814,-144.3 6012.78,-45.71 7472.8,-82.72 8081.11,-102.77"/>
<polygon fill="black" stroke="black" points="8081.23,-106.28 8091.34,-103.11 8081.46,-99.28 8081.23,-106.28"/>
</g>
<!-- build_site.main&#45;&gt;price_utils.canonical_currency -->
<g id="edge94" class="edge">
<title>build_site.main&#45;&gt;price_utils.canonical_currency</title>
<path fill="none" stroke="black" d="M5513.02,-510.26C5541.41,-421.27 5634.87,-171.32 5814,-75.3 6115.43,86.26 8550.47,-60.3 8892,-78.3 8949.39,-81.33 9012.19,-87.16 9067.45,-93.15"/>
<polygon fill="black" stroke="black" points="9067.35,-96.67 9077.67,-94.27 9068.11,-89.71 9067.35,-96.67"/>
</g>
<!-- build_site.main&#45;&gt;build_site._load_state -->
<g id="edge90" class="edge">
<title>build_site.main&#45;&gt;build_site._load_state</title>
<path fill="none" stroke="black" d="M5579.39,-574.33C5742.33,-643.08 6122.18,-803.36 6261.53,-862.16"/>
<polygon fill="black" stroke="black" points="6260.57,-865.56 6271.14,-866.22 6263.29,-859.11 6260.57,-865.56"/>
</g>
<!-- build_site.main&#45;&gt;build_site._categorise -->
<g id="edge91" class="edge">
<title>build_site.main&#45;&gt;build_site._categorise</title>
<path fill="none" stroke="black" d="M5541.54,-574.45C5604.24,-630.09 5727.37,-751.24 5778,-884.3 5806.05,-958.03 5758.93,-1536.83 5814,-1593.3 5848.08,-1628.25 5948.25,-1639.87 6050.06,-1641.9"/>
<polygon fill="black" stroke="black" points="6050.18,-1645.4 6060.24,-1642.07 6050.3,-1638.4 6050.18,-1645.4"/>
</g>
<!-- build_site.main&#45;&gt;build_site._render_site -->
<g id="edge92" class="edge">
<title>build_site.main&#45;&gt;build_site._render_site</title>
<path fill="none" stroke="black" d="M5534.41,-574.51C5589.01,-632.64 5703.75,-760.6 5778,-884.3 5798.9,-919.13 5783.47,-941.51 5814,-968.3 5861.69,-1010.17 5920.94,-1039.67 5981.79,-1060.44"/>
<polygon fill="black" stroke="black" points="5980.97,-1063.86 5991.56,-1063.7 5983.18,-1057.22 5980.97,-1063.86"/>
</g>
<!-- config_utils.load_config -->
<g id="node73" class="node">
<title>config_utils.load_config</title>
<g id="a_node73"><a xlink:title="Return the ``config`` module or exit with a helpful message.&#10;&#10;When running the scripts directly from ``src/`` the repository root isn&#39;t on&#10;``sys.path`` and ``config.py`` can&#39;t be imported. &#160;Try adding the parent&#10;directory before failing so the configuration can live alongside&#10;``config.example.py`` in the project root.">
<polygon fill="none" stroke="black" points="9987,-797.8 9554,-797.8 9554,-750.8 9987,-750.8 9987,-797.8"/>
<text text-anchor="middle" x="9770.5" y="-765.8" font-family="Times,serif" font-size="35.00">config_utils.load_config</text>
</a>
</g>
</g>
<!-- build_site.main&#45;&gt;config_utils.load_config -->
<g id="edge93" class="edge">
<title>build_site.main&#45;&gt;config_utils.load_config</title>
<path fill="none" stroke="black" d="M5525.32,-510.08C5570.41,-446.68 5680.9,-307.21 5814,-253.3 5967.89,-190.98 7141.97,-223.3 7308,-223.3 7308,-223.3 7308,-223.3 8348,-223.3 8609.15,-223.3 9302.24,-186.19 9518,-333.3 9667.25,-435.07 9738.72,-656.55 9761.29,-740.83"/>
<polygon fill="black" stroke="black" points="9757.94,-741.86 9763.86,-750.64 9764.71,-740.08 9757.94,-741.86"/>
</g>
<!-- price_utils.fetch_official_rates -->
<g id="node74" class="node">
<title>price_utils.fetch_official_rates</title>
<g id="a_node74"><a xlink:title="Return currency multipliers relative to USD from NBG.">
<polygon fill="none" stroke="black" points="7626.5,-684.8 6991.5,-684.8 6991.5,-631.8 7626.5,-631.8 7626.5,-684.8"/>
<text text-anchor="middle" x="7309" y="-648.1" font-family="Times,serif" font-size="40.88">price_utils.fetch_official_rates</text>
</a>
</g>
</g>
<!-- build_site.main&#45;&gt;price_utils.fetch_official_rates -->
<g id="edge95" class="edge">
<title>build_site.main&#45;&gt;price_utils.fetch_official_rates</title>
<path fill="none" stroke="black" d="M5615.32,-574.37C5673.96,-589.71 5747.28,-606.59 5814,-615.3 6213.26,-667.44 6677.42,-672.17 6981.11,-667.81"/>
<polygon fill="black" stroke="black" points="6981.45,-671.3 6991.39,-667.66 6981.34,-664.31 6981.45,-671.3"/>
</g>
<!-- price_utils.apply_price_model -->
<g id="node75" class="node">
<title>price_utils.apply_price_model</title>
<g id="a_node75"><a xlink:title="Predict prices in USD and guess missing currencies.">
<polygon fill="none" stroke="black" points="6630,-489.8 6000,-489.8 6000,-436.8 6630,-436.8 6630,-489.8"/>
<text text-anchor="middle" x="6315" y="-453.1" font-family="Times,serif" font-size="40.88">price_utils.apply_price_model</text>
</a>
</g>
</g>
<!-- build_site.main&#45;&gt;price_utils.apply_price_model -->
<g id="edge96" class="edge">
<title>build_site.main&#45;&gt;price_utils.apply_price_model</title>
<path fill="none" stroke="black" d="M5707.5,-522.42C5805.72,-512.85 5925.09,-501.21 6031.85,-490.81"/>
<polygon fill="black" stroke="black" points="6032.2,-494.29 6041.82,-489.83 6031.52,-487.32 6032.2,-494.29"/>
</g>
<!-- price_utils.train_price_regression -->
<g id="node151" class="node">
<title>price_utils.train_price_regression</title>
<g id="a_node151"><a xlink:title="Return ``(model, currency_map, counts)`` trained on ``lots``.&#10;&#10;``lots`` must contain ``price`` and ``price:currency`` fields. Only lots with&#10;embeddings present in ``id_to_vec`` are considered. Prices are regressed on&#10;the logarithm scale so coefficients are interpretable as multiplicative&#10;factors. ``USD`` is treated as the base currency so coefficients can be&#10;interpreted as exchange rate multipliers. The returned ``counts`` dictionary&#10;maps each currency to the number of training samples observed.">
<polygon fill="none" stroke="black" points="8892,-328.8 7802,-328.8 7802,-251.8 8892,-251.8 8892,-328.8"/>
<text text-anchor="middle" x="8347" y="-274.4" font-family="Times,serif" font-size="63.00">price_utils.train_price_regression</text>
</a>
</g>
</g>
<!-- price_utils.apply_price_model&#45;&gt;price_utils.train_price_regression -->
<g id="edge256" class="edge">
<title>price_utils.apply_price_model&#45;&gt;price_utils.train_price_regression</title>
<path fill="none" stroke="black" d="M6520.58,-436.8C6620.39,-424.69 6742.31,-411.12 6852,-402.3 7054.68,-386.02 7571.61,-418.96 7766,-359.3 7783.93,-353.8 7784.19,-343.16 7802,-337.3 7807.77,-335.41 7813.59,-333.58 7819.46,-331.81"/>
<polygon fill="black" stroke="black" points="7820.77,-335.08 7829.37,-328.9 7818.79,-328.36 7820.77,-335.08"/>
</g>
<!-- price_utils.predict_price -->
<g id="node152" class="node">
<title>price_utils.predict_price</title>
<g id="a_node152"><a xlink:title="Return predicted price for ``vec`` in ``currency``.&#10;&#10;When ``model`` is ``None`` or ``vec`` is missing, ``None`` is returned.">
<polygon fill="none" stroke="black" points="8552,-555.8 8142,-555.8 8142,-512.8 8552,-512.8 8552,-555.8"/>
<text text-anchor="middle" x="8347" y="-526.16" font-family="Times,serif" font-size="32.06">price_utils.predict_price</text>
</a>
</g>
</g>
<!-- price_utils.apply_price_model&#45;&gt;price_utils.predict_price -->
<g id="edge257" class="edge">
<title>price_utils.apply_price_model&#45;&gt;price_utils.predict_price</title>
<path fill="none" stroke="black" d="M6630.19,-480.95C6703,-484.7 6780.19,-488.4 6852,-491.3 7307.45,-509.75 7841.32,-523.13 8131.53,-529.71"/>
<polygon fill="black" stroke="black" points="8131.67,-533.21 8141.75,-529.94 8131.83,-526.21 8131.67,-533.21"/>
</g>
<!-- price_utils.currency_rates -->
<g id="node153" class="node">
<title>price_utils.currency_rates</title>
<g id="a_node153"><a xlink:title="Return estimated currency multipliers relative to the base.&#10;&#10;The regression model learns one coefficient per currency dummy feature. &#160;The&#10;coefficient is the logarithm of the multiplier relative to USD.">
<polygon fill="none" stroke="black" points="9416.5,-435.8 9029.5,-435.8 9029.5,-396.8 9416.5,-396.8 9416.5,-435.8"/>
<text text-anchor="middle" x="9223" y="-409.4" font-family="Times,serif" font-size="28.00">price_utils.currency_rates</text>
</a>
</g>
</g>
<!-- price_utils.apply_price_model&#45;&gt;price_utils.currency_rates -->
<g id="edge258" class="edge">
<title>price_utils.apply_price_model&#45;&gt;price_utils.currency_rates</title>
<path fill="none" stroke="black" d="M6630.15,-444.57C6702.97,-440.87 6780.17,-437.47 6852,-435.3 7653.98,-411.15 8609.25,-412.77 9019,-414.91"/>
<polygon fill="black" stroke="black" points="9019.16,-418.41 9029.17,-414.97 9019.19,-411.41 9019.16,-418.41"/>
</g>
<!-- price_utils._guess_currency_verified -->
<g id="node155" class="node">
<title>price_utils._guess_currency_verified</title>
<g id="a_node155"><a xlink:title="Return currency when both AI and official rates agree.">
<polygon fill="none" stroke="black" points="7565.5,-482.3 7052.5,-482.3 7052.5,-444.3 7565.5,-444.3 7565.5,-482.3"/>
<text text-anchor="middle" x="7309" y="-456.58" font-family="Times,serif" font-size="27.16">price_utils._guess_currency_verified</text>
</a>
</g>
</g>
<!-- price_utils.apply_price_model&#45;&gt;price_utils._guess_currency_verified -->
<g id="edge259" class="edge">
<title>price_utils.apply_price_model&#45;&gt;price_utils._guess_currency_verified</title>
<path fill="none" stroke="black" d="M6630.22,-463.3C6762.7,-463.3 6915.26,-463.3 7042.06,-463.3"/>
<polygon fill="black" stroke="black" points="7042.3,-466.8 7052.3,-463.3 7042.3,-459.8 7042.3,-466.8"/>
</g>
<!-- caption_io._get_langs&#45;&gt;config_utils.load_config -->
<g id="edge97" class="edge">
<title>caption_io._get_langs&#45;&gt;config_utils.load_config</title>
<path fill="none" stroke="black" d="M9332.12,-2080.09C9396.22,-2077.19 9473.41,-2061.37 9518,-2008.3 9572.03,-1944.01 9534.43,-1334.98 9554,-1253.3 9596.59,-1075.57 9704.59,-882.53 9749.46,-807.09"/>
<polygon fill="black" stroke="black" points="9752.73,-808.45 9754.87,-798.07 9746.73,-804.85 9752.73,-808.45"/>
</g>
<!-- notes_utils.read_md&#45;&gt;notes_utils.read_text -->
<g id="edge236" class="edge">
<title>notes_utils.read_md&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M9293.03,-2161.59C9358.82,-2163.65 9456.67,-2155.92 9518,-2101.3 9643.2,-1989.8 9742.54,-1440.45 9764.82,-1308.73"/>
<polygon fill="black" stroke="black" points="9768.31,-1309.07 9766.51,-1298.63 9761.41,-1307.91 9768.31,-1309.07"/>
</g>
<!-- caption_io.write_caption -->
<g id="node80" class="node">
<title>caption_io.write_caption</title>
<g id="a_node80"><a xlink:title="Write ``text`` as ``lang`` caption for ``image``.">
<polygon fill="none" stroke="black" points="8513.5,-2092.3 8180.5,-2092.3 8180.5,-2056.3 8513.5,-2056.3 8513.5,-2092.3"/>
<text text-anchor="middle" x="8347" y="-2068.14" font-family="Times,serif" font-size="25.20">caption_io.write_caption</text>
</a>
</g>
</g>
<!-- caption_io.write_caption&#45;&gt;notes_utils.write_json -->
<g id="edge108" class="edge">
<title>caption_io.write_caption&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M8513.81,-2058.85C8654.49,-2049.83 8841.33,-2048.93 8892,-2101.3 8934.3,-2145.03 8906.34,-4234.45 8928,-4291.3 8982.33,-4433.92 9124.78,-4557.34 9189.35,-4607.89"/>
<polygon fill="black" stroke="black" points="9187.52,-4610.9 9197.56,-4614.26 9191.8,-4605.36 9187.52,-4610.9"/>
</g>
<!-- caption_io.write_caption&#45;&gt;notes_utils.load_json -->
<g id="edge107" class="edge">
<title>caption_io.write_caption&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M8513.52,-2087.15C8633.72,-2087.08 8792.16,-2066.13 8892,-1971.3 8941.08,-1924.68 8880.32,-1871.36 8928,-1823.3 8969.96,-1781.01 9032.3,-1761.65 9088.79,-1753.21"/>
<polygon fill="black" stroke="black" points="9089.48,-1756.65 9098.9,-1751.8 9088.51,-1749.71 9089.48,-1756.65"/>
</g>
<!-- caption_io.write_caption&#45;&gt;caption_io._get_langs -->
<g id="edge105" class="edge">
<title>caption_io.write_caption&#45;&gt;caption_io._get_langs</title>
<path fill="none" stroke="black" d="M8513.68,-2074.3C8685.93,-2074.3 8951.26,-2074.3 9103.56,-2074.3"/>
<polygon fill="black" stroke="black" points="9103.88,-2077.8 9113.88,-2074.3 9103.88,-2070.8 9103.88,-2077.8"/>
</g>
<!-- caption_io.write_caption&#45;&gt;caption_io.caption_json_path -->
<g id="edge106" class="edge">
<title>caption_io.write_caption&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M8513.79,-2060.91C8652.85,-2053.47 8837.27,-2053.73 8892,-2101.3 8956.21,-2157.12 8867.72,-2229.28 8928,-2289.3 8976.54,-2337.63 9053.11,-2350.76 9115.94,-2352.13"/>
<polygon fill="black" stroke="black" points="9116.26,-2355.64 9126.3,-2352.26 9116.34,-2348.64 9116.26,-2355.64"/>
</g>
<!-- tg_client._mark_activity -->
<g id="node81" class="node">
<title>tg_client._mark_activity</title>
<g id="a_node81"><a xlink:title="Update ``_last_event`` to the current time.">
<polygon fill="none" stroke="black" points="5039.5,-3138.3 4853.5,-3138.3 4853.5,-3102.3 5039.5,-3102.3 5039.5,-3138.3"/>
<text text-anchor="middle" x="4946.5" y="-3116.6" font-family="Times,serif" font-size="14.00">tg_client._mark_activity</text>
</a>
</g>
</g>
<!-- tg_client._heartbeat -->
<g id="node82" class="node">
<title>tg_client._heartbeat</title>
<g id="a_node82"><a xlink:title="Periodically log a heartbeat and warn if idle for too long.">
<polygon fill="none" stroke="black" points="1490.5,-3268.3 1260.5,-3268.3 1260.5,-3232.3 1490.5,-3232.3 1490.5,-3268.3"/>
<text text-anchor="middle" x="1375.5" y="-3245" font-family="Times,serif" font-size="21.00">tg_client._heartbeat</text>
</a>
</g>
</g>
<!-- tg_client._progress_logger -->
<g id="node83" class="node">
<title>tg_client._progress_logger</title>
<g id="a_node83"><a xlink:title="Return a progress callback that logs received bytes.">
<polygon fill="none" stroke="black" points="5130,-2873.8 4763,-2873.8 4763,-2836.8 5130,-2836.8 5130,-2873.8"/>
<text text-anchor="middle" x="4946.5" y="-2848.86" font-family="Times,serif" font-size="26.18">tg_client._progress_logger</text>
</a>
</g>
</g>
<!-- tg_client._write_md -->
<g id="node84" class="node">
<title>tg_client._write_md</title>
<g id="a_node84"><a xlink:title="Helper to store a raw post in Markdown format.">
<polygon fill="none" stroke="black" points="5571,-2697.3 5434,-2697.3 5434,-2661.3 5571,-2661.3 5571,-2697.3"/>
<text text-anchor="middle" x="5502.5" y="-2676.06" font-family="Times,serif" font-size="12.18">tg_client._write_md</text>
</a>
</g>
</g>
<!-- post_io.write_post -->
<g id="node85" class="node">
<title>post_io.write_post</title>
<g id="a_node85"><a xlink:title="Write metadata and body as a Markdown post.">
<polygon fill="none" stroke="black" points="6481,-2727.3 6149,-2727.3 6149,-2681.3 6481,-2681.3 6481,-2727.3"/>
<text text-anchor="middle" x="6315" y="-2695.86" font-family="Times,serif" font-size="34.30">post_io.write_post</text>
</a>
</g>
</g>
<!-- tg_client._write_md&#45;&gt;post_io.write_post -->
<g id="edge109" class="edge">
<title>tg_client._write_md&#45;&gt;post_io.write_post</title>
<path fill="none" stroke="black" d="M5571.21,-2681.39C5694.84,-2685.21 5960.73,-2693.41 6138.51,-2698.89"/>
<polygon fill="black" stroke="black" points="6138.66,-2702.4 6148.76,-2699.21 6138.88,-2695.4 6138.66,-2702.4"/>
</g>
<!-- post_io.write_post&#45;&gt;notes_utils.write_md -->
<g id="edge193" class="edge">
<title>post_io.write_post&#45;&gt;notes_utils.write_md</title>
<path fill="none" stroke="black" d="M6481.15,-2682.39C6586.99,-2668.97 6727.4,-2652.31 6852,-2641.3 6964.88,-2631.34 7093.82,-2624.08 7185.72,-2619.62"/>
<polygon fill="black" stroke="black" points="7186.08,-2623.11 7195.9,-2619.13 7185.74,-2616.12 7186.08,-2623.11"/>
</g>
<!-- post_io.get_contact -->
<g id="node107" class="node">
<title>post_io.get_contact</title>
<g id="a_node107"><a xlink:title="Return a contact identifier from ``meta`` or ``None`` when missing.">
<polygon fill="none" stroke="black" points="7408.5,-2686.3 7209.5,-2686.3 7209.5,-2650.3 7408.5,-2650.3 7408.5,-2686.3"/>
<text text-anchor="middle" x="7309" y="-2663.52" font-family="Times,serif" font-size="18.48">post_io.get_contact</text>
</a>
</g>
</g>
<!-- post_io.write_post&#45;&gt;post_io.get_contact -->
<g id="edge191" class="edge">
<title>post_io.write_post&#45;&gt;post_io.get_contact</title>
<path fill="none" stroke="black" d="M6481.2,-2698.31C6684.91,-2690.92 7025.42,-2678.56 7199.03,-2672.26"/>
<polygon fill="black" stroke="black" points="7199.33,-2675.75 7209.2,-2671.89 7199.08,-2668.75 7199.33,-2675.75"/>
</g>
<!-- post_io.get_timestamp -->
<g id="node123" class="node">
<title>post_io.get_timestamp</title>
<g id="a_node123"><a xlink:title="Return ``meta[&#39;date&#39;]`` as a timezone&#45;aware ``datetime``.">
<polygon fill="none" stroke="black" points="7480.5,-2744.3 7137.5,-2744.3 7137.5,-2704.3 7480.5,-2704.3 7480.5,-2744.3"/>
<text text-anchor="middle" x="7309" y="-2717.23" font-family="Times,serif" font-size="28.84">post_io.get_timestamp</text>
</a>
</g>
</g>
<!-- post_io.write_post&#45;&gt;post_io.get_timestamp -->
<g id="edge192" class="edge">
<title>post_io.write_post&#45;&gt;post_io.get_timestamp</title>
<path fill="none" stroke="black" d="M6481.2,-2707.63C6659.64,-2711.23 6943.06,-2716.95 7127.31,-2720.66"/>
<polygon fill="black" stroke="black" points="7127.31,-2724.16 7137.38,-2720.86 7127.45,-2717.16 7127.31,-2724.16"/>
</g>
<!-- tg_client._scan_group_cache -->
<g id="node86" class="node">
<title>tg_client._scan_group_cache</title>
<g id="a_node86"><a xlink:title="Build group_id &#45;&gt; Path mapping for ``chat`` quickly.">
<polygon fill="none" stroke="black" points="7548.5,-2371.8 7069.5,-2371.8 7069.5,-2328.8 7548.5,-2328.8 7548.5,-2371.8"/>
<text text-anchor="middle" x="7309" y="-2342.16" font-family="Times,serif" font-size="32.06">tg_client._scan_group_cache</text>
</a>
</g>
</g>
<!-- tg_client._scan_group_cache&#45;&gt;post_io.raw_post_path -->
<g id="edge110" class="edge">
<title>tg_client._scan_group_cache&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7548.65,-2359.52C7775.87,-2368.29 8105.4,-2381.01 8259.93,-2386.98"/>
<polygon fill="black" stroke="black" points="8260.18,-2390.49 8270.3,-2387.38 8260.45,-2383.5 8260.18,-2390.49"/>
</g>
<!-- tg_client._find_group_path -->
<g id="node87" class="node">
<title>tg_client._find_group_path</title>
<g id="a_node87"><a xlink:title="Return stored message path for ``group_id`` if known.">
<polygon fill="none" stroke="black" points="6448,-2349.3 6182,-2349.3 6182,-2313.3 6448,-2313.3 6448,-2349.3"/>
<text text-anchor="middle" x="6315" y="-2326.52" font-family="Times,serif" font-size="18.48">tg_client._find_group_path</text>
</a>
</g>
</g>
<!-- tg_client._find_group_path&#45;&gt;tg_client._scan_group_cache -->
<g id="edge111" class="edge">
<title>tg_client._find_group_path&#45;&gt;tg_client._scan_group_cache</title>
<path fill="none" stroke="black" d="M6448.24,-2333.84C6603.79,-2336.82 6865.34,-2341.83 7059.2,-2345.54"/>
<polygon fill="black" stroke="black" points="7059.19,-2349.04 7069.25,-2345.73 7059.32,-2342.04 7059.19,-2349.04"/>
</g>
<!-- tg_client._get_message_path -->
<g id="node88" class="node">
<title>tg_client._get_message_path</title>
<g id="a_node88"><a xlink:title="Return path of stored message ``msg_id`` in ``chat`` if any.">
<polygon fill="none" stroke="black" points="3331,-2245.3 3092,-2245.3 3092,-2209.3 3331,-2209.3 3331,-2245.3"/>
<text text-anchor="middle" x="3211.5" y="-2223.26" font-family="Times,serif" font-size="15.68">tg_client._get_message_path</text>
</a>
</g>
</g>
<!-- tg_client._get_message_path&#45;&gt;post_io.raw_post_path -->
<g id="edge112" class="edge">
<title>tg_client._get_message_path&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M3331.1,-2225.62C3786.59,-2219.23 5467.39,-2196.53 6852,-2189.3 6953.55,-2188.77 7685.9,-2126.87 7766,-2189.3 7817.69,-2229.59 7752.52,-2289.33 7802,-2332.3 7868.48,-2390.05 8124.04,-2394.57 8259.91,-2392.68"/>
<polygon fill="black" stroke="black" points="8260.33,-2396.17 8270.28,-2392.52 8260.22,-2389.17 8260.33,-2396.17"/>
</g>
<!-- tg_client._should_skip_media -->
<g id="node89" class="node">
<title>tg_client._should_skip_media</title>
<g id="a_node89"><a xlink:title="Return reason string if ``msg`` media should be skipped.">
<polygon fill="none" stroke="black" points="5191,-2818.8 4702,-2818.8 4702,-2775.8 5191,-2775.8 5191,-2818.8"/>
<text text-anchor="middle" x="4946.5" y="-2789.16" font-family="Times,serif" font-size="32.06">tg_client._should_skip_media</text>
</a>
</g>
</g>
<!-- tg_client._allowed_topic -->
<g id="node90" class="node">
<title>tg_client._allowed_topic</title>
<g id="a_node90"><a xlink:title="Return ``True`` if ``msg`` belongs to an allowed forum topic.">
<polygon fill="none" stroke="black" points="5714.5,-2798.8 5290.5,-2798.8 5290.5,-2753.8 5714.5,-2753.8 5714.5,-2798.8"/>
<text text-anchor="middle" x="5502.5" y="-2767.92" font-family="Times,serif" font-size="33.60">tg_client._allowed_topic</text>
</a>
</g>
</g>
<!-- tg_client._extract_author -->
<g id="node91" class="node">
<title>tg_client._extract_author</title>
<g id="a_node91"><a xlink:title="Return a metadata dictionary describing the message author.">
<polygon fill="none" stroke="black" points="6678,-2815.3 5952,-2815.3 5952,-2745.3 6678,-2745.3 6678,-2815.3"/>
<text text-anchor="middle" x="6315" y="-2766.5" font-family="Times,serif" font-size="56.00">tg_client._extract_author</text>
</a>
</g>
</g>
<!-- phone_utils.format_georgian -->
<g id="node92" class="node">
<title>phone_utils.format_georgian</title>
<g id="a_node92"><a xlink:title="Return ``phone`` in ``+995...`` format if possible.">
<polygon fill="none" stroke="black" points="7515,-2800.3 7103,-2800.3 7103,-2762.3 7515,-2762.3 7515,-2800.3"/>
<text text-anchor="middle" x="7309" y="-2774.58" font-family="Times,serif" font-size="27.16">phone_utils.format_georgian</text>
</a>
</g>
</g>
<!-- tg_client._extract_author&#45;&gt;phone_utils.format_georgian -->
<g id="edge113" class="edge">
<title>tg_client._extract_author&#45;&gt;phone_utils.format_georgian</title>
<path fill="none" stroke="black" d="M6678.35,-2780.67C6817.37,-2780.81 6971.54,-2780.97 7092.52,-2781.09"/>
<polygon fill="black" stroke="black" points="7092.64,-2784.59 7102.65,-2781.1 7092.65,-2777.59 7092.64,-2784.59"/>
</g>
<!-- tg_client._schedule_caption -->
<g id="node93" class="node">
<title>tg_client._schedule_caption</title>
<g id="a_node93"><a xlink:title="Run captioning in a separate process so downloads continue.">
<polygon fill="none" stroke="black" points="7448,-2578.3 7170,-2578.3 7170,-2542.3 7448,-2542.3 7448,-2578.3"/>
<text text-anchor="middle" x="7309" y="-2555.52" font-family="Times,serif" font-size="18.48">tg_client._schedule_caption</text>
</a>
</g>
</g>
<!-- tg_client._schedule_chop -->
<g id="node94" class="node">
<title>tg_client._schedule_chop</title>
<g id="a_node94"><a xlink:title="Run lot extraction in a separate process.">
<polygon fill="none" stroke="black" points="8495,-4480.3 8199,-4480.3 8199,-4444.3 8495,-4444.3 8495,-4480.3"/>
<text text-anchor="middle" x="8347" y="-4456.61" font-family="Times,serif" font-size="22.12">tg_client._schedule_chop</text>
</a>
</g>
</g>
<!-- tg_client._enqueue_chop -->
<g id="node95" class="node">
<title>tg_client._enqueue_chop</title>
<g id="a_node95"><a xlink:title="Queue ``path`` for chopping once captions are available.">
<polygon fill="none" stroke="black" points="5189,-4301.8 4704,-4301.8 4704,-4252.8 5189,-4252.8 5189,-4301.8"/>
<text text-anchor="middle" x="4946.5" y="-4267.68" font-family="Times,serif" font-size="37.66">tg_client._enqueue_chop</text>
</a>
</g>
</g>
<!-- tg_client._enqueue_chop&#45;&gt;moderation.should_skip_message -->
<g id="edge114" class="edge">
<title>tg_client._enqueue_chop&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M5189.31,-4285.96C5363.08,-4291.77 5602.96,-4298.96 5814,-4302.3 5922.43,-4304.02 7679,-4370.04 7766,-4305.3 7810.67,-4272.07 7758.16,-4219.64 7802,-4185.3 7857.51,-4141.82 8032.98,-4139.84 8169.8,-4145.76"/>
<polygon fill="black" stroke="black" points="8169.84,-4149.27 8179.99,-4146.22 8170.16,-4142.27 8169.84,-4149.27"/>
</g>
<!-- tg_client._enqueue_chop&#45;&gt;caption_io.has_caption -->
<g id="edge115" class="edge">
<title>tg_client._enqueue_chop&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M5189.33,-4268.6C5363.11,-4262.5 5602.99,-4254.38 5814,-4248.3 5868.22,-4246.74 7725.8,-4237.72 7766,-4201.3 7862.91,-4113.51 7709.2,-4001.42 7802,-3909.3 7922.27,-3789.92 8138.77,-3806.24 8259.2,-3827.17"/>
<polygon fill="black" stroke="black" points="8258.67,-3830.63 8269.13,-3828.94 8259.9,-3823.73 8258.67,-3830.63"/>
</g>
<!-- tg_client._start_chop_worker -->
<g id="node96" class="node">
<title>tg_client._start_chop_worker</title>
<g id="a_node96"><a xlink:title="Ensure the chop queue worker task is running.">
<polygon fill="none" stroke="black" points="5635.5,-4388.3 5369.5,-4388.3 5369.5,-4352.3 5635.5,-4352.3 5635.5,-4388.3"/>
<text text-anchor="middle" x="5502.5" y="-4366.14" font-family="Times,serif" font-size="17.08">tg_client._start_chop_worker</text>
</a>
</g>
</g>
<!-- tg_client._enqueue_chop&#45;&gt;tg_client._start_chop_worker -->
<g id="edge116" class="edge">
<title>tg_client._enqueue_chop&#45;&gt;tg_client._start_chop_worker</title>
<path fill="none" stroke="black" d="M5048.27,-4301.82C5101.23,-4314.06 5167.36,-4328.34 5227,-4338.3 5269.72,-4345.44 5316.44,-4351.52 5359.03,-4356.4"/>
<polygon fill="black" stroke="black" points="5358.85,-4359.91 5369.18,-4357.55 5359.64,-4352.95 5358.85,-4359.91"/>
</g>
<!-- tg_client._chop_worker -->
<g id="node97" class="node">
<title>tg_client._chop_worker</title>
<g id="a_node97"><a xlink:title="Background task processing ``_CHOP_QUEUE``.">
<polygon fill="none" stroke="black" points="6440.5,-4388.3 6189.5,-4388.3 6189.5,-4352.3 6440.5,-4352.3 6440.5,-4388.3"/>
<text text-anchor="middle" x="6315" y="-4365.51" font-family="Times,serif" font-size="19.74">tg_client._chop_worker</text>
</a>
</g>
</g>
<!-- tg_client._start_chop_worker&#45;&gt;tg_client._chop_worker -->
<g id="edge117" class="edge">
<title>tg_client._start_chop_worker&#45;&gt;tg_client._chop_worker</title>
<path fill="none" stroke="black" d="M5635.52,-4370.3C5785.27,-4370.3 6028.18,-4370.3 6179.1,-4370.3"/>
<polygon fill="black" stroke="black" points="6179.36,-4373.8 6189.36,-4370.3 6179.36,-4366.8 6179.36,-4373.8"/>
</g>
<!-- tg_client._process_chop_queue -->
<g id="node98" class="node">
<title>tg_client._process_chop_queue</title>
<g id="a_node98"><a xlink:title="Check queued posts and chop cooled down ones.">
<polygon fill="none" stroke="black" points="7490.5,-4426.3 7127.5,-4426.3 7127.5,-4390.3 7490.5,-4390.3 7490.5,-4426.3"/>
<text text-anchor="middle" x="7309" y="-4402.61" font-family="Times,serif" font-size="22.12">tg_client._process_chop_queue</text>
</a>
</g>
</g>
<!-- tg_client._chop_worker&#45;&gt;tg_client._process_chop_queue -->
<g id="edge120" class="edge">
<title>tg_client._chop_worker&#45;&gt;tg_client._process_chop_queue</title>
<path fill="none" stroke="black" d="M6440.63,-4375.08C6610.91,-4381.6 6917.83,-4393.36 7117.17,-4400.99"/>
<polygon fill="black" stroke="black" points="7117.05,-4404.49 7127.17,-4401.38 7117.31,-4397.5 7117.05,-4404.49"/>
</g>
<!-- tg_client._process_chop_queue&#45;&gt;caption_io.has_caption -->
<g id="edge118" class="edge">
<title>tg_client._process_chop_queue&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M7490.63,-4415.13C7586.63,-4408.47 7698.46,-4382.36 7766,-4305.3 7824.24,-4238.85 7740.29,-3972.55 7802,-3909.3 7920.5,-3787.84 8138.2,-3805.12 8259.17,-3826.73"/>
<polygon fill="black" stroke="black" points="8258.67,-3830.19 8269.14,-3828.55 8259.93,-3823.31 8258.67,-3830.19"/>
</g>
<!-- tg_client._process_chop_queue&#45;&gt;tg_client._schedule_chop -->
<g id="edge119" class="edge">
<title>tg_client._process_chop_queue&#45;&gt;tg_client._schedule_chop</title>
<path fill="none" stroke="black" d="M7490.79,-4418.45C7583.78,-4423.61 7698.95,-4429.92 7802,-4435.3 7932.26,-4442.11 8080.09,-4449.42 8188.74,-4454.72"/>
<polygon fill="black" stroke="black" points="8188.64,-4458.22 8198.8,-4455.21 8188.98,-4451.22 8188.64,-4458.22"/>
</g>
<!-- tg_client._flush_chop_queue -->
<g id="node99" class="node">
<title>tg_client._flush_chop_queue</title>
<g id="a_node99"><a xlink:title="Run the chop worker until the queue is empty and cancel it.">
<polygon fill="none" stroke="black" points="2204,-4156.8 1768,-4156.8 1768,-4115.8 2204,-4115.8 2204,-4156.8"/>
<text text-anchor="middle" x="1986" y="-4129.06" font-family="Times,serif" font-size="29.68">tg_client._flush_chop_queue</text>
</a>
</g>
</g>
<!-- tg_client._flush_chop_queue&#45;&gt;tg_client._process_chop_queue -->
<g id="edge121" class="edge">
<title>tg_client._flush_chop_queue&#45;&gt;tg_client._process_chop_queue</title>
<path fill="none" stroke="black" d="M2038.5,-4156.89C2205.05,-4221.56 2745.27,-4416.3 3210.5,-4416.3 3210.5,-4416.3 3210.5,-4416.3 5503.5,-4416.3 6091.86,-4416.3 6788.12,-4412 7117.32,-4409.7"/>
<polygon fill="black" stroke="black" points="7117.46,-4413.2 7127.43,-4409.63 7117.41,-4406.2 7117.46,-4413.2"/>
</g>
<!-- tg_client._get_id_date -->
<g id="node100" class="node">
<title>tg_client._get_id_date</title>
<g id="a_node100"><a xlink:title="Return the stored date for ``msg_id`` in ``chat`` if available.">
<polygon fill="none" stroke="black" points="7481,-1465.8 7137,-1465.8 7137,-1424.8 7481,-1424.8 7481,-1465.8"/>
<text text-anchor="middle" x="7309" y="-1438.06" font-family="Times,serif" font-size="29.68">tg_client._get_id_date</text>
</a>
</g>
</g>
<!-- tg_client._get_id_date&#45;&gt;notes_utils.read_text -->
<g id="edge123" class="edge">
<title>tg_client._get_id_date&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M7481.07,-1434.11C7566.64,-1428.5 7671.8,-1421.58 7766,-1415.3 8483.33,-1367.54 9345.06,-1309.13 9653.07,-1288.21"/>
<polygon fill="black" stroke="black" points="9653.61,-1291.69 9663.35,-1287.52 9653.13,-1284.7 9653.61,-1291.69"/>
</g>
<!-- tg_client._get_id_date&#45;&gt;post_io.raw_post_path -->
<g id="edge122" class="edge">
<title>tg_client._get_id_date&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7481.07,-1453.22C7580.46,-1467.51 7698.95,-1503.15 7766,-1589.3 7851.04,-1698.57 7717.62,-2101.53 7802,-2211.3 7911.18,-2353.34 8136.17,-2384.11 8259.85,-2389.88"/>
<polygon fill="black" stroke="black" points="8259.9,-2393.38 8270.04,-2390.31 8260.19,-2386.39 8259.9,-2393.38"/>
</g>
<!-- tg_client._load_progress -->
<g id="node101" class="node">
<title>tg_client._load_progress</title>
<g id="a_node101"><a xlink:title="Return saved resume timestamp for ``chat`` if available.">
<polygon fill="none" stroke="black" points="4223,-828.3 3893,-828.3 3893,-792.3 4223,-792.3 4223,-828.3"/>
<text text-anchor="middle" x="4058" y="-804.14" font-family="Times,serif" font-size="25.20">tg_client._load_progress</text>
</a>
</g>
</g>
<!-- tg_client._load_progress&#45;&gt;notes_utils.read_text -->
<g id="edge124" class="edge">
<title>tg_client._load_progress&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M4221.01,-792.29C4487.66,-764.23 5035.9,-713.3 5501.5,-713.3 5501.5,-713.3 5501.5,-713.3 8348,-713.3 8868.05,-713.3 9082.47,-445.12 9518,-729.3 9519.52,-730.3 9706.39,-1141.4 9756.99,-1252.76"/>
<polygon fill="black" stroke="black" points="9753.87,-1254.35 9761.19,-1262.01 9760.24,-1251.46 9753.87,-1254.35"/>
</g>
<!-- tg_client._save_progress -->
<g id="node102" class="node">
<title>tg_client._save_progress</title>
<g id="a_node102"><a xlink:title="Persist resume timestamp for ``chat`` to ``STATE_DIR``.">
<polygon fill="none" stroke="black" points="2721,-2142.3 2492,-2142.3 2492,-2106.3 2721,-2106.3 2721,-2142.3"/>
<text text-anchor="middle" x="2606.5" y="-2120.14" font-family="Times,serif" font-size="17.08">tg_client._save_progress</text>
</a>
</g>
</g>
<!-- tg_client.get_first_id -->
<g id="node103" class="node">
<title>tg_client.get_first_id</title>
<g id="a_node103"><a xlink:title="Return the smallest saved message id for ``chat``.">
<polygon fill="none" stroke="black" points="3345,-2104.3 3078,-2104.3 3078,-2068.3 3345,-2068.3 3345,-2104.3"/>
<text text-anchor="middle" x="3211.5" y="-2080.43" font-family="Times,serif" font-size="24.22">tg_client.get_first_id</text>
</a>
</g>
</g>
<!-- tg_client.get_first_id&#45;&gt;post_io.raw_post_path -->
<g id="edge125" class="edge">
<title>tg_client.get_first_id&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M3345.12,-2087.33C3635.28,-2089.49 4348.27,-2094.3 4945.5,-2094.3 4945.5,-2094.3 4945.5,-2094.3 6316,-2094.3 6396.57,-2094.3 7704.92,-2065.77 7766,-2118.3 7839.12,-2181.2 7731.77,-2266.2 7802,-2332.3 7866.27,-2392.8 8123.93,-2396.03 8260.32,-2393.25"/>
<polygon fill="black" stroke="black" points="8260.4,-2396.75 8270.32,-2393.03 8260.25,-2389.75 8260.4,-2396.75"/>
</g>
<!-- tg_client.get_last_id -->
<g id="node104" class="node">
<title>tg_client.get_last_id</title>
<g id="a_node104"><a xlink:title="Return the highest saved message id for ``chat``.">
<polygon fill="none" stroke="black" points="2116.5,-2050.3 1855.5,-2050.3 1855.5,-2014.3 2116.5,-2014.3 2116.5,-2050.3"/>
<text text-anchor="middle" x="1986" y="-2026.43" font-family="Times,serif" font-size="24.22">tg_client.get_last_id</text>
</a>
</g>
</g>
<!-- tg_client.get_last_id&#45;&gt;post_io.raw_post_path -->
<g id="edge126" class="edge">
<title>tg_client.get_last_id&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M2116.54,-2032.3C2966.34,-2032.42 7710.97,-2035.23 7766,-2083.3 7850.21,-2156.87 7721.47,-2254.73 7802,-2332.3 7865.61,-2393.58 8123.88,-2396.43 8260.43,-2393.41"/>
<polygon fill="black" stroke="black" points="8260.53,-2396.91 8270.44,-2393.18 8260.36,-2389.91 8260.53,-2396.91"/>
</g>
<!-- tg_client._save_message -->
<g id="node105" class="node">
<title>tg_client._save_message</title>
<g id="a_node105"><a xlink:title="Write ``msg`` to disk with metadata and any media references.&#10;&#10;Returns the path of the stored message or ``None`` when skipped.">
<polygon fill="none" stroke="black" points="4666,-2829.8 3450,-2829.8 3450,-2714.8 4666,-2714.8 4666,-2829.8"/>
<text text-anchor="middle" x="4058" y="-2748.19" font-family="Times,serif" font-size="97.02">tg_client._save_message</text>
</a>
</g>
</g>
<!-- tg_client._save_message&#45;&gt;post_io.read_post -->
<g id="edge139" class="edge">
<title>tg_client._save_message&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M4334.22,-2829.87C4447.57,-2850.84 4580.55,-2871.93 4702,-2882.3 4744.4,-2885.93 7723.57,-2881.97 7766,-2885.3 7891.89,-2895.19 8031.76,-2916.82 8142.6,-2936.51"/>
<polygon fill="black" stroke="black" points="8142.1,-2939.97 8152.56,-2938.28 8143.33,-2933.08 8142.1,-2939.97"/>
</g>
<!-- tg_client._save_message&#45;&gt;moderation.should_skip_user -->
<g id="edge127" class="edge">
<title>tg_client._save_message&#45;&gt;moderation.should_skip_user</title>
<path fill="none" stroke="black" d="M4059.01,-2829.92C4062.48,-3084.44 4113.53,-4114.96 4702,-4557.3 4974.41,-4762.07 7425.23,-4698.8 7766,-4695.3 7960.7,-4693.3 9375.62,-4792.12 9518,-4659.3 9583.1,-4598.58 9492.15,-4324.34 9554,-4260.3 9575.57,-4237.97 9605.56,-4227.21 9636.32,-4222.89"/>
<polygon fill="black" stroke="black" points="9636.8,-4226.36 9646.32,-4221.71 9635.98,-4219.41 9636.8,-4226.36"/>
</g>
<!-- tg_client._save_message&#45;&gt;post_io.raw_post_path -->
<g id="edge140" class="edge">
<title>tg_client._save_message&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M4196.05,-2714.67C4411.07,-2627.58 4842.87,-2466.07 5227,-2404.3 5380.66,-2379.6 7774.24,-2387.98 8260.29,-2389.94"/>
<polygon fill="black" stroke="black" points="8260.38,-2393.44 8270.39,-2389.98 8260.41,-2386.44 8260.38,-2393.44"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._mark_activity -->
<g id="edge128" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._mark_activity</title>
<path fill="none" stroke="black" d="M4149.06,-2829.83C4269.77,-2903.89 4493.08,-3030.39 4702,-3092.3 4747.23,-3105.71 4798.95,-3112.76 4843.06,-3116.44"/>
<polygon fill="black" stroke="black" points="4842.98,-3119.94 4853.22,-3117.24 4843.53,-3112.96 4842.98,-3119.94"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._progress_logger -->
<g id="edge129" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._progress_logger</title>
<path fill="none" stroke="black" d="M4666.22,-2829.16C4696.34,-2831.98 4725.28,-2834.69 4752.37,-2837.22"/>
<polygon fill="black" stroke="black" points="4752.37,-2840.74 4762.66,-2838.19 4753.03,-2833.77 4752.37,-2840.74"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._write_md -->
<g id="edge130" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._write_md</title>
<path fill="none" stroke="black" d="M4489.49,-2714.78C4560.37,-2707.03 4633.16,-2700.1 4702,-2695.3 4966.24,-2676.88 5280.7,-2677.03 5423.75,-2678.3"/>
<polygon fill="black" stroke="black" points="5423.72,-2681.8 5433.75,-2678.4 5423.78,-2674.8 5423.72,-2681.8"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._find_group_path -->
<g id="edge131" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._find_group_path</title>
<path fill="none" stroke="black" d="M4122.34,-2714.77C4231.23,-2620.08 4465.15,-2434.81 4702,-2363.3 4974.34,-2281.09 5830.41,-2309.25 6171.6,-2324.35"/>
<polygon fill="black" stroke="black" points="6171.65,-2327.86 6181.79,-2324.8 6171.96,-2320.86 6171.65,-2327.86"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._should_skip_media -->
<g id="edge132" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._should_skip_media</title>
<path fill="none" stroke="black" d="M4666.22,-2789.43C4674.85,-2789.67 4683.37,-2789.91 4691.79,-2790.15"/>
<polygon fill="black" stroke="black" points="4691.9,-2793.65 4702,-2790.44 4692.1,-2786.66 4691.9,-2793.65"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._allowed_topic -->
<g id="edge133" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._allowed_topic</title>
<path fill="none" stroke="black" d="M4666.33,-2764.3C4836.14,-2763.37 5020.78,-2763.56 5191,-2766.3 5219.83,-2766.77 5250.16,-2767.47 5280.1,-2768.3"/>
<polygon fill="black" stroke="black" points="5280.14,-2771.8 5290.24,-2768.59 5280.34,-2764.81 5280.14,-2771.8"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._extract_author -->
<g id="edge134" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._extract_author</title>
<path fill="none" stroke="black" d="M4666.23,-2747.68C4995.32,-2738.05 5409.03,-2731.93 5778,-2744.3 5830.98,-2746.08 5886.86,-2748.84 5941.73,-2752.07"/>
<polygon fill="black" stroke="black" points="5941.77,-2755.58 5951.96,-2752.67 5942.19,-2748.59 5941.77,-2755.58"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._enqueue_chop -->
<g id="edge135" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._enqueue_chop</title>
<path fill="none" stroke="black" d="M4067.96,-2830.02C4104.27,-3044.36 4260.25,-3802.62 4702,-4198.3 4727.91,-4221.51 4760.74,-4237.92 4793.84,-4249.5"/>
<polygon fill="black" stroke="black" points="4793.05,-4252.93 4803.64,-4252.8 4795.28,-4246.3 4793.05,-4252.93"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._save_message -->
<g id="edge136" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._save_message</title>
<path fill="none" stroke="black" d="M3908.09,-2829.91C3927.06,-2840.43 3977.04,-2847.8 4058,-2847.8 4128.21,-2847.8 4175.12,-2842.26 4198.71,-2833.93"/>
<polygon fill="black" stroke="black" points="4200.15,-2837.12 4207.91,-2829.91 4197.35,-2830.7 4200.15,-2837.12"/>
</g>
<!-- tg_client._save_media -->
<g id="node106" class="node">
<title>tg_client._save_media</title>
<g id="a_node106"><a xlink:title="Store ``data`` and return relative file path.">
<polygon fill="none" stroke="black" points="5743.5,-2605.3 5261.5,-2605.3 5261.5,-2551.3 5743.5,-2551.3 5743.5,-2605.3"/>
<text text-anchor="middle" x="5502.5" y="-2567.7" font-family="Times,serif" font-size="42.00">tg_client._save_media</text>
</a>
</g>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._save_media -->
<g id="edge137" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._save_media</title>
<path fill="none" stroke="black" d="M4259.19,-2714.71C4385.17,-2680.96 4551.78,-2640.84 4702,-2619.3 4884.58,-2593.12 5092.72,-2583.07 5250.85,-2579.46"/>
<polygon fill="black" stroke="black" points="5251.27,-2582.95 5261.19,-2579.23 5251.12,-2575.95 5251.27,-2582.95"/>
</g>
<!-- tg_client._save_message&#45;&gt;post_io.get_contact -->
<g id="edge138" class="edge">
<title>tg_client._save_message&#45;&gt;post_io.get_contact</title>
<path fill="none" stroke="black" d="M4394.8,-2714.78C4493.5,-2699.73 4601.85,-2685.02 4702,-2675.3 4934.46,-2652.74 4993.5,-2657.42 5227,-2652.3 5981.48,-2635.79 6890.16,-2656.87 7199.12,-2665.2"/>
<polygon fill="black" stroke="black" points="7199.32,-2668.71 7209.41,-2665.48 7199.51,-2661.71 7199.32,-2668.71"/>
</g>
<!-- tg_client._save_media&#45;&gt;image_io.write_image_meta -->
<g id="edge141" class="edge">
<title>tg_client._save_media&#45;&gt;image_io.write_image_meta</title>
<path fill="none" stroke="black" d="M5743.66,-2586.9C5889.13,-2592.1 6068.83,-2598.53 6187.19,-2602.77"/>
<polygon fill="black" stroke="black" points="6187.26,-2606.27 6197.38,-2603.13 6187.51,-2599.28 6187.26,-2606.27"/>
</g>
<!-- tg_client._save_media&#45;&gt;caption_io.has_caption -->
<g id="edge143" class="edge">
<title>tg_client._save_media&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M5717.42,-2605.46C5740.8,-2616.66 5761.91,-2631.83 5778,-2652.3 5828.3,-2716.32 5756.82,-4059.35 5814,-4117.3 5853.13,-4156.96 6761.45,-4144 6816,-4155.3 6832.81,-4158.79 6835.13,-4166.14 6852,-4169.3 6951.81,-4188.03 7689.42,-4236.01 7766,-4169.3 7853.96,-4092.68 7718.6,-3990.87 7802,-3909.3 7923.16,-3790.82 8139.31,-3806.78 8259.45,-3827.41"/>
<polygon fill="black" stroke="black" points="8258.89,-3830.87 8269.35,-3829.16 8260.11,-3823.98 8258.89,-3830.87"/>
</g>
<!-- tg_client._save_media&#45;&gt;caption_io.caption_json_path -->
<g id="edge142" class="edge">
<title>tg_client._save_media&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M5743.78,-2565.82C5767.51,-2564.62 5791.22,-2563.43 5814,-2562.3 6497.93,-2528.57 8213.23,-2507.69 8892,-2417.3 8980.24,-2405.55 9079.79,-2382.09 9146.26,-2364.93"/>
<polygon fill="black" stroke="black" points="9147.43,-2368.24 9156.22,-2362.34 9145.67,-2361.46 9147.43,-2368.24"/>
</g>
<!-- tg_client._save_media&#45;&gt;tg_client._schedule_caption -->
<g id="edge144" class="edge">
<title>tg_client._save_media&#45;&gt;tg_client._schedule_caption</title>
<path fill="none" stroke="black" d="M5743.59,-2575.91C6122.53,-2572.13 6848.17,-2564.89 7159.81,-2561.78"/>
<polygon fill="black" stroke="black" points="7159.85,-2565.28 7169.81,-2561.68 7159.78,-2558.28 7159.85,-2565.28"/>
</g>
<!-- tg_client._save_bounded -->
<g id="node108" class="node">
<title>tg_client._save_bounded</title>
<g id="a_node108"><a xlink:title="Run ``_save_message`` under the global semaphore and return path.">
<polygon fill="none" stroke="black" points="3414,-3119.3 3009,-3119.3 3009,-3077.3 3414,-3077.3 3414,-3119.3"/>
<text text-anchor="middle" x="3211.5" y="-3090.22" font-family="Times,serif" font-size="31.36">tg_client._save_bounded</text>
</a>
</g>
</g>
<!-- tg_client._save_bounded&#45;&gt;tg_client._save_message -->
<g id="edge145" class="edge">
<title>tg_client._save_bounded&#45;&gt;tg_client._save_message</title>
<path fill="none" stroke="black" d="M3266.94,-3077.29C3392.46,-3028.84 3706.14,-2907.75 3898.36,-2833.55"/>
<polygon fill="black" stroke="black" points="3899.63,-2836.8 3907.7,-2829.94 3897.11,-2830.27 3899.63,-2836.8"/>
</g>
<!-- tg_client._remove_local_message -->
<g id="node109" class="node">
<title>tg_client._remove_local_message</title>
<g id="a_node109"><a xlink:title="Delete ``path`` and related media if the post no longer exists.">
<polygon fill="none" stroke="black" points="7594,-3502.3 7024,-3502.3 7024,-3458.3 7594,-3458.3 7594,-3502.3"/>
<text text-anchor="middle" x="7309" y="-3471.98" font-family="Times,serif" font-size="32.90">tg_client._remove_local_message</text>
</a>
</g>
</g>
<!-- tg_client._remove_local_message&#45;&gt;post_io.read_post -->
<g id="edge148" class="edge">
<title>tg_client._remove_local_message&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7594.14,-3486.46C7670.35,-3482 7739.11,-3470.26 7766,-3444.3 7867.07,-3346.75 7711.02,-3237.33 7802,-3130.3 7865.78,-3055.28 7963.12,-3015.4 8057.92,-2994.65"/>
<polygon fill="black" stroke="black" points="8058.91,-2998.02 8067.97,-2992.52 8057.46,-2991.17 8058.91,-2998.02"/>
</g>
<!-- tg_client._remove_local_message&#45;&gt;caption_io.caption_json_path -->
<g id="edge146" class="edge">
<title>tg_client._remove_local_message&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M7594.28,-3485.93C7670.22,-3481.41 7738.79,-3469.78 7766,-3444.3 7846.99,-3368.49 7721.7,-3273.85 7802,-3197.3 7978.15,-3029.38 8694.76,-3233.87 8892,-3091.3 9145.54,-2908.04 9207.18,-2485.74 9219.36,-2372.61"/>
<polygon fill="black" stroke="black" points="9222.88,-2372.67 9220.42,-2362.36 9215.91,-2371.95 9222.88,-2372.67"/>
</g>
<!-- tg_client._remove_local_message&#45;&gt;caption_io.caption_md_path -->
<g id="edge147" class="edge">
<title>tg_client._remove_local_message&#45;&gt;caption_io.caption_md_path</title>
<path fill="none" stroke="black" d="M7594.09,-3485.37C7669.88,-3480.82 7738.41,-3469.3 7766,-3444.3 7833.25,-3383.37 7733.53,-3302.88 7802,-3243.3 7847.72,-3203.53 8831.45,-3203.85 8892,-3201.3 8968.01,-3198.11 9053.85,-3194.2 9118.93,-3191.17"/>
<polygon fill="black" stroke="black" points="9119.37,-3194.66 9129.19,-3190.69 9119.04,-3187.66 9119.37,-3194.66"/>
</g>
<!-- tg_client._download_messages -->
<g id="node110" class="node">
<title>tg_client._download_messages</title>
<g id="a_node110"><a xlink:title="Save ``messages`` with a progress bar and return count saved.">
<polygon fill="none" stroke="black" points="2961.5,-2819.8 2251.5,-2819.8 2251.5,-2762.8 2961.5,-2762.8 2961.5,-2819.8"/>
<text text-anchor="middle" x="2606.5" y="-2779.96" font-family="Times,serif" font-size="44.80">tg_client._download_messages</text>
</a>
</g>
</g>
<!-- tg_client._download_messages&#45;&gt;tg_client._save_bounded -->
<g id="edge149" class="edge">
<title>tg_client._download_messages&#45;&gt;tg_client._save_bounded</title>
<path fill="none" stroke="black" d="M2648.73,-2819.92C2747.15,-2888.14 2989.14,-3055.29 3009,-3063.3 3019.44,-3067.52 3030.39,-3071.23 3041.55,-3074.49"/>
<polygon fill="black" stroke="black" points="3040.84,-3077.92 3051.41,-3077.24 3042.72,-3071.18 3040.84,-3077.92"/>
</g>
<!-- tg_client.ensure_chat_access -->
<g id="node111" class="node">
<title>tg_client.ensure_chat_access</title>
<g id="a_node111"><a xlink:title="Join chats listed in ``CHATS`` if not already joined.">
<polygon fill="none" stroke="black" points="2777.5,-3119.3 2435.5,-3119.3 2435.5,-3083.3 2777.5,-3083.3 2777.5,-3119.3"/>
<text text-anchor="middle" x="2606.5" y="-3095.61" font-family="Times,serif" font-size="22.12">tg_client.ensure_chat_access</text>
</a>
</g>
</g>
<!-- tg_client.refetch_messages -->
<g id="node112" class="node">
<title>tg_client.refetch_messages</title>
<g id="a_node112"><a xlink:title="Re&#45;fetch posts that failed parsing or are empty.">
<polygon fill="none" stroke="black" points="2973,-2659.8 2240,-2659.8 2240,-2594.8 2973,-2594.8 2973,-2659.8"/>
<text text-anchor="middle" x="2606.5" y="-2614.25" font-family="Times,serif" font-size="51.94">tg_client.refetch_messages</text>
</a>
</g>
</g>
<!-- tg_client.refetch_messages&#45;&gt;notes_utils.write_json -->
<g id="edge156" class="edge">
<title>tg_client.refetch_messages&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M2774,-2659.9C2840.79,-2678.98 2915.41,-2708.46 2973,-2753.3 2996.05,-2771.25 2988.25,-2787.74 3009,-2808.3 3160.92,-2958.88 3253.86,-2926.5 3414,-3068.3 3497.95,-3142.64 4601.34,-4572.89 4702,-4622.3 5007.7,-4772.37 7425.54,-4702.67 7766,-4695.3 8273.79,-4684.32 8880.49,-4651.83 9118.75,-4638.31"/>
<polygon fill="black" stroke="black" points="9119,-4641.8 9128.78,-4637.74 9118.6,-4634.81 9119,-4641.8"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;notes_utils.load_json -->
<g id="edge155" class="edge">
<title>tg_client.refetch_messages&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M2626.86,-2594.56C2677.6,-2512.08 2823.43,-2295.59 3009,-2200.3 3170.54,-2117.36 3237.23,-2187.89 3414,-2146.3 4242.97,-1951.31 4388.54,-1675.27 5227,-1526.3 5277.12,-1517.4 8853.34,-1446.18 8892,-1479.3 8971.24,-1547.2 8853.29,-1638.46 8928,-1711.3 8969.72,-1751.97 9032.03,-1764.11 9088.56,-1764.99"/>
<polygon fill="black" stroke="black" points="9088.66,-1768.49 9098.68,-1765.03 9088.69,-1761.49 9088.66,-1768.49"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;post_io.read_post -->
<g id="edge153" class="edge">
<title>tg_client.refetch_messages&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M2892.07,-2594.79C3184.03,-2564.28 3651.59,-2523.3 4057,-2523.3 4057,-2523.3 4057,-2523.3 5503.5,-2523.3 5629.2,-2523.3 7669.3,-2453 7766,-2533.3 7831.45,-2587.65 7749.78,-2654.14 7802,-2721.3 7889.73,-2834.15 8039.42,-2899.25 8159.6,-2935.39"/>
<polygon fill="black" stroke="black" points="8158.71,-2938.78 8169.29,-2938.26 8160.7,-2932.07 8158.71,-2938.78"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;post_io.raw_post_path -->
<g id="edge154" class="edge">
<title>tg_client.refetch_messages&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M2687.27,-2594.67C2903.65,-2509.18 3521.46,-2285.3 4057,-2285.3 4057,-2285.3 4057,-2285.3 5503.5,-2285.3 6006.33,-2285.3 7271.39,-2228.71 7766,-2319.3 7782.73,-2322.37 7785.42,-2328.49 7802,-2332.3 7961.15,-2368.96 8151.94,-2382.54 8260.06,-2387.51"/>
<polygon fill="black" stroke="black" points="8260.11,-2391.01 8270.26,-2387.96 8260.42,-2384.02 8260.11,-2391.01"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;tg_client._get_message_path -->
<g id="edge150" class="edge">
<title>tg_client.refetch_messages&#45;&gt;tg_client._get_message_path</title>
<path fill="none" stroke="black" d="M2633.77,-2594.71C2692.79,-2523.82 2843.73,-2355.3 3009,-2271.3 3031.54,-2259.85 3056.99,-2251.36 3082.01,-2245.08"/>
<polygon fill="black" stroke="black" points="3083.04,-2248.43 3091.95,-2242.7 3081.4,-2241.63 3083.04,-2248.43"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;tg_client._save_bounded -->
<g id="edge151" class="edge">
<title>tg_client.refetch_messages&#45;&gt;tg_client._save_bounded</title>
<path fill="none" stroke="black" d="M2826.74,-2659.88C2882.17,-2678.5 2936.3,-2707.67 2973,-2753.3 3059.92,-2861.4 2913.72,-2962.5 3009,-3063.3 3011.52,-3065.97 3014.15,-3068.47 3016.9,-3070.82"/>
<polygon fill="black" stroke="black" points="3014.89,-3073.69 3024.93,-3077.07 3019.19,-3068.17 3014.89,-3073.69"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;tg_client._remove_local_message -->
<g id="edge152" class="edge">
<title>tg_client.refetch_messages&#45;&gt;tg_client._remove_local_message</title>
<path fill="none" stroke="black" d="M2721.96,-2659.86C2883.69,-2705.53 3188.56,-2790.41 3450,-2856.3 4003.95,-2995.92 4137.39,-3060.3 4702,-3147.3 5633.38,-3290.83 5925.3,-3003.52 6816,-3311.3 6834.18,-3317.58 6834.67,-3326.98 6852,-3335.3 6966.99,-3390.56 7108.11,-3431.7 7202.63,-3455.77"/>
<polygon fill="black" stroke="black" points="7201.93,-3459.21 7212.49,-3458.27 7203.65,-3452.42 7201.93,-3459.21"/>
</g>
<!-- tg_client.fetch_missing -->
<g id="node113" class="node">
<title>tg_client.fetch_missing</title>
<g id="a_node113"><a xlink:title="Pull new messages and back&#45;fill history until fully synced.">
<polygon fill="none" stroke="black" points="1732,-2138.3 1019,-2138.3 1019,-2064.3 1732,-2064.3 1732,-2138.3"/>
<text text-anchor="middle" x="1375.5" y="-2086.48" font-family="Times,serif" font-size="59.78">tg_client.fetch_missing</text>
</a>
</g>
</g>
<!-- tg_client.fetch_missing&#45;&gt;post_io.raw_post_path -->
<g id="edge163" class="edge">
<title>tg_client.fetch_missing&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M1732.07,-2127.1C1887.86,-2137.05 2072.9,-2147.06 2240,-2151.3 2565.67,-2159.58 2648,-2173.77 2973,-2151.3 2989.12,-2150.19 2992.89,-2147.53 3009,-2146.3 3473.49,-2111.08 3591.18,-2132.3 4057,-2132.3 4057,-2132.3 4057,-2132.3 6316,-2132.3 6396.57,-2132.3 7703.98,-2106.87 7766,-2158.3 7826.79,-2208.72 7743.5,-2279.26 7802,-2332.3 7867.28,-2391.49 8123.69,-2395.35 8259.89,-2392.99"/>
<polygon fill="black" stroke="black" points="8260.35,-2396.48 8270.29,-2392.8 8260.22,-2389.49 8260.35,-2396.48"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client._get_id_date -->
<g id="edge157" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client._get_id_date</title>
<path fill="none" stroke="black" d="M1413.48,-2064.14C1554.58,-1926.45 2077.85,-1453.3 2605.5,-1453.3 2605.5,-1453.3 2605.5,-1453.3 5503.5,-1453.3 6097.38,-1453.3 6801.2,-1448.92 7126.49,-1446.64"/>
<polygon fill="black" stroke="black" points="7126.98,-1450.14 7136.95,-1446.57 7126.93,-1443.14 7126.98,-1450.14"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client._load_progress -->
<g id="edge158" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client._load_progress</title>
<path fill="none" stroke="black" d="M1387.72,-2064.03C1423.47,-1951.68 1545.63,-1613.39 1768,-1439.3 2423.91,-925.82 3470.97,-831.07 3882.66,-813.93"/>
<polygon fill="black" stroke="black" points="3883.02,-817.42 3892.87,-813.51 3882.73,-810.42 3883.02,-817.42"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client._save_progress -->
<g id="edge159" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client._save_progress</title>
<path fill="none" stroke="black" d="M1732.39,-2107.96C1984.51,-2112.68 2307.68,-2118.73 2481.52,-2121.98"/>
<polygon fill="black" stroke="black" points="2481.67,-2125.49 2491.73,-2122.18 2481.8,-2118.49 2481.67,-2125.49"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client.get_first_id -->
<g id="edge160" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client.get_first_id</title>
<path fill="none" stroke="black" d="M1732.02,-2098.4C2138.03,-2095.08 2782.81,-2089.8 3067.44,-2087.47"/>
<polygon fill="black" stroke="black" points="3067.86,-2090.97 3077.83,-2087.39 3067.8,-2083.97 3067.86,-2090.97"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client.get_last_id -->
<g id="edge161" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client.get_last_id</title>
<path fill="none" stroke="black" d="M1703.02,-2064.28C1753,-2058.61 1802.18,-2053.04 1845.12,-2048.17"/>
<polygon fill="black" stroke="black" points="1845.78,-2051.61 1855.32,-2047.01 1844.99,-2044.66 1845.78,-2051.61"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client._download_messages -->
<g id="edge162" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client._download_messages</title>
<path fill="none" stroke="black" d="M1423.52,-2138.53C1549.36,-2236.72 1906.98,-2506.28 2240,-2668.3 2319.51,-2706.99 2414.26,-2738.5 2487.37,-2759.93"/>
<polygon fill="black" stroke="black" points="2486.5,-2763.33 2497.08,-2762.76 2488.45,-2756.61 2486.5,-2763.33"/>
</g>
<!-- tg_client.remove_deleted -->
<g id="node114" class="node">
<title>tg_client.remove_deleted</title>
<g id="a_node114"><a xlink:title="Delete locally stored messages removed from Telegram recently.">
<polygon fill="none" stroke="black" points="7625.5,-3217.8 6992.5,-3217.8 6992.5,-3156.8 7625.5,-3156.8 7625.5,-3217.8"/>
<text text-anchor="middle" x="7309" y="-3175.05" font-family="Times,serif" font-size="48.44">tg_client.remove_deleted</text>
</a>
</g>
</g>
<!-- tg_client.remove_deleted&#45;&gt;post_io.read_post -->
<g id="edge166" class="edge">
<title>tg_client.remove_deleted&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7625.65,-3207.97C7676.66,-3198.34 7725.83,-3179.78 7766,-3147.3 7808.31,-3113.1 7759.89,-3064.75 7802,-3030.3 7872.72,-2972.46 7967.18,-2950.48 8057.52,-2945.57"/>
<polygon fill="black" stroke="black" points="8057.84,-2949.06 8067.66,-2945.09 8057.51,-2942.07 8057.84,-2949.06"/>
</g>
<!-- tg_client.remove_deleted&#45;&gt;post_io.raw_post_path -->
<g id="edge167" class="edge">
<title>tg_client.remove_deleted&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7449.57,-3217.83C7551.6,-3231.21 7685.66,-3228.66 7766,-3147.3 7841.16,-3071.19 7742.72,-2756.34 7802,-2667.3 7908.22,-2507.75 8135.86,-2435.39 8260.35,-2406.65"/>
<polygon fill="black" stroke="black" points="8261.25,-2410.04 8270.23,-2404.41 8259.71,-2403.21 8261.25,-2410.04"/>
</g>
<!-- tg_client.remove_deleted&#45;&gt;caption_io.caption_json_path -->
<g id="edge164" class="edge">
<title>tg_client.remove_deleted&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M7625.62,-3174.26C7673.15,-3168.1 7721.22,-3159.42 7766,-3147.3 7783.08,-3142.68 7784.94,-3135.02 7802,-3130.3 8036.6,-3065.5 8692.25,-3162.36 8892,-3023.3 9127.55,-2859.33 9201.59,-2479.06 9218.07,-2372.51"/>
<polygon fill="black" stroke="black" points="9221.55,-2372.93 9219.57,-2362.52 9214.62,-2371.89 9221.55,-2372.93"/>
</g>
<!-- tg_client.remove_deleted&#45;&gt;caption_io.caption_md_path -->
<g id="edge165" class="edge">
<title>tg_client.remove_deleted&#45;&gt;caption_io.caption_md_path</title>
<path fill="none" stroke="black" d="M7625.73,-3187.14C8065.77,-3186.91 8840.77,-3186.5 9118.97,-3186.36"/>
<polygon fill="black" stroke="black" points="9119.06,-3189.86 9129.05,-3186.35 9119.05,-3182.86 9119.06,-3189.86"/>
</g>
<!-- tg_client.main -->
<g id="node115" class="node">
<title>tg_client.main</title>
<g id="a_node115"><a xlink:title="Synchronize configured chats and optional live updates.">
<polygon fill="none" stroke="black" points="934.5,-3170.3 366.5,-3170.3 366.5,-3078.3 934.5,-3078.3 934.5,-3170.3"/>
<text text-anchor="middle" x="650.5" y="-3105.26" font-family="Times,serif" font-size="76.30">tg_client.main</text>
</a>
</g>
</g>
<!-- tg_client.main&#45;&gt;tg_client._mark_activity -->
<g id="edge168" class="edge">
<title>tg_client.main&#45;&gt;tg_client._mark_activity</title>
<path fill="none" stroke="black" d="M934.7,-3132.02C1204.62,-3138.7 1622.49,-3147.3 1985,-3147.3 1985,-3147.3 1985,-3147.3 2607.5,-3147.3 3472.13,-3147.3 4516.5,-3128.61 4842.95,-3122.33"/>
<polygon fill="black" stroke="black" points="4843.4,-3125.83 4853.33,-3122.13 4843.26,-3118.83 4843.4,-3125.83"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client._heartbeat -->
<g id="edge169" class="edge">
<title>tg_client.main&#45;&gt;tg_client._heartbeat</title>
<path fill="none" stroke="black" d="M808.58,-3170.4C873.25,-3187.83 949.23,-3206.32 1019,-3218.3 1095.26,-3231.4 1181.69,-3239.34 1250.24,-3244.03"/>
<polygon fill="black" stroke="black" points="1250.01,-3247.52 1260.22,-3244.7 1250.48,-3240.53 1250.01,-3247.52"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client._flush_chop_queue -->
<g id="edge170" class="edge">
<title>tg_client.main&#45;&gt;tg_client._flush_chop_queue</title>
<path fill="none" stroke="black" d="M712.26,-3170.42C944.11,-3346.36 1769.11,-3972.46 1949.84,-4109.62"/>
<polygon fill="black" stroke="black" points="1947.87,-4112.52 1957.96,-4115.78 1952.11,-4106.95 1947.87,-4112.52"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client._save_bounded -->
<g id="edge171" class="edge">
<title>tg_client.main&#45;&gt;tg_client._save_bounded</title>
<path fill="none" stroke="black" d="M934.88,-3111.52C963.3,-3110.37 991.72,-3109.28 1019,-3108.3 1887.02,-3077.32 2105.53,-3030.59 2973,-3074.3 2984.72,-3074.89 2996.76,-3075.65 3008.89,-3076.52"/>
<polygon fill="black" stroke="black" points="3008.87,-3080.03 3019.1,-3077.28 3009.39,-3073.05 3008.87,-3080.03"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client.ensure_chat_access -->
<g id="edge172" class="edge">
<title>tg_client.main&#45;&gt;tg_client.ensure_chat_access</title>
<path fill="none" stroke="black" d="M934.58,-3120.97C1342.56,-3116.17 2084.17,-3107.44 2425.17,-3103.43"/>
<polygon fill="black" stroke="black" points="2425.43,-3106.92 2435.39,-3103.31 2425.35,-3099.92 2425.43,-3106.92"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client.refetch_messages -->
<g id="edge173" class="edge">
<title>tg_client.main&#45;&gt;tg_client.refetch_messages</title>
<path fill="none" stroke="black" d="M832.7,-3078.22C1220.31,-2979.63 2122.68,-2750.11 2467.85,-2662.32"/>
<polygon fill="black" stroke="black" points="2468.82,-2665.68 2477.65,-2659.82 2467.1,-2658.9 2468.82,-2665.68"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client.fetch_missing -->
<g id="edge174" class="edge">
<title>tg_client.main&#45;&gt;tg_client.fetch_missing</title>
<path fill="none" stroke="black" d="M684.21,-3078.03C804.71,-2907.53 1223.05,-2315.59 1342.45,-2146.65"/>
<polygon fill="black" stroke="black" points="1345.33,-2148.64 1348.24,-2138.46 1339.61,-2144.6 1345.33,-2148.64"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client.remove_deleted -->
<g id="edge175" class="edge">
<title>tg_client.main&#45;&gt;tg_client.remove_deleted</title>
<path fill="none" stroke="black" d="M934.75,-3151.17C1204.49,-3174.41 1622.03,-3204.3 1985,-3204.3 1985,-3204.3 1985,-3204.3 4947.5,-3204.3 5674.18,-3204.3 6526.66,-3196.15 6982.04,-3191.13"/>
<polygon fill="black" stroke="black" points="6982.1,-3194.63 6992.06,-3191.02 6982.02,-3187.64 6982.1,-3194.63"/>
</g>
<!-- clean_data._parse_date -->
<g id="node116" class="node">
<title>clean_data._parse_date</title>
<g id="a_node116"><a xlink:title="Return the ``date`` field from a markdown file if present.">
<polygon fill="none" stroke="black" points="8486.5,-3288.3 8207.5,-3288.3 8207.5,-3252.3 8486.5,-3252.3 8486.5,-3288.3"/>
<text text-anchor="middle" x="8347" y="-3264.61" font-family="Times,serif" font-size="22.12">clean_data._parse_date</text>
</a>
</g>
</g>
<!-- clean_data._parse_date&#45;&gt;notes_utils.read_text -->
<g id="edge176" class="edge">
<title>clean_data._parse_date&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M8401.12,-3288.38C8584.16,-3346.95 9195.11,-3511.13 9518,-3213.3 9665.31,-3077.43 9755.33,-1538.09 9767.96,-1308.79"/>
<polygon fill="black" stroke="black" points="9771.47,-1308.77 9768.52,-1298.6 9764.48,-1308.39 9771.47,-1308.77"/>
</g>
<!-- clean_data._clean_raw -->
<g id="node117" class="node">
<title>clean_data._clean_raw</title>
<g id="a_node117"><a xlink:title="Delete raw posts older than ``cutoff``.">
<polygon fill="none" stroke="black" points="7462.5,-3272.3 7155.5,-3272.3 7155.5,-3236.3 7462.5,-3236.3 7462.5,-3272.3"/>
<text text-anchor="middle" x="7309" y="-3248.14" font-family="Times,serif" font-size="25.20">clean_data._clean_raw</text>
</a>
</g>
</g>
<!-- clean_data._clean_raw&#45;&gt;post_io.raw_post_path -->
<g id="edge178" class="edge">
<title>clean_data._clean_raw&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7462.51,-3265.67C7578.28,-3270.63 7724.4,-3267.78 7766,-3226.3 7854.15,-3138.42 7733.57,-2771.29 7802,-2667.3 7907.37,-2507.19 8135.36,-2435.06 8260.13,-2406.51"/>
<polygon fill="black" stroke="black" points="8261.05,-2409.89 8270.04,-2404.28 8259.51,-2403.06 8261.05,-2409.89"/>
</g>
<!-- clean_data._clean_raw&#45;&gt;clean_data._parse_date -->
<g id="edge177" class="edge">
<title>clean_data._clean_raw&#45;&gt;clean_data._parse_date</title>
<path fill="none" stroke="black" d="M7462.59,-3256.66C7660.02,-3259.71 8001.77,-3264.99 8197.29,-3268.01"/>
<polygon fill="black" stroke="black" points="8197.31,-3271.51 8207.36,-3268.16 8197.41,-3264.51 8197.31,-3271.51"/>
</g>
<!-- clean_data._clean_media -->
<g id="node118" class="node">
<title>clean_data._clean_media</title>
<g id="a_node118"><a xlink:title="Remove unused media files older than ``cutoff``.">
<polygon fill="none" stroke="black" points="7499,-3738.3 7119,-3738.3 7119,-3698.3 7499,-3698.3 7499,-3738.3"/>
<text text-anchor="middle" x="7309" y="-3711.23" font-family="Times,serif" font-size="28.84">clean_data._clean_media</text>
</a>
</g>
</g>
<!-- clean_data._clean_media&#45;&gt;caption_io.has_caption -->
<g id="edge179" class="edge">
<title>clean_data._clean_media&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M7499.17,-3706.29C7583.2,-3706.99 7681.9,-3716.27 7766,-3747.3 7784.76,-3754.23 7783.48,-3766.75 7802,-3774.3 7954.46,-3836.54 8149.05,-3847.56 8259.37,-3848.15"/>
<polygon fill="black" stroke="black" points="8259.44,-3851.65 8269.45,-3848.17 8259.46,-3844.65 8259.44,-3851.65"/>
</g>
<!-- clean_data._clean_media&#45;&gt;clean_data._parse_date -->
<g id="edge180" class="edge">
<title>clean_data._clean_media&#45;&gt;clean_data._parse_date</title>
<path fill="none" stroke="black" d="M7499.11,-3726.92C7587,-3722.2 7688.88,-3703.43 7766,-3650.3 7792.88,-3631.79 7779.08,-3609.54 7802,-3586.3 7948.85,-3437.41 8180.35,-3334.47 8287.72,-3292.03"/>
<polygon fill="black" stroke="black" points="8289.07,-3295.27 8297.1,-3288.36 8286.51,-3288.75 8289.07,-3295.27"/>
</g>
<!-- clean_data._clean_lots -->
<g id="node119" class="node">
<title>clean_data._clean_lots</title>
<g id="a_node119"><a xlink:title="Drop lots missing translations or source posts.">
<polygon fill="none" stroke="black" points="7511,-3802.3 7107,-3802.3 7107,-3756.3 7511,-3756.3 7511,-3802.3"/>
<text text-anchor="middle" x="7309" y="-3770.86" font-family="Times,serif" font-size="34.30">clean_data._clean_lots</text>
</a>
</g>
</g>
<!-- clean_data._clean_lots&#45;&gt;lot_io.read_lots -->
<g id="edge183" class="edge">
<title>clean_data._clean_lots&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M7511.02,-3790.3C7592.5,-3788.4 7686.05,-3777.91 7766,-3747.3 7784.93,-3740.06 7783.14,-3726.74 7802,-3719.3 7942.02,-3664.12 8117.51,-3658.53 8230.68,-3662.25"/>
<polygon fill="black" stroke="black" points="8230.63,-3665.75 8240.75,-3662.61 8230.88,-3658.75 8230.63,-3665.75"/>
</g>
<!-- clean_data._clean_lots&#45;&gt;lot_io.needs_cleanup -->
<g id="edge182" class="edge">
<title>clean_data._clean_lots&#45;&gt;lot_io.needs_cleanup</title>
<path fill="none" stroke="black" d="M7360.26,-3802.41C7454.43,-3848.3 7657.69,-3960.06 7766,-4115.3 7798.84,-4162.37 7761.8,-4198.35 7802,-4239.3 7921.18,-4360.73 8125.86,-4395.28 8247.29,-4404.88"/>
<polygon fill="black" stroke="black" points="8247.1,-4408.37 8257.33,-4405.63 8247.62,-4401.39 8247.1,-4408.37"/>
</g>
<!-- clean_data._clean_lots&#45;&gt;post_io.raw_post_path -->
<g id="edge181" class="edge">
<title>clean_data._clean_lots&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7511.26,-3790.73C7616.53,-3791.89 7730.72,-3783.91 7766,-3747.3 7849.33,-3660.86 7737.56,-2768.61 7802,-2667.3 7905.16,-2505.15 8135.13,-2433.73 8260.5,-2405.87"/>
<polygon fill="black" stroke="black" points="8261.42,-2409.25 8270.45,-2403.7 8259.93,-2402.41 8261.42,-2409.25"/>
</g>
<!-- clean_data._clean_embeddings -->
<g id="node120" class="node">
<title>clean_data._clean_embeddings</title>
<g id="a_node120"><a xlink:title="Delete embedding files when the matching lot JSON is absent.">
<polygon fill="none" stroke="black" points="7517,-3084.3 7101,-3084.3 7101,-3048.3 7517,-3048.3 7517,-3084.3"/>
<text text-anchor="middle" x="7309" y="-3060.14" font-family="Times,serif" font-size="25.20">clean_data._clean_embeddings</text>
</a>
</g>
</g>
<!-- clean_data._remove_empty_dirs -->
<g id="node121" class="node">
<title>clean_data._remove_empty_dirs</title>
<g id="a_node121"><a xlink:title="Recursively remove empty folders under ``root``.">
<polygon fill="none" stroke="black" points="8560.5,-3954.3 8133.5,-3954.3 8133.5,-3918.3 8560.5,-3918.3 8560.5,-3954.3"/>
<text text-anchor="middle" x="8347" y="-3930.14" font-family="Times,serif" font-size="25.20">clean_data._remove_empty_dirs</text>
</a>
</g>
</g>
<!-- clean_data.main -->
<g id="node122" class="node">
<title>clean_data.main</title>
<g id="a_node122"><a xlink:title="Clean up old or inconsistent files across data directories.">
<polygon fill="none" stroke="black" points="6411,-3356.3 6219,-3356.3 6219,-3320.3 6411,-3320.3 6411,-3356.3"/>
<text text-anchor="middle" x="6315" y="-3333" font-family="Times,serif" font-size="21.00">clean_data.main</text>
</a>
</g>
</g>
<!-- clean_data.main&#45;&gt;clean_data._clean_raw -->
<g id="edge184" class="edge">
<title>clean_data.main&#45;&gt;clean_data._clean_raw</title>
<path fill="none" stroke="black" d="M6411.24,-3326.81C6518.31,-3314.22 6697.42,-3294.09 6852,-3281.3 6949.12,-3273.27 7058.07,-3266.73 7145.12,-3262.1"/>
<polygon fill="black" stroke="black" points="7145.55,-3265.58 7155.35,-3261.55 7145.18,-3258.59 7145.55,-3265.58"/>
</g>
<!-- clean_data.main&#45;&gt;clean_data._clean_media -->
<g id="edge185" class="edge">
<title>clean_data.main&#45;&gt;clean_data._clean_media</title>
<path fill="none" stroke="black" d="M6374.2,-3320.28C6478.05,-3292.1 6695.69,-3251.82 6816,-3365.3 6919.79,-3463.2 6749.22,-3585.35 6852,-3684.3 6888.74,-3719.67 7003.46,-3728.11 7108.63,-3727.73"/>
<polygon fill="black" stroke="black" points="7108.8,-3731.23 7118.78,-3727.67 7108.76,-3724.23 7108.8,-3731.23"/>
</g>
<!-- clean_data.main&#45;&gt;clean_data._clean_lots -->
<g id="edge186" class="edge">
<title>clean_data.main&#45;&gt;clean_data._clean_lots</title>
<path fill="none" stroke="black" d="M6373.58,-3320.28C6477.44,-3291.75 6696.42,-3250.42 6816,-3365.3 6877.49,-3424.38 6790.99,-3687.74 6852,-3747.3 6887.14,-3781.61 6994.86,-3790.23 7096.79,-3789.97"/>
<polygon fill="black" stroke="black" points="7096.97,-3793.47 7106.95,-3789.92 7096.93,-3786.47 7096.97,-3793.47"/>
</g>
<!-- clean_data.main&#45;&gt;clean_data._clean_embeddings -->
<g id="edge187" class="edge">
<title>clean_data.main&#45;&gt;clean_data._clean_embeddings</title>
<path fill="none" stroke="black" d="M6345.09,-3320.26C6423.41,-3272.76 6646.72,-3144.4 6852,-3093.3 6928.5,-3074.26 7014.36,-3065.94 7090.76,-3062.88"/>
<polygon fill="black" stroke="black" points="7091.13,-3066.37 7100.99,-3062.5 7090.87,-3059.37 7091.13,-3066.37"/>
</g>
<!-- clean_data.main&#45;&gt;clean_data._remove_empty_dirs -->
<g id="edge188" class="edge">
<title>clean_data.main&#45;&gt;clean_data._remove_empty_dirs</title>
<path fill="none" stroke="black" d="M6373.04,-3320.23C6477.01,-3291.23 6697.53,-3248.66 6816,-3365.3 6898.07,-3446.1 6769.22,-3802.24 6852,-3882.3 6941.07,-3968.45 7728.71,-3956.12 8123.06,-3944.3"/>
<polygon fill="black" stroke="black" points="8123.28,-3947.79 8133.17,-3943.99 8123.07,-3940.79 8123.28,-3947.79"/>
</g>
<!-- post_io.raw_post_path_from_lot -->
<g id="node125" class="node">
<title>post_io.raw_post_path_from_lot</title>
<g id="a_node125"><a xlink:title="Return raw post path referenced by ``lot`` or ``None``.">
<polygon fill="none" stroke="black" points="7454,-3138.3 7164,-3138.3 7164,-3102.3 7454,-3102.3 7454,-3138.3"/>
<text text-anchor="middle" x="7309" y="-3116.14" font-family="Times,serif" font-size="17.08">post_io.raw_post_path_from_lot</text>
</a>
</g>
</g>
<!-- post_io.raw_post_path_from_lot&#45;&gt;post_io.raw_post_path -->
<g id="edge194" class="edge">
<title>post_io.raw_post_path_from_lot&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7454.13,-3131.43C7570.93,-3137 7722.95,-3135.28 7766,-3093.3 7834.02,-3026.98 7748.98,-2746.14 7802,-2667.3 7908.97,-2508.26 8136.3,-2435.68 8260.54,-2406.78"/>
<polygon fill="black" stroke="black" points="8261.44,-2410.17 8270.41,-2404.53 8259.88,-2403.34 8261.44,-2410.17"/>
</g>
<!-- message_utils.gather_chop_input -->
<g id="node126" class="node">
<title>message_utils.gather_chop_input</title>
<g id="a_node126"><a xlink:title="Return the exact text fed to the lot parser for ``msg_path``.">
<polygon fill="none" stroke="black" points="7521.5,-2992.3 7096.5,-2992.3 7096.5,-2956.3 7521.5,-2956.3 7521.5,-2992.3"/>
<text text-anchor="middle" x="7309" y="-2968.43" font-family="Times,serif" font-size="24.22">message_utils.gather_chop_input</text>
</a>
</g>
</g>
<!-- message_utils.gather_chop_input&#45;&gt;caption_io.read_caption -->
<g id="edge195" class="edge">
<title>message_utils.gather_chop_input&#45;&gt;caption_io.read_caption</title>
<path fill="none" stroke="black" d="M7521.76,-2988.1C7623.84,-2989.71 7731.54,-2982.24 7766,-2947.3 7827.71,-2884.75 7740.05,-2219.62 7802,-2157.3 7852.21,-2106.8 8031.62,-2106.03 8170.84,-2113.95"/>
<polygon fill="black" stroke="black" points="8171.02,-2117.47 8181.21,-2114.56 8171.43,-2110.48 8171.02,-2117.47"/>
</g>
<!-- message_utils.gather_chop_input&#45;&gt;post_io.read_post -->
<g id="edge196" class="edge">
<title>message_utils.gather_chop_input&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7521.52,-2974.71C7676.16,-2975.01 7887.69,-2975.42 8057.78,-2975.75"/>
<polygon fill="black" stroke="black" points="8057.89,-2979.25 8067.89,-2975.77 8057.9,-2972.25 8057.89,-2979.25"/>
</g>
<!-- message_utils.gather_chop_input&#45;&gt;message_utils.build_prompt -->
<g id="edge197" class="edge">
<title>message_utils.gather_chop_input&#45;&gt;message_utils.build_prompt</title>
<path fill="none" stroke="black" d="M7405.58,-2956.29C7510.84,-2942.6 7676.95,-2940.32 7766,-3039.3 7840.29,-3121.88 7726.86,-3956.51 7802,-4038.3 7852.48,-4093.25 8045.34,-4105.64 8187.15,-4107"/>
<polygon fill="black" stroke="black" points="8187.24,-4110.5 8197.26,-4107.08 8187.29,-4103.5 8187.24,-4110.5"/>
</g>
<!-- debug_dump.parse_url -->
<g id="node127" class="node">
<title>debug_dump.parse_url</title>
<g id="a_node127"><a xlink:title="Return ``(lot_id, lang)`` extracted from ``url``.">
<polygon fill="none" stroke="black" points="7458.5,-1898.3 7159.5,-1898.3 7159.5,-1862.3 7458.5,-1862.3 7458.5,-1898.3"/>
<text text-anchor="middle" x="7309" y="-1874.43" font-family="Times,serif" font-size="24.22">debug_dump.parse_url</text>
</a>
</g>
</g>
<!-- debug_dump.guess_source_from_lot -->
<g id="node128" class="node">
<title>debug_dump.guess_source_from_lot</title>
<g id="a_node128"><a xlink:title="Guess ``(chat, message_id)`` directly from ``lot_id``.">
<polygon fill="none" stroke="black" points="8568,-1524.3 8126,-1524.3 8126,-1488.3 8568,-1488.3 8568,-1524.3"/>
<text text-anchor="middle" x="8347" y="-1500.71" font-family="Times,serif" font-size="23.24">debug_dump.guess_source_from_lot</text>
</a>
</g>
</g>
<!-- debug_dump.load_source_info -->
<g id="node129" class="node">
<title>debug_dump.load_source_info</title>
<g id="a_node129"><a xlink:title="Return ``(chat, message_id)`` for ``lot_id`` if available.">
<polygon fill="none" stroke="black" points="7563,-1234.8 7055,-1234.8 7055,-1191.8 7563,-1191.8 7563,-1234.8"/>
<text text-anchor="middle" x="7309" y="-1205.16" font-family="Times,serif" font-size="32.06">debug_dump.load_source_info</text>
</a>
</g>
</g>
<!-- debug_dump.load_source_info&#45;&gt;notes_utils.load_json -->
<g id="edge198" class="edge">
<title>debug_dump.load_source_info&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M7563.24,-1203.41C7985.91,-1189.52 8798.32,-1175.03 8892,-1264.3 8964.14,-1333.05 8859.25,-1639.16 8928,-1711.3 8968.53,-1753.83 9031.37,-1765.99 9088.56,-1766.41"/>
<polygon fill="black" stroke="black" points="9088.81,-1769.91 9098.79,-1766.36 9088.78,-1762.91 9088.81,-1769.91"/>
</g>
<!-- debug_dump.load_source_info&#45;&gt;lot_io.lot_json_path -->
<g id="edge199" class="edge">
<title>debug_dump.load_source_info&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M7563.14,-1202.07C7651.13,-1203.85 7735.48,-1213.94 7766,-1243.3 7821.39,-1296.6 7748.05,-1532.56 7802,-1587.3 7864.12,-1650.34 8123.39,-1656.08 8260.35,-1654.51"/>
<polygon fill="black" stroke="black" points="8260.45,-1658.01 8270.4,-1654.38 8260.36,-1651.01 8260.45,-1658.01"/>
</g>
<!-- debug_dump.run_tg_fetch -->
<g id="node130" class="node">
<title>debug_dump.run_tg_fetch</title>
<g id="a_node130"><a xlink:title="Run ``tg_client.py &#45;&#45;fetch`` and return combined logs.">
<polygon fill="none" stroke="black" points="9449,-1197.3 8997,-1197.3 8997,-1153.3 9449,-1153.3 9449,-1197.3"/>
<text text-anchor="middle" x="9223" y="-1166.98" font-family="Times,serif" font-size="32.90">debug_dump.run_tg_fetch</text>
</a>
</g>
</g>
<!-- debug_dump.run_tg_fetch&#45;&gt;notes_utils.read_text -->
<g id="edge200" class="edge">
<title>debug_dump.run_tg_fetch&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M9338.35,-1197.32C9434.96,-1215.91 9572.15,-1242.32 9665.65,-1260.32"/>
<polygon fill="black" stroke="black" points="9665.22,-1263.8 9675.7,-1262.25 9666.54,-1256.92 9665.22,-1263.8"/>
</g>
<!-- debug_dump.collect_files -->
<g id="node131" class="node">
<title>debug_dump.collect_files</title>
<g id="a_node131"><a xlink:title="Return ``[(name, content), ...]`` for files related to ``lot_id``.">
<polygon fill="none" stroke="black" points="7556,-2027.8 7062,-2027.8 7062,-1978.8 7556,-1978.8 7556,-2027.8"/>
<text text-anchor="middle" x="7309" y="-1994.12" font-family="Times,serif" font-size="37.10">debug_dump.collect_files</text>
</a>
</g>
</g>
<!-- debug_dump.collect_files&#45;&gt;notes_utils.read_text -->
<g id="edge205" class="edge">
<title>debug_dump.collect_files&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M7556.13,-2011.48C8115.34,-2029.03 9439.33,-2064.36 9518,-2008.3 9758.03,-1837.28 9771.17,-1421.1 9770.19,-1308.69"/>
<polygon fill="black" stroke="black" points="9773.68,-1308.44 9770.05,-1298.49 9766.68,-1308.53 9773.68,-1308.44"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;notes_utils.load_json -->
<g id="edge206" class="edge">
<title>debug_dump.collect_files&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M7556.03,-2027.02C7628.22,-2023.29 7704.27,-2007.97 7766,-1969.3 7793,-1952.39 7774.89,-1924.05 7802,-1907.3 8008.45,-1779.72 8656.28,-1897.06 8892,-1839.3 8909.01,-1835.14 8911.45,-1829.02 8928,-1823.3 8992.08,-1801.18 9066.1,-1782.59 9123.84,-1769.57"/>
<polygon fill="black" stroke="black" points="9124.7,-1772.97 9133.69,-1767.37 9123.17,-1766.14 9124.7,-1772.97"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;lot_io.lot_json_path -->
<g id="edge207" class="edge">
<title>debug_dump.collect_files&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M7434.99,-2027.83C7534.4,-2039.99 7671.94,-2039.55 7766,-1969.3 7802.18,-1942.29 7770.48,-1906.63 7802,-1874.3 7928.63,-1744.44 8141.81,-1687.87 8260.21,-1665.44"/>
<polygon fill="black" stroke="black" points="8261.12,-1668.83 8270.31,-1663.56 8259.84,-1661.94 8261.12,-1668.83"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;caption_io.has_caption -->
<g id="edge202" class="edge">
<title>debug_dump.collect_files&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M7487.99,-2027.87C7587.25,-2051.59 7703.2,-2098.12 7766,-2189.3 7815.96,-2261.84 7743.2,-3708.73 7802,-3774.3 7915.98,-3901.42 8136.97,-3885.85 8259.29,-3865.07"/>
<polygon fill="black" stroke="black" points="8260.12,-3868.48 8269.37,-3863.31 8258.92,-3861.58 8260.12,-3868.48"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;caption_io.read_caption -->
<g id="edge203" class="edge">
<title>debug_dump.collect_files&#45;&gt;caption_io.read_caption</title>
<path fill="none" stroke="black" d="M7556,-1983.51C7628.09,-1988.11 7704.09,-2004 7766,-2042.3 7792.12,-2058.47 7775.61,-2085.59 7802,-2101.3 7862.39,-2137.27 8036.08,-2140.91 8171.12,-2137.64"/>
<polygon fill="black" stroke="black" points="8171.28,-2141.13 8181.18,-2137.38 8171.1,-2134.14 8171.28,-2141.13"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;post_io.raw_post_path -->
<g id="edge204" class="edge">
<title>debug_dump.collect_files&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7556.13,-1997.2C7646.67,-2000.43 7734.77,-2011.94 7766,-2042.3 7867.35,-2140.84 7699.35,-2261.12 7802,-2358.3 7865.84,-2418.75 8123.7,-2408.29 8260.22,-2398.03"/>
<polygon fill="black" stroke="black" points="8260.54,-2401.51 8270.24,-2397.26 8260,-2394.54 8260.54,-2401.51"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;caption_io.caption_json_path -->
<g id="edge201" class="edge">
<title>debug_dump.collect_files&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M7556.23,-1997.77C7646.47,-2001.13 7734.31,-2012.57 7766,-2042.3 7844.65,-2116.11 7721.83,-2210.15 7802,-2282.3 7898.89,-2369.5 8803.13,-2355 9116.05,-2347.27"/>
<polygon fill="black" stroke="black" points="9116.57,-2350.76 9126.48,-2347.01 9116.39,-2343.76 9116.57,-2350.76"/>
</g>
<!-- debug_dump.delete_files -->
<g id="node132" class="node">
<title>debug_dump.delete_files</title>
<g id="a_node132"><a xlink:title="Remove files related to ``lot_id`` from the filesystem.">
<polygon fill="none" stroke="black" points="7524.5,-1960.3 7093.5,-1960.3 7093.5,-1916.3 7524.5,-1916.3 7524.5,-1960.3"/>
<text text-anchor="middle" x="7309" y="-1929.98" font-family="Times,serif" font-size="32.90">debug_dump.delete_files</text>
</a>
</g>
</g>
<!-- debug_dump.delete_files&#45;&gt;notes_utils.load_json -->
<g id="edge211" class="edge">
<title>debug_dump.delete_files&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M7524.6,-1952.79C7603.25,-1950.7 7691.24,-1939.34 7766,-1907.3 7785.95,-1898.75 7782.14,-1883.05 7802,-1874.3 7831.3,-1861.4 8741.29,-1787.67 9088.86,-1759.89"/>
<polygon fill="black" stroke="black" points="9089.29,-1763.36 9098.98,-1759.08 9088.73,-1756.39 9089.29,-1763.36"/>
</g>
<!-- debug_dump.delete_files&#45;&gt;lot_io.lot_json_path -->
<g id="edge212" class="edge">
<title>debug_dump.delete_files&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M7524.73,-1946.09C7623.91,-1945.28 7728.03,-1936.76 7766,-1907.3 7806.31,-1876.03 7764.91,-1833.34 7802,-1798.3 7928.39,-1678.89 8141.66,-1654.93 8260.14,-1651.43"/>
<polygon fill="black" stroke="black" points="8260.35,-1654.92 8270.25,-1651.17 8260.17,-1647.92 8260.35,-1654.92"/>
</g>
<!-- debug_dump.delete_files&#45;&gt;post_io.raw_post_path -->
<g id="edge210" class="edge">
<title>debug_dump.delete_files&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7524.79,-1927.25C7625.57,-1927.02 7731.12,-1935.6 7766,-1969.3 7822.39,-2023.79 7747.28,-2264.15 7802,-2320.3 7920.94,-2442.35 8139.45,-2427.96 8260.18,-2408.26"/>
<polygon fill="black" stroke="black" points="8260.85,-2411.69 8270.13,-2406.58 8259.69,-2404.79 8260.85,-2411.69"/>
</g>
<!-- debug_dump.delete_files&#45;&gt;caption_io.caption_json_path -->
<g id="edge208" class="edge">
<title>debug_dump.delete_files&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M7524.72,-1927.65C7625.29,-1927.55 7730.69,-1936.13 7766,-1969.3 7855.83,-2053.71 7711.17,-2160.98 7802,-2244.3 7846.67,-2285.28 8831.69,-2286.24 8892,-2292.3 8967.32,-2299.87 9051.61,-2313.24 9116.16,-2324.53"/>
<polygon fill="black" stroke="black" points="9115.89,-2328.03 9126.34,-2326.32 9117.1,-2321.14 9115.89,-2328.03"/>
</g>
<!-- debug_dump.delete_files&#45;&gt;caption_io.caption_md_path -->
<g id="edge209" class="edge">
<title>debug_dump.delete_files&#45;&gt;caption_io.caption_md_path</title>
<path fill="none" stroke="black" d="M7524.62,-1927.43C7625.35,-1927.24 7730.91,-1935.82 7766,-1969.3 7867.3,-2065.98 7701.01,-2185.31 7802,-2282.3 7977.18,-2450.55 8696,-2219.85 8892,-2363.3 9168.16,-2565.43 9213.54,-3037.14 9220.71,-3157.8"/>
<polygon fill="black" stroke="black" points="9217.23,-3158.26 9221.27,-3168.05 9224.22,-3157.87 9217.23,-3158.26"/>
</g>
<!-- debug_dump._message_reason -->
<g id="node133" class="node">
<title>debug_dump._message_reason</title>
<g id="a_node133"><a xlink:title="Return explanation why a message would be skipped.">
<polygon fill="none" stroke="black" points="9495.5,-1999.8 8950.5,-1999.8 8950.5,-1954.8 9495.5,-1954.8 9495.5,-1999.8"/>
<text text-anchor="middle" x="9223" y="-1968.92" font-family="Times,serif" font-size="33.60">debug_dump._message_reason</text>
</a>
</g>
</g>
<!-- debug_dump._message_reason&#45;&gt;moderation.should_skip_user -->
<g id="edge213" class="edge">
<title>debug_dump._message_reason&#45;&gt;moderation.should_skip_user</title>
<path fill="none" stroke="black" d="M9449.51,-1999.84C9475.46,-2010.89 9499.28,-2026.21 9518,-2047.3 9668.85,-2217.29 9756.57,-3960.14 9768.18,-4204.82"/>
<polygon fill="black" stroke="black" points="9764.69,-4205.21 9768.66,-4215.03 9771.68,-4204.88 9764.69,-4205.21"/>
</g>
<!-- debug_dump._lot_reason -->
<g id="node134" class="node">
<title>debug_dump._lot_reason</title>
<g id="a_node134"><a xlink:title="Return explanation why ``lot`` would be skipped.">
<polygon fill="none" stroke="black" points="9377,-1624.3 9069,-1624.3 9069,-1588.3 9377,-1588.3 9377,-1624.3"/>
<text text-anchor="middle" x="9223" y="-1600.71" font-family="Times,serif" font-size="23.24">debug_dump._lot_reason</text>
</a>
</g>
</g>
<!-- debug_dump.moderation_summary -->
<g id="node135" class="node">
<title>debug_dump.moderation_summary</title>
<g id="a_node135"><a xlink:title="Return a multi&#45;line summary of moderation checks for ``lot_id``.">
<polygon fill="none" stroke="black" points="7755.5,-1660.3 6862.5,-1660.3 6862.5,-1598.3 7755.5,-1598.3 7755.5,-1660.3"/>
<text text-anchor="middle" x="7309" y="-1617.1" font-family="Times,serif" font-size="49.00">debug_dump.moderation_summary</text>
</a>
</g>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;notes_utils.load_json -->
<g id="edge218" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M7711.23,-1660.34C7729.78,-1663.08 7748.11,-1666.06 7766,-1669.3 7782.34,-1672.26 7785.61,-1676.66 7802,-1679.3 8047.23,-1718.9 8784.64,-1739.51 9088.7,-1746.5"/>
<polygon fill="black" stroke="black" points="9088.81,-1750.01 9098.89,-1746.74 9088.97,-1743.01 9088.81,-1750.01"/>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;lot_io.lot_json_path -->
<g id="edge219" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M7755.75,-1639.2C7945.54,-1643.41 8148.53,-1647.92 8260.1,-1650.4"/>
<polygon fill="black" stroke="black" points="8260.2,-1653.9 8270.28,-1650.62 8260.36,-1646.9 8260.2,-1653.9"/>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;post_io.read_post -->
<g id="edge214" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7447.33,-1598.29C7550.25,-1583.95 7686.51,-1585.46 7766,-1669.3 7846.47,-1754.18 7737.58,-2623.69 7802,-2721.3 7877.66,-2835.94 8019.42,-2900.12 8139.26,-2935.41"/>
<polygon fill="black" stroke="black" points="8138.37,-2938.79 8148.95,-2938.21 8140.32,-2932.07 8138.37,-2938.79"/>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;post_io.raw_post_path -->
<g id="edge215" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7452.17,-1598.27C7553.99,-1585.15 7686.64,-1588.24 7766,-1669.3 7850.45,-1755.56 7728.03,-2115.92 7802,-2211.3 7911.79,-2352.87 8136.52,-2383.83 8260.01,-2389.75"/>
<polygon fill="black" stroke="black" points="8260.04,-2393.26 8270.18,-2390.2 8260.34,-2386.27 8260.04,-2393.26"/>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;debug_dump._message_reason -->
<g id="edge216" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;debug_dump._message_reason</title>
<path fill="none" stroke="black" d="M7461.41,-1598.28C7561.13,-1587.32 7687.32,-1593.04 7766,-1669.3 7863.06,-1763.39 7701.11,-1881.34 7802,-1971.3 7843.7,-2008.49 8538.5,-1996.01 8940.46,-1985.57"/>
<polygon fill="black" stroke="black" points="8940.59,-1989.07 8950.49,-1985.31 8940.4,-1982.07 8940.59,-1989.07"/>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;debug_dump._lot_reason -->
<g id="edge217" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;debug_dump._lot_reason</title>
<path fill="none" stroke="black" d="M7755.56,-1623.94C8172.55,-1618.93 8772.85,-1611.71 9058.71,-1608.27"/>
<polygon fill="black" stroke="black" points="9058.79,-1611.77 9068.74,-1608.15 9058.7,-1604.77 9058.79,-1611.77"/>
</g>
<!-- debug_dump.main -->
<g id="node136" class="node">
<title>debug_dump.main</title>
<g id="a_node136"><a xlink:title="Collect log and data files related to a single lot.">
<polygon fill="none" stroke="black" points="6553,-1584.3 6077,-1584.3 6077,-1522.3 6553,-1522.3 6553,-1584.3"/>
<text text-anchor="middle" x="6315" y="-1541.1" font-family="Times,serif" font-size="49.00">debug_dump.main</text>
</a>
</g>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.parse_url -->
<g id="edge220" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.parse_url</title>
<path fill="none" stroke="black" d="M6452.42,-1522.27C6564.8,-1505.44 6720.65,-1503.55 6816,-1593.3 6899.34,-1671.76 6768.28,-1770.26 6852,-1848.3 6894.12,-1887.57 7035.02,-1892.6 7149.18,-1889.59"/>
<polygon fill="black" stroke="black" points="7149.54,-1893.08 7159.44,-1889.3 7149.34,-1886.09 7149.54,-1893.08"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.guess_source_from_lot -->
<g id="edge221" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.guess_source_from_lot</title>
<path fill="none" stroke="black" d="M6553.34,-1547.81C6946.32,-1538.71 7727.26,-1520.63 8115.62,-1511.64"/>
<polygon fill="black" stroke="black" points="8115.94,-1515.13 8125.85,-1511.4 8115.77,-1508.13 8115.94,-1515.13"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.load_source_info -->
<g id="edge222" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.load_source_info</title>
<path fill="none" stroke="black" d="M6451.49,-1522.27C6562.35,-1490.59 6716.53,-1431.26 6816,-1329.3 6844.93,-1299.64 6818.28,-1267.38 6852,-1243.3 6884.61,-1220.02 6962.49,-1210.44 7044.84,-1207.38"/>
<polygon fill="black" stroke="black" points="7045.02,-1210.87 7054.9,-1207.03 7044.78,-1203.87 7045.02,-1210.87"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.run_tg_fetch -->
<g id="edge223" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.run_tg_fetch</title>
<path fill="none" stroke="black" d="M6478.05,-1522.28C6590.12,-1492.19 6733.41,-1434.97 6816,-1329.3 6871.89,-1257.8 6782.4,-1186.55 6852,-1128.3 7025.83,-982.84 8665.9,-1112.28 8892,-1128.3 8956.39,-1132.87 9027.32,-1142.38 9086.87,-1151.66"/>
<polygon fill="black" stroke="black" points="9086.66,-1155.17 9097.08,-1153.26 9087.75,-1148.25 9086.66,-1155.17"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.collect_files -->
<g id="edge224" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.collect_files</title>
<path fill="none" stroke="black" d="M6446.75,-1522.26C6560.22,-1503.82 6720.82,-1499.6 6816,-1593.3 6875.81,-1652.19 6792.03,-1910.58 6852,-1969.3 6881.94,-1998.62 6964.71,-2009.54 7051.67,-2012.25"/>
<polygon fill="black" stroke="black" points="7051.64,-2015.75 7061.73,-2012.53 7051.84,-2008.75 7051.64,-2015.75"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.delete_files -->
<g id="edge225" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.delete_files</title>
<path fill="none" stroke="black" d="M6448.82,-1522.29C6561.87,-1504.48 6720.65,-1501.18 6816,-1593.3 6917.02,-1690.91 6750.4,-1810.3 6852,-1907.3 6885.92,-1939.69 6985.71,-1948.78 7083.33,-1949.18"/>
<polygon fill="black" stroke="black" points="7083.37,-1952.68 7093.37,-1949.19 7083.38,-1945.68 7083.37,-1952.68"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.moderation_summary -->
<g id="edge226" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.moderation_summary</title>
<path fill="none" stroke="black" d="M6553.29,-1571.48C6655.07,-1579.28 6777.03,-1588.63 6892.94,-1597.51"/>
<polygon fill="black" stroke="black" points="6892.82,-1601.01 6903.05,-1598.28 6893.35,-1594.03 6892.82,-1601.01"/>
</g>
<!-- scan_ontology.collect_ontology -->
<g id="node137" class="node">
<title>scan_ontology.collect_ontology</title>
<g id="a_node137"><a xlink:title="Return counts per field, value counters, misparsed lots and broken metadata.">
<polygon fill="none" stroke="black" points="6773,-3035.8 5857,-3035.8 5857,-2964.8 6773,-2964.8 6773,-3035.8"/>
<text text-anchor="middle" x="6315" y="-2985.66" font-family="Times,serif" font-size="57.68">scan_ontology.collect_ontology</text>
</a>
</g>
</g>
<!-- scan_ontology.collect_ontology&#45;&gt;lot_io.read_lots -->
<g id="edge231" class="edge">
<title>scan_ontology.collect_ontology&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M6426.12,-3035.89C6544.03,-3080.25 6726.26,-3168.18 6816,-3311.3 6856.25,-3375.49 6796.01,-3599.27 6852,-3650.3 6902.68,-3696.5 7889.24,-3680.02 8230.79,-3672.89"/>
<polygon fill="black" stroke="black" points="8231.03,-3676.39 8240.96,-3672.68 8230.88,-3669.39 8231.03,-3676.39"/>
</g>
<!-- scan_ontology.collect_ontology&#45;&gt;post_io.read_post -->
<g id="edge228" class="edge">
<title>scan_ontology.collect_ontology&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M6773.25,-3001.21C6799.89,-3001.25 6826.29,-3001.28 6852,-3001.3 7258.22,-3001.68 7359.87,-3010.05 7766,-3001.3 7860.91,-2999.26 7964.5,-2995.34 8057.53,-2991.19"/>
<polygon fill="black" stroke="black" points="8057.83,-2994.68 8067.66,-2990.74 8057.51,-2987.69 8057.83,-2994.68"/>
</g>
<!-- scan_ontology.collect_ontology&#45;&gt;moderation.is_misparsed -->
<g id="edge227" class="edge">
<title>scan_ontology.collect_ontology&#45;&gt;moderation.is_misparsed</title>
<path fill="none" stroke="black" d="M6659.34,-2964.78C6723.35,-2958.6 6789.68,-2952.5 6852,-2947.3 6926.3,-2941.11 7007.48,-2935.28 7080.49,-2930.39"/>
<polygon fill="black" stroke="black" points="7080.99,-2933.87 7090.73,-2929.71 7080.52,-2926.88 7080.99,-2933.87"/>
</g>
<!-- scan_ontology.collect_ontology&#45;&gt;post_io.raw_post_path -->
<g id="edge229" class="edge">
<title>scan_ontology.collect_ontology&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M6764.4,-2964.76C6782.29,-2957.11 6799.58,-2948.34 6816,-2938.3 6840.29,-2923.45 6827.41,-2899.66 6852,-2885.3 7028,-2782.53 7610.48,-2941.03 7766,-2809.3 7815.68,-2767.22 7761.36,-2718.17 7802,-2667.3 7920.55,-2518.91 8139.71,-2442.53 8260.53,-2410.07"/>
<polygon fill="black" stroke="black" points="8261.71,-2413.37 8270.48,-2407.43 8259.91,-2406.61 8261.71,-2413.37"/>
</g>
<!-- scan_ontology.collect_ontology&#45;&gt;message_utils.gather_chop_input -->
<g id="edge230" class="edge">
<title>scan_ontology.collect_ontology&#45;&gt;message_utils.gather_chop_input</title>
<path fill="none" stroke="black" d="M6773.16,-2988.32C6882.04,-2985.47 6993.42,-2982.55 7086.16,-2980.12"/>
<polygon fill="black" stroke="black" points="7086.32,-2983.62 7096.22,-2979.85 7086.14,-2976.62 7086.32,-2983.62"/>
</g>
<!-- scan_ontology.main -->
<g id="node138" class="node">
<title>scan_ontology.main</title>
<polygon fill="none" stroke="black" points="5730,-4199.8 5275,-4199.8 5275,-4142.8 5730,-4142.8 5730,-4199.8"/>
<text text-anchor="middle" x="5502.5" y="-4160.41" font-family="Times,serif" font-size="44.24">scan_ontology.main</text>
</g>
<!-- scan_ontology.main&#45;&gt;notes_utils.write_json -->
<g id="edge233" class="edge">
<title>scan_ontology.main&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M5583.93,-4199.82C5647.32,-4226.68 5732.38,-4273.35 5778,-4343.3 5838.6,-4436.23 5737.29,-4510.17 5814,-4590.3 6127.5,-4917.79 6467.25,-4491.65 6816,-4781.3 6849.78,-4809.36 6815.97,-4848.21 6852,-4873.3 6922.31,-4922.27 8839.58,-4909.42 8892,-4891.3 9028.8,-4844.03 9152.07,-4714.08 9200.38,-4658.3"/>
<polygon fill="black" stroke="black" points="9203.11,-4660.49 9206.96,-4650.62 9197.79,-4655.94 9203.11,-4660.49"/>
</g>
<!-- scan_ontology.main&#45;&gt;scan_ontology.collect_ontology -->
<g id="edge232" class="edge">
<title>scan_ontology.main&#45;&gt;scan_ontology.collect_ontology</title>
<path fill="none" stroke="black" d="M5596.11,-4142.74C5658.97,-4118.11 5737.72,-4075.81 5778,-4009.3 5858.46,-3876.45 5735.09,-3445.08 5814,-3311.3 5897,-3170.6 6071.2,-3084.38 6190.4,-3039.44"/>
<polygon fill="black" stroke="black" points="6191.81,-3042.65 6199.96,-3035.88 6189.37,-3036.09 6191.81,-3042.65"/>
</g>
<!-- log_utils.install_excepthook -->
<g id="node139" class="node">
<title>log_utils.install_excepthook</title>
<g id="a_node139"><a xlink:title="Redirect uncaught exceptions to ``logger.exception``.">
<polygon fill="none" stroke="black" points="6501.5,-4200.3 6128.5,-4200.3 6128.5,-4164.3 6501.5,-4164.3 6501.5,-4200.3"/>
<text text-anchor="middle" x="6315" y="-4176.14" font-family="Times,serif" font-size="25.20">log_utils.install_excepthook</text>
</a>
</g>
</g>
<!-- scan_ontology.main&#45;&gt;log_utils.install_excepthook -->
<g id="edge234" class="edge">
<title>scan_ontology.main&#45;&gt;log_utils.install_excepthook</title>
<path fill="none" stroke="black" d="M5730.08,-4174.38C5852.15,-4176.04 6001.27,-4178.06 6118.25,-4179.65"/>
<polygon fill="black" stroke="black" points="6118.35,-4183.15 6128.4,-4179.79 6118.45,-4176.15 6118.35,-4183.15"/>
</g>
<!-- log_utils._extract_tb_lineno -->
<g id="node142" class="node">
<title>log_utils._extract_tb_lineno</title>
<g id="a_node142"><a xlink:title="Return the last line number from a traceback.">
<polygon fill="none" stroke="black" points="7424.5,-4160.3 7193.5,-4160.3 7193.5,-4124.3 7424.5,-4124.3 7424.5,-4160.3"/>
<text text-anchor="middle" x="7309" y="-4138.26" font-family="Times,serif" font-size="15.68">log_utils._extract_tb_lineno</text>
</a>
</g>
</g>
<!-- log_utils.install_excepthook&#45;&gt;log_utils._extract_tb_lineno -->
<g id="edge245" class="edge">
<title>log_utils.install_excepthook&#45;&gt;log_utils._extract_tb_lineno</title>
<path fill="none" stroke="black" d="M6501.71,-4174.82C6700.79,-4166.79 7011.33,-4154.27 7183.12,-4147.34"/>
<polygon fill="black" stroke="black" points="7183.37,-4150.83 7193.22,-4146.93 7183.09,-4143.84 7183.37,-4150.83"/>
</g>
<!-- testing_mode.apply_testing_mode -->
<g id="node140" class="node">
<title>testing_mode.apply_testing_mode</title>
<g id="a_node140"><a xlink:title="Tweak environment variables when ``TEST_MODE`` is set.">
<polygon fill="none" stroke="black" points="282,-4638.3 0,-4638.3 0,-4602.3 282,-4602.3 282,-4638.3"/>
<text text-anchor="middle" x="141" y="-4616.26" font-family="Times,serif" font-size="15.68">testing_mode.apply_testing_mode</text>
</a>
</g>
</g>
<!-- telegram_bot:cli -->
<g id="node141" class="node">
<title>telegram_bot:cli</title>
<g id="a_node141"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="650.5" cy="-4620.3" rx="111.95" ry="19.18"/>
<text text-anchor="middle" x="650.5" y="-4616.14" font-family="Times,serif" font-size="17.08">telegram_bot:cli</text>
</a>
</g>
</g>
<!-- testing_mode.apply_testing_mode&#45;&gt;telegram_bot:cli -->
<!-- embed:cli -->
<g id="node168" class="node">
<title>embed:cli</title>
<g id="a_node168"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="1375.5" cy="-4620.3" rx="29.05" ry="18"/>
<text text-anchor="middle" x="1375.5" y="-4618.7" font-family="Times,serif" font-size="7.00">embed:cli</text>
</a>
</g>
</g>
<!-- telegram_bot:cli&#45;&gt;embed:cli -->
<!-- log_utils._add_exc_line -->
<g id="node143" class="node">
<title>log_utils._add_exc_line</title>
<g id="a_node143"><a xlink:title="Attach ``line`` from traceback to structured log events.">
<polygon fill="none" stroke="black" points="6456.5,-4108.3 6173.5,-4108.3 6173.5,-4072.3 6456.5,-4072.3 6456.5,-4108.3"/>
<text text-anchor="middle" x="6315" y="-4084.71" font-family="Times,serif" font-size="23.24">log_utils._add_exc_line</text>
</a>
</g>
</g>
<!-- log_utils._add_exc_line&#45;&gt;log_utils._extract_tb_lineno -->
<g id="edge241" class="edge">
<title>log_utils._add_exc_line&#45;&gt;log_utils._extract_tb_lineno</title>
<path fill="none" stroke="black" d="M6456.55,-4097.67C6650.74,-4107.85 6998.07,-4126.06 7183.42,-4135.77"/>
<polygon fill="black" stroke="black" points="7183.31,-4139.27 7193.48,-4136.3 7183.68,-4132.28 7183.31,-4139.27"/>
</g>
<!-- log_utils.init_logger -->
<g id="node144" class="node">
<title>log_utils.init_logger</title>
<g id="a_node144"><a xlink:title="Initialize logger writing to ``LOGFILE``.&#10;&#10;``LOG_LEVEL`` may be set in ``config.py`` or via an environment&#10;variable. &#160;The level accepts ``DEBUG``, ``INFO`` or ``ERROR`` and&#10;defaults to ``INFO``. &#160;The function falls back to the standard&#10;``logging`` module if ``structlog`` isn&#39;t available so the scripts&#10;can still run in minimal environments.">
<polygon fill="none" stroke="black" points="6662.5,-3456.3 5967.5,-3456.3 5967.5,-3374.3 6662.5,-3374.3 6662.5,-3456.3"/>
<text text-anchor="middle" x="6315" y="-3398.32" font-family="Times,serif" font-size="67.48">log_utils.init_logger</text>
</a>
</g>
</g>
<!-- log_utils.init_logger&#45;&gt;log_utils._extract_tb_lineno -->
<g id="edge242" class="edge">
<title>log_utils.init_logger&#45;&gt;log_utils._extract_tb_lineno</title>
<path fill="none" stroke="black" d="M6662.52,-3425.1C6721,-3442.25 6775.71,-3470.66 6816,-3516.3 6886.79,-3596.5 6785.75,-3912.32 6852,-3996.3 6930.55,-4095.88 7077.45,-4128.62 7183.32,-4138.83"/>
<polygon fill="black" stroke="black" points="7183.16,-4142.33 7193.44,-4139.75 7183.79,-4135.36 7183.16,-4142.33"/>
</g>
<!-- log_utils.get_logger -->
<g id="node145" class="node">
<title>log_utils.get_logger</title>
<g id="a_node145"><a xlink:title="Return the singleton logger instance.">
<polygon fill="none" stroke="black" points="7377.5,-3326.3 7240.5,-3326.3 7240.5,-3290.3 7377.5,-3290.3 7377.5,-3326.3"/>
<text text-anchor="middle" x="7309" y="-3305.06" font-family="Times,serif" font-size="12.18">log_utils.get_logger</text>
</a>
</g>
</g>
<!-- log_utils.init_logger&#45;&gt;log_utils.get_logger -->
<g id="edge243" class="edge">
<title>log_utils.init_logger&#45;&gt;log_utils.get_logger</title>
<path fill="none" stroke="black" d="M6662.78,-3394.8C6715.12,-3386.37 6767.71,-3374.11 6816,-3356.3 6834.28,-3349.56 6833.63,-3337.77 6852,-3331.3 6978.81,-3286.66 7137.46,-3287.09 7230.29,-3295.09"/>
<polygon fill="black" stroke="black" points="7230.17,-3298.6 7240.45,-3296.02 7230.81,-3291.63 7230.17,-3298.6"/>
</g>
<!-- log_utils.get_logger&#45;&gt;log_utils.init_logger -->
<g id="edge244" class="edge">
<title>log_utils.get_logger&#45;&gt;log_utils.init_logger</title>
<path fill="none" stroke="black" d="M7240.45,-3308.2C7149.4,-3305.18 6983.56,-3302.98 6852,-3349.3 6833.63,-3355.77 6834.28,-3367.56 6816,-3374.3 6770.82,-3390.97 6721.88,-3402.77 6672.9,-3410.94"/>
<polygon fill="black" stroke="black" points="6672.09,-3407.53 6662.78,-3412.58 6673.21,-3414.44 6672.09,-3407.53"/>
</g>
<!-- caption._identify_size -->
<g id="node146" class="node">
<title>caption._identify_size</title>
<g id="a_node146"><a xlink:title="Return ``(width, height)`` for ``path`` using ImageMagick.">
<polygon fill="none" stroke="black" points="9351.5,-1936.3 9094.5,-1936.3 9094.5,-1900.3 9351.5,-1900.3 9351.5,-1936.3"/>
<text text-anchor="middle" x="9223" y="-1912.61" font-family="Times,serif" font-size="22.12">caption._identify_size</text>
</a>
</g>
</g>
<!-- caption._prepare_image -->
<g id="node147" class="node">
<title>caption._prepare_image</title>
<g id="a_node147"><a xlink:title="Resize ``path`` and return the processed JPEG bytes.">
<polygon fill="none" stroke="black" points="8564,-1962.3 8130,-1962.3 8130,-1916.3 8564,-1916.3 8564,-1962.3"/>
<text text-anchor="middle" x="8347" y="-1930.86" font-family="Times,serif" font-size="34.30">caption._prepare_image</text>
</a>
</g>
</g>
<!-- caption._prepare_image&#45;&gt;caption._identify_size -->
<g id="edge246" class="edge">
<title>caption._prepare_image&#45;&gt;caption._identify_size</title>
<path fill="none" stroke="black" d="M8564.04,-1934.11C8726.54,-1930.21 8944.35,-1924.98 9083.96,-1921.62"/>
<polygon fill="black" stroke="black" points="9084.38,-1925.11 9094.3,-1921.37 9084.21,-1918.11 9084.38,-1925.11"/>
</g>
<!-- caption._guess_chat -->
<g id="node148" class="node">
<title>caption._guess_chat</title>
<g id="a_node148"><a xlink:title="Return chat name for ``path`` relative to ``MEDIA_DIR``.">
<polygon fill="none" stroke="black" points="9319,-1868.3 9127,-1868.3 9127,-1832.3 9319,-1832.3 9319,-1868.3"/>
<text text-anchor="middle" x="9223" y="-1846.14" font-family="Times,serif" font-size="17.08">caption._guess_chat</text>
</a>
</g>
</g>
<!-- caption.caption_file -->
<g id="node149" class="node">
<title>caption.caption_file</title>
<g id="a_node149"><a xlink:title="Caption ``path`` with GPT&#45;4o and save ``.caption.json`` beside it.">
<polygon fill="none" stroke="black" points="7612,-1805.8 7006,-1805.8 7006,-1732.8 7612,-1732.8 7612,-1805.8"/>
<text text-anchor="middle" x="7309" y="-1754.32" font-family="Times,serif" font-size="59.36">caption.caption_file</text>
</a>
</g>
</g>
<!-- caption.caption_file&#45;&gt;notes_utils.load_json -->
<g id="edge250" class="edge">
<title>caption.caption_file&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M7612.17,-1766.14C8034.81,-1761.72 8784.76,-1753.88 9088.61,-1750.7"/>
<polygon fill="black" stroke="black" points="9088.83,-1754.2 9098.79,-1750.59 9088.75,-1747.2 9088.83,-1754.2"/>
</g>
<!-- caption.caption_file&#45;&gt;caption_io.has_caption -->
<g id="edge248" class="edge">
<title>caption.caption_file&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M7612.05,-1766.65C7671.07,-1780.74 7726.74,-1807.04 7766,-1853.3 7835.06,-1934.69 7730.9,-3694.69 7802,-3774.3 7915.73,-3901.65 8136.82,-3885.98 8259.22,-3865.13"/>
<polygon fill="black" stroke="black" points="8260.06,-3868.53 8269.31,-3863.36 8258.85,-3861.64 8260.06,-3868.53"/>
</g>
<!-- caption.caption_file&#45;&gt;caption_io.caption_json_path -->
<g id="edge247" class="edge">
<title>caption.caption_file&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M7612.02,-1746.32C7669.77,-1756.42 7724.94,-1778.43 7766,-1820.3 7827.09,-1882.6 7738.43,-2151.53 7802,-2211.3 7846.14,-2252.8 8837.8,-2217.24 8892,-2244.3 8914.91,-2255.75 8906.04,-2276.13 8928,-2289.3 8984.51,-2323.21 9057.24,-2337.02 9116.22,-2342.32"/>
<polygon fill="black" stroke="black" points="9116.06,-2345.82 9126.32,-2343.16 9116.64,-2338.84 9116.06,-2345.82"/>
</g>
<!-- caption.caption_file&#45;&gt;caption_io.write_caption -->
<g id="edge249" class="edge">
<title>caption.caption_file&#45;&gt;caption_io.write_caption</title>
<path fill="none" stroke="black" d="M7612.12,-1750.13C7668.92,-1760.26 7723.67,-1781.31 7766,-1820.3 7827.28,-1876.77 7741.19,-1947.34 7802,-2004.3 7854.08,-2053.09 8031.63,-2068.74 8169.89,-2073.34"/>
<polygon fill="black" stroke="black" points="8170.09,-2076.85 8180.2,-2073.67 8170.31,-2069.85 8170.09,-2076.85"/>
</g>
<!-- caption.caption_file&#45;&gt;caption._prepare_image -->
<g id="edge251" class="edge">
<title>caption.caption_file&#45;&gt;caption._prepare_image</title>
<path fill="none" stroke="black" d="M7612.28,-1770C7665.74,-1779.21 7719.2,-1794.85 7766,-1820.3 7788.2,-1832.38 7779.96,-1851.95 7802,-1864.3 7897.57,-1917.89 8016.96,-1938.48 8119.53,-1944.9"/>
<polygon fill="black" stroke="black" points="8119.53,-1948.4 8129.72,-1945.49 8119.94,-1941.42 8119.53,-1948.4"/>
</g>
<!-- caption.caption_file&#45;&gt;caption._guess_chat -->
<g id="edge252" class="edge">
<title>caption.caption_file&#45;&gt;caption._guess_chat</title>
<path fill="none" stroke="black" d="M7612.17,-1782.11C8048.3,-1800.58 8832.95,-1833.82 9116.31,-1845.83"/>
<polygon fill="black" stroke="black" points="9116.45,-1849.34 9126.59,-1846.26 9116.74,-1842.34 9116.45,-1849.34"/>
</g>
<!-- caption.main -->
<g id="node150" class="node">
<title>caption.main</title>
<g id="a_node150"><a xlink:title="Caption a single image provided on the command line.">
<polygon fill="none" stroke="black" points="6407.5,-1860.3 6222.5,-1860.3 6222.5,-1824.3 6407.5,-1824.3 6407.5,-1860.3"/>
<text text-anchor="middle" x="6315" y="-1836.14" font-family="Times,serif" font-size="25.20">caption.main</text>
</a>
</g>
</g>
<!-- caption.main&#45;&gt;caption.caption_file -->
<g id="edge253" class="edge">
<title>caption.main&#45;&gt;caption.caption_file</title>
<path fill="none" stroke="black" d="M6407.73,-1836.96C6508.04,-1831 6673.52,-1820.8 6816,-1810.3 6874.08,-1806.03 6935.99,-1801.13 6995.6,-1796.25"/>
<polygon fill="black" stroke="black" points="6996.24,-1799.71 7005.92,-1795.4 6995.67,-1792.73 6996.24,-1799.71"/>
</g>
<!-- price_utils.train_price_regression&#45;&gt;price_utils.canonical_currency -->
<g id="edge254" class="edge">
<title>price_utils.train_price_regression&#45;&gt;price_utils.canonical_currency</title>
<path fill="none" stroke="black" d="M8631.85,-251.75C8715.97,-238.63 8808.03,-222.58 8892,-204.3 8984.18,-184.24 9088.81,-153.72 9155.08,-133.41"/>
<polygon fill="black" stroke="black" points="9156.45,-136.65 9164.97,-130.36 9154.39,-129.96 9156.45,-136.65"/>
</g>
<!-- price_utils.guess_currency -->
<g id="node154" class="node">
<title>price_utils.guess_currency</title>
<g id="a_node154"><a xlink:title="Return currency with multiplier closest to ``price/pred_usd``.&#10;&#10;``pred_usd`` is the predicted price in USD. &#160;``price`` is the numeric value&#10;provided by the user without a currency. &#160;The function compares the implied&#10;multiplier ``price / pred_usd`` against the learnt exchange rates and picks&#10;the closest match. &#160;``counts`` may be provided to ignore rarely seen&#10;currencies when guessing. &#160;Any currency with fewer than ``min_samples``&#10;samples in the training set is skipped.">
<polygon fill="none" stroke="black" points="8614.5,-494.3 8079.5,-494.3 8079.5,-444.3 8614.5,-444.3 8614.5,-494.3"/>
<text text-anchor="middle" x="8347" y="-459.62" font-family="Times,serif" font-size="38.36">price_utils.guess_currency</text>
</a>
</g>
</g>
<!-- price_utils._guess_currency_verified&#45;&gt;price_utils.guess_currency -->
<g id="edge255" class="edge">
<title>price_utils._guess_currency_verified&#45;&gt;price_utils.guess_currency</title>
<path fill="none" stroke="black" d="M7565.76,-464.79C7718.49,-465.67 7912.54,-466.79 8068.91,-467.7"/>
<polygon fill="black" stroke="black" points="8069.13,-471.2 8079.15,-467.76 8069.17,-464.2 8069.13,-471.2"/>
</g>
<!-- lot_io.get_timestamp -->
<g id="node157" class="node">
<title>lot_io.get_timestamp</title>
<g id="a_node157"><a xlink:title="Return ``lot[&#39;timestamp&#39;]`` as a timezone&#45;aware ``datetime``.">
<polygon fill="none" stroke="black" points="8506,-4604.3 8188,-4604.3 8188,-4564.3 8506,-4564.3 8506,-4604.3"/>
<text text-anchor="middle" x="8347" y="-4577.23" font-family="Times,serif" font-size="28.84">lot_io.get_timestamp</text>
</a>
</g>
</g>
<!-- lot_io.write_lots -->
<g id="node158" class="node">
<title>lot_io.write_lots</title>
<g id="a_node158"><a xlink:title="Write lots to ``path`` using consistent JSON formatting.">
<polygon fill="none" stroke="black" points="7410.5,-4632.3 7207.5,-4632.3 7207.5,-4596.3 7410.5,-4596.3 7410.5,-4632.3"/>
<text text-anchor="middle" x="7309" y="-4608.71" font-family="Times,serif" font-size="23.24">lot_io.write_lots</text>
</a>
</g>
</g>
<!-- lot_io.write_lots&#45;&gt;notes_utils.write_json -->
<g id="edge262" class="edge">
<title>lot_io.write_lots&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M7410.78,-4615.25C7740.57,-4618.36 8785.53,-4628.2 9118.8,-4631.33"/>
<polygon fill="black" stroke="black" points="9118.9,-4634.83 9128.93,-4631.43 9118.96,-4627.83 9118.9,-4634.83"/>
</g>
<!-- lot_io.write_lots&#45;&gt;lot_io.get_seller -->
<g id="edge264" class="edge">
<title>lot_io.write_lots&#45;&gt;lot_io.get_seller</title>
<path fill="none" stroke="black" d="M7410.92,-4606.19C7518.89,-4591.54 7685.45,-4550.47 7766,-4435.3 7861.93,-4298.14 7708.39,-3068.06 7802,-2929.3 7899.92,-2784.15 8108.07,-2728.13 8236.62,-2706.89"/>
<polygon fill="black" stroke="black" points="8237.18,-2710.34 8246.5,-2705.3 8236.07,-2703.43 8237.18,-2710.34"/>
</g>
<!-- lot_io.write_lots&#45;&gt;lot_io._clean_lot -->
<g id="edge263" class="edge">
<title>lot_io.write_lots&#45;&gt;lot_io._clean_lot</title>
<path fill="none" stroke="black" d="M7410.51,-4615.02C7504.12,-4613.36 7646.74,-4604.86 7766,-4572.3 7783.07,-4567.64 7784.86,-4559.7 7802,-4555.3 7919.54,-4525.19 8802.98,-4571.75 8892,-4489.3 8934.96,-4449.52 8904.01,-4281.71 8928,-4228.3 8991.15,-4087.7 9130.18,-3960.57 9191.7,-3908.84"/>
<polygon fill="black" stroke="black" points="9194.06,-3911.42 9199.5,-3902.33 9189.58,-3906.05 9194.06,-3911.42"/>
</g>
<!-- lot_io.write_lots&#45;&gt;lot_io.get_timestamp -->
<g id="edge265" class="edge">
<title>lot_io.write_lots&#45;&gt;lot_io.get_timestamp</title>
<path fill="none" stroke="black" d="M7410.75,-4611.39C7588.69,-4606.23 7960.3,-4595.47 8177.71,-4589.18"/>
<polygon fill="black" stroke="black" points="8178.05,-4592.67 8187.94,-4588.88 8177.85,-4585.67 8178.05,-4592.67"/>
</g>
<!-- lot_io.embedding_path -->
<g id="node160" class="node">
<title>lot_io.embedding_path</title>
<g id="a_node160"><a xlink:title="Return embedding file path for ``lot_path``.">
<polygon fill="none" stroke="black" points="8453.5,-4230.3 8240.5,-4230.3 8240.5,-4194.3 8453.5,-4194.3 8453.5,-4230.3"/>
<text text-anchor="middle" x="8347" y="-4208.14" font-family="Times,serif" font-size="17.08">lot_io.embedding_path</text>
</a>
</g>
</g>
<!-- pending_chop.main -->
<g id="node161" class="node">
<title>pending_chop.main</title>
<polygon fill="none" stroke="black" points="7472.5,-4296.3 7145.5,-4296.3 7145.5,-4254.3 7472.5,-4254.3 7472.5,-4296.3"/>
<text text-anchor="middle" x="7309" y="-4267.22" font-family="Times,serif" font-size="31.36">pending_chop.main</text>
</g>
<!-- pending_chop.main&#45;&gt;moderation.should_skip_message -->
<g id="edge269" class="edge">
<title>pending_chop.main&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M7466.48,-4296.31C7559.6,-4301.13 7676.63,-4293.14 7766,-4240.3 7791.15,-4225.44 7776.65,-4199.83 7802,-4185.3 7862.73,-4150.5 8035.15,-4146.92 8169.77,-4150.09"/>
<polygon fill="black" stroke="black" points="8169.72,-4153.59 8179.8,-4150.34 8169.89,-4146.59 8169.72,-4153.59"/>
</g>
<!-- pending_chop.main&#45;&gt;post_io.read_post -->
<g id="edge270" class="edge">
<title>pending_chop.main&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7472.75,-4283.32C7573.34,-4278.69 7696.17,-4253.81 7766,-4169.3 7831.59,-4089.93 7745.86,-3329.62 7802,-3243.3 7880.68,-3122.34 8031.21,-3054.35 8154.02,-3017.3"/>
<polygon fill="black" stroke="black" points="8155.34,-3020.55 8163.93,-3014.35 8153.35,-3013.84 8155.34,-3020.55"/>
</g>
<!-- pending_caption._get_message_path -->
<g id="node162" class="node">
<title>pending_caption._get_message_path</title>
<g id="a_node162"><a xlink:title="Return path of stored message ``msg_id`` in ``chat`` if any.">
<polygon fill="none" stroke="black" points="8497.5,-1578.3 8196.5,-1578.3 8196.5,-1542.3 8497.5,-1542.3 8497.5,-1578.3"/>
<text text-anchor="middle" x="8347" y="-1556.26" font-family="Times,serif" font-size="15.68">pending_caption._get_message_path</text>
</a>
</g>
</g>
<!-- pending_caption.main -->
<g id="node163" class="node">
<title>pending_caption.main</title>
<polygon fill="none" stroke="black" points="6549,-2457.3 6081,-2457.3 6081,-2405.3 6549,-2405.3 6549,-2457.3"/>
<text text-anchor="middle" x="6315" y="-2421.16" font-family="Times,serif" font-size="40.18">pending_caption.main</text>
</g>
<!-- pending_caption.main&#45;&gt;image_io.read_image_meta -->
<g id="edge271" class="edge">
<title>pending_caption.main&#45;&gt;image_io.read_image_meta</title>
<path fill="none" stroke="black" d="M6549.19,-2429.75C6636.94,-2421.02 6735,-2401.01 6816,-2358.3 6836.87,-2347.3 6831.57,-2331.1 6852,-2319.3 6954.5,-2260.11 7088.2,-2234.93 7184.29,-2224.22"/>
<polygon fill="black" stroke="black" points="7184.78,-2227.69 7194.35,-2223.14 7184.03,-2220.73 7184.78,-2227.69"/>
</g>
<!-- pending_caption.main&#45;&gt;moderation.should_skip_message -->
<g id="edge272" class="edge">
<title>pending_caption.main&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M6549.14,-2442.43C6647.33,-2459.97 6753.19,-2498.48 6816,-2580.3 6902.43,-2692.9 6762.08,-3747.47 6852,-3857.3 7116.1,-4179.89 7431.42,-3819.58 7766,-4068.3 7791.88,-4087.54 7774.52,-4114.43 7802,-4131.3 7861.75,-4167.99 8034.81,-4171.23 8169.86,-4167.47"/>
<polygon fill="black" stroke="black" points="8170.03,-4170.97 8179.93,-4167.17 8169.83,-4163.97 8170.03,-4170.97"/>
</g>
<!-- pending_caption.main&#45;&gt;caption_io.has_caption -->
<g id="edge273" class="edge">
<title>pending_caption.main&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M6549.1,-2442.46C6647.28,-2460.01 6753.15,-2498.52 6816,-2580.3 6899.38,-2688.8 6754.96,-3714.83 6852,-3811.3 6951.77,-3910.5 7955.06,-3866.72 8259.12,-3851.04"/>
<polygon fill="black" stroke="black" points="8259.4,-3854.53 8269.21,-3850.52 8259.04,-3847.54 8259.4,-3854.53"/>
</g>
<!-- pending_caption.main&#45;&gt;post_io.read_post -->
<g id="edge274" class="edge">
<title>pending_caption.main&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M6549.09,-2426.64C6936.06,-2421.2 7677.55,-2421.4 7766,-2500.3 7840.26,-2566.55 7742.01,-2641.9 7802,-2721.3 7887.55,-2834.55 8035.84,-2899.45 8156,-2935.41"/>
<polygon fill="black" stroke="black" points="8155.12,-2938.79 8165.7,-2938.26 8157.1,-2932.08 8155.12,-2938.79"/>
</g>
<!-- pending_caption.main&#45;&gt;pending_caption._get_message_path -->
<g id="edge275" class="edge">
<title>pending_caption.main&#45;&gt;pending_caption._get_message_path</title>
<path fill="none" stroke="black" d="M6514.43,-2457.31C6619.49,-2459.17 6741.77,-2440.21 6816,-2358.3 6873.44,-2294.92 6790.69,-1648.96 6852,-1589.3 6899.17,-1543.41 7810.62,-1552.06 8186.27,-1557.61"/>
<polygon fill="black" stroke="black" points="8186.35,-1561.11 8196.4,-1557.76 8186.46,-1554.11 8186.35,-1561.11"/>
</g>
<!-- check_translations.parse_po -->
<g id="node164" class="node">
<title>check_translations.parse_po</title>
<polygon fill="none" stroke="black" points="1667.5,-4708.3 1083.5,-4708.3 1083.5,-4656.3 1667.5,-4656.3 1667.5,-4708.3"/>
<text text-anchor="middle" x="1375.5" y="-4672.61" font-family="Times,serif" font-size="39.62">check_translations.parse_po</text>
</g>
<!-- check_translations.check_translations -->
<g id="node165" class="node">
<title>check_translations.check_translations</title>
<polygon fill="none" stroke="black" points="983,-4704.8 318,-4704.8 318,-4659.8 983,-4659.8 983,-4704.8"/>
<text text-anchor="middle" x="650.5" y="-4673.92" font-family="Times,serif" font-size="33.60">check_translations.check_translations</text>
</g>
<!-- check_translations.check_translations&#45;&gt;check_translations.parse_po -->
<g id="edge276" class="edge">
<title>check_translations.check_translations&#45;&gt;check_translations.parse_po</title>
<path fill="none" stroke="black" d="M983.11,-4682.3C1013.14,-4682.3 1043.45,-4682.3 1073.19,-4682.3"/>
<polygon fill="black" stroke="black" points="1073.26,-4685.8 1083.26,-4682.3 1073.26,-4678.8 1073.26,-4685.8"/>
</g>
<!-- pending_embed._needs_embedding -->
<g id="node166" class="node">
<title>pending_embed._needs_embedding</title>
<g id="a_node166"><a xlink:title="Return ``True`` when ``emb`` is missing or stale.&#10;&#10;The function also upgrades older vector files stored as a single object and&#10;removes corrupted or mismatched ones so ``embed.py`` always operates on&#10;clean data.">
<polygon fill="none" stroke="black" points="8756,-4029.8 7938,-4029.8 7938,-3972.8 8756,-3972.8 8756,-4029.8"/>
<text text-anchor="middle" x="8347" y="-3989.96" font-family="Times,serif" font-size="44.80">pending_embed._needs_embedding</text>
</a>
</g>
</g>
<!-- pending_embed._needs_embedding&#45;&gt;notes_utils.write_json -->
<g id="edge278" class="edge">
<title>pending_embed._needs_embedding&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M8756.22,-4000.13C8806.79,-4015.82 8853.97,-4040.32 8892,-4077.3 8961.14,-4144.55 8887,-4204.01 8928,-4291.3 8993.04,-4429.77 9130.46,-4555.83 9191.59,-4607.52"/>
<polygon fill="black" stroke="black" points="9189.43,-4610.28 9199.34,-4614.02 9193.93,-4604.91 9189.43,-4610.28"/>
</g>
<!-- pending_embed._needs_embedding&#45;&gt;notes_utils.load_json -->
<g id="edge277" class="edge">
<title>pending_embed._needs_embedding&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M8756.11,-4008.35C8818.19,-4001.08 8869.2,-3987.35 8892,-3963.3 8973.83,-3877.03 8854.11,-1916.47 8928,-1823.3 8966.03,-1775.35 9030.16,-1755.7 9088.84,-1748.52"/>
<polygon fill="black" stroke="black" points="9089.41,-1751.98 9098.97,-1747.4 9088.64,-1745.02 9089.41,-1751.98"/>
</g>
<!-- pending_embed.main -->
<g id="node167" class="node">
<title>pending_embed.main</title>
<polygon fill="none" stroke="black" points="6577,-4012.3 6053,-4012.3 6053,-3952.3 6577,-3952.3 6577,-4012.3"/>
<text text-anchor="middle" x="6315" y="-3970.78" font-family="Times,serif" font-size="46.90">pending_embed.main</text>
</g>
<!-- pending_embed.main&#45;&gt;lot_io.read_lots -->
<g id="edge283" class="edge">
<title>pending_embed.main&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M6407.72,-3952.22C6513.48,-3919.05 6693.19,-3867.34 6852,-3844.3 6902.28,-3837.01 7724.56,-3840.7 7766,-3811.3 7801.81,-3785.9 7766.88,-3745.66 7802,-3719.3 7867.34,-3670.26 8091.19,-3665.04 8230.55,-3666.87"/>
<polygon fill="black" stroke="black" points="8230.8,-3670.37 8240.85,-3667.02 8230.91,-3663.37 8230.8,-3670.37"/>
</g>
<!-- pending_embed.main&#45;&gt;post_io.read_post -->
<g id="edge281" class="edge">
<title>pending_embed.main&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M6373.18,-3952.1C6478.38,-3893.43 6702.24,-3753.54 6816,-3570.3 6853.08,-3510.59 6798.91,-3462.38 6852,-3416.3 7006,-3282.65 7615.79,-3473.2 7766,-3335.3 7834.15,-3272.75 7740.01,-3198.97 7802,-3130.3 7867.43,-3057.83 7964.16,-3018.42 8057.98,-2997.33"/>
<polygon fill="black" stroke="black" points="8058.9,-3000.71 8067.93,-2995.16 8057.41,-2993.88 8058.9,-3000.71"/>
</g>
<!-- pending_embed.main&#45;&gt;moderation.message_skip_reason -->
<g id="edge279" class="edge">
<title>pending_embed.main&#45;&gt;moderation.message_skip_reason</title>
<path fill="none" stroke="black" d="M6577.25,-3966.1C6663.97,-3974.54 6754.07,-4000.57 6816,-4063.3 6892.39,-4140.69 6769.65,-4234.3 6852,-4305.3 7009.27,-4440.91 8391.84,-4334.71 8969.78,-4283.7"/>
<polygon fill="black" stroke="black" points="8970.26,-4287.17 8979.92,-4282.81 8969.65,-4280.2 8970.26,-4287.17"/>
</g>
<!-- pending_embed.main&#45;&gt;moderation.lot_skip_reason -->
<g id="edge280" class="edge">
<title>pending_embed.main&#45;&gt;moderation.lot_skip_reason</title>
<path fill="none" stroke="black" d="M6577.29,-3999.71C6664.61,-4005.04 6762.47,-4010.5 6852,-4014.3 6965.24,-4019.11 8804.39,-4110.21 8892,-4038.3 8955.4,-3986.27 8877.26,-3921.75 8928,-3857.3 8976.31,-3795.94 9058.72,-3761.13 9124.02,-3742.12"/>
<polygon fill="black" stroke="black" points="9125.27,-3745.41 9133.94,-3739.32 9123.36,-3738.67 9125.27,-3745.41"/>
</g>
<!-- pending_embed.main&#45;&gt;lot_io.iter_lot_files -->
<g id="edge285" class="edge">
<title>pending_embed.main&#45;&gt;lot_io.iter_lot_files</title>
<path fill="none" stroke="black" d="M6577.06,-3973.3C6934.03,-3958.3 7554.29,-3921.81 7766,-3844.3 7784.29,-3837.61 7783.83,-3826.34 7802,-3819.3 7933.84,-3768.27 8095.63,-3752.21 8208.34,-3747.73"/>
<polygon fill="black" stroke="black" points="8208.55,-3751.22 8218.41,-3747.35 8208.29,-3744.23 8208.55,-3751.22"/>
</g>
<!-- pending_embed.main&#45;&gt;post_io.raw_post_path_from_lot -->
<g id="edge282" class="edge">
<title>pending_embed.main&#45;&gt;post_io.raw_post_path_from_lot</title>
<path fill="none" stroke="black" d="M6378.33,-3952.23C6488.78,-3895.18 6716.57,-3759.79 6816,-3570.3 6859.84,-3486.77 6784.44,-3213.15 6852,-3147.3 6893.84,-3106.53 7038.55,-3103.75 7153.87,-3108.73"/>
<polygon fill="black" stroke="black" points="7153.73,-3112.22 7163.88,-3109.18 7154.05,-3105.23 7153.73,-3112.22"/>
</g>
<!-- pending_embed.main&#45;&gt;lot_io.embedding_path -->
<g id="edge284" class="edge">
<title>pending_embed.main&#45;&gt;lot_io.embedding_path</title>
<path fill="none" stroke="black" d="M6526.24,-4012.33C6615.85,-4026.17 6721.36,-4043.84 6816,-4063.3 6832.15,-4066.63 6835.68,-4069.9 6852,-4072.3 6952.59,-4087.09 7680.48,-4060.32 7766,-4115.3 7795.43,-4134.22 7772.6,-4166.35 7802,-4185.3 7942.21,-4275.71 8147.54,-4254.33 8261.63,-4232.3"/>
<polygon fill="black" stroke="black" points="8262.58,-4235.69 8271.71,-4230.31 8261.22,-4228.82 8262.58,-4235.69"/>
</g>
<!-- pending_embed.main&#45;&gt;pending_embed._needs_embedding -->
<g id="edge286" class="edge">
<title>pending_embed.main&#45;&gt;pending_embed._needs_embedding</title>
<path fill="none" stroke="black" d="M6577.01,-3990.31C6664.42,-3992.68 6762.41,-3994.98 6852,-3996.3 7215.18,-4001.65 7628.07,-4002.65 7927.61,-4002.45"/>
<polygon fill="black" stroke="black" points="7927.78,-4005.95 7937.77,-4002.44 7927.77,-3998.95 7927.78,-4005.95"/>
</g>
<!-- chop:cli -->
<g id="node169" class="node">
<title>chop:cli</title>
<g id="a_node169"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="1986" cy="-4620.3" rx="27" ry="18"/>
<text text-anchor="middle" x="1986" y="-4618.7" font-family="Times,serif" font-size="7.00">chop:cli</text>
</a>
</g>
</g>
<!-- embed:cli&#45;&gt;chop:cli -->
<!-- moderation:cli -->
<g id="node170" class="node">
<title>moderation:cli</title>
<g id="a_node170"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="2606.5" cy="-4620.3" rx="38.53" ry="18"/>
<text text-anchor="middle" x="2606.5" y="-4618.7" font-family="Times,serif" font-size="7.00">moderation:cli</text>
</a>
</g>
</g>
<!-- chop:cli&#45;&gt;moderation:cli -->
<!-- build_site:cli -->
<g id="node171" class="node">
<title>build_site:cli</title>
<g id="a_node171"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="3211.5" cy="-4620.3" rx="34.71" ry="18"/>
<text text-anchor="middle" x="3211.5" y="-4618.7" font-family="Times,serif" font-size="7.00">build_site:cli</text>
</a>
</g>
</g>
<!-- moderation:cli&#45;&gt;build_site:cli -->
<!-- tg_client:cli -->
<g id="node172" class="node">
<title>tg_client:cli</title>
<g id="a_node172"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="4058" cy="-4620.3" rx="32.86" ry="18"/>
<text text-anchor="middle" x="4058" y="-4618.7" font-family="Times,serif" font-size="7.00">tg_client:cli</text>
</a>
</g>
</g>
<!-- build_site:cli&#45;&gt;tg_client:cli -->
<!-- clean_data:cli -->
<g id="node173" class="node">
<title>clean_data:cli</title>
<g id="a_node173"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="141" cy="-4744.3" rx="37.29" ry="18"/>
<text text-anchor="middle" x="141" y="-4742.7" font-family="Times,serif" font-size="7.00">clean_data:cli</text>
</a>
</g>
</g>
<!-- debug_dump:cli -->
<g id="node174" class="node">
<title>debug_dump:cli</title>
<g id="a_node174"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="650.5" cy="-4744.3" rx="41.11" ry="18"/>
<text text-anchor="middle" x="650.5" y="-4742.7" font-family="Times,serif" font-size="7.00">debug_dump:cli</text>
</a>
</g>
</g>
<!-- clean_data:cli&#45;&gt;debug_dump:cli -->
<!-- scan_ontology:cli -->
<g id="node175" class="node">
<title>scan_ontology:cli</title>
<g id="a_node175"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="1375.5" cy="-4744.3" rx="44.19" ry="18"/>
<text text-anchor="middle" x="1375.5" y="-4742.7" font-family="Times,serif" font-size="7.00">scan_ontology:cli</text>
</a>
</g>
</g>
<!-- debug_dump:cli&#45;&gt;scan_ontology:cli -->
<!-- caption:cli -->
<g id="node176" class="node">
<title>caption:cli</title>
<g id="a_node176"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="1986" cy="-4744.3" rx="30.28" ry="18"/>
<text text-anchor="middle" x="1986" y="-4742.7" font-family="Times,serif" font-size="7.00">caption:cli</text>
</a>
</g>
</g>
<!-- scan_ontology:cli&#45;&gt;caption:cli -->
<!-- pending_chop:cli -->
<g id="node177" class="node">
<title>pending_chop:cli</title>
<g id="a_node177"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="2606.5" cy="-4744.3" rx="42.96" ry="18"/>
<text text-anchor="middle" x="2606.5" y="-4742.7" font-family="Times,serif" font-size="7.00">pending_chop:cli</text>
</a>
</g>
</g>
<!-- caption:cli&#45;&gt;pending_chop:cli -->
<!-- pending_caption:cli -->
<g id="node178" class="node">
<title>pending_caption:cli</title>
<g id="a_node178"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="3211.5" cy="-4744.3" rx="48.62" ry="18"/>
<text text-anchor="middle" x="3211.5" y="-4742.7" font-family="Times,serif" font-size="7.00">pending_caption:cli</text>
</a>
</g>
</g>
<!-- pending_chop:cli&#45;&gt;pending_caption:cli -->
<!-- check_translations:cli -->
<g id="node179" class="node">
<title>check_translations:cli</title>
<g id="a_node179"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="4058" cy="-4744.3" rx="53.05" ry="18"/>
<text text-anchor="middle" x="4058" y="-4742.7" font-family="Times,serif" font-size="7.00">check_translations:cli</text>
</a>
</g>
</g>
<!-- pending_caption:cli&#45;&gt;check_translations:cli -->
<!-- pending_embed:cli -->
<g id="node180" class="node">
<title>pending_embed:cli</title>
<g id="a_node180"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="141" cy="-4798.3" rx="47.39" ry="18"/>
<text text-anchor="middle" x="141" y="-4796.7" font-family="Times,serif" font-size="7.00">pending_embed:cli</text>
</a>
</g>
</g>
<!-- build_site -->
<g id="node181" class="node">
<title>build_site</title>
<ellipse fill="none" stroke="black" cx="4946.5" cy="-542.3" rx="55.79" ry="18"/>
<text text-anchor="middle" x="4946.5" y="-538.6" font-family="Times,serif" font-size="14.00">build_site</text>
</g>
<!-- build_site&#45;&gt;build_site.main -->
<g id="edge298" class="edge">
<title>build_site:cli&#45;&gt;build_site.main</title>
<path fill="none" stroke="black" d="M5002.65,-542.3C5068.93,-542.3 5184.12,-542.3 5287.12,-542.3"/>
<polygon fill="black" stroke="black" points="5287.37,-545.8 5297.37,-542.3 5287.37,-538.8 5287.37,-545.8"/>
</g>
<!-- caption -->
<g id="node182" class="node">
<title>caption</title>
<ellipse fill="none" stroke="black" cx="5502.5" cy="-1718.3" rx="44.69" ry="18"/>
<text text-anchor="middle" x="5502.5" y="-1714.6" font-family="Times,serif" font-size="14.00">caption</text>
</g>
<!-- caption&#45;&gt;caption.main -->
<g id="edge299" class="edge">
<title>caption:cli&#45;&gt;caption.main</title>
<path fill="none" stroke="black" d="M5546.45,-1714.56C5602.28,-1711.44 5701.66,-1711.91 5778,-1745.3 5797.61,-1753.88 5794.52,-1768.42 5814,-1777.3 5942.52,-1835.93 6107.7,-1846.47 6212.24,-1846.26"/>
<polygon fill="black" stroke="black" points="6212.5,-1849.76 6222.48,-1846.2 6212.46,-1842.76 6212.5,-1849.76"/>
</g>
<!-- check_translations -->
<g id="node183" class="node">
<title>check_translations</title>
<ellipse fill="none" stroke="black" cx="141" cy="-4682.3" rx="96.68" ry="18"/>
<text text-anchor="middle" x="141" y="-4678.6" font-family="Times,serif" font-size="14.00">check_translations</text>
</g>
<!-- check_translations&#45;&gt;check_translations.check_translations -->
<g id="edge300" class="edge">
<title>check_translations:cli&#45;&gt;check_translations.check_translations</title>
<path fill="none" stroke="black" d="M238.05,-4682.3C259.3,-4682.3 282.99,-4682.3 307.97,-4682.3"/>
<polygon fill="black" stroke="black" points="307.99,-4685.8 317.99,-4682.3 307.99,-4678.8 307.99,-4685.8"/>
</g>
<!-- chop -->
<g id="node184" class="node">
<title>chop</title>
<ellipse fill="none" stroke="black" cx="4946.5" cy="-4530.3" rx="32.49" ry="18"/>
<text text-anchor="middle" x="4946.5" y="-4526.6" font-family="Times,serif" font-size="14.00">chop</text>
</g>
<!-- chop&#45;&gt;chop.main -->
<g id="edge301" class="edge">
<title>chop:cli&#45;&gt;chop.main</title>
<path fill="none" stroke="black" d="M4979.28,-4530.3C5062.91,-4530.3 5291.32,-4530.3 5416.56,-4530.3"/>
<polygon fill="black" stroke="black" points="5416.88,-4533.8 5426.88,-4530.3 5416.88,-4526.8 5416.88,-4533.8"/>
</g>
<!-- clean_data -->
<g id="node185" class="node">
<title>clean_data</title>
<ellipse fill="none" stroke="black" cx="5502.5" cy="-3338.3" rx="59.59" ry="18"/>
<text text-anchor="middle" x="5502.5" y="-3334.6" font-family="Times,serif" font-size="14.00">clean_data</text>
</g>
<!-- clean_data&#45;&gt;clean_data.main -->
<g id="edge302" class="edge">
<title>clean_data:cli&#45;&gt;clean_data.main</title>
<path fill="none" stroke="black" d="M5562.44,-3338.3C5698.52,-3338.3 6036.11,-3338.3 6208.72,-3338.3"/>
<polygon fill="black" stroke="black" points="6208.83,-3341.8 6218.83,-3338.3 6208.83,-3334.8 6208.83,-3341.8"/>
</g>
<!-- debug_dump -->
<g id="node186" class="node">
<title>debug_dump</title>
<ellipse fill="none" stroke="black" cx="5502.5" cy="-1553.3" rx="70.39" ry="18"/>
<text text-anchor="middle" x="5502.5" y="-1549.6" font-family="Times,serif" font-size="14.00">debug_dump</text>
</g>
<!-- debug_dump&#45;&gt;debug_dump.main -->
<g id="edge303" class="edge">
<title>debug_dump:cli&#45;&gt;debug_dump.main</title>
<path fill="none" stroke="black" d="M5572.95,-1553.3C5681.4,-1553.3 5896.21,-1553.3 6066.75,-1553.3"/>
<polygon fill="black" stroke="black" points="6066.89,-1556.8 6076.89,-1553.3 6066.89,-1549.8 6066.89,-1556.8"/>
</g>
<!-- embed -->
<g id="node187" class="node">
<title>embed</title>
<ellipse fill="none" stroke="black" cx="5502.5" cy="-4808.3" rx="42.49" ry="18"/>
<text text-anchor="middle" x="5502.5" y="-4804.6" font-family="Times,serif" font-size="14.00">embed</text>
</g>
<!-- embed&#45;&gt;embed.main -->
<g id="edge304" class="edge">
<title>embed:cli&#45;&gt;embed.main</title>
<path fill="none" stroke="black" d="M5544.81,-4808.3C5668.62,-4808.3 6039.03,-4808.3 6216.76,-4808.3"/>
<polygon fill="black" stroke="black" points="6216.89,-4811.8 6226.89,-4808.3 6216.89,-4804.8 6216.89,-4811.8"/>
</g>
<!-- moderation -->
<g id="node188" class="node">
<title>moderation</title>
<ellipse fill="none" stroke="black" cx="6315" cy="-3543.3" rx="63.89" ry="18"/>
<text text-anchor="middle" x="6315" y="-3539.6" font-family="Times,serif" font-size="14.00">moderation</text>
</g>
<!-- moderation&#45;&gt;moderation.apply_to_history -->
<g id="edge305" class="edge">
<title>moderation:cli&#45;&gt;moderation.apply_to_history</title>
<path fill="none" stroke="black" d="M6378.81,-3543.3C6509.48,-3543.3 6817.21,-3543.3 7042.87,-3543.3"/>
<polygon fill="black" stroke="black" points="7042.88,-3546.8 7052.88,-3543.3 7042.88,-3539.8 7042.88,-3546.8"/>
</g>
<!-- pending_caption -->
<g id="node189" class="node">
<title>pending_caption</title>
<ellipse fill="none" stroke="black" cx="5502.5" cy="-2431.3" rx="87.18" ry="18"/>
<text text-anchor="middle" x="5502.5" y="-2427.6" font-family="Times,serif" font-size="14.00">pending_caption</text>
</g>
<!-- pending_caption&#45;&gt;pending_caption.main -->
<g id="edge306" class="edge">
<title>pending_caption:cli&#45;&gt;pending_caption.main</title>
<path fill="none" stroke="black" d="M5589.85,-2431.3C5703.52,-2431.3 5907.97,-2431.3 6070.71,-2431.3"/>
<polygon fill="black" stroke="black" points="6070.87,-2434.8 6080.87,-2431.3 6070.87,-2427.8 6070.87,-2434.8"/>
</g>
<!-- pending_chop -->
<g id="node190" class="node">
<title>pending_chop</title>
<ellipse fill="none" stroke="black" cx="6315" cy="-4275.3" rx="74.99" ry="18"/>
<text text-anchor="middle" x="6315" y="-4271.6" font-family="Times,serif" font-size="14.00">pending_chop</text>
</g>
<!-- pending_chop&#45;&gt;pending_chop.main -->
<g id="edge307" class="edge">
<title>pending_chop:cli&#45;&gt;pending_chop.main</title>
<path fill="none" stroke="black" d="M6389.75,-4275.3C6546.3,-4275.3 6915.42,-4275.3 7135.03,-4275.3"/>
<polygon fill="black" stroke="black" points="7135.05,-4278.8 7145.05,-4275.3 7135.05,-4271.8 7135.05,-4278.8"/>
</g>
<!-- pending_embed -->
<g id="node191" class="node">
<title>pending_embed</title>
<ellipse fill="none" stroke="black" cx="5502.5" cy="-3982.3" rx="83.69" ry="18"/>
<text text-anchor="middle" x="5502.5" y="-3978.6" font-family="Times,serif" font-size="14.00">pending_embed</text>
</g>
<!-- pending_embed&#45;&gt;pending_embed.main -->
<g id="edge308" class="edge">
<title>pending_embed:cli&#45;&gt;pending_embed.main</title>
<path fill="none" stroke="black" d="M5586.43,-3982.3C5692.92,-3982.3 5882.99,-3982.3 6042.15,-3982.3"/>
<polygon fill="black" stroke="black" points="6042.59,-3985.8 6052.59,-3982.3 6042.59,-3978.8 6042.59,-3985.8"/>
</g>
<!-- scan_ontology -->
<g id="node192" class="node">
<title>scan_ontology</title>
<ellipse fill="none" stroke="black" cx="4946.5" cy="-4171.3" rx="76.09" ry="18"/>
<text text-anchor="middle" x="4946.5" y="-4167.6" font-family="Times,serif" font-size="14.00">scan_ontology</text>
</g>
<!-- scan_ontology&#45;&gt;scan_ontology.main -->
<g id="edge309" class="edge">
<title>scan_ontology:cli&#45;&gt;scan_ontology.main</title>
<path fill="none" stroke="black" d="M5022.79,-4171.3C5085.32,-4171.3 5177.8,-4171.3 5264.85,-4171.3"/>
<polygon fill="black" stroke="black" points="5264.88,-4174.8 5274.88,-4171.3 5264.88,-4167.8 5264.88,-4174.8"/>
</g>
<!-- telegram_bot -->
<g id="node193" class="node">
<title>telegram_bot</title>
<ellipse fill="none" stroke="black" cx="4058" cy="-961.3" rx="72.29" ry="18"/>
<text text-anchor="middle" x="4058" y="-957.6" font-family="Times,serif" font-size="14.00">telegram_bot</text>
</g>
<!-- telegram_bot&#45;&gt;telegram_bot.send_alert -->
<g id="edge310" class="edge">
<title>telegram_bot:cli&#45;&gt;telegram_bot.send_alert</title>
<path fill="none" stroke="black" d="M4129.67,-958.99C4267.46,-954.48 4575.61,-944.4 4771.27,-938"/>
<polygon fill="black" stroke="black" points="4771.49,-941.5 4781.37,-937.67 4771.27,-934.5 4771.49,-941.5"/>
</g>
<!-- telegram_bot&#45;&gt;telegram_bot.main -->
<g id="edge311" class="edge">
<title>telegram_bot:cli&#45;&gt;telegram_bot.main</title>
<path fill="none" stroke="black" d="M4128.56,-965.23C4265.67,-972.96 4574.51,-990.38 4770.73,-1001.45"/>
<polygon fill="black" stroke="black" points="4770.68,-1004.95 4780.86,-1002.02 4771.07,-997.96 4770.68,-1004.95"/>
</g>
<!-- tg_client -->
<g id="node194" class="node">
<title>tg_client</title>
<ellipse fill="none" stroke="black" cx="141" cy="-3124.3" rx="50.89" ry="18"/>
<text text-anchor="middle" x="141" y="-3120.6" font-family="Times,serif" font-size="14.00">tg_client</text>
</g>
<!-- tg_client&#45;&gt;tg_client.main -->
<g id="edge312" class="edge">
<title>tg_client:cli&#45;&gt;tg_client.main</title>
<path fill="none" stroke="black" d="M192.05,-3124.3C232.34,-3124.3 292.58,-3124.3 356.22,-3124.3"/>
<polygon fill="black" stroke="black" points="356.46,-3127.8 366.46,-3124.3 356.46,-3120.8 356.46,-3127.8"/>
</g>
</g>
</svg>
