<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: callgraph Pages: 1 -->
<svg width="10286pt" height="5446pt"
 viewBox="0.00 0.00 10286.00 5446.44" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 5442.44)">
<title>callgraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-5442.44 10282,-5442.44 10282,4 -4,4"/>
<!-- scan_ontology.collect_ontology -->
<g id="node1" class="node">
<title>scan_ontology.collect_ontology</title>
<g id="a_node1"><a xlink:title="Return counts per field, value counters, misparsed lots and broken metadata.">
<polygon fill="none" stroke="black" points="6844,-2164.35 5928,-2164.35 5928,-2093.35 6844,-2093.35 6844,-2164.35"/>
<text text-anchor="middle" x="6386" y="-2114.21" font-family="Times,serif" font-size="57.68">scan_ontology.collect_ontology</text>
</a>
</g>
</g>
<!-- post_io.read_post -->
<g id="node2" class="node">
<title>post_io.read_post</title>
<g id="a_node2"><a xlink:title="Return metadata dictionary and body text for ``path``.">
<polygon fill="none" stroke="black" points="8820.5,-1818.85 8262.5,-1818.85 8262.5,-1742.85 8820.5,-1742.85 8820.5,-1818.85"/>
<text text-anchor="middle" x="8541.5" y="-1765.68" font-family="Times,serif" font-size="61.46">post_io.read_post</text>
</a>
</g>
</g>
<!-- scan_ontology.collect_ontology&#45;&gt;post_io.read_post -->
<g id="edge1" class="edge">
<title>scan_ontology.collect_ontology&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M6457.49,-2093.17C6561.28,-2042.49 6762.66,-1951.12 6945,-1908.85 7185.63,-1853.06 7861.5,-1813.03 8252.06,-1793.77"/>
<polygon fill="black" stroke="black" points="8252.28,-1797.27 8262.09,-1793.28 8251.93,-1790.27 8252.28,-1797.27"/>
</g>
<!-- post_io.raw_post_path -->
<g id="node3" class="node">
<title>post_io.raw_post_path</title>
<g id="a_node3"><a xlink:title="Return absolute message path for ``rel`` under ``root``.">
<polygon fill="none" stroke="black" points="8618,-3393.85 8465,-3393.85 8465,-3357.85 8618,-3357.85 8618,-3393.85"/>
<text text-anchor="middle" x="8541.5" y="-3372.61" font-family="Times,serif" font-size="12.18">post_io.raw_post_path</text>
</a>
</g>
</g>
<!-- scan_ontology.collect_ontology&#45;&gt;post_io.raw_post_path -->
<g id="edge2" class="edge">
<title>scan_ontology.collect_ontology&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M6808.71,-2164.47C6846.88,-2182.68 6881.45,-2207.18 6909,-2239.85 6973.31,-2316.1 6876.76,-3064.09 6945,-3136.85 7111.6,-3314.49 7835.54,-3111.11 8035,-3250.85 8064.95,-3271.84 8041.09,-3303.8 8071,-3324.85 8184.61,-3404.78 8353.5,-3401.25 8454.72,-3389.72"/>
<polygon fill="black" stroke="black" points="8455.39,-3393.16 8464.91,-3388.51 8454.56,-3386.21 8455.39,-3393.16"/>
</g>
<!-- moderation.is_misparsed -->
<g id="node4" class="node">
<title>moderation.is_misparsed</title>
<g id="a_node4"><a xlink:title="Return ``True`` for obviously invalid lots or source posts.">
<polygon fill="none" stroke="black" points="8759.5,-850.85 8323.5,-850.85 8323.5,-806.85 8759.5,-806.85 8759.5,-850.85"/>
<text text-anchor="middle" x="8541.5" y="-820.53" font-family="Times,serif" font-size="32.90">moderation.is_misparsed</text>
</a>
</g>
</g>
<!-- scan_ontology.collect_ontology&#45;&gt;moderation.is_misparsed -->
<g id="edge3" class="edge">
<title>scan_ontology.collect_ontology&#45;&gt;moderation.is_misparsed</title>
<path fill="none" stroke="black" d="M6447.9,-2093.21C6562.5,-2022.26 6807.81,-1851.13 6909,-1631.85 6939.63,-1565.47 6894.26,-1027.48 6945,-974.85 7128.34,-784.69 7917.82,-796.33 8313.14,-815"/>
<polygon fill="black" stroke="black" points="8313.12,-818.51 8323.28,-815.49 8313.45,-811.52 8313.12,-818.51"/>
</g>
<!-- message_utils.gather_chop_input -->
<g id="node5" class="node">
<title>message_utils.gather_chop_input</title>
<g id="a_node5"><a xlink:title="Return the exact text fed to the lot parser for ``msg_path``.">
<polygon fill="none" stroke="black" points="7702.5,-2024.85 7277.5,-2024.85 7277.5,-1988.85 7702.5,-1988.85 7702.5,-2024.85"/>
<text text-anchor="middle" x="7490" y="-2000.97" font-family="Times,serif" font-size="24.22">message_utils.gather_chop_input</text>
</a>
</g>
</g>
<!-- scan_ontology.collect_ontology&#45;&gt;message_utils.gather_chop_input -->
<g id="edge4" class="edge">
<title>scan_ontology.collect_ontology&#45;&gt;message_utils.gather_chop_input</title>
<path fill="none" stroke="black" d="M6707.97,-2093.32C6906.5,-2071.34 7153.59,-2043.98 7316.04,-2026"/>
<polygon fill="black" stroke="black" points="7316.58,-2029.46 7326.13,-2024.88 7315.81,-2022.5 7316.58,-2029.46"/>
</g>
<!-- lot_io.read_lots -->
<g id="node6" class="node">
<title>lot_io.read_lots</title>
<g id="a_node6"><a xlink:title="Return a list of lots from ``path`` or ``None`` when invalid.">
<polygon fill="none" stroke="black" points="8647.5,-2533.85 8435.5,-2533.85 8435.5,-2497.85 8647.5,-2497.85 8647.5,-2533.85"/>
<text text-anchor="middle" x="8541.5" y="-2509.69" font-family="Times,serif" font-size="25.20">lot_io.read_lots</text>
</a>
</g>
</g>
<!-- scan_ontology.collect_ontology&#45;&gt;lot_io.read_lots -->
<g id="edge5" class="edge">
<title>scan_ontology.collect_ontology&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M6726.96,-2164.38C6798.92,-2171.51 6874.44,-2178.69 6945,-2184.85 7065.98,-2195.41 7945.37,-2183.9 8035,-2265.85 8107.47,-2332.11 7998.32,-2417.81 8071,-2483.85 8178.38,-2581.42 8362.71,-2559.02 8465.56,-2536.15"/>
<polygon fill="black" stroke="black" points="8466.59,-2539.5 8475.56,-2533.86 8465.03,-2532.68 8466.59,-2539.5"/>
</g>
<!-- notes_utils.read_md -->
<g id="node42" class="node">
<title>notes_utils.read_md</title>
<g id="a_node42"><a xlink:title="Alias for :func:`read_text` used for Markdown files.">
<polygon fill="none" stroke="black" points="9447.5,-1922.85 9307.5,-1922.85 9307.5,-1886.85 9447.5,-1886.85 9447.5,-1922.85"/>
<text text-anchor="middle" x="9377.5" y="-1901.61" font-family="Times,serif" font-size="12.18">notes_utils.read_md</text>
</a>
</g>
</g>
<!-- post_io.read_post&#45;&gt;notes_utils.read_md -->
<g id="edge44" class="edge">
<title>post_io.read_post&#45;&gt;notes_utils.read_md</title>
<path fill="none" stroke="black" d="M8820.57,-1803.66C8883.67,-1810.23 8950.28,-1818.27 9012,-1827.85 9111.04,-1843.22 9223.73,-1868.2 9297.26,-1885.52"/>
<polygon fill="black" stroke="black" points="9296.84,-1889.01 9307.37,-1887.91 9298.45,-1882.2 9296.84,-1889.01"/>
</g>
<!-- notes_utils._parse_block -->
<g id="node43" class="node">
<title>notes_utils._parse_block</title>
<g id="a_node43"><a xlink:title="Return metadata dict and remaining body from ``text``.">
<polygon fill="none" stroke="black" points="9546.5,-1665.35 9208.5,-1665.35 9208.5,-1628.35 9546.5,-1628.35 9546.5,-1665.35"/>
<text text-anchor="middle" x="9377.5" y="-1640.41" font-family="Times,serif" font-size="26.18">notes_utils._parse_block</text>
</a>
</g>
</g>
<!-- post_io.read_post&#45;&gt;notes_utils._parse_block -->
<g id="edge45" class="edge">
<title>post_io.read_post&#45;&gt;notes_utils._parse_block</title>
<path fill="none" stroke="black" d="M8779.26,-1742.81C8932.82,-1718.14 9126.75,-1686.98 9251.22,-1666.98"/>
<polygon fill="black" stroke="black" points="9251.85,-1670.42 9261.17,-1665.38 9250.74,-1663.51 9251.85,-1670.42"/>
</g>
<!-- lot_io.get_seller -->
<g id="node76" class="node">
<title>lot_io.get_seller</title>
<g id="a_node76"><a xlink:title="Return the seller identifier or ``None`` when missing.">
<polygon fill="none" stroke="black" points="9478,-680.85 9277,-680.85 9277,-644.85 9478,-644.85 9478,-680.85"/>
<text text-anchor="middle" x="9377.5" y="-657.26" font-family="Times,serif" font-size="23.24">lot_io.get_seller</text>
</a>
</g>
</g>
<!-- moderation.is_misparsed&#45;&gt;lot_io.get_seller -->
<g id="edge85" class="edge">
<title>moderation.is_misparsed&#45;&gt;lot_io.get_seller</title>
<path fill="none" stroke="black" d="M8612.05,-806.83C8708.79,-777.05 8889.94,-724.4 9048,-695.85 9120.28,-682.79 9202.51,-674.54 9266.62,-669.55"/>
<polygon fill="black" stroke="black" points="9267.04,-673.03 9276.75,-668.78 9266.51,-666.05 9267.04,-673.03"/>
</g>
<!-- message_utils.gather_chop_input&#45;&gt;post_io.read_post -->
<g id="edge264" class="edge">
<title>message_utils.gather_chop_input&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7605.99,-2024.88C7726.61,-2037.01 7915.01,-2035.86 8035,-1936.85 8074.35,-1904.38 8031.19,-1859.76 8071,-1827.85 8122.14,-1786.85 8187.18,-1766.89 8252.44,-1758.82"/>
<polygon fill="black" stroke="black" points="8252.95,-1762.28 8262.49,-1757.67 8252.15,-1755.33 8252.95,-1762.28"/>
</g>
<!-- message_utils.build_prompt -->
<g id="node34" class="node">
<title>message_utils.build_prompt</title>
<g id="a_node34"><a xlink:title="Return prompt combining message text with captioned file names.">
<polygon fill="none" stroke="black" points="8691,-1926.85 8392,-1926.85 8392,-1890.85 8691,-1890.85 8691,-1926.85"/>
<text text-anchor="middle" x="8541.5" y="-1904.06" font-family="Times,serif" font-size="19.74">message_utils.build_prompt</text>
</a>
</g>
</g>
<!-- message_utils.gather_chop_input&#45;&gt;message_utils.build_prompt -->
<g id="edge265" class="edge">
<title>message_utils.gather_chop_input&#45;&gt;message_utils.build_prompt</title>
<path fill="none" stroke="black" d="M7702.78,-1997.89C7803.54,-1992.74 7925.62,-1985.19 8035,-1974.85 8163.23,-1962.72 8309.03,-1943.05 8410.98,-1928.34"/>
<polygon fill="black" stroke="black" points="8411.62,-1931.78 8421.02,-1926.89 8410.62,-1924.85 8411.62,-1931.78"/>
</g>
<!-- caption_io.read_caption -->
<g id="node38" class="node">
<title>caption_io.read_caption</title>
<g id="a_node38"><a xlink:title="Return caption for ``image`` in ``lang`` or empty string when missing.">
<polygon fill="none" stroke="black" points="8707,-2074.35 8376,-2074.35 8376,-2037.35 8707,-2037.35 8707,-2074.35"/>
<text text-anchor="middle" x="8541.5" y="-2049.41" font-family="Times,serif" font-size="26.18">caption_io.read_caption</text>
</a>
</g>
</g>
<!-- message_utils.gather_chop_input&#45;&gt;caption_io.read_caption -->
<g id="edge266" class="edge">
<title>message_utils.gather_chop_input&#45;&gt;caption_io.read_caption</title>
<path fill="none" stroke="black" d="M7702.75,-2016.74C7897.71,-2025.84 8183.5,-2039.18 8365.75,-2047.69"/>
<polygon fill="black" stroke="black" points="8365.82,-2051.2 8375.97,-2048.17 8366.15,-2044.21 8365.82,-2051.2"/>
</g>
<!-- notes_utils.load_json -->
<g id="node52" class="node">
<title>notes_utils.load_json</title>
<g id="a_node52"><a xlink:title="Return parsed JSON or ``None`` when invalid.">
<polygon fill="none" stroke="black" points="9501.5,-4008.85 9253.5,-4008.85 9253.5,-3972.85 9501.5,-3972.85 9501.5,-4008.85"/>
<text text-anchor="middle" x="9377.5" y="-3985.15" font-family="Times,serif" font-size="22.12">notes_utils.load_json</text>
</a>
</g>
</g>
<!-- lot_io.read_lots&#45;&gt;notes_utils.load_json -->
<g id="edge268" class="edge">
<title>lot_io.read_lots&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M8632.72,-2497.84C8740.04,-2482.24 8916.64,-2476.05 9012,-2578.85 9058.63,-2629.11 9032.71,-3128.01 9048,-3194.85 9120.51,-3511.83 9306.94,-3864.79 9361.37,-3963.77"/>
<polygon fill="black" stroke="black" points="9358.46,-3965.74 9366.36,-3972.8 9364.59,-3962.36 9358.46,-3965.74"/>
</g>
<!-- lot_io._clean_lot -->
<g id="node163" class="node">
<title>lot_io._clean_lot</title>
<g id="a_node163"><a xlink:title="Return ``lot`` without empty or null fields.">
<polygon fill="none" stroke="black" points="9435,-2005.85 9320,-2005.85 9320,-1969.85 9435,-1969.85 9435,-2005.85"/>
<text text-anchor="middle" x="9377.5" y="-1984.61" font-family="Times,serif" font-size="12.18">lot_io._clean_lot</text>
</a>
</g>
</g>
<!-- lot_io.read_lots&#45;&gt;lot_io._clean_lot -->
<g id="edge267" class="edge">
<title>lot_io.read_lots&#45;&gt;lot_io._clean_lot</title>
<path fill="none" stroke="black" d="M8604.38,-2533.95C8705.07,-2559.18 8903.96,-2590.71 9012,-2483.85 9084.11,-2412.52 8977.92,-2102.17 9048,-2028.85 9114.47,-1959.31 9234.45,-1963.17 9309.55,-1974.19"/>
<polygon fill="black" stroke="black" points="9309.42,-1977.71 9319.84,-1975.78 9310.49,-1970.79 9309.42,-1977.71"/>
</g>
<!-- scan_ontology.main -->
<g id="node7" class="node">
<title>scan_ontology.main</title>
<polygon fill="none" stroke="black" points="5779,-2443.35 5324,-2443.35 5324,-2386.35 5779,-2386.35 5779,-2443.35"/>
<text text-anchor="middle" x="5551.5" y="-2403.96" font-family="Times,serif" font-size="44.24">scan_ontology.main</text>
</g>
<!-- scan_ontology.main&#45;&gt;scan_ontology.collect_ontology -->
<g id="edge6" class="edge">
<title>scan_ontology.main&#45;&gt;scan_ontology.collect_ontology</title>
<path fill="none" stroke="black" d="M5779.24,-2406.21C5796.63,-2398.96 5812.87,-2389.38 5827,-2376.85 5874.09,-2335.07 5817.44,-2283.3 5863,-2239.85 5895.57,-2208.79 5934.57,-2185.52 5976.4,-2168.2"/>
<polygon fill="black" stroke="black" points="5977.96,-2171.35 5985.94,-2164.37 5975.35,-2164.85 5977.96,-2171.35"/>
</g>
<!-- log_utils.install_excepthook -->
<g id="node8" class="node">
<title>log_utils.install_excepthook</title>
<g id="a_node8"><a xlink:title="Redirect uncaught exceptions to ``logger.exception``.">
<polygon fill="none" stroke="black" points="6572.5,-5050.85 6199.5,-5050.85 6199.5,-5014.85 6572.5,-5014.85 6572.5,-5050.85"/>
<text text-anchor="middle" x="6386" y="-5026.69" font-family="Times,serif" font-size="25.20">log_utils.install_excepthook</text>
</a>
</g>
</g>
<!-- scan_ontology.main&#45;&gt;log_utils.install_excepthook -->
<g id="edge7" class="edge">
<title>scan_ontology.main&#45;&gt;log_utils.install_excepthook</title>
<path fill="none" stroke="black" d="M5628.15,-2443.4C5693.84,-2472.69 5784.86,-2525.18 5827,-2603.85 5886.8,-2715.47 5786.03,-4782.3 5863,-4882.85 5938.53,-4981.51 6074.61,-5018.34 6188.89,-5030.86"/>
<polygon fill="black" stroke="black" points="6188.87,-5034.38 6199.18,-5031.93 6189.59,-5027.42 6188.87,-5034.38"/>
</g>
<!-- notes_utils.write_json -->
<g id="node9" class="node">
<title>notes_utils.write_json</title>
<g id="a_node9"><a xlink:title="Serialise ``data`` to ``path`` with standard options.">
<polygon fill="none" stroke="black" points="9471.5,-2379.85 9283.5,-2379.85 9283.5,-2343.85 9471.5,-2343.85 9471.5,-2379.85"/>
<text text-anchor="middle" x="9377.5" y="-2357.81" font-family="Times,serif" font-size="15.68">notes_utils.write_json</text>
</a>
</g>
</g>
<!-- scan_ontology.main&#45;&gt;notes_utils.write_json -->
<g id="edge8" class="edge">
<title>scan_ontology.main&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M5779.27,-2413.03C6215.91,-2409.38 7203.77,-2400.42 8035,-2387.85 8496.94,-2380.86 9048.28,-2369.1 9273.25,-2364.15"/>
<polygon fill="black" stroke="black" points="9273.47,-2367.65 9283.39,-2363.93 9273.32,-2360.65 9273.47,-2367.65"/>
</g>
<!-- log_utils._extract_tb_lineno -->
<g id="node123" class="node">
<title>log_utils._extract_tb_lineno</title>
<g id="a_node123"><a xlink:title="Return the last line number from a traceback.">
<polygon fill="none" stroke="black" points="7605.5,-5196.85 7374.5,-5196.85 7374.5,-5160.85 7605.5,-5160.85 7605.5,-5196.85"/>
<text text-anchor="middle" x="7490" y="-5174.81" font-family="Times,serif" font-size="15.68">log_utils._extract_tb_lineno</text>
</a>
</g>
</g>
<!-- log_utils.install_excepthook&#45;&gt;log_utils._extract_tb_lineno -->
<g id="edge174" class="edge">
<title>log_utils.install_excepthook&#45;&gt;log_utils._extract_tb_lineno</title>
<path fill="none" stroke="black" d="M6536.42,-5050.86C6640.84,-5063.59 6783.49,-5081.27 6909,-5097.85 7066.07,-5118.6 7246.83,-5144.1 7364.24,-5160.88"/>
<polygon fill="black" stroke="black" points="7363.95,-5164.37 7374.34,-5162.32 7364.94,-5157.44 7363.95,-5164.37"/>
</g>
<!-- telegram_bot._t -->
<g id="node10" class="node">
<title>telegram_bot._t</title>
<g id="a_node10"><a xlink:title="Return ``text`` translated to ``lang`` using gettext files.">
<polygon fill="none" stroke="black" points="5655.5,-5350.85 5447.5,-5350.85 5447.5,-5314.85 5655.5,-5314.85 5655.5,-5350.85"/>
<text text-anchor="middle" x="5551.5" y="-5326.97" font-family="Times,serif" font-size="24.22">telegram_bot._t</text>
</a>
</g>
</g>
<!-- telegram_bot.ensure_profile -->
<g id="node11" class="node">
<title>telegram_bot.ensure_profile</title>
<g id="a_node11"><a xlink:title="Return profile for ``uid`` creating one if needed.">
<polygon fill="none" stroke="black" points="5702.5,-5404.85 5400.5,-5404.85 5400.5,-5368.85 5702.5,-5368.85 5702.5,-5404.85"/>
<text text-anchor="middle" x="5551.5" y="-5382.06" font-family="Times,serif" font-size="19.74">telegram_bot.ensure_profile</text>
</a>
</g>
</g>
<!-- telegram_bot.save_profiles -->
<g id="node12" class="node">
<title>telegram_bot.save_profiles</title>
<g id="a_node12"><a xlink:title="Write ``profiles`` to disk.">
<polygon fill="none" stroke="black" points="6490,-5404.85 6282,-5404.85 6282,-5368.85 6490,-5368.85 6490,-5404.85"/>
<text text-anchor="middle" x="6386" y="-5383.15" font-family="Times,serif" font-size="14.00">telegram_bot.save_profiles</text>
</a>
</g>
</g>
<!-- telegram_bot.ensure_profile&#45;&gt;telegram_bot.save_profiles -->
<g id="edge9" class="edge">
<title>telegram_bot.ensure_profile&#45;&gt;telegram_bot.save_profiles</title>
<path fill="none" stroke="black" d="M5702.78,-5386.85C5866.29,-5386.85 6124.01,-5386.85 6271.44,-5386.85"/>
<polygon fill="black" stroke="black" points="6271.86,-5390.35 6281.86,-5386.85 6271.86,-5383.35 6271.86,-5390.35"/>
</g>
<!-- telegram_bot.load_profiles -->
<g id="node13" class="node">
<title>telegram_bot.load_profiles</title>
<g id="a_node13"><a xlink:title="Populate the global ``profiles`` mapping.">
<polygon fill="none" stroke="black" points="5702.5,-4972.85 5400.5,-4972.85 5400.5,-4936.85 5702.5,-4936.85 5702.5,-4972.85"/>
<text text-anchor="middle" x="5551.5" y="-4949.55" font-family="Times,serif" font-size="21.00">telegram_bot.load_profiles</text>
</a>
</g>
</g>
<!-- notes_utils.read_text -->
<g id="node14" class="node">
<title>notes_utils.read_text</title>
<g id="a_node14"><a xlink:title="Return file contents as UTF&#45;8 or empty string when missing.">
<polygon fill="none" stroke="black" points="10117.5,-4120.85 9903.5,-4120.85 9903.5,-4084.85 10117.5,-4084.85 10117.5,-4120.85"/>
<text text-anchor="middle" x="10010.5" y="-4098.07" font-family="Times,serif" font-size="18.48">notes_utils.read_text</text>
</a>
</g>
</g>
<!-- telegram_bot.load_profiles&#45;&gt;notes_utils.read_text -->
<g id="edge10" class="edge">
<title>telegram_bot.load_profiles&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M5702.63,-4959.58C6428.18,-4981.85 9543.1,-5070.04 9707,-4948.85 9986.71,-4742.02 10008.65,-4253.5 10009.66,-4131.06"/>
<polygon fill="black" stroke="black" points="10013.16,-4131 10009.7,-4120.99 10006.16,-4130.98 10013.16,-4131"/>
</g>
<!-- notes_utils.read_text&#45;&gt;notes_utils.read_text -->
<g id="edge276" class="edge">
<title>notes_utils.read_text&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M9903.28,-4118.11C9871.38,-4128.57 9907.12,-4138.85 10010.5,-4138.85 10100.15,-4138.85 10138.93,-4131.12 10126.85,-4122.25"/>
<polygon fill="black" stroke="black" points="10128.27,-4119.05 10117.72,-4118.11 10125.38,-4125.42 10128.27,-4119.05"/>
</g>
<!-- telegram_bot.load_state -->
<g id="node15" class="node">
<title>telegram_bot.load_state</title>
<g id="a_node15"><a xlink:title="Populate ``processed_ids`` from ``STATE_PATH``.">
<polygon fill="none" stroke="black" points="5695,-5096.85 5408,-5096.85 5408,-5060.85 5695,-5060.85 5695,-5096.85"/>
<text text-anchor="middle" x="5551.5" y="-5073.15" font-family="Times,serif" font-size="22.12">telegram_bot.load_state</text>
</a>
</g>
</g>
<!-- telegram_bot.load_state&#45;&gt;notes_utils.read_text -->
<g id="edge11" class="edge">
<title>telegram_bot.load_state&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M5695.23,-5078.85C6015.89,-5078.85 6817.86,-5078.85 7489,-5078.85 7489,-5078.85 7489,-5078.85 8542.5,-5078.85 9061.5,-5078.85 9296.58,-5309.52 9707,-4991.85 9995.15,-4768.82 10010.73,-4257.6 10010.04,-4131.4"/>
<polygon fill="black" stroke="black" points="10013.54,-4131.02 10009.94,-4121.05 10006.54,-4131.08 10013.54,-4131.02"/>
</g>
<!-- telegram_bot.save_state -->
<g id="node16" class="node">
<title>telegram_bot.save_state</title>
<polygon fill="none" stroke="black" points="6470,-5142.85 6302,-5142.85 6302,-5106.85 6470,-5106.85 6470,-5142.85"/>
<text text-anchor="middle" x="6386" y="-5121.61" font-family="Times,serif" font-size="12.18">telegram_bot.save_state</text>
</g>
<!-- telegram_bot.scan_embeddings -->
<g id="node17" class="node">
<title>telegram_bot.scan_embeddings</title>
<g id="a_node17"><a xlink:title="Load new embeddings and return list of new lot ids.">
<polygon fill="none" stroke="black" points="7636,-4599.85 7344,-4599.85 7344,-4563.85 7636,-4563.85 7636,-4599.85"/>
<text text-anchor="middle" x="7490" y="-4577.69" font-family="Times,serif" font-size="17.08">telegram_bot.scan_embeddings</text>
</a>
</g>
</g>
<!-- similar_utils._load_embeddings -->
<g id="node18" class="node">
<title>similar_utils._load_embeddings</title>
<g id="a_node18"><a xlink:title="Return mapping of lot id to embedding vector.">
<polygon fill="none" stroke="black" points="8797.5,-4464.85 8285.5,-4464.85 8285.5,-4422.85 8797.5,-4422.85 8797.5,-4464.85"/>
<text text-anchor="middle" x="8541.5" y="-4435.76" font-family="Times,serif" font-size="31.36">similar_utils._load_embeddings</text>
</a>
</g>
</g>
<!-- telegram_bot.scan_embeddings&#45;&gt;similar_utils._load_embeddings -->
<g id="edge12" class="edge">
<title>telegram_bot.scan_embeddings&#45;&gt;similar_utils._load_embeddings</title>
<path fill="none" stroke="black" d="M7636.08,-4588.17C7774.14,-4591.57 7970.17,-4588.79 8035,-4549.85 8061.33,-4534.03 8045,-4507.2 8071,-4490.85 8131.27,-4452.95 8204.73,-4435.37 8275.48,-4428.67"/>
<polygon fill="black" stroke="black" points="8275.79,-4432.16 8285.44,-4427.8 8275.18,-4425.19 8275.79,-4432.16"/>
</g>
<!-- similar_utils._load_embeddings&#45;&gt;notes_utils.load_json -->
<g id="edge158" class="edge">
<title>similar_utils._load_embeddings&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M8624.66,-4464.85C8729.55,-4486.23 8909.68,-4503.76 9012,-4404.85 9110.77,-4309.37 8960.94,-4204.12 9048,-4097.85 9095.37,-4040.03 9174.46,-4013.14 9243.17,-4000.78"/>
<polygon fill="black" stroke="black" points="9243.96,-4004.2 9253.23,-3999.06 9242.78,-3997.3 9243.96,-4004.2"/>
</g>
<!-- telegram_bot._should_suggest -->
<g id="node19" class="node">
<title>telegram_bot._should_suggest</title>
<polygon fill="none" stroke="black" points="6547.5,-5250.85 6224.5,-5250.85 6224.5,-5214.85 6547.5,-5214.85 6547.5,-5250.85"/>
<text text-anchor="middle" x="6386" y="-5228.06" font-family="Times,serif" font-size="19.74">telegram_bot._should_suggest</text>
</g>
<!-- similar_utils._cos_sim -->
<g id="node20" class="node">
<title>similar_utils._cos_sim</title>
<g id="a_node20"><a xlink:title="Return cosine similarity between two embeddings.">
<polygon fill="none" stroke="black" points="7606.5,-5250.85 7373.5,-5250.85 7373.5,-5214.85 7606.5,-5214.85 7606.5,-5250.85"/>
<text text-anchor="middle" x="7490" y="-5228.06" font-family="Times,serif" font-size="19.74">similar_utils._cos_sim</text>
</a>
</g>
</g>
<!-- telegram_bot._should_suggest&#45;&gt;similar_utils._cos_sim -->
<g id="edge13" class="edge">
<title>telegram_bot._should_suggest&#45;&gt;similar_utils._cos_sim</title>
<path fill="none" stroke="black" d="M6547.54,-5232.85C6768.64,-5232.85 7162.29,-5232.85 7363.31,-5232.85"/>
<polygon fill="black" stroke="black" points="7363.33,-5236.35 7373.33,-5232.85 7363.33,-5229.35 7363.33,-5236.35"/>
</g>
<!-- telegram_bot.enqueue_new_ids -->
<g id="node21" class="node">
<title>telegram_bot.enqueue_new_ids</title>
<polygon fill="none" stroke="black" points="5790,-5252.85 5313,-5252.85 5313,-5212.85 5790,-5212.85 5790,-5252.85"/>
<text text-anchor="middle" x="5551.5" y="-5225.78" font-family="Times,serif" font-size="28.84">telegram_bot.enqueue_new_ids</text>
</g>
<!-- telegram_bot.enqueue_new_ids&#45;&gt;telegram_bot.save_profiles -->
<g id="edge14" class="edge">
<title>telegram_bot.enqueue_new_ids&#45;&gt;telegram_bot.save_profiles</title>
<path fill="none" stroke="black" d="M5790.25,-5250.73C5803.31,-5256.75 5815.7,-5264.05 5827,-5272.85 5860.02,-5298.56 5828.82,-5335.7 5863,-5359.85 5994.53,-5452.77 6194.54,-5429.84 6304.89,-5407.02"/>
<polygon fill="black" stroke="black" points="6305.9,-5410.39 6314.96,-5404.89 6304.45,-5403.54 6305.9,-5410.39"/>
</g>
<!-- telegram_bot.enqueue_new_ids&#45;&gt;telegram_bot._should_suggest -->
<g id="edge15" class="edge">
<title>telegram_bot.enqueue_new_ids&#45;&gt;telegram_bot._should_suggest</title>
<path fill="none" stroke="black" d="M5790.23,-5232.85C5925.54,-5232.85 6091.92,-5232.85 6214.26,-5232.85"/>
<polygon fill="black" stroke="black" points="6214.47,-5236.35 6224.47,-5232.85 6214.47,-5229.35 6214.47,-5236.35"/>
</g>
<!-- telegram_bot._send_queue -->
<g id="node22" class="node">
<title>telegram_bot._send_queue</title>
<g id="a_node22"><a xlink:title="Send next lot from each user queue via ``app``.">
<polygon fill="none" stroke="black" points="5827,-5042.85 5276,-5042.85 5276,-4990.85 5827,-4990.85 5827,-5042.85"/>
<text text-anchor="middle" x="5551.5" y="-5007.15" font-family="Times,serif" font-size="39.62">telegram_bot._send_queue</text>
</a>
</g>
</g>
<!-- telegram_bot._send_queue&#45;&gt;telegram_bot.save_profiles -->
<g id="edge16" class="edge">
<title>telegram_bot._send_queue&#45;&gt;telegram_bot.save_profiles</title>
<path fill="none" stroke="black" d="M5817.24,-5042.91C5820.62,-5045.71 5823.87,-5048.69 5827,-5051.85 5923.94,-5149.81 5762.45,-5265.6 5863,-5359.85 5986.56,-5475.66 6207.37,-5436.97 6317.98,-5407.5"/>
<polygon fill="black" stroke="black" points="6318.96,-5410.86 6327.69,-5404.86 6317.12,-5404.1 6318.96,-5410.86"/>
</g>
<!-- lot_io.get_lot -->
<g id="node23" class="node">
<title>lot_io.get_lot</title>
<g id="a_node23"><a xlink:title="Return the lot identified by ``lot_id`` or ``None`` when missing.">
<polygon fill="none" stroke="black" points="7562.5,-3967.85 7417.5,-3967.85 7417.5,-3931.85 7562.5,-3931.85 7562.5,-3967.85"/>
<text text-anchor="middle" x="7490" y="-3945.06" font-family="Times,serif" font-size="19.74">lot_io.get_lot</text>
</a>
</g>
</g>
<!-- telegram_bot._send_queue&#45;&gt;lot_io.get_lot -->
<g id="edge17" class="edge">
<title>telegram_bot._send_queue&#45;&gt;lot_io.get_lot</title>
<path fill="none" stroke="black" d="M5818.13,-4990.66C5821.21,-4987.89 5824.17,-4984.95 5827,-4981.85 5903.44,-4898.08 5781.7,-4040.91 5863,-3961.85 5918.79,-3907.59 7085.23,-3937.91 7407.27,-3947.35"/>
<polygon fill="black" stroke="black" points="7407.36,-3950.86 7417.46,-3947.65 7407.57,-3943.86 7407.36,-3950.86"/>
</g>
<!-- lot_io.get_lot&#45;&gt;lot_io.read_lots -->
<g id="edge274" class="edge">
<title>lot_io.get_lot&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M7562.65,-3952.16C7695.73,-3954.76 7973.22,-3951.68 8035,-3883.85 8132.68,-3776.62 7974,-2686.7 8071,-2578.85 8162.86,-2476.71 8334.73,-2481.04 8443.09,-2496.38"/>
<polygon fill="black" stroke="black" points="8442.64,-2499.85 8453.05,-2497.85 8443.66,-2492.93 8442.64,-2499.85"/>
</g>
<!-- lot_io.parse_lot_id -->
<g id="node166" class="node">
<title>lot_io.parse_lot_id</title>
<g id="a_node166"><a xlink:title="Return ``(relative_path, index)`` extracted from ``lot_id``.">
<polygon fill="none" stroke="black" points="9502.5,-4142.85 9252.5,-4142.85 9252.5,-4106.85 9502.5,-4106.85 9502.5,-4142.85"/>
<text text-anchor="middle" x="9377.5" y="-4118.69" font-family="Times,serif" font-size="25.20">lot_io.parse_lot_id</text>
</a>
</g>
</g>
<!-- lot_io.get_lot&#45;&gt;lot_io.parse_lot_id -->
<g id="edge275" class="edge">
<title>lot_io.get_lot&#45;&gt;lot_io.parse_lot_id</title>
<path fill="none" stroke="black" d="M7562.94,-3965.33C7672.17,-3988.19 7886.66,-4030.56 8071,-4051.85 8497,-4101.04 9005.19,-4117.39 9242.29,-4122.57"/>
<polygon fill="black" stroke="black" points="9242.26,-4126.07 9252.34,-4122.79 9242.41,-4119.07 9242.26,-4126.07"/>
</g>
<!-- telegram_bot.send_alert -->
<g id="node24" class="node">
<title>telegram_bot.send_alert</title>
<g id="a_node24"><a xlink:title="Broadcast ``text`` to all registered users.">
<polygon fill="none" stroke="black" points="5160.5,-4974.85 4830.5,-4974.85 4830.5,-4938.85 5160.5,-4938.85 5160.5,-4974.85"/>
<text text-anchor="middle" x="4995.5" y="-4950.69" font-family="Times,serif" font-size="25.20">telegram_bot.send_alert</text>
</a>
</g>
</g>
<!-- telegram_bot.send_alert&#45;&gt;telegram_bot.load_profiles -->
<g id="edge18" class="edge">
<title>telegram_bot.send_alert&#45;&gt;telegram_bot.load_profiles</title>
<path fill="none" stroke="black" d="M5160.84,-4956.26C5233.36,-4955.99 5318.29,-4955.69 5390.31,-4955.43"/>
<polygon fill="black" stroke="black" points="5390.4,-4958.93 5400.39,-4955.39 5390.38,-4951.93 5390.4,-4958.93"/>
</g>
<!-- telegram_bot.start_cmd -->
<g id="node25" class="node">
<title>telegram_bot.start_cmd</title>
<g id="a_node25"><a xlink:title="Register the user and confirm startup.">
<polygon fill="none" stroke="black" points="5107.5,-5377.85 4883.5,-5377.85 4883.5,-5341.85 5107.5,-5341.85 5107.5,-5377.85"/>
<text text-anchor="middle" x="4995.5" y="-5355.69" font-family="Times,serif" font-size="17.08">telegram_bot.start_cmd</text>
</a>
</g>
</g>
<!-- telegram_bot.start_cmd&#45;&gt;telegram_bot._t -->
<g id="edge19" class="edge">
<title>telegram_bot.start_cmd&#45;&gt;telegram_bot._t</title>
<path fill="none" stroke="black" d="M5107.61,-5354.43C5203.25,-5349.77 5340.66,-5343.08 5436.99,-5338.38"/>
<polygon fill="black" stroke="black" points="5437.24,-5341.87 5447.06,-5337.89 5436.9,-5334.88 5437.24,-5341.87"/>
</g>
<!-- telegram_bot.start_cmd&#45;&gt;telegram_bot.ensure_profile -->
<g id="edge20" class="edge">
<title>telegram_bot.start_cmd&#45;&gt;telegram_bot.ensure_profile</title>
<path fill="none" stroke="black" d="M5107.61,-5365.26C5188.67,-5369.22 5299.74,-5374.63 5390.37,-5379.05"/>
<polygon fill="black" stroke="black" points="5390.31,-5382.55 5400.47,-5379.54 5390.66,-5375.55 5390.31,-5382.55"/>
</g>
<!-- telegram_bot.lang_cmd -->
<g id="node26" class="node">
<title>telegram_bot.lang_cmd</title>
<g id="a_node26"><a xlink:title="Set preferred language or list available choices.">
<polygon fill="none" stroke="black" points="5170,-5435.35 4821,-5435.35 4821,-5396.35 5170,-5396.35 5170,-5435.35"/>
<text text-anchor="middle" x="4995.5" y="-5408.95" font-family="Times,serif" font-size="28.00">telegram_bot.lang_cmd</text>
</a>
</g>
</g>
<!-- telegram_bot.lang_cmd&#45;&gt;telegram_bot._t -->
<g id="edge21" class="edge">
<title>telegram_bot.lang_cmd&#45;&gt;telegram_bot._t</title>
<path fill="none" stroke="black" d="M5170.27,-5406.52C5194.2,-5401.98 5218.07,-5395.64 5240,-5386.85 5258.57,-5379.41 5257.36,-5367.1 5276,-5359.85 5326.73,-5340.13 5386.53,-5332.6 5437.35,-5330.32"/>
<polygon fill="black" stroke="black" points="5437.53,-5333.81 5447.38,-5329.93 5437.26,-5326.82 5437.53,-5333.81"/>
</g>
<!-- telegram_bot.lang_cmd&#45;&gt;telegram_bot.ensure_profile -->
<g id="edge22" class="edge">
<title>telegram_bot.lang_cmd&#45;&gt;telegram_bot.ensure_profile</title>
<path fill="none" stroke="black" d="M5170.27,-5406.75C5240.59,-5403.07 5321.27,-5398.85 5390.16,-5395.24"/>
<polygon fill="black" stroke="black" points="5390.44,-5398.73 5400.24,-5394.72 5390.07,-5391.74 5390.44,-5398.73"/>
</g>
<!-- telegram_bot.lang_cmd&#45;&gt;telegram_bot.save_profiles -->
<g id="edge23" class="edge">
<title>telegram_bot.lang_cmd&#45;&gt;telegram_bot.save_profiles</title>
<path fill="none" stroke="black" d="M5170.31,-5417.75C5338.36,-5419.04 5600.16,-5419.61 5827,-5413.85 5981.23,-5409.93 6159.24,-5400.46 6271.93,-5393.85"/>
<polygon fill="black" stroke="black" points="6272.18,-5397.34 6281.95,-5393.26 6271.76,-5390.35 6272.18,-5397.34"/>
</g>
<!-- telegram_bot.vote_callback -->
<g id="node27" class="node">
<title>telegram_bot.vote_callback</title>
<g id="a_node27"><a xlink:title="Handle inline button presses for lot feedback.">
<polygon fill="none" stroke="black" points="5210.5,-5323.35 4780.5,-5323.35 4780.5,-5282.35 5210.5,-5282.35 5210.5,-5323.35"/>
<text text-anchor="middle" x="4995.5" y="-5295.61" font-family="Times,serif" font-size="29.68">telegram_bot.vote_callback</text>
</a>
</g>
</g>
<!-- telegram_bot.vote_callback&#45;&gt;telegram_bot._t -->
<g id="edge24" class="edge">
<title>telegram_bot.vote_callback&#45;&gt;telegram_bot._t</title>
<path fill="none" stroke="black" d="M5210.69,-5314.45C5287.86,-5318.63 5371.89,-5323.18 5437.09,-5326.71"/>
<polygon fill="black" stroke="black" points="5437.21,-5330.22 5447.39,-5327.27 5437.59,-5323.23 5437.21,-5330.22"/>
</g>
<!-- telegram_bot.vote_callback&#45;&gt;telegram_bot.ensure_profile -->
<g id="edge25" class="edge">
<title>telegram_bot.vote_callback&#45;&gt;telegram_bot.ensure_profile</title>
<path fill="none" stroke="black" d="M5210.62,-5322.69C5220.67,-5325.66 5230.52,-5329.03 5240,-5332.85 5258.55,-5340.32 5257.36,-5352.6 5276,-5359.85 5311.64,-5373.71 5351.76,-5381.55 5390.1,-5385.77"/>
<polygon fill="black" stroke="black" points="5390.02,-5389.28 5400.33,-5386.82 5390.74,-5382.32 5390.02,-5389.28"/>
</g>
<!-- telegram_bot.vote_callback&#45;&gt;telegram_bot.save_profiles -->
<g id="edge26" class="edge">
<title>telegram_bot.vote_callback&#45;&gt;telegram_bot.save_profiles</title>
<path fill="none" stroke="black" d="M5197.48,-5282.33C5407.98,-5264.54 5722.3,-5249.57 5827,-5305.85 5852.41,-5319.51 5837.93,-5345.59 5863,-5359.85 5994.75,-5434.8 6176.8,-5423.44 6287.43,-5406.49"/>
<polygon fill="black" stroke="black" points="6288.24,-5409.9 6297.57,-5404.89 6287.15,-5402.99 6288.24,-5409.9"/>
</g>
<!-- telegram_bot.main -->
<g id="node28" class="node">
<title>telegram_bot.main</title>
<g id="a_node28"><a xlink:title="Run the Telegram recommendation bot.">
<polygon fill="none" stroke="black" points="5161,-5038.85 4830,-5038.85 4830,-4994.85 5161,-4994.85 5161,-5038.85"/>
<text text-anchor="middle" x="4995.5" y="-5008.53" font-family="Times,serif" font-size="32.90">telegram_bot.main</text>
</a>
</g>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot.load_profiles -->
<g id="edge27" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot.load_profiles</title>
<path fill="none" stroke="black" d="M5161.2,-4995.49C5198.9,-4990.8 5238.82,-4986.01 5276,-4981.85 5313.02,-4977.71 5352.9,-4973.59 5390.47,-4969.87"/>
<polygon fill="black" stroke="black" points="5390.87,-4973.35 5400.48,-4968.88 5390.18,-4966.38 5390.87,-4973.35"/>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot.load_state -->
<g id="edge28" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot.load_state</title>
<path fill="none" stroke="black" d="M5161.2,-5038.21C5198.9,-5042.9 5238.82,-5047.69 5276,-5051.85 5315.48,-5056.26 5358.21,-5060.65 5397.93,-5064.57"/>
<polygon fill="black" stroke="black" points="5397.66,-5068.06 5407.95,-5065.55 5398.34,-5061.09 5397.66,-5068.06"/>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot.save_state -->
<g id="edge29" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot.save_state</title>
<path fill="none" stroke="black" d="M5049.72,-5038.93C5105.13,-5060.69 5194.97,-5092.55 5276,-5105.85 5648.19,-5166.95 6100.06,-5145.67 6291.79,-5132.31"/>
<polygon fill="black" stroke="black" points="6292.11,-5135.8 6301.83,-5131.6 6291.61,-5128.81 6292.11,-5135.8"/>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot.scan_embeddings -->
<g id="edge30" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot.scan_embeddings</title>
<path fill="none" stroke="black" d="M5161.27,-5021.91C5190.36,-5015.64 5218.25,-5004 5240,-4983.85 5296.02,-4931.95 5219.69,-4867.43 5276,-4815.85 5827.19,-4310.99 6200.33,-4673.42 6945,-4608.85 7075.87,-4597.5 7224.89,-4590.52 7333.83,-4586.51"/>
<polygon fill="black" stroke="black" points="7334.05,-4590 7343.91,-4586.14 7333.79,-4583.01 7334.05,-4590"/>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot.enqueue_new_ids -->
<g id="edge31" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot.enqueue_new_ids</title>
<path fill="none" stroke="black" d="M5043.98,-5038.99C5099.19,-5064.41 5193.34,-5106.72 5276,-5138.85 5343.54,-5165.11 5421.86,-5191.54 5477.51,-5209.66"/>
<polygon fill="black" stroke="black" points="5476.69,-5213.07 5487.28,-5212.83 5478.85,-5206.41 5476.69,-5213.07"/>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot._send_queue -->
<g id="edge32" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot._send_queue</title>
<path fill="none" stroke="black" d="M5161.22,-5016.85C5194.31,-5016.85 5229.97,-5016.85 5265.81,-5016.85"/>
<polygon fill="black" stroke="black" points="5265.92,-5020.35 5275.92,-5016.85 5265.92,-5013.35 5265.92,-5020.35"/>
</g>
<!-- chop.has_misc_deal -->
<g id="node29" class="node">
<title>chop.has_misc_deal</title>
<g id="a_node29"><a xlink:title="Return True when any lot is classified as misc or announcement.">
<polygon fill="none" stroke="black" points="7604,-1416.85 7376,-1416.85 7376,-1380.85 7604,-1380.85 7604,-1416.85"/>
<text text-anchor="middle" x="7490" y="-1393.55" font-family="Times,serif" font-size="21.00">chop.has_misc_deal</text>
</a>
</g>
</g>
<!-- chop.process_message -->
<g id="node30" class="node">
<title>chop.process_message</title>
<g id="a_node30"><a xlink:title="Extract lots from ``msg_path`` and save them under ``LOTS_DIR``.">
<polygon fill="none" stroke="black" points="6887,-1454.85 5885,-1454.85 5885,-1352.85 6887,-1352.85 6887,-1454.85"/>
<text text-anchor="middle" x="6386" y="-1382.53" font-family="Times,serif" font-size="85.40">chop.process_message</text>
</a>
</g>
</g>
<!-- chop.process_message&#45;&gt;post_io.read_post -->
<g id="edge34" class="edge">
<title>chop.process_message&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M6887.05,-1423.57C7372,-1442.7 8035,-1468.85 8035,-1468.85 8091.91,-1516.44 8020.95,-1577.08 8071,-1631.85 8118.94,-1684.3 8185.22,-1718.4 8252.88,-1740.54"/>
<polygon fill="black" stroke="black" points="8251.85,-1743.88 8262.44,-1743.58 8253.97,-1737.21 8251.85,-1743.88"/>
</g>
<!-- chop.process_message&#45;&gt;chop.has_misc_deal -->
<g id="edge33" class="edge">
<title>chop.process_message&#45;&gt;chop.has_misc_deal</title>
<path fill="none" stroke="black" d="M6887.22,-1401.58C7064.42,-1400.78 7248.7,-1399.94 7365.88,-1399.41"/>
<polygon fill="black" stroke="black" points="7365.97,-1402.91 7375.96,-1399.36 7365.94,-1395.91 7365.97,-1402.91"/>
</g>
<!-- moderation.should_skip_message -->
<g id="node31" class="node">
<title>moderation.should_skip_message</title>
<g id="a_node31"><a xlink:title="Return ``True`` when the raw Telegram message should be ignored.">
<polygon fill="none" stroke="black" points="8708.5,-1280.85 8374.5,-1280.85 8374.5,-1244.85 8708.5,-1244.85 8708.5,-1280.85"/>
<text text-anchor="middle" x="8541.5" y="-1258.07" font-family="Times,serif" font-size="18.48">moderation.should_skip_message</text>
</a>
</g>
</g>
<!-- chop.process_message&#45;&gt;moderation.should_skip_message -->
<g id="edge35" class="edge">
<title>chop.process_message&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M6887.03,-1363.53C6894.68,-1357.44 6902.01,-1350.89 6909,-1343.85 6961.89,-1290.55 6889.14,-1058.04 6945,-1007.85 7125.17,-845.95 7846.06,-856.28 8035,-1007.85 8092.53,-1054 8018.25,-1118.3 8071,-1169.85 8147.42,-1244.52 8265.52,-1267.64 8364.15,-1272.16"/>
<polygon fill="black" stroke="black" points="8364.11,-1275.66 8374.24,-1272.56 8364.39,-1268.67 8364.11,-1275.66"/>
</g>
<!-- token_utils.estimate_tokens -->
<g id="node32" class="node">
<title>token_utils.estimate_tokens</title>
<g id="a_node32"><a xlink:title="Return a naive token count approximation.">
<polygon fill="none" stroke="black" points="8659.5,-1160.85 8423.5,-1160.85 8423.5,-1124.85 8659.5,-1124.85 8659.5,-1160.85"/>
<text text-anchor="middle" x="8541.5" y="-1138.81" font-family="Times,serif" font-size="15.68">token_utils.estimate_tokens</text>
</a>
</g>
</g>
<!-- chop.process_message&#45;&gt;token_utils.estimate_tokens -->
<g id="edge36" class="edge">
<title>chop.process_message&#45;&gt;token_utils.estimate_tokens</title>
<path fill="none" stroke="black" d="M6887.05,-1364.01C6894.7,-1357.78 6902.03,-1351.07 6909,-1343.85 6979.73,-1270.54 6870.19,-956 6945,-886.85 7033.94,-804.64 7942.95,-808.14 8035,-886.85 8113.3,-953.81 7994.65,-1046.67 8071,-1115.85 8179.76,-1214.4 8367.28,-1187.86 8469.32,-1163.31"/>
<polygon fill="black" stroke="black" points="8470.36,-1166.66 8479.23,-1160.87 8468.68,-1159.86 8470.36,-1166.66"/>
</g>
<!-- embed.embed_file -->
<g id="node33" class="node">
<title>embed.embed_file</title>
<g id="a_node33"><a xlink:title="Embed ``path`` and write the result beside it under ``EMBED_DIR``.">
<polygon fill="none" stroke="black" points="7695,-1362.35 7285,-1362.35 7285,-1307.35 7695,-1307.35 7695,-1362.35"/>
<text text-anchor="middle" x="7490" y="-1324.3" font-family="Times,serif" font-size="42.56">embed.embed_file</text>
</a>
</g>
</g>
<!-- chop.process_message&#45;&gt;embed.embed_file -->
<g id="edge37" class="edge">
<title>chop.process_message&#45;&gt;embed.embed_file</title>
<path fill="none" stroke="black" d="M6887.22,-1372.53C7023.37,-1364 7163.7,-1355.22 7274.56,-1348.28"/>
<polygon fill="black" stroke="black" points="7275.1,-1351.75 7284.86,-1347.63 7274.66,-1344.76 7275.1,-1351.75"/>
</g>
<!-- chop.process_message&#45;&gt;message_utils.build_prompt -->
<g id="edge38" class="edge">
<title>chop.process_message&#45;&gt;message_utils.build_prompt</title>
<path fill="none" stroke="black" d="M6716.39,-1454.85C6788.99,-1480.71 6859.03,-1519.55 6909,-1577.85 6971.2,-1650.41 6873.21,-1726.76 6945,-1789.85 7036.04,-1869.86 7927.96,-1775.99 8035,-1832.85 8058.87,-1845.53 8047.25,-1868.96 8071,-1881.85 8181.13,-1941.63 8327.96,-1939.43 8427.9,-1928.09"/>
<polygon fill="black" stroke="black" points="8428.51,-1931.54 8438.03,-1926.89 8427.69,-1924.59 8428.51,-1931.54"/>
</g>
<!-- lot_io.valid_lots -->
<g id="node35" class="node">
<title>lot_io.valid_lots</title>
<g id="a_node35"><a xlink:title="Return ``True`` when every lot contains the required translations.">
<polygon fill="none" stroke="black" points="9479.5,-740.85 9275.5,-740.85 9275.5,-704.85 9479.5,-704.85 9479.5,-740.85"/>
<text text-anchor="middle" x="9377.5" y="-716.97" font-family="Times,serif" font-size="24.22">lot_io.valid_lots</text>
</a>
</g>
</g>
<!-- chop.process_message&#45;&gt;lot_io.valid_lots -->
<g id="edge39" class="edge">
<title>chop.process_message&#45;&gt;lot_io.valid_lots</title>
<path fill="none" stroke="black" d="M6887.14,-1364.11C6894.77,-1357.85 6902.07,-1351.1 6909,-1343.85 6989.18,-1259.94 6861.8,-903.76 6945,-822.85 7112.72,-659.74 8810.48,-704.02 9265.05,-718.92"/>
<polygon fill="black" stroke="black" points="9265.12,-722.43 9275.23,-719.26 9265.35,-715.43 9265.12,-722.43"/>
</g>
<!-- lot_io.needs_cleanup -->
<g id="node36" class="node">
<title>lot_io.needs_cleanup</title>
<g id="a_node36"><a xlink:title="Return ``True`` when ``clean_data`` would drop ``lots``.">
<polygon fill="none" stroke="black" points="8631,-2474.85 8452,-2474.85 8452,-2438.85 8631,-2438.85 8631,-2474.85"/>
<text text-anchor="middle" x="8541.5" y="-2452.81" font-family="Times,serif" font-size="15.68">lot_io.needs_cleanup</text>
</a>
</g>
</g>
<!-- chop.process_message&#45;&gt;lot_io.needs_cleanup -->
<g id="edge40" class="edge">
<title>chop.process_message&#45;&gt;lot_io.needs_cleanup</title>
<path fill="none" stroke="black" d="M6730.95,-1454.97C6799.68,-1480.97 6864.36,-1519.84 6909,-1577.85 6986.81,-1678.96 6853.37,-2062.07 6945,-2150.85 7032.02,-2235.17 7941.57,-2107.69 8035,-2184.85 8091.2,-2231.26 8019.79,-2292.98 8071,-2344.85 8168.24,-2443.35 8335.45,-2461.37 8441.86,-2461.75"/>
<polygon fill="black" stroke="black" points="8441.96,-2465.25 8451.96,-2461.74 8441.95,-2458.25 8441.96,-2465.25"/>
</g>
<!-- caption_io.has_caption -->
<g id="node37" class="node">
<title>caption_io.has_caption</title>
<g id="a_node37"><a xlink:title="Return ``True`` when any caption exists for ``image``.">
<polygon fill="none" stroke="black" points="8619,-1872.85 8464,-1872.85 8464,-1836.85 8619,-1836.85 8619,-1872.85"/>
<text text-anchor="middle" x="8541.5" y="-1851.61" font-family="Times,serif" font-size="12.18">caption_io.has_caption</text>
</a>
</g>
</g>
<!-- chop.process_message&#45;&gt;caption_io.has_caption -->
<g id="edge41" class="edge">
<title>chop.process_message&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M6869.71,-1454.86C6895.17,-1457.29 6920.39,-1459.63 6945,-1461.85 7065.97,-1472.74 7946.97,-1461.16 8035,-1544.85 8126.89,-1632.21 7978.3,-1741.34 8071,-1827.85 8124.51,-1877.78 8333.32,-1871.02 8453.68,-1862.48"/>
<polygon fill="black" stroke="black" points="8454.25,-1865.95 8463.97,-1861.73 8453.74,-1858.97 8454.25,-1865.95"/>
</g>
<!-- chop.process_message&#45;&gt;caption_io.read_caption -->
<g id="edge42" class="edge">
<title>chop.process_message&#45;&gt;caption_io.read_caption</title>
<path fill="none" stroke="black" d="M6728.58,-1454.87C6797.97,-1480.84 6863.53,-1519.73 6909,-1577.85 6971.64,-1657.91 6870.83,-1964.35 6945,-2033.85 6996.1,-2081.74 7962.26,-2067.69 8365.76,-2059.68"/>
<polygon fill="black" stroke="black" points="8365.84,-2063.18 8375.77,-2059.48 8365.7,-2056.18 8365.84,-2063.18"/>
</g>
<!-- moderation.message_skip_reason -->
<g id="node74" class="node">
<title>moderation.message_skip_reason</title>
<g id="a_node74"><a xlink:title="Return the moderation reason for ``meta`` and ``text`` or ``None``.">
<polygon fill="none" stroke="black" points="9672.5,-1479.35 9082.5,-1479.35 9082.5,-1434.35 9672.5,-1434.35 9672.5,-1479.35"/>
<text text-anchor="middle" x="9377.5" y="-1448.47" font-family="Times,serif" font-size="33.60">moderation.message_skip_reason</text>
</a>
</g>
</g>
<!-- moderation.should_skip_message&#45;&gt;moderation.message_skip_reason -->
<g id="edge83" class="edge">
<title>moderation.should_skip_message&#45;&gt;moderation.message_skip_reason</title>
<path fill="none" stroke="black" d="M8708.54,-1266.42C8799.29,-1271.36 8913.04,-1282.43 9012,-1306.85 9128.04,-1335.48 9255.41,-1394.87 9324.63,-1429.71"/>
<polygon fill="black" stroke="black" points="9323.1,-1432.86 9333.6,-1434.25 9326.26,-1426.61 9323.1,-1432.86"/>
</g>
<!-- embed.embed_file&#45;&gt;lot_io.read_lots -->
<g id="edge260" class="edge">
<title>embed.embed_file&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M7695.08,-1321.43C7829.47,-1317.53 7988.82,-1324 8035,-1371.85 8120.85,-1460.8 7985.16,-2394.89 8071,-2483.85 8174.05,-2590.64 8367.23,-2562 8470.76,-2536.35"/>
<polygon fill="black" stroke="black" points="8471.66,-2539.73 8480.49,-2533.88 8469.94,-2532.95 8471.66,-2539.73"/>
</g>
<!-- embed.embed_file&#45;&gt;notes_utils.write_json -->
<g id="edge262" class="edge">
<title>embed.embed_file&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M7609.77,-1307.32C7730.2,-1286.82 7915.4,-1276.62 8035,-1371.85 8078.23,-1406.27 8028.2,-1455.91 8071,-1490.85 8233.68,-1623.65 8865.07,-1427.8 9012,-1577.85 9090.71,-1658.24 8997.15,-1982.49 9048,-2082.85 9111.07,-2207.35 9256.62,-2298.54 9330.98,-2338.86"/>
<polygon fill="black" stroke="black" points="9329.65,-2342.12 9340.12,-2343.76 9332.96,-2335.95 9329.65,-2342.12"/>
</g>
<!-- lot_io.make_lot_id -->
<g id="node161" class="node">
<title>lot_io.make_lot_id</title>
<g id="a_node161"><a xlink:title="Return lot id string for ``rel`` and ``index``.&#10;&#10;``rel`` is the JSON file path relative to the ``data/lots`` directory&#10;without the ``.json`` suffix.">
<polygon fill="none" stroke="black" points="8634,-1481.85 8449,-1481.85 8449,-1445.85 8634,-1445.85 8634,-1481.85"/>
<text text-anchor="middle" x="8541.5" y="-1459.07" font-family="Times,serif" font-size="18.48">lot_io.make_lot_id</text>
</a>
</g>
</g>
<!-- embed.embed_file&#45;&gt;lot_io.make_lot_id -->
<g id="edge261" class="edge">
<title>embed.embed_file&#45;&gt;lot_io.make_lot_id</title>
<path fill="none" stroke="black" d="M7664.83,-1307.35C7778.25,-1298.4 7925.09,-1304.59 8035,-1371.85 8061.53,-1388.08 8044.48,-1415.62 8071,-1431.85 8182.33,-1499.99 8337.56,-1495.54 8438.54,-1482.57"/>
<polygon fill="black" stroke="black" points="8439.29,-1486 8448.74,-1481.21 8438.37,-1479.06 8439.29,-1486"/>
</g>
<!-- caption_io.caption_json_path -->
<g id="node104" class="node">
<title>caption_io.caption_json_path</title>
<g id="a_node104"><a xlink:title="Return new&#45;style caption path for ``image``.">
<polygon fill="none" stroke="black" points="9474,-2779.85 9281,-2779.85 9281,-2743.85 9474,-2743.85 9474,-2779.85"/>
<text text-anchor="middle" x="9377.5" y="-2758.61" font-family="Times,serif" font-size="12.18">caption_io.caption_json_path</text>
</a>
</g>
</g>
<!-- caption_io.has_caption&#45;&gt;caption_io.caption_json_path -->
<g id="edge283" class="edge">
<title>caption_io.has_caption&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M8619.41,-1847.57C8738.29,-1838.17 8958.57,-1828.77 9012,-1881.85 9056.31,-1925.87 9021.84,-2386.13 9048,-2442.85 9112.01,-2581.66 9265.18,-2691.91 9337.47,-2738.19"/>
<polygon fill="black" stroke="black" points="9335.97,-2741.39 9346.29,-2743.78 9339.71,-2735.47 9335.97,-2741.39"/>
</g>
<!-- caption_io.caption_md_path -->
<g id="node107" class="node">
<title>caption_io.caption_md_path</title>
<g id="a_node107"><a xlink:title="Return legacy Markdown caption path for ``image``.">
<polygon fill="none" stroke="black" points="9471,-2073.85 9284,-2073.85 9284,-2037.85 9471,-2037.85 9471,-2073.85"/>
<text text-anchor="middle" x="9377.5" y="-2052.61" font-family="Times,serif" font-size="12.18">caption_io.caption_md_path</text>
</a>
</g>
</g>
<!-- caption_io.has_caption&#45;&gt;caption_io.caption_md_path -->
<g id="edge284" class="edge">
<title>caption_io.has_caption&#45;&gt;caption_io.caption_md_path</title>
<path fill="none" stroke="black" d="M8619.19,-1848.82C8736.65,-1841.27 8953.69,-1834.5 9012,-1881.85 9059.54,-1920.45 9001.77,-1974.69 9048,-2014.85 9109,-2067.84 9202.07,-2075 9273.59,-2070.68"/>
<polygon fill="black" stroke="black" points="9274.24,-2074.14 9283.98,-2069.96 9273.76,-2067.16 9274.24,-2074.14"/>
</g>
<!-- caption_io.read_caption&#45;&gt;notes_utils.read_md -->
<g id="edge285" class="edge">
<title>caption_io.read_caption&#45;&gt;notes_utils.read_md</title>
<path fill="none" stroke="black" d="M8638.38,-2037.33C8739.99,-2017.82 8905.17,-1986.44 9048,-1960.85 9133.04,-1945.61 9230.65,-1929.1 9297.23,-1917.98"/>
<polygon fill="black" stroke="black" points="9297.94,-1921.41 9307.23,-1916.31 9296.79,-1914.5 9297.94,-1921.41"/>
</g>
<!-- caption_io.read_caption&#45;&gt;notes_utils.load_json -->
<g id="edge286" class="edge">
<title>caption_io.read_caption&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M8643.56,-2074.35C8754.98,-2100.66 8929.39,-2160.59 9012,-2287.85 9066.91,-2372.45 9026.43,-3096.33 9048,-3194.85 9117.54,-3512.5 9306.05,-3864.99 9361.17,-3963.82"/>
<polygon fill="black" stroke="black" points="9358.28,-3965.82 9366.22,-3972.83 9364.39,-3962.4 9358.28,-3965.82"/>
</g>
<!-- caption_io.read_caption&#45;&gt;caption_io.caption_json_path -->
<g id="edge288" class="edge">
<title>caption_io.read_caption&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M8707.25,-2068.43C8810.17,-2085.27 8936.97,-2124.07 9012,-2212.85 9078.79,-2291.87 9000.44,-2350.96 9048,-2442.85 9118.44,-2578.93 9269.04,-2690.94 9339.16,-2737.98"/>
<polygon fill="black" stroke="black" points="9337.43,-2741.03 9347.7,-2743.65 9341.31,-2735.2 9337.43,-2741.03"/>
</g>
<!-- caption_io.read_caption&#45;&gt;caption_io.caption_md_path -->
<g id="edge289" class="edge">
<title>caption_io.read_caption&#45;&gt;caption_io.caption_md_path</title>
<path fill="none" stroke="black" d="M8707.27,-2055.85C8875.62,-2055.85 9131.81,-2055.85 9273.4,-2055.85"/>
<polygon fill="black" stroke="black" points="9273.81,-2059.35 9283.81,-2055.85 9273.81,-2052.35 9273.81,-2059.35"/>
</g>
<!-- caption_io._get_langs -->
<g id="node170" class="node">
<title>caption_io._get_langs</title>
<g id="a_node170"><a xlink:title="Return configured languages, caching the result.">
<polygon fill="none" stroke="black" points="9486.5,-2433.85 9268.5,-2433.85 9268.5,-2397.85 9486.5,-2397.85 9486.5,-2433.85"/>
<text text-anchor="middle" x="9377.5" y="-2411.07" font-family="Times,serif" font-size="18.48">caption_io._get_langs</text>
</a>
</g>
</g>
<!-- caption_io.read_caption&#45;&gt;caption_io._get_langs -->
<g id="edge287" class="edge">
<title>caption_io.read_caption&#45;&gt;caption_io._get_langs</title>
<path fill="none" stroke="black" d="M8707.02,-2069.8C8809.18,-2087.23 8935.21,-2126.16 9012,-2212.85 9064.94,-2272.62 8988.27,-2335.87 9048,-2388.85 9111.68,-2445.33 9212.27,-2445.29 9285.38,-2435.34"/>
<polygon fill="black" stroke="black" points="9286.11,-2438.77 9295.5,-2433.88 9285.1,-2431.84 9286.11,-2438.77"/>
</g>
<!-- chop.main -->
<g id="node39" class="node">
<title>chop.main</title>
<g id="a_node39"><a xlink:title="Process a single message file passed on the command line.">
<polygon fill="none" stroke="black" points="5627,-1421.85 5476,-1421.85 5476,-1385.85 5627,-1385.85 5627,-1421.85"/>
<text text-anchor="middle" x="5551.5" y="-1397.69" font-family="Times,serif" font-size="25.20">chop.main</text>
</a>
</g>
</g>
<!-- chop.main&#45;&gt;chop.process_message -->
<g id="edge43" class="edge">
<title>chop.main&#45;&gt;chop.process_message</title>
<path fill="none" stroke="black" d="M5627.11,-1403.85C5687.11,-1403.85 5777.22,-1403.85 5874.58,-1403.85"/>
<polygon fill="black" stroke="black" points="5874.63,-1407.35 5884.63,-1403.85 5874.63,-1400.35 5874.63,-1407.35"/>
</g>
<!-- post_io.get_contact -->
<g id="node40" class="node">
<title>post_io.get_contact</title>
<g id="a_node40"><a xlink:title="Return a contact identifier from ``meta`` or ``None`` when missing.">
<polygon fill="none" stroke="black" points="7589.5,-3593.85 7390.5,-3593.85 7390.5,-3557.85 7589.5,-3557.85 7589.5,-3593.85"/>
<text text-anchor="middle" x="7490" y="-3571.07" font-family="Times,serif" font-size="18.48">post_io.get_contact</text>
</a>
</g>
</g>
<!-- post_io.get_timestamp -->
<g id="node41" class="node">
<title>post_io.get_timestamp</title>
<g id="a_node41"><a xlink:title="Return ``meta[&#39;date&#39;]`` as a timezone&#45;aware ``datetime``.">
<polygon fill="none" stroke="black" points="7661.5,-3539.85 7318.5,-3539.85 7318.5,-3499.85 7661.5,-3499.85 7661.5,-3539.85"/>
<text text-anchor="middle" x="7490" y="-3512.78" font-family="Times,serif" font-size="28.84">post_io.get_timestamp</text>
</a>
</g>
</g>
<!-- notes_utils.read_md&#45;&gt;notes_utils.read_text -->
<g id="edge277" class="edge">
<title>notes_utils.read_md&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M9447.62,-1895.15C9522.53,-1888.9 9640.27,-1892.19 9707,-1960.85 10017.16,-2280 10012.3,-3843.99 10009.87,-4074.46"/>
<polygon fill="black" stroke="black" points="10006.37,-4074.66 10009.76,-4084.7 10013.37,-4074.74 10006.37,-4074.66"/>
</g>
<!-- post_io.write_post -->
<g id="node44" class="node">
<title>post_io.write_post</title>
<g id="a_node44"><a xlink:title="Write metadata and body as a Markdown post.">
<polygon fill="none" stroke="black" points="6552,-3547.85 6220,-3547.85 6220,-3501.85 6552,-3501.85 6552,-3547.85"/>
<text text-anchor="middle" x="6386" y="-3516.41" font-family="Times,serif" font-size="34.30">post_io.write_post</text>
</a>
</g>
</g>
<!-- post_io.write_post&#45;&gt;post_io.get_contact -->
<g id="edge46" class="edge">
<title>post_io.write_post&#45;&gt;post_io.get_contact</title>
<path fill="none" stroke="black" d="M6552.28,-3532.5C6780.64,-3543.07 7186.37,-3561.84 7380.13,-3570.81"/>
<polygon fill="black" stroke="black" points="7380.18,-3574.32 7390.33,-3571.28 7380.5,-3567.32 7380.18,-3574.32"/>
</g>
<!-- post_io.write_post&#45;&gt;post_io.get_timestamp -->
<g id="edge47" class="edge">
<title>post_io.write_post&#45;&gt;post_io.get_timestamp</title>
<path fill="none" stroke="black" d="M6552.28,-3524.1C6755.28,-3523.18 7098.43,-3521.62 7308.25,-3520.67"/>
<polygon fill="black" stroke="black" points="7308.47,-3524.17 7318.45,-3520.62 7308.44,-3517.17 7308.47,-3524.17"/>
</g>
<!-- notes_utils.write_md -->
<g id="node45" class="node">
<title>notes_utils.write_md</title>
<g id="a_node45"><a xlink:title="Write ``text`` to ``path`` ensuring a trailing newline.">
<polygon fill="none" stroke="black" points="7603,-3481.85 7377,-3481.85 7377,-3445.85 7603,-3445.85 7603,-3481.85"/>
<text text-anchor="middle" x="7490" y="-3459.06" font-family="Times,serif" font-size="19.74">notes_utils.write_md</text>
</a>
</g>
</g>
<!-- post_io.write_post&#45;&gt;notes_utils.write_md -->
<g id="edge48" class="edge">
<title>post_io.write_post&#45;&gt;notes_utils.write_md</title>
<path fill="none" stroke="black" d="M6552.09,-3514.3C6663.14,-3507.33 6812.84,-3498.16 6945,-3490.85 7089.89,-3482.84 7256.55,-3474.73 7366.82,-3469.52"/>
<polygon fill="black" stroke="black" points="7367.16,-3473.01 7376.98,-3469.04 7366.83,-3466.02 7367.16,-3473.01"/>
</g>
<!-- post_io.raw_post_path_from_lot -->
<g id="node46" class="node">
<title>post_io.raw_post_path_from_lot</title>
<g id="a_node46"><a xlink:title="Return raw post path referenced by ``lot`` or ``None``.">
<polygon fill="none" stroke="black" points="7635,-3295.85 7345,-3295.85 7345,-3259.85 7635,-3259.85 7635,-3295.85"/>
<text text-anchor="middle" x="7490" y="-3273.69" font-family="Times,serif" font-size="17.08">post_io.raw_post_path_from_lot</text>
</a>
</g>
</g>
<!-- post_io.raw_post_path_from_lot&#45;&gt;post_io.raw_post_path -->
<g id="edge49" class="edge">
<title>post_io.raw_post_path_from_lot&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7635.19,-3260.19C7748.55,-3252.36 7907.98,-3254.98 8035,-3309.85 8055.2,-3318.58 8050.84,-3335.03 8071,-3343.85 8195.88,-3398.49 8357.41,-3395.5 8454.77,-3386.79"/>
<polygon fill="black" stroke="black" points="8455.23,-3390.26 8464.86,-3385.85 8454.58,-3383.29 8455.23,-3390.26"/>
</g>
<!-- price_utils.canonical_currency -->
<g id="node47" class="node">
<title>price_utils.canonical_currency</title>
<g id="a_node47"><a xlink:title="Return canonical currency code or ``None`` when unknown.">
<polygon fill="none" stroke="black" points="9557,-175.85 9198,-175.85 9198,-139.85 9557,-139.85 9557,-175.85"/>
<text text-anchor="middle" x="9377.5" y="-152.15" font-family="Times,serif" font-size="22.12">price_utils.canonical_currency</text>
</a>
</g>
</g>
<!-- price_utils.fetch_official_rates -->
<g id="node48" class="node">
<title>price_utils.fetch_official_rates</title>
<g id="a_node48"><a xlink:title="Return currency multipliers relative to USD from NBG.">
<polygon fill="none" stroke="black" points="6703.5,-246.35 6068.5,-246.35 6068.5,-193.35 6703.5,-193.35 6703.5,-246.35"/>
<text text-anchor="middle" x="6386" y="-209.65" font-family="Times,serif" font-size="40.88">price_utils.fetch_official_rates</text>
</a>
</g>
</g>
<!-- price_utils.train_price_regression -->
<g id="node49" class="node">
<title>price_utils.train_price_regression</title>
<g id="a_node49"><a xlink:title="Return ``(model, currency_map, counts)`` trained on ``lots``.&#10;&#10;``lots`` must contain ``price`` and ``price:currency`` fields. Only lots with&#10;embeddings present in ``id_to_vec`` are considered. Prices are regressed on&#10;the logarithm scale so coefficients are interpretable as multiplicative&#10;factors. ``USD`` is treated as the base currency so coefficients can be&#10;interpreted as exchange rate multipliers. The returned ``counts`` dictionary&#10;maps each currency to the number of training samples observed.">
<polygon fill="none" stroke="black" points="8035,-450.35 6945,-450.35 6945,-373.35 8035,-373.35 8035,-450.35"/>
<text text-anchor="middle" x="7490" y="-395.95" font-family="Times,serif" font-size="63.00">price_utils.train_price_regression</text>
</a>
</g>
</g>
<!-- price_utils.train_price_regression&#45;&gt;price_utils.canonical_currency -->
<g id="edge50" class="edge">
<title>price_utils.train_price_regression&#45;&gt;price_utils.canonical_currency</title>
<path fill="none" stroke="black" d="M8035.34,-390.44C8327.15,-371.87 8691.6,-337.26 9012,-272.85 9123.99,-250.34 9250.2,-206.1 9320.85,-179.53"/>
<polygon fill="black" stroke="black" points="9322.33,-182.72 9330.45,-175.91 9319.85,-176.17 9322.33,-182.72"/>
</g>
<!-- price_utils.save_price_model -->
<g id="node50" class="node">
<title>price_utils.save_price_model</title>
<g id="a_node50"><a xlink:title="Write ``model`` parameters to ``path`` as JSON.">
<polygon fill="none" stroke="black" points="8754,-2336.35 8329,-2336.35 8329,-2297.35 8754,-2297.35 8754,-2336.35"/>
<text text-anchor="middle" x="8541.5" y="-2309.95" font-family="Times,serif" font-size="28.00">price_utils.save_price_model</text>
</a>
</g>
</g>
<!-- price_utils.save_price_model&#45;&gt;notes_utils.write_json -->
<g id="edge51" class="edge">
<title>price_utils.save_price_model&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M8754.03,-2328.26C8920.01,-2337.22 9143.88,-2349.3 9272.97,-2356.26"/>
<polygon fill="black" stroke="black" points="9273.07,-2359.77 9283.25,-2356.82 9273.45,-2352.78 9273.07,-2359.77"/>
</g>
<!-- price_utils.load_price_model -->
<g id="node51" class="node">
<title>price_utils.load_price_model</title>
<g id="a_node51"><a xlink:title="Return ``(model, currencies, counts)`` loaded from ``path``.">
<polygon fill="none" stroke="black" points="8776,-3925.85 8307,-3925.85 8307,-3883.85 8776,-3883.85 8776,-3925.85"/>
<text text-anchor="middle" x="8541.5" y="-3896.76" font-family="Times,serif" font-size="31.36">price_utils.load_price_model</text>
</a>
</g>
</g>
<!-- price_utils.load_price_model&#45;&gt;notes_utils.load_json -->
<g id="edge52" class="edge">
<title>price_utils.load_price_model&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M8776.29,-3915.7C8851.65,-3920.29 8935.47,-3926.54 9012,-3934.85 9097.26,-3944.1 9193.09,-3959.01 9265.09,-3971.11"/>
<polygon fill="black" stroke="black" points="9264.64,-3974.59 9275.08,-3972.8 9265.81,-3967.68 9264.64,-3974.59"/>
</g>
<!-- notes_utils.load_json&#45;&gt;notes_utils.read_text -->
<g id="edge280" class="edge">
<title>notes_utils.load_json&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M9480.23,-4008.91C9594.55,-4029.2 9779.56,-4062.04 9897.8,-4083.02"/>
<polygon fill="black" stroke="black" points="9897.51,-4086.53 9907.97,-4084.83 9898.73,-4079.63 9897.51,-4086.53"/>
</g>
<!-- price_utils.predict_price -->
<g id="node53" class="node">
<title>price_utils.predict_price</title>
<g id="a_node53"><a xlink:title="Return predicted price for ``vec`` in ``currency``.&#10;&#10;When ``model`` is ``None`` or ``vec`` is missing, ``None`` is returned.">
<polygon fill="none" stroke="black" points="7695,-316.35 7285,-316.35 7285,-273.35 7695,-273.35 7695,-316.35"/>
<text text-anchor="middle" x="7490" y="-286.7" font-family="Times,serif" font-size="32.06">price_utils.predict_price</text>
</a>
</g>
</g>
<!-- price_utils.currency_rates -->
<g id="node54" class="node">
<title>price_utils.currency_rates</title>
<g id="a_node54"><a xlink:title="Return estimated currency multipliers relative to the base.&#10;&#10;The regression model learns one coefficient per currency dummy feature. &#160;The&#10;coefficient is the logarithm of the multiplier relative to USD.">
<polygon fill="none" stroke="black" points="8735,-264.35 8348,-264.35 8348,-225.35 8735,-225.35 8735,-264.35"/>
<text text-anchor="middle" x="8541.5" y="-237.95" font-family="Times,serif" font-size="28.00">price_utils.currency_rates</text>
</a>
</g>
</g>
<!-- price_utils.guess_currency -->
<g id="node55" class="node">
<title>price_utils.guess_currency</title>
<g id="a_node55"><a xlink:title="Return currency with multiplier closest to ``price/pred_usd``.&#10;&#10;``pred_usd`` is the predicted price in USD. &#160;``price`` is the numeric value&#10;provided by the user without a currency. &#160;The function compares the implied&#10;multiplier ``price / pred_usd`` against the learnt exchange rates and picks&#10;the closest match. &#160;``counts`` may be provided to ignore rarely seen&#10;currencies when guessing. &#160;Any currency with fewer than ``min_samples``&#10;samples in the training set is skipped.">
<polygon fill="none" stroke="black" points="10278,-369.85 9743,-369.85 9743,-319.85 10278,-319.85 10278,-369.85"/>
<text text-anchor="middle" x="10010.5" y="-335.16" font-family="Times,serif" font-size="38.36">price_utils.guess_currency</text>
</a>
</g>
</g>
<!-- price_utils._guess_currency_verified -->
<g id="node56" class="node">
<title>price_utils._guess_currency_verified</title>
<g id="a_node56"><a xlink:title="Return currency when both AI and official rates agree.">
<polygon fill="none" stroke="black" points="9634,-363.85 9121,-363.85 9121,-325.85 9634,-325.85 9634,-363.85"/>
<text text-anchor="middle" x="9377.5" y="-338.12" font-family="Times,serif" font-size="27.16">price_utils._guess_currency_verified</text>
</a>
</g>
</g>
<!-- price_utils._guess_currency_verified&#45;&gt;price_utils.guess_currency -->
<g id="edge53" class="edge">
<title>price_utils._guess_currency_verified&#45;&gt;price_utils.guess_currency</title>
<path fill="none" stroke="black" d="M9634.24,-344.85C9666.67,-344.85 9699.98,-344.85 9732.72,-344.85"/>
<polygon fill="black" stroke="black" points="9732.86,-348.35 9742.86,-344.85 9732.86,-341.35 9732.86,-348.35"/>
</g>
<!-- price_utils.apply_price_model -->
<g id="node57" class="node">
<title>price_utils.apply_price_model</title>
<g id="a_node57"><a xlink:title="Predict prices in USD and guess missing currencies.">
<polygon fill="none" stroke="black" points="6746.5,-374.35 6025.5,-374.35 6025.5,-315.35 6746.5,-315.35 6746.5,-374.35"/>
<text text-anchor="middle" x="6386" y="-333.17" font-family="Times,serif" font-size="46.48">price_utils.apply_price_model</text>
</a>
</g>
</g>
<!-- price_utils.apply_price_model&#45;&gt;price_utils.train_price_regression -->
<g id="edge54" class="edge">
<title>price_utils.apply_price_model&#45;&gt;price_utils.train_price_regression</title>
<path fill="none" stroke="black" d="M6746.69,-366.72C6806.9,-370.38 6870.59,-374.25 6934.34,-378.13"/>
<polygon fill="black" stroke="black" points="6934.38,-381.64 6944.57,-378.75 6934.8,-374.65 6934.38,-381.64"/>
</g>
<!-- price_utils.apply_price_model&#45;&gt;price_utils.predict_price -->
<g id="edge55" class="edge">
<title>price_utils.apply_price_model&#45;&gt;price_utils.predict_price</title>
<path fill="none" stroke="black" d="M6746.69,-328.53C6921.19,-320.61 7124.92,-311.37 7274.76,-304.57"/>
<polygon fill="black" stroke="black" points="7275.17,-308.06 7285,-304.11 7274.85,-301.06 7275.17,-308.06"/>
</g>
<!-- price_utils.apply_price_model&#45;&gt;price_utils.currency_rates -->
<g id="edge56" class="edge">
<title>price_utils.apply_price_model&#45;&gt;price_utils.currency_rates</title>
<path fill="none" stroke="black" d="M6746.66,-330.18C6802.1,-321.13 6857.87,-307.92 6909,-288.85 6927.25,-282.04 6926.45,-269.78 6945,-263.85 7074.04,-222.59 7937.56,-233.29 8337.67,-240.64"/>
<polygon fill="black" stroke="black" points="8337.85,-244.14 8347.91,-240.83 8337.98,-237.14 8337.85,-244.14"/>
</g>
<!-- price_utils.apply_price_model&#45;&gt;price_utils._guess_currency_verified -->
<g id="edge57" class="edge">
<title>price_utils.apply_price_model&#45;&gt;price_utils._guess_currency_verified</title>
<path fill="none" stroke="black" d="M6746.86,-344.85C7355.12,-344.85 8572.72,-344.85 9110.6,-344.85"/>
<polygon fill="black" stroke="black" points="9110.83,-348.35 9120.83,-344.85 9110.83,-341.35 9110.83,-348.35"/>
</g>
<!-- price_utils.prepare_price_fields -->
<g id="node58" class="node">
<title>price_utils.prepare_price_fields</title>
<g id="a_node58"><a xlink:title="Add display price helpers to ``lots``.&#10;&#10;``rates`` maps currency codes to multipliers relative to USD and&#10;``cur`` is the display currency. ``_display_price`` is a formatted&#10;string in ``cur``. ``_usd_value`` stores the numeric USD value so&#10;the front&#45;end can switch currencies without rebuilding the site.&#10;Prices predicted by AI get ``_price_class`` set to ``ai&#45;price`` for&#10;styling.">
<polygon fill="none" stroke="black" points="8911.5,-129.85 8171.5,-129.85 8171.5,-71.85 8911.5,-71.85 8911.5,-129.85"/>
<text text-anchor="middle" x="8541.5" y="-89.56" font-family="Times,serif" font-size="45.36">price_utils.prepare_price_fields</text>
</a>
</g>
</g>
<!-- price_utils.prepare_price_fields&#45;&gt;price_utils.canonical_currency -->
<g id="edge58" class="edge">
<title>price_utils.prepare_price_fields&#45;&gt;price_utils.canonical_currency</title>
<path fill="none" stroke="black" d="M8911.64,-126.08C9006.94,-132.59 9105.63,-139.34 9187.42,-144.93"/>
<polygon fill="black" stroke="black" points="9187.6,-148.45 9197.82,-145.64 9188.08,-141.46 9187.6,-148.45"/>
</g>
<!-- price_train._iter_lots -->
<g id="node59" class="node">
<title>price_train._iter_lots</title>
<g id="a_node59"><a xlink:title="Return all lots with generated ids.">
<polygon fill="none" stroke="black" points="7645.5,-2474.35 7334.5,-2474.35 7334.5,-2435.35 7645.5,-2435.35 7645.5,-2474.35"/>
<text text-anchor="middle" x="7490" y="-2447.95" font-family="Times,serif" font-size="28.00">price_train._iter_lots</text>
</a>
</g>
</g>
<!-- price_train._iter_lots&#45;&gt;lot_io.read_lots -->
<g id="edge59" class="edge">
<title>price_train._iter_lots&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M7645.78,-2462.69C7754.66,-2468.31 7903.76,-2476.2 8035,-2483.85 8169.02,-2491.66 8322.97,-2501.54 8425.41,-2508.24"/>
<polygon fill="black" stroke="black" points="8425.27,-2511.73 8435.47,-2508.9 8425.72,-2504.75 8425.27,-2511.73"/>
</g>
<!-- lot_io.iter_lot_files -->
<g id="node60" class="node">
<title>lot_io.iter_lot_files</title>
<g id="a_node60"><a xlink:title="Return ``*.json`` files under ``root``.&#10;&#10;When ``newest_first`` is ``True`` the result is ordered by modification&#10;time with the most recently changed files first. &#160;Both ``build_site.py`` and&#10;``pending_embed.py`` rely on this helper so they scan the lot directory in&#10;the same order.">
<polygon fill="none" stroke="black" points="8670,-2679.35 8413,-2679.35 8413,-2642.35 8670,-2642.35 8670,-2679.35"/>
<text text-anchor="middle" x="8541.5" y="-2654.41" font-family="Times,serif" font-size="26.18">lot_io.iter_lot_files</text>
</a>
</g>
</g>
<!-- price_train._iter_lots&#45;&gt;lot_io.iter_lot_files -->
<g id="edge60" class="edge">
<title>price_train._iter_lots&#45;&gt;lot_io.iter_lot_files</title>
<path fill="none" stroke="black" d="M7645.53,-2443.26C7785.32,-2436.24 7977.77,-2436.28 8035,-2483.85 8087.39,-2527.4 8018.75,-2589.14 8071,-2632.85 8119.7,-2673.59 8282.47,-2675.16 8402.76,-2670.13"/>
<polygon fill="black" stroke="black" points="8402.96,-2673.62 8412.8,-2669.69 8402.66,-2666.63 8402.96,-2673.62"/>
</g>
<!-- price_train.main -->
<g id="node61" class="node">
<title>price_train.main</title>
<g id="a_node61"><a xlink:title="Train price regression model and save it.">
<polygon fill="none" stroke="black" points="6501,-2376.85 6271,-2376.85 6271,-2340.85 6501,-2340.85 6501,-2376.85"/>
<text text-anchor="middle" x="6386" y="-2352.69" font-family="Times,serif" font-size="25.20">price_train.main</text>
</a>
</g>
</g>
<!-- price_train.main&#45;&gt;similar_utils._load_embeddings -->
<g id="edge64" class="edge">
<title>price_train.main&#45;&gt;similar_utils._load_embeddings</title>
<path fill="none" stroke="black" d="M6501.06,-2376.61C6625.28,-2402.66 6818.34,-2464.28 6909,-2603.85 6962.97,-2686.93 6875.3,-4316.44 6945,-4386.85 6987.62,-4429.9 7974.46,-4417.5 8035,-4419.85 8112.93,-4422.88 8197.59,-4426.69 8274.95,-4430.38"/>
<polygon fill="black" stroke="black" points="8275.17,-4433.9 8285.32,-4430.88 8275.5,-4426.91 8275.17,-4433.9"/>
</g>
<!-- price_train.main&#45;&gt;price_utils.train_price_regression -->
<g id="edge61" class="edge">
<title>price_train.main&#45;&gt;price_utils.train_price_regression</title>
<path fill="none" stroke="black" d="M6466.19,-2376.92C6582.64,-2398.25 6798.21,-2416.83 6909,-2293.85 6977.21,-2218.13 6875.45,-534.33 6945,-459.85 7034.3,-364.23 7185.39,-357.75 7305.72,-372.09"/>
<polygon fill="black" stroke="black" points="7305.43,-375.58 7315.79,-373.35 7306.3,-368.64 7305.43,-375.58"/>
</g>
<!-- price_train.main&#45;&gt;price_utils.save_price_model -->
<g id="edge62" class="edge">
<title>price_train.main&#45;&gt;price_utils.save_price_model</title>
<path fill="none" stroke="black" d="M6501.12,-2361.81C6609.94,-2360.73 6776.42,-2348.73 6909,-2293.85 6927.73,-2286.1 6925.83,-2272.43 6945,-2265.85 7403.22,-2108.63 7551.17,-2241.5 8035,-2265.85 8149.55,-2271.61 8278.16,-2284.68 8376.98,-2296.14"/>
<polygon fill="black" stroke="black" points="8376.72,-2299.64 8387.05,-2297.32 8377.53,-2292.68 8376.72,-2299.64"/>
</g>
<!-- price_train.main&#45;&gt;price_train._iter_lots -->
<g id="edge63" class="edge">
<title>price_train.main&#45;&gt;price_train._iter_lots</title>
<path fill="none" stroke="black" d="M6501.04,-2368.78C6696.91,-2385.85 7097.96,-2420.78 7324.22,-2440.49"/>
<polygon fill="black" stroke="black" points="7323.92,-2443.98 7334.19,-2441.36 7324.53,-2437.01 7323.92,-2443.98"/>
</g>
<!-- similar_utils._sync_embeddings -->
<g id="node62" class="node">
<title>similar_utils._sync_embeddings</title>
<g id="a_node62"><a xlink:title="Drop lots or vectors that do not match and return cleaned data.">
<polygon fill="none" stroke="black" points="7728.5,-2378.85 7251.5,-2378.85 7251.5,-2338.85 7728.5,-2338.85 7728.5,-2378.85"/>
<text text-anchor="middle" x="7490" y="-2351.78" font-family="Times,serif" font-size="28.84">similar_utils._sync_embeddings</text>
</a>
</g>
</g>
<!-- price_train.main&#45;&gt;similar_utils._sync_embeddings -->
<g id="edge65" class="edge">
<title>price_train.main&#45;&gt;similar_utils._sync_embeddings</title>
<path fill="none" stroke="black" d="M6501.04,-2358.85C6674.68,-2358.85 7009.57,-2358.85 7240.98,-2358.85"/>
<polygon fill="black" stroke="black" points="7241.23,-2362.35 7251.23,-2358.85 7241.23,-2355.35 7241.23,-2362.35"/>
</g>
<!-- similar._iter_lots -->
<g id="node63" class="node">
<title>similar._iter_lots</title>
<g id="a_node63"><a xlink:title="Return lots filtered by moderation rules.">
<polygon fill="none" stroke="black" points="7644,-2829.35 7336,-2829.35 7336,-2782.35 7644,-2782.35 7644,-2829.35"/>
<text text-anchor="middle" x="7490" y="-2797.35" font-family="Times,serif" font-size="35.00">similar._iter_lots</text>
</a>
</g>
</g>
<!-- similar._iter_lots&#45;&gt;post_io.read_post -->
<g id="edge66" class="edge">
<title>similar._iter_lots&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7644.14,-2818.43C7785.92,-2826.34 7982.5,-2826.55 8035,-2772.85 8108.46,-2697.72 7999.03,-1904.41 8071,-1827.85 8117.93,-1777.93 8184.31,-1755.61 8252.42,-1748.19"/>
<polygon fill="black" stroke="black" points="8252.87,-1751.66 8262.48,-1747.2 8252.18,-1744.7 8252.87,-1751.66"/>
</g>
<!-- similar._iter_lots&#45;&gt;post_io.raw_post_path -->
<g id="edge67" class="edge">
<title>similar._iter_lots&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7644.24,-2815.06C7769.25,-2831.24 7940.15,-2874.8 8035,-2990.85 8114.68,-3088.34 7986.09,-3178.88 8071,-3271.85 8168.22,-3378.3 8347.9,-3388.46 8454.57,-3383.8"/>
<polygon fill="black" stroke="black" points="8454.84,-3387.29 8464.66,-3383.3 8454.5,-3380.3 8454.84,-3387.29"/>
</g>
<!-- similar._iter_lots&#45;&gt;lot_io.read_lots -->
<g id="edge70" class="edge">
<title>similar._iter_lots&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M7644.17,-2816.79C7784.6,-2823.33 7978.95,-2822.4 8035,-2772.85 8100.7,-2714.77 8007.46,-2639.29 8071,-2578.85 8164.23,-2490.17 8318.87,-2486.36 8425.03,-2496.79"/>
<polygon fill="black" stroke="black" points="8424.84,-2500.29 8435.15,-2497.85 8425.56,-2493.33 8424.84,-2500.29"/>
</g>
<!-- similar._iter_lots&#45;&gt;moderation.should_skip_message -->
<g id="edge68" class="edge">
<title>similar._iter_lots&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M7644.3,-2818.58C7786.19,-2826.61 7982.86,-2826.9 8035,-2772.85 8091.56,-2714.21 8015.41,-1366.41 8071,-1306.85 8170.03,-1200.75 8357.06,-1220.5 8462.71,-1242.68"/>
<polygon fill="black" stroke="black" points="8462.17,-1246.14 8472.68,-1244.83 8463.64,-1239.3 8462.17,-1246.14"/>
</g>
<!-- similar._iter_lots&#45;&gt;lot_io.iter_lot_files -->
<g id="edge71" class="edge">
<title>similar._iter_lots&#45;&gt;lot_io.iter_lot_files</title>
<path fill="none" stroke="black" d="M7644.23,-2814.02C7782.81,-2818.33 7974.16,-2815.66 8035,-2772.85 8068.22,-2749.47 8037.77,-2712.21 8071,-2688.85 8122.68,-2652.52 8283.42,-2649.88 8402.5,-2653.47"/>
<polygon fill="black" stroke="black" points="8402.69,-2656.98 8412.8,-2653.8 8402.92,-2649.98 8402.69,-2656.98"/>
</g>
<!-- moderation.should_skip_lot -->
<g id="node64" class="node">
<title>moderation.should_skip_lot</title>
<g id="a_node64"><a xlink:title="Return ``True`` when the lot fails additional checks.">
<polygon fill="none" stroke="black" points="8679.5,-2623.85 8403.5,-2623.85 8403.5,-2587.85 8679.5,-2587.85 8679.5,-2623.85"/>
<text text-anchor="middle" x="8541.5" y="-2601.07" font-family="Times,serif" font-size="18.48">moderation.should_skip_lot</text>
</a>
</g>
</g>
<!-- similar._iter_lots&#45;&gt;moderation.should_skip_lot -->
<g id="edge69" class="edge">
<title>similar._iter_lots&#45;&gt;moderation.should_skip_lot</title>
<path fill="none" stroke="black" d="M7644.11,-2815.97C7783.94,-2821.84 7977.39,-2820.38 8035,-2772.85 8084.56,-2731.96 8021.38,-2673.66 8071,-2632.85 8182.37,-2541.25 8363.54,-2563.19 8465.19,-2585.61"/>
<polygon fill="black" stroke="black" points="8464.55,-2589.05 8475.08,-2587.84 8466.1,-2582.22 8464.55,-2589.05"/>
</g>
<!-- moderation.lot_skip_reason -->
<g id="node75" class="node">
<title>moderation.lot_skip_reason</title>
<g id="a_node75"><a xlink:title="Return the moderation reason for ``lot`` or ``None``.">
<polygon fill="none" stroke="black" points="9554,-3131.85 9201,-3131.85 9201,-3095.85 9554,-3095.85 9554,-3131.85"/>
<text text-anchor="middle" x="9377.5" y="-3107.97" font-family="Times,serif" font-size="24.22">moderation.lot_skip_reason</text>
</a>
</g>
</g>
<!-- moderation.should_skip_lot&#45;&gt;moderation.lot_skip_reason -->
<g id="edge84" class="edge">
<title>moderation.should_skip_lot&#45;&gt;moderation.lot_skip_reason</title>
<path fill="none" stroke="black" d="M8601.06,-2587.83C8700.51,-2561.26 8902.29,-2525.5 9012,-2632.85 9084.33,-2703.63 8976.54,-3015.18 9048,-3086.85 9069.24,-3108.15 9128.43,-3116.51 9190.82,-3118.96"/>
<polygon fill="black" stroke="black" points="9190.74,-3122.46 9200.86,-3119.31 9190.98,-3115.47 9190.74,-3122.46"/>
</g>
<!-- similar.main -->
<g id="node65" class="node">
<title>similar.main</title>
<g id="a_node65"><a xlink:title="Update ``data/similar`` using available embeddings.">
<polygon fill="none" stroke="black" points="6491,-4380.85 6281,-4380.85 6281,-4338.85 6491,-4338.85 6491,-4380.85"/>
<text text-anchor="middle" x="6386" y="-4351.76" font-family="Times,serif" font-size="31.36">similar.main</text>
</a>
</g>
</g>
<!-- similar.main&#45;&gt;similar_utils._load_embeddings -->
<g id="edge73" class="edge">
<title>similar.main&#45;&gt;similar_utils._load_embeddings</title>
<path fill="none" stroke="black" d="M6442.15,-4380.85C6541.1,-4417.28 6756.08,-4490.78 6945,-4516.85 7064.97,-4533.41 7919.76,-4554.11 8035,-4516.85 8053.78,-4510.78 8052.55,-4497.85 8071,-4490.85 8134.97,-4466.58 8207.17,-4453.14 8275.42,-4446.05"/>
<polygon fill="black" stroke="black" points="8275.86,-4449.53 8285.46,-4445.05 8275.16,-4442.56 8275.86,-4449.53"/>
</g>
<!-- similar.main&#45;&gt;similar_utils._sync_embeddings -->
<g id="edge79" class="edge">
<title>similar.main&#45;&gt;similar_utils._sync_embeddings</title>
<path fill="none" stroke="black" d="M6454.21,-4338.82C6571.22,-4298.17 6809.4,-4196.59 6909,-4016.85 6951.85,-3939.52 6885.68,-2491.41 6945,-2425.85 6985.17,-2381.45 7117.3,-2364.51 7241.27,-2358.76"/>
<polygon fill="black" stroke="black" points="7241.49,-2362.26 7251.33,-2358.32 7241.18,-2355.27 7241.49,-2362.26"/>
</g>
<!-- similar.main&#45;&gt;similar._iter_lots -->
<g id="edge72" class="edge">
<title>similar.main&#45;&gt;similar._iter_lots</title>
<path fill="none" stroke="black" d="M6453.98,-4338.7C6570.64,-4297.85 6808.28,-4195.96 6909,-4016.85 6964.91,-3917.42 6876.97,-3082.41 6945,-2990.85 7032.69,-2872.84 7199.72,-2829.39 7325.67,-2813.77"/>
<polygon fill="black" stroke="black" points="7326.29,-2817.22 7335.81,-2812.56 7325.46,-2810.27 7326.29,-2817.22"/>
</g>
<!-- similar_utils._load_similar -->
<g id="node66" class="node">
<title>similar_utils._load_similar</title>
<g id="a_node66"><a xlink:title="Return cached similar lots mapping.">
<polygon fill="none" stroke="black" points="7739,-4147.85 7241,-4147.85 7241,-4099.85 7739,-4099.85 7739,-4147.85"/>
<text text-anchor="middle" x="7490" y="-4114.73" font-family="Times,serif" font-size="36.40">similar_utils._load_similar</text>
</a>
</g>
</g>
<!-- similar.main&#45;&gt;similar_utils._load_similar -->
<g id="edge74" class="edge">
<title>similar.main&#45;&gt;similar_utils._load_similar</title>
<path fill="none" stroke="black" d="M6431.28,-4338.72C6524.05,-4295.6 6746.67,-4198.04 6945,-4156.85 7037.08,-4137.73 7139.67,-4128.48 7230.73,-4124.32"/>
<polygon fill="black" stroke="black" points="7231.08,-4127.81 7240.92,-4123.87 7230.77,-4120.82 7231.08,-4127.81"/>
</g>
<!-- similar_utils._save_similar -->
<g id="node67" class="node">
<title>similar_utils._save_similar</title>
<g id="a_node67"><a xlink:title="Write ``sim_map`` to ``SIMILAR_DIR`` mirroring ``LOTS_DIR`` layout.">
<polygon fill="none" stroke="black" points="7638,-4377.85 7342,-4377.85 7342,-4341.85 7638,-4341.85 7638,-4377.85"/>
<text text-anchor="middle" x="7490" y="-4354.55" font-family="Times,serif" font-size="21.00">similar_utils._save_similar</text>
</a>
</g>
</g>
<!-- similar.main&#45;&gt;similar_utils._save_similar -->
<g id="edge75" class="edge">
<title>similar.main&#45;&gt;similar_utils._save_similar</title>
<path fill="none" stroke="black" d="M6491.17,-4359.85C6685.19,-4359.85 7102.91,-4359.85 7331.55,-4359.85"/>
<polygon fill="black" stroke="black" points="7331.62,-4363.35 7341.62,-4359.85 7331.62,-4356.35 7331.62,-4363.35"/>
</g>
<!-- similar_utils._save_more_user -->
<g id="node68" class="node">
<title>similar_utils._save_more_user</title>
<g id="a_node68"><a xlink:title="Write ``more_map`` to ``MORE_USER_DIR`` mirroring ``LOTS_DIR`` layout.">
<polygon fill="none" stroke="black" points="7657.5,-4323.85 7322.5,-4323.85 7322.5,-4287.85 7657.5,-4287.85 7657.5,-4323.85"/>
<text text-anchor="middle" x="7490" y="-4300.55" font-family="Times,serif" font-size="21.00">similar_utils._save_more_user</text>
</a>
</g>
</g>
<!-- similar.main&#45;&gt;similar_utils._save_more_user -->
<g id="edge76" class="edge">
<title>similar.main&#45;&gt;similar_utils._save_more_user</title>
<path fill="none" stroke="black" d="M6491.17,-4354.74C6679.77,-4345.5 7079.75,-4325.9 7311.96,-4314.52"/>
<polygon fill="black" stroke="black" points="7312.38,-4318.01 7322.2,-4314.02 7312.04,-4311.02 7312.38,-4318.01"/>
</g>
<!-- similar_utils._prune_similar -->
<g id="node69" class="node">
<title>similar_utils._prune_similar</title>
<g id="a_node69"><a xlink:title="Drop cache entries referring to ids not in ``valid_ids``.">
<polygon fill="none" stroke="black" points="7629,-4507.85 7351,-4507.85 7351,-4471.85 7629,-4471.85 7629,-4507.85"/>
<text text-anchor="middle" x="7490" y="-4485.07" font-family="Times,serif" font-size="18.48">similar_utils._prune_similar</text>
</a>
</g>
</g>
<!-- similar.main&#45;&gt;similar_utils._prune_similar -->
<g id="edge77" class="edge">
<title>similar.main&#45;&gt;similar_utils._prune_similar</title>
<path fill="none" stroke="black" d="M6486.28,-4380.85C6597.47,-4403.54 6783.32,-4438.96 6945,-4457.85 7078.38,-4473.43 7231.1,-4481.57 7340.7,-4485.73"/>
<polygon fill="black" stroke="black" points="7340.71,-4489.24 7350.84,-4486.11 7340.97,-4482.24 7340.71,-4489.24"/>
</g>
<!-- similar_utils._calc_similar_nn -->
<g id="node70" class="node">
<title>similar_utils._calc_similar_nn</title>
<g id="a_node70"><a xlink:title="Fill ``sim_map`` for ``new_ids`` using a nearest neighbour search.&#10;&#10;``vec_ids`` lists all lots that have an embedding. &#160;``new_ids`` is a subset&#10;for which we still need recommendations. &#160;We gather vectors for&#10;``vec_ids`` and use ``NearestNeighbors`` from scikit&#45;learn to find the&#10;closest items. &#160;Embeddings of lots without a vector are skipped.">
<polygon fill="none" stroke="black" points="8998.5,-4717.35 8084.5,-4717.35 8084.5,-4642.35 8998.5,-4642.35 8998.5,-4717.35"/>
<text text-anchor="middle" x="8541.5" y="-4664.85" font-family="Times,serif" font-size="60.62">similar_utils._calc_similar_nn</text>
</a>
</g>
</g>
<!-- similar.main&#45;&gt;similar_utils._calc_similar_nn -->
<g id="edge78" class="edge">
<title>similar.main&#45;&gt;similar_utils._calc_similar_nn</title>
<path fill="none" stroke="black" d="M6411.44,-4380.98C6485.45,-4443.39 6716.08,-4626.39 6945,-4688.85 7149.67,-4744.7 7680.65,-4730.49 8074.16,-4710.07"/>
<polygon fill="black" stroke="black" points="8074.5,-4713.55 8084.3,-4709.54 8074.14,-4706.56 8074.5,-4713.55"/>
</g>
<!-- similar_utils._similar_by_user -->
<g id="node71" class="node">
<title>similar_utils._similar_by_user</title>
<g id="a_node71"><a xlink:title="Return map of lot id to other lots from the same user.">
<polygon fill="none" stroke="black" points="9707,-4773.35 9048,-4773.35 9048,-4718.35 9707,-4718.35 9707,-4773.35"/>
<text text-anchor="middle" x="9377.5" y="-4734.85" font-family="Times,serif" font-size="43.12">similar_utils._similar_by_user</text>
</a>
</g>
</g>
<!-- similar.main&#45;&gt;similar_utils._similar_by_user -->
<g id="edge80" class="edge">
<title>similar.main&#45;&gt;similar_utils._similar_by_user</title>
<path fill="none" stroke="black" d="M6408.99,-4381.11C6479.54,-4447.66 6709.33,-4651.73 6945,-4722.85 7139.49,-4781.55 8416.23,-4764.98 9037.73,-4753.14"/>
<polygon fill="black" stroke="black" points="9037.81,-4756.64 9047.74,-4752.95 9037.67,-4749.64 9037.81,-4756.64"/>
</g>
<!-- similar_utils._load_similar&#45;&gt;notes_utils.load_json -->
<g id="edge159" class="edge">
<title>similar_utils._load_similar&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M7739.08,-4135.04C8041.36,-4144.69 8566.85,-4148.57 9012,-4085.85 9119.77,-4070.67 9241.46,-4035.08 9313.43,-4012.03"/>
<polygon fill="black" stroke="black" points="9314.81,-4015.26 9323.25,-4008.86 9312.66,-4008.6 9314.81,-4015.26"/>
</g>
<!-- similar_utils._save_similar&#45;&gt;notes_utils.write_json -->
<g id="edge163" class="edge">
<title>similar_utils._save_similar&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M7638.17,-4373.95C7780.36,-4383.95 7981.81,-4387.31 8035,-4332.85 8142.48,-4222.8 7963.3,-3058.69 8071,-2948.85 8144.28,-2874.12 8937.11,-2978.97 9012,-2905.85 9094.4,-2825.39 8967.07,-2470.79 9048,-2388.85 9110.92,-2325.14 9219.65,-2329.23 9294.68,-2342.03"/>
<polygon fill="black" stroke="black" points="9294.12,-2345.49 9304.58,-2343.8 9295.35,-2338.6 9294.12,-2345.49"/>
</g>
<!-- similar_utils._similar_path -->
<g id="node115" class="node">
<title>similar_utils._similar_path</title>
<g id="a_node115"><a xlink:title="Return cache file path for ``lot_path`` under ``SIMILAR_DIR``.">
<polygon fill="none" stroke="black" points="8643.5,-4395.85 8439.5,-4395.85 8439.5,-4359.85 8643.5,-4359.85 8643.5,-4395.85"/>
<text text-anchor="middle" x="8541.5" y="-4374.15" font-family="Times,serif" font-size="14.00">similar_utils._similar_path</text>
</a>
</g>
</g>
<!-- similar_utils._save_similar&#45;&gt;similar_utils._similar_path -->
<g id="edge161" class="edge">
<title>similar_utils._save_similar&#45;&gt;similar_utils._similar_path</title>
<path fill="none" stroke="black" d="M7638.03,-4362.37C7850.58,-4366.02 8238.99,-4372.68 8429.35,-4375.94"/>
<polygon fill="black" stroke="black" points="8429.32,-4379.44 8439.38,-4376.12 8429.44,-4372.44 8429.32,-4379.44"/>
</g>
<!-- lot_io.lot_json_path -->
<g id="node118" class="node">
<title>lot_io.lot_json_path</title>
<g id="a_node118"><a xlink:title="Return full JSON path for ``lot_id`` given ``root`` directory.">
<polygon fill="none" stroke="black" points="8618,-4341.85 8465,-4341.85 8465,-4305.85 8618,-4305.85 8618,-4341.85"/>
<text text-anchor="middle" x="8541.5" y="-4320.15" font-family="Times,serif" font-size="14.00">lot_io.lot_json_path</text>
</a>
</g>
</g>
<!-- similar_utils._save_similar&#45;&gt;lot_io.lot_json_path -->
<g id="edge162" class="edge">
<title>similar_utils._save_similar&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M7638.03,-4354.81C7860.5,-4347.17 8275.63,-4332.93 8454.68,-4326.79"/>
<polygon fill="black" stroke="black" points="8454.96,-4330.29 8464.83,-4326.44 8454.72,-4323.29 8454.96,-4330.29"/>
</g>
<!-- similar_utils._save_more_user&#45;&gt;notes_utils.write_json -->
<g id="edge166" class="edge">
<title>similar_utils._save_more_user&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M7657.72,-4321.25C7798.19,-4330.12 7984.2,-4330.84 8035,-4278.85 8140.88,-4170.49 7965.2,-3024.28 8071,-2915.85 8144.11,-2840.92 8937.09,-2940.98 9012,-2867.85 9088.38,-2793.28 8972.78,-2464.59 9048,-2388.85 9111,-2325.41 9219.45,-2329.35 9294.42,-2342.05"/>
<polygon fill="black" stroke="black" points="9293.85,-2345.51 9304.31,-2343.81 9295.07,-2338.61 9293.85,-2345.51"/>
</g>
<!-- similar_utils._more_user_path -->
<g id="node116" class="node">
<title>similar_utils._more_user_path</title>
<g id="a_node116"><a xlink:title="Return cache file path for ``lot_path`` under ``MORE_USER_DIR``.">
<polygon fill="none" stroke="black" points="8656.5,-4287.85 8426.5,-4287.85 8426.5,-4251.85 8656.5,-4251.85 8656.5,-4287.85"/>
<text text-anchor="middle" x="8541.5" y="-4266.15" font-family="Times,serif" font-size="14.00">similar_utils._more_user_path</text>
</a>
</g>
</g>
<!-- similar_utils._save_more_user&#45;&gt;similar_utils._more_user_path -->
<g id="edge164" class="edge">
<title>similar_utils._save_more_user&#45;&gt;similar_utils._more_user_path</title>
<path fill="none" stroke="black" d="M7657.59,-4300.14C7868.64,-4292.9 8227.54,-4280.58 8416.19,-4274.11"/>
<polygon fill="black" stroke="black" points="8416.55,-4277.6 8426.43,-4273.76 8416.31,-4270.61 8416.55,-4277.6"/>
</g>
<!-- similar_utils._save_more_user&#45;&gt;lot_io.lot_json_path -->
<g id="edge165" class="edge">
<title>similar_utils._save_more_user&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M7657.59,-4308.71C7884.05,-4312.59 8280.76,-4319.39 8454.68,-4322.38"/>
<polygon fill="black" stroke="black" points="8454.75,-4325.88 8464.81,-4322.55 8454.87,-4318.88 8454.75,-4325.88"/>
</g>
<!-- similar_utils._update_reciprocal -->
<g id="node119" class="node">
<title>similar_utils._update_reciprocal</title>
<g id="a_node119"><a xlink:title="Insert ``lot_id`` into caches of lots listed in ``sims`` if closer.">
<polygon fill="none" stroke="black" points="9618.5,-4699.85 9136.5,-4699.85 9136.5,-4659.85 9618.5,-4659.85 9618.5,-4699.85"/>
<text text-anchor="middle" x="9377.5" y="-4672.78" font-family="Times,serif" font-size="28.84">similar_utils._update_reciprocal</text>
</a>
</g>
</g>
<!-- similar_utils._calc_similar_nn&#45;&gt;similar_utils._update_reciprocal -->
<g id="edge167" class="edge">
<title>similar_utils._calc_similar_nn&#45;&gt;similar_utils._update_reciprocal</title>
<path fill="none" stroke="black" d="M8998.54,-4679.85C9042.37,-4679.85 9085.62,-4679.85 9126.32,-4679.85"/>
<polygon fill="black" stroke="black" points="9126.34,-4683.35 9136.34,-4679.85 9126.34,-4676.35 9126.34,-4683.35"/>
</g>
<!-- moderation.should_skip_text -->
<g id="node72" class="node">
<title>moderation.should_skip_text</title>
<g id="a_node72"><a xlink:title="Return ``True`` if ``text`` contains banned phrases.">
<polygon fill="none" stroke="black" points="10154.5,-1414.85 9866.5,-1414.85 9866.5,-1378.85 10154.5,-1378.85 10154.5,-1414.85"/>
<text text-anchor="middle" x="10010.5" y="-1392.07" font-family="Times,serif" font-size="18.48">moderation.should_skip_text</text>
</a>
</g>
</g>
<!-- moderation.should_skip_user -->
<g id="node73" class="node">
<title>moderation.should_skip_user</title>
<g id="a_node73"><a xlink:title="Return ``True`` if ``username`` is blacklisted.">
<polygon fill="none" stroke="black" points="10134.5,-1534.85 9886.5,-1534.85 9886.5,-1498.85 10134.5,-1498.85 10134.5,-1534.85"/>
<text text-anchor="middle" x="10010.5" y="-1512.81" font-family="Times,serif" font-size="15.68">moderation.should_skip_user</text>
</a>
</g>
</g>
<!-- moderation.message_skip_reason&#45;&gt;moderation.should_skip_text -->
<g id="edge81" class="edge">
<title>moderation.message_skip_reason&#45;&gt;moderation.should_skip_text</title>
<path fill="none" stroke="black" d="M9615.26,-1434.34C9695.92,-1426.67 9783.91,-1418.3 9856.26,-1411.42"/>
<polygon fill="black" stroke="black" points="9856.74,-1414.89 9866.37,-1410.46 9856.08,-1407.92 9856.74,-1414.89"/>
</g>
<!-- moderation.message_skip_reason&#45;&gt;moderation.should_skip_user -->
<g id="edge82" class="edge">
<title>moderation.message_skip_reason&#45;&gt;moderation.should_skip_user</title>
<path fill="none" stroke="black" d="M9615.26,-1479.36C9703.44,-1487.75 9800.4,-1496.97 9876.09,-1504.16"/>
<polygon fill="black" stroke="black" points="9875.87,-1507.66 9886.16,-1505.12 9876.53,-1500.69 9875.87,-1507.66"/>
</g>
<!-- moderation.apply_to_history -->
<g id="node77" class="node">
<title>moderation.apply_to_history</title>
<g id="a_node77"><a xlink:title="Remove processed lots now failing moderation.">
<polygon fill="none" stroke="black" points="7746,-2320.85 7234,-2320.85 7234,-2274.85 7746,-2274.85 7746,-2320.85"/>
<text text-anchor="middle" x="7490" y="-2289.41" font-family="Times,serif" font-size="34.30">moderation.apply_to_history</text>
</a>
</g>
</g>
<!-- moderation.apply_to_history&#45;&gt;post_io.read_post -->
<g id="edge86" class="edge">
<title>moderation.apply_to_history&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7746.02,-2289.59C7850.62,-2272.55 7963.67,-2234.02 8035,-2150.85 8129.04,-2041.21 7968.29,-1929.41 8071,-1827.85 8119.06,-1780.32 8184.92,-1758.55 8252.11,-1750.87"/>
<polygon fill="black" stroke="black" points="8252.88,-1754.31 8262.46,-1749.8 8252.15,-1747.34 8252.88,-1754.31"/>
</g>
<!-- moderation.apply_to_history&#45;&gt;post_io.raw_post_path -->
<g id="edge87" class="edge">
<title>moderation.apply_to_history&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7746.33,-2281.13C7867.37,-2279.29 7994.32,-2288.33 8035,-2329.85 8108.3,-2404.67 8003.88,-3191.43 8071,-3271.85 8163.76,-3382.99 8346.28,-3391.29 8454.39,-3385.07"/>
<polygon fill="black" stroke="black" points="8454.85,-3388.54 8464.61,-3384.42 8454.41,-3381.56 8454.85,-3388.54"/>
</g>
<!-- moderation.apply_to_history&#45;&gt;lot_io.read_lots -->
<g id="edge90" class="edge">
<title>moderation.apply_to_history&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M7746.2,-2284.41C7865.5,-2283.68 7990.9,-2292.71 8035,-2329.85 8088.76,-2375.13 8017.45,-2438.32 8071,-2483.85 8180.03,-2576.55 8359.67,-2557.37 8462.24,-2536.02"/>
<polygon fill="black" stroke="black" points="8463.18,-2539.4 8472.23,-2533.88 8461.72,-2532.55 8463.18,-2539.4"/>
</g>
<!-- moderation.apply_to_history&#45;&gt;moderation.should_skip_message -->
<g id="edge88" class="edge">
<title>moderation.apply_to_history&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M7746.3,-2292.24C7852.11,-2275.85 7966.02,-2237.08 8035,-2150.85 8093.64,-2077.56 8006.34,-1374.89 8071,-1306.85 8170.58,-1202.08 8356.12,-1220.89 8461.69,-1242.66"/>
<polygon fill="black" stroke="black" points="8461.14,-1246.12 8471.65,-1244.77 8462.59,-1239.28 8461.14,-1246.12"/>
</g>
<!-- moderation.apply_to_history&#45;&gt;moderation.should_skip_lot -->
<g id="edge89" class="edge">
<title>moderation.apply_to_history&#45;&gt;moderation.should_skip_lot</title>
<path fill="none" stroke="black" d="M7746.06,-2283.31C7865.96,-2282.21 7991.95,-2291.24 8035,-2329.85 8106.48,-2393.95 8001.97,-2476.13 8071,-2542.85 8164.23,-2632.96 8320.71,-2635.97 8427.16,-2624.99"/>
<polygon fill="black" stroke="black" points="8427.74,-2628.45 8437.31,-2623.89 8426.99,-2621.49 8427.74,-2628.45"/>
</g>
<!-- tg_client._mark_activity -->
<g id="node78" class="node">
<title>tg_client._mark_activity</title>
<g id="a_node78"><a xlink:title="Update ``_last_event`` to the current time.">
<polygon fill="none" stroke="black" points="5088.5,-3838.85 4902.5,-3838.85 4902.5,-3802.85 5088.5,-3802.85 5088.5,-3838.85"/>
<text text-anchor="middle" x="4995.5" y="-3817.15" font-family="Times,serif" font-size="14.00">tg_client._mark_activity</text>
</a>
</g>
</g>
<!-- tg_client._heartbeat -->
<g id="node79" class="node">
<title>tg_client._heartbeat</title>
<g id="a_node79"><a xlink:title="Periodically log a heartbeat and warn if idle for too long.">
<polygon fill="none" stroke="black" points="1490.5,-4136.85 1260.5,-4136.85 1260.5,-4100.85 1490.5,-4100.85 1490.5,-4136.85"/>
<text text-anchor="middle" x="1375.5" y="-4113.55" font-family="Times,serif" font-size="21.00">tg_client._heartbeat</text>
</a>
</g>
</g>
<!-- tg_client._progress_logger -->
<g id="node80" class="node">
<title>tg_client._progress_logger</title>
<g id="a_node80"><a xlink:title="Return a progress callback that logs received bytes.">
<polygon fill="none" stroke="black" points="5179,-3708.35 4812,-3708.35 4812,-3671.35 5179,-3671.35 5179,-3708.35"/>
<text text-anchor="middle" x="4995.5" y="-3683.41" font-family="Times,serif" font-size="26.18">tg_client._progress_logger</text>
</a>
</g>
</g>
<!-- tg_client._write_md -->
<g id="node81" class="node">
<title>tg_client._write_md</title>
<g id="a_node81"><a xlink:title="Helper to store a raw post in Markdown format.">
<polygon fill="none" stroke="black" points="5620,-3497.85 5483,-3497.85 5483,-3461.85 5620,-3461.85 5620,-3497.85"/>
<text text-anchor="middle" x="5551.5" y="-3476.61" font-family="Times,serif" font-size="12.18">tg_client._write_md</text>
</a>
</g>
</g>
<!-- tg_client._write_md&#45;&gt;post_io.write_post -->
<g id="edge91" class="edge">
<title>tg_client._write_md&#45;&gt;post_io.write_post</title>
<path fill="none" stroke="black" d="M5620.27,-3483.51C5747.62,-3490.4 6026.3,-3505.46 6209.73,-3515.38"/>
<polygon fill="black" stroke="black" points="6209.58,-3518.87 6219.76,-3515.92 6209.96,-3511.88 6209.58,-3518.87"/>
</g>
<!-- tg_client._scan_group_cache -->
<g id="node82" class="node">
<title>tg_client._scan_group_cache</title>
<g id="a_node82"><a xlink:title="Build group_id &#45;&gt; Path mapping for ``chat`` quickly.">
<polygon fill="none" stroke="black" points="7729.5,-3693.35 7250.5,-3693.35 7250.5,-3650.35 7729.5,-3650.35 7729.5,-3693.35"/>
<text text-anchor="middle" x="7490" y="-3663.7" font-family="Times,serif" font-size="32.06">tg_client._scan_group_cache</text>
</a>
</g>
</g>
<!-- tg_client._scan_group_cache&#45;&gt;post_io.raw_post_path -->
<g id="edge92" class="edge">
<title>tg_client._scan_group_cache&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7591.65,-3693.38C7708.73,-3712.51 7902.79,-3725.27 8035,-3635.85 8065.63,-3615.13 8043.93,-3586.03 8071,-3560.85 8180.26,-3459.21 8351.97,-3410.92 8454.66,-3389.99"/>
<polygon fill="black" stroke="black" points="8455.56,-3393.38 8464.68,-3387.99 8454.19,-3386.51 8455.56,-3393.38"/>
</g>
<!-- tg_client._find_group_path -->
<g id="node83" class="node">
<title>tg_client._find_group_path</title>
<g id="a_node83"><a xlink:title="Return stored message path for ``group_id`` if known.">
<polygon fill="none" stroke="black" points="6519,-3696.85 6253,-3696.85 6253,-3660.85 6519,-3660.85 6519,-3696.85"/>
<text text-anchor="middle" x="6386" y="-3674.07" font-family="Times,serif" font-size="18.48">tg_client._find_group_path</text>
</a>
</g>
</g>
<!-- tg_client._find_group_path&#45;&gt;tg_client._scan_group_cache -->
<g id="edge93" class="edge">
<title>tg_client._find_group_path&#45;&gt;tg_client._scan_group_cache</title>
<path fill="none" stroke="black" d="M6519.11,-3678.01C6696.85,-3676.88 7016.47,-3674.85 7240.06,-3673.43"/>
<polygon fill="black" stroke="black" points="7240.32,-3676.93 7250.3,-3673.37 7240.27,-3669.93 7240.32,-3676.93"/>
</g>
<!-- tg_client._get_message_path -->
<g id="node84" class="node">
<title>tg_client._get_message_path</title>
<g id="a_node84"><a xlink:title="Return path of stored message ``msg_id`` in ``chat`` if any.">
<polygon fill="none" stroke="black" points="3380,-3357.85 3141,-3357.85 3141,-3321.85 3380,-3321.85 3380,-3357.85"/>
<text text-anchor="middle" x="3260.5" y="-3335.81" font-family="Times,serif" font-size="15.68">tg_client._get_message_path</text>
</a>
</g>
</g>
<!-- tg_client._get_message_path&#45;&gt;post_io.raw_post_path -->
<g id="edge94" class="edge">
<title>tg_client._get_message_path&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M3380.21,-3338.92C3660.9,-3336.82 4387.49,-3331.85 4994.5,-3331.85 4994.5,-3331.85 4994.5,-3331.85 5552.5,-3331.85 6701.35,-3331.85 8098.4,-3364.77 8454.65,-3373.66"/>
<polygon fill="black" stroke="black" points="8454.8,-3377.17 8464.89,-3373.92 8454.98,-3370.17 8454.8,-3377.17"/>
</g>
<!-- tg_client._should_skip_media -->
<g id="node85" class="node">
<title>tg_client._should_skip_media</title>
<g id="a_node85"><a xlink:title="Return reason string if ``msg`` media should be skipped.">
<polygon fill="none" stroke="black" points="5240,-3614.35 4751,-3614.35 4751,-3571.35 5240,-3571.35 5240,-3614.35"/>
<text text-anchor="middle" x="4995.5" y="-3584.7" font-family="Times,serif" font-size="32.06">tg_client._should_skip_media</text>
</a>
</g>
</g>
<!-- tg_client._allowed_topic -->
<g id="node86" class="node">
<title>tg_client._allowed_topic</title>
<g id="a_node86"><a xlink:title="Return ``True`` if ``msg`` belongs to an allowed forum topic.">
<polygon fill="none" stroke="black" points="5763.5,-3665.35 5339.5,-3665.35 5339.5,-3620.35 5763.5,-3620.35 5763.5,-3665.35"/>
<text text-anchor="middle" x="5551.5" y="-3634.47" font-family="Times,serif" font-size="33.60">tg_client._allowed_topic</text>
</a>
</g>
</g>
<!-- tg_client._extract_author -->
<g id="node87" class="node">
<title>tg_client._extract_author</title>
<g id="a_node87"><a xlink:title="Return a metadata dictionary describing the message author.">
<polygon fill="none" stroke="black" points="6749,-3483.85 6023,-3483.85 6023,-3413.85 6749,-3413.85 6749,-3483.85"/>
<text text-anchor="middle" x="6386" y="-3435.05" font-family="Times,serif" font-size="56.00">tg_client._extract_author</text>
</a>
</g>
</g>
<!-- phone_utils.format_georgian -->
<g id="node88" class="node">
<title>phone_utils.format_georgian</title>
<g id="a_node88"><a xlink:title="Return ``phone`` in ``+995...`` format if possible.">
<polygon fill="none" stroke="black" points="7696,-3427.85 7284,-3427.85 7284,-3389.85 7696,-3389.85 7696,-3427.85"/>
<text text-anchor="middle" x="7490" y="-3402.12" font-family="Times,serif" font-size="27.16">phone_utils.format_georgian</text>
</a>
</g>
</g>
<!-- tg_client._extract_author&#45;&gt;phone_utils.format_georgian -->
<g id="edge95" class="edge">
<title>tg_client._extract_author&#45;&gt;phone_utils.format_georgian</title>
<path fill="none" stroke="black" d="M6749.36,-3435.7C6922.75,-3429.4 7124.49,-3422.08 7273.44,-3416.67"/>
<polygon fill="black" stroke="black" points="7273.75,-3420.16 7283.62,-3416.3 7273.5,-3413.17 7273.75,-3420.16"/>
</g>
<!-- tg_client._schedule_caption -->
<g id="node89" class="node">
<title>tg_client._schedule_caption</title>
<g id="a_node89"><a xlink:title="Run captioning in a separate process so downloads continue.">
<polygon fill="none" stroke="black" points="5690.5,-3216.85 5412.5,-3216.85 5412.5,-3180.85 5690.5,-3180.85 5690.5,-3216.85"/>
<text text-anchor="middle" x="5551.5" y="-3194.07" font-family="Times,serif" font-size="18.48">tg_client._schedule_caption</text>
</a>
</g>
</g>
<!-- tg_client._schedule_chop -->
<g id="node90" class="node">
<title>tg_client._schedule_chop</title>
<g id="a_node90"><a xlink:title="Run lot extraction in a separate process.">
<polygon fill="none" stroke="black" points="8689.5,-1622.85 8393.5,-1622.85 8393.5,-1586.85 8689.5,-1586.85 8689.5,-1622.85"/>
<text text-anchor="middle" x="8541.5" y="-1599.15" font-family="Times,serif" font-size="22.12">tg_client._schedule_chop</text>
</a>
</g>
</g>
<!-- tg_client._enqueue_chop -->
<g id="node91" class="node">
<title>tg_client._enqueue_chop</title>
<g id="a_node91"><a xlink:title="Queue ``path`` for chopping once captions are available.">
<polygon fill="none" stroke="black" points="5238,-1603.35 4753,-1603.35 4753,-1554.35 5238,-1554.35 5238,-1603.35"/>
<text text-anchor="middle" x="4995.5" y="-1569.22" font-family="Times,serif" font-size="37.66">tg_client._enqueue_chop</text>
</a>
</g>
</g>
<!-- tg_client._enqueue_chop&#45;&gt;moderation.should_skip_message -->
<g id="edge96" class="edge">
<title>tg_client._enqueue_chop&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M5071.13,-1554.32C5127.47,-1531.64 5201.44,-1492.07 5240,-1430.85 5282.96,-1362.63 5220.3,-1128.13 5276,-1069.85 5793.94,-527.96 6197.36,-880.99 6945,-826.85 7186.59,-809.35 7855.01,-664.76 8035,-826.85 8091.95,-878.14 8019.33,-1113.25 8071,-1169.85 8143.78,-1249.57 8263.6,-1272.33 8363.98,-1275.41"/>
<polygon fill="black" stroke="black" points="8364.17,-1278.92 8374.25,-1275.66 8364.34,-1271.92 8364.17,-1278.92"/>
</g>
<!-- tg_client._enqueue_chop&#45;&gt;caption_io.has_caption -->
<g id="edge98" class="edge">
<title>tg_client._enqueue_chop&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M5238.14,-1577.93C5250.94,-1577.9 5263.63,-1577.87 5276,-1577.85 5429.28,-1577.58 7919.15,-1477.49 8035,-1577.85 8119.85,-1651.35 7988.3,-1751.94 8071,-1827.85 8124.84,-1877.27 8333,-1870.77 8453.3,-1862.4"/>
<polygon fill="black" stroke="black" points="8453.86,-1865.87 8463.59,-1861.66 8453.37,-1858.88 8453.86,-1865.87"/>
</g>
<!-- tg_client._start_chop_worker -->
<g id="node92" class="node">
<title>tg_client._start_chop_worker</title>
<g id="a_node92"><a xlink:title="Ensure the chop queue worker task is running.">
<polygon fill="none" stroke="black" points="5684.5,-1622.85 5418.5,-1622.85 5418.5,-1586.85 5684.5,-1586.85 5684.5,-1622.85"/>
<text text-anchor="middle" x="5551.5" y="-1600.69" font-family="Times,serif" font-size="17.08">tg_client._start_chop_worker</text>
</a>
</g>
</g>
<!-- tg_client._enqueue_chop&#45;&gt;tg_client._start_chop_worker -->
<g id="edge97" class="edge">
<title>tg_client._enqueue_chop&#45;&gt;tg_client._start_chop_worker</title>
<path fill="none" stroke="black" d="M5238.28,-1590.2C5296.19,-1592.91 5356.19,-1595.73 5407.93,-1598.16"/>
<polygon fill="black" stroke="black" points="5408.01,-1601.67 5418.16,-1598.64 5408.34,-1594.67 5408.01,-1601.67"/>
</g>
<!-- tg_client._chop_worker -->
<g id="node93" class="node">
<title>tg_client._chop_worker</title>
<g id="a_node93"><a xlink:title="Background task processing ``_CHOP_QUEUE``.">
<polygon fill="none" stroke="black" points="6511.5,-1622.85 6260.5,-1622.85 6260.5,-1586.85 6511.5,-1586.85 6511.5,-1622.85"/>
<text text-anchor="middle" x="6386" y="-1600.06" font-family="Times,serif" font-size="19.74">tg_client._chop_worker</text>
</a>
</g>
</g>
<!-- tg_client._start_chop_worker&#45;&gt;tg_client._chop_worker -->
<g id="edge99" class="edge">
<title>tg_client._start_chop_worker&#45;&gt;tg_client._chop_worker</title>
<path fill="none" stroke="black" d="M5684.87,-1604.85C5839.64,-1604.85 6094.4,-1604.85 6250.2,-1604.85"/>
<polygon fill="black" stroke="black" points="6250.31,-1608.35 6260.31,-1604.85 6250.31,-1601.35 6250.31,-1608.35"/>
</g>
<!-- tg_client._process_chop_queue -->
<g id="node94" class="node">
<title>tg_client._process_chop_queue</title>
<g id="a_node94"><a xlink:title="Check queued posts and chop cooled down ones.">
<polygon fill="none" stroke="black" points="7671.5,-1622.85 7308.5,-1622.85 7308.5,-1586.85 7671.5,-1586.85 7671.5,-1622.85"/>
<text text-anchor="middle" x="7490" y="-1599.15" font-family="Times,serif" font-size="22.12">tg_client._process_chop_queue</text>
</a>
</g>
</g>
<!-- tg_client._chop_worker&#45;&gt;tg_client._process_chop_queue -->
<g id="edge102" class="edge">
<title>tg_client._chop_worker&#45;&gt;tg_client._process_chop_queue</title>
<path fill="none" stroke="black" d="M6511.54,-1604.85C6703.32,-1604.85 7072.35,-1604.85 7298.04,-1604.85"/>
<polygon fill="black" stroke="black" points="7298.35,-1608.35 7308.35,-1604.85 7298.35,-1601.35 7298.35,-1608.35"/>
</g>
<!-- tg_client._process_chop_queue&#45;&gt;caption_io.has_caption -->
<g id="edge101" class="edge">
<title>tg_client._process_chop_queue&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M7582.51,-1586.85C7702.2,-1569.02 7911.19,-1558.41 8035,-1669.85 8088.53,-1718.03 8016.01,-1781.34 8071,-1827.85 8126.72,-1874.99 8333.61,-1869.45 8453.34,-1861.83"/>
<polygon fill="black" stroke="black" points="8453.83,-1865.3 8463.58,-1861.16 8453.38,-1858.32 8453.83,-1865.3"/>
</g>
<!-- tg_client._process_chop_queue&#45;&gt;tg_client._schedule_chop -->
<g id="edge100" class="edge">
<title>tg_client._process_chop_queue&#45;&gt;tg_client._schedule_chop</title>
<path fill="none" stroke="black" d="M7671.71,-1604.85C7872.28,-1604.85 8192.73,-1604.85 8383.29,-1604.85"/>
<polygon fill="black" stroke="black" points="8383.39,-1608.35 8393.39,-1604.85 8383.39,-1601.35 8383.39,-1608.35"/>
</g>
<!-- tg_client._flush_chop_queue -->
<g id="node95" class="node">
<title>tg_client._flush_chop_queue</title>
<g id="a_node95"><a xlink:title="Run the chop worker until the queue is empty and cancel it.">
<polygon fill="none" stroke="black" points="2253,-1707.85 1768,-1707.85 1768,-1663.85 2253,-1663.85 2253,-1707.85"/>
<text text-anchor="middle" x="2010.5" y="-1677.53" font-family="Times,serif" font-size="32.90">tg_client._flush_chop_queue</text>
</a>
</g>
</g>
<!-- tg_client._flush_chop_queue&#45;&gt;tg_client._process_chop_queue -->
<g id="edge103" class="edge">
<title>tg_client._flush_chop_queue&#45;&gt;tg_client._process_chop_queue</title>
<path fill="none" stroke="black" d="M2253.02,-1675.06C2504.38,-1664.78 2909.45,-1650.85 3259.5,-1650.85 3259.5,-1650.85 3259.5,-1650.85 5552.5,-1650.85 6155.45,-1650.85 6306.33,-1650.09 6909,-1631.85 7038.96,-1627.92 7185.2,-1621.09 7298.32,-1615.29"/>
<polygon fill="black" stroke="black" points="7298.66,-1618.78 7308.47,-1614.77 7298.3,-1611.78 7298.66,-1618.78"/>
</g>
<!-- tg_client._get_id_date -->
<g id="node96" class="node">
<title>tg_client._get_id_date</title>
<g id="a_node96"><a xlink:title="Return the stored date for ``msg_id`` in ``chat`` if available.">
<polygon fill="none" stroke="black" points="7662,-4207.35 7318,-4207.35 7318,-4166.35 7662,-4166.35 7662,-4207.35"/>
<text text-anchor="middle" x="7490" y="-4179.61" font-family="Times,serif" font-size="29.68">tg_client._get_id_date</text>
</a>
</g>
</g>
<!-- tg_client._get_id_date&#45;&gt;post_io.raw_post_path -->
<g id="edge104" class="edge">
<title>tg_client._get_id_date&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7662.34,-4200.63C7801.57,-4207.75 7983.08,-4206.4 8035,-4156.85 8092.04,-4102.41 8035.53,-3874.27 8071,-3803.85 8170.86,-3605.6 8403.88,-3454.54 8498.98,-3399"/>
<polygon fill="black" stroke="black" points="8500.84,-3401.96 8507.74,-3393.92 8497.33,-3395.9 8500.84,-3401.96"/>
</g>
<!-- tg_client._get_id_date&#45;&gt;notes_utils.read_text -->
<g id="edge105" class="edge">
<title>tg_client._get_id_date&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M7662.08,-4192.56C8034.63,-4203.14 8946.92,-4219.06 9707,-4151.85 9775.13,-4145.83 9851.12,-4133.49 9909.9,-4122.71"/>
<polygon fill="black" stroke="black" points="9910.72,-4126.12 9919.92,-4120.85 9909.45,-4119.23 9910.72,-4126.12"/>
</g>
<!-- tg_client._load_progress -->
<g id="node97" class="node">
<title>tg_client._load_progress</title>
<g id="a_node97"><a xlink:title="Return saved resume timestamp for ``chat`` if available.">
<polygon fill="none" stroke="black" points="4272,-4446.85 3942,-4446.85 3942,-4410.85 4272,-4410.85 4272,-4446.85"/>
<text text-anchor="middle" x="4107" y="-4422.69" font-family="Times,serif" font-size="25.20">tg_client._load_progress</text>
</a>
</g>
</g>
<!-- tg_client._load_progress&#45;&gt;notes_utils.read_text -->
<g id="edge106" class="edge">
<title>tg_client._load_progress&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M4149.56,-4446.94C4319.62,-4519.28 4980.53,-4783.85 5550.5,-4783.85 5550.5,-4783.85 5550.5,-4783.85 6387,-4783.85 6479.22,-4783.85 9629.67,-4832.09 9707,-4781.85 9944.5,-4627.55 9997.11,-4238.79 10007.29,-4130.97"/>
<polygon fill="black" stroke="black" points="10010.78,-4131.14 10008.19,-4120.87 10003.81,-4130.52 10010.78,-4131.14"/>
</g>
<!-- tg_client._save_progress -->
<g id="node98" class="node">
<title>tg_client._save_progress</title>
<g id="a_node98"><a xlink:title="Persist resume timestamp for ``chat`` to ``STATE_DIR``.">
<polygon fill="none" stroke="black" points="2770,-3976.85 2541,-3976.85 2541,-3940.85 2770,-3940.85 2770,-3976.85"/>
<text text-anchor="middle" x="2655.5" y="-3954.69" font-family="Times,serif" font-size="17.08">tg_client._save_progress</text>
</a>
</g>
</g>
<!-- tg_client.get_first_id -->
<g id="node99" class="node">
<title>tg_client.get_first_id</title>
<g id="a_node99"><a xlink:title="Return the smallest saved message id for ``chat``.">
<polygon fill="none" stroke="black" points="3394,-3838.85 3127,-3838.85 3127,-3802.85 3394,-3802.85 3394,-3838.85"/>
<text text-anchor="middle" x="3260.5" y="-3814.97" font-family="Times,serif" font-size="24.22">tg_client.get_first_id</text>
</a>
</g>
</g>
<!-- tg_client.get_first_id&#45;&gt;post_io.raw_post_path -->
<g id="edge107" class="edge">
<title>tg_client.get_first_id&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M3394.09,-3814.93C3684.19,-3802.51 4397.07,-3774.85 4994.5,-3774.85 4994.5,-3774.85 4994.5,-3774.85 5552.5,-3774.85 5586.99,-3774.85 8009.55,-3725.13 8035,-3701.85 8135.06,-3610.31 7971.84,-3491.36 8071,-3398.85 8179.71,-3297.42 8371.47,-3328.71 8473.02,-3355.19"/>
<polygon fill="black" stroke="black" points="8472.29,-3358.61 8482.86,-3357.81 8474.1,-3351.85 8472.29,-3358.61"/>
</g>
<!-- tg_client.get_last_id -->
<g id="node100" class="node">
<title>tg_client.get_last_id</title>
<g id="a_node100"><a xlink:title="Return the highest saved message id for ``chat``.">
<polygon fill="none" stroke="black" points="2141,-3930.85 1880,-3930.85 1880,-3894.85 2141,-3894.85 2141,-3930.85"/>
<text text-anchor="middle" x="2010.5" y="-3906.97" font-family="Times,serif" font-size="24.22">tg_client.get_last_id</text>
</a>
</g>
</g>
<!-- tg_client.get_last_id&#45;&gt;post_io.raw_post_path -->
<g id="edge108" class="edge">
<title>tg_client.get_last_id&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M2141.28,-3915.22C2870.53,-3927.95 6442.02,-3982.54 6909,-3839.85 6927.16,-3834.3 6926.88,-3822.53 6945,-3816.85 7060.65,-3780.57 7946.92,-3857.11 8035,-3773.85 8095.84,-3716.34 8010.44,-3456.65 8071,-3398.85 8178.84,-3295.93 8371.83,-3328.18 8473.54,-3355.1"/>
<polygon fill="black" stroke="black" points="8472.83,-3358.53 8483.39,-3357.76 8474.66,-3351.77 8472.83,-3358.53"/>
</g>
<!-- tg_client._save_message -->
<g id="node101" class="node">
<title>tg_client._save_message</title>
<g id="a_node101"><a xlink:title="Write ``msg`` to disk with metadata and any media references.&#10;&#10;Returns the path of the stored message or ``None`` when skipped.">
<polygon fill="none" stroke="black" points="4715,-3581.35 3499,-3581.35 3499,-3466.35 4715,-3466.35 4715,-3581.35"/>
<text text-anchor="middle" x="4107" y="-3499.73" font-family="Times,serif" font-size="97.02">tg_client._save_message</text>
</a>
</g>
</g>
<!-- tg_client._save_message&#45;&gt;post_io.read_post -->
<g id="edge110" class="edge">
<title>tg_client._save_message&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M4133.76,-3466.1C4227.8,-3252.78 4555.42,-2487.1 4715,-1822.85 4729.55,-1762.28 4705.83,-1587.75 4751,-1544.85 4880.2,-1422.12 5372.3,-1482.85 5550.5,-1482.85 5550.5,-1482.85 5550.5,-1482.85 6387,-1482.85 6570.19,-1482.85 7886.98,-1421.93 8035,-1529.85 8073.84,-1558.17 8036.47,-1598.4 8071,-1631.85 8124.79,-1683.95 8196.72,-1717.84 8268.08,-1739.88"/>
<polygon fill="black" stroke="black" points="8267.1,-1743.24 8277.69,-1742.78 8269.12,-1736.54 8267.1,-1743.24"/>
</g>
<!-- tg_client._save_message&#45;&gt;post_io.raw_post_path -->
<g id="edge111" class="edge">
<title>tg_client._save_message&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M4715.08,-3544.81C5053.02,-3556.08 5481.32,-3569.7 5863,-3579.85 5983.63,-3583.06 7942.55,-3680.41 8035,-3602.85 8105.53,-3543.67 8001.94,-3459.73 8071,-3398.85 8181.49,-3301.45 8369.56,-3329.96 8470.89,-3355.25"/>
<polygon fill="black" stroke="black" points="8470.17,-3358.68 8480.72,-3357.76 8471.9,-3351.89 8470.17,-3358.68"/>
</g>
<!-- tg_client._save_message&#45;&gt;post_io.get_contact -->
<g id="edge109" class="edge">
<title>tg_client._save_message&#45;&gt;post_io.get_contact</title>
<path fill="none" stroke="black" d="M4715.01,-3522C4884.91,-3522.72 5069.69,-3524.65 5240,-3528.85 5517.08,-3535.69 5585.94,-3549.01 5863,-3556.85 6434.23,-3573.02 7118.71,-3575.5 7380.2,-3575.83"/>
<polygon fill="black" stroke="black" points="7380.45,-3579.33 7390.46,-3575.84 7380.46,-3572.33 7380.45,-3579.33"/>
</g>
<!-- tg_client._save_message&#45;&gt;moderation.should_skip_user -->
<g id="edge112" class="edge">
<title>tg_client._save_message&#45;&gt;moderation.should_skip_user</title>
<path fill="none" stroke="black" d="M4110.59,-3466.13C4129.13,-3130.22 4272,-1419.63 5276,-766.85 5504.45,-618.32 5594.16,-634.32 5863,-589.85 6101.24,-550.44 7816.16,-615.94 8035,-513.85 8056.68,-503.74 8049.15,-483.58 8071,-473.85 8453.05,-303.7 8595.67,-434.08 9012,-473.85 9325.15,-503.76 9501.81,-369.41 9707,-607.85 9770.9,-682.11 9675.97,-1417.4 9743,-1488.85 9783,-1531.49 9847.96,-1539.01 9903.72,-1535.62"/>
<polygon fill="black" stroke="black" points="9904.3,-1539.09 9914.02,-1534.87 9903.79,-1532.11 9904.3,-1539.09"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._mark_activity -->
<g id="edge113" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._mark_activity</title>
<path fill="none" stroke="black" d="M4401.31,-3581.44C4505.56,-3610.28 4620.42,-3652.17 4715,-3711.85 4734.95,-3724.44 4730.92,-3738.47 4751,-3750.85 4793.73,-3777.2 4846.75,-3793.97 4892.4,-3804.46"/>
<polygon fill="black" stroke="black" points="4891.8,-3807.91 4902.32,-3806.67 4893.32,-3801.08 4891.8,-3807.91"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._progress_logger -->
<g id="edge114" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._progress_logger</title>
<path fill="none" stroke="black" d="M4365.74,-3581.42C4482.94,-3606.49 4623.61,-3635.07 4751,-3656.85 4778.27,-3661.51 4807.35,-3665.93 4835.58,-3669.93"/>
<polygon fill="black" stroke="black" points="4835.13,-3673.4 4845.52,-3671.32 4836.1,-3666.47 4835.13,-3673.4"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._write_md -->
<g id="edge115" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._write_md</title>
<path fill="none" stroke="black" d="M4715.05,-3492.08C4727.14,-3491.65 4739.13,-3491.24 4751,-3490.85 5015.45,-3482.25 5329.31,-3480.36 5472.41,-3479.95"/>
<polygon fill="black" stroke="black" points="5472.84,-3483.45 5482.83,-3479.92 5472.82,-3476.45 5472.84,-3483.45"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._find_group_path -->
<g id="edge116" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._find_group_path</title>
<path fill="none" stroke="black" d="M4254.94,-3581.37C4383.5,-3628.42 4576.44,-3691.22 4751,-3716.85 5297.76,-3797.14 5958.29,-3733.27 6243.06,-3698.12"/>
<polygon fill="black" stroke="black" points="6243.54,-3701.59 6253.03,-3696.88 6242.67,-3694.64 6243.54,-3701.59"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._should_skip_media -->
<g id="edge117" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._should_skip_media</title>
<path fill="none" stroke="black" d="M4715.22,-3571.11C4723.85,-3571.78 4732.37,-3572.45 4740.79,-3573.1"/>
<polygon fill="black" stroke="black" points="4740.75,-3576.61 4751,-3573.9 4741.3,-3569.63 4740.75,-3576.61"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._allowed_topic -->
<g id="edge118" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._allowed_topic</title>
<path fill="none" stroke="black" d="M4427.95,-3581.35C4530.77,-3597.62 4645.39,-3613.44 4751,-3622.85 4945.89,-3640.22 5168.49,-3644.53 5329.23,-3644.89"/>
<polygon fill="black" stroke="black" points="5329.24,-3648.39 5339.25,-3644.91 5329.25,-3641.39 5329.24,-3648.39"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._extract_author -->
<g id="edge119" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._extract_author</title>
<path fill="none" stroke="black" d="M4715.05,-3480.03C4727.14,-3479.28 4739.13,-3478.56 4751,-3477.85 4984.18,-3463.96 5042.48,-3458.83 5276,-3452.85 5521.36,-3446.57 5797.35,-3445.55 6012.63,-3446.11"/>
<polygon fill="black" stroke="black" points="6012.82,-3449.61 6022.83,-3446.14 6012.84,-3442.61 6012.82,-3449.61"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._enqueue_chop -->
<g id="edge120" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._enqueue_chop</title>
<path fill="none" stroke="black" d="M4134.29,-3466.17C4268.42,-3171.88 4874.25,-1842.69 4979.03,-1612.78"/>
<polygon fill="black" stroke="black" points="4982.27,-1614.11 4983.24,-1603.56 4975.9,-1611.21 4982.27,-1614.11"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._save_message -->
<g id="edge121" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._save_message</title>
<path fill="none" stroke="black" d="M3957.09,-3581.46C3976.06,-3591.97 4026.04,-3599.35 4107,-3599.35 4177.21,-3599.35 4224.12,-3593.8 4247.71,-3585.47"/>
<polygon fill="black" stroke="black" points="4249.15,-3588.66 4256.91,-3581.46 4246.35,-3582.25 4249.15,-3588.66"/>
</g>
<!-- tg_client._save_media -->
<g id="node102" class="node">
<title>tg_client._save_media</title>
<g id="a_node102"><a xlink:title="Store ``data`` and return relative file path.">
<polygon fill="none" stroke="black" points="5236.5,-3179.85 4754.5,-3179.85 4754.5,-3125.85 5236.5,-3125.85 5236.5,-3179.85"/>
<text text-anchor="middle" x="4995.5" y="-3142.25" font-family="Times,serif" font-size="42.00">tg_client._save_media</text>
</a>
</g>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._save_media -->
<g id="edge122" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._save_media</title>
<path fill="none" stroke="black" d="M4245.54,-3466.29C4435.54,-3386.77 4771.65,-3246.11 4920.27,-3183.92"/>
<polygon fill="black" stroke="black" points="4921.91,-3187.02 4929.78,-3179.93 4919.21,-3180.57 4921.91,-3187.02"/>
</g>
<!-- tg_client._save_media&#45;&gt;caption_io.has_caption -->
<g id="edge126" class="edge">
<title>tg_client._save_media&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M5006.14,-3125.84C5039.63,-3031.84 5153.53,-2710.08 5240,-2441.85 5256.95,-2389.26 5238.78,-2363.69 5276,-2322.85 5465.72,-2114.64 5589.47,-2151.15 5863,-2083.85 6857.57,-1839.15 8115.42,-1845.73 8453.55,-1852.57"/>
<polygon fill="black" stroke="black" points="8453.69,-1856.07 8463.76,-1852.78 8453.84,-1849.08 8453.69,-1856.07"/>
</g>
<!-- tg_client._save_media&#45;&gt;tg_client._schedule_caption -->
<g id="edge123" class="edge">
<title>tg_client._save_media&#45;&gt;tg_client._schedule_caption</title>
<path fill="none" stroke="black" d="M5236.67,-3172.79C5292.97,-3177.47 5351.34,-3182.31 5402.24,-3186.54"/>
<polygon fill="black" stroke="black" points="5402.06,-3190.04 5412.32,-3187.38 5402.64,-3183.06 5402.06,-3190.04"/>
</g>
<!-- image_io.write_image_meta -->
<g id="node103" class="node">
<title>image_io.write_image_meta</title>
<g id="a_node103"><a xlink:title="Write ``meta`` to ``path.with_suffix(&#39;.md&#39;)``.">
<polygon fill="none" stroke="black" points="6503.5,-3395.85 6268.5,-3395.85 6268.5,-3359.85 6503.5,-3359.85 6503.5,-3395.85"/>
<text text-anchor="middle" x="6386" y="-3373.81" font-family="Times,serif" font-size="15.68">image_io.write_image_meta</text>
</a>
</g>
</g>
<!-- tg_client._save_media&#45;&gt;image_io.write_image_meta -->
<g id="edge124" class="edge">
<title>tg_client._save_media&#45;&gt;image_io.write_image_meta</title>
<path fill="none" stroke="black" d="M5236.76,-3137.56C5403.79,-3131.97 5630.78,-3134.47 5827,-3171.85 6025.6,-3209.69 6246.78,-3310.13 6339.86,-3355.29"/>
<polygon fill="black" stroke="black" points="6338.47,-3358.51 6348.99,-3359.75 6341.54,-3352.22 6338.47,-3358.51"/>
</g>
<!-- tg_client._save_media&#45;&gt;caption_io.caption_json_path -->
<g id="edge125" class="edge">
<title>tg_client._save_media&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M5024.53,-3125.81C5071.8,-3082.24 5172.41,-2998.03 5276,-2964.85 5422.03,-2918.07 7911.74,-2979.06 8035,-2887.85 8075.33,-2858 8030.47,-2810.43 8071,-2780.85 8119.12,-2745.74 8968.68,-2755.48 9270.87,-2760.09"/>
<polygon fill="black" stroke="black" points="9270.9,-2763.59 9280.96,-2760.24 9271.01,-2756.59 9270.9,-2763.59"/>
</g>
<!-- image_io.write_image_meta&#45;&gt;notes_utils.write_md -->
<g id="edge169" class="edge">
<title>image_io.write_image_meta&#45;&gt;notes_utils.write_md</title>
<path fill="none" stroke="black" d="M6503.51,-3362.43C6612.57,-3352.86 6777.92,-3351.1 6909,-3404.85 6928.81,-3412.97 6925.18,-3428.75 6945,-3436.85 7081.26,-3492.56 7252.97,-3490.5 7366.62,-3480.33"/>
<polygon fill="black" stroke="black" points="7367.12,-3483.8 7376.75,-3479.39 7366.47,-3476.83 7367.12,-3483.8"/>
</g>
<!-- tg_client._save_bounded -->
<g id="node105" class="node">
<title>tg_client._save_bounded</title>
<g id="a_node105"><a xlink:title="Run ``_save_message`` under the global semaphore and return path.">
<polygon fill="none" stroke="black" points="3463,-3784.85 3058,-3784.85 3058,-3742.85 3463,-3742.85 3463,-3784.85"/>
<text text-anchor="middle" x="3260.5" y="-3755.76" font-family="Times,serif" font-size="31.36">tg_client._save_bounded</text>
</a>
</g>
</g>
<!-- tg_client._save_bounded&#45;&gt;tg_client._save_message -->
<g id="edge127" class="edge">
<title>tg_client._save_bounded&#45;&gt;tg_client._save_message</title>
<path fill="none" stroke="black" d="M3335.7,-3742.76C3459.27,-3707.64 3711.61,-3635.93 3893.86,-3584.14"/>
<polygon fill="black" stroke="black" points="3894.91,-3587.48 3903.58,-3581.38 3893,-3580.74 3894.91,-3587.48"/>
</g>
<!-- tg_client._remove_local_message -->
<g id="node106" class="node">
<title>tg_client._remove_local_message</title>
<g id="a_node106"><a xlink:title="Delete ``path`` and related media if the post no longer exists.">
<polygon fill="none" stroke="black" points="7775,-1174.85 7205,-1174.85 7205,-1130.85 7775,-1130.85 7775,-1174.85"/>
<text text-anchor="middle" x="7490" y="-1144.53" font-family="Times,serif" font-size="32.90">tg_client._remove_local_message</text>
</a>
</g>
</g>
<!-- tg_client._remove_local_message&#45;&gt;post_io.read_post -->
<g id="edge128" class="edge">
<title>tg_client._remove_local_message&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7775.3,-1138.87C7886.69,-1139.93 7996.94,-1151.36 8035,-1188.85 8105.36,-1258.16 8009.49,-1554.57 8071,-1631.85 8116.27,-1688.72 8183.24,-1724.25 8252.51,-1746.35"/>
<polygon fill="black" stroke="black" points="8251.71,-1749.76 8262.29,-1749.38 8253.78,-1743.08 8251.71,-1749.76"/>
</g>
<!-- tg_client._remove_local_message&#45;&gt;caption_io.caption_json_path -->
<g id="edge129" class="edge">
<title>tg_client._remove_local_message&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M7775.1,-1135.43C7885.67,-1134.98 7995.34,-1144.5 8035,-1179.85 8107.98,-1244.9 7997.79,-1332.06 8071,-1396.85 8149.37,-1466.2 8938.25,-1362.6 9012,-1436.85 9090.82,-1516.2 9002.6,-2340.63 9048,-2442.85 9109.96,-2582.37 9263.81,-2692.08 9336.83,-2738.19"/>
<polygon fill="black" stroke="black" points="9335.4,-2741.42 9345.74,-2743.75 9339.11,-2735.49 9335.4,-2741.42"/>
</g>
<!-- tg_client._remove_local_message&#45;&gt;caption_io.caption_md_path -->
<g id="edge130" class="edge">
<title>tg_client._remove_local_message&#45;&gt;caption_io.caption_md_path</title>
<path fill="none" stroke="black" d="M7775.31,-1136.03C7885.53,-1135.74 7994.87,-1145.21 8035,-1179.85 8097.09,-1233.44 8008.8,-1307.38 8071,-1360.85 8150.37,-1429.08 8937.5,-1330.33 9012,-1403.85 9108.81,-1499.39 8955.02,-1915.58 9048,-2014.85 9104.1,-2074.74 9199.81,-2080.58 9273.5,-2074.03"/>
<polygon fill="black" stroke="black" points="9274.13,-2077.48 9283.74,-2073.02 9273.45,-2070.51 9274.13,-2077.48"/>
</g>
<!-- tg_client._download_messages -->
<g id="node108" class="node">
<title>tg_client._download_messages</title>
<g id="a_node108"><a xlink:title="Save ``messages`` with a progress bar and return count saved.">
<polygon fill="none" stroke="black" points="3010.5,-3800.35 2300.5,-3800.35 2300.5,-3743.35 3010.5,-3743.35 3010.5,-3800.35"/>
<text text-anchor="middle" x="2655.5" y="-3760.51" font-family="Times,serif" font-size="44.80">tg_client._download_messages</text>
</a>
</g>
</g>
<!-- tg_client._download_messages&#45;&gt;tg_client._save_bounded -->
<g id="edge131" class="edge">
<title>tg_client._download_messages&#45;&gt;tg_client._save_bounded</title>
<path fill="none" stroke="black" d="M3010.76,-3767.15C3023.17,-3766.98 3035.47,-3766.82 3047.55,-3766.66"/>
<polygon fill="black" stroke="black" points="3047.7,-3770.16 3057.65,-3766.53 3047.6,-3763.16 3047.7,-3770.16"/>
</g>
<!-- tg_client.ensure_chat_access -->
<g id="node109" class="node">
<title>tg_client.ensure_chat_access</title>
<g id="a_node109"><a xlink:title="Join chats listed in ``CHATS`` if not already joined.">
<polygon fill="none" stroke="black" points="2826.5,-4182.85 2484.5,-4182.85 2484.5,-4146.85 2826.5,-4146.85 2826.5,-4182.85"/>
<text text-anchor="middle" x="2655.5" y="-4159.15" font-family="Times,serif" font-size="22.12">tg_client.ensure_chat_access</text>
</a>
</g>
</g>
<!-- tg_client.refetch_messages -->
<g id="node110" class="node">
<title>tg_client.refetch_messages</title>
<g id="a_node110"><a xlink:title="Re&#45;fetch posts that failed parsing or are empty.">
<polygon fill="none" stroke="black" points="3022,-3349.35 2289,-3349.35 2289,-3284.35 3022,-3284.35 3022,-3349.35"/>
<text text-anchor="middle" x="2655.5" y="-3303.8" font-family="Times,serif" font-size="51.94">tg_client.refetch_messages</text>
</a>
</g>
</g>
<!-- tg_client.refetch_messages&#45;&gt;post_io.read_post -->
<g id="edge132" class="edge">
<title>tg_client.refetch_messages&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M2660.79,-3284.28C2687.49,-3086.55 2836.88,-2048.37 3058,-1832.85 3193.69,-1700.6 4559.3,-1537.83 4715,-1429.85 4738.4,-1413.62 4727.01,-1392.2 4751,-1376.85 4950.23,-1249.38 5040.28,-1309.25 5276,-1289.85 5999.33,-1230.32 6183.23,-1287.27 6909,-1289.85 7159.23,-1290.74 7849.42,-1130 8035,-1297.85 8090.37,-1347.92 8023.74,-1574.06 8071,-1631.85 8116.82,-1687.89 8183.67,-1723.16 8252.63,-1745.27"/>
<polygon fill="black" stroke="black" points="8251.78,-1748.67 8262.37,-1748.3 8253.86,-1741.98 8251.78,-1748.67"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;post_io.raw_post_path -->
<g id="edge133" class="edge">
<title>tg_client.refetch_messages&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M3022.1,-3307.84C3315.16,-3301.39 3736.97,-3293.85 4106,-3293.85 4106,-3293.85 4106,-3293.85 5552.5,-3293.85 6104.26,-3293.85 7483.79,-3315.13 8035,-3339.85 8182.65,-3346.47 8354.18,-3359.9 8454.68,-3368.36"/>
<polygon fill="black" stroke="black" points="8454.52,-3371.86 8464.78,-3369.21 8455.11,-3364.88 8454.52,-3371.86"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;notes_utils.write_json -->
<g id="edge138" class="edge">
<title>tg_client.refetch_messages&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M2669,-3284.09C2754.09,-3067.19 3270.01,-1846.85 4106,-1846.85 4106,-1846.85 4106,-1846.85 6387,-1846.85 6460.09,-1846.85 8948.94,-1990.9 9012,-2027.85 9037.21,-2042.62 9028.67,-2060.95 9048,-2082.85 9142.58,-2190.01 9278.91,-2292.58 9342.03,-2337.76"/>
<polygon fill="black" stroke="black" points="9340.26,-2340.8 9350.44,-2343.75 9344.32,-2335.09 9340.26,-2340.8"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;notes_utils.load_json -->
<g id="edge137" class="edge">
<title>tg_client.refetch_messages&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M2738.1,-3349.43C2887.16,-3407.95 3214.38,-3531.83 3499,-3607.85 5471.43,-4134.64 6029.5,-4035.67 8071,-4051.85 8489.21,-4055.16 8595.21,-4086.48 9012,-4051.85 9104.82,-4044.14 9209.59,-4025.55 9282.9,-4010.91"/>
<polygon fill="black" stroke="black" points="9283.91,-4014.28 9293.03,-4008.87 9282.53,-4007.41 9283.91,-4014.28"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;tg_client._get_message_path -->
<g id="edge134" class="edge">
<title>tg_client.refetch_messages&#45;&gt;tg_client._get_message_path</title>
<path fill="none" stroke="black" d="M3022.04,-3330.79C3060.6,-3332.26 3097.68,-3333.68 3130.62,-3334.93"/>
<polygon fill="black" stroke="black" points="3130.58,-3338.43 3140.71,-3335.32 3130.85,-3331.44 3130.58,-3338.43"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;tg_client._save_bounded -->
<g id="edge135" class="edge">
<title>tg_client.refetch_messages&#45;&gt;tg_client._save_bounded</title>
<path fill="none" stroke="black" d="M2686.24,-3349.61C2771.16,-3442.82 3011.62,-3704.4 3058,-3728.85 3065.39,-3732.75 3073.13,-3736.22 3081.09,-3739.32"/>
<polygon fill="black" stroke="black" points="3079.92,-3742.63 3090.52,-3742.79 3082.34,-3736.06 3079.92,-3742.63"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;tg_client._remove_local_message -->
<g id="edge136" class="edge">
<title>tg_client.refetch_messages&#45;&gt;tg_client._remove_local_message</title>
<path fill="none" stroke="black" d="M2660.72,-3284.25C2687.26,-3083.98 2837.14,-2021.53 3058,-1794.85 3633.52,-1204.17 6299.27,-1151.62 7194.72,-1150.92"/>
<polygon fill="black" stroke="black" points="7194.85,-1154.42 7204.85,-1150.92 7194.85,-1147.42 7194.85,-1154.42"/>
</g>
<!-- tg_client.fetch_missing -->
<g id="node111" class="node">
<title>tg_client.fetch_missing</title>
<g id="a_node111"><a xlink:title="Pull new messages and back&#45;fill history until fully synced.">
<polygon fill="none" stroke="black" points="1732,-3926.85 1019,-3926.85 1019,-3852.85 1732,-3852.85 1732,-3926.85"/>
<text text-anchor="middle" x="1375.5" y="-3875.03" font-family="Times,serif" font-size="59.78">tg_client.fetch_missing</text>
</a>
</g>
</g>
<!-- tg_client.fetch_missing&#45;&gt;post_io.raw_post_path -->
<g id="edge139" class="edge">
<title>tg_client.fetch_missing&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M1732.14,-3880.02C1988.53,-3873.77 2342.85,-3866.85 2654.5,-3866.85 2654.5,-3866.85 2654.5,-3866.85 4108,-3866.85 5369.57,-3866.85 5684.38,-3822.6 6945,-3773.85 7005.55,-3771.51 7990.64,-3778.12 8035,-3736.85 8090.3,-3685.4 8016.08,-3450.71 8071,-3398.85 8179.23,-3296.63 8371.62,-3328.41 8473.27,-3355.13"/>
<polygon fill="black" stroke="black" points="8472.55,-3358.56 8483.12,-3357.77 8474.37,-3351.8 8472.55,-3358.56"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client._get_id_date -->
<g id="edge140" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client._get_id_date</title>
<path fill="none" stroke="black" d="M1720.39,-3926.88C1724.3,-3928.47 1728.17,-3930.13 1732,-3931.85 1751.53,-3940.62 1748.16,-3955.82 1768,-3963.85 1982.85,-4050.77 2057.43,-3976.48 2289,-3985.85 4255.25,-4065.36 6640,-4155.08 7307.67,-4180.07"/>
<polygon fill="black" stroke="black" points="7307.73,-4183.58 7317.86,-4180.46 7308,-4176.58 7307.73,-4183.58"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client._load_progress -->
<g id="edge141" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client._load_progress</title>
<path fill="none" stroke="black" d="M1476.87,-3926.93C1555.12,-3954.35 1667.08,-3990.36 1768,-4010.85 2316.98,-4122.33 2471.03,-4036.68 3022,-4137.85 3415.67,-4210.14 3875.48,-4353.77 4041.85,-4407.72"/>
<polygon fill="black" stroke="black" points="4040.85,-4411.07 4051.44,-4410.83 4043.01,-4404.41 4040.85,-4411.07"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client._save_progress -->
<g id="edge142" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client._save_progress</title>
<path fill="none" stroke="black" d="M1635.66,-3926.86C1679.74,-3932.03 1725.12,-3936.66 1768,-3939.85 2039.69,-3960.05 2359.4,-3961.4 2530.9,-3960.31"/>
<polygon fill="black" stroke="black" points="2530.99,-3963.81 2540.97,-3960.24 2530.94,-3956.81 2530.99,-3963.81"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client.get_first_id -->
<g id="edge143" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client.get_first_id</title>
<path fill="none" stroke="black" d="M1732.23,-3855.11C1744.29,-3854.29 1756.24,-3853.53 1768,-3852.85 2262.77,-3824.2 2851.21,-3820.5 3116.85,-3820.46"/>
<polygon fill="black" stroke="black" points="3116.94,-3823.96 3126.94,-3820.46 3116.94,-3816.96 3116.94,-3823.96"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client.get_last_id -->
<g id="edge144" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client.get_last_id</title>
<path fill="none" stroke="black" d="M1732.32,-3902.78C1780.94,-3904.54 1828.31,-3906.27 1869.74,-3907.77"/>
<polygon fill="black" stroke="black" points="1869.74,-3911.27 1879.86,-3908.14 1869.99,-3904.28 1869.74,-3911.27"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client._download_messages -->
<g id="edge145" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client._download_messages</title>
<path fill="none" stroke="black" d="M1541.9,-3852.81C1611.38,-3838.65 1693.27,-3823.77 1768,-3814.85 1939.03,-3794.42 2129.73,-3783.64 2290.3,-3777.97"/>
<polygon fill="black" stroke="black" points="2290.48,-3781.46 2300.35,-3777.62 2290.23,-3774.47 2290.48,-3781.46"/>
</g>
<!-- tg_client.remove_deleted -->
<g id="node112" class="node">
<title>tg_client.remove_deleted</title>
<g id="a_node112"><a xlink:title="Delete locally stored messages removed from Telegram recently.">
<polygon fill="none" stroke="black" points="7806.5,-2142.35 7173.5,-2142.35 7173.5,-2081.35 7806.5,-2081.35 7806.5,-2142.35"/>
<text text-anchor="middle" x="7490" y="-2099.6" font-family="Times,serif" font-size="48.44">tg_client.remove_deleted</text>
</a>
</g>
</g>
<!-- tg_client.remove_deleted&#45;&gt;post_io.read_post -->
<g id="edge146" class="edge">
<title>tg_client.remove_deleted&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7806.71,-2130.92C7890.43,-2120.18 7974.3,-2092.72 8035,-2033.85 8101.72,-1969.14 8002.92,-1891.12 8071,-1827.85 8120.01,-1782.3 8185.55,-1761.03 8252.07,-1753.19"/>
<polygon fill="black" stroke="black" points="8252.75,-1756.64 8262.32,-1752.08 8252,-1749.68 8252.75,-1756.64"/>
</g>
<!-- tg_client.remove_deleted&#45;&gt;post_io.raw_post_path -->
<g id="edge147" class="edge">
<title>tg_client.remove_deleted&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7806.8,-2133.19C7893.78,-2155.15 7979.4,-2195 8035,-2265.85 8104.05,-2353.84 7999.43,-3185.89 8071,-3271.85 8163.63,-3383.11 8346.19,-3391.36 8454.35,-3385.1"/>
<polygon fill="black" stroke="black" points="8454.82,-3388.58 8464.58,-3384.45 8454.38,-3381.59 8454.82,-3388.58"/>
</g>
<!-- tg_client.remove_deleted&#45;&gt;caption_io.caption_json_path -->
<g id="edge148" class="edge">
<title>tg_client.remove_deleted&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M7806.53,-2106.56C8199.72,-2106.87 8840.89,-2132.26 9012,-2287.85 9064.32,-2335.43 9013.22,-2381.27 9048,-2442.85 9123.55,-2576.61 9272.21,-2690.19 9340.57,-2737.85"/>
<polygon fill="black" stroke="black" points="9338.67,-2740.79 9348.89,-2743.6 9342.65,-2735.03 9338.67,-2740.79"/>
</g>
<!-- tg_client.remove_deleted&#45;&gt;caption_io.caption_md_path -->
<g id="edge149" class="edge">
<title>tg_client.remove_deleted&#45;&gt;caption_io.caption_md_path</title>
<path fill="none" stroke="black" d="M7806.5,-2110.88C8114.24,-2108.74 8595.49,-2102.23 9012,-2082.85 9100.39,-2078.74 9200.63,-2071.09 9273.59,-2064.99"/>
<polygon fill="black" stroke="black" points="9274.03,-2068.46 9283.7,-2064.14 9273.44,-2061.49 9274.03,-2068.46"/>
</g>
<!-- tg_client.main -->
<g id="node113" class="node">
<title>tg_client.main</title>
<g id="a_node113"><a xlink:title="Synchronize configured chats and optional live updates.">
<polygon fill="none" stroke="black" points="934.5,-3848.85 366.5,-3848.85 366.5,-3756.85 934.5,-3756.85 934.5,-3848.85"/>
<text text-anchor="middle" x="650.5" y="-3783.81" font-family="Times,serif" font-size="76.30">tg_client.main</text>
</a>
</g>
</g>
<!-- tg_client.main&#45;&gt;tg_client._mark_activity -->
<g id="edge150" class="edge">
<title>tg_client.main&#45;&gt;tg_client._mark_activity</title>
<path fill="none" stroke="black" d="M757.14,-3848.99C829.48,-3878.6 928.36,-3915.24 1019,-3935.85 1345.23,-4010.01 1433.86,-3994.16 1768,-4010.85 2999.09,-4072.33 4493.12,-3888.4 4892.38,-3834.96"/>
<polygon fill="black" stroke="black" points="4893.01,-3838.4 4902.46,-3833.61 4892.08,-3831.47 4893.01,-3838.4"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client._heartbeat -->
<g id="edge151" class="edge">
<title>tg_client.main&#45;&gt;tg_client._heartbeat</title>
<path fill="none" stroke="black" d="M693.71,-3849.06C757.09,-3914.97 883.88,-4033.84 1019,-4086.85 1092.13,-4115.54 1180,-4123.66 1250.09,-4124.55"/>
<polygon fill="black" stroke="black" points="1250.27,-4128.05 1260.3,-4124.63 1250.32,-4121.05 1250.27,-4128.05"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client._flush_chop_queue -->
<g id="edge152" class="edge">
<title>tg_client.main&#45;&gt;tg_client._flush_chop_queue</title>
<path fill="none" stroke="black" d="M652.45,-3756.55C659.18,-3478.74 708.86,-2035.69 1019,-1756.85 1274.99,-1526.69 1734.25,-1612.38 1923.94,-1661.22"/>
<polygon fill="black" stroke="black" points="1923.3,-1664.67 1933.86,-1663.81 1925.06,-1657.9 1923.3,-1664.67"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client._save_bounded -->
<g id="edge153" class="edge">
<title>tg_client.main&#45;&gt;tg_client._save_bounded</title>
<path fill="none" stroke="black" d="M934.58,-3777.82C1379.39,-3742.28 2269.01,-3686.48 3022,-3733.85 3049.34,-3735.57 3078.34,-3738.39 3106.34,-3741.64"/>
<polygon fill="black" stroke="black" points="3106.26,-3745.15 3116.6,-3742.85 3107.08,-3738.2 3106.26,-3745.15"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client.ensure_chat_access -->
<g id="edge154" class="edge">
<title>tg_client.main&#45;&gt;tg_client.ensure_chat_access</title>
<path fill="none" stroke="black" d="M682.83,-3849.05C739.22,-3927.6 866.3,-4084.63 1019,-4145.85 1571.38,-4367.29 2315.44,-4238.9 2567.15,-4185.05"/>
<polygon fill="black" stroke="black" points="2567.93,-4188.46 2576.97,-4182.93 2566.46,-4181.62 2567.93,-4188.46"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client.refetch_messages -->
<g id="edge155" class="edge">
<title>tg_client.main&#45;&gt;tg_client.refetch_messages</title>
<path fill="none" stroke="black" d="M812.13,-3756.76C876.31,-3738.74 951.01,-3718.26 1019,-3700.85 1559.41,-3562.47 2205.25,-3416.52 2497.32,-3351.55"/>
<polygon fill="black" stroke="black" points="2498.13,-3354.95 2507.13,-3349.37 2496.61,-3348.12 2498.13,-3354.95"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client.fetch_missing -->
<g id="edge156" class="edge">
<title>tg_client.main&#45;&gt;tg_client.fetch_missing</title>
<path fill="none" stroke="black" d="M934.66,-3836.92C974.7,-3841.74 1016.09,-3846.72 1056.73,-3851.61"/>
<polygon fill="black" stroke="black" points="1056.42,-3855.1 1066.76,-3852.82 1057.25,-3848.15 1056.42,-3855.1"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client.remove_deleted -->
<g id="edge157" class="edge">
<title>tg_client.main&#45;&gt;tg_client.remove_deleted</title>
<path fill="none" stroke="black" d="M658.47,-3756.59C706.91,-3454.13 1020.86,-1770.85 2009.5,-1770.85 2009.5,-1770.85 2009.5,-1770.85 3261.5,-1770.85 3358.96,-1770.85 6188.31,-2004.22 7162.87,-2084.84"/>
<polygon fill="black" stroke="black" points="7162.94,-2088.36 7173.19,-2085.69 7163.51,-2081.38 7162.94,-2088.36"/>
</g>
<!-- similar_utils._format_vector -->
<g id="node114" class="node">
<title>similar_utils._format_vector</title>
<g id="a_node114"><a xlink:title="Return compact JSON representation for ``vec``.">
<polygon fill="none" stroke="black" points="8670,-932.85 8413,-932.85 8413,-896.85 8670,-896.85 8670,-932.85"/>
<text text-anchor="middle" x="8541.5" y="-910.69" font-family="Times,serif" font-size="17.08">similar_utils._format_vector</text>
</a>
</g>
</g>
<!-- similar_utils._load_more_user -->
<g id="node117" class="node">
<title>similar_utils._load_more_user</title>
<g id="a_node117"><a xlink:title="Return cached per&#45;user lot mapping.">
<polygon fill="none" stroke="black" points="8800.5,-4043.35 8282.5,-4043.35 8282.5,-3998.35 8800.5,-3998.35 8800.5,-4043.35"/>
<text text-anchor="middle" x="8541.5" y="-4012.47" font-family="Times,serif" font-size="33.60">similar_utils._load_more_user</text>
</a>
</g>
</g>
<!-- similar_utils._load_more_user&#45;&gt;notes_utils.load_json -->
<g id="edge160" class="edge">
<title>similar_utils._load_more_user&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M8800.67,-4011.56C8947.1,-4006.3 9124.24,-3999.92 9243.05,-3995.65"/>
<polygon fill="black" stroke="black" points="9243.42,-3999.14 9253.28,-3995.28 9243.17,-3992.14 9243.42,-3999.14"/>
</g>
<!-- lot_io.lot_json_path&#45;&gt;lot_io.parse_lot_id -->
<g id="edge273" class="edge">
<title>lot_io.lot_json_path&#45;&gt;lot_io.parse_lot_id</title>
<path fill="none" stroke="black" d="M8618.25,-4328.27C8712.19,-4331.76 8876.5,-4331.33 9012,-4296.85 9139,-4264.53 9275.27,-4187.44 9339.27,-4148.39"/>
<polygon fill="black" stroke="black" points="9341.49,-4151.13 9348.18,-4142.91 9337.82,-4145.17 9341.49,-4151.13"/>
</g>
<!-- config_utils.load_config -->
<g id="node120" class="node">
<title>config_utils.load_config</title>
<g id="a_node120"><a xlink:title="Return the ``config`` module or exit with a helpful message.&#10;&#10;When running the scripts directly from ``src/`` the repository root isn&#39;t on&#10;``sys.path`` and ``config.py`` can&#39;t be imported. &#160;Try adding the parent&#10;directory before failing so the configuration can live alongside&#10;``config.example.py`` in the project root.">
<polygon fill="none" stroke="black" points="10227,-1480.35 9794,-1480.35 9794,-1433.35 10227,-1433.35 10227,-1480.35"/>
<text text-anchor="middle" x="10010.5" y="-1448.35" font-family="Times,serif" font-size="35.00">config_utils.load_config</text>
</a>
</g>
</g>
<!-- image_io.read_image_meta -->
<g id="node121" class="node">
<title>image_io.read_image_meta</title>
<g id="a_node121"><a xlink:title="Return metadata from ``path.with_suffix(&#39;.md&#39;)``.">
<polygon fill="none" stroke="black" points="7604.5,-1112.85 7375.5,-1112.85 7375.5,-1076.85 7604.5,-1076.85 7604.5,-1112.85"/>
<text text-anchor="middle" x="7490" y="-1090.81" font-family="Times,serif" font-size="15.68">image_io.read_image_meta</text>
</a>
</g>
</g>
<!-- notes_utils.parse_md -->
<g id="node122" class="node">
<title>notes_utils.parse_md</title>
<g id="a_node122"><a xlink:title="Return metadata dictionary and body text from ``path``.">
<polygon fill="none" stroke="black" points="8625,-1351.85 8458,-1351.85 8458,-1315.85 8625,-1315.85 8625,-1351.85"/>
<text text-anchor="middle" x="8541.5" y="-1330.15" font-family="Times,serif" font-size="14.00">notes_utils.parse_md</text>
</a>
</g>
</g>
<!-- image_io.read_image_meta&#45;&gt;notes_utils.parse_md -->
<g id="edge168" class="edge">
<title>image_io.read_image_meta&#45;&gt;notes_utils.parse_md</title>
<path fill="none" stroke="black" d="M7604.61,-1084.9C7744.85,-1075.2 7972.51,-1068.71 8035,-1121.85 8093.18,-1171.31 8013.92,-1239.12 8071,-1289.85 8174.89,-1382.18 8347.47,-1371.4 8451.95,-1353.66"/>
<polygon fill="black" stroke="black" points="8452.59,-1357.1 8461.84,-1351.93 8451.38,-1350.21 8452.59,-1357.1"/>
</g>
<!-- notes_utils.parse_md&#45;&gt;notes_utils.read_md -->
<g id="edge278" class="edge">
<title>notes_utils.parse_md&#45;&gt;notes_utils.read_md</title>
<path fill="none" stroke="black" d="M8605.56,-1315.81C8706.12,-1291.3 8902.58,-1261.59 9012,-1365.85 9061.89,-1413.39 9012.74,-1614.64 9048,-1673.85 9111.21,-1779.98 9244.27,-1849.85 9320.22,-1882.82"/>
<polygon fill="black" stroke="black" points="9319.07,-1886.13 9329.64,-1886.85 9321.82,-1879.7 9319.07,-1886.13"/>
</g>
<!-- notes_utils.parse_md&#45;&gt;notes_utils._parse_block -->
<g id="edge279" class="edge">
<title>notes_utils.parse_md&#45;&gt;notes_utils._parse_block</title>
<path fill="none" stroke="black" d="M8614.25,-1315.79C8714.86,-1295.05 8898.23,-1274.61 9012,-1365.85 9056.1,-1401.22 9011.43,-1444.74 9048,-1487.85 9109.88,-1560.8 9213.02,-1603 9287.24,-1625.36"/>
<polygon fill="black" stroke="black" points="9286.47,-1628.78 9297.05,-1628.25 9288.45,-1622.06 9286.47,-1628.78"/>
</g>
<!-- log_utils._add_exc_line -->
<g id="node124" class="node">
<title>log_utils._add_exc_line</title>
<g id="a_node124"><a xlink:title="Attach ``line`` from traceback to structured log events.">
<polygon fill="none" stroke="black" points="6527.5,-5196.85 6244.5,-5196.85 6244.5,-5160.85 6527.5,-5160.85 6527.5,-5196.85"/>
<text text-anchor="middle" x="6386" y="-5173.26" font-family="Times,serif" font-size="23.24">log_utils._add_exc_line</text>
</a>
</g>
</g>
<!-- log_utils._add_exc_line&#45;&gt;log_utils._extract_tb_lineno -->
<g id="edge170" class="edge">
<title>log_utils._add_exc_line&#45;&gt;log_utils._extract_tb_lineno</title>
<path fill="none" stroke="black" d="M6527.69,-5178.85C6744.52,-5178.85 7156.93,-5178.85 7363.92,-5178.85"/>
<polygon fill="black" stroke="black" points="7364.23,-5182.35 7374.23,-5178.85 7364.23,-5175.35 7364.23,-5182.35"/>
</g>
<!-- log_utils.init_logger -->
<g id="node125" class="node">
<title>log_utils.init_logger</title>
<g id="a_node125"><a xlink:title="Initialize logger writing to ``LOGFILE``.&#10;&#10;``LOG_LEVEL`` may be set in ``config.py`` or via an environment&#10;variable. &#160;The level accepts ``DEBUG``, ``INFO`` or ``ERROR`` and&#10;defaults to ``INFO``. &#160;The function falls back to the standard&#10;``logging`` module if ``structlog`` isn&#39;t available so the scripts&#10;can still run in minimal environments.">
<polygon fill="none" stroke="black" points="6733.5,-5350.85 6038.5,-5350.85 6038.5,-5268.85 6733.5,-5268.85 6733.5,-5350.85"/>
<text text-anchor="middle" x="6386" y="-5292.87" font-family="Times,serif" font-size="67.48">log_utils.init_logger</text>
</a>
</g>
</g>
<!-- log_utils.init_logger&#45;&gt;log_utils._extract_tb_lineno -->
<g id="edge171" class="edge">
<title>log_utils.init_logger&#45;&gt;log_utils._extract_tb_lineno</title>
<path fill="none" stroke="black" d="M6733.83,-5319.71C6795.28,-5309.72 6856.36,-5291.34 6909,-5259.85 6933.75,-5245.04 6919.91,-5220.09 6945,-5205.85 7084.9,-5126.45 7279.09,-5140.65 7393.64,-5159.12"/>
<polygon fill="black" stroke="black" points="7393.35,-5162.62 7403.79,-5160.8 7394.49,-5155.71 7393.35,-5162.62"/>
</g>
<!-- log_utils.get_logger -->
<g id="node126" class="node">
<title>log_utils.get_logger</title>
<g id="a_node126"><a xlink:title="Return the singleton logger instance.">
<polygon fill="none" stroke="black" points="7558.5,-5327.85 7421.5,-5327.85 7421.5,-5291.85 7558.5,-5291.85 7558.5,-5327.85"/>
<text text-anchor="middle" x="7490" y="-5306.61" font-family="Times,serif" font-size="12.18">log_utils.get_logger</text>
</a>
</g>
</g>
<!-- log_utils.init_logger&#45;&gt;log_utils.get_logger -->
<g id="edge172" class="edge">
<title>log_utils.init_logger&#45;&gt;log_utils.get_logger</title>
<path fill="none" stroke="black" d="M6733.79,-5303.53C6973.09,-5302.48 7272.25,-5303.36 7411.29,-5306.18"/>
<polygon fill="black" stroke="black" points="7411.35,-5309.68 7421.42,-5306.39 7411.5,-5302.68 7411.35,-5309.68"/>
</g>
<!-- log_utils.get_logger&#45;&gt;log_utils.init_logger -->
<g id="edge173" class="edge">
<title>log_utils.get_logger&#45;&gt;log_utils.init_logger</title>
<path fill="none" stroke="black" d="M7421.42,-5313.31C7289.1,-5316.25 6987.47,-5317.22 6743.88,-5316.21"/>
<polygon fill="black" stroke="black" points="6743.8,-5312.71 6733.79,-5316.17 6743.77,-5319.71 6743.8,-5312.71"/>
</g>
<!-- caption._identify_size -->
<g id="node127" class="node">
<title>caption._identify_size</title>
<g id="a_node127"><a xlink:title="Return ``(width, height)`` for ``path`` using ImageMagick.">
<polygon fill="none" stroke="black" points="9506,-3185.85 9249,-3185.85 9249,-3149.85 9506,-3149.85 9506,-3185.85"/>
<text text-anchor="middle" x="9377.5" y="-3162.15" font-family="Times,serif" font-size="22.12">caption._identify_size</text>
</a>
</g>
</g>
<!-- caption._prepare_image -->
<g id="node128" class="node">
<title>caption._prepare_image</title>
<g id="a_node128"><a xlink:title="Resize ``path`` and return the processed JPEG bytes.">
<polygon fill="none" stroke="black" points="8758.5,-3133.85 8324.5,-3133.85 8324.5,-3087.85 8758.5,-3087.85 8758.5,-3133.85"/>
<text text-anchor="middle" x="8541.5" y="-3102.41" font-family="Times,serif" font-size="34.30">caption._prepare_image</text>
</a>
</g>
</g>
<!-- caption._prepare_image&#45;&gt;caption._identify_size -->
<g id="edge175" class="edge">
<title>caption._prepare_image&#45;&gt;caption._identify_size</title>
<path fill="none" stroke="black" d="M8758.71,-3125.57C8838.33,-3130.99 8929.27,-3137.19 9012,-3142.85 9086.79,-3147.96 9170.21,-3153.68 9238.35,-3158.36"/>
<polygon fill="black" stroke="black" points="9238.5,-3161.88 9248.72,-3159.07 9238.98,-3154.9 9238.5,-3161.88"/>
</g>
<!-- caption._guess_chat -->
<g id="node129" class="node">
<title>caption._guess_chat</title>
<g id="a_node129"><a xlink:title="Return chat name for ``path`` relative to ``MEDIA_DIR``.">
<polygon fill="none" stroke="black" points="9473.5,-3077.85 9281.5,-3077.85 9281.5,-3041.85 9473.5,-3041.85 9473.5,-3077.85"/>
<text text-anchor="middle" x="9377.5" y="-3055.69" font-family="Times,serif" font-size="17.08">caption._guess_chat</text>
</a>
</g>
</g>
<!-- caption.caption_file -->
<g id="node130" class="node">
<title>caption.caption_file</title>
<g id="a_node130"><a xlink:title="Caption ``path`` with GPT&#45;4o and save ``.caption.json`` beside it.">
<polygon fill="none" stroke="black" points="7793,-3073.35 7187,-3073.35 7187,-3000.35 7793,-3000.35 7793,-3073.35"/>
<text text-anchor="middle" x="7490" y="-3021.86" font-family="Times,serif" font-size="59.36">caption.caption_file</text>
</a>
</g>
</g>
<!-- caption.caption_file&#45;&gt;caption_io.has_caption -->
<g id="edge180" class="edge">
<title>caption.caption_file&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M7769.27,-3000.34C7869.23,-2972.53 7972.59,-2923.65 8035,-2837.85 8097.53,-2751.89 7996.58,-1957.75 8071,-1881.85 8122.36,-1829.47 8332.95,-1837.32 8453.92,-1846.65"/>
<polygon fill="black" stroke="black" points="8453.66,-1850.15 8463.91,-1847.44 8454.22,-1843.17 8453.66,-1850.15"/>
</g>
<!-- caption.caption_file&#45;&gt;notes_utils.load_json -->
<g id="edge178" class="edge">
<title>caption.caption_file&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M7679.28,-3000.33C7795.76,-2989.19 7940.56,-2997.75 8035,-3082.85 8098.52,-3140.09 8007.4,-3214.69 8071,-3271.85 8227.05,-3412.1 8850.6,-3214.8 9012,-3348.85 9058.78,-3387.7 9023.25,-3425.31 9048,-3480.85 9136.99,-3680.52 9297.62,-3891.67 9355.23,-3964.43"/>
<polygon fill="black" stroke="black" points="9352.77,-3966.96 9361.73,-3972.61 9358.24,-3962.6 9352.77,-3966.96"/>
</g>
<!-- caption.caption_file&#45;&gt;caption_io.caption_json_path -->
<g id="edge179" class="edge">
<title>caption.caption_file&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M7793.43,-3039.06C8203.93,-3040.69 8899.47,-3038.06 9012,-3002.85 9154.79,-2958.17 9293.91,-2839.29 9350.26,-2787.06"/>
<polygon fill="black" stroke="black" points="9352.74,-2789.53 9357.66,-2780.15 9347.96,-2784.42 9352.74,-2789.53"/>
</g>
<!-- caption.caption_file&#45;&gt;caption._prepare_image -->
<g id="edge176" class="edge">
<title>caption.caption_file&#45;&gt;caption._prepare_image</title>
<path fill="none" stroke="black" d="M7793.15,-3058.15C7959.19,-3069.86 8161.74,-3084.14 8314.06,-3094.88"/>
<polygon fill="black" stroke="black" points="8314.26,-3098.41 8324.48,-3095.62 8314.75,-3091.42 8314.26,-3098.41"/>
</g>
<!-- caption.caption_file&#45;&gt;caption._guess_chat -->
<g id="edge177" class="edge">
<title>caption.caption_file&#45;&gt;caption._guess_chat</title>
<path fill="none" stroke="black" d="M7793.15,-3040.54C8223.55,-3045.79 8991.94,-3055.16 9271.3,-3058.57"/>
<polygon fill="black" stroke="black" points="9271.39,-3062.07 9281.43,-3058.69 9271.47,-3055.07 9271.39,-3062.07"/>
</g>
<!-- caption_io.write_caption -->
<g id="node131" class="node">
<title>caption_io.write_caption</title>
<g id="a_node131"><a xlink:title="Write ``text`` as ``lang`` caption for ``image``.">
<polygon fill="none" stroke="black" points="8708,-2993.85 8375,-2993.85 8375,-2957.85 8708,-2957.85 8708,-2993.85"/>
<text text-anchor="middle" x="8541.5" y="-2969.69" font-family="Times,serif" font-size="25.20">caption_io.write_caption</text>
</a>
</g>
</g>
<!-- caption.caption_file&#45;&gt;caption_io.write_caption -->
<g id="edge181" class="edge">
<title>caption.caption_file&#45;&gt;caption_io.write_caption</title>
<path fill="none" stroke="black" d="M7793.15,-3019.29C7978.32,-3008.52 8208.88,-2995.12 8364.57,-2986.08"/>
<polygon fill="black" stroke="black" points="8364.94,-2989.56 8374.72,-2985.49 8364.53,-2982.57 8364.94,-2989.56"/>
</g>
<!-- caption_io.write_caption&#45;&gt;notes_utils.write_json -->
<g id="edge291" class="edge">
<title>caption_io.write_caption&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M8708.09,-2986.71C8825.87,-2990.47 8970.29,-2985.69 9012,-2943.85 9099.25,-2856.31 8961.36,-2476.99 9048,-2388.85 9110.86,-2324.89 9219.86,-2329.12 9294.96,-2342.02"/>
<polygon fill="black" stroke="black" points="9294.4,-2345.48 9304.86,-2343.81 9295.64,-2338.59 9294.4,-2345.48"/>
</g>
<!-- caption_io.write_caption&#45;&gt;notes_utils.load_json -->
<g id="edge290" class="edge">
<title>caption_io.write_caption&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M8708.02,-2972.41C8807.66,-2979.09 8930.57,-3004.06 9012,-3078.85 9051.76,-3115.36 9029.68,-3144.07 9048,-3194.85 9158.45,-3501.07 9318.67,-3862.26 9364.09,-3963.36"/>
<polygon fill="black" stroke="black" points="9360.94,-3964.9 9368.24,-3972.58 9367.33,-3962.02 9360.94,-3964.9"/>
</g>
<!-- caption_io.write_caption&#45;&gt;caption_io.caption_json_path -->
<g id="edge293" class="edge">
<title>caption_io.write_caption&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M8708.09,-2980.34C8799.21,-2978.91 8913.46,-2970.65 9012,-2943.85 9141.07,-2908.74 9278.35,-2826.19 9341.28,-2785.45"/>
<polygon fill="black" stroke="black" points="9343.19,-2788.38 9349.66,-2779.98 9339.37,-2782.51 9343.19,-2788.38"/>
</g>
<!-- caption_io.write_caption&#45;&gt;caption_io._get_langs -->
<g id="edge292" class="edge">
<title>caption_io.write_caption&#45;&gt;caption_io._get_langs</title>
<path fill="none" stroke="black" d="M8708.08,-2985.46C8824.99,-2988.47 8968.29,-2983.29 9012,-2943.85 9081.98,-2880.7 9004.03,-2818.22 9048,-2734.85 9119.48,-2599.31 9269.56,-2487.03 9339.35,-2439.82"/>
<polygon fill="black" stroke="black" points="9341.49,-2442.6 9347.85,-2434.12 9337.59,-2436.78 9341.49,-2442.6"/>
</g>
<!-- caption.main -->
<g id="node132" class="node">
<title>caption.main</title>
<g id="a_node132"><a xlink:title="Caption a single image provided on the command line.">
<polygon fill="none" stroke="black" points="6478.5,-3075.85 6293.5,-3075.85 6293.5,-3039.85 6478.5,-3039.85 6478.5,-3075.85"/>
<text text-anchor="middle" x="6386" y="-3051.69" font-family="Times,serif" font-size="25.20">caption.main</text>
</a>
</g>
</g>
<!-- caption.main&#45;&gt;caption.caption_file -->
<g id="edge182" class="edge">
<title>caption.main&#45;&gt;caption.caption_file</title>
<path fill="none" stroke="black" d="M6478.59,-3056.1C6630.13,-3053.22 6939.81,-3047.31 7176.61,-3042.8"/>
<polygon fill="black" stroke="black" points="7176.84,-3046.3 7186.77,-3042.61 7176.71,-3039.3 7176.84,-3046.3"/>
</g>
<!-- build_site._load_ontology -->
<g id="node133" class="node">
<title>build_site._load_ontology</title>
<g id="a_node133"><a xlink:title="Return sorted field list from ``ONTOLOGY`` or empty list when missing.">
<polygon fill="none" stroke="black" points="8698,-3979.85 8385,-3979.85 8385,-3943.85 8698,-3943.85 8698,-3979.85"/>
<text text-anchor="middle" x="8541.5" y="-3956.26" font-family="Times,serif" font-size="23.24">build_site._load_ontology</text>
</a>
</g>
</g>
<!-- build_site._load_ontology&#45;&gt;notes_utils.load_json -->
<g id="edge183" class="edge">
<title>build_site._load_ontology&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M8698.39,-3967.27C8855.32,-3972.73 9094.8,-3981.05 9243.17,-3986.21"/>
<polygon fill="black" stroke="black" points="9243.14,-3989.71 9253.26,-3986.56 9243.38,-3982.72 9243.14,-3989.71"/>
</g>
<!-- build_site._compile_locale -->
<g id="node134" class="node">
<title>build_site._compile_locale</title>
<g id="a_node134"><a xlink:title="Compile ``lang`` gettext catalogue when out of date.">
<polygon fill="none" stroke="black" points="7657,-504.85 7323,-504.85 7323,-468.85 7657,-468.85 7657,-504.85"/>
<text text-anchor="middle" x="7490" y="-480.97" font-family="Times,serif" font-size="24.22">build_site._compile_locale</text>
</a>
</g>
</g>
<!-- build_site._env_for_lang -->
<g id="node135" class="node">
<title>build_site._env_for_lang</title>
<g id="a_node135"><a xlink:title="Return Jinja environment configured for ``lang``.">
<polygon fill="none" stroke="black" points="6574.5,-469.35 6197.5,-469.35 6197.5,-428.35 6574.5,-428.35 6574.5,-469.35"/>
<text text-anchor="middle" x="6386" y="-441.61" font-family="Times,serif" font-size="29.68">build_site._env_for_lang</text>
</a>
</g>
</g>
<!-- build_site._env_for_lang&#45;&gt;build_site._compile_locale -->
<g id="edge184" class="edge">
<title>build_site._env_for_lang&#45;&gt;build_site._compile_locale</title>
<path fill="none" stroke="black" d="M6574.56,-455.32C6781.05,-462.44 7110.46,-473.8 7312.45,-480.76"/>
<polygon fill="black" stroke="black" points="7312.45,-484.26 7322.57,-481.11 7312.69,-477.27 7312.45,-484.26"/>
</g>
<!-- build_site._iter_lots -->
<g id="node136" class="node">
<title>build_site._iter_lots</title>
<g id="a_node136"><a xlink:title="Return all lots ready for rendering.">
<polygon fill="none" stroke="black" points="7716,-2764.35 7264,-2764.35 7264,-2707.35 7716,-2707.35 7716,-2764.35"/>
<text text-anchor="middle" x="7490" y="-2724.96" font-family="Times,serif" font-size="44.24">build_site._iter_lots</text>
</a>
</g>
</g>
<!-- build_site._iter_lots&#45;&gt;post_io.read_post -->
<g id="edge185" class="edge">
<title>build_site._iter_lots&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7674.45,-2764.35C7795.06,-2771.74 7946.42,-2757.33 8035,-2659.85 8097.23,-2591.37 8007.45,-1895.1 8071,-1827.85 8117.99,-1778.12 8184.29,-1755.84 8252.3,-1748.39"/>
<polygon fill="black" stroke="black" points="8252.74,-1751.86 8262.35,-1747.39 8252.05,-1744.9 8252.74,-1751.86"/>
</g>
<!-- build_site._iter_lots&#45;&gt;post_io.raw_post_path -->
<g id="edge186" class="edge">
<title>build_site._iter_lots&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7716.18,-2722.5C7845.31,-2720.18 7990.4,-2728.43 8035,-2772.85 8113.78,-2851.3 7998.33,-3187.71 8071,-3271.85 8165.5,-3381.26 8346.97,-3390.24 8454.52,-3384.59"/>
<polygon fill="black" stroke="black" points="8454.91,-3388.08 8464.69,-3384.01 8454.51,-3381.09 8454.91,-3388.08"/>
</g>
<!-- build_site._iter_lots&#45;&gt;lot_io.read_lots -->
<g id="edge189" class="edge">
<title>build_site._iter_lots&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M7716.17,-2742.75C7843.23,-2741.97 7986.11,-2731.73 8035,-2692.85 8076.58,-2659.78 8030.33,-2613.04 8071,-2578.85 8168.77,-2496.64 8320.74,-2491 8425.15,-2499.27"/>
<polygon fill="black" stroke="black" points="8425.15,-2502.79 8435.41,-2500.14 8425.75,-2495.81 8425.15,-2502.79"/>
</g>
<!-- build_site._iter_lots&#45;&gt;moderation.should_skip_message -->
<g id="edge187" class="edge">
<title>build_site._iter_lots&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M7668.11,-2764.36C7790.03,-2772.94 7945.56,-2759.93 8035,-2659.85 8135.21,-2547.71 7968.27,-1416.68 8071,-1306.85 8170,-1201 8356.61,-1220.51 8462.31,-1242.61"/>
<polygon fill="black" stroke="black" points="8461.77,-1246.08 8472.28,-1244.76 8463.24,-1239.23 8461.77,-1246.08"/>
</g>
<!-- build_site._iter_lots&#45;&gt;lot_io.iter_lot_files -->
<g id="edge190" class="edge">
<title>build_site._iter_lots&#45;&gt;lot_io.iter_lot_files</title>
<path fill="none" stroke="black" d="M7716.11,-2719.67C7814.13,-2712.21 7930.31,-2702.8 8035,-2692.85 8051.03,-2691.33 8054.96,-2690.22 8071,-2688.85 8182.47,-2679.34 8309.1,-2671.99 8402.74,-2667.21"/>
<polygon fill="black" stroke="black" points="8403.03,-2670.7 8412.84,-2666.7 8402.68,-2663.71 8403.03,-2670.7"/>
</g>
<!-- build_site._iter_lots&#45;&gt;moderation.should_skip_lot -->
<g id="edge188" class="edge">
<title>build_site._iter_lots&#45;&gt;moderation.should_skip_lot</title>
<path fill="none" stroke="black" d="M7716.31,-2763.24C7820.34,-2765.07 7941.27,-2750.91 8035,-2692.85 8061.44,-2676.47 8044.39,-2648.94 8071,-2632.85 8183.8,-2564.63 8341.07,-2571.72 8441.84,-2586.26"/>
<polygon fill="black" stroke="black" points="8441.61,-2589.77 8452.02,-2587.79 8442.65,-2582.85 8441.61,-2589.77"/>
</g>
<!-- build_site._copy_images -->
<g id="node137" class="node">
<title>build_site._copy_images</title>
<g id="a_node137"><a xlink:title="Copy media referenced by ``lots`` into ``VIEWS_DIR``.">
<polygon fill="none" stroke="black" points="9541,-1006.85 9214,-1006.85 9214,-970.85 9541,-970.85 9541,-1006.85"/>
<text text-anchor="middle" x="9377.5" y="-982.69" font-family="Times,serif" font-size="25.20">build_site._copy_images</text>
</a>
</g>
</g>
<!-- build_site._copy_static -->
<g id="node138" class="node">
<title>build_site._copy_static</title>
<g id="a_node138"><a xlink:title="Copy CSS and JS so generated pages are standalone.">
<polygon fill="none" stroke="black" points="7618,-216.85 7362,-216.85 7362,-180.85 7618,-180.85 7618,-216.85"/>
<text text-anchor="middle" x="7490" y="-193.55" font-family="Times,serif" font-size="21.00">build_site._copy_static</text>
</a>
</g>
</g>
<!-- build_site._load_state -->
<g id="node139" class="node">
<title>build_site._load_state</title>
<g id="a_node139"><a xlink:title="Return ontology fields, embeddings, lots and similarity caches.">
<polygon fill="none" stroke="black" points="6535.5,-4008.35 6236.5,-4008.35 6236.5,-3971.35 6535.5,-3971.35 6535.5,-4008.35"/>
<text text-anchor="middle" x="6386" y="-3983.41" font-family="Times,serif" font-size="26.18">build_site._load_state</text>
</a>
</g>
</g>
<!-- build_site._load_state&#45;&gt;similar_utils._load_embeddings -->
<g id="edge191" class="edge">
<title>build_site._load_state&#45;&gt;similar_utils._load_embeddings</title>
<path fill="none" stroke="black" d="M6433.57,-4008.48C6533.99,-4050.87 6772.84,-4163.86 6909,-4329.85 6936.32,-4363.16 6909.51,-4395.43 6945,-4419.85 6998.67,-4456.78 7835.23,-4452.39 8274.94,-4447.47"/>
<polygon fill="black" stroke="black" points="8275.3,-4450.97 8285.26,-4447.35 8275.22,-4443.97 8275.3,-4450.97"/>
</g>
<!-- build_site._load_state&#45;&gt;similar_utils._load_similar -->
<g id="edge192" class="edge">
<title>build_site._load_state&#45;&gt;similar_utils._load_similar</title>
<path fill="none" stroke="black" d="M6535.62,-4007.92C6727.86,-4031.3 7063.79,-4072.15 7281.22,-4098.58"/>
<polygon fill="black" stroke="black" points="7280.81,-4102.06 7291.16,-4099.79 7281.66,-4095.11 7280.81,-4102.06"/>
</g>
<!-- build_site._load_state&#45;&gt;similar_utils._load_more_user -->
<g id="edge193" class="edge">
<title>build_site._load_state&#45;&gt;similar_utils._load_more_user</title>
<path fill="none" stroke="black" d="M6535.87,-3991.99C6895.12,-3997.16 7813.67,-4010.39 8272,-4016.98"/>
<polygon fill="black" stroke="black" points="8272.02,-4020.48 8282.06,-4017.13 8272.12,-4013.49 8272.02,-4020.48"/>
</g>
<!-- build_site._load_state&#45;&gt;build_site._load_ontology -->
<g id="edge194" class="edge">
<title>build_site._load_state&#45;&gt;build_site._load_ontology</title>
<path fill="none" stroke="black" d="M6535.58,-3989.76C6824.45,-3989.35 7481.99,-3987.23 8035,-3976.85 8148.41,-3974.72 8276.09,-3970.92 8374.75,-3967.68"/>
<polygon fill="black" stroke="black" points="8374.93,-3971.17 8384.81,-3967.35 8374.7,-3964.18 8374.93,-3971.17"/>
</g>
<!-- build_site._load_state&#45;&gt;build_site._iter_lots -->
<g id="edge195" class="edge">
<title>build_site._load_state&#45;&gt;build_site._iter_lots</title>
<path fill="none" stroke="black" d="M6471.81,-3971.34C6592.78,-3939.94 6811.06,-3863.63 6909,-3705.85 6963.72,-3617.71 6872.73,-2847.28 6945,-2772.85 6987.74,-2728.84 7126.65,-2719.91 7253.4,-2721.82"/>
<polygon fill="black" stroke="black" points="7253.61,-2725.32 7263.67,-2722 7253.73,-2718.32 7253.61,-2725.32"/>
</g>
<!-- build_site._load_state&#45;&gt;build_site._copy_images -->
<g id="edge196" class="edge">
<title>build_site._load_state&#45;&gt;build_site._copy_images</title>
<path fill="none" stroke="black" d="M6473.61,-3971.34C6595.48,-3940.13 6813.39,-3864.3 6909,-3705.85 6947.72,-3641.68 6891.86,-1060.7 6945,-1007.85 7024.84,-928.45 8660.97,-968.21 9203.45,-983.65"/>
<polygon fill="black" stroke="black" points="9203.61,-987.16 9213.71,-983.95 9203.81,-980.16 9203.61,-987.16"/>
</g>
<!-- build_site._categorise -->
<g id="node140" class="node">
<title>build_site._categorise</title>
<g id="a_node140"><a xlink:title="Return category info and recent lot list.&#10;&#10;Categories are split by ``market:deal`` and ``sell_item`` lots are further&#10;grouped by ``item:type``.&#10;Stats include price range, last timestamp and embedding centroid so the&#10;sorting logic used on item pages also works for categories.">
<polygon fill="none" stroke="black" points="9012,-582.85 8071,-582.85 8071,-482.85 9012,-482.85 9012,-582.85"/>
<text text-anchor="middle" x="8541.5" y="-511.65" font-family="Times,serif" font-size="84.00">build_site._categorise</text>
</a>
</g>
</g>
<!-- build_site._categorise&#45;&gt;lot_io.get_seller -->
<g id="edge197" class="edge">
<title>build_site._categorise&#45;&gt;lot_io.get_seller</title>
<path fill="none" stroke="black" d="M8863.46,-582.88C9005.82,-605.07 9163.98,-629.72 9266.55,-645.71"/>
<polygon fill="black" stroke="black" points="9266.19,-649.2 9276.61,-647.28 9267.27,-642.28 9266.19,-649.2"/>
</g>
<!-- build_site._render_site -->
<g id="node141" class="node">
<title>build_site._render_site</title>
<g id="a_node141"><a xlink:title="Render all HTML pages for ``lots`` using cached templates.&#10;&#10;``envs`` supplies jinja environments for every language so they are&#10;initialised only once. ``rates`` maps currency codes to multipliers relative&#10;to USD. &#160;The values are embedded into the pages so the front&#45;end can&#10;convert prices on the fly.">
<polygon fill="none" stroke="black" points="6909,-706.35 5863,-706.35 5863,-599.35 6909,-599.35 6909,-706.35"/>
<text text-anchor="middle" x="6386" y="-630.22" font-family="Times,serif" font-size="90.16">build_site._render_site</text>
</a>
</g>
</g>
<!-- build_site._render_site&#45;&gt;notes_utils.read_text -->
<g id="edge201" class="edge">
<title>build_site._render_site&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M6909.01,-640.94C7831.32,-621.14 9657.36,-588.14 9707,-635.85 9743.4,-670.83 9739.38,-1493.5 9743,-1543.85 9818.13,-2589.97 9979.64,-3869.88 10005.87,-4074.64"/>
<polygon fill="black" stroke="black" points="10002.43,-4075.37 10007.18,-4084.85 10009.38,-4074.48 10002.43,-4075.37"/>
</g>
<!-- build_site._render_site&#45;&gt;lot_io.get_seller -->
<g id="edge200" class="edge">
<title>build_site._render_site&#45;&gt;lot_io.get_seller</title>
<path fill="none" stroke="black" d="M6909.01,-654.6C7631.45,-657.01 8889.77,-661.22 9266.74,-662.48"/>
<polygon fill="black" stroke="black" points="9266.82,-665.98 9276.83,-662.52 9266.84,-658.98 9266.82,-665.98"/>
</g>
<!-- build_site._render_site&#45;&gt;similar_utils._format_vector -->
<g id="edge198" class="edge">
<title>build_site._render_site&#45;&gt;similar_utils._format_vector</title>
<path fill="none" stroke="black" d="M6909.17,-668.46C7374.95,-684.57 7990.35,-712.22 8035,-746.85 8076.65,-779.15 8030.33,-826.32 8071,-859.85 8168.44,-940.18 8318.37,-943.82 8422.48,-933.93"/>
<polygon fill="black" stroke="black" points="8423.13,-937.38 8432.73,-932.9 8422.43,-930.42 8423.13,-937.38"/>
</g>
<!-- build_site.build_page -->
<g id="node142" class="node">
<title>build_site.build_page</title>
<g id="a_node142"><a xlink:title="Render ``lot`` into separate HTML files for every language.&#10;&#10;``rates`` provides currency multipliers used by the front&#45;end for dynamic&#10;conversion. ``envs`` preloads jinja environments to avoid expensive&#10;reinitialisation for each page.">
<polygon fill="none" stroke="black" points="7959.5,-1780.85 7020.5,-1780.85 7020.5,-1678.85 7959.5,-1678.85 7959.5,-1780.85"/>
<text text-anchor="middle" x="7490" y="-1708.31" font-family="Times,serif" font-size="85.68">build_site.build_page</text>
</a>
</g>
</g>
<!-- build_site._render_site&#45;&gt;build_site.build_page -->
<g id="edge199" class="edge">
<title>build_site._render_site&#45;&gt;build_site.build_page</title>
<path fill="none" stroke="black" d="M6528.43,-706.41C6652.39,-761.57 6825.45,-860.42 6909,-1007.85 6977.48,-1128.69 6852.88,-1527.89 6945,-1631.85 6964.43,-1653.77 6986.96,-1671.86 7011.57,-1686.72"/>
<polygon fill="black" stroke="black" points="7009.96,-1689.83 7020.37,-1691.84 7013.49,-1683.78 7009.96,-1689.83"/>
</g>
<!-- build_site.build_page&#45;&gt;post_io.read_post -->
<g id="edge202" class="edge">
<title>build_site.build_page&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7959.73,-1752.63C8059.36,-1757.47 8161.72,-1762.44 8252.21,-1766.84"/>
<polygon fill="black" stroke="black" points="8252.18,-1770.34 8262.34,-1767.33 8252.52,-1763.35 8252.18,-1770.34"/>
</g>
<!-- build_site.build_page&#45;&gt;post_io.raw_post_path -->
<g id="edge203" class="edge">
<title>build_site.build_page&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7737.97,-1780.96C7848.05,-1817.19 7967.81,-1878.17 8035,-1979.85 8114.17,-2099.66 7979.55,-3161.12 8071,-3271.85 8163.32,-3383.63 8346.42,-3391.62 8454.66,-3385.19"/>
<polygon fill="black" stroke="black" points="8455.15,-3388.66 8464.9,-3384.52 8454.69,-3381.68 8455.15,-3388.66"/>
</g>
<!-- build_site.build_page&#45;&gt;caption_io.read_caption -->
<g id="edge205" class="edge">
<title>build_site.build_page&#45;&gt;caption_io.read_caption</title>
<path fill="none" stroke="black" d="M7623.75,-1780.89C7740.58,-1824.87 7915.76,-1888.55 8071,-1935.85 8200.8,-1975.4 8353.42,-2012.75 8448.57,-2034.97"/>
<polygon fill="black" stroke="black" points="8447.92,-2038.41 8458.45,-2037.27 8449.5,-2031.59 8447.92,-2038.41"/>
</g>
<!-- build_site.build_page&#45;&gt;similar_utils._format_vector -->
<g id="edge204" class="edge">
<title>build_site.build_page&#45;&gt;similar_utils._format_vector</title>
<path fill="none" stroke="black" d="M7959.63,-1691.84C7987.69,-1676.08 8013.28,-1656.36 8035,-1631.85 8127.12,-1527.89 7979.79,-1112.6 8071,-1007.85 8151.55,-915.35 8295.31,-898.6 8402.6,-901"/>
<polygon fill="black" stroke="black" points="8402.77,-904.51 8412.87,-901.29 8402.97,-897.51 8402.77,-904.51"/>
</g>
<!-- build_site.main -->
<g id="node143" class="node">
<title>build_site.main</title>
<g id="a_node143"><a xlink:title="Build the static site under ``VIEWS_DIR``.">
<polygon fill="none" stroke="black" points="5760.5,-446.35 5342.5,-446.35 5342.5,-381.35 5760.5,-381.35 5760.5,-446.35"/>
<text text-anchor="middle" x="5551.5" y="-400.8" font-family="Times,serif" font-size="51.94">build_site.main</text>
</a>
</g>
</g>
<!-- build_site.main&#45;&gt;price_utils.canonical_currency -->
<g id="edge206" class="edge">
<title>build_site.main&#45;&gt;price_utils.canonical_currency</title>
<path fill="none" stroke="black" d="M5582.51,-381.01C5633.82,-327.57 5744.41,-223.72 5863,-183.85 6021.32,-130.63 8481.06,-149.45 9187.9,-155.99"/>
<polygon fill="black" stroke="black" points="9187.89,-159.49 9197.92,-156.08 9187.95,-152.49 9187.89,-159.49"/>
</g>
<!-- build_site.main&#45;&gt;price_utils.fetch_official_rates -->
<g id="edge207" class="edge">
<title>build_site.main&#45;&gt;price_utils.fetch_official_rates</title>
<path fill="none" stroke="black" d="M5603.37,-381.2C5662.96,-344.79 5765.94,-287.52 5863,-260.85 5925.12,-243.78 5992.84,-233.03 6058.31,-226.39"/>
<polygon fill="black" stroke="black" points="6058.76,-229.86 6068.37,-225.4 6058.08,-222.9 6058.76,-229.86"/>
</g>
<!-- build_site.main&#45;&gt;price_utils.load_price_model -->
<g id="edge208" class="edge">
<title>build_site.main&#45;&gt;price_utils.load_price_model</title>
<path fill="none" stroke="black" d="M5571.55,-446.52C5624.76,-539.85 5774.48,-817.22 5827,-1069.85 5841.91,-1141.55 5815.23,-3650.35 5863,-3705.85 6180.93,-4075.22 6459.54,-3840.97 6945,-3883.85 7422.38,-3926.02 7983.17,-3920.78 8296.63,-3912.96"/>
<polygon fill="black" stroke="black" points="8296.85,-3916.45 8306.76,-3912.7 8296.67,-3909.46 8296.85,-3916.45"/>
</g>
<!-- build_site.main&#45;&gt;price_utils.apply_price_model -->
<g id="edge209" class="edge">
<title>build_site.main&#45;&gt;price_utils.apply_price_model</title>
<path fill="none" stroke="black" d="M5760.7,-396.59C5838.95,-390.11 5930.42,-382.53 6018.82,-375.2"/>
<polygon fill="black" stroke="black" points="6019.35,-378.67 6029.03,-374.35 6018.77,-371.69 6019.35,-378.67"/>
</g>
<!-- build_site.main&#45;&gt;price_utils.prepare_price_fields -->
<g id="edge210" class="edge">
<title>build_site.main&#45;&gt;price_utils.prepare_price_fields</title>
<path fill="none" stroke="black" d="M5576.11,-381.2C5622.73,-319.86 5733.4,-189.04 5863,-138.85 6071.08,-58.26 7473.07,-77.18 8161.11,-91.67"/>
<polygon fill="black" stroke="black" points="8161.11,-95.18 8171.18,-91.89 8161.26,-88.18 8161.11,-95.18"/>
</g>
<!-- build_site.main&#45;&gt;similar_utils._sync_embeddings -->
<g id="edge211" class="edge">
<title>build_site.main&#45;&gt;similar_utils._sync_embeddings</title>
<path fill="none" stroke="black" d="M5571.35,-446.56C5624.03,-540.01 5772.49,-817.65 5827,-1069.85 5841.37,-1136.34 5815.06,-2245.58 5863,-2293.85 5903.98,-2335.11 6850.9,-2329.44 6909,-2331.85 7017.92,-2336.36 7138.33,-2341.88 7241.07,-2346.75"/>
<polygon fill="black" stroke="black" points="7241.12,-2350.26 7251.28,-2347.24 7241.46,-2343.26 7241.12,-2350.26"/>
</g>
<!-- build_site.main&#45;&gt;config_utils.load_config -->
<g id="edge212" class="edge">
<title>build_site.main&#45;&gt;config_utils.load_config</title>
<path fill="none" stroke="black" d="M5570.02,-381.28C5610.47,-309.97 5718.09,-141.21 5863,-75.85 6192.44,72.75 7127.6,-43.85 7489,-43.85 7489,-43.85 7489,-43.85 8542.5,-43.85 8802,-43.85 9530.01,58.93 9707,-130.85 9805.02,-235.96 9646.33,-1317.49 9743,-1423.85 9754.86,-1436.9 9769.04,-1446.81 9784.58,-1454.23"/>
<polygon fill="black" stroke="black" points="9783.32,-1457.5 9793.88,-1458.32 9786.14,-1451.09 9783.32,-1457.5"/>
</g>
<!-- build_site.main&#45;&gt;build_site._env_for_lang -->
<g id="edge213" class="edge">
<title>build_site.main&#45;&gt;build_site._env_for_lang</title>
<path fill="none" stroke="black" d="M5760.7,-422.6C5891.17,-428.09 6058.36,-435.12 6186.88,-440.52"/>
<polygon fill="black" stroke="black" points="6187.1,-444.03 6197.24,-440.96 6187.39,-437.04 6187.1,-444.03"/>
</g>
<!-- build_site.main&#45;&gt;build_site._copy_static -->
<g id="edge214" class="edge">
<title>build_site.main&#45;&gt;build_site._copy_static</title>
<path fill="none" stroke="black" d="M5626.76,-381.25C5688.64,-355.75 5779.8,-322 5863,-305.85 6091.46,-261.5 6688.68,-329.79 6909,-254.85 6927.44,-248.58 6926.58,-236.2 6945,-229.85 7077.72,-184.1 7239.36,-180.97 7351.81,-186.43"/>
<polygon fill="black" stroke="black" points="7351.68,-189.93 7361.85,-186.94 7352.04,-182.94 7351.68,-189.93"/>
</g>
<!-- build_site.main&#45;&gt;build_site._load_state -->
<g id="edge215" class="edge">
<title>build_site.main&#45;&gt;build_site._load_state</title>
<path fill="none" stroke="black" d="M5571.55,-446.52C5624.77,-539.85 5774.51,-817.22 5827,-1069.85 5842.15,-1142.77 5822.34,-3688.45 5863,-3750.85 5948.55,-3882.17 6125.94,-3942.33 6250.08,-3969.22"/>
<polygon fill="black" stroke="black" points="6249.54,-3972.68 6260.04,-3971.33 6250.99,-3965.83 6249.54,-3972.68"/>
</g>
<!-- build_site.main&#45;&gt;build_site._categorise -->
<g id="edge216" class="edge">
<title>build_site.main&#45;&gt;build_site._categorise</title>
<path fill="none" stroke="black" d="M5685.42,-446.42C5740.08,-458.46 5804.25,-470.87 5863,-477.85 6627.56,-568.69 7523.35,-565.02 8060.67,-551.1"/>
<polygon fill="black" stroke="black" points="8061.02,-554.6 8070.93,-550.84 8060.84,-547.6 8061.02,-554.6"/>
</g>
<!-- build_site.main&#45;&gt;build_site._render_site -->
<g id="edge217" class="edge">
<title>build_site.main&#45;&gt;build_site._render_site</title>
<path fill="none" stroke="black" d="M5617.64,-446.4C5679.47,-476.17 5775.67,-519.59 5863,-546.85 5925.24,-566.27 5992.79,-583.04 6058.01,-597.14"/>
<polygon fill="black" stroke="black" points="6057.52,-600.61 6068.03,-599.29 6058.99,-593.77 6057.52,-600.61"/>
</g>
<!-- clean_data._parse_date -->
<g id="node144" class="node">
<title>clean_data._parse_date</title>
<g id="a_node144"><a xlink:title="Return the ``date`` field from a markdown file if present.">
<polygon fill="none" stroke="black" points="8681,-3187.85 8402,-3187.85 8402,-3151.85 8681,-3151.85 8681,-3187.85"/>
<text text-anchor="middle" x="8541.5" y="-3164.15" font-family="Times,serif" font-size="22.12">clean_data._parse_date</text>
</a>
</g>
</g>
<!-- clean_data._parse_date&#45;&gt;notes_utils.read_text -->
<g id="edge218" class="edge">
<title>clean_data._parse_date&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M8681.07,-3155.77C8777.17,-3151.22 8906.36,-3155.66 9012,-3196.85 9504.23,-3388.76 9904.26,-3947.12 9991.71,-4076.06"/>
<polygon fill="black" stroke="black" points="9988.97,-4078.26 9997.47,-4084.59 9994.78,-4074.34 9988.97,-4078.26"/>
</g>
<!-- clean_data._clean_raw -->
<g id="node145" class="node">
<title>clean_data._clean_raw</title>
<g id="a_node145"><a xlink:title="Delete raw posts older than ``cutoff``.">
<polygon fill="none" stroke="black" points="7643.5,-3127.85 7336.5,-3127.85 7336.5,-3091.85 7643.5,-3091.85 7643.5,-3127.85"/>
<text text-anchor="middle" x="7490" y="-3103.69" font-family="Times,serif" font-size="25.20">clean_data._clean_raw</text>
</a>
</g>
</g>
<!-- clean_data._clean_raw&#45;&gt;post_io.raw_post_path -->
<g id="edge219" class="edge">
<title>clean_data._clean_raw&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7643.78,-3102.97C7762.89,-3105.63 7925.86,-3127.91 8035,-3217.85 8067.61,-3244.72 8037.75,-3279.77 8071,-3305.85 8181.28,-3392.37 8352.27,-3394.82 8454.62,-3386.72"/>
<polygon fill="black" stroke="black" points="8454.94,-3390.21 8464.61,-3385.88 8454.35,-3383.23 8454.94,-3390.21"/>
</g>
<!-- clean_data._clean_raw&#45;&gt;clean_data._parse_date -->
<g id="edge220" class="edge">
<title>clean_data._clean_raw&#45;&gt;clean_data._parse_date</title>
<path fill="none" stroke="black" d="M7643.61,-3118.57C7843.93,-3130.03 8193.34,-3150 8391.74,-3161.34"/>
<polygon fill="black" stroke="black" points="8391.77,-3164.85 8401.95,-3161.93 8392.16,-3157.86 8391.77,-3164.85"/>
</g>
<!-- clean_data._clean_media -->
<g id="node146" class="node">
<title>clean_data._clean_media</title>
<g id="a_node146"><a xlink:title="Remove unused media files older than ``cutoff``.">
<polygon fill="none" stroke="black" points="7680,-2650.85 7300,-2650.85 7300,-2610.85 7680,-2610.85 7680,-2650.85"/>
<text text-anchor="middle" x="7490" y="-2623.78" font-family="Times,serif" font-size="28.84">clean_data._clean_media</text>
</a>
</g>
</g>
<!-- clean_data._clean_media&#45;&gt;caption_io.has_caption -->
<g id="edge222" class="edge">
<title>clean_data._clean_media&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M7680.06,-2646.53C7817.05,-2653.29 7986.39,-2650.62 8035,-2601.85 8091.55,-2545.12 8014.57,-1938.7 8071,-1881.85 8122.68,-1829.78 8333.14,-1837.51 8454.01,-1846.74"/>
<polygon fill="black" stroke="black" points="8453.74,-1850.23 8463.99,-1847.52 8454.29,-1843.25 8453.74,-1850.23"/>
</g>
<!-- clean_data._clean_media&#45;&gt;clean_data._parse_date -->
<g id="edge221" class="edge">
<title>clean_data._clean_media&#45;&gt;clean_data._parse_date</title>
<path fill="none" stroke="black" d="M7680.08,-2629.58C7817.32,-2633.02 7987,-2647.8 8035,-2697.85 8103.67,-2769.45 8000.03,-3073.52 8071,-3142.85 8115.24,-3186.07 8271.53,-3187.59 8391.76,-3181.63"/>
<polygon fill="black" stroke="black" points="8392.01,-3185.12 8401.82,-3181.11 8391.65,-3178.13 8392.01,-3185.12"/>
</g>
<!-- clean_data._clean_lots -->
<g id="node147" class="node">
<title>clean_data._clean_lots</title>
<g id="a_node147"><a xlink:title="Drop lots missing translations or source posts.">
<polygon fill="none" stroke="black" points="7692,-2538.85 7288,-2538.85 7288,-2492.85 7692,-2492.85 7692,-2538.85"/>
<text text-anchor="middle" x="7490" y="-2507.41" font-family="Times,serif" font-size="34.30">clean_data._clean_lots</text>
</a>
</g>
</g>
<!-- clean_data._clean_lots&#45;&gt;post_io.raw_post_path -->
<g id="edge223" class="edge">
<title>clean_data._clean_lots&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7692.21,-2500.78C7826.94,-2495.55 7987.93,-2500.35 8035,-2547.85 8091.69,-2605.06 8019.04,-3210.31 8071,-3271.85 8164.4,-3382.46 8346.69,-3390.94 8454.59,-3384.9"/>
<polygon fill="black" stroke="black" points="8455.03,-3388.38 8464.79,-3384.27 8454.6,-3381.39 8455.03,-3388.38"/>
</g>
<!-- clean_data._clean_lots&#45;&gt;lot_io.read_lots -->
<g id="edge225" class="edge">
<title>clean_data._clean_lots&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M7692.11,-2515.85C7909.6,-2515.85 8248.78,-2515.85 8425.17,-2515.85"/>
<polygon fill="black" stroke="black" points="8425.26,-2519.35 8435.26,-2515.85 8425.26,-2512.35 8425.26,-2519.35"/>
</g>
<!-- clean_data._clean_lots&#45;&gt;lot_io.needs_cleanup -->
<g id="edge224" class="edge">
<title>clean_data._clean_lots&#45;&gt;lot_io.needs_cleanup</title>
<path fill="none" stroke="black" d="M7692.11,-2504.54C7916.64,-2491.92 8270.86,-2472.01 8441.78,-2462.4"/>
<polygon fill="black" stroke="black" points="8441.98,-2465.89 8451.77,-2461.84 8441.59,-2458.9 8441.98,-2465.89"/>
</g>
<!-- clean_data._clean_embeddings -->
<g id="node148" class="node">
<title>clean_data._clean_embeddings</title>
<g id="a_node148"><a xlink:title="Delete embedding files when the matching lot JSON is absent.">
<polygon fill="none" stroke="black" points="7698,-2592.85 7282,-2592.85 7282,-2556.85 7698,-2556.85 7698,-2592.85"/>
<text text-anchor="middle" x="7490" y="-2568.69" font-family="Times,serif" font-size="25.20">clean_data._clean_embeddings</text>
</a>
</g>
</g>
<!-- clean_data._remove_empty_dirs -->
<g id="node149" class="node">
<title>clean_data._remove_empty_dirs</title>
<g id="a_node149"><a xlink:title="Recursively remove empty folders under ``root``.">
<polygon fill="none" stroke="black" points="8755,-2733.85 8328,-2733.85 8328,-2697.85 8755,-2697.85 8755,-2733.85"/>
<text text-anchor="middle" x="8541.5" y="-2709.69" font-family="Times,serif" font-size="25.20">clean_data._remove_empty_dirs</text>
</a>
</g>
</g>
<!-- clean_data.main -->
<g id="node150" class="node">
<title>clean_data.main</title>
<g id="a_node150"><a xlink:title="Clean up old or inconsistent files across data directories.">
<polygon fill="none" stroke="black" points="6482,-2648.85 6290,-2648.85 6290,-2612.85 6482,-2612.85 6482,-2648.85"/>
<text text-anchor="middle" x="6386" y="-2625.55" font-family="Times,serif" font-size="21.00">clean_data.main</text>
</a>
</g>
</g>
<!-- clean_data.main&#45;&gt;clean_data._clean_raw -->
<g id="edge226" class="edge">
<title>clean_data.main&#45;&gt;clean_data._clean_raw</title>
<path fill="none" stroke="black" d="M6440.93,-2648.87C6547.24,-2687.21 6784.31,-2787.15 6909,-2952.85 6944.79,-3000.41 6898.53,-3044.65 6945,-3081.85 7001.86,-3127.36 7187.21,-3128.25 7325.87,-3121.73"/>
<polygon fill="black" stroke="black" points="7326.37,-3125.21 7336.18,-3121.22 7326.03,-3118.21 7326.37,-3125.21"/>
</g>
<!-- clean_data.main&#45;&gt;clean_data._clean_media -->
<g id="edge227" class="edge">
<title>clean_data.main&#45;&gt;clean_data._clean_media</title>
<path fill="none" stroke="black" d="M6482.39,-2630.85C6661.38,-2630.85 7051.03,-2630.85 7289.61,-2630.85"/>
<polygon fill="black" stroke="black" points="7289.8,-2634.35 7299.8,-2630.85 7289.8,-2627.35 7289.8,-2634.35"/>
</g>
<!-- clean_data.main&#45;&gt;clean_data._clean_lots -->
<g id="edge228" class="edge">
<title>clean_data.main&#45;&gt;clean_data._clean_lots</title>
<path fill="none" stroke="black" d="M6482.45,-2614.01C6593.3,-2595.07 6781.82,-2564.75 6945,-2547.85 7054.51,-2536.51 7176.88,-2528.86 7277.78,-2523.9"/>
<polygon fill="black" stroke="black" points="7277.97,-2527.4 7287.79,-2523.41 7277.63,-2520.4 7277.97,-2527.4"/>
</g>
<!-- clean_data.main&#45;&gt;clean_data._clean_embeddings -->
<g id="edge229" class="edge">
<title>clean_data.main&#45;&gt;clean_data._clean_embeddings</title>
<path fill="none" stroke="black" d="M6482.28,-2625.83C6593.36,-2619.99 6782.48,-2610.11 6945,-2601.85 7052.51,-2596.39 7171.98,-2590.44 7271.51,-2585.53"/>
<polygon fill="black" stroke="black" points="7271.88,-2589.01 7281.69,-2585.02 7271.53,-2582.02 7271.88,-2589.01"/>
</g>
<!-- clean_data.main&#45;&gt;clean_data._remove_empty_dirs -->
<g id="edge230" class="edge">
<title>clean_data.main&#45;&gt;clean_data._remove_empty_dirs</title>
<path fill="none" stroke="black" d="M6421.98,-2648.87C6508.08,-2692.08 6738.29,-2800.74 6945,-2837.85 7183.41,-2880.65 7834.42,-2973.65 8035,-2837.85 8070.67,-2813.7 8036.17,-2773.2 8071,-2747.85 8110.67,-2718.97 8216.49,-2710.15 8317.64,-2708.92"/>
<polygon fill="black" stroke="black" points="8317.76,-2712.42 8327.73,-2708.82 8317.7,-2705.42 8317.76,-2712.42"/>
</g>
<!-- debug_dump.parse_url -->
<g id="node151" class="node">
<title>debug_dump.parse_url</title>
<g id="a_node151"><a xlink:title="Return ``(lot_id, lang)`` extracted from ``url``.">
<polygon fill="none" stroke="black" points="7639.5,-4847.85 7340.5,-4847.85 7340.5,-4811.85 7639.5,-4811.85 7639.5,-4847.85"/>
<text text-anchor="middle" x="7490" y="-4823.97" font-family="Times,serif" font-size="24.22">debug_dump.parse_url</text>
</a>
</g>
</g>
<!-- debug_dump.guess_source_from_lot -->
<g id="node152" class="node">
<title>debug_dump.guess_source_from_lot</title>
<g id="a_node152"><a xlink:title="Guess ``(chat, message_id)`` directly from ``lot_id``.">
<polygon fill="none" stroke="black" points="8762.5,-4947.85 8320.5,-4947.85 8320.5,-4911.85 8762.5,-4911.85 8762.5,-4947.85"/>
<text text-anchor="middle" x="8541.5" y="-4924.26" font-family="Times,serif" font-size="23.24">debug_dump.guess_source_from_lot</text>
</a>
</g>
</g>
<!-- debug_dump.load_source_info -->
<g id="node153" class="node">
<title>debug_dump.load_source_info</title>
<g id="a_node153"><a xlink:title="Return ``(chat, message_id)`` for ``lot_id`` if available.">
<polygon fill="none" stroke="black" points="7744,-4909.35 7236,-4909.35 7236,-4866.35 7744,-4866.35 7744,-4909.35"/>
<text text-anchor="middle" x="7490" y="-4879.7" font-family="Times,serif" font-size="32.06">debug_dump.load_source_info</text>
</a>
</g>
</g>
<!-- debug_dump.load_source_info&#45;&gt;notes_utils.load_json -->
<g id="edge232" class="edge">
<title>debug_dump.load_source_info&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M7744.07,-4899.12C8131.87,-4910.34 8845.82,-4905.17 9012,-4725.85 9107.01,-4623.32 8962.67,-4208.57 9048,-4097.85 9093.89,-4038.3 9173.59,-4011.42 9242.99,-3999.48"/>
<polygon fill="black" stroke="black" points="9243.84,-4002.89 9253.15,-3997.83 9242.71,-3995.98 9243.84,-4002.89"/>
</g>
<!-- debug_dump.load_source_info&#45;&gt;lot_io.lot_json_path -->
<g id="edge231" class="edge">
<title>debug_dump.load_source_info&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M7744.28,-4904.5C7865.6,-4906.5 7993.45,-4897.82 8035,-4856.85 8115.27,-4777.7 7990.75,-4430.02 8071,-4350.85 8123.24,-4299.31 8333.61,-4306.84 8454.28,-4315.89"/>
<polygon fill="black" stroke="black" points="8454.36,-4319.41 8464.6,-4316.69 8454.9,-4312.43 8454.36,-4319.41"/>
</g>
<!-- debug_dump.run_tg_fetch -->
<g id="node154" class="node">
<title>debug_dump.run_tg_fetch</title>
<g id="a_node154"><a xlink:title="Run ``tg_client.py &#45;&#45;fetch`` and return combined logs.">
<polygon fill="none" stroke="black" points="9603.5,-4939.85 9151.5,-4939.85 9151.5,-4895.85 9603.5,-4895.85 9603.5,-4939.85"/>
<text text-anchor="middle" x="9377.5" y="-4909.53" font-family="Times,serif" font-size="32.90">debug_dump.run_tg_fetch</text>
</a>
</g>
</g>
<!-- debug_dump.run_tg_fetch&#45;&gt;notes_utils.read_text -->
<g id="edge233" class="edge">
<title>debug_dump.run_tg_fetch&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M9589.74,-4895.79C9632.17,-4883.36 9673.85,-4864.46 9707,-4835.85 9935.73,-4638.45 9994.6,-4240.8 10006.75,-4131.32"/>
<polygon fill="black" stroke="black" points="10010.26,-4131.39 10007.84,-4121.08 10003.3,-4130.65 10010.26,-4131.39"/>
</g>
<!-- debug_dump.collect_files -->
<g id="node155" class="node">
<title>debug_dump.collect_files</title>
<g id="a_node155"><a xlink:title="Return ``[(name, content), ...]`` for files related to ``lot_id``.">
<polygon fill="none" stroke="black" points="7737,-3875.35 7243,-3875.35 7243,-3826.35 7737,-3826.35 7737,-3875.35"/>
<text text-anchor="middle" x="7490" y="-3841.67" font-family="Times,serif" font-size="37.10">debug_dump.collect_files</text>
</a>
</g>
</g>
<!-- debug_dump.collect_files&#45;&gt;post_io.raw_post_path -->
<g id="edge234" class="edge">
<title>debug_dump.collect_files&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7737.07,-3862.35C7859.94,-3862.51 7991.52,-3852.35 8035,-3811.85 8117.46,-3735.03 8001.11,-3649.26 8071,-3560.85 8165.08,-3441.84 8346.71,-3399.18 8454.39,-3384.04"/>
<polygon fill="black" stroke="black" points="8455.14,-3387.47 8464.58,-3382.66 8454.2,-3380.54 8455.14,-3387.47"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;notes_utils.read_text -->
<g id="edge236" class="edge">
<title>debug_dump.collect_files&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M7737.09,-3832.71C7840.19,-3825.97 7961.35,-3819.16 8071,-3815.85 8800.75,-3793.85 9014.04,-3734 9707,-3963.85 9803.39,-3995.82 9909.98,-4049.39 9967.35,-4079.85"/>
<polygon fill="black" stroke="black" points="9965.99,-4083.09 9976.46,-4084.71 9969.29,-4076.91 9965.99,-4083.09"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;caption_io.has_caption -->
<g id="edge239" class="edge">
<title>debug_dump.collect_files&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M7737.12,-3846.52C7845.95,-3830.8 7964.91,-3791.86 8035,-3701.85 8097.13,-3622.06 8000.85,-1954.69 8071,-1881.85 8121.89,-1829.01 8332.67,-1837.05 8453.8,-1846.53"/>
<polygon fill="black" stroke="black" points="8453.55,-1850.02 8463.8,-1847.34 8454.11,-1843.05 8453.55,-1850.02"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;caption_io.read_caption -->
<g id="edge240" class="edge">
<title>debug_dump.collect_files&#45;&gt;caption_io.read_caption</title>
<path fill="none" stroke="black" d="M7737.24,-3846.29C7845.93,-3830.5 7964.73,-3791.56 8035,-3701.85 8131.91,-3578.12 7986.37,-2420.28 8071,-2287.85 8150.07,-2164.12 8316.23,-2104.17 8428.13,-2076.77"/>
<polygon fill="black" stroke="black" points="8429.2,-2080.11 8438.11,-2074.38 8427.57,-2073.31 8429.2,-2080.11"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;notes_utils.load_json -->
<g id="edge237" class="edge">
<title>debug_dump.collect_files&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M7737.28,-3832.83C8039.71,-3815.73 8567.28,-3802.19 9012,-3874.85 9126.71,-3893.59 9254.94,-3940.92 9324.59,-3969"/>
<polygon fill="black" stroke="black" points="9323.44,-3972.31 9334.02,-3972.82 9326.07,-3965.82 9323.44,-3972.31"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;caption_io.caption_json_path -->
<g id="edge238" class="edge">
<title>debug_dump.collect_files&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M7737.08,-3874.99C7834.83,-3874.22 7945.15,-3859.68 8035,-3811.85 8057.92,-3799.65 8050.14,-3781.3 8071,-3765.85 8431.23,-3499.06 8740.79,-3759.75 9012,-3402.85 9061.98,-3337.08 9009.19,-3105.78 9048,-3032.85 9112.36,-2911.89 9255.69,-2824.04 9329.93,-2784.75"/>
<polygon fill="black" stroke="black" points="9331.82,-2787.71 9339.06,-2779.98 9328.58,-2781.51 9331.82,-2787.71"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;lot_io.lot_json_path -->
<g id="edge235" class="edge">
<title>debug_dump.collect_files&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M7627.33,-3826.34C7751.79,-3812.55 7931.63,-3815.73 8035,-3922.85 8092.98,-3982.93 8010.83,-4238.96 8071,-4296.85 8123.88,-4347.73 8333.99,-4340.47 8454.45,-4331.63"/>
<polygon fill="black" stroke="black" points="8455.04,-4335.1 8464.75,-4330.85 8454.51,-4328.12 8455.04,-4335.1"/>
</g>
<!-- debug_dump.delete_files -->
<g id="node156" class="node">
<title>debug_dump.delete_files</title>
<g id="a_node156"><a xlink:title="Remove files related to ``lot_id`` from the filesystem.">
<polygon fill="none" stroke="black" points="7705.5,-4269.85 7274.5,-4269.85 7274.5,-4225.85 7705.5,-4225.85 7705.5,-4269.85"/>
<text text-anchor="middle" x="7490" y="-4239.53" font-family="Times,serif" font-size="32.90">debug_dump.delete_files</text>
</a>
</g>
</g>
<!-- debug_dump.delete_files&#45;&gt;post_io.raw_post_path -->
<g id="edge241" class="edge">
<title>debug_dump.delete_files&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7705.68,-4262.86C7837.11,-4266.96 7988.7,-4260.85 8035,-4215.85 8100.9,-4151.79 8030.25,-3886.23 8071,-3803.85 8169.31,-3605.12 8402.71,-3454.59 8498.43,-3399.1"/>
<polygon fill="black" stroke="black" points="8500.33,-3402.04 8507.26,-3394.03 8496.84,-3395.97 8500.33,-3402.04"/>
</g>
<!-- debug_dump.delete_files&#45;&gt;notes_utils.load_json -->
<g id="edge243" class="edge">
<title>debug_dump.delete_files&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M7705.79,-4247.11C8067.59,-4243.19 8781.62,-4223.16 9012,-4127.85 9031.25,-4119.89 9029.77,-4107.92 9048,-4097.85 9122.18,-4056.86 9214.55,-4028.52 9282.43,-4011.36"/>
<polygon fill="black" stroke="black" points="9283.41,-4014.72 9292.27,-4008.9 9281.72,-4007.93 9283.41,-4014.72"/>
</g>
<!-- debug_dump.delete_files&#45;&gt;caption_io.caption_json_path -->
<g id="edge244" class="edge">
<title>debug_dump.delete_files&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M7705.78,-4262.6C7837.01,-4266.56 7988.34,-4260.39 8035,-4215.85 8090.12,-4163.23 8022.18,-3933.36 8071,-3874.85 8350.22,-3540.19 8739.81,-3939.25 9012,-3598.85 9090.71,-3500.42 8990.67,-3145.09 9048,-3032.85 9110.25,-2910.99 9254.2,-2823.68 9329.17,-2784.66"/>
<polygon fill="black" stroke="black" points="9331.11,-2787.6 9338.4,-2779.92 9327.91,-2781.38 9331.11,-2787.6"/>
</g>
<!-- debug_dump.delete_files&#45;&gt;caption_io.caption_md_path -->
<g id="edge245" class="edge">
<title>debug_dump.delete_files&#45;&gt;caption_io.caption_md_path</title>
<path fill="none" stroke="black" d="M7705.86,-4263.74C7837.84,-4268.27 7990,-4262.32 8035,-4215.85 8139.23,-4108.22 7965.5,-2974.24 8071,-2867.85 8144.67,-2793.56 8936.67,-2907.45 9012,-2834.85 9092.21,-2757.54 8997.62,-2434.2 9048,-2334.85 9111.12,-2210.37 9256.65,-2119.17 9330.99,-2078.84"/>
<polygon fill="black" stroke="black" points="9332.97,-2081.75 9340.13,-2073.95 9329.66,-2075.58 9332.97,-2081.75"/>
</g>
<!-- debug_dump.delete_files&#45;&gt;lot_io.lot_json_path -->
<g id="edge242" class="edge">
<title>debug_dump.delete_files&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M7705.67,-4240.18C7807.06,-4241.58 7928.85,-4250.58 8035,-4278.85 8052.29,-4283.45 8053.72,-4292.24 8071,-4296.85 8201.35,-4331.6 8359.02,-4332.74 8454.44,-4329.18"/>
<polygon fill="black" stroke="black" points="8454.77,-4332.67 8464.62,-4328.77 8454.49,-4325.68 8454.77,-4332.67"/>
</g>
<!-- debug_dump._message_reason -->
<g id="node157" class="node">
<title>debug_dump._message_reason</title>
<g id="a_node157"><a xlink:title="Return explanation why a message would be skipped.">
<polygon fill="none" stroke="black" points="9650,-4418.35 9105,-4418.35 9105,-4373.35 9650,-4373.35 9650,-4418.35"/>
<text text-anchor="middle" x="9377.5" y="-4387.47" font-family="Times,serif" font-size="33.60">debug_dump._message_reason</text>
</a>
</g>
</g>
<!-- debug_dump._message_reason&#45;&gt;moderation.should_skip_user -->
<g id="edge246" class="edge">
<title>debug_dump._message_reason&#45;&gt;moderation.should_skip_user</title>
<path fill="none" stroke="black" d="M9431.59,-4373.25C9507.04,-4338.04 9643.2,-4262.47 9707,-4151.85 9844.77,-3912.96 9989.58,-1813.83 10007.62,-1545.12"/>
<polygon fill="black" stroke="black" points="10011.12,-1545.22 10008.3,-1535.01 10004.14,-1544.75 10011.12,-1545.22"/>
</g>
<!-- debug_dump._lot_reason -->
<g id="node158" class="node">
<title>debug_dump._lot_reason</title>
<g id="a_node158"><a xlink:title="Return explanation why ``lot`` would be skipped.">
<polygon fill="none" stroke="black" points="9531.5,-4631.85 9223.5,-4631.85 9223.5,-4595.85 9531.5,-4595.85 9531.5,-4631.85"/>
<text text-anchor="middle" x="9377.5" y="-4608.26" font-family="Times,serif" font-size="23.24">debug_dump._lot_reason</text>
</a>
</g>
</g>
<!-- debug_dump.moderation_summary -->
<g id="node159" class="node">
<title>debug_dump.moderation_summary</title>
<g id="a_node159"><a xlink:title="Return a multi&#45;line summary of moderation checks for ``lot_id``.">
<polygon fill="none" stroke="black" points="7936.5,-4679.85 7043.5,-4679.85 7043.5,-4617.85 7936.5,-4617.85 7936.5,-4679.85"/>
<text text-anchor="middle" x="7490" y="-4636.65" font-family="Times,serif" font-size="49.00">debug_dump.moderation_summary</text>
</a>
</g>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;post_io.read_post -->
<g id="edge247" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7936.54,-4648.83C7981.38,-4640.65 8017.03,-4627.94 8035,-4608.85 8140.91,-4496.34 7966.59,-1941.75 8071,-1827.85 8117.43,-1777.2 8183.83,-1754.7 8252.14,-1747.33"/>
<polygon fill="black" stroke="black" points="8252.61,-1750.8 8262.23,-1746.35 8251.94,-1743.83 8252.61,-1750.8"/>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;post_io.raw_post_path -->
<g id="edge248" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7936.52,-4648.12C7981.17,-4640.02 8016.77,-4627.53 8035,-4608.85 8092.03,-4550.41 8039.05,-3949.99 8071,-3874.85 8166.8,-3649.5 8412.12,-3463.9 8504.55,-3399.84"/>
<polygon fill="black" stroke="black" points="8506.75,-3402.58 8513,-3394.03 8502.78,-3396.81 8506.75,-3402.58"/>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;notes_utils.load_json -->
<g id="edge252" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M7658.65,-4679.86C7775.08,-4691.79 7927.92,-4687.23 8035,-4608.85 8069.76,-4583.4 8035.91,-4543.85 8071,-4518.85 8156.25,-4458.11 8936.24,-4546.08 9012,-4473.85 9072.75,-4415.93 8995.5,-4163.34 9048,-4097.85 9094.84,-4039.41 9174.13,-4012.53 9243.08,-4000.31"/>
<polygon fill="black" stroke="black" points="9243.89,-4003.73 9253.17,-3998.62 9242.73,-3996.82 9243.89,-4003.73"/>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;lot_io.lot_json_path -->
<g id="edge251" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M7936.53,-4646.31C7980.7,-4638.44 8016.17,-4626.49 8035,-4608.85 8119.49,-4529.7 7985.88,-4429.33 8071,-4350.85 8124.88,-4301.18 8334.07,-4307.89 8454.25,-4316.34"/>
<polygon fill="black" stroke="black" points="8454.3,-4319.85 8464.52,-4317.08 8454.8,-4312.87 8454.3,-4319.85"/>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;debug_dump._message_reason -->
<g id="edge249" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;debug_dump._message_reason</title>
<path fill="none" stroke="black" d="M7936.58,-4622.96C8310.34,-4598.99 8813.9,-4560.8 9012,-4518.85 9120.49,-4495.88 9241.59,-4450.96 9313.3,-4422.23"/>
<polygon fill="black" stroke="black" points="9314.69,-4425.44 9322.65,-4418.46 9312.07,-4418.95 9314.69,-4425.44"/>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;debug_dump._lot_reason -->
<g id="edge250" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;debug_dump._lot_reason</title>
<path fill="none" stroke="black" d="M7936.68,-4635.97C7982.05,-4634.83 8027.44,-4633.77 8071,-4632.85 8482.01,-4624.19 8965.88,-4618.26 9213.1,-4615.54"/>
<polygon fill="black" stroke="black" points="9213.28,-4619.04 9223.24,-4615.43 9213.2,-4612.04 9213.28,-4619.04"/>
</g>
<!-- debug_dump.main -->
<g id="node160" class="node">
<title>debug_dump.main</title>
<g id="a_node160"><a xlink:title="Collect log and data files related to a single lot.">
<polygon fill="none" stroke="black" points="6624,-4873.85 6148,-4873.85 6148,-4811.85 6624,-4811.85 6624,-4873.85"/>
<text text-anchor="middle" x="6386" y="-4830.65" font-family="Times,serif" font-size="49.00">debug_dump.main</text>
</a>
</g>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.parse_url -->
<g id="edge253" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.parse_url</title>
<path fill="none" stroke="black" d="M6624.08,-4840.05C6837.45,-4837.54 7145.06,-4833.91 7330.14,-4831.72"/>
<polygon fill="black" stroke="black" points="7330.27,-4835.22 7340.23,-4831.6 7330.19,-4828.22 7330.27,-4835.22"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.guess_source_from_lot -->
<g id="edge254" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.guess_source_from_lot</title>
<path fill="none" stroke="black" d="M6573.35,-4873.88C6681.51,-4890.39 6820.56,-4909.05 6945,-4917.85 7430.02,-4952.13 8000.03,-4945.04 8310.44,-4937.2"/>
<polygon fill="black" stroke="black" points="8310.56,-4940.7 8320.46,-4936.94 8310.38,-4933.7 8310.56,-4940.7"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.load_source_info -->
<g id="edge255" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.load_source_info</title>
<path fill="none" stroke="black" d="M6624.08,-4852.53C6800.96,-4859.75 7042.59,-4869.62 7225.51,-4877.09"/>
<polygon fill="black" stroke="black" points="7225.41,-4880.59 7235.54,-4877.5 7225.69,-4873.59 7225.41,-4880.59"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.run_tg_fetch -->
<g id="edge256" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.run_tg_fetch</title>
<path fill="none" stroke="black" d="M6520.56,-4873.88C6633.04,-4898.41 6798.57,-4930.79 6945,-4944.85 7402.24,-4988.75 8553.31,-4981.32 9012,-4956.85 9072.08,-4953.64 9137.49,-4947.49 9196.1,-4941"/>
<polygon fill="black" stroke="black" points="9196.65,-4944.46 9206.2,-4939.87 9195.87,-4937.5 9196.65,-4944.46"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.collect_files -->
<g id="edge257" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.collect_files</title>
<path fill="none" stroke="black" d="M6447.36,-4811.63C6561.04,-4749.13 6804.84,-4596.69 6909,-4389.85 6955.81,-4296.89 6873.44,-3998.43 6945,-3922.85 7045.68,-3816.51 7221.58,-3811.91 7346.08,-3825.22"/>
<polygon fill="black" stroke="black" points="7345.75,-3828.7 7356.07,-3826.34 7346.53,-3821.75 7345.75,-3828.7"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.delete_files -->
<g id="edge258" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.delete_files</title>
<path fill="none" stroke="black" d="M6438.98,-4811.68C6543.36,-4746.49 6779.5,-4585.45 6909,-4389.85 6937.63,-4346.61 6903.93,-4310.53 6945,-4278.85 6994.36,-4240.77 7137.1,-4233.69 7263.98,-4235.77"/>
<polygon fill="black" stroke="black" points="7264.19,-4239.28 7274.25,-4235.96 7264.32,-4232.28 7264.19,-4239.28"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.moderation_summary -->
<g id="edge259" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.moderation_summary</title>
<path fill="none" stroke="black" d="M6563.14,-4811.84C6765.43,-4776.23 7095.92,-4718.05 7302.48,-4681.68"/>
<polygon fill="black" stroke="black" points="7303.29,-4685.1 7312.53,-4679.92 7302.07,-4678.2 7303.29,-4685.1"/>
</g>
<!-- embed.main -->
<g id="node162" class="node">
<title>embed.main</title>
<g id="a_node162"><a xlink:title="Embed the file given on the command line.">
<polygon fill="none" stroke="black" points="6474,-1334.85 6298,-1334.85 6298,-1298.85 6474,-1298.85 6474,-1334.85"/>
<text text-anchor="middle" x="6386" y="-1310.69" font-family="Times,serif" font-size="25.20">embed.main</text>
</a>
</g>
</g>
<!-- embed.main&#45;&gt;embed.embed_file -->
<g id="edge263" class="edge">
<title>embed.main&#45;&gt;embed.embed_file</title>
<path fill="none" stroke="black" d="M6474.39,-1318.28C6645.99,-1321.08 7031.41,-1327.38 7274.73,-1331.35"/>
<polygon fill="black" stroke="black" points="7274.71,-1334.85 7284.76,-1331.51 7274.82,-1327.85 7274.71,-1334.85"/>
</g>
<!-- lot_io.get_timestamp -->
<g id="node164" class="node">
<title>lot_io.get_timestamp</title>
<g id="a_node164"><a xlink:title="Return ``lot[&#39;timestamp&#39;]`` as a timezone&#45;aware ``datetime``.">
<polygon fill="none" stroke="black" points="9536.5,-1064.85 9218.5,-1064.85 9218.5,-1024.85 9536.5,-1024.85 9536.5,-1064.85"/>
<text text-anchor="middle" x="9377.5" y="-1037.78" font-family="Times,serif" font-size="28.84">lot_io.get_timestamp</text>
</a>
</g>
</g>
<!-- lot_io.write_lots -->
<g id="node165" class="node">
<title>lot_io.write_lots</title>
<g id="a_node165"><a xlink:title="Write lots to ``path`` using consistent JSON formatting.">
<polygon fill="none" stroke="black" points="8643,-1052.85 8440,-1052.85 8440,-1016.85 8643,-1016.85 8643,-1052.85"/>
<text text-anchor="middle" x="8541.5" y="-1029.26" font-family="Times,serif" font-size="23.24">lot_io.write_lots</text>
</a>
</g>
</g>
<!-- lot_io.write_lots&#45;&gt;notes_utils.write_json -->
<g id="edge272" class="edge">
<title>lot_io.write_lots&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M8643.25,-1025.58C8765.85,-1016.77 8962.66,-1011.4 9012,-1061.85 9091.37,-1143 8998.53,-1980.68 9048,-2082.85 9108.75,-2208.3 9255.03,-2298.91 9330.2,-2338.96"/>
<polygon fill="black" stroke="black" points="9328.96,-2342.26 9339.44,-2343.82 9332.22,-2336.06 9328.96,-2342.26"/>
</g>
<!-- lot_io.write_lots&#45;&gt;lot_io.get_seller -->
<g id="edge270" class="edge">
<title>lot_io.write_lots&#45;&gt;lot_io.get_seller</title>
<path fill="none" stroke="black" d="M8643.46,-1045.66C8750.8,-1051.06 8917.8,-1040.9 9012,-941.85 9088.15,-861.78 8968.12,-772.2 9048,-695.85 9107.86,-638.64 9204.76,-635.49 9277.84,-643.6"/>
<polygon fill="black" stroke="black" points="9277.64,-647.1 9287.99,-644.82 9278.48,-640.15 9277.64,-647.1"/>
</g>
<!-- lot_io.write_lots&#45;&gt;lot_io._clean_lot -->
<g id="edge269" class="edge">
<title>lot_io.write_lots&#45;&gt;lot_io._clean_lot</title>
<path fill="none" stroke="black" d="M8643.2,-1025.63C8765.75,-1016.87 8962.5,-1011.55 9012,-1061.85 9079.86,-1130.81 8984.08,-1859.22 9048,-1931.85 9112.15,-2004.75 9233.41,-2006.13 9309.3,-1998.43"/>
<polygon fill="black" stroke="black" points="9310.14,-2001.86 9319.7,-1997.29 9309.38,-1994.9 9310.14,-2001.86"/>
</g>
<!-- lot_io.write_lots&#45;&gt;lot_io.get_timestamp -->
<g id="edge271" class="edge">
<title>lot_io.write_lots&#45;&gt;lot_io.get_timestamp</title>
<path fill="none" stroke="black" d="M8643.1,-1036.06C8783.17,-1037.74 9038.78,-1040.8 9208.16,-1042.83"/>
<polygon fill="black" stroke="black" points="9208.14,-1046.33 9218.18,-1042.95 9208.22,-1039.33 9208.14,-1046.33"/>
</g>
<!-- lot_io.embedding_path -->
<g id="node167" class="node">
<title>lot_io.embedding_path</title>
<g id="a_node167"><a xlink:title="Return embedding file path for ``lot_path``.">
<polygon fill="none" stroke="black" points="8648,-2825.85 8435,-2825.85 8435,-2789.85 8648,-2789.85 8648,-2825.85"/>
<text text-anchor="middle" x="8541.5" y="-2803.69" font-family="Times,serif" font-size="17.08">lot_io.embedding_path</text>
</a>
</g>
</g>
<!-- testing_mode.apply_testing_mode -->
<g id="node168" class="node">
<title>testing_mode.apply_testing_mode</title>
<g id="a_node168"><a xlink:title="Tweak environment variables when ``TEST_MODE`` is set.">
<polygon fill="none" stroke="black" points="282,-5058.85 0,-5058.85 0,-5022.85 282,-5022.85 282,-5058.85"/>
<text text-anchor="middle" x="141" y="-5036.81" font-family="Times,serif" font-size="15.68">testing_mode.apply_testing_mode</text>
</a>
</g>
</g>
<!-- scan_ontology:cli -->
<g id="node169" class="node">
<title>scan_ontology:cli</title>
<g id="a_node169"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="650.5" cy="-5040.85" rx="44.19" ry="18"/>
<text text-anchor="middle" x="650.5" y="-5039.25" font-family="Times,serif" font-size="7.00">scan_ontology:cli</text>
</a>
</g>
</g>
<!-- testing_mode.apply_testing_mode&#45;&gt;scan_ontology:cli -->
<!-- telegram_bot:cli -->
<g id="node178" class="node">
<title>telegram_bot:cli</title>
<g id="a_node178"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="1375.5" cy="-5040.85" rx="111.95" ry="19.18"/>
<text text-anchor="middle" x="1375.5" y="-5036.69" font-family="Times,serif" font-size="17.08">telegram_bot:cli</text>
</a>
</g>
</g>
<!-- scan_ontology:cli&#45;&gt;telegram_bot:cli -->
<!-- caption_io._get_langs&#45;&gt;config_utils.load_config -->
<g id="edge282" class="edge">
<title>caption_io._get_langs&#45;&gt;config_utils.load_config</title>
<path fill="none" stroke="black" d="M9448.74,-2433.87C9524.08,-2448.52 9641.65,-2457 9707,-2388.85 9776.19,-2316.69 9675.31,-1563.42 9743,-1489.85 9754.87,-1476.94 9769.01,-1467.12 9784.5,-1459.75"/>
<polygon fill="black" stroke="black" points="9786.01,-1462.91 9793.76,-1455.68 9783.19,-1456.5 9786.01,-1462.91"/>
</g>
<!-- pending_chop.main -->
<g id="node171" class="node">
<title>pending_chop.main</title>
<polygon fill="none" stroke="black" points="7653.5,-1058.85 7326.5,-1058.85 7326.5,-1016.85 7653.5,-1016.85 7653.5,-1058.85"/>
<text text-anchor="middle" x="7490" y="-1029.76" font-family="Times,serif" font-size="31.36">pending_chop.main</text>
</g>
<!-- pending_chop.main&#45;&gt;post_io.read_post -->
<g id="edge294" class="edge">
<title>pending_chop.main&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7653.56,-1024.09C7794.19,-1016.13 7982.9,-1016.2 8035,-1067.85 8124.19,-1156.27 7993.64,-1532.91 8071,-1631.85 8115.9,-1689.27 8182.95,-1724.98 8252.43,-1747.06"/>
<polygon fill="black" stroke="black" points="8251.66,-1750.48 8262.25,-1750.08 8253.72,-1743.79 8251.66,-1750.48"/>
</g>
<!-- pending_chop.main&#45;&gt;moderation.should_skip_message -->
<g id="edge295" class="edge">
<title>pending_chop.main&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M7653.51,-1027.54C7791.7,-1022.18 7976.72,-1024.16 8035,-1067.85 8073.47,-1096.69 8034.65,-1138.38 8071,-1169.85 8150.87,-1238.99 8267.19,-1262.39 8364.07,-1268.44"/>
<polygon fill="black" stroke="black" points="8364.09,-1271.94 8374.28,-1269.02 8364.49,-1264.96 8364.09,-1271.94"/>
</g>
<!-- pending_embed._needs_embedding -->
<g id="node172" class="node">
<title>pending_embed._needs_embedding</title>
<g id="a_node172"><a xlink:title="Return ``True`` when ``emb`` is missing or stale.&#10;&#10;The function also upgrades older vector files stored as a single object and&#10;removes corrupted or mismatched ones so ``embed.py`` always operates on&#10;clean data.">
<polygon fill="none" stroke="black" points="8950.5,-3263.35 8132.5,-3263.35 8132.5,-3206.35 8950.5,-3206.35 8950.5,-3263.35"/>
<text text-anchor="middle" x="8541.5" y="-3223.51" font-family="Times,serif" font-size="44.80">pending_embed._needs_embedding</text>
</a>
</g>
</g>
<!-- pending_embed._needs_embedding&#45;&gt;notes_utils.write_json -->
<g id="edge297" class="edge">
<title>pending_embed._needs_embedding&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M8657.31,-3263.39C8764.99,-3282.55 8922.45,-3289.71 9012,-3196.85 9074.38,-3132.16 8985.66,-2453.57 9048,-2388.85 9110.59,-2323.87 9220.69,-2328.69 9296.04,-2341.98"/>
<polygon fill="black" stroke="black" points="9295.5,-2345.44 9305.97,-2343.81 9296.77,-2338.55 9295.5,-2345.44"/>
</g>
<!-- pending_embed._needs_embedding&#45;&gt;notes_utils.load_json -->
<g id="edge296" class="edge">
<title>pending_embed._needs_embedding&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M8683.57,-3206.35C8787.59,-3194.11 8925.5,-3197.63 9012,-3277.85 9082.72,-3343.43 9012.72,-3402.08 9048,-3491.85 9126.37,-3691.29 9292.2,-3893.82 9353.28,-3964.56"/>
<polygon fill="black" stroke="black" points="9351,-3967.27 9360.2,-3972.52 9356.28,-3962.68 9351,-3967.27"/>
</g>
<!-- pending_embed.main -->
<g id="node173" class="node">
<title>pending_embed.main</title>
<polygon fill="none" stroke="black" points="6648,-3021.85 6124,-3021.85 6124,-2961.85 6648,-2961.85 6648,-3021.85"/>
<text text-anchor="middle" x="6386" y="-2980.33" font-family="Times,serif" font-size="46.90">pending_embed.main</text>
</g>
<!-- pending_embed.main&#45;&gt;post_io.read_post -->
<g id="edge298" class="edge">
<title>pending_embed.main&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M6481.46,-2961.85C6604.22,-2917.3 6814.05,-2820.9 6909,-2657.85 6946.96,-2592.66 6892.86,-2034.37 6945,-1979.85 7113.2,-1803.94 7821.05,-1988.88 8035,-1872.85 8057.51,-1860.64 8048.5,-1840.08 8071,-1827.85 8125.91,-1798 8189.79,-1781.77 8252.42,-1773.69"/>
<polygon fill="black" stroke="black" points="8252.96,-1777.15 8262.46,-1772.46 8252.11,-1770.2 8252.96,-1777.15"/>
</g>
<!-- pending_embed.main&#45;&gt;lot_io.read_lots -->
<g id="edge302" class="edge">
<title>pending_embed.main&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M6428.02,-2961.75C6516.81,-2898.6 6735.74,-2753.49 6945,-2697.85 7062.12,-2666.71 7934.55,-2727.65 8035,-2659.85 8067.65,-2637.81 8039.47,-2602.47 8071,-2578.85 8172.6,-2502.73 8322.37,-2495.5 8425.29,-2501.76"/>
<polygon fill="black" stroke="black" points="8425.2,-2505.26 8435.41,-2502.43 8425.66,-2498.28 8425.2,-2505.26"/>
</g>
<!-- pending_embed.main&#45;&gt;post_io.raw_post_path_from_lot -->
<g id="edge299" class="edge">
<title>pending_embed.main&#45;&gt;post_io.raw_post_path_from_lot</title>
<path fill="none" stroke="black" d="M6512.69,-2961.83C6630.33,-2941.83 6803.36,-2934.44 6909,-3030.85 6980.56,-3096.16 6872.92,-3181.11 6945,-3245.85 7000.55,-3295.74 7194.39,-3296.28 7334.88,-3289.35"/>
<polygon fill="black" stroke="black" points="7335.1,-3292.84 7344.9,-3288.84 7334.74,-3285.85 7335.1,-3292.84"/>
</g>
<!-- pending_embed.main&#45;&gt;lot_io.iter_lot_files -->
<g id="edge304" class="edge">
<title>pending_embed.main&#45;&gt;lot_io.iter_lot_files</title>
<path fill="none" stroke="black" d="M6648.37,-2969.36C7109.85,-2929.38 8022.02,-2849.08 8035,-2837.85 8086.51,-2793.26 8018.75,-2732.56 8071,-2688.85 8119.7,-2648.11 8282.47,-2646.53 8402.76,-2651.57"/>
<polygon fill="black" stroke="black" points="8402.66,-2655.07 8412.8,-2652.01 8402.96,-2648.08 8402.66,-2655.07"/>
</g>
<!-- pending_embed.main&#45;&gt;moderation.message_skip_reason -->
<g id="edge300" class="edge">
<title>pending_embed.main&#45;&gt;moderation.message_skip_reason</title>
<path fill="none" stroke="black" d="M6482.66,-2961.8C6605.97,-2917.38 6815.61,-2821.34 6909,-2657.85 6963.49,-2562.46 6866.63,-1746.82 6945,-1669.85 6985.97,-1629.61 8956.13,-1645.11 9012,-1631.85 9044.51,-1624.13 9230.31,-1531.08 9323.38,-1483.91"/>
<polygon fill="black" stroke="black" points="9325.03,-1487 9332.36,-1479.35 9321.86,-1480.75 9325.03,-1487"/>
</g>
<!-- pending_embed.main&#45;&gt;moderation.lot_skip_reason -->
<g id="edge301" class="edge">
<title>pending_embed.main&#45;&gt;moderation.lot_skip_reason</title>
<path fill="none" stroke="black" d="M6523.94,-2961.82C6639.84,-2944.91 6803.48,-2942.23 6909,-3030.85 6958.86,-3072.72 6895.08,-3131.06 6945,-3172.85 7131.21,-3328.73 7802.99,-3179.14 8035,-3250.85 8052.7,-3256.32 8053.12,-3267.02 8071,-3271.85 8272.86,-3326.42 8845.7,-3398.62 9012,-3271.85 9060.02,-3235.25 9001.52,-3179.39 9048,-3140.85 9111.32,-3088.35 9207.09,-3086.29 9278.92,-3094.58"/>
<polygon fill="black" stroke="black" points="9278.53,-3098.06 9288.89,-3095.82 9279.4,-3091.12 9278.53,-3098.06"/>
</g>
<!-- pending_embed.main&#45;&gt;lot_io.embedding_path -->
<g id="edge303" class="edge">
<title>pending_embed.main&#45;&gt;lot_io.embedding_path</title>
<path fill="none" stroke="black" d="M6648.27,-2988.69C7106.06,-2982.64 8007.59,-2968.17 8035,-2947.85 8075.65,-2917.72 8030.98,-2870.81 8071,-2839.85 8124.3,-2798.6 8303.91,-2797.23 8424.88,-2801.47"/>
<polygon fill="black" stroke="black" points="8424.82,-2804.97 8434.94,-2801.84 8425.07,-2797.97 8424.82,-2804.97"/>
</g>
<!-- pending_embed.main&#45;&gt;pending_embed._needs_embedding -->
<g id="edge305" class="edge">
<title>pending_embed.main&#45;&gt;pending_embed._needs_embedding</title>
<path fill="none" stroke="black" d="M6538.73,-2961.84C6652.25,-2948.38 6805.18,-2950.44 6909,-3030.85 6948.34,-3061.31 6905.13,-3107.08 6945,-3136.85 7042.12,-3209.37 7917.28,-3151 8035,-3179.85 8052.19,-3184.06 8053.9,-3192.28 8071,-3196.85 8087.68,-3201.3 8104.79,-3205.28 8122.17,-3208.83"/>
<polygon fill="black" stroke="black" points="8121.94,-3212.35 8132.43,-3210.87 8123.3,-3205.49 8121.94,-3212.35"/>
</g>
<!-- pending_caption._get_message_path -->
<g id="node174" class="node">
<title>pending_caption._get_message_path</title>
<g id="a_node174"><a xlink:title="Return path of stored message ``msg_id`` in ``chat`` if any.">
<polygon fill="none" stroke="black" points="8692,-1106.85 8391,-1106.85 8391,-1070.85 8692,-1070.85 8692,-1106.85"/>
<text text-anchor="middle" x="8541.5" y="-1084.81" font-family="Times,serif" font-size="15.68">pending_caption._get_message_path</text>
</a>
</g>
</g>
<!-- pending_caption.main -->
<g id="node175" class="node">
<title>pending_caption.main</title>
<polygon fill="none" stroke="black" points="6620,-1122.85 6152,-1122.85 6152,-1070.85 6620,-1070.85 6620,-1122.85"/>
<text text-anchor="middle" x="6386" y="-1086.71" font-family="Times,serif" font-size="40.18">pending_caption.main</text>
</g>
<!-- pending_caption.main&#45;&gt;post_io.read_post -->
<g id="edge306" class="edge">
<title>pending_caption.main&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M6524.89,-1122.88C6637.47,-1143.04 6800.94,-1169.82 6945,-1183.85 7005.32,-1189.72 7991.11,-1185.06 8035,-1226.85 8100.44,-1289.15 8014.46,-1561.37 8071,-1631.85 8116.42,-1688.47 8183.34,-1723.93 8252.5,-1746.02"/>
<polygon fill="black" stroke="black" points="8251.69,-1749.44 8262.28,-1749.06 8253.76,-1742.75 8251.69,-1749.44"/>
</g>
<!-- pending_caption.main&#45;&gt;moderation.should_skip_message -->
<g id="edge307" class="edge">
<title>pending_caption.main&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M6489.1,-1122.85C6605.35,-1145.83 6793.99,-1161.97 6909,-1061.85 6968.24,-1010.28 6884.07,-938.4 6945,-888.85 7038.96,-812.43 7944.08,-808.84 8035,-888.85 8129.52,-972.03 7985.05,-1077.84 8071,-1169.85 8144.55,-1248.59 8264.05,-1271.42 8364.08,-1274.78"/>
<polygon fill="black" stroke="black" points="8364.22,-1278.29 8374.31,-1275.06 8364.41,-1271.29 8364.22,-1278.29"/>
</g>
<!-- pending_caption.main&#45;&gt;caption_io.has_caption -->
<g id="edge309" class="edge">
<title>pending_caption.main&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M6484.48,-1122.86C6595.23,-1151.36 6781.79,-1196.15 6945,-1219.85 7065.16,-1237.3 7949.3,-1211.84 8035,-1297.85 8118.32,-1381.47 7987.09,-1744.81 8071,-1827.85 8123.07,-1879.38 8332.85,-1871.93 8453.64,-1862.87"/>
<polygon fill="black" stroke="black" points="8453.91,-1866.36 8463.61,-1862.11 8453.37,-1859.38 8453.91,-1866.36"/>
</g>
<!-- pending_caption.main&#45;&gt;image_io.read_image_meta -->
<g id="edge308" class="edge">
<title>pending_caption.main&#45;&gt;image_io.read_image_meta</title>
<path fill="none" stroke="black" d="M6620.03,-1096.43C6847.54,-1096.01 7185.01,-1095.4 7365.12,-1095.07"/>
<polygon fill="black" stroke="black" points="7365.17,-1098.57 7375.17,-1095.06 7365.16,-1091.57 7365.17,-1098.57"/>
</g>
<!-- pending_caption.main&#45;&gt;pending_caption._get_message_path -->
<g id="edge310" class="edge">
<title>pending_caption.main&#45;&gt;pending_caption._get_message_path</title>
<path fill="none" stroke="black" d="M6484.92,-1122.9C6601.64,-1147.47 6795.15,-1166.66 6909,-1061.85 6988.03,-989.09 6863.58,-892.92 6945,-822.85 7128.59,-664.84 7851.41,-664.84 8035,-822.85 8116.42,-892.92 7991.63,-989.47 8071,-1061.85 8115.18,-1102.14 8262.52,-1105.16 8380.5,-1100.38"/>
<polygon fill="black" stroke="black" points="8380.89,-1103.86 8390.73,-1099.94 8380.59,-1096.87 8380.89,-1103.86"/>
</g>
<!-- check_translations.parse_po -->
<g id="node176" class="node">
<title>check_translations.parse_po</title>
<polygon fill="none" stroke="black" points="1667.5,-5129.85 1083.5,-5129.85 1083.5,-5077.85 1667.5,-5077.85 1667.5,-5129.85"/>
<text text-anchor="middle" x="1375.5" y="-5094.15" font-family="Times,serif" font-size="39.62">check_translations.parse_po</text>
</g>
<!-- check_translations.check_translations -->
<g id="node177" class="node">
<title>check_translations.check_translations</title>
<polygon fill="none" stroke="black" points="983,-5126.35 318,-5126.35 318,-5081.35 983,-5081.35 983,-5126.35"/>
<text text-anchor="middle" x="650.5" y="-5095.47" font-family="Times,serif" font-size="33.60">check_translations.check_translations</text>
</g>
<!-- check_translations.check_translations&#45;&gt;check_translations.parse_po -->
<g id="edge311" class="edge">
<title>check_translations.check_translations&#45;&gt;check_translations.parse_po</title>
<path fill="none" stroke="black" d="M983.11,-5103.85C1013.14,-5103.85 1043.45,-5103.85 1073.19,-5103.85"/>
<polygon fill="black" stroke="black" points="1073.26,-5107.35 1083.26,-5103.85 1073.26,-5100.35 1073.26,-5107.35"/>
</g>
<!-- chop:cli -->
<g id="node179" class="node">
<title>chop:cli</title>
<g id="a_node179"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="2010.5" cy="-5040.85" rx="27" ry="18"/>
<text text-anchor="middle" x="2010.5" y="-5039.25" font-family="Times,serif" font-size="7.00">chop:cli</text>
</a>
</g>
</g>
<!-- telegram_bot:cli&#45;&gt;chop:cli -->
<!-- price_train:cli -->
<g id="node180" class="node">
<title>price_train:cli</title>
<g id="a_node180"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="2655.5" cy="-5040.85" rx="36.68" ry="18"/>
<text text-anchor="middle" x="2655.5" y="-5039.25" font-family="Times,serif" font-size="7.00">price_train:cli</text>
</a>
</g>
</g>
<!-- chop:cli&#45;&gt;price_train:cli -->
<!-- similar:cli -->
<g id="node181" class="node">
<title>similar:cli</title>
<g id="a_node181"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="3260.5" cy="-5040.85" rx="29.05" ry="18"/>
<text text-anchor="middle" x="3260.5" y="-5039.25" font-family="Times,serif" font-size="7.00">similar:cli</text>
</a>
</g>
</g>
<!-- price_train:cli&#45;&gt;similar:cli -->
<!-- moderation:cli -->
<g id="node182" class="node">
<title>moderation:cli</title>
<g id="a_node182"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="4107" cy="-5040.85" rx="38.53" ry="18"/>
<text text-anchor="middle" x="4107" y="-5039.25" font-family="Times,serif" font-size="7.00">moderation:cli</text>
</a>
</g>
</g>
<!-- similar:cli&#45;&gt;moderation:cli -->
<!-- tg_client:cli -->
<g id="node183" class="node">
<title>tg_client:cli</title>
<g id="a_node183"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="141" cy="-5165.85" rx="32.86" ry="18"/>
<text text-anchor="middle" x="141" y="-5164.25" font-family="Times,serif" font-size="7.00">tg_client:cli</text>
</a>
</g>
</g>
<!-- caption:cli -->
<g id="node184" class="node">
<title>caption:cli</title>
<g id="a_node184"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="650.5" cy="-5165.85" rx="30.28" ry="18"/>
<text text-anchor="middle" x="650.5" y="-5164.25" font-family="Times,serif" font-size="7.00">caption:cli</text>
</a>
</g>
</g>
<!-- tg_client:cli&#45;&gt;caption:cli -->
<!-- build_site:cli -->
<g id="node185" class="node">
<title>build_site:cli</title>
<g id="a_node185"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="1375.5" cy="-5165.85" rx="34.71" ry="18"/>
<text text-anchor="middle" x="1375.5" y="-5164.25" font-family="Times,serif" font-size="7.00">build_site:cli</text>
</a>
</g>
</g>
<!-- caption:cli&#45;&gt;build_site:cli -->
<!-- clean_data:cli -->
<g id="node186" class="node">
<title>clean_data:cli</title>
<g id="a_node186"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="2010.5" cy="-5165.85" rx="37.29" ry="18"/>
<text text-anchor="middle" x="2010.5" y="-5164.25" font-family="Times,serif" font-size="7.00">clean_data:cli</text>
</a>
</g>
</g>
<!-- build_site:cli&#45;&gt;clean_data:cli -->
<!-- debug_dump:cli -->
<g id="node187" class="node">
<title>debug_dump:cli</title>
<g id="a_node187"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="2655.5" cy="-5165.85" rx="41.11" ry="18"/>
<text text-anchor="middle" x="2655.5" y="-5164.25" font-family="Times,serif" font-size="7.00">debug_dump:cli</text>
</a>
</g>
</g>
<!-- clean_data:cli&#45;&gt;debug_dump:cli -->
<!-- embed:cli -->
<g id="node188" class="node">
<title>embed:cli</title>
<g id="a_node188"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="3260.5" cy="-5165.85" rx="29.05" ry="18"/>
<text text-anchor="middle" x="3260.5" y="-5164.25" font-family="Times,serif" font-size="7.00">embed:cli</text>
</a>
</g>
</g>
<!-- debug_dump:cli&#45;&gt;embed:cli -->
<!-- pending_chop:cli -->
<g id="node189" class="node">
<title>pending_chop:cli</title>
<g id="a_node189"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="4107" cy="-5165.85" rx="42.96" ry="18"/>
<text text-anchor="middle" x="4107" y="-5164.25" font-family="Times,serif" font-size="7.00">pending_chop:cli</text>
</a>
</g>
</g>
<!-- embed:cli&#45;&gt;pending_chop:cli -->
<!-- pending_embed:cli -->
<g id="node190" class="node">
<title>pending_embed:cli</title>
<g id="a_node190"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="141" cy="-5219.85" rx="47.39" ry="18"/>
<text text-anchor="middle" x="141" y="-5218.25" font-family="Times,serif" font-size="7.00">pending_embed:cli</text>
</a>
</g>
</g>
<!-- pending_caption:cli -->
<g id="node191" class="node">
<title>pending_caption:cli</title>
<g id="a_node191"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="650.5" cy="-5219.85" rx="48.62" ry="18"/>
<text text-anchor="middle" x="650.5" y="-5218.25" font-family="Times,serif" font-size="7.00">pending_caption:cli</text>
</a>
</g>
</g>
<!-- pending_embed:cli&#45;&gt;pending_caption:cli -->
<!-- check_translations:cli -->
<g id="node192" class="node">
<title>check_translations:cli</title>
<g id="a_node192"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="1375.5" cy="-5219.85" rx="53.05" ry="18"/>
<text text-anchor="middle" x="1375.5" y="-5218.25" font-family="Times,serif" font-size="7.00">check_translations:cli</text>
</a>
</g>
</g>
<!-- pending_caption:cli&#45;&gt;check_translations:cli -->
<!-- build_site -->
<g id="node193" class="node">
<title>build_site</title>
<ellipse fill="none" stroke="black" cx="4995.5" cy="-413.85" rx="55.79" ry="18"/>
<text text-anchor="middle" x="4995.5" y="-410.15" font-family="Times,serif" font-size="14.00">build_site</text>
</g>
<!-- build_site&#45;&gt;build_site.main -->
<g id="edge325" class="edge">
<title>build_site:cli&#45;&gt;build_site.main</title>
<path fill="none" stroke="black" d="M5051.65,-413.85C5117.07,-413.85 5230.14,-413.85 5332.11,-413.85"/>
<polygon fill="black" stroke="black" points="5332.25,-417.35 5342.25,-413.85 5332.25,-410.35 5332.25,-417.35"/>
</g>
<!-- caption -->
<g id="node194" class="node">
<title>caption</title>
<ellipse fill="none" stroke="black" cx="5551.5" cy="-3057.85" rx="44.69" ry="18"/>
<text text-anchor="middle" x="5551.5" y="-3054.15" font-family="Times,serif" font-size="14.00">caption</text>
</g>
<!-- caption&#45;&gt;caption.main -->
<g id="edge326" class="edge">
<title>caption:cli&#45;&gt;caption.main</title>
<path fill="none" stroke="black" d="M5596.38,-3057.85C5724.49,-3057.85 6100.48,-3057.85 6283.11,-3057.85"/>
<polygon fill="black" stroke="black" points="6283.26,-3061.35 6293.26,-3057.85 6283.26,-3054.35 6283.26,-3061.35"/>
</g>
<!-- check_translations -->
<g id="node195" class="node">
<title>check_translations</title>
<ellipse fill="none" stroke="black" cx="141" cy="-5103.85" rx="96.68" ry="18"/>
<text text-anchor="middle" x="141" y="-5100.15" font-family="Times,serif" font-size="14.00">check_translations</text>
</g>
<!-- check_translations&#45;&gt;check_translations.check_translations -->
<g id="edge327" class="edge">
<title>check_translations:cli&#45;&gt;check_translations.check_translations</title>
<path fill="none" stroke="black" d="M238.05,-5103.85C259.3,-5103.85 282.99,-5103.85 307.97,-5103.85"/>
<polygon fill="black" stroke="black" points="307.99,-5107.35 317.99,-5103.85 307.99,-5100.35 307.99,-5107.35"/>
</g>
<!-- chop -->
<g id="node196" class="node">
<title>chop</title>
<ellipse fill="none" stroke="black" cx="4995.5" cy="-1403.85" rx="32.49" ry="18"/>
<text text-anchor="middle" x="4995.5" y="-1400.15" font-family="Times,serif" font-size="14.00">chop</text>
</g>
<!-- chop&#45;&gt;chop.main -->
<g id="edge328" class="edge">
<title>chop:cli&#45;&gt;chop.main</title>
<path fill="none" stroke="black" d="M5028.28,-1403.85C5111.91,-1403.85 5340.32,-1403.85 5465.56,-1403.85"/>
<polygon fill="black" stroke="black" points="5465.88,-1407.35 5475.88,-1403.85 5465.88,-1400.35 5465.88,-1407.35"/>
</g>
<!-- clean_data -->
<g id="node197" class="node">
<title>clean_data</title>
<ellipse fill="none" stroke="black" cx="5551.5" cy="-2630.85" rx="59.59" ry="18"/>
<text text-anchor="middle" x="5551.5" y="-2627.15" font-family="Times,serif" font-size="14.00">clean_data</text>
</g>
<!-- clean_data&#45;&gt;clean_data.main -->
<g id="edge329" class="edge">
<title>clean_data:cli&#45;&gt;clean_data.main</title>
<path fill="none" stroke="black" d="M5611.37,-2630.85C5750.77,-2630.85 6102.57,-2630.85 6279.69,-2630.85"/>
<polygon fill="black" stroke="black" points="6279.8,-2634.35 6289.8,-2630.85 6279.8,-2627.35 6279.8,-2634.35"/>
</g>
<!-- debug_dump -->
<g id="node198" class="node">
<title>debug_dump</title>
<ellipse fill="none" stroke="black" cx="5551.5" cy="-4842.85" rx="70.39" ry="18"/>
<text text-anchor="middle" x="5551.5" y="-4839.15" font-family="Times,serif" font-size="14.00">debug_dump</text>
</g>
<!-- debug_dump&#45;&gt;debug_dump.main -->
<g id="edge330" class="edge">
<title>debug_dump:cli&#45;&gt;debug_dump.main</title>
<path fill="none" stroke="black" d="M5622.05,-4842.85C5734.18,-4842.85 5960.24,-4842.85 6137.32,-4842.85"/>
<polygon fill="black" stroke="black" points="6137.58,-4846.35 6147.58,-4842.85 6137.58,-4839.35 6137.58,-4846.35"/>
</g>
<!-- embed -->
<g id="node199" class="node">
<title>embed</title>
<ellipse fill="none" stroke="black" cx="5551.5" cy="-1316.85" rx="42.49" ry="18"/>
<text text-anchor="middle" x="5551.5" y="-1313.15" font-family="Times,serif" font-size="14.00">embed</text>
</g>
<!-- embed&#45;&gt;embed.main -->
<g id="edge331" class="edge">
<title>embed:cli&#45;&gt;embed.main</title>
<path fill="none" stroke="black" d="M5593.78,-1316.85C5720.41,-1316.85 6105.73,-1316.85 6287.77,-1316.85"/>
<polygon fill="black" stroke="black" points="6287.88,-1320.35 6297.88,-1316.85 6287.88,-1313.35 6287.88,-1320.35"/>
</g>
<!-- moderation -->
<g id="node200" class="node">
<title>moderation</title>
<ellipse fill="none" stroke="black" cx="6386" cy="-2266.85" rx="63.89" ry="18"/>
<text text-anchor="middle" x="6386" y="-2263.15" font-family="Times,serif" font-size="14.00">moderation</text>
</g>
<!-- moderation&#45;&gt;moderation.apply_to_history -->
<g id="edge332" class="edge">
<title>moderation:cli&#45;&gt;moderation.apply_to_history</title>
<path fill="none" stroke="black" d="M6449.41,-2268.6C6595.49,-2272.71 6966.71,-2283.16 7223.55,-2290.38"/>
<polygon fill="black" stroke="black" points="7223.69,-2293.89 7233.78,-2290.67 7223.88,-2286.89 7223.69,-2293.89"/>
</g>
<!-- pending_caption -->
<g id="node201" class="node">
<title>pending_caption</title>
<ellipse fill="none" stroke="black" cx="5551.5" cy="-1096.85" rx="87.18" ry="18"/>
<text text-anchor="middle" x="5551.5" y="-1093.15" font-family="Times,serif" font-size="14.00">pending_caption</text>
</g>
<!-- pending_caption&#45;&gt;pending_caption.main -->
<g id="edge333" class="edge">
<title>pending_caption:cli&#45;&gt;pending_caption.main</title>
<path fill="none" stroke="black" d="M5638.85,-1096.85C5756.6,-1096.85 5972.27,-1096.85 6141.57,-1096.85"/>
<polygon fill="black" stroke="black" points="6141.63,-1100.35 6151.63,-1096.85 6141.63,-1093.35 6141.63,-1100.35"/>
</g>
<!-- pending_chop -->
<g id="node202" class="node">
<title>pending_chop</title>
<ellipse fill="none" stroke="black" cx="6386" cy="-1034.85" rx="74.99" ry="18"/>
<text text-anchor="middle" x="6386" y="-1031.15" font-family="Times,serif" font-size="14.00">pending_chop</text>
</g>
<!-- pending_chop&#45;&gt;pending_chop.main -->
<g id="edge334" class="edge">
<title>pending_chop:cli&#45;&gt;pending_chop.main</title>
<path fill="none" stroke="black" d="M6461.02,-1035.05C6634.51,-1035.52 7071.21,-1036.71 7315.94,-1037.38"/>
<polygon fill="black" stroke="black" points="7316,-1040.88 7326,-1037.41 7316.01,-1033.88 7316,-1040.88"/>
</g>
<!-- pending_embed -->
<g id="node203" class="node">
<title>pending_embed</title>
<ellipse fill="none" stroke="black" cx="5551.5" cy="-2991.85" rx="83.69" ry="18"/>
<text text-anchor="middle" x="5551.5" y="-2988.15" font-family="Times,serif" font-size="14.00">pending_embed</text>
</g>
<!-- pending_embed&#45;&gt;pending_embed.main -->
<g id="edge335" class="edge">
<title>pending_embed:cli&#45;&gt;pending_embed.main</title>
<path fill="none" stroke="black" d="M5635.37,-2991.85C5745.95,-2991.85 5947.11,-2991.85 6113.23,-2991.85"/>
<polygon fill="black" stroke="black" points="6113.62,-2995.35 6123.62,-2991.85 6113.62,-2988.35 6113.62,-2995.35"/>
</g>
<!-- price_train -->
<g id="node204" class="node">
<title>price_train</title>
<ellipse fill="none" stroke="black" cx="5551.5" cy="-2349.85" rx="61.19" ry="18"/>
<text text-anchor="middle" x="5551.5" y="-2346.15" font-family="Times,serif" font-size="14.00">price_train</text>
</g>
<!-- price_train&#45;&gt;price_train.main -->
<g id="edge336" class="edge">
<title>price_train:cli&#45;&gt;price_train.main</title>
<path fill="none" stroke="black" d="M5612.71,-2350.5C5748.15,-2351.96 6079.17,-2355.54 6260.76,-2357.51"/>
<polygon fill="black" stroke="black" points="6260.86,-2361.01 6270.9,-2357.62 6260.94,-2354.01 6260.86,-2361.01"/>
</g>
<!-- scan_ontology -->
<g id="node205" class="node">
<title>scan_ontology</title>
<ellipse fill="none" stroke="black" cx="4995.5" cy="-2414.85" rx="76.09" ry="18"/>
<text text-anchor="middle" x="4995.5" y="-2411.15" font-family="Times,serif" font-size="14.00">scan_ontology</text>
</g>
<!-- scan_ontology&#45;&gt;scan_ontology.main -->
<g id="edge337" class="edge">
<title>scan_ontology:cli&#45;&gt;scan_ontology.main</title>
<path fill="none" stroke="black" d="M5071.79,-2414.85C5134.32,-2414.85 5226.8,-2414.85 5313.85,-2414.85"/>
<polygon fill="black" stroke="black" points="5313.88,-2418.35 5323.88,-2414.85 5313.88,-2411.35 5313.88,-2418.35"/>
</g>
<!-- similar -->
<g id="node206" class="node">
<title>similar</title>
<ellipse fill="none" stroke="black" cx="5551.5" cy="-4359.85" rx="42.79" ry="18"/>
<text text-anchor="middle" x="5551.5" y="-4356.15" font-family="Times,serif" font-size="14.00">similar</text>
</g>
<!-- similar&#45;&gt;similar.main -->
<g id="edge338" class="edge">
<title>similar:cli&#45;&gt;similar.main</title>
<path fill="none" stroke="black" d="M5594.64,-4359.85C5718.3,-4359.85 6083.23,-4359.85 6270.82,-4359.85"/>
<polygon fill="black" stroke="black" points="6270.99,-4363.35 6280.99,-4359.85 6270.99,-4356.35 6270.99,-4363.35"/>
</g>
<!-- telegram_bot -->
<g id="node207" class="node">
<title>telegram_bot</title>
<ellipse fill="none" stroke="black" cx="4107" cy="-4986.85" rx="72.29" ry="18"/>
<text text-anchor="middle" x="4107" y="-4983.15" font-family="Times,serif" font-size="14.00">telegram_bot</text>
</g>
<!-- telegram_bot&#45;&gt;telegram_bot.send_alert -->
<g id="edge339" class="edge">
<title>telegram_bot:cli&#45;&gt;telegram_bot.send_alert</title>
<path fill="none" stroke="black" d="M4178.67,-4984.46C4316.46,-4979.79 4624.61,-4969.37 4820.27,-4962.75"/>
<polygon fill="black" stroke="black" points="4820.5,-4966.24 4830.37,-4962.4 4820.26,-4959.24 4820.5,-4966.24"/>
</g>
<!-- telegram_bot&#45;&gt;telegram_bot.main -->
<g id="edge340" class="edge">
<title>telegram_bot:cli&#45;&gt;telegram_bot.main</title>
<path fill="none" stroke="black" d="M4178.67,-4989.24C4316.36,-4993.9 4624.16,-5004.32 4819.84,-5010.94"/>
<polygon fill="black" stroke="black" points="4819.83,-5014.44 4829.95,-5011.28 4820.07,-5007.44 4819.83,-5014.44"/>
</g>
<!-- tg_client -->
<g id="node208" class="node">
<title>tg_client</title>
<ellipse fill="none" stroke="black" cx="141" cy="-3802.85" rx="50.89" ry="18"/>
<text text-anchor="middle" x="141" y="-3799.15" font-family="Times,serif" font-size="14.00">tg_client</text>
</g>
<!-- tg_client&#45;&gt;tg_client.main -->
<g id="edge341" class="edge">
<title>tg_client:cli&#45;&gt;tg_client.main</title>
<path fill="none" stroke="black" d="M192.05,-3802.85C232.34,-3802.85 292.58,-3802.85 356.22,-3802.85"/>
<polygon fill="black" stroke="black" points="356.46,-3806.35 366.46,-3802.85 356.46,-3799.35 356.46,-3806.35"/>
</g>
</g>
</svg>
