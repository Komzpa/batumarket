<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: callgraph Pages: 1 -->
<svg width="4489pt" height="9743pt"
 viewBox="0.00 0.00 4488.68 9743.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 9739)">
<title>callgraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-9739 4484.68,-9739 4484.68,4 -4,4"/>
<!-- lot_io._clean_lot -->
<g id="node1" class="node">
<title>lot_io._clean_lot</title>
<g id="a_node1"><a xlink:title="Return ``lot`` without empty or null fields.">
<polygon fill="none" stroke="black" points="4211.68,-1216.5 4148.68,-1216.5 4148.68,-1153.5 4211.68,-1153.5 4211.68,-1216.5"/>
<text text-anchor="middle" x="4180.18" y="-1181.3" font-family="Times,serif" font-size="14.00">lot_io._clean_lot</text>
</a>
</g>
</g>
<!-- lot_io.valid_lots -->
<g id="node2" class="node">
<title>lot_io.valid_lots</title>
<g id="a_node2"><a xlink:title="Return ``True`` when every lot contains the required translations.">
<polygon fill="none" stroke="black" points="3556.18,-5322.5 3431.18,-5322.5 3431.18,-5197.5 3556.18,-5197.5 3556.18,-5322.5"/>
<text text-anchor="middle" x="3493.68" y="-5256.3" font-family="Times,serif" font-size="14.00">lot_io.valid_lots</text>
</a>
</g>
</g>
<!-- lot_io.needs_cleanup -->
<g id="node3" class="node">
<title>lot_io.needs_cleanup</title>
<g id="a_node3"><a xlink:title="Return ``True`` when ``clean_data`` would drop ``lots``.">
<polygon fill="none" stroke="black" points="3942.18,-7048.5 3861.18,-7048.5 3861.18,-6967.5 3942.18,-6967.5 3942.18,-7048.5"/>
<text text-anchor="middle" x="3901.68" y="-7004.3" font-family="Times,serif" font-size="14.00">lot_io.needs_cleanup</text>
</a>
</g>
</g>
<!-- lot_io.get_seller -->
<g id="node4" class="node">
<title>lot_io.get_seller</title>
<g id="a_node4"><a xlink:title="Return the seller identifier or ``None`` when missing.">
<polygon fill="none" stroke="black" points="3961.68,-1345 3841.68,-1345 3841.68,-1225 3961.68,-1225 3961.68,-1345"/>
<text text-anchor="middle" x="3901.68" y="-1281.3" font-family="Times,serif" font-size="14.00">lot_io.get_seller</text>
</a>
</g>
</g>
<!-- lot_io.get_timestamp -->
<g id="node5" class="node">
<title>lot_io.get_timestamp</title>
<g id="a_node5"><a xlink:title="Return ``lot[&#39;timestamp&#39;]`` as a timezone&#45;aware ``datetime``.">
<polygon fill="none" stroke="black" points="3975.68,-778 3827.68,-778 3827.68,-630 3975.68,-630 3975.68,-778"/>
<text text-anchor="middle" x="3901.68" y="-700.3" font-family="Times,serif" font-size="14.00">lot_io.get_timestamp</text>
</a>
</g>
</g>
<!-- lot_io.read_lots -->
<g id="node6" class="node">
<title>lot_io.read_lots</title>
<g id="a_node6"><a xlink:title="Return a list of lots from ``path`` or ``None`` when invalid.">
<polygon fill="none" stroke="black" points="3966.68,-2489 3836.68,-2489 3836.68,-2359 3966.68,-2359 3966.68,-2489"/>
<text text-anchor="middle" x="3901.68" y="-2420.3" font-family="Times,serif" font-size="14.00">lot_io.read_lots</text>
</a>
</g>
</g>
<!-- lot_io.read_lots&#45;&gt;lot_io._clean_lot -->
<g id="edge1" class="edge">
<title>lot_io.read_lots&#45;&gt;lot_io._clean_lot</title>
<path fill="none" stroke="black" d="M3944.25,-2358.92C3980.8,-2298.44 4032.32,-2204.6 4059.68,-2116 4162.09,-1784.38 4176.81,-1360.15 4178.87,-1226.94"/>
<polygon fill="black" stroke="black" points="4182.37,-1226.81 4179.01,-1216.76 4175.37,-1226.72 4182.37,-1226.81"/>
</g>
<!-- notes_utils.load_json -->
<g id="node7" class="node">
<title>notes_utils.load_json</title>
<g id="a_node7"><a xlink:title="Return parsed JSON or ``None`` when invalid.">
<polygon fill="none" stroke="black" points="4237.18,-4116 4123.18,-4116 4123.18,-4002 4237.18,-4002 4237.18,-4116"/>
<text text-anchor="middle" x="4180.18" y="-4055.3" font-family="Times,serif" font-size="14.00">notes_utils.load_json</text>
</a>
</g>
</g>
<!-- lot_io.read_lots&#45;&gt;notes_utils.load_json -->
<g id="edge2" class="edge">
<title>lot_io.read_lots&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M3967,-2455.15C4001.06,-2475.37 4039.85,-2505.2 4059.68,-2544 4127.47,-2676.62 4060.85,-3739.19 4095.68,-3884 4104.75,-3921.68 4122.55,-3960.87 4139.39,-3992.58"/>
<polygon fill="black" stroke="black" points="4136.51,-3994.61 4144.34,-4001.75 4142.67,-3991.28 4136.51,-3994.61"/>
</g>
<!-- notes_utils.read_text -->
<g id="node46" class="node">
<title>notes_utils.read_text</title>
<g id="a_node46"><a xlink:title="Return file contents as UTF&#45;8 or empty string when missing.">
<polygon fill="none" stroke="black" points="4438.18,-4507.5 4343.18,-4507.5 4343.18,-4412.5 4438.18,-4412.5 4438.18,-4507.5"/>
<text text-anchor="middle" x="4390.68" y="-4456.3" font-family="Times,serif" font-size="14.00">notes_utils.read_text</text>
</a>
</g>
</g>
<!-- notes_utils.load_json&#45;&gt;notes_utils.read_text -->
<g id="edge97" class="edge">
<title>notes_utils.load_json&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M4210.83,-4116.03C4250.54,-4192.39 4320.56,-4327.05 4360.18,-4403.26"/>
<polygon fill="black" stroke="black" points="4357.14,-4405 4364.86,-4412.26 4363.35,-4401.77 4357.14,-4405"/>
</g>
<!-- lot_io.write_lots -->
<g id="node8" class="node">
<title>lot_io.write_lots</title>
<g id="a_node8"><a xlink:title="Write lots to ``path`` using consistent JSON formatting.">
<polygon fill="none" stroke="black" points="3553.68,-554 3433.68,-554 3433.68,-434 3553.68,-434 3553.68,-554"/>
<text text-anchor="middle" x="3493.68" y="-490.3" font-family="Times,serif" font-size="14.00">lot_io.write_lots</text>
</a>
</g>
</g>
<!-- lot_io.write_lots&#45;&gt;lot_io._clean_lot -->
<g id="edge3" class="edge">
<title>lot_io.write_lots&#45;&gt;lot_io._clean_lot</title>
<path fill="none" stroke="black" d="M3554,-496.86C3602.69,-502.54 3669.62,-518.58 3707.68,-563 3773.29,-639.57 3695.8,-698.26 3743.68,-787 3841.03,-967.39 4052.32,-1108.97 4139.91,-1162.18"/>
<polygon fill="black" stroke="black" points="4138.12,-1165.18 4148.49,-1167.35 4141.73,-1159.19 4138.12,-1165.18"/>
</g>
<!-- lot_io.write_lots&#45;&gt;lot_io.get_seller -->
<g id="edge4" class="edge">
<title>lot_io.write_lots&#45;&gt;lot_io.get_seller</title>
<path fill="none" stroke="black" d="M3554.16,-495.83C3603.65,-500.82 3671.63,-516.44 3707.68,-563 3789.05,-668.09 3682.39,-1042.07 3743.68,-1160 3763.3,-1197.74 3799.91,-1227.92 3832.85,-1249.16"/>
<polygon fill="black" stroke="black" points="3831.25,-1252.28 3841.58,-1254.64 3834.97,-1246.35 3831.25,-1252.28"/>
</g>
<!-- lot_io.write_lots&#45;&gt;lot_io.get_timestamp -->
<g id="edge5" class="edge">
<title>lot_io.write_lots&#45;&gt;lot_io.get_timestamp</title>
<path fill="none" stroke="black" d="M3554.04,-501.99C3599.89,-510.64 3662.86,-528.19 3707.68,-563 3731.35,-581.38 3721.75,-599.59 3743.68,-620 3765.34,-640.16 3792.76,-656.98 3818.59,-670.15"/>
<polygon fill="black" stroke="black" points="3817.14,-673.34 3827.65,-674.66 3820.25,-667.07 3817.14,-673.34"/>
</g>
<!-- notes_utils.write_json -->
<g id="node9" class="node">
<title>notes_utils.write_json</title>
<g id="a_node9"><a xlink:title="Serialise ``data`` to ``path`` with standard options.">
<polygon fill="none" stroke="black" points="4220.68,-2565.5 4139.68,-2565.5 4139.68,-2484.5 4220.68,-2484.5 4220.68,-2565.5"/>
<text text-anchor="middle" x="4180.18" y="-2521.3" font-family="Times,serif" font-size="14.00">notes_utils.write_json</text>
</a>
</g>
</g>
<!-- lot_io.write_lots&#45;&gt;notes_utils.write_json -->
<g id="edge6" class="edge">
<title>lot_io.write_lots&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M3553.81,-496.1C3603.08,-501.27 3670.93,-516.99 3707.68,-563 3762.97,-632.21 3701.98,-881.85 3743.68,-960 3828.78,-1119.47 3974.54,-1056.56 4059.68,-1216 4179.07,-1439.57 4181.24,-2260.66 4179.73,-2474.05"/>
<polygon fill="black" stroke="black" points="4176.23,-2474.3 4179.65,-2484.33 4183.23,-2474.36 4176.23,-2474.3"/>
</g>
<!-- lot_io.make_lot_id -->
<g id="node10" class="node">
<title>lot_io.make_lot_id</title>
<g id="a_node10"><a xlink:title="Return lot id string for ``rel`` and ``index``.&#10;&#10;``rel`` is the JSON file path relative to the ``data/lots`` directory&#10;without the ``.json`` suffix.">
<polygon fill="none" stroke="black" points="3949.18,-2648.5 3854.18,-2648.5 3854.18,-2553.5 3949.18,-2553.5 3949.18,-2648.5"/>
<text text-anchor="middle" x="3901.68" y="-2597.3" font-family="Times,serif" font-size="14.00">lot_io.make_lot_id</text>
</a>
</g>
</g>
<!-- lot_io.parse_lot_id -->
<g id="node11" class="node">
<title>lot_io.parse_lot_id</title>
<g id="a_node11"><a xlink:title="Return ``(relative_path, index)`` extracted from ``lot_id``.">
<polygon fill="none" stroke="black" points="4245.18,-6656 4115.18,-6656 4115.18,-6526 4245.18,-6526 4245.18,-6656"/>
<text text-anchor="middle" x="4180.18" y="-6587.3" font-family="Times,serif" font-size="14.00">lot_io.parse_lot_id</text>
</a>
</g>
</g>
<!-- lot_io.lot_json_path -->
<g id="node12" class="node">
<title>lot_io.lot_json_path</title>
<g id="a_node12"><a xlink:title="Return full JSON path for ``lot_id`` given ``root`` directory.">
<polygon fill="none" stroke="black" points="3937.68,-7282 3865.68,-7282 3865.68,-7210 3937.68,-7210 3937.68,-7282"/>
<text text-anchor="middle" x="3901.68" y="-7242.3" font-family="Times,serif" font-size="14.00">lot_io.lot_json_path</text>
</a>
</g>
</g>
<!-- lot_io.lot_json_path&#45;&gt;lot_io.parse_lot_id -->
<g id="edge7" class="edge">
<title>lot_io.lot_json_path&#45;&gt;lot_io.parse_lot_id</title>
<path fill="none" stroke="black" d="M3937.88,-7228.04C3975.31,-7206.84 4032.75,-7167.81 4059.68,-7116 4152.44,-6937.59 4005.94,-6844.94 4095.68,-6665 4099.01,-6658.33 4103.23,-6651.99 4107.99,-6646.03"/>
<polygon fill="black" stroke="black" points="4110.9,-6648.01 4114.79,-6638.15 4105.6,-6643.44 4110.9,-6648.01"/>
</g>
<!-- lot_io.embedding_path -->
<g id="node13" class="node">
<title>lot_io.embedding_path</title>
<g id="a_node13"><a xlink:title="Return embedding file path for ``lot_path``.">
<polygon fill="none" stroke="black" points="3068.18,-3894 2980.18,-3894 2980.18,-3806 3068.18,-3806 3068.18,-3894"/>
<text text-anchor="middle" x="3024.18" y="-3846.3" font-family="Times,serif" font-size="14.00">lot_io.embedding_path</text>
</a>
</g>
</g>
<!-- lot_io.iter_lot_files -->
<g id="node14" class="node">
<title>lot_io.iter_lot_files</title>
<g id="a_node14"><a xlink:title="Return ``*.json`` files under ``root``.&#10;&#10;When ``newest_first`` is ``True`` the result is ordered by modification&#10;time with the most recently changed files first. &#160;Both ``build_site.py`` and&#10;``pending_embed.py`` rely on this helper so they scan the lot directory in&#10;the same order.">
<polygon fill="none" stroke="black" points="3561.18,-4043.5 3426.18,-4043.5 3426.18,-3908.5 3561.18,-3908.5 3561.18,-4043.5"/>
<text text-anchor="middle" x="3493.68" y="-3972.3" font-family="Times,serif" font-size="14.00">lot_io.iter_lot_files</text>
</a>
</g>
</g>
<!-- lot_io.get_lot -->
<g id="node15" class="node">
<title>lot_io.get_lot</title>
<g id="a_node15"><a xlink:title="Return the lot identified by ``lot_id`` or ``None`` when missing.">
<polygon fill="none" stroke="black" points="3544.68,-4315 3442.68,-4315 3442.68,-4213 3544.68,-4213 3544.68,-4315"/>
<text text-anchor="middle" x="3493.68" y="-4260.3" font-family="Times,serif" font-size="14.00">lot_io.get_lot</text>
</a>
</g>
</g>
<!-- lot_io.get_lot&#45;&gt;lot_io.read_lots -->
<g id="edge8" class="edge">
<title>lot_io.get_lot&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M3545.13,-4256.12C3595.84,-4245.25 3671.54,-4220.3 3707.68,-4165 3806.26,-4014.2 3662.06,-2704.6 3743.68,-2544 3761.73,-2508.5 3795.69,-2480.52 3827.42,-2460.54"/>
<polygon fill="black" stroke="black" points="3829.59,-2463.31 3836.3,-2455.11 3825.94,-2457.34 3829.59,-2463.31"/>
</g>
<!-- lot_io.get_lot&#45;&gt;lot_io.parse_lot_id -->
<g id="edge9" class="edge">
<title>lot_io.get_lot&#45;&gt;lot_io.parse_lot_id</title>
<path fill="none" stroke="black" d="M3545.06,-4271.67C3595.72,-4282.33 3671.37,-4306.96 3707.68,-4362 3789.71,-4486.32 3651.84,-5584.75 3743.68,-5702 3833.51,-5816.68 3968.56,-5675.35 4059.68,-5789 4110.27,-5852.1 4060.93,-6442.97 4095.68,-6516 4099.04,-6523.05 4103.39,-6529.73 4108.34,-6535.99"/>
<polygon fill="black" stroke="black" points="4105.76,-6538.35 4114.91,-6543.68 4111.08,-6533.8 4105.76,-6538.35"/>
</g>
<!-- token_utils.estimate_tokens -->
<g id="node16" class="node">
<title>token_utils.estimate_tokens</title>
<g id="a_node16"><a xlink:title="Return a naive token count approximation.">
<polygon fill="none" stroke="black" points="3942.18,-5235.5 3861.18,-5235.5 3861.18,-5154.5 3942.18,-5154.5 3942.18,-5235.5"/>
<text text-anchor="middle" x="3901.68" y="-5191.3" font-family="Times,serif" font-size="14.00">token_utils.estimate_tokens</text>
</a>
</g>
</g>
<!-- caption_io._get_langs -->
<g id="node17" class="node">
<title>caption_io._get_langs</title>
<g id="a_node17"><a xlink:title="Return configured languages, caching the result.">
<polygon fill="none" stroke="black" points="4227.68,-3498.5 4132.68,-3498.5 4132.68,-3403.5 4227.68,-3403.5 4227.68,-3498.5"/>
<text text-anchor="middle" x="4180.18" y="-3447.3" font-family="Times,serif" font-size="14.00">caption_io._get_langs</text>
</a>
</g>
</g>
<!-- config_utils.load_config -->
<g id="node18" class="node">
<title>config_utils.load_config</title>
<g id="a_node18"><a xlink:title="Return the ``config`` module or exit with a helpful message.&#10;&#10;When running the scripts directly from ``src/`` the repository root isn&#39;t on&#10;``sys.path`` and ``config.py`` can&#39;t be imported. &#160;Try adding the parent&#10;directory before failing so the configuration can live alongside&#10;``config.example.py`` in the project root.">
<polygon fill="none" stroke="black" points="4480.68,-1815 4300.68,-1815 4300.68,-1635 4480.68,-1635 4480.68,-1815"/>
<text text-anchor="middle" x="4390.68" y="-1721.3" font-family="Times,serif" font-size="14.00">config_utils.load_config</text>
</a>
</g>
</g>
<!-- caption_io._get_langs&#45;&gt;config_utils.load_config -->
<g id="edge10" class="edge">
<title>caption_io._get_langs&#45;&gt;config_utils.load_config</title>
<path fill="none" stroke="black" d="M4227.8,-3406.19C4242.14,-3389.64 4256.33,-3369.82 4264.68,-3349 4376.53,-3070.11 4388.82,-2135.04 4389.77,-1825.48"/>
<polygon fill="black" stroke="black" points="4393.27,-1825.18 4389.8,-1815.17 4386.27,-1825.16 4393.27,-1825.18"/>
</g>
<!-- caption_io.caption_json_path -->
<g id="node19" class="node">
<title>caption_io.caption_json_path</title>
<g id="a_node19"><a xlink:title="Return new&#45;style caption path for ``image``.">
<polygon fill="none" stroke="black" points="4211.68,-6507.5 4148.68,-6507.5 4148.68,-6444.5 4211.68,-6444.5 4211.68,-6507.5"/>
<text text-anchor="middle" x="4180.18" y="-6472.3" font-family="Times,serif" font-size="14.00">caption_io.caption_json_path</text>
</a>
</g>
</g>
<!-- caption_io.caption_md_path -->
<g id="node20" class="node">
<title>caption_io.caption_md_path</title>
<g id="a_node20"><a xlink:title="Return legacy Markdown caption path for ``image``.">
<polygon fill="none" stroke="black" points="4211.68,-6737.5 4148.68,-6737.5 4148.68,-6674.5 4211.68,-6674.5 4211.68,-6737.5"/>
<text text-anchor="middle" x="4180.18" y="-6702.3" font-family="Times,serif" font-size="14.00">caption_io.caption_md_path</text>
</a>
</g>
</g>
<!-- caption_io.has_caption -->
<g id="node21" class="node">
<title>caption_io.has_caption</title>
<g id="a_node21"><a xlink:title="Return ``True`` when any caption exists for ``image``.">
<polygon fill="none" stroke="black" points="3933.18,-7766.5 3870.18,-7766.5 3870.18,-7703.5 3933.18,-7703.5 3933.18,-7766.5"/>
<text text-anchor="middle" x="3901.68" y="-7731.3" font-family="Times,serif" font-size="14.00">caption_io.has_caption</text>
</a>
</g>
</g>
<!-- caption_io.has_caption&#45;&gt;caption_io.caption_json_path -->
<g id="edge11" class="edge">
<title>caption_io.has_caption&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M3927.87,-7703.46C3964.81,-7655.07 4032.26,-7558.09 4059.68,-7463 4088.83,-7361.93 4038.37,-6605.2 4095.68,-6517 4105.45,-6501.97 4122.44,-6492.27 4138.55,-6486.1"/>
<polygon fill="black" stroke="black" points="4140.09,-6489.27 4148.4,-6482.7 4137.8,-6482.65 4140.09,-6489.27"/>
</g>
<!-- caption_io.has_caption&#45;&gt;caption_io.caption_md_path -->
<g id="edge12" class="edge">
<title>caption_io.has_caption&#45;&gt;caption_io.caption_md_path</title>
<path fill="none" stroke="black" d="M3926.16,-7703.41C3961.2,-7654.56 4026.59,-7556.55 4059.68,-7463 4152.09,-7201.79 4173.23,-6864.62 4177.91,-6747.92"/>
<polygon fill="black" stroke="black" points="4181.41,-6747.77 4178.3,-6737.65 4174.42,-6747.51 4181.41,-6747.77"/>
</g>
<!-- caption_io.read_caption -->
<g id="node22" class="node">
<title>caption_io.read_caption</title>
<g id="a_node22"><a xlink:title="Return caption for ``image`` in ``lang`` or empty string when missing.">
<polygon fill="none" stroke="black" points="3969.18,-4803.5 3834.18,-4803.5 3834.18,-4668.5 3969.18,-4668.5 3969.18,-4803.5"/>
<text text-anchor="middle" x="3901.68" y="-4732.3" font-family="Times,serif" font-size="14.00">caption_io.read_caption</text>
</a>
</g>
</g>
<!-- caption_io.read_caption&#45;&gt;notes_utils.load_json -->
<g id="edge17" class="edge">
<title>caption_io.read_caption&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M3944.61,-4668.39C3978.81,-4611.22 4026.7,-4526.33 4059.68,-4448 4105.83,-4338.42 4142.95,-4204.79 4162.97,-4126.1"/>
<polygon fill="black" stroke="black" points="4166.38,-4126.86 4165.44,-4116.31 4159.6,-4125.14 4166.38,-4126.86"/>
</g>
<!-- caption_io.read_caption&#45;&gt;caption_io._get_langs -->
<g id="edge13" class="edge">
<title>caption_io.read_caption&#45;&gt;caption_io._get_langs</title>
<path fill="none" stroke="black" d="M3950.89,-4668.5C3988.04,-4612.41 4036.8,-4528.97 4059.68,-4448 4143.91,-4149.92 4045.99,-4057.73 4095.68,-3752 4109.74,-3665.55 4139.29,-3568.37 4159.2,-3508.42"/>
<polygon fill="black" stroke="black" points="4162.57,-3509.35 4162.43,-3498.76 4155.94,-3507.13 4162.57,-3509.35"/>
</g>
<!-- caption_io.read_caption&#45;&gt;caption_io.caption_json_path -->
<g id="edge14" class="edge">
<title>caption_io.read_caption&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M3969.46,-4750.86C4002.49,-4761.91 4039.52,-4780.68 4059.68,-4812 4104.95,-4882.32 4074.69,-6236.04 4095.68,-6317 4106.87,-6360.13 4131.58,-6404.65 4151.24,-6435.57"/>
<polygon fill="black" stroke="black" points="4148.52,-6437.82 4156.89,-6444.31 4154.4,-6434.02 4148.52,-6437.82"/>
</g>
<!-- caption_io.read_caption&#45;&gt;caption_io.caption_md_path -->
<g id="edge15" class="edge">
<title>caption_io.read_caption&#45;&gt;caption_io.caption_md_path</title>
<path fill="none" stroke="black" d="M3969.51,-4750.83C4002.56,-4761.87 4039.59,-4780.64 4059.68,-4812 4115.22,-4898.7 4040.39,-6578.14 4095.68,-6665 4105.31,-6680.12 4122.28,-6689.83 4138.42,-6695.99"/>
<polygon fill="black" stroke="black" points="4137.69,-6699.44 4148.28,-6699.38 4139.96,-6692.82 4137.69,-6699.44"/>
</g>
<!-- notes_utils.read_md -->
<g id="node23" class="node">
<title>notes_utils.read_md</title>
<g id="a_node23"><a xlink:title="Alias for :func:`read_text` used for Markdown files.">
<polygon fill="none" stroke="black" points="4211.68,-4830.5 4148.68,-4830.5 4148.68,-4767.5 4211.68,-4767.5 4211.68,-4830.5"/>
<text text-anchor="middle" x="4180.18" y="-4795.3" font-family="Times,serif" font-size="14.00">notes_utils.read_md</text>
</a>
</g>
</g>
<!-- caption_io.read_caption&#45;&gt;notes_utils.read_md -->
<g id="edge16" class="edge">
<title>caption_io.read_caption&#45;&gt;notes_utils.read_md</title>
<path fill="none" stroke="black" d="M3969.26,-4751.17C4022.04,-4763.2 4094.08,-4779.61 4138.57,-4789.75"/>
<polygon fill="black" stroke="black" points="4137.91,-4793.19 4148.44,-4791.99 4139.47,-4786.36 4137.91,-4793.19"/>
</g>
<!-- notes_utils.read_md&#45;&gt;notes_utils.read_text -->
<g id="edge94" class="edge">
<title>notes_utils.read_md&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M4200.61,-4767.41C4235.85,-4710.11 4310.75,-4588.34 4354.97,-4516.44"/>
<polygon fill="black" stroke="black" points="4358.21,-4517.85 4360.47,-4507.5 4352.25,-4514.19 4358.21,-4517.85"/>
</g>
<!-- caption_io.write_caption -->
<g id="node24" class="node">
<title>caption_io.write_caption</title>
<g id="a_node24"><a xlink:title="Write ``text`` as ``lang`` caption for ``image``.">
<polygon fill="none" stroke="black" points="3966.68,-3516 3836.68,-3516 3836.68,-3386 3966.68,-3386 3966.68,-3516"/>
<text text-anchor="middle" x="3901.68" y="-3447.3" font-family="Times,serif" font-size="14.00">caption_io.write_caption</text>
</a>
</g>
</g>
<!-- caption_io.write_caption&#45;&gt;notes_utils.load_json -->
<g id="edge20" class="edge">
<title>caption_io.write_caption&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M3966.95,-3467.21C4000.11,-3479.01 4038.05,-3498.58 4059.68,-3530 4104.52,-3595.13 4074.34,-3807.86 4095.68,-3884 4106.18,-3921.47 4124.23,-3960.78 4140.86,-3992.63"/>
<polygon fill="black" stroke="black" points="4137.96,-3994.63 4145.73,-4001.83 4144.15,-3991.36 4137.96,-3994.63"/>
</g>
<!-- caption_io.write_caption&#45;&gt;notes_utils.write_json -->
<g id="edge21" class="edge">
<title>caption_io.write_caption&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M3966.85,-3436.44C3999.77,-3425.59 4037.51,-3407.26 4059.68,-3377 4094.94,-3328.89 4087.48,-3170.08 4095.68,-3111 4123.19,-2912.96 4157.12,-2677.45 4171.82,-2575.83"/>
<polygon fill="black" stroke="black" points="4175.3,-2576.23 4173.26,-2565.84 4168.37,-2575.23 4175.3,-2576.23"/>
</g>
<!-- caption_io.write_caption&#45;&gt;caption_io._get_langs -->
<g id="edge18" class="edge">
<title>caption_io.write_caption&#45;&gt;caption_io._get_langs</title>
<path fill="none" stroke="black" d="M3966.81,-3451C4013.88,-3451 4077.21,-3451 4122.45,-3451"/>
<polygon fill="black" stroke="black" points="4122.67,-3454.5 4132.67,-3451 4122.67,-3447.5 4122.67,-3454.5"/>
</g>
<!-- caption_io.write_caption&#45;&gt;caption_io.caption_json_path -->
<g id="edge19" class="edge">
<title>caption_io.write_caption&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M3966.72,-3492.45C4001.15,-3518.68 4040.4,-3555.93 4059.68,-3600 4120.19,-3738.3 4058.57,-6170.68 4095.68,-6317 4106.64,-6360.19 4131.38,-6404.7 4151.1,-6435.6"/>
<polygon fill="black" stroke="black" points="4148.4,-6437.86 4156.78,-6444.34 4154.27,-6434.05 4148.4,-6437.86"/>
</g>
<!-- testing_mode.apply_testing_mode -->
<g id="node25" class="node">
<title>testing_mode.apply_testing_mode</title>
<g id="a_node25"><a xlink:title="Tweak environment variables when ``TEST_MODE`` is set.">
<polygon fill="none" stroke="black" points="137.34,-9216.5 56.34,-9216.5 56.34,-9135.5 137.34,-9135.5 137.34,-9216.5"/>
<text text-anchor="middle" x="96.84" y="-9172.3" font-family="Times,serif" font-size="14.00">testing_mode.apply_testing_mode</text>
</a>
</g>
</g>
<!-- build_site:cli -->
<g id="node26" class="node">
<title>build_site:cli</title>
<g id="a_node26"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="425.68" cy="-9176" rx="18" ry="18"/>
<text text-anchor="middle" x="425.68" y="-9172.3" font-family="Times,serif" font-size="14.00">build_site:cli</text>
</a>
</g>
</g>
<!-- testing_mode.apply_testing_mode&#45;&gt;build_site:cli -->
<!-- moderation:cli -->
<g id="node168" class="node">
<title>moderation:cli</title>
<g id="a_node168"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="811.18" cy="-9176" rx="18" ry="18"/>
<text text-anchor="middle" x="811.18" y="-9172.3" font-family="Times,serif" font-size="14.00">moderation:cli</text>
</a>
</g>
</g>
<!-- build_site:cli&#45;&gt;moderation:cli -->
<!-- phone_utils.format_georgian -->
<g id="node27" class="node">
<title>phone_utils.format_georgian</title>
<g id="a_node27"><a xlink:title="Return ``phone`` in ``+995...`` format if possible.">
<polygon fill="none" stroke="black" points="3563.68,-9158 3423.68,-9158 3423.68,-9018 3563.68,-9018 3563.68,-9158"/>
<text text-anchor="middle" x="3493.68" y="-9084.3" font-family="Times,serif" font-size="14.00">phone_utils.format_georgian</text>
</a>
</g>
</g>
<!-- build_site._load_ontology -->
<g id="node28" class="node">
<title>build_site._load_ontology</title>
<g id="a_node28"><a xlink:title="Return sorted field list from ``ONTOLOGY`` or empty list when missing.">
<polygon fill="none" stroke="black" points="3084.18,-3358 2964.18,-3358 2964.18,-3238 3084.18,-3238 3084.18,-3358"/>
<text text-anchor="middle" x="3024.18" y="-3294.3" font-family="Times,serif" font-size="14.00">build_site._load_ontology</text>
</a>
</g>
</g>
<!-- build_site._load_ontology&#45;&gt;notes_utils.load_json -->
<g id="edge23" class="edge">
<title>build_site._load_ontology&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M3084.42,-3298.62C3134.76,-3302.56 3204.87,-3316.78 3243.68,-3363 3333.16,-3469.56 3179.99,-3576.93 3279.68,-3674 3348.1,-3740.61 3631.38,-3654.59 3707.68,-3712 3743.1,-3738.65 3708.68,-3777.81 3743.68,-3805 3855.38,-3891.79 3942.34,-3764 4059.68,-3843 4087.13,-3861.48 4124.94,-3936.24 4150.63,-3992.67"/>
<polygon fill="black" stroke="black" points="4147.49,-3994.24 4154.8,-4001.92 4153.87,-3991.36 4147.49,-3994.24"/>
</g>
<!-- build_site._compile_locale -->
<g id="node29" class="node">
<title>build_site._compile_locale</title>
<g id="a_node29"><a xlink:title="Compile ``lang`` gettext catalogue when out of date.">
<polygon fill="none" stroke="black" points="4242.68,-597.5 4117.68,-597.5 4117.68,-472.5 4242.68,-472.5 4242.68,-597.5"/>
<text text-anchor="middle" x="4180.18" y="-531.3" font-family="Times,serif" font-size="14.00">build_site._compile_locale</text>
</a>
</g>
</g>
<!-- build_site._env_for_lang -->
<g id="node30" class="node">
<title>build_site._env_for_lang</title>
<g id="a_node30"><a xlink:title="Return Jinja environment configured for ``lang``.">
<polygon fill="none" stroke="black" points="3978.18,-611.5 3825.18,-611.5 3825.18,-458.5 3978.18,-458.5 3978.18,-611.5"/>
<text text-anchor="middle" x="3901.68" y="-531.3" font-family="Times,serif" font-size="14.00">build_site._env_for_lang</text>
</a>
</g>
</g>
<!-- build_site._env_for_lang&#45;&gt;build_site._compile_locale -->
<g id="edge24" class="edge">
<title>build_site._env_for_lang&#45;&gt;build_site._compile_locale</title>
<path fill="none" stroke="black" d="M3978.24,-535C4018.39,-535 4067.5,-535 4107.12,-535"/>
<polygon fill="black" stroke="black" points="4107.24,-538.5 4117.24,-535 4107.24,-531.5 4107.24,-538.5"/>
</g>
<!-- build_site._iter_lots -->
<g id="node31" class="node">
<title>build_site._iter_lots</title>
<g id="a_node31"><a xlink:title="Return all lots ready for rendering.">
<polygon fill="none" stroke="black" points="3138.18,-4178 2910.18,-4178 2910.18,-3950 3138.18,-3950 3138.18,-4178"/>
<text text-anchor="middle" x="3024.18" y="-4060.3" font-family="Times,serif" font-size="14.00">build_site._iter_lots</text>
</a>
</g>
</g>
<!-- build_site._iter_lots&#45;&gt;lot_io.read_lots -->
<g id="edge25" class="edge">
<title>build_site._iter_lots&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M3138.28,-4008.77C3179,-3982.69 3220.57,-3947.41 3243.68,-3903 3281.99,-3829.4 3220.31,-2467.96 3279.68,-2410 3355.26,-2336.22 3678.74,-2383.54 3826.51,-2409.84"/>
<polygon fill="black" stroke="black" points="3825.96,-2413.29 3836.42,-2411.61 3827.19,-2406.4 3825.96,-2413.29"/>
</g>
<!-- build_site._iter_lots&#45;&gt;lot_io.iter_lot_files -->
<g id="edge26" class="edge">
<title>build_site._iter_lots&#45;&gt;lot_io.iter_lot_files</title>
<path fill="none" stroke="black" d="M3138.35,-4042.7C3224.47,-4026.49 3340.66,-4004.62 3416.12,-3990.41"/>
<polygon fill="black" stroke="black" points="3416.86,-3993.83 3426.04,-3988.55 3415.56,-3986.96 3416.86,-3993.83"/>
</g>
<!-- moderation.should_skip_message -->
<g id="node32" class="node">
<title>moderation.should_skip_message</title>
<g id="a_node32"><a xlink:title="Return ``True`` when the raw Telegram message should be ignored.">
<polygon fill="none" stroke="black" points="3541.18,-5435.5 3446.18,-5435.5 3446.18,-5340.5 3541.18,-5340.5 3541.18,-5435.5"/>
<text text-anchor="middle" x="3493.68" y="-5384.3" font-family="Times,serif" font-size="14.00">moderation.should_skip_message</text>
</a>
</g>
</g>
<!-- build_site._iter_lots&#45;&gt;moderation.should_skip_message -->
<g id="edge27" class="edge">
<title>build_site._iter_lots&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M3138.25,-4137.58C3179.09,-4170.62 3220.76,-4213.4 3243.68,-4263 3293.49,-4370.78 3205.81,-5238.04 3279.68,-5331 3316.37,-5377.17 3386.03,-5388.41 3435.7,-5390.05"/>
<polygon fill="black" stroke="black" points="3435.9,-5393.55 3445.97,-5390.26 3436.05,-5386.55 3435.9,-5393.55"/>
</g>
<!-- moderation.should_skip_lot -->
<g id="node33" class="node">
<title>moderation.should_skip_lot</title>
<g id="a_node33"><a xlink:title="Return ``True`` when the lot fails additional checks.">
<polygon fill="none" stroke="black" points="3541.18,-4156.5 3446.18,-4156.5 3446.18,-4061.5 3541.18,-4061.5 3541.18,-4156.5"/>
<text text-anchor="middle" x="3493.68" y="-4105.3" font-family="Times,serif" font-size="14.00">moderation.should_skip_lot</text>
</a>
</g>
</g>
<!-- build_site._iter_lots&#45;&gt;moderation.should_skip_lot -->
<g id="edge28" class="edge">
<title>build_site._iter_lots&#45;&gt;moderation.should_skip_lot</title>
<path fill="none" stroke="black" d="M3138.35,-4074.89C3232.43,-4083.95 3362.38,-4096.46 3435.93,-4103.54"/>
<polygon fill="black" stroke="black" points="3435.64,-4107.03 3445.93,-4104.5 3436.31,-4100.06 3435.64,-4107.03"/>
</g>
<!-- post_io.read_post -->
<g id="node34" class="node">
<title>post_io.read_post</title>
<g id="a_node34"><a xlink:title="Return metadata dictionary and body text for ``path``.">
<polygon fill="none" stroke="black" points="4059.68,-5137 3743.68,-5137 3743.68,-4821 4059.68,-4821 4059.68,-5137"/>
<text text-anchor="middle" x="3901.68" y="-4975.3" font-family="Times,serif" font-size="14.00">post_io.read_post</text>
</a>
</g>
</g>
<!-- build_site._iter_lots&#45;&gt;post_io.read_post -->
<g id="edge29" class="edge">
<title>build_site._iter_lots&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M3138.33,-4104.99C3178.03,-4125.09 3218.87,-4153.47 3243.68,-4192 3285.66,-4257.18 3227.53,-4481.64 3279.68,-4539 3410.22,-4682.55 3571.04,-4487.25 3707.68,-4625 3767.29,-4685.09 3705.17,-4736.63 3743.68,-4812 3743.73,-4812.09 3743.78,-4812.19 3743.83,-4812.28"/>
<polygon fill="black" stroke="black" points="3740.69,-4813.84 3748.51,-4820.99 3746.85,-4810.52 3740.69,-4813.84"/>
</g>
<!-- post_io.raw_post_path -->
<g id="node35" class="node">
<title>post_io.raw_post_path</title>
<g id="a_node35"><a xlink:title="Return absolute message path for ``rel`` under ``root``.">
<polygon fill="none" stroke="black" points="3933.18,-5861.5 3870.18,-5861.5 3870.18,-5798.5 3933.18,-5798.5 3933.18,-5861.5"/>
<text text-anchor="middle" x="3901.68" y="-5826.3" font-family="Times,serif" font-size="14.00">post_io.raw_post_path</text>
</a>
</g>
</g>
<!-- build_site._iter_lots&#45;&gt;post_io.raw_post_path -->
<g id="edge30" class="edge">
<title>build_site._iter_lots&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M3138.3,-4116.71C3178.25,-4141.16 3219.27,-4174.2 3243.68,-4216 3286.47,-4289.24 3223.89,-4532.11 3279.68,-4596 3408.18,-4743.14 3583.73,-4545.02 3707.68,-4696 3783.38,-4788.2 3674.68,-5671.7 3743.68,-5769 3770.2,-5806.39 3823.11,-5820.86 3860.15,-5826.46"/>
<polygon fill="black" stroke="black" points="3859.76,-5829.94 3870.14,-5827.82 3860.7,-5823.01 3859.76,-5829.94"/>
</g>
<!-- moderation.message_skip_reason -->
<g id="node58" class="node">
<title>moderation.message_skip_reason</title>
<g id="a_node58"><a xlink:title="Return the moderation reason for ``meta`` and ``text`` or ``None``.">
<polygon fill="none" stroke="black" points="3988.18,-6347.5 3815.18,-6347.5 3815.18,-6174.5 3988.18,-6174.5 3988.18,-6347.5"/>
<text text-anchor="middle" x="3901.68" y="-6257.3" font-family="Times,serif" font-size="14.00">moderation.message_skip_reason</text>
</a>
</g>
</g>
<!-- moderation.should_skip_message&#45;&gt;moderation.message_skip_reason -->
<g id="edge64" class="edge">
<title>moderation.should_skip_message&#45;&gt;moderation.message_skip_reason</title>
<path fill="none" stroke="black" d="M3541.49,-5411.25C3591.82,-5438.96 3669.73,-5490.31 3707.68,-5559 3774.98,-5680.79 3709.46,-5735.13 3743.68,-5870 3770.09,-5974.07 3817.83,-6087.34 3853.76,-6165.05"/>
<polygon fill="black" stroke="black" points="3850.69,-6166.75 3858.08,-6174.35 3857.04,-6163.8 3850.69,-6166.75"/>
</g>
<!-- moderation.lot_skip_reason -->
<g id="node59" class="node">
<title>moderation.lot_skip_reason</title>
<g id="a_node59"><a xlink:title="Return the moderation reason for ``lot`` or ``None``.">
<polygon fill="none" stroke="black" points="3964.18,-4156.5 3839.18,-4156.5 3839.18,-4031.5 3964.18,-4031.5 3964.18,-4156.5"/>
<text text-anchor="middle" x="3901.68" y="-4090.3" font-family="Times,serif" font-size="14.00">moderation.lot_skip_reason</text>
</a>
</g>
</g>
<!-- moderation.should_skip_lot&#45;&gt;moderation.lot_skip_reason -->
<g id="edge65" class="edge">
<title>moderation.should_skip_lot&#45;&gt;moderation.lot_skip_reason</title>
<path fill="none" stroke="black" d="M3541.26,-4107.28C3611.74,-4104.68 3746.05,-4099.71 3829.04,-4096.65"/>
<polygon fill="black" stroke="black" points="3829.28,-4100.14 3839.15,-4096.27 3829.03,-4093.15 3829.28,-4100.14"/>
</g>
<!-- post_io.read_post&#45;&gt;notes_utils.read_md -->
<g id="edge87" class="edge">
<title>post_io.read_post&#45;&gt;notes_utils.read_md</title>
<path fill="none" stroke="black" d="M4059.92,-4876.64C4089.62,-4857.3 4118.14,-4838.74 4139.83,-4824.62"/>
<polygon fill="black" stroke="black" points="4141.93,-4827.43 4148.4,-4819.04 4138.11,-4821.56 4141.93,-4827.43"/>
</g>
<!-- notes_utils._parse_block -->
<g id="node77" class="node">
<title>notes_utils._parse_block</title>
<g id="a_node77"><a xlink:title="Return metadata dict and remaining body from ``text``.">
<polygon fill="none" stroke="black" points="4247.68,-5361.5 4112.68,-5361.5 4112.68,-5226.5 4247.68,-5226.5 4247.68,-5361.5"/>
<text text-anchor="middle" x="4180.18" y="-5290.3" font-family="Times,serif" font-size="14.00">notes_utils._parse_block</text>
</a>
</g>
</g>
<!-- post_io.read_post&#45;&gt;notes_utils._parse_block -->
<g id="edge88" class="edge">
<title>post_io.read_post&#45;&gt;notes_utils._parse_block</title>
<path fill="none" stroke="black" d="M4052.96,-5137.33C4055.23,-5139.9 4057.47,-5142.46 4059.68,-5145 4080.04,-5168.36 4101.45,-5194.52 4120.44,-5218.32"/>
<polygon fill="black" stroke="black" points="4117.82,-5220.64 4126.79,-5226.29 4123.3,-5216.29 4117.82,-5220.64"/>
</g>
<!-- build_site._copy_images -->
<g id="node36" class="node">
<title>build_site._copy_images</title>
<g id="a_node36"><a xlink:title="Copy media referenced by ``lots`` into ``VIEWS_DIR``.">
<polygon fill="none" stroke="black" points="3558.68,-1915 3428.68,-1915 3428.68,-1785 3558.68,-1785 3558.68,-1915"/>
<text text-anchor="middle" x="3493.68" y="-1846.3" font-family="Times,serif" font-size="14.00">build_site._copy_images</text>
</a>
</g>
</g>
<!-- build_site._copy_static -->
<g id="node37" class="node">
<title>build_site._copy_static</title>
<g id="a_node37"><a xlink:title="Copy CSS and JS so generated pages are standalone.">
<polygon fill="none" stroke="black" points="2702.18,-1659 2594.18,-1659 2594.18,-1551 2702.18,-1551 2702.18,-1659"/>
<text text-anchor="middle" x="2648.18" y="-1601.3" font-family="Times,serif" font-size="14.00">build_site._copy_static</text>
</a>
</g>
</g>
<!-- build_site._convert_prices -->
<g id="node38" class="node">
<title>build_site._convert_prices</title>
<g id="a_node38"><a xlink:title="Add `_display_price` and `_price_class` fields converted to `cur`.">
<polygon fill="none" stroke="black" points="3121.18,-1784 2927.18,-1784 2927.18,-1590 3121.18,-1590 3121.18,-1784"/>
<text text-anchor="middle" x="3024.18" y="-1683.3" font-family="Times,serif" font-size="14.00">build_site._convert_prices</text>
</a>
</g>
</g>
<!-- price_utils.canonical_currency -->
<g id="node39" class="node">
<title>price_utils.canonical_currency</title>
<g id="a_node39"><a xlink:title="Return canonical currency code or ``None`` when unknown.">
<polygon fill="none" stroke="black" points="3550.68,-1729 3436.68,-1729 3436.68,-1615 3550.68,-1615 3550.68,-1729"/>
<text text-anchor="middle" x="3493.68" y="-1668.3" font-family="Times,serif" font-size="14.00">price_utils.canonical_currency</text>
</a>
</g>
</g>
<!-- build_site._convert_prices&#45;&gt;price_utils.canonical_currency -->
<g id="edge31" class="edge">
<title>build_site._convert_prices&#45;&gt;price_utils.canonical_currency</title>
<path fill="none" stroke="black" d="M3121.2,-1683.92C3212.11,-1681 3346.23,-1676.7 3426,-1674.14"/>
<polygon fill="black" stroke="black" points="3426.52,-1677.62 3436.4,-1673.81 3426.3,-1670.63 3426.52,-1677.62"/>
</g>
<!-- build_site._load_state -->
<g id="node40" class="node">
<title>build_site._load_state</title>
<g id="a_node40"><a xlink:title="Return ontology fields, embeddings, lots and similarity cache.">
<polygon fill="none" stroke="black" points="2710.68,-3343.5 2585.68,-3343.5 2585.68,-3218.5 2710.68,-3218.5 2710.68,-3343.5"/>
<text text-anchor="middle" x="2648.18" y="-3277.3" font-family="Times,serif" font-size="14.00">build_site._load_state</text>
</a>
</g>
</g>
<!-- build_site._load_state&#45;&gt;build_site._load_ontology -->
<g id="edge32" class="edge">
<title>build_site._load_state&#45;&gt;build_site._load_ontology</title>
<path fill="none" stroke="black" d="M2710.94,-3283.81C2777.88,-3286.85 2884.44,-3291.69 2954.11,-3294.86"/>
<polygon fill="black" stroke="black" points="2953.96,-3298.36 2964.11,-3295.31 2954.28,-3291.36 2953.96,-3298.36"/>
</g>
<!-- build_site._load_state&#45;&gt;build_site._iter_lots -->
<g id="edge33" class="edge">
<title>build_site._load_state&#45;&gt;build_site._iter_lots</title>
<path fill="none" stroke="black" d="M2673.77,-3343.76C2700.83,-3415.18 2743.79,-3535.82 2768.68,-3643 2795.08,-3756.63 2745.04,-3802.74 2804.68,-3903 2827.98,-3942.15 2864.84,-3974.7 2901.71,-4000.04"/>
<polygon fill="black" stroke="black" points="2899.82,-4002.99 2910.07,-4005.67 2903.72,-3997.18 2899.82,-4002.99"/>
</g>
<!-- build_site._load_state&#45;&gt;build_site._copy_images -->
<g id="edge34" class="edge">
<title>build_site._load_state&#45;&gt;build_site._copy_images</title>
<path fill="none" stroke="black" d="M2706.41,-3218.11C2730.38,-3187.73 2755.66,-3149.37 2768.68,-3110 2790.26,-3044.78 2756.25,-1922.71 2804.68,-1874 2847.16,-1831.28 3249.52,-1840.96 3418.52,-1847.01"/>
<polygon fill="black" stroke="black" points="3418.45,-1850.51 3428.57,-1847.37 3418.71,-1843.51 3418.45,-1850.51"/>
</g>
<!-- similar_utils._load_embeddings -->
<g id="node41" class="node">
<title>similar_utils._load_embeddings</title>
<g id="a_node41"><a xlink:title="Return mapping of lot id to embedding vector.">
<polygon fill="none" stroke="black" points="3982.18,-4013.5 3821.18,-4013.5 3821.18,-3852.5 3982.18,-3852.5 3982.18,-4013.5"/>
<text text-anchor="middle" x="3901.68" y="-3929.3" font-family="Times,serif" font-size="14.00">similar_utils._load_embeddings</text>
</a>
</g>
</g>
<!-- build_site._load_state&#45;&gt;similar_utils._load_embeddings -->
<g id="edge35" class="edge">
<title>build_site._load_state&#45;&gt;similar_utils._load_embeddings</title>
<path fill="none" stroke="black" d="M2710.94,-3322.48C2738.5,-3339.02 2772.06,-3356.58 2804.68,-3367 2898.21,-3396.89 3173.98,-3347.85 3243.68,-3417 3337.45,-3510.02 3184.76,-3620.15 3279.68,-3712 3348.3,-3778.4 3630.84,-3693.32 3707.68,-3750 3741.69,-3775.08 3716.22,-3805.88 3743.68,-3838 3762.48,-3859.98 3787.7,-3878.32 3812.41,-3892.84"/>
<polygon fill="black" stroke="black" points="3810.7,-3895.89 3821.12,-3897.81 3814.17,-3889.81 3810.7,-3895.89"/>
</g>
<!-- similar_utils._load_similar -->
<g id="node42" class="node">
<title>similar_utils._load_similar</title>
<g id="a_node42"><a xlink:title="Return cached similar lots mapping.">
<polygon fill="none" stroke="black" points="3995.18,-3796.5 3808.18,-3796.5 3808.18,-3609.5 3995.18,-3609.5 3995.18,-3796.5"/>
<text text-anchor="middle" x="3901.68" y="-3699.3" font-family="Times,serif" font-size="14.00">similar_utils._load_similar</text>
</a>
</g>
</g>
<!-- build_site._load_state&#45;&gt;similar_utils._load_similar -->
<g id="edge36" class="edge">
<title>build_site._load_state&#45;&gt;similar_utils._load_similar</title>
<path fill="none" stroke="black" d="M2710.82,-3255.29C2738.92,-3244.91 2772.93,-3234.17 2804.68,-3229 2900.97,-3213.33 3171.73,-3163.13 3243.68,-3229 3310.66,-3290.31 3216.1,-3571.18 3279.68,-3636 3284.18,-3640.59 3622.54,-3675.12 3797.85,-3692.73"/>
<polygon fill="black" stroke="black" points="3797.57,-3696.22 3807.87,-3693.74 3798.27,-3689.26 3797.57,-3696.22"/>
</g>
<!-- similar_utils._load_embeddings&#45;&gt;notes_utils.load_json -->
<g id="edge103" class="edge">
<title>similar_utils._load_embeddings&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M3982.29,-3969.28C4023.94,-3988.26 4074.31,-4011.21 4113.67,-4029.15"/>
<polygon fill="black" stroke="black" points="4112.37,-4032.4 4122.92,-4033.36 4115.27,-4026.03 4112.37,-4032.4"/>
</g>
<!-- similar_utils._load_similar&#45;&gt;notes_utils.load_json -->
<g id="edge104" class="edge">
<title>similar_utils._load_similar&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M3995.2,-3754.26C4018.23,-3770.02 4041.51,-3788.86 4059.68,-3810 4061.33,-3811.92 4112.75,-3919.54 4147.6,-3992.65"/>
<polygon fill="black" stroke="black" points="4144.51,-3994.31 4151.97,-4001.83 4150.83,-3991.3 4144.51,-3994.31"/>
</g>
<!-- build_site._categorise -->
<g id="node43" class="node">
<title>build_site._categorise</title>
<g id="a_node43"><a xlink:title="Return category info and recent lot list.&#10;&#10;Categories are split by ``market:deal`` and ``sell_item`` lots are further&#10;grouped by ``item:type``.&#10;Stats include price range, last timestamp and embedding centroid so the&#10;sorting logic used on item pages also works for categories.">
<polygon fill="none" stroke="black" points="3686.68,-958 3300.68,-958 3300.68,-572 3686.68,-572 3686.68,-958"/>
<text text-anchor="middle" x="3493.68" y="-761.3" font-family="Times,serif" font-size="14.00">build_site._categorise</text>
</a>
</g>
</g>
<!-- build_site._categorise&#45;&gt;lot_io.get_seller -->
<g id="edge37" class="edge">
<title>build_site._categorise&#45;&gt;lot_io.get_seller</title>
<path fill="none" stroke="black" d="M3686.89,-933.94C3694.53,-944.66 3701.53,-955.7 3707.68,-967 3749.37,-1043.65 3698.72,-1085.22 3743.68,-1160 3765.19,-1195.77 3800.95,-1225.43 3832.91,-1246.87"/>
<polygon fill="black" stroke="black" points="3831.09,-1249.87 3841.38,-1252.42 3834.93,-1244.01 3831.09,-1249.87"/>
</g>
<!-- build_site._render_site -->
<g id="node44" class="node">
<title>build_site._render_site</title>
<g id="a_node44"><a xlink:title="Render all HTML pages for ``lots`` using cached templates.">
<polygon fill="none" stroke="black" points="3217.18,-1154 2831.18,-1154 2831.18,-768 3217.18,-768 3217.18,-1154"/>
<text text-anchor="middle" x="3024.18" y="-957.3" font-family="Times,serif" font-size="14.00">build_site._render_site</text>
</a>
</g>
</g>
<!-- build_site._render_site&#45;&gt;lot_io.get_seller -->
<g id="edge38" class="edge">
<title>build_site._render_site&#45;&gt;lot_io.get_seller</title>
<path fill="none" stroke="black" d="M3217.2,-1126.95C3227.06,-1140.15 3236.03,-1153.87 3243.68,-1168 3286.09,-1246.26 3211.32,-1308 3279.68,-1365 3352.73,-1425.91 3614.4,-1383.57 3707.68,-1365 3750.62,-1356.45 3795.98,-1338.18 3831.93,-1321.25"/>
<polygon fill="black" stroke="black" points="3833.82,-1324.23 3841.33,-1316.75 3830.8,-1317.91 3833.82,-1324.23"/>
</g>
<!-- build_site.build_page -->
<g id="node45" class="node">
<title>build_site.build_page</title>
<g id="a_node45"><a xlink:title="Render ``lot`` into separate HTML files for every language.">
<polygon fill="none" stroke="black" points="3707.68,-3232 3279.68,-3232 3279.68,-2804 3707.68,-2804 3707.68,-3232"/>
<text text-anchor="middle" x="3493.68" y="-3014.3" font-family="Times,serif" font-size="14.00">build_site.build_page</text>
</a>
</g>
</g>
<!-- build_site._render_site&#45;&gt;build_site.build_page -->
<g id="edge39" class="edge">
<title>build_site._render_site&#45;&gt;build_site.build_page</title>
<path fill="none" stroke="black" d="M3217.28,-1149.68C3227.59,-1166.18 3236.6,-1183.35 3243.68,-1201 3304.87,-1353.57 3232.15,-2522.64 3279.68,-2680 3291.47,-2719.03 3309.08,-2757.96 3329.21,-2794.78"/>
<polygon fill="black" stroke="black" points="3326.19,-2796.55 3334.1,-2803.59 3332.31,-2793.15 3326.19,-2796.55"/>
</g>
<!-- build_site._render_site&#45;&gt;notes_utils.read_text -->
<g id="edge40" class="edge">
<title>build_site._render_site&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M3217.2,-1118.28C3227.13,-1131.3 3236.11,-1144.91 3243.68,-1159 3293.9,-1252.47 3202.14,-1322.58 3279.68,-1395 3406.8,-1513.72 3929.76,-1344.36 4059.68,-1460 4288.69,-1663.84 4374.79,-4002.55 4387.87,-4402.11"/>
<polygon fill="black" stroke="black" points="4384.38,-4402.4 4388.2,-4412.28 4391.38,-4402.17 4384.38,-4402.4"/>
</g>
<!-- similar_utils._format_vector -->
<g id="node47" class="node">
<title>similar_utils._format_vector</title>
<g id="a_node47"><a xlink:title="Return compact JSON representation for ``vec``.">
<polygon fill="none" stroke="black" points="3945.68,-2107 3857.68,-2107 3857.68,-2019 3945.68,-2019 3945.68,-2107"/>
<text text-anchor="middle" x="3901.68" y="-2059.3" font-family="Times,serif" font-size="14.00">similar_utils._format_vector</text>
</a>
</g>
</g>
<!-- build_site._render_site&#45;&gt;similar_utils._format_vector -->
<g id="edge41" class="edge">
<title>build_site._render_site&#45;&gt;similar_utils._format_vector</title>
<path fill="none" stroke="black" d="M3217.24,-1152.48C3227.32,-1168.16 3236.3,-1184.39 3243.68,-1201 3276.96,-1275.89 3221.47,-1510.32 3279.68,-1568 3347.51,-1635.21 3630.52,-1549.75 3707.68,-1606 3716.42,-1612.37 3830.21,-1889.94 3878.86,-2009.33"/>
<polygon fill="black" stroke="black" points="3875.65,-2010.73 3882.67,-2018.67 3882.13,-2008.09 3875.65,-2010.73"/>
</g>
<!-- build_site.build_page&#45;&gt;caption_io.read_caption -->
<g id="edge42" class="edge">
<title>build_site.build_page&#45;&gt;caption_io.read_caption</title>
<path fill="none" stroke="black" d="M3686.1,-3232.23C3694.42,-3247.47 3701.75,-3263.11 3707.68,-3279 3798.66,-3522.46 3675.63,-4197.17 3743.68,-4448 3764.6,-4525.11 3809.75,-4604.2 3846.28,-4659.94"/>
<polygon fill="black" stroke="black" points="3843.4,-4661.93 3851.84,-4668.34 3849.24,-4658.07 3843.4,-4661.93"/>
</g>
<!-- build_site.build_page&#45;&gt;build_site._env_for_lang -->
<g id="edge43" class="edge">
<title>build_site.build_page&#45;&gt;build_site._env_for_lang</title>
<path fill="none" stroke="black" d="M3653.51,-2803.67C3675.64,-2764.27 3695.09,-2722.21 3707.68,-2680 3740.39,-2570.37 3684.51,-718.92 3743.68,-621 3759.93,-594.12 3787.82,-575.05 3815.63,-561.83"/>
<polygon fill="black" stroke="black" points="3817.38,-564.88 3825.04,-557.57 3814.49,-558.5 3817.38,-564.88"/>
</g>
<!-- build_site.build_page&#45;&gt;post_io.read_post -->
<g id="edge44" class="edge">
<title>build_site.build_page&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M3686.23,-3232.18C3694.52,-3247.44 3701.8,-3263.09 3707.68,-3279 3765.73,-3436.09 3682.02,-4613.11 3744.16,-4811.33"/>
<polygon fill="black" stroke="black" points="3740.87,-4812.53 3747.53,-4820.77 3747.46,-4810.18 3740.87,-4812.53"/>
</g>
<!-- build_site.build_page&#45;&gt;post_io.raw_post_path -->
<g id="edge45" class="edge">
<title>build_site.build_page&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M3686.39,-3232.13C3694.64,-3247.39 3701.87,-3263.07 3707.68,-3279 3798.13,-3526.94 3647.81,-5408.11 3743.68,-5654 3767.71,-5715.61 3823.91,-5769.54 3862.13,-5800.95"/>
<polygon fill="black" stroke="black" points="3860.01,-5803.74 3869.99,-5807.31 3864.41,-5798.3 3860.01,-5803.74"/>
</g>
<!-- build_site.build_page&#45;&gt;similar_utils._format_vector -->
<g id="edge46" class="edge">
<title>build_site.build_page&#45;&gt;similar_utils._format_vector</title>
<path fill="none" stroke="black" d="M3649.74,-2803.55C3672.45,-2764 3693.07,-2721.92 3707.68,-2680 3756.26,-2540.69 3699.43,-2490.74 3743.68,-2350 3771.17,-2262.57 3826.39,-2171.33 3863.45,-2115.82"/>
<polygon fill="black" stroke="black" points="3866.56,-2117.47 3869.24,-2107.22 3860.75,-2113.56 3866.56,-2117.47"/>
</g>
<!-- notes_utils.read_text&#45;&gt;notes_utils.read_text -->
<g id="edge93" class="edge">
<title>notes_utils.read_text&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M4352.47,-4507.69C4356.21,-4518.01 4368.94,-4525.5 4390.68,-4525.5 4405.97,-4525.5 4416.8,-4521.8 4423.19,-4516.01"/>
<polygon fill="black" stroke="black" points="4426.13,-4517.92 4428.89,-4507.69 4420.35,-4513.96 4426.13,-4517.92"/>
</g>
<!-- build_site.main -->
<g id="node48" class="node">
<title>build_site.main</title>
<g id="a_node48"><a xlink:title="Build the static site under ``VIEWS_DIR``.">
<polygon fill="none" stroke="black" points="2491.68,-1225.5 2224.68,-1225.5 2224.68,-958.5 2491.68,-958.5 2491.68,-1225.5"/>
<text text-anchor="middle" x="2358.18" y="-1088.3" font-family="Times,serif" font-size="14.00">build_site.main</text>
</a>
</g>
</g>
<!-- build_site.main&#45;&gt;config_utils.load_config -->
<g id="edge61" class="edge">
<title>build_site.main&#45;&gt;config_utils.load_config</title>
<path fill="none" stroke="black" d="M2368.87,-958.24C2387.27,-738.51 2434.11,-314.09 2527.68,-200 2678.29,-16.38 2785.7,0 3023.18,0 3023.18,0 3023.18,0 3902.68,0 4163.89,0 4185.75,-214 4264.68,-463 4333.25,-679.3 4372.44,-1365.42 4385.11,-1624.58"/>
<polygon fill="black" stroke="black" points="4381.62,-1624.92 4385.6,-1634.73 4388.61,-1624.58 4381.62,-1624.92"/>
</g>
<!-- build_site.main&#45;&gt;build_site._env_for_lang -->
<g id="edge47" class="edge">
<title>build_site.main&#45;&gt;build_site._env_for_lang</title>
<path fill="none" stroke="black" d="M2373.63,-958.28C2395.87,-779.84 2444.84,-478.13 2527.68,-408 2627.76,-323.28 3583.84,-381.91 3707.68,-425 3725.84,-431.32 3727.23,-439.04 3743.68,-449 3766.78,-462.99 3792.29,-477.39 3815.91,-490.31"/>
<polygon fill="black" stroke="black" points="3814.4,-493.48 3824.86,-495.19 3817.75,-487.33 3814.4,-493.48"/>
</g>
<!-- build_site.main&#45;&gt;build_site._copy_static -->
<g id="edge48" class="edge">
<title>build_site.main&#45;&gt;build_site._copy_static</title>
<path fill="none" stroke="black" d="M2384.42,-1225.62C2408.07,-1321.14 2451.56,-1448.02 2527.68,-1537 2543.09,-1555.01 2564.53,-1569.28 2585,-1580"/>
<polygon fill="black" stroke="black" points="2583.49,-1583.16 2594,-1584.53 2586.64,-1576.91 2583.49,-1583.16"/>
</g>
<!-- build_site.main&#45;&gt;build_site._convert_prices -->
<g id="edge49" class="edge">
<title>build_site.main&#45;&gt;build_site._convert_prices</title>
<path fill="none" stroke="black" d="M2379.93,-1225.57C2406.6,-1378.1 2457.95,-1613.62 2527.68,-1668 2586.06,-1713.52 2789.6,-1706.46 2916.93,-1696.92"/>
<polygon fill="black" stroke="black" points="2917.4,-1700.39 2927.11,-1696.14 2916.87,-1693.41 2917.4,-1700.39"/>
</g>
<!-- build_site.main&#45;&gt;price_utils.canonical_currency -->
<g id="edge53" class="edge">
<title>build_site.main&#45;&gt;price_utils.canonical_currency</title>
<path fill="none" stroke="black" d="M2449.61,-1225.71C2529.47,-1331.72 2656.12,-1473.25 2804.68,-1543 2981.96,-1626.23 3056.4,-1523.74 3243.68,-1581 3261.19,-1586.35 3262.93,-1593.63 3279.68,-1601 3327.68,-1622.11 3384.05,-1640.64 3426.74,-1653.47"/>
<polygon fill="black" stroke="black" points="3425.87,-1656.87 3436.45,-1656.37 3427.87,-1650.16 3425.87,-1656.87"/>
</g>
<!-- build_site.main&#45;&gt;build_site._load_state -->
<g id="edge50" class="edge">
<title>build_site.main&#45;&gt;build_site._load_state</title>
<path fill="none" stroke="black" d="M2374.07,-1225.81C2400.81,-1469.85 2457.36,-2003.69 2491.68,-2455 2502.74,-2600.36 2480.11,-2972.21 2527.68,-3110 2540.11,-3145.99 2562.48,-3181.25 2584.53,-3210.32"/>
<polygon fill="black" stroke="black" points="2581.85,-3212.58 2590.73,-3218.35 2587.39,-3208.3 2581.85,-3212.58"/>
</g>
<!-- build_site.main&#45;&gt;build_site._categorise -->
<g id="edge51" class="edge">
<title>build_site.main&#45;&gt;build_site._categorise</title>
<path fill="none" stroke="black" d="M2378.29,-958.33C2404.42,-794.83 2456.32,-531.54 2527.68,-465 2586.04,-410.59 3181.1,-361.51 3243.68,-411 3298.14,-454.06 3245.05,-502.83 3279.68,-563 3284.3,-571.03 3289.34,-578.94 3294.71,-586.7"/>
<polygon fill="black" stroke="black" points="3292.02,-588.95 3300.67,-595.06 3297.72,-584.89 3292.02,-588.95"/>
</g>
<!-- build_site.main&#45;&gt;build_site._render_site -->
<g id="edge52" class="edge">
<title>build_site.main&#45;&gt;build_site._render_site</title>
<path fill="none" stroke="black" d="M2491.81,-1098.07C2572.81,-1098.77 2677.91,-1094.3 2768.68,-1073 2786.03,-1068.93 2803.67,-1063.7 2821.15,-1057.74"/>
<polygon fill="black" stroke="black" points="2822.56,-1060.96 2830.84,-1054.36 2820.25,-1054.35 2822.56,-1060.96"/>
</g>
<!-- price_utils.fetch_official_rates -->
<g id="node49" class="node">
<title>price_utils.fetch_official_rates</title>
<g id="a_node49"><a xlink:title="Return currency multipliers relative to USD from NBG.">
<polygon fill="none" stroke="black" points="2753.18,-1064 2543.18,-1064 2543.18,-854 2753.18,-854 2753.18,-1064"/>
<text text-anchor="middle" x="2648.18" y="-955.3" font-family="Times,serif" font-size="14.00">price_utils.fetch_official_rates</text>
</a>
</g>
</g>
<!-- build_site.main&#45;&gt;price_utils.fetch_official_rates -->
<g id="edge54" class="edge">
<title>build_site.main&#45;&gt;price_utils.fetch_official_rates</title>
<path fill="none" stroke="black" d="M2491.8,-1030.76C2505.72,-1024.33 2519.77,-1017.84 2533.45,-1011.52"/>
<polygon fill="black" stroke="black" points="2535.24,-1014.55 2542.85,-1007.18 2532.3,-1008.2 2535.24,-1014.55"/>
</g>
<!-- price_utils.apply_price_model -->
<g id="node50" class="node">
<title>price_utils.apply_price_model</title>
<g id="a_node50"><a xlink:title="Predict prices in USD and guess missing currencies.">
<polygon fill="none" stroke="black" points="2753.18,-785 2543.18,-785 2543.18,-575 2753.18,-575 2753.18,-785"/>
<text text-anchor="middle" x="2648.18" y="-676.3" font-family="Times,serif" font-size="14.00">price_utils.apply_price_model</text>
</a>
</g>
</g>
<!-- build_site.main&#45;&gt;price_utils.apply_price_model -->
<g id="edge55" class="edge">
<title>build_site.main&#45;&gt;price_utils.apply_price_model</title>
<path fill="none" stroke="black" d="M2449.45,-958.21C2474.57,-921.38 2502.01,-881.52 2527.68,-845 2539.4,-828.34 2551.88,-810.83 2564.21,-793.69"/>
<polygon fill="black" stroke="black" points="2567.24,-795.47 2570.24,-785.31 2561.56,-791.38 2567.24,-795.47"/>
</g>
<!-- similar_utils._save_similar -->
<g id="node51" class="node">
<title>similar_utils._save_similar</title>
<g id="a_node51"><a xlink:title="Write ``sim_map`` to ``SIMILAR_DIR`` mirroring ``LOTS_DIR`` layout.">
<polygon fill="none" stroke="black" points="3547.68,-1559 3439.68,-1559 3439.68,-1451 3547.68,-1451 3547.68,-1559"/>
<text text-anchor="middle" x="3493.68" y="-1501.3" font-family="Times,serif" font-size="14.00">similar_utils._save_similar</text>
</a>
</g>
</g>
<!-- build_site.main&#45;&gt;similar_utils._save_similar -->
<g id="edge56" class="edge">
<title>build_site.main&#45;&gt;similar_utils._save_similar</title>
<path fill="none" stroke="black" d="M2491.88,-1115.7C2580.28,-1130.86 2699.16,-1150.04 2804.68,-1163 2853.28,-1168.97 3207.96,-1167.52 3243.68,-1201 3321.11,-1273.55 3210.8,-1356.3 3279.68,-1437 3316.62,-1480.28 3381.09,-1496.29 3429.45,-1502.07"/>
<polygon fill="black" stroke="black" points="3429.19,-1505.56 3439.51,-1503.15 3429.94,-1498.6 3429.19,-1505.56"/>
</g>
<!-- similar_utils._prune_similar -->
<g id="node52" class="node">
<title>similar_utils._prune_similar</title>
<g id="a_node52"><a xlink:title="Drop cache entries referring to ids not in ``valid_ids``.">
<polygon fill="none" stroke="black" points="3071.68,-515.5 2976.68,-515.5 2976.68,-420.5 3071.68,-420.5 3071.68,-515.5"/>
<text text-anchor="middle" x="3024.18" y="-464.3" font-family="Times,serif" font-size="14.00">similar_utils._prune_similar</text>
</a>
</g>
</g>
<!-- build_site.main&#45;&gt;similar_utils._prune_similar -->
<g id="edge57" class="edge">
<title>build_site.main&#45;&gt;similar_utils._prune_similar</title>
<path fill="none" stroke="black" d="M2365.24,-958.32C2378.12,-837.97 2416.37,-665.22 2527.68,-566 2652.2,-455.01 2865.24,-454.85 2966.51,-462.1"/>
<polygon fill="black" stroke="black" points="2966.3,-465.6 2976.54,-462.87 2966.84,-458.62 2966.3,-465.6"/>
</g>
<!-- similar_utils._calc_similar_nn -->
<g id="node53" class="node">
<title>similar_utils._calc_similar_nn</title>
<g id="a_node53"><a xlink:title="Fill ``sim_map`` for ``new_ids`` using a nearest neighbour search.&#10;&#10;``vec_ids`` lists all lots that have an embedding. &#160;``new_ids`` is a subset&#10;for which we still need recommendations. &#160;We gather vectors for&#10;``vec_ids`` and use ``NearestNeighbors`` from scikit&#45;learn to find the&#10;closest items. &#160;Embeddings of lots without a vector are skipped.">
<polygon fill="none" stroke="black" points="3649.68,-340 3337.68,-340 3337.68,-28 3649.68,-28 3649.68,-340"/>
<text text-anchor="middle" x="3493.68" y="-180.3" font-family="Times,serif" font-size="14.00">similar_utils._calc_similar_nn</text>
</a>
</g>
</g>
<!-- build_site.main&#45;&gt;similar_utils._calc_similar_nn -->
<g id="edge58" class="edge">
<title>build_site.main&#45;&gt;similar_utils._calc_similar_nn</title>
<path fill="none" stroke="black" d="M2371.31,-958.36C2391.67,-765.5 2439.41,-423.12 2527.68,-340 2743.42,-136.87 3113.78,-138.26 3327.48,-159.68"/>
<polygon fill="black" stroke="black" points="3327.23,-163.17 3337.54,-160.71 3327.95,-156.21 3327.23,-163.17"/>
</g>
<!-- similar_utils._sync_embeddings -->
<g id="node54" class="node">
<title>similar_utils._sync_embeddings</title>
<g id="a_node54"><a xlink:title="Drop lots or vectors that do not match and return cleaned data.">
<polygon fill="none" stroke="black" points="2722.18,-1863 2574.18,-1863 2574.18,-1715 2722.18,-1715 2722.18,-1863"/>
<text text-anchor="middle" x="2648.18" y="-1785.3" font-family="Times,serif" font-size="14.00">similar_utils._sync_embeddings</text>
</a>
</g>
</g>
<!-- build_site.main&#45;&gt;similar_utils._sync_embeddings -->
<g id="edge59" class="edge">
<title>build_site.main&#45;&gt;similar_utils._sync_embeddings</title>
<path fill="none" stroke="black" d="M2370.74,-1225.55C2387.59,-1356.57 2428.61,-1557.11 2527.68,-1701 2537.98,-1715.95 2551.66,-1729.34 2566.08,-1740.89"/>
<polygon fill="black" stroke="black" points="2564.09,-1743.78 2574.15,-1747.12 2568.37,-1738.24 2564.09,-1743.78"/>
</g>
<!-- similar_utils._similar_by_user -->
<g id="node55" class="node">
<title>similar_utils._similar_by_user</title>
<g id="a_node55"><a xlink:title="Return map of lot id to other lots from the same user.">
<polygon fill="none" stroke="black" points="3127.68,-4479.5 2920.68,-4479.5 2920.68,-4272.5 3127.68,-4272.5 3127.68,-4479.5"/>
<text text-anchor="middle" x="3024.18" y="-4372.3" font-family="Times,serif" font-size="14.00">similar_utils._similar_by_user</text>
</a>
</g>
</g>
<!-- build_site.main&#45;&gt;similar_utils._similar_by_user -->
<g id="edge60" class="edge">
<title>build_site.main&#45;&gt;similar_utils._similar_by_user</title>
<path fill="none" stroke="black" d="M2375.41,-1225.72C2404.29,-1469.61 2464.14,-2003.23 2491.68,-2455 2501.47,-2615.53 2473.38,-3750.62 2527.68,-3902 2595.14,-4090.04 2652.47,-4126.61 2804.68,-4256 2836.53,-4283.07 2875.44,-4306.79 2911.55,-4325.84"/>
<polygon fill="black" stroke="black" points="2910.18,-4329.07 2920.67,-4330.58 2913.41,-4322.86 2910.18,-4329.07"/>
</g>
<!-- price_utils.train_price_regression -->
<g id="node64" class="node">
<title>price_utils.train_price_regression</title>
<g id="a_node64"><a xlink:title="Return ``(model, currency_map, counts)`` trained on ``lots``.&#10;&#10;``lots`` must contain ``price`` and ``price:currency`` fields. Only lots with&#10;embeddings present in ``id_to_vec`` are considered. Prices are regressed on&#10;the logarithm scale so coefficients are interpretable as multiplicative&#10;factors. ``USD`` is treated as the base currency so coefficients can be&#10;interpreted as exchange rate multipliers. The returned ``counts`` dictionary&#10;maps each currency to the number of training samples observed.">
<polygon fill="none" stroke="black" points="3186.18,-1534 2862.18,-1534 2862.18,-1210 3186.18,-1210 3186.18,-1534"/>
<text text-anchor="middle" x="3024.18" y="-1368.3" font-family="Times,serif" font-size="14.00">price_utils.train_price_regression</text>
</a>
</g>
</g>
<!-- price_utils.apply_price_model&#45;&gt;price_utils.train_price_regression -->
<g id="edge77" class="edge">
<title>price_utils.apply_price_model&#45;&gt;price_utils.train_price_regression</title>
<path fill="none" stroke="black" d="M2737.4,-785.43C2749.66,-804.33 2760.76,-824.55 2768.68,-845 2820.09,-977.62 2741.52,-1035.56 2804.68,-1163 2817.72,-1189.3 2835.49,-1214.09 2855.3,-1236.77"/>
<polygon fill="black" stroke="black" points="2852.83,-1239.25 2862.1,-1244.38 2858.05,-1234.58 2852.83,-1239.25"/>
</g>
<!-- price_utils.predict_price -->
<g id="node65" class="node">
<title>price_utils.predict_price</title>
<g id="a_node65"><a xlink:title="Return predicted price for ``vec`` in ``currency``.&#10;&#10;When ``model`` is ``None`` or ``vec`` is missing, ``None`` is returned.">
<polygon fill="none" stroke="black" points="3576.18,-1141.5 3411.18,-1141.5 3411.18,-976.5 3576.18,-976.5 3576.18,-1141.5"/>
<text text-anchor="middle" x="3493.68" y="-1055.3" font-family="Times,serif" font-size="14.00">price_utils.predict_price</text>
</a>
</g>
</g>
<!-- price_utils.apply_price_model&#45;&gt;price_utils.predict_price -->
<g id="edge78" class="edge">
<title>price_utils.apply_price_model&#45;&gt;price_utils.predict_price</title>
<path fill="none" stroke="black" d="M2753.27,-618.86C2769.98,-611.49 2787.46,-605.13 2804.68,-601 2899.56,-578.28 3171.4,-535.48 3243.68,-601 3304.23,-655.89 3231.5,-900.99 3279.68,-967 3308.39,-1006.32 3357.46,-1029.02 3401.28,-1042.03"/>
<polygon fill="black" stroke="black" points="3400.54,-1045.46 3411.12,-1044.82 3402.45,-1038.72 3400.54,-1045.46"/>
</g>
<!-- price_utils.currency_rates -->
<g id="node66" class="node">
<title>price_utils.currency_rates</title>
<g id="a_node66"><a xlink:title="Return estimated currency multipliers relative to the base.&#10;&#10;The regression model learns one coefficient per currency dummy feature. &#160;The&#10;coefficient is the logarithm of the multiplier relative to USD.">
<polygon fill="none" stroke="black" points="3973.68,-440 3829.68,-440 3829.68,-296 3973.68,-296 3973.68,-440"/>
<text text-anchor="middle" x="3901.68" y="-364.3" font-family="Times,serif" font-size="14.00">price_utils.currency_rates</text>
</a>
</g>
</g>
<!-- price_utils.apply_price_model&#45;&gt;price_utils.currency_rates -->
<g id="edge79" class="edge">
<title>price_utils.apply_price_model&#45;&gt;price_utils.currency_rates</title>
<path fill="none" stroke="black" d="M2753.28,-589.77C2769.65,-579.2 2787.02,-569.79 2804.68,-563 2896.11,-527.87 3166.03,-583.69 3243.68,-524 3280.8,-495.47 3242.6,-453.59 3279.68,-425 3362,-361.54 3670.2,-361.21 3819.12,-365.01"/>
<polygon fill="black" stroke="black" points="3819.48,-368.52 3829.57,-365.29 3819.66,-361.52 3819.48,-368.52"/>
</g>
<!-- price_utils._guess_currency_verified -->
<g id="node68" class="node">
<title>price_utils._guess_currency_verified</title>
<g id="a_node68"><a xlink:title="Return currency when both AI and official rates agree.">
<polygon fill="none" stroke="black" points="3094.18,-750 2954.18,-750 2954.18,-610 3094.18,-610 3094.18,-750"/>
<text text-anchor="middle" x="3024.18" y="-676.3" font-family="Times,serif" font-size="14.00">price_utils._guess_currency_verified</text>
</a>
</g>
</g>
<!-- price_utils.apply_price_model&#45;&gt;price_utils._guess_currency_verified -->
<g id="edge80" class="edge">
<title>price_utils.apply_price_model&#45;&gt;price_utils._guess_currency_verified</title>
<path fill="none" stroke="black" d="M2753.36,-680C2813.69,-680 2888.44,-680 2943.95,-680"/>
<polygon fill="black" stroke="black" points="2944.08,-683.5 2954.08,-680 2944.08,-676.5 2944.08,-683.5"/>
</g>
<!-- similar_utils._save_similar&#45;&gt;notes_utils.write_json -->
<g id="edge106" class="edge">
<title>similar_utils._save_similar&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M3548.1,-1519.93C3676.26,-1556.88 3995.33,-1655.89 4059.68,-1743 4146.24,-1860.16 4171.4,-2320.09 4177.48,-2474.29"/>
<polygon fill="black" stroke="black" points="4173.99,-2474.57 4177.87,-2484.43 4180.99,-2474.3 4173.99,-2474.57"/>
</g>
<!-- similar_utils._save_similar&#45;&gt;lot_io.lot_json_path -->
<g id="edge105" class="edge">
<title>similar_utils._save_similar&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M3547.71,-1513.77C3598.55,-1525.29 3672.61,-1550.95 3707.68,-1606 3789.05,-1733.7 3691.78,-6914.75 3743.68,-7057 3766.41,-7119.29 3819.42,-7175.62 3857.56,-7210.26"/>
<polygon fill="black" stroke="black" points="3855.67,-7213.26 3865.46,-7217.31 3860.34,-7208.04 3855.67,-7213.26"/>
</g>
<!-- similar_utils._similar_path -->
<g id="node86" class="node">
<title>similar_utils._similar_path</title>
<g id="a_node86"><a xlink:title="Return cache file path for ``lot_path`` under ``SIMILAR_DIR``.">
<polygon fill="none" stroke="black" points="3937.68,-1541 3865.68,-1541 3865.68,-1469 3937.68,-1469 3937.68,-1541"/>
<text text-anchor="middle" x="3901.68" y="-1501.3" font-family="Times,serif" font-size="14.00">similar_utils._similar_path</text>
</a>
</g>
</g>
<!-- similar_utils._save_similar&#45;&gt;similar_utils._similar_path -->
<g id="edge107" class="edge">
<title>similar_utils._save_similar&#45;&gt;similar_utils._similar_path</title>
<path fill="none" stroke="black" d="M3547.76,-1505C3628.23,-1505 3779.72,-1505 3855.34,-1505"/>
<polygon fill="black" stroke="black" points="3855.5,-1508.5 3865.5,-1505 3855.5,-1501.5 3855.5,-1508.5"/>
</g>
<!-- similar_utils._update_reciprocal -->
<g id="node87" class="node">
<title>similar_utils._update_reciprocal</title>
<g id="a_node87"><a xlink:title="Insert ``lot_id`` into caches of lots listed in ``sims`` if closer.">
<polygon fill="none" stroke="black" points="3975.68,-258 3827.68,-258 3827.68,-110 3975.68,-110 3975.68,-258"/>
<text text-anchor="middle" x="3901.68" y="-180.3" font-family="Times,serif" font-size="14.00">similar_utils._update_reciprocal</text>
</a>
</g>
</g>
<!-- similar_utils._calc_similar_nn&#45;&gt;similar_utils._update_reciprocal -->
<g id="edge108" class="edge">
<title>similar_utils._calc_similar_nn&#45;&gt;similar_utils._update_reciprocal</title>
<path fill="none" stroke="black" d="M3649.91,-184C3706.86,-184 3769.13,-184 3817.37,-184"/>
<polygon fill="black" stroke="black" points="3817.45,-187.5 3827.45,-184 3817.45,-180.5 3817.45,-187.5"/>
</g>
<!-- similar_utils._cos_sim -->
<g id="node85" class="node">
<title>similar_utils._cos_sim</title>
<g id="a_node85"><a xlink:title="Return cosine similarity between two embeddings.">
<polygon fill="none" stroke="black" points="3544.68,-4951 3442.68,-4951 3442.68,-4849 3544.68,-4849 3544.68,-4951"/>
<text text-anchor="middle" x="3493.68" y="-4896.3" font-family="Times,serif" font-size="14.00">similar_utils._cos_sim</text>
</a>
</g>
</g>
<!-- similar_utils._similar_by_user&#45;&gt;similar_utils._cos_sim -->
<g id="edge109" class="edge">
<title>similar_utils._similar_by_user&#45;&gt;similar_utils._cos_sim</title>
<path fill="none" stroke="black" d="M3127.88,-4404.73C3170.47,-4421.94 3216.26,-4448.4 3243.68,-4488 3323.65,-4603.49 3197.28,-4688.24 3279.68,-4802 3315.65,-4851.65 3383.03,-4876.8 3432.41,-4889.1"/>
<polygon fill="black" stroke="black" points="3431.8,-4892.55 3442.34,-4891.46 3433.42,-4885.74 3431.8,-4892.55"/>
</g>
<!-- moderation.should_skip_text -->
<g id="node56" class="node">
<title>moderation.should_skip_text</title>
<g id="a_node56"><a xlink:title="Return ``True`` if ``text`` contains banned phrases.">
<polygon fill="none" stroke="black" points="4227.68,-6308.5 4132.68,-6308.5 4132.68,-6213.5 4227.68,-6213.5 4227.68,-6308.5"/>
<text text-anchor="middle" x="4180.18" y="-6257.3" font-family="Times,serif" font-size="14.00">moderation.should_skip_text</text>
</a>
</g>
</g>
<!-- moderation.should_skip_user -->
<g id="node57" class="node">
<title>moderation.should_skip_user</title>
<g id="a_node57"><a xlink:title="Return ``True`` if ``username`` is blacklisted.">
<polygon fill="none" stroke="black" points="4220.68,-8183.5 4139.68,-8183.5 4139.68,-8102.5 4220.68,-8102.5 4220.68,-8183.5"/>
<text text-anchor="middle" x="4180.18" y="-8139.3" font-family="Times,serif" font-size="14.00">moderation.should_skip_user</text>
</a>
</g>
</g>
<!-- moderation.message_skip_reason&#45;&gt;moderation.should_skip_text -->
<g id="edge62" class="edge">
<title>moderation.message_skip_reason&#45;&gt;moderation.should_skip_text</title>
<path fill="none" stroke="black" d="M3988.28,-6261C4031.95,-6261 4083.88,-6261 4122.54,-6261"/>
<polygon fill="black" stroke="black" points="4122.57,-6264.5 4132.57,-6261 4122.57,-6257.5 4122.57,-6264.5"/>
</g>
<!-- moderation.message_skip_reason&#45;&gt;moderation.should_skip_user -->
<g id="edge63" class="edge">
<title>moderation.message_skip_reason&#45;&gt;moderation.should_skip_user</title>
<path fill="none" stroke="black" d="M3925.73,-6347.54C3959.84,-6478.66 4023.61,-6735.94 4059.68,-6958 4130.48,-7393.87 4166.32,-7927.19 4176.26,-8092.03"/>
<polygon fill="black" stroke="black" points="4172.78,-8092.58 4176.87,-8102.35 4179.77,-8092.16 4172.78,-8092.58"/>
</g>
<!-- moderation.is_misparsed -->
<g id="node60" class="node">
<title>moderation.is_misparsed</title>
<g id="a_node60"><a xlink:title="Return ``True`` for obviously invalid lots or source posts.">
<polygon fill="none" stroke="black" points="3578.18,-2320.5 3409.18,-2320.5 3409.18,-2151.5 3578.18,-2151.5 3578.18,-2320.5"/>
<text text-anchor="middle" x="3493.68" y="-2232.3" font-family="Times,serif" font-size="14.00">moderation.is_misparsed</text>
</a>
</g>
</g>
<!-- moderation.is_misparsed&#45;&gt;lot_io.get_seller -->
<g id="edge66" class="edge">
<title>moderation.is_misparsed&#45;&gt;lot_io.get_seller</title>
<path fill="none" stroke="black" d="M3578.34,-2221.16C3624.43,-2208.36 3678.13,-2184.83 3707.68,-2142 3793.87,-2017.08 3685.7,-1600.26 3743.68,-1460 3763.04,-1413.18 3800.53,-1370.63 3834.02,-1339.21"/>
<polygon fill="black" stroke="black" points="3836.56,-1341.62 3841.54,-1332.27 3831.81,-1336.48 3836.56,-1341.62"/>
</g>
<!-- moderation.apply_to_history -->
<g id="node61" class="node">
<title>moderation.apply_to_history</title>
<g id="a_node61"><a xlink:title="Remove processed lots now failing moderation.">
<polygon fill="none" stroke="black" points="3112.18,-4831 2936.18,-4831 2936.18,-4655 3112.18,-4655 3112.18,-4831"/>
<text text-anchor="middle" x="3024.18" y="-4739.3" font-family="Times,serif" font-size="14.00">moderation.apply_to_history</text>
</a>
</g>
</g>
<!-- moderation.apply_to_history&#45;&gt;lot_io.read_lots -->
<g id="edge67" class="edge">
<title>moderation.apply_to_history&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M3112.19,-4698.8C3160.35,-4669.2 3215.94,-4625.34 3243.68,-4569 3295.87,-4463.03 3196.73,-2527.1 3279.68,-2443 3317.28,-2404.89 3669.99,-2414.46 3826.5,-2420.68"/>
<polygon fill="black" stroke="black" points="3826.38,-2424.18 3836.52,-2421.08 3826.67,-2417.18 3826.38,-2424.18"/>
</g>
<!-- moderation.apply_to_history&#45;&gt;moderation.should_skip_message -->
<g id="edge68" class="edge">
<title>moderation.apply_to_history&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M3112.33,-4759.15C3159.13,-4772.59 3213.29,-4796.8 3243.68,-4840 3306.63,-4929.48 3209.94,-5246.71 3279.68,-5331 3317.16,-5376.29 3386.33,-5387.76 3435.68,-5389.68"/>
<polygon fill="black" stroke="black" points="3435.8,-5393.18 3445.89,-5389.95 3435.98,-5386.19 3435.8,-5393.18"/>
</g>
<!-- moderation.apply_to_history&#45;&gt;moderation.should_skip_lot -->
<g id="edge69" class="edge">
<title>moderation.apply_to_history&#45;&gt;moderation.should_skip_lot</title>
<path fill="none" stroke="black" d="M3112.18,-4696.89C3159.39,-4667.02 3214.02,-4623.52 3243.68,-4569 3321.59,-4425.81 3184.33,-4336.21 3279.68,-4204 3316.24,-4153.3 3386.16,-4129.21 3435.91,-4118.06"/>
<polygon fill="black" stroke="black" points="3436.84,-4121.44 3445.89,-4115.94 3435.38,-4114.59 3436.84,-4121.44"/>
</g>
<!-- moderation.apply_to_history&#45;&gt;post_io.read_post -->
<g id="edge70" class="edge">
<title>moderation.apply_to_history&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M3112.34,-4766.37C3161.21,-4778.68 3223.47,-4793.03 3279.68,-4802 3468.27,-4832.08 3528.71,-4773.38 3707.68,-4840 3716.66,-4843.34 3725.59,-4847.22 3734.42,-4851.51"/>
<polygon fill="black" stroke="black" points="3733.07,-4854.74 3743.57,-4856.12 3736.22,-4848.49 3733.07,-4854.74"/>
</g>
<!-- moderation.apply_to_history&#45;&gt;post_io.raw_post_path -->
<g id="edge71" class="edge">
<title>moderation.apply_to_history&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M3112.42,-4762.97C3157.33,-4777.42 3209.66,-4801.38 3243.68,-4840 3280.49,-4881.78 3244.39,-4916.93 3279.68,-4960 3416.27,-5126.72 3591.09,-5006.73 3707.68,-5188 3777.66,-5296.8 3667.36,-5664.55 3743.68,-5769 3770.65,-5805.9 3823.21,-5820.48 3860.07,-5826.24"/>
<polygon fill="black" stroke="black" points="3859.62,-5829.71 3870.01,-5827.64 3860.6,-5822.78 3859.62,-5829.71"/>
</g>
<!-- message_utils.build_prompt -->
<g id="node62" class="node">
<title>message_utils.build_prompt</title>
<g id="a_node62"><a xlink:title="Return prompt combining message text with captioned file names.">
<polygon fill="none" stroke="black" points="3952.68,-4439 3850.68,-4439 3850.68,-4337 3952.68,-4337 3952.68,-4439"/>
<text text-anchor="middle" x="3901.68" y="-4384.3" font-family="Times,serif" font-size="14.00">message_utils.build_prompt</text>
</a>
</g>
</g>
<!-- message_utils.gather_chop_input -->
<g id="node63" class="node">
<title>message_utils.gather_chop_input</title>
<g id="a_node63"><a xlink:title="Return the exact text fed to the lot parser for ``msg_path``.">
<polygon fill="none" stroke="black" points="3556.18,-4496.5 3431.18,-4496.5 3431.18,-4371.5 3556.18,-4371.5 3556.18,-4496.5"/>
<text text-anchor="middle" x="3493.68" y="-4430.3" font-family="Times,serif" font-size="14.00">message_utils.gather_chop_input</text>
</a>
</g>
</g>
<!-- message_utils.gather_chop_input&#45;&gt;caption_io.read_caption -->
<g id="edge72" class="edge">
<title>message_utils.gather_chop_input&#45;&gt;caption_io.read_caption</title>
<path fill="none" stroke="black" d="M3556.45,-4447.33C3601.23,-4459.05 3661.74,-4479.27 3707.68,-4511 3765.23,-4550.74 3816.06,-4611.69 3851.1,-4660.13"/>
<polygon fill="black" stroke="black" points="3848.35,-4662.31 3857.02,-4668.41 3854.05,-4658.24 3848.35,-4662.31"/>
</g>
<!-- message_utils.gather_chop_input&#45;&gt;post_io.read_post -->
<g id="edge74" class="edge">
<title>message_utils.gather_chop_input&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M3556.6,-4439.15C3605.5,-4446.7 3671.35,-4465.28 3707.68,-4511 3789.46,-4613.91 3691.69,-4686.31 3743.86,-4811.38"/>
<polygon fill="black" stroke="black" points="3740.81,-4813.14 3748.06,-4820.87 3747.21,-4810.31 3740.81,-4813.14"/>
</g>
<!-- message_utils.gather_chop_input&#45;&gt;message_utils.build_prompt -->
<g id="edge73" class="edge">
<title>message_utils.gather_chop_input&#45;&gt;message_utils.build_prompt</title>
<path fill="none" stroke="black" d="M3556.35,-4427.01C3633.25,-4418.3 3763.89,-4403.5 3840.23,-4394.85"/>
<polygon fill="black" stroke="black" points="3841.09,-4398.27 3850.63,-4393.67 3840.3,-4391.32 3841.09,-4398.27"/>
</g>
<!-- price_utils.train_price_regression&#45;&gt;price_utils.canonical_currency -->
<g id="edge75" class="edge">
<title>price_utils.train_price_regression&#45;&gt;price_utils.canonical_currency</title>
<path fill="none" stroke="black" d="M3186.46,-1492.68C3206.57,-1510.35 3226.19,-1529.02 3243.68,-1548 3262.98,-1568.94 3256.98,-1583.81 3279.68,-1601 3322.74,-1633.59 3381.56,-1651.7 3426.49,-1661.46"/>
<polygon fill="black" stroke="black" points="3425.92,-1664.91 3436.43,-1663.53 3427.35,-1658.06 3425.92,-1664.91"/>
</g>
<!-- price_utils.guess_currency -->
<g id="node67" class="node">
<title>price_utils.guess_currency</title>
<g id="a_node67"><a xlink:title="Return currency with multiplier closest to ``price/pred_usd``.&#10;&#10;``pred_usd`` is the predicted price in USD. &#160;``price`` is the numeric value&#10;provided by the user without a currency. &#160;The function compares the implied&#10;multiplier ``price / pred_usd`` against the learnt exchange rates and picks&#10;the closest match. &#160;``counts`` may be provided to ignore rarely seen&#10;currencies when guessing. &#160;Any currency with fewer than ``min_samples``&#10;samples in the training set is skipped.">
<polygon fill="none" stroke="black" points="3592.18,-1356.5 3395.18,-1356.5 3395.18,-1159.5 3592.18,-1159.5 3592.18,-1356.5"/>
<text text-anchor="middle" x="3493.68" y="-1254.3" font-family="Times,serif" font-size="14.00">price_utils.guess_currency</text>
</a>
</g>
</g>
<!-- price_utils._guess_currency_verified&#45;&gt;price_utils.guess_currency -->
<g id="edge76" class="edge">
<title>price_utils._guess_currency_verified&#45;&gt;price_utils.guess_currency</title>
<path fill="none" stroke="black" d="M3094.44,-685.87C3144.15,-693.99 3208.35,-713.28 3243.68,-759 3297.03,-828.05 3230.65,-1077.82 3279.68,-1150 3304.59,-1186.67 3345.85,-1211.55 3385.46,-1228.09"/>
<polygon fill="black" stroke="black" points="3384.36,-1231.42 3394.95,-1231.91 3386.98,-1224.93 3384.36,-1231.42"/>
</g>
<!-- image_io.read_image_meta -->
<g id="node69" class="node">
<title>image_io.read_image_meta</title>
<g id="a_node69"><a xlink:title="Return metadata from ``path.with_suffix(&#39;.md&#39;)``.">
<polygon fill="none" stroke="black" points="3534.18,-5649.5 3453.18,-5649.5 3453.18,-5568.5 3534.18,-5568.5 3534.18,-5649.5"/>
<text text-anchor="middle" x="3493.68" y="-5605.3" font-family="Times,serif" font-size="14.00">image_io.read_image_meta</text>
</a>
</g>
</g>
<!-- notes_utils.parse_md -->
<g id="node70" class="node">
<title>notes_utils.parse_md</title>
<g id="a_node70"><a xlink:title="Return metadata dictionary and body text from ``path``.">
<polygon fill="none" stroke="black" points="3937.68,-5645 3865.68,-5645 3865.68,-5573 3937.68,-5573 3937.68,-5645"/>
<text text-anchor="middle" x="3901.68" y="-5605.3" font-family="Times,serif" font-size="14.00">notes_utils.parse_md</text>
</a>
</g>
</g>
<!-- image_io.read_image_meta&#45;&gt;notes_utils.parse_md -->
<g id="edge81" class="edge">
<title>image_io.read_image_meta&#45;&gt;notes_utils.parse_md</title>
<path fill="none" stroke="black" d="M3534.35,-5609C3610.16,-5609 3775.19,-5609 3855.27,-5609"/>
<polygon fill="black" stroke="black" points="3855.53,-5612.5 3865.53,-5609 3855.53,-5605.5 3855.53,-5612.5"/>
</g>
<!-- notes_utils.parse_md&#45;&gt;notes_utils.read_md -->
<g id="edge95" class="edge">
<title>notes_utils.parse_md&#45;&gt;notes_utils.read_md</title>
<path fill="none" stroke="black" d="M3937.79,-5608.34C3974.29,-5605.6 4030.14,-5595.26 4059.68,-5559 4107.95,-5499.76 4084.19,-5292.55 4095.68,-5217 4116.82,-5078.12 4152.52,-4915.38 4169.56,-4840.52"/>
<polygon fill="black" stroke="black" points="4173.03,-4841.08 4171.84,-4830.55 4166.2,-4839.52 4173.03,-4841.08"/>
</g>
<!-- notes_utils.parse_md&#45;&gt;notes_utils._parse_block -->
<g id="edge96" class="edge">
<title>notes_utils.parse_md&#45;&gt;notes_utils._parse_block</title>
<path fill="none" stroke="black" d="M3937.94,-5606.02C3972.72,-5601.36 4025.51,-5589.44 4059.68,-5559 4114.74,-5509.95 4145.88,-5430.56 4162.47,-5371.45"/>
<polygon fill="black" stroke="black" points="4165.85,-5372.34 4165.1,-5361.77 4159.1,-5370.5 4165.85,-5372.34"/>
</g>
<!-- image_io.write_image_meta -->
<g id="node71" class="node">
<title>image_io.write_image_meta</title>
<g id="a_node71"><a xlink:title="Write ``meta`` to ``path.with_suffix(&#39;.md&#39;)``.">
<polygon fill="none" stroke="black" points="3064.68,-9120.5 2983.68,-9120.5 2983.68,-9039.5 3064.68,-9039.5 3064.68,-9120.5"/>
<text text-anchor="middle" x="3024.18" y="-9076.3" font-family="Times,serif" font-size="14.00">image_io.write_image_meta</text>
</a>
</g>
</g>
<!-- notes_utils.write_md -->
<g id="node72" class="node">
<title>notes_utils.write_md</title>
<g id="a_node72"><a xlink:title="Write ``text`` to ``path`` ensuring a trailing newline.">
<polygon fill="none" stroke="black" points="3544.68,-9278 3442.68,-9278 3442.68,-9176 3544.68,-9176 3544.68,-9278"/>
<text text-anchor="middle" x="3493.68" y="-9223.3" font-family="Times,serif" font-size="14.00">notes_utils.write_md</text>
</a>
</g>
</g>
<!-- image_io.write_image_meta&#45;&gt;notes_utils.write_md -->
<g id="edge82" class="edge">
<title>image_io.write_image_meta&#45;&gt;notes_utils.write_md</title>
<path fill="none" stroke="black" d="M3064.69,-9082.31C3110.4,-9086.45 3186.69,-9097.97 3243.68,-9130 3263.68,-9141.24 3259.97,-9155.27 3279.68,-9167 3326.85,-9195.07 3387.71,-9210.5 3432.29,-9218.65"/>
<polygon fill="black" stroke="black" points="3431.94,-9222.14 3442.4,-9220.43 3433.16,-9215.25 3431.94,-9222.14"/>
</g>
<!-- embed.embed_file -->
<g id="node73" class="node">
<title>embed.embed_file</title>
<g id="a_node73"><a xlink:title="Embed ``path`` and write the result beside it under ``EMBED_DIR``.">
<polygon fill="none" stroke="black" points="3603.18,-2671.5 3384.18,-2671.5 3384.18,-2452.5 3603.18,-2452.5 3603.18,-2671.5"/>
<text text-anchor="middle" x="3493.68" y="-2558.3" font-family="Times,serif" font-size="14.00">embed.embed_file</text>
</a>
</g>
</g>
<!-- embed.embed_file&#45;&gt;lot_io.read_lots -->
<g id="edge83" class="edge">
<title>embed.embed_file&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M3603.22,-2525.11C3673.9,-2501.08 3764.24,-2470.38 3826.73,-2449.14"/>
<polygon fill="black" stroke="black" points="3828.17,-2452.35 3836.51,-2445.81 3825.91,-2445.72 3828.17,-2452.35"/>
</g>
<!-- embed.embed_file&#45;&gt;notes_utils.write_json -->
<g id="edge85" class="edge">
<title>embed.embed_file&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M3603.42,-2553.46C3647.01,-2550.22 3697.71,-2546.66 3743.68,-2544 3883.23,-2535.91 4048.12,-2529.6 4129.14,-2526.72"/>
<polygon fill="black" stroke="black" points="4129.66,-2530.2 4139.53,-2526.35 4129.42,-2523.21 4129.66,-2530.2"/>
</g>
<!-- embed.embed_file&#45;&gt;lot_io.make_lot_id -->
<g id="edge84" class="edge">
<title>embed.embed_file&#45;&gt;lot_io.make_lot_id</title>
<path fill="none" stroke="black" d="M3603.22,-2572.43C3680.76,-2579.87 3781.97,-2589.6 3844.1,-2595.56"/>
<polygon fill="black" stroke="black" points="3843.81,-2599.05 3854.1,-2596.53 3844.48,-2592.08 3843.81,-2599.05"/>
</g>
<!-- embed.main -->
<g id="node74" class="node">
<title>embed.main</title>
<g id="a_node74"><a xlink:title="Embed the file given on the command line.">
<polygon fill="none" stroke="black" points="3089.18,-2696 2959.18,-2696 2959.18,-2566 3089.18,-2566 3089.18,-2696"/>
<text text-anchor="middle" x="3024.18" y="-2627.3" font-family="Times,serif" font-size="14.00">embed.main</text>
</a>
</g>
</g>
<!-- embed.main&#45;&gt;embed.embed_file -->
<g id="edge86" class="edge">
<title>embed.main&#45;&gt;embed.embed_file</title>
<path fill="none" stroke="black" d="M3089.21,-2621.55C3162.24,-2610.77 3283.23,-2592.91 3373.71,-2579.56"/>
<polygon fill="black" stroke="black" points="3374.37,-2583 3383.75,-2578.08 3373.35,-2576.07 3374.37,-2583"/>
</g>
<!-- post_io.get_contact -->
<g id="node75" class="node">
<title>post_io.get_contact</title>
<g id="a_node75"><a xlink:title="Return a contact identifier from ``meta`` or ``None`` when missing.">
<polygon fill="none" stroke="black" points="3541.18,-9557.5 3446.18,-9557.5 3446.18,-9462.5 3541.18,-9462.5 3541.18,-9557.5"/>
<text text-anchor="middle" x="3493.68" y="-9506.3" font-family="Times,serif" font-size="14.00">post_io.get_contact</text>
</a>
</g>
</g>
<!-- post_io.get_timestamp -->
<g id="node76" class="node">
<title>post_io.get_timestamp</title>
<g id="a_node76"><a xlink:title="Return ``meta[&#39;date&#39;]`` as a timezone&#45;aware ``datetime``.">
<polygon fill="none" stroke="black" points="3567.68,-9444 3419.68,-9444 3419.68,-9296 3567.68,-9296 3567.68,-9444"/>
<text text-anchor="middle" x="3493.68" y="-9366.3" font-family="Times,serif" font-size="14.00">post_io.get_timestamp</text>
</a>
</g>
</g>
<!-- post_io.write_post -->
<g id="node78" class="node">
<title>post_io.write_post</title>
<g id="a_node78"><a xlink:title="Write metadata and body as a Markdown post.">
<polygon fill="none" stroke="black" points="3112.18,-9315 2936.18,-9315 2936.18,-9139 3112.18,-9139 3112.18,-9315"/>
<text text-anchor="middle" x="3024.18" y="-9223.3" font-family="Times,serif" font-size="14.00">post_io.write_post</text>
</a>
</g>
</g>
<!-- post_io.write_post&#45;&gt;notes_utils.write_md -->
<g id="edge91" class="edge">
<title>post_io.write_post&#45;&gt;notes_utils.write_md</title>
<path fill="none" stroke="black" d="M3112.29,-9227C3205.52,-9227 3350.95,-9227 3432.33,-9227"/>
<polygon fill="black" stroke="black" points="3432.41,-9230.5 3442.41,-9227 3432.41,-9223.5 3432.41,-9230.5"/>
</g>
<!-- post_io.write_post&#45;&gt;post_io.get_contact -->
<g id="edge89" class="edge">
<title>post_io.write_post&#45;&gt;post_io.get_contact</title>
<path fill="none" stroke="black" d="M3112.34,-9248.85C3157.38,-9264.31 3209.84,-9289.5 3243.68,-9329 3281.02,-9372.58 3238.68,-9412.85 3279.68,-9453 3321.09,-9493.55 3388.02,-9506.07 3435.79,-9509.54"/>
<polygon fill="black" stroke="black" points="3435.79,-9513.04 3445.98,-9510.16 3436.22,-9506.05 3435.79,-9513.04"/>
</g>
<!-- post_io.write_post&#45;&gt;post_io.get_timestamp -->
<g id="edge90" class="edge">
<title>post_io.write_post&#45;&gt;post_io.get_timestamp</title>
<path fill="none" stroke="black" d="M3112.29,-9253.65C3197.42,-9279.68 3326.07,-9319.04 3409.74,-9344.63"/>
<polygon fill="black" stroke="black" points="3408.88,-9348.02 3419.46,-9347.6 3410.92,-9341.33 3408.88,-9348.02"/>
</g>
<!-- post_io.raw_post_path_from_lot -->
<g id="node79" class="node">
<title>post_io.raw_post_path_from_lot</title>
<g id="a_node79"><a xlink:title="Return raw post path referenced by ``lot`` or ``None``.">
<polygon fill="none" stroke="black" points="3537.68,-4793 3449.68,-4793 3449.68,-4705 3537.68,-4705 3537.68,-4793"/>
<text text-anchor="middle" x="3493.68" y="-4745.3" font-family="Times,serif" font-size="14.00">post_io.raw_post_path_from_lot</text>
</a>
</g>
</g>
<!-- post_io.raw_post_path_from_lot&#45;&gt;post_io.raw_post_path -->
<g id="edge92" class="edge">
<title>post_io.raw_post_path_from_lot&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M3537.97,-4753.92C3588.19,-4762.17 3669.03,-4783.86 3707.68,-4840 3766.26,-4925.09 3683.71,-5684.89 3743.68,-5769 3770.3,-5806.32 3823.19,-5820.81 3860.19,-5826.43"/>
<polygon fill="black" stroke="black" points="3859.79,-5829.91 3870.18,-5827.8 3860.74,-5822.97 3859.79,-5829.91"/>
</g>
<!-- log_utils._extract_tb_lineno -->
<g id="node80" class="node">
<title>log_utils._extract_tb_lineno</title>
<g id="a_node80"><a xlink:title="Return the last line number from a traceback.">
<polygon fill="none" stroke="black" points="3534.18,-2133.5 3453.18,-2133.5 3453.18,-2052.5 3534.18,-2052.5 3534.18,-2133.5"/>
<text text-anchor="middle" x="3493.68" y="-2089.3" font-family="Times,serif" font-size="14.00">log_utils._extract_tb_lineno</text>
</a>
</g>
</g>
<!-- log_utils._add_exc_line -->
<g id="node81" class="node">
<title>log_utils._add_exc_line</title>
<g id="a_node81"><a xlink:title="Attach ``line`` from traceback to structured log events.">
<polygon fill="none" stroke="black" points="3084.18,-2400 2964.18,-2400 2964.18,-2280 3084.18,-2280 3084.18,-2400"/>
<text text-anchor="middle" x="3024.18" y="-2336.3" font-family="Times,serif" font-size="14.00">log_utils._add_exc_line</text>
</a>
</g>
</g>
<!-- log_utils._add_exc_line&#45;&gt;log_utils._extract_tb_lineno -->
<g id="edge98" class="edge">
<title>log_utils._add_exc_line&#45;&gt;log_utils._extract_tb_lineno</title>
<path fill="none" stroke="black" d="M3084.23,-2336.49C3133.41,-2330.43 3201.93,-2314.19 3243.68,-2271 3285.06,-2228.21 3236.64,-2183.11 3279.68,-2142 3323.27,-2100.37 3394.77,-2091.54 3442.77,-2090.83"/>
<polygon fill="black" stroke="black" points="3442.94,-2094.33 3452.93,-2090.79 3442.92,-2087.33 3442.94,-2094.33"/>
</g>
<!-- log_utils.init_logger -->
<g id="node82" class="node">
<title>log_utils.init_logger</title>
<g id="a_node82"><a xlink:title="Initialize logger writing to ``LOGFILE``.&#10;&#10;``LOG_LEVEL`` may be set in ``config.py`` or via an environment&#10;variable. &#160;The level accepts ``DEBUG``, ``INFO`` or ``ERROR`` and&#10;defaults to ``INFO``. &#160;The function falls back to the standard&#10;``logging`` module if ``structlog`` isn&#39;t available so the scripts&#10;can still run in minimal environments.">
<polygon fill="none" stroke="black" points="3197.68,-2262.5 2850.68,-2262.5 2850.68,-1915.5 3197.68,-1915.5 3197.68,-2262.5"/>
<text text-anchor="middle" x="3024.18" y="-2085.3" font-family="Times,serif" font-size="14.00">log_utils.init_logger</text>
</a>
</g>
</g>
<!-- log_utils.init_logger&#45;&gt;log_utils._extract_tb_lineno -->
<g id="edge99" class="edge">
<title>log_utils.init_logger&#45;&gt;log_utils._extract_tb_lineno</title>
<path fill="none" stroke="black" d="M3197.93,-2090.48C3285.29,-2091.23 3384.86,-2092.08 3443.04,-2092.58"/>
<polygon fill="black" stroke="black" points="3443.03,-2096.08 3453.06,-2092.66 3443.09,-2089.08 3443.03,-2096.08"/>
</g>
<!-- log_utils.get_logger -->
<g id="node83" class="node">
<title>log_utils.get_logger</title>
<g id="a_node83"><a xlink:title="Return the singleton logger instance.">
<polygon fill="none" stroke="black" points="3525.18,-2034.5 3462.18,-2034.5 3462.18,-1971.5 3525.18,-1971.5 3525.18,-2034.5"/>
<text text-anchor="middle" x="3493.68" y="-1999.3" font-family="Times,serif" font-size="14.00">log_utils.get_logger</text>
</a>
</g>
</g>
<!-- log_utils.init_logger&#45;&gt;log_utils.get_logger -->
<g id="edge100" class="edge">
<title>log_utils.init_logger&#45;&gt;log_utils.get_logger</title>
<path fill="none" stroke="black" d="M3197.93,-2050.68C3290,-2033.1 3395.65,-2014.51 3452.09,-2006.46"/>
<polygon fill="black" stroke="black" points="3452.62,-2009.92 3462.04,-2005.08 3451.66,-2002.98 3452.62,-2009.92"/>
</g>
<!-- log_utils.get_logger&#45;&gt;log_utils.init_logger -->
<g id="edge101" class="edge">
<title>log_utils.get_logger&#45;&gt;log_utils.init_logger</title>
<path fill="none" stroke="black" d="M3462.04,-2012.19C3410.67,-2024.23 3303.4,-2044.98 3208.01,-2061.97"/>
<polygon fill="black" stroke="black" points="3207.17,-2058.57 3197.93,-2063.76 3208.39,-2065.46 3207.17,-2058.57"/>
</g>
<!-- log_utils.install_excepthook -->
<g id="node84" class="node">
<title>log_utils.install_excepthook</title>
<g id="a_node84"><a xlink:title="Redirect uncaught exceptions to ``logger.exception``.">
<polygon fill="none" stroke="black" points="3089.18,-2548 2959.18,-2548 2959.18,-2418 3089.18,-2418 3089.18,-2548"/>
<text text-anchor="middle" x="3024.18" y="-2479.3" font-family="Times,serif" font-size="14.00">log_utils.install_excepthook</text>
</a>
</g>
</g>
<!-- log_utils.install_excepthook&#45;&gt;log_utils._extract_tb_lineno -->
<g id="edge102" class="edge">
<title>log_utils.install_excepthook&#45;&gt;log_utils._extract_tb_lineno</title>
<path fill="none" stroke="black" d="M3089.42,-2478.96C3139.31,-2472.21 3206.12,-2454.59 3243.68,-2409 3319.82,-2316.58 3199,-2230.48 3279.68,-2142 3320.74,-2096.98 3394.1,-2089.16 3443.08,-2089.58"/>
<polygon fill="black" stroke="black" points="3443.07,-2093.08 3453.14,-2089.79 3443.21,-2086.08 3443.07,-2093.08"/>
</g>
<!-- debug_dump.parse_url -->
<g id="node88" class="node">
<title>debug_dump.parse_url</title>
<g id="a_node88"><a xlink:title="Return ``(lot_id, lang)`` extracted from ``url``.">
<polygon fill="none" stroke="black" points="3556.18,-8077.5 3431.18,-8077.5 3431.18,-7952.5 3556.18,-7952.5 3556.18,-8077.5"/>
<text text-anchor="middle" x="3493.68" y="-8011.3" font-family="Times,serif" font-size="14.00">debug_dump.parse_url</text>
</a>
</g>
</g>
<!-- debug_dump.guess_source_from_lot -->
<g id="node89" class="node">
<title>debug_dump.guess_source_from_lot</title>
<g id="a_node89"><a xlink:title="Guess ``(chat, message_id)`` directly from ``lot_id``.">
<polygon fill="none" stroke="black" points="3961.68,-8738 3841.68,-8738 3841.68,-8618 3961.68,-8618 3961.68,-8738"/>
<text text-anchor="middle" x="3901.68" y="-8674.3" font-family="Times,serif" font-size="14.00">debug_dump.guess_source_from_lot</text>
</a>
</g>
</g>
<!-- debug_dump.load_source_info -->
<g id="node90" class="node">
<title>debug_dump.load_source_info</title>
<g id="a_node90"><a xlink:title="Return ``(chat, message_id)`` for ``lot_id`` if available.">
<polygon fill="none" stroke="black" points="3576.18,-7478.5 3411.18,-7478.5 3411.18,-7313.5 3576.18,-7313.5 3576.18,-7478.5"/>
<text text-anchor="middle" x="3493.68" y="-7392.3" font-family="Times,serif" font-size="14.00">debug_dump.load_source_info</text>
</a>
</g>
</g>
<!-- debug_dump.load_source_info&#45;&gt;notes_utils.load_json -->
<g id="edge111" class="edge">
<title>debug_dump.load_source_info&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M3576.39,-7382.95C3623.17,-7370.87 3678.26,-7347.8 3707.68,-7304 3763.79,-7220.46 3677.1,-5568.45 3743.68,-5493 3837.59,-5386.59 3964.07,-5551.88 4059.68,-5447 4111.33,-5390.35 4089.13,-4834.38 4095.68,-4758 4115.62,-4525.56 4152.25,-4251.12 4169.59,-4126.55"/>
<polygon fill="black" stroke="black" points="4173.09,-4126.79 4171.01,-4116.4 4166.16,-4125.83 4173.09,-4126.79"/>
</g>
<!-- debug_dump.load_source_info&#45;&gt;lot_io.lot_json_path -->
<g id="edge110" class="edge">
<title>debug_dump.load_source_info&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M3576.35,-7365.83C3660.66,-7334.68 3789.08,-7287.23 3856.23,-7262.42"/>
<polygon fill="black" stroke="black" points="3857.51,-7265.68 3865.68,-7258.93 3855.09,-7259.11 3857.51,-7265.68"/>
</g>
<!-- debug_dump.run_tg_fetch -->
<g id="node91" class="node">
<title>debug_dump.run_tg_fetch</title>
<g id="a_node91"><a xlink:title="Run ``tg_client.py &#45;&#45;fetch`` and return combined logs.">
<polygon fill="none" stroke="black" points="4264.68,-8757.5 4095.68,-8757.5 4095.68,-8588.5 4264.68,-8588.5 4264.68,-8757.5"/>
<text text-anchor="middle" x="4180.18" y="-8669.3" font-family="Times,serif" font-size="14.00">debug_dump.run_tg_fetch</text>
</a>
</g>
</g>
<!-- debug_dump.run_tg_fetch&#45;&gt;notes_utils.read_text -->
<g id="edge112" class="edge">
<title>debug_dump.run_tg_fetch&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M4219.24,-8588.27C4236.51,-8545.61 4255.17,-8492.54 4264.68,-8443 4341.92,-8040.97 4383.19,-4977.43 4388.98,-4517.68"/>
<polygon fill="black" stroke="black" points="4392.48,-4517.66 4389.1,-4507.61 4385.48,-4517.57 4392.48,-4517.66"/>
</g>
<!-- debug_dump.collect_files -->
<g id="node92" class="node">
<title>debug_dump.collect_files</title>
<g id="a_node92"><a xlink:title="Return ``[(name, content), ...]`` for files related to ``lot_id``.">
<polygon fill="none" stroke="black" points="3589.18,-7687.5 3398.18,-7687.5 3398.18,-7496.5 3589.18,-7496.5 3589.18,-7687.5"/>
<text text-anchor="middle" x="3493.68" y="-7588.3" font-family="Times,serif" font-size="14.00">debug_dump.collect_files</text>
</a>
</g>
</g>
<!-- debug_dump.collect_files&#45;&gt;notes_utils.load_json -->
<g id="edge119" class="edge">
<title>debug_dump.collect_files&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M3589.26,-7569.76C3633.11,-7554.24 3681.28,-7528.6 3707.68,-7487 3765.93,-7395.24 3671.95,-5612.65 3743.68,-5531 3837.39,-5424.32 3964.32,-5589.2 4059.68,-5484 4086.8,-5454.08 4092.29,-4798.24 4095.68,-4758 4115.31,-4525.53 4152.09,-4251.11 4169.53,-4126.55"/>
<polygon fill="black" stroke="black" points="4173.03,-4126.79 4170.96,-4116.4 4166.1,-4125.82 4173.03,-4126.79"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;lot_io.lot_json_path -->
<g id="edge113" class="edge">
<title>debug_dump.collect_files&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M3589.19,-7557.75C3628.58,-7540.49 3673.1,-7516.82 3707.68,-7487 3728.97,-7468.64 3726.69,-7457.39 3743.68,-7435 3782.45,-7383.93 3829.82,-7327.68 3862.32,-7289.93"/>
<polygon fill="black" stroke="black" points="3865.14,-7292.02 3869.02,-7282.17 3859.84,-7287.45 3865.14,-7292.02"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;caption_io.caption_json_path -->
<g id="edge114" class="edge">
<title>debug_dump.collect_files&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M3589.4,-7572.45C3721.08,-7539.68 3955.06,-7459.89 4059.68,-7291 4150.36,-7144.62 4001.26,-6660.99 4095.68,-6517 4105.51,-6502.01 4122.51,-6492.32 4138.61,-6486.14"/>
<polygon fill="black" stroke="black" points="4140.15,-6489.31 4148.45,-6482.73 4137.86,-6482.7 4140.15,-6489.31"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;caption_io.has_caption -->
<g id="edge115" class="edge">
<title>debug_dump.collect_files&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M3589.36,-7625.35C3675.21,-7655.59 3797.62,-7698.7 3860.3,-7720.78"/>
<polygon fill="black" stroke="black" points="3859.24,-7724.11 3869.83,-7724.13 3861.56,-7717.51 3859.24,-7724.11"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;caption_io.read_caption -->
<g id="edge116" class="edge">
<title>debug_dump.collect_files&#45;&gt;caption_io.read_caption</title>
<path fill="none" stroke="black" d="M3589.34,-7569.81C3633.22,-7554.31 3681.38,-7528.66 3707.68,-7487 3787.02,-7361.32 3663.89,-4937.39 3743.68,-4812 3761.8,-4783.53 3793.89,-4765.44 3824.36,-4754.1"/>
<polygon fill="black" stroke="black" points="3825.91,-4757.26 3834.18,-4750.65 3823.59,-4750.66 3825.91,-4757.26"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;post_io.raw_post_path -->
<g id="edge117" class="edge">
<title>debug_dump.collect_files&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M3589.37,-7569.56C3633.12,-7554 3681.15,-7528.39 3707.68,-7487 3747.33,-7425.14 3726.74,-6236.49 3743.68,-6165 3770.51,-6051.82 3837.95,-5931.13 3875.11,-5870.19"/>
<polygon fill="black" stroke="black" points="3878.11,-5871.99 3880.37,-5861.64 3872.15,-5868.33 3878.11,-5871.99"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;notes_utils.read_text -->
<g id="edge118" class="edge">
<title>debug_dump.collect_files&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M3589.41,-7589.42C3714.13,-7580.87 3932.46,-7547.26 4059.68,-7420 4281.05,-7198.57 4210.19,-7054.33 4264.68,-6746 4343.73,-6298.77 4381.26,-4828.3 4388.4,-4517.87"/>
<polygon fill="black" stroke="black" points="4391.91,-4517.82 4388.64,-4507.74 4384.91,-4517.66 4391.91,-4517.82"/>
</g>
<!-- debug_dump.delete_files -->
<g id="node93" class="node">
<title>debug_dump.delete_files</title>
<g id="a_node93"><a xlink:title="Remove files related to ``lot_id`` from the filesystem.">
<polygon fill="none" stroke="black" points="3578.18,-7295.5 3409.18,-7295.5 3409.18,-7126.5 3578.18,-7126.5 3578.18,-7295.5"/>
<text text-anchor="middle" x="3493.68" y="-7207.3" font-family="Times,serif" font-size="14.00">debug_dump.delete_files</text>
</a>
</g>
</g>
<!-- debug_dump.delete_files&#45;&gt;notes_utils.load_json -->
<g id="edge124" class="edge">
<title>debug_dump.delete_files&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M3578.28,-7182.61C3625.11,-7161.97 3679.6,-7128.96 3707.68,-7080 3752.61,-7001.67 3683.65,-5522.45 3743.68,-5455 3837.96,-5349.08 3963.68,-5515.35 4059.68,-5411 4108.88,-5357.52 4089.37,-4830.39 4095.68,-4758 4115.95,-4525.59 4152.42,-4251.14 4169.66,-4126.56"/>
<polygon fill="black" stroke="black" points="4173.16,-4126.8 4171.07,-4116.41 4166.22,-4125.83 4173.16,-4126.8"/>
</g>
<!-- debug_dump.delete_files&#45;&gt;lot_io.lot_json_path -->
<g id="edge120" class="edge">
<title>debug_dump.delete_files&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M3578.31,-7218.21C3662.26,-7225.45 3788.46,-7236.33 3855.33,-7242.09"/>
<polygon fill="black" stroke="black" points="3855.28,-7245.6 3865.54,-7242.97 3855.88,-7238.62 3855.28,-7245.6"/>
</g>
<!-- debug_dump.delete_files&#45;&gt;caption_io.caption_json_path -->
<g id="edge121" class="edge">
<title>debug_dump.delete_files&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M3578.4,-7174.73C3626.13,-7155.16 3687.46,-7131.84 3743.68,-7116 3881.2,-7077.27 3964.79,-7163.81 4059.68,-7057 4139.56,-6967.09 4028.72,-6616.9 4095.68,-6517 4105.66,-6502.11 4122.68,-6492.43 4138.76,-6486.23"/>
<polygon fill="black" stroke="black" points="4140.28,-6489.41 4148.58,-6482.81 4137.98,-6482.8 4140.28,-6489.41"/>
</g>
<!-- debug_dump.delete_files&#45;&gt;caption_io.caption_md_path -->
<g id="edge122" class="edge">
<title>debug_dump.delete_files&#45;&gt;caption_io.caption_md_path</title>
<path fill="none" stroke="black" d="M3578.31,-7207.6C3717.86,-7200.24 3989.82,-7178.13 4059.68,-7116 4115.35,-7066.49 4157.26,-6842.05 4172.71,-6747.83"/>
<polygon fill="black" stroke="black" points="4176.19,-6748.23 4174.33,-6737.8 4169.28,-6747.11 4176.19,-6748.23"/>
</g>
<!-- debug_dump.delete_files&#45;&gt;post_io.raw_post_path -->
<g id="edge123" class="edge">
<title>debug_dump.delete_files&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M3578.24,-7182.32C3624.91,-7161.61 3679.24,-7128.62 3707.68,-7080 3759.06,-6992.18 3719.62,-6263.86 3743.68,-6165 3771.2,-6051.98 3838.35,-5931.22 3875.29,-5870.23"/>
<polygon fill="black" stroke="black" points="3878.29,-5872.03 3880.51,-5861.67 3872.32,-5868.39 3878.29,-5872.03"/>
</g>
<!-- debug_dump._message_reason -->
<g id="node94" class="node">
<title>debug_dump._message_reason</title>
<g id="a_node94"><a xlink:title="Return explanation why a message would be skipped.">
<polygon fill="none" stroke="black" points="3988.18,-8231.5 3815.18,-8231.5 3815.18,-8058.5 3988.18,-8058.5 3988.18,-8231.5"/>
<text text-anchor="middle" x="3901.68" y="-8141.3" font-family="Times,serif" font-size="14.00">debug_dump._message_reason</text>
</a>
</g>
</g>
<!-- debug_dump._message_reason&#45;&gt;moderation.should_skip_user -->
<g id="edge125" class="edge">
<title>debug_dump._message_reason&#45;&gt;moderation.should_skip_user</title>
<path fill="none" stroke="black" d="M3988.28,-8144.38C4034.57,-8144.05 4090.14,-8143.64 4129.35,-8143.36"/>
<polygon fill="black" stroke="black" points="4129.48,-8146.86 4139.45,-8143.29 4129.43,-8139.86 4129.48,-8146.86"/>
</g>
<!-- debug_dump._lot_reason -->
<g id="node95" class="node">
<title>debug_dump._lot_reason</title>
<g id="a_node95"><a xlink:title="Return explanation why ``lot`` would be skipped.">
<polygon fill="none" stroke="black" points="4240.18,-8322 4120.18,-8322 4120.18,-8202 4240.18,-8202 4240.18,-8322"/>
<text text-anchor="middle" x="4180.18" y="-8258.3" font-family="Times,serif" font-size="14.00">debug_dump._lot_reason</text>
</a>
</g>
</g>
<!-- debug_dump.moderation_summary -->
<g id="node96" class="node">
<title>debug_dump.moderation_summary</title>
<g id="a_node96"><a xlink:title="Return a multi&#45;line summary of moderation checks for ``lot_id``.">
<polygon fill="none" stroke="black" points="3619.68,-8348 3367.68,-8348 3367.68,-8096 3619.68,-8096 3619.68,-8348"/>
<text text-anchor="middle" x="3493.68" y="-8218.3" font-family="Times,serif" font-size="14.00">debug_dump.moderation_summary</text>
</a>
</g>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;notes_utils.load_json -->
<g id="edge129" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M3619.9,-8169.99C3654.46,-8149.19 3687.87,-8121.55 3707.68,-8086 3775.89,-7963.6 3650.61,-5668.75 3743.68,-5564 3837.79,-5458.09 3963.85,-5626.35 4059.68,-5522 4088.42,-5490.7 4092.16,-4800.35 4095.68,-4758 4115.02,-4525.51 4151.94,-4251.1 4169.48,-4126.54"/>
<polygon fill="black" stroke="black" points="4172.98,-4126.79 4170.91,-4116.4 4166.05,-4125.81 4172.98,-4126.79"/>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;lot_io.lot_json_path -->
<g id="edge126" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M3619.91,-8168C3653.82,-8147.29 3686.86,-8120.19 3707.68,-8086 3753.19,-8011.29 3725.08,-7779.48 3743.68,-7694 3776.7,-7542.33 3846.11,-7371.34 3880.5,-7291.55"/>
<polygon fill="black" stroke="black" points="3883.75,-7292.85 3884.51,-7282.28 3877.33,-7290.07 3883.75,-7292.85"/>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;post_io.read_post -->
<g id="edge127" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M3619.94,-8170.01C3654.51,-8149.21 3687.91,-8121.57 3707.68,-8086 3785.8,-7945.49 3685.66,-5381.09 3744.11,-5146.68"/>
<polygon fill="black" stroke="black" points="3747.48,-5147.65 3747.11,-5137.06 3740.79,-5145.56 3747.48,-5147.65"/>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;post_io.raw_post_path -->
<g id="edge128" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M3619.8,-8169.93C3654.36,-8149.13 3687.79,-8121.5 3707.68,-8086 3759.85,-7992.88 3719.5,-6268.97 3743.68,-6165 3770.03,-6051.71 3837.67,-5931.06 3874.99,-5870.16"/>
<polygon fill="black" stroke="black" points="3877.99,-5871.96 3880.27,-5861.62 3872.04,-5868.28 3877.99,-5871.96"/>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;debug_dump._message_reason -->
<g id="edge130" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;debug_dump._message_reason</title>
<path fill="none" stroke="black" d="M3619.81,-8198.27C3679.47,-8186.95 3749.71,-8173.63 3805.02,-8163.14"/>
<polygon fill="black" stroke="black" points="3806,-8166.52 3815.17,-8161.22 3804.69,-8159.64 3806,-8166.52"/>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;debug_dump._lot_reason -->
<g id="edge131" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;debug_dump._lot_reason</title>
<path fill="none" stroke="black" d="M3619.72,-8231.57C3659.35,-8234.46 3703.34,-8237.52 3743.68,-8240 3872.93,-8247.94 4023.88,-8255.09 4109.84,-8258.96"/>
<polygon fill="black" stroke="black" points="4109.84,-8262.47 4119.99,-8259.42 4110.16,-8255.47 4109.84,-8262.47"/>
</g>
<!-- debug_dump.main -->
<g id="node97" class="node">
<title>debug_dump.main</title>
<g id="a_node97"><a xlink:title="Collect log and data files related to a single lot.">
<polygon fill="none" stroke="black" points="3150.18,-8230 2898.18,-8230 2898.18,-7978 3150.18,-7978 3150.18,-8230"/>
<text text-anchor="middle" x="3024.18" y="-8100.3" font-family="Times,serif" font-size="14.00">debug_dump.main</text>
</a>
</g>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.parse_url -->
<g id="edge132" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.parse_url</title>
<path fill="none" stroke="black" d="M3150.46,-8080.15C3237.13,-8063.65 3349.36,-8042.29 3421.2,-8028.61"/>
<polygon fill="black" stroke="black" points="3421.9,-8032.04 3431.07,-8026.73 3420.59,-8025.16 3421.9,-8032.04"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.guess_source_from_lot -->
<g id="edge133" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.guess_source_from_lot</title>
<path fill="none" stroke="black" d="M3094.49,-8230.16C3141.65,-8320.04 3202.69,-8444.84 3243.68,-8560 3266.53,-8624.18 3226.15,-8666.86 3279.68,-8709 3363.5,-8774.98 3688.01,-8720.61 3831.63,-8692.39"/>
<polygon fill="black" stroke="black" points="3832.52,-8695.78 3841.65,-8690.4 3831.16,-8688.91 3832.52,-8695.78"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.load_source_info -->
<g id="edge134" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.load_source_info</title>
<path fill="none" stroke="black" d="M3150.22,-8053.6C3186.3,-8032.83 3221.8,-8005.01 3243.68,-7969 3299.45,-7877.2 3217.2,-7574.37 3279.68,-7487 3308.01,-7447.39 3357.19,-7424.89 3401.17,-7412.18"/>
<polygon fill="black" stroke="black" points="3402.33,-7415.49 3411.04,-7409.46 3400.47,-7408.74 3402.33,-7415.49"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.run_tg_fetch -->
<g id="edge135" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.run_tg_fetch</title>
<path fill="none" stroke="black" d="M3096.14,-8230.16C3143.9,-8319.78 3204.99,-8444.27 3243.68,-8560 3269.41,-8636.96 3217.35,-8687.05 3279.68,-8739 3346.26,-8794.49 3976.32,-8770.72 4059.68,-8747 4068.65,-8744.45 4077.61,-8741.01 4086.36,-8737"/>
<polygon fill="black" stroke="black" points="4087.91,-8740.14 4095.39,-8732.64 4084.86,-8733.84 4087.91,-8740.14"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.collect_files -->
<g id="edge136" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.collect_files</title>
<path fill="none" stroke="black" d="M3150.22,-8049.69C3185.08,-8029.05 3219.89,-8002.28 3243.68,-7969 3285.57,-7910.41 3245.29,-7874.28 3279.68,-7811 3307.46,-7759.89 3350.53,-7712.38 3390.69,-7674.76"/>
<polygon fill="black" stroke="black" points="3393.19,-7677.22 3398.15,-7667.85 3388.43,-7672.08 3393.19,-7677.22"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.delete_files -->
<g id="edge137" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.delete_files</title>
<path fill="none" stroke="black" d="M3150.37,-8054.03C3186.58,-8033.26 3222.12,-8005.33 3243.68,-7969 3319.23,-7841.74 3195.31,-7425.59 3279.68,-7304 3307.22,-7264.32 3355.57,-7241.41 3399.25,-7228.27"/>
<polygon fill="black" stroke="black" points="3400.42,-7231.58 3409.07,-7225.45 3398.49,-7224.85 3400.42,-7231.58"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.moderation_summary -->
<g id="edge138" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.moderation_summary</title>
<path fill="none" stroke="black" d="M3150.46,-8135.62C3214.39,-8151.76 3292.23,-8171.4 3357.51,-8187.88"/>
<polygon fill="black" stroke="black" points="3356.91,-8191.34 3367.46,-8190.39 3358.62,-8184.55 3356.91,-8191.34"/>
</g>
<!-- chop.process_message -->
<g id="node98" class="node">
<title>chop.process_message</title>
<g id="a_node98"><a xlink:title="Extract lots from ``msg_path`` and save them under ``LOTS_DIR``.">
<polygon fill="none" stroke="black" points="3243.68,-5484.5 2804.68,-5484.5 2804.68,-5045.5 3243.68,-5045.5 3243.68,-5484.5"/>
<text text-anchor="middle" x="3024.18" y="-5261.3" font-family="Times,serif" font-size="14.00">chop.process_message</text>
</a>
</g>
</g>
<!-- chop.process_message&#45;&gt;lot_io.valid_lots -->
<g id="edge139" class="edge">
<title>chop.process_message&#45;&gt;lot_io.valid_lots</title>
<path fill="none" stroke="black" d="M3243.88,-5262.66C3307.75,-5261.98 3373.13,-5261.28 3420.83,-5260.77"/>
<polygon fill="black" stroke="black" points="3421.07,-5264.27 3431.03,-5260.66 3421,-5257.27 3421.07,-5264.27"/>
</g>
<!-- chop.process_message&#45;&gt;lot_io.needs_cleanup -->
<g id="edge140" class="edge">
<title>chop.process_message&#45;&gt;lot_io.needs_cleanup</title>
<path fill="none" stroke="black" d="M3222.12,-5484.88C3230.44,-5500.24 3237.76,-5515.99 3243.68,-5532 3273.55,-5612.67 3218.15,-7019.88 3279.68,-7080 3313.7,-7113.23 3662.57,-7095.04 3707.68,-7080 3726.66,-7073.68 3725.77,-7061.9 3743.68,-7053 3777.82,-7036.03 3819.4,-7024.47 3851.2,-7017.32"/>
<polygon fill="black" stroke="black" points="3852.13,-7020.7 3861.16,-7015.16 3850.64,-7013.86 3852.13,-7020.7"/>
</g>
<!-- chop.process_message&#45;&gt;token_utils.estimate_tokens -->
<g id="edge141" class="edge">
<title>chop.process_message&#45;&gt;token_utils.estimate_tokens</title>
<path fill="none" stroke="black" d="M3243.94,-5194.4C3255.96,-5191.91 3267.92,-5189.74 3279.68,-5188 3490.25,-5156.84 3745.38,-5177.91 3851.1,-5189.17"/>
<polygon fill="black" stroke="black" points="3850.84,-5192.67 3861.16,-5190.27 3851.59,-5185.71 3850.84,-5192.67"/>
</g>
<!-- chop.process_message&#45;&gt;caption_io.has_caption -->
<g id="edge142" class="edge">
<title>chop.process_message&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M3222.25,-5484.83C3230.54,-5500.2 3237.81,-5515.97 3243.68,-5532 3264.37,-5588.45 3238.16,-7652.52 3279.68,-7696 3299.73,-7716.99 3723.84,-7730.22 3859.41,-7733.93"/>
<polygon fill="black" stroke="black" points="3859.68,-7737.44 3869.77,-7734.21 3859.87,-7730.44 3859.68,-7737.44"/>
</g>
<!-- chop.process_message&#45;&gt;caption_io.read_caption -->
<g id="edge143" class="edge">
<title>chop.process_message&#45;&gt;caption_io.read_caption</title>
<path fill="none" stroke="black" d="M3244,-5121.09C3255.92,-5114.71 3267.86,-5108.63 3279.68,-5103 3460.74,-5016.73 3571.93,-5107.64 3707.68,-4960 3753.5,-4910.17 3701.15,-4864.67 3743.68,-4812 3764.28,-4786.49 3795.54,-4768.96 3824.76,-4757.23"/>
<polygon fill="black" stroke="black" points="3826.08,-4760.47 3834.16,-4753.62 3823.57,-4753.94 3826.08,-4760.47"/>
</g>
<!-- chop.process_message&#45;&gt;moderation.should_skip_message -->
<g id="edge144" class="edge">
<title>chop.process_message&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M3243.88,-5322.54C3314.87,-5341.22 3387.73,-5360.39 3436.1,-5373.11"/>
<polygon fill="black" stroke="black" points="3435.48,-5376.57 3446.04,-5375.73 3437.26,-5369.8 3435.48,-5376.57"/>
</g>
<!-- chop.process_message&#45;&gt;post_io.read_post -->
<g id="edge147" class="edge">
<title>chop.process_message&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M3243.87,-5178.14C3255.9,-5174.46 3267.89,-5171.05 3279.68,-5168 3465.72,-5119.93 3528.1,-5175.33 3707.68,-5107 3716.61,-5103.6 3725.54,-5099.74 3734.39,-5095.51"/>
<polygon fill="black" stroke="black" points="3736.17,-5098.54 3743.6,-5090.99 3733.08,-5092.26 3736.17,-5098.54"/>
</g>
<!-- chop.process_message&#45;&gt;message_utils.build_prompt -->
<g id="edge145" class="edge">
<title>chop.process_message&#45;&gt;message_utils.build_prompt</title>
<path fill="none" stroke="black" d="M3203.57,-5045.2C3219.46,-5017.7 3233.39,-4989.01 3243.68,-4960 3265.94,-4897.27 3231.22,-4407.63 3279.68,-4362 3359.1,-4287.22 3700.45,-4346.78 3840.43,-4375.12"/>
<polygon fill="black" stroke="black" points="3840.06,-4378.62 3850.56,-4377.19 3841.46,-4371.76 3840.06,-4378.62"/>
</g>
<!-- chop.process_message&#45;&gt;embed.embed_file -->
<g id="edge146" class="edge">
<title>chop.process_message&#45;&gt;embed.embed_file</title>
<path fill="none" stroke="black" d="M3205.09,-5045.19C3220.63,-5017.74 3234.08,-4989.07 3243.68,-4960 3319.17,-4731.56 3190.76,-3018.55 3279.68,-2795 3300.37,-2742.98 3338.46,-2695.38 3376.77,-2656.96"/>
<polygon fill="black" stroke="black" points="3379.27,-2659.41 3383.92,-2649.89 3374.35,-2654.43 3379.27,-2659.41"/>
</g>
<!-- chop.main -->
<g id="node99" class="node">
<title>chop.main</title>
<g id="a_node99"><a xlink:title="Process a single message file passed on the command line.">
<polygon fill="none" stroke="black" points="2713.18,-5330 2583.18,-5330 2583.18,-5200 2713.18,-5200 2713.18,-5330"/>
<text text-anchor="middle" x="2648.18" y="-5261.3" font-family="Times,serif" font-size="14.00">chop.main</text>
</a>
</g>
</g>
<!-- chop.main&#45;&gt;chop.process_message -->
<g id="edge148" class="edge">
<title>chop.main&#45;&gt;chop.process_message</title>
<path fill="none" stroke="black" d="M2713.48,-5265C2736.93,-5265 2765,-5265 2794.52,-5265"/>
<polygon fill="black" stroke="black" points="2794.59,-5268.5 2804.59,-5265 2794.59,-5261.5 2794.59,-5268.5"/>
</g>
<!-- telegram_bot._t -->
<g id="node100" class="node">
<title>telegram_bot._t</title>
<g id="a_node100"><a xlink:title="Return ``text`` translated to ``lang`` using gettext files.">
<polygon fill="none" stroke="black" points="2710.68,-9514.5 2585.68,-9514.5 2585.68,-9389.5 2710.68,-9389.5 2710.68,-9514.5"/>
<text text-anchor="middle" x="2648.18" y="-9448.3" font-family="Times,serif" font-size="14.00">telegram_bot._t</text>
</a>
</g>
</g>
<!-- telegram_bot.ensure_profile -->
<g id="node101" class="node">
<title>telegram_bot.ensure_profile</title>
<g id="a_node101"><a xlink:title="Return profile for ``uid`` creating one if needed.">
<polygon fill="none" stroke="black" points="2699.18,-9635 2597.18,-9635 2597.18,-9533 2699.18,-9533 2699.18,-9635"/>
<text text-anchor="middle" x="2648.18" y="-9580.3" font-family="Times,serif" font-size="14.00">telegram_bot.ensure_profile</text>
</a>
</g>
</g>
<!-- telegram_bot.save_profiles -->
<g id="node102" class="node">
<title>telegram_bot.save_profiles</title>
<g id="a_node102"><a xlink:title="Write ``profiles`` to disk.">
<polygon fill="none" stroke="black" points="3060.18,-9443 2988.18,-9443 2988.18,-9371 3060.18,-9371 3060.18,-9443"/>
<text text-anchor="middle" x="3024.18" y="-9403.3" font-family="Times,serif" font-size="14.00">telegram_bot.save_profiles</text>
</a>
</g>
</g>
<!-- telegram_bot.ensure_profile&#45;&gt;telegram_bot.save_profiles -->
<g id="edge149" class="edge">
<title>telegram_bot.ensure_profile&#45;&gt;telegram_bot.save_profiles</title>
<path fill="none" stroke="black" d="M2699.23,-9560.31C2772.61,-9525.58 2908.27,-9461.38 2978.48,-9428.16"/>
<polygon fill="black" stroke="black" points="2980.4,-9431.12 2987.94,-9423.68 2977.41,-9424.79 2980.4,-9431.12"/>
</g>
<!-- telegram_bot.load_profiles -->
<g id="node103" class="node">
<title>telegram_bot.load_profiles</title>
<g id="a_node103"><a xlink:title="Populate the global ``profiles`` mapping.">
<polygon fill="none" stroke="black" points="2702.18,-3047 2594.18,-3047 2594.18,-2939 2702.18,-2939 2702.18,-3047"/>
<text text-anchor="middle" x="2648.18" y="-2989.3" font-family="Times,serif" font-size="14.00">telegram_bot.load_profiles</text>
</a>
</g>
</g>
<!-- telegram_bot.load_profiles&#45;&gt;notes_utils.read_text -->
<g id="edge150" class="edge">
<title>telegram_bot.load_profiles&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M2702.26,-2970.24C2809.11,-2925.79 3058.82,-2828.86 3279.68,-2795 3625.26,-2742.01 3760.62,-2715.91 4059.68,-2897 4172.35,-2965.22 4210,-2991.18 4264.68,-3111 4372.22,-3346.63 4387.24,-4175.27 4389.34,-4402.18"/>
<polygon fill="black" stroke="black" points="4385.84,-4402.24 4389.43,-4412.21 4392.84,-4402.18 4385.84,-4402.24"/>
</g>
<!-- telegram_bot.load_state -->
<g id="node104" class="node">
<title>telegram_bot.load_state</title>
<g id="a_node104"><a xlink:title="Populate ``processed_ids`` from ``STATE_PATH``.">
<polygon fill="none" stroke="black" points="4237.18,-3875 4123.18,-3875 4123.18,-3761 4237.18,-3761 4237.18,-3875"/>
<text text-anchor="middle" x="4180.18" y="-3814.3" font-family="Times,serif" font-size="14.00">telegram_bot.load_state</text>
</a>
</g>
</g>
<!-- telegram_bot.load_state&#45;&gt;notes_utils.read_text -->
<g id="edge151" class="edge">
<title>telegram_bot.load_state&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M4211.75,-3875.18C4228.9,-3908.82 4249.77,-3952.57 4264.68,-3993 4317.75,-4136.87 4358.74,-4313.26 4377.86,-4402.46"/>
<polygon fill="black" stroke="black" points="4374.47,-4403.33 4379.97,-4412.38 4381.31,-4401.87 4374.47,-4403.33"/>
</g>
<!-- telegram_bot.save_state -->
<g id="node105" class="node">
<title>telegram_bot.save_state</title>
<polygon fill="none" stroke="black" points="3055.68,-4560.5 2992.68,-4560.5 2992.68,-4497.5 3055.68,-4497.5 3055.68,-4560.5"/>
<text text-anchor="middle" x="3024.18" y="-4525.3" font-family="Times,serif" font-size="14.00">telegram_bot.save_state</text>
</g>
<!-- telegram_bot.scan_embeddings -->
<g id="node106" class="node">
<title>telegram_bot.scan_embeddings</title>
<g id="a_node106"><a xlink:title="Load new embeddings and return list of new lot ids.">
<polygon fill="none" stroke="black" points="3537.68,-3890 3449.68,-3890 3449.68,-3802 3537.68,-3802 3537.68,-3890"/>
<text text-anchor="middle" x="3493.68" y="-3842.3" font-family="Times,serif" font-size="14.00">telegram_bot.scan_embeddings</text>
</a>
</g>
</g>
<!-- telegram_bot.scan_embeddings&#45;&gt;similar_utils._load_embeddings -->
<g id="edge152" class="edge">
<title>telegram_bot.scan_embeddings&#45;&gt;similar_utils._load_embeddings</title>
<path fill="none" stroke="black" d="M3537.75,-3855.23C3602.43,-3869.09 3726.11,-3895.59 3810.96,-3913.77"/>
<polygon fill="black" stroke="black" points="3810.34,-3917.22 3820.85,-3915.89 3811.81,-3910.38 3810.34,-3917.22"/>
</g>
<!-- telegram_bot._should_suggest -->
<g id="node107" class="node">
<title>telegram_bot._should_suggest</title>
<polygon fill="none" stroke="black" points="3075.18,-4951 2973.18,-4951 2973.18,-4849 3075.18,-4849 3075.18,-4951"/>
<text text-anchor="middle" x="3024.18" y="-4896.3" font-family="Times,serif" font-size="14.00">telegram_bot._should_suggest</text>
</g>
<!-- telegram_bot._should_suggest&#45;&gt;similar_utils._cos_sim -->
<g id="edge153" class="edge">
<title>telegram_bot._should_suggest&#45;&gt;similar_utils._cos_sim</title>
<path fill="none" stroke="black" d="M3075.21,-4900C3161.83,-4900 3339.36,-4900 3432.54,-4900"/>
<polygon fill="black" stroke="black" points="3432.66,-4903.5 3442.66,-4900 3432.66,-4896.5 3432.66,-4903.5"/>
</g>
<!-- telegram_bot.enqueue_new_ids -->
<g id="node108" class="node">
<title>telegram_bot.enqueue_new_ids</title>
<polygon fill="none" stroke="black" points="2722.18,-5041 2574.18,-5041 2574.18,-4893 2722.18,-4893 2722.18,-5041"/>
<text text-anchor="middle" x="2648.18" y="-4963.3" font-family="Times,serif" font-size="14.00">telegram_bot.enqueue_new_ids</text>
</g>
<!-- telegram_bot.enqueue_new_ids&#45;&gt;telegram_bot.save_profiles -->
<g id="edge154" class="edge">
<title>telegram_bot.enqueue_new_ids&#45;&gt;telegram_bot.save_profiles</title>
<path fill="none" stroke="black" d="M2700.51,-5041.25C2726.39,-5083.17 2755.11,-5137.72 2768.68,-5191 2797.02,-5302.26 2739.08,-9229.78 2804.68,-9324 2843.73,-9380.08 2925.95,-9398.29 2977.65,-9404.19"/>
<polygon fill="black" stroke="black" points="2977.57,-9407.7 2987.88,-9405.25 2978.29,-9400.74 2977.57,-9407.7"/>
</g>
<!-- telegram_bot.enqueue_new_ids&#45;&gt;telegram_bot._should_suggest -->
<g id="edge155" class="edge">
<title>telegram_bot.enqueue_new_ids&#45;&gt;telegram_bot._should_suggest</title>
<path fill="none" stroke="black" d="M2722.63,-4953.84C2792.8,-4941.27 2897.3,-4922.55 2962.77,-4910.82"/>
<polygon fill="black" stroke="black" points="2963.71,-4914.21 2972.94,-4909 2962.48,-4907.32 2963.71,-4914.21"/>
</g>
<!-- telegram_bot._send_queue -->
<g id="node109" class="node">
<title>telegram_bot._send_queue</title>
<g id="a_node109"><a xlink:title="Send next lot from each user queue via ``app``.">
<polygon fill="none" stroke="black" points="2750.18,-4875 2546.18,-4875 2546.18,-4671 2750.18,-4671 2750.18,-4875"/>
<text text-anchor="middle" x="2648.18" y="-4769.3" font-family="Times,serif" font-size="14.00">telegram_bot._send_queue</text>
</a>
</g>
</g>
<!-- telegram_bot._send_queue&#45;&gt;lot_io.get_lot -->
<g id="edge156" class="edge">
<title>telegram_bot._send_queue&#45;&gt;lot_io.get_lot</title>
<path fill="none" stroke="black" d="M2750.38,-4676.75C2767.48,-4664.63 2785.83,-4653.78 2804.68,-4646 2895.3,-4608.62 3173.24,-4671.16 3243.68,-4603 3331.95,-4517.59 3200.31,-4422.73 3279.68,-4329 3317.12,-4284.79 3383.71,-4270.06 3432.49,-4265.45"/>
<polygon fill="black" stroke="black" points="3432.94,-4268.93 3442.61,-4264.62 3432.36,-4261.95 3432.94,-4268.93"/>
</g>
<!-- telegram_bot._send_queue&#45;&gt;telegram_bot.save_profiles -->
<g id="edge157" class="edge">
<title>telegram_bot._send_queue&#45;&gt;telegram_bot.save_profiles</title>
<path fill="none" stroke="black" d="M2750.3,-4853.55C2757.6,-4863.06 2763.94,-4873.25 2768.68,-4884 2818.43,-4996.86 2734.24,-9222.76 2804.68,-9324 2843.71,-9380.09 2925.94,-9398.3 2977.65,-9404.2"/>
<polygon fill="black" stroke="black" points="2977.57,-9407.71 2987.88,-9405.25 2978.29,-9400.75 2977.57,-9407.71"/>
</g>
<!-- telegram_bot.send_alert -->
<g id="node110" class="node">
<title>telegram_bot.send_alert</title>
<g id="a_node110"><a xlink:title="Broadcast ``text`` to all registered users.">
<polygon fill="none" stroke="black" points="2423.18,-3418 2293.18,-3418 2293.18,-3288 2423.18,-3288 2423.18,-3418"/>
<text text-anchor="middle" x="2358.18" y="-3349.3" font-family="Times,serif" font-size="14.00">telegram_bot.send_alert</text>
</a>
</g>
</g>
<!-- telegram_bot.send_alert&#45;&gt;telegram_bot.load_profiles -->
<g id="edge158" class="edge">
<title>telegram_bot.send_alert&#45;&gt;telegram_bot.load_profiles</title>
<path fill="none" stroke="black" d="M2383.39,-3287.8C2410.33,-3222.47 2459.26,-3122.34 2527.68,-3056 2543.96,-3040.21 2564.99,-3027.37 2584.86,-3017.49"/>
<polygon fill="black" stroke="black" points="2586.39,-3020.64 2593.89,-3013.16 2583.36,-3014.33 2586.39,-3020.64"/>
</g>
<!-- telegram_bot.start_cmd -->
<g id="node111" class="node">
<title>telegram_bot.start_cmd</title>
<g id="a_node111"><a xlink:title="Register the user and confirm startup.">
<polygon fill="none" stroke="black" points="2402.18,-9573 2314.18,-9573 2314.18,-9485 2402.18,-9485 2402.18,-9573"/>
<text text-anchor="middle" x="2358.18" y="-9525.3" font-family="Times,serif" font-size="14.00">telegram_bot.start_cmd</text>
</a>
</g>
</g>
<!-- telegram_bot.start_cmd&#45;&gt;telegram_bot._t -->
<g id="edge159" class="edge">
<title>telegram_bot.start_cmd&#45;&gt;telegram_bot._t</title>
<path fill="none" stroke="black" d="M2402.3,-9517.47C2448.09,-9505.23 2521.24,-9485.67 2575.69,-9471.12"/>
<polygon fill="black" stroke="black" points="2576.87,-9474.42 2585.62,-9468.46 2575.06,-9467.66 2576.87,-9474.42"/>
</g>
<!-- telegram_bot.start_cmd&#45;&gt;telegram_bot.ensure_profile -->
<g id="edge160" class="edge">
<title>telegram_bot.start_cmd&#45;&gt;telegram_bot.ensure_profile</title>
<path fill="none" stroke="black" d="M2402.3,-9537.23C2451.34,-9546.6 2531.76,-9561.96 2586.98,-9572.5"/>
<polygon fill="black" stroke="black" points="2586.5,-9575.97 2596.98,-9574.41 2587.82,-9569.1 2586.5,-9575.97"/>
</g>
<!-- telegram_bot.lang_cmd -->
<g id="node112" class="node">
<title>telegram_bot.lang_cmd</title>
<g id="a_node112"><a xlink:title="Set preferred language or list available choices.">
<polygon fill="none" stroke="black" points="2430.18,-9735 2286.18,-9735 2286.18,-9591 2430.18,-9591 2430.18,-9735"/>
<text text-anchor="middle" x="2358.18" y="-9659.3" font-family="Times,serif" font-size="14.00">telegram_bot.lang_cmd</text>
</a>
</g>
</g>
<!-- telegram_bot.lang_cmd&#45;&gt;telegram_bot._t -->
<g id="edge161" class="edge">
<title>telegram_bot.lang_cmd&#45;&gt;telegram_bot._t</title>
<path fill="none" stroke="black" d="M2430.29,-9627.79C2451.54,-9615.19 2473.89,-9599.67 2491.68,-9582 2513.21,-9560.62 2506.09,-9545.31 2527.68,-9524 2541.92,-9509.95 2559.42,-9497.47 2576.58,-9487.01"/>
<polygon fill="black" stroke="black" points="2578.68,-9489.83 2585.5,-9481.72 2575.12,-9483.81 2578.68,-9489.83"/>
</g>
<!-- telegram_bot.lang_cmd&#45;&gt;telegram_bot.ensure_profile -->
<g id="edge162" class="edge">
<title>telegram_bot.lang_cmd&#45;&gt;telegram_bot.ensure_profile</title>
<path fill="none" stroke="black" d="M2430.37,-9643.47C2478.64,-9630.23 2541.71,-9612.93 2587.37,-9600.41"/>
<polygon fill="black" stroke="black" points="2588.41,-9603.75 2597.13,-9597.73 2586.56,-9597 2588.41,-9603.75"/>
</g>
<!-- telegram_bot.lang_cmd&#45;&gt;telegram_bot.save_profiles -->
<g id="edge163" class="edge">
<title>telegram_bot.lang_cmd&#45;&gt;telegram_bot.save_profiles</title>
<path fill="none" stroke="black" d="M2430.51,-9674.06C2514.86,-9683.97 2657.81,-9690.63 2768.68,-9644 2865.76,-9603.18 2948.69,-9507.96 2991.7,-9451.43"/>
<polygon fill="black" stroke="black" points="2994.54,-9453.47 2997.75,-9443.38 2988.94,-9449.27 2994.54,-9453.47"/>
</g>
<!-- telegram_bot.vote_callback -->
<g id="node113" class="node">
<title>telegram_bot.vote_callback</title>
<g id="a_node113"><a xlink:title="Handle inline button presses for lot feedback.">
<polygon fill="none" stroke="black" points="2434.68,-9466.5 2281.68,-9466.5 2281.68,-9313.5 2434.68,-9313.5 2434.68,-9466.5"/>
<text text-anchor="middle" x="2358.18" y="-9386.3" font-family="Times,serif" font-size="14.00">telegram_bot.vote_callback</text>
</a>
</g>
</g>
<!-- telegram_bot.vote_callback&#45;&gt;telegram_bot._t -->
<g id="edge164" class="edge">
<title>telegram_bot.vote_callback&#45;&gt;telegram_bot._t</title>
<path fill="none" stroke="black" d="M2434.85,-9406.29C2478.45,-9415.68 2532.94,-9427.41 2575.79,-9436.63"/>
<polygon fill="black" stroke="black" points="2575.07,-9440.06 2585.59,-9438.74 2576.55,-9433.21 2575.07,-9440.06"/>
</g>
<!-- telegram_bot.vote_callback&#45;&gt;telegram_bot.ensure_profile -->
<g id="edge165" class="edge">
<title>telegram_bot.vote_callback&#45;&gt;telegram_bot.ensure_profile</title>
<path fill="none" stroke="black" d="M2434.76,-9432.55C2454.32,-9445.26 2474.65,-9460.09 2491.68,-9476 2511.17,-9494.21 2507.22,-9506.9 2527.68,-9524 2545.44,-9538.85 2567.5,-9551.23 2587.81,-9560.82"/>
<polygon fill="black" stroke="black" points="2586.45,-9564.05 2597,-9565.03 2589.37,-9557.68 2586.45,-9564.05"/>
</g>
<!-- telegram_bot.vote_callback&#45;&gt;telegram_bot.save_profiles -->
<g id="edge166" class="edge">
<title>telegram_bot.vote_callback&#45;&gt;telegram_bot.save_profiles</title>
<path fill="none" stroke="black" d="M2435.05,-9384.54C2464.02,-9382.71 2497.37,-9380.9 2527.68,-9380 2634.75,-9376.83 2661.72,-9374.34 2768.68,-9380 2842.16,-9383.89 2927.06,-9394.04 2977.87,-9400.73"/>
<polygon fill="black" stroke="black" points="2977.5,-9404.21 2987.87,-9402.06 2978.42,-9397.27 2977.5,-9404.21"/>
</g>
<!-- telegram_bot.main -->
<g id="node114" class="node">
<title>telegram_bot.main</title>
<g id="a_node114"><a xlink:title="Run the Telegram recommendation bot.">
<polygon fill="none" stroke="black" points="2442.68,-4006.5 2273.68,-4006.5 2273.68,-3837.5 2442.68,-3837.5 2442.68,-4006.5"/>
<text text-anchor="middle" x="2358.18" y="-3918.3" font-family="Times,serif" font-size="14.00">telegram_bot.main</text>
</a>
</g>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot.load_profiles -->
<g id="edge167" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot.load_profiles</title>
<path fill="none" stroke="black" d="M2442.83,-3863.33C2462.25,-3845.36 2480.49,-3823.93 2491.68,-3800 2561.81,-3650.06 2438.78,-3195.63 2527.68,-3056 2540.8,-3035.4 2563.02,-3021.14 2584.76,-3011.46"/>
<polygon fill="black" stroke="black" points="2586.14,-3014.68 2594.02,-3007.59 2583.44,-3008.22 2586.14,-3014.68"/>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot.load_state -->
<g id="edge168" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot.load_state</title>
<path fill="none" stroke="black" d="M2442.98,-3862.91C2462.26,-3845.01 2480.41,-3823.72 2491.68,-3800 2519.93,-3740.58 2481.17,-3255.53 2527.68,-3209 2601.23,-3135.42 3176.4,-3130.37 3243.68,-3192 3311.13,-3253.78 3212.24,-3540.22 3279.68,-3602 3355.72,-3671.65 3640.61,-3602.86 3743.68,-3600 3884.07,-3596.1 3938.84,-3528.43 4059.68,-3600 4114.46,-3632.44 4145.78,-3699.86 4162.5,-3751.19"/>
<polygon fill="black" stroke="black" points="4159.21,-3752.41 4165.55,-3760.9 4165.89,-3750.31 4159.21,-3752.41"/>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot.save_state -->
<g id="edge169" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot.save_state</title>
<path fill="none" stroke="black" d="M2398.49,-4006.56C2463.15,-4135.03 2604.99,-4376.23 2804.68,-4488 2860.77,-4519.39 2936.34,-4527.29 2982.32,-4528.98"/>
<polygon fill="black" stroke="black" points="2982.41,-4532.48 2992.5,-4529.27 2982.61,-4525.49 2982.41,-4532.48"/>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot.scan_embeddings -->
<g id="edge170" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot.scan_embeddings</title>
<path fill="none" stroke="black" d="M2442.82,-3925.84C2600.28,-3931.83 2951.21,-3939.23 3243.68,-3903 3312.24,-3894.51 3389.55,-3875.25 3439.59,-3861.47"/>
<polygon fill="black" stroke="black" points="3440.83,-3864.75 3449.53,-3858.7 3438.96,-3858.01 3440.83,-3864.75"/>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot.enqueue_new_ids -->
<g id="edge171" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot.enqueue_new_ids</title>
<path fill="none" stroke="black" d="M2365.66,-4006.53C2382.79,-4213.27 2434.51,-4738.17 2527.68,-4884 2537.44,-4899.27 2551.1,-4912.49 2565.73,-4923.62"/>
<polygon fill="black" stroke="black" points="2563.79,-4926.54 2573.93,-4929.59 2567.9,-4920.88 2563.79,-4926.54"/>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot._send_queue -->
<g id="edge172" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot._send_queue</title>
<path fill="none" stroke="black" d="M2362.41,-4006.62C2371.25,-4150.5 2404.27,-4447.98 2527.68,-4662 2531.28,-4668.24 2535.34,-4674.34 2539.74,-4680.25"/>
<polygon fill="black" stroke="black" points="2537.04,-4682.47 2545.94,-4688.21 2542.56,-4678.17 2537.04,-4682.47"/>
</g>
<!-- scan_ontology.collect_ontology -->
<g id="node115" class="node">
<title>scan_ontology.collect_ontology</title>
<g id="a_node115"><a xlink:title="Return counts per field, value counters, misparsed lots and broken metadata.">
<polygon fill="none" stroke="black" points="3172.68,-3749.5 2875.68,-3749.5 2875.68,-3452.5 3172.68,-3452.5 3172.68,-3749.5"/>
<text text-anchor="middle" x="3024.18" y="-3597.3" font-family="Times,serif" font-size="14.00">scan_ontology.collect_ontology</text>
</a>
</g>
</g>
<!-- scan_ontology.collect_ontology&#45;&gt;lot_io.read_lots -->
<g id="edge173" class="edge">
<title>scan_ontology.collect_ontology&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M3172.75,-3475.12C3201.3,-3442.96 3227.37,-3406.27 3243.68,-3367 3286.12,-3264.83 3200.06,-2448.8 3279.68,-2372 3348.14,-2305.97 3613.39,-2359.52 3707.68,-2372 3747.62,-2377.29 3791.02,-2388.47 3826.54,-2399.12"/>
<polygon fill="black" stroke="black" points="3825.75,-2402.54 3836.33,-2402.1 3827.79,-2395.84 3825.75,-2402.54"/>
</g>
<!-- scan_ontology.collect_ontology&#45;&gt;post_io.read_post -->
<g id="edge176" class="edge">
<title>scan_ontology.collect_ontology&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M3172.89,-3703.86C3201.14,-3730.78 3227.06,-3762.16 3243.68,-3797 3277.6,-3868.09 3225.44,-4447.88 3279.68,-4505 3345.52,-4574.33 3638.95,-4482.54 3707.68,-4549 3790.18,-4628.77 3698.18,-4701.45 3743.94,-4811.47"/>
<polygon fill="black" stroke="black" points="3740.85,-4813.14 3748.13,-4820.83 3747.24,-4810.28 3740.85,-4813.14"/>
</g>
<!-- scan_ontology.collect_ontology&#45;&gt;post_io.raw_post_path -->
<g id="edge177" class="edge">
<title>scan_ontology.collect_ontology&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M3172.95,-3703.83C3201.2,-3730.75 3227.1,-3762.14 3243.68,-3797 3279.23,-3871.74 3223.25,-4480.46 3279.68,-4541 3410.3,-4681.13 3578.31,-4450.71 3707.68,-4592 3796.04,-4688.5 3668.15,-5662.16 3743.68,-5769 3770.15,-5806.43 3823.07,-5820.89 3860.13,-5826.48"/>
<polygon fill="black" stroke="black" points="3859.74,-5829.96 3870.12,-5827.83 3860.68,-5823.02 3859.74,-5829.96"/>
</g>
<!-- scan_ontology.collect_ontology&#45;&gt;moderation.is_misparsed -->
<g id="edge174" class="edge">
<title>scan_ontology.collect_ontology&#45;&gt;moderation.is_misparsed</title>
<path fill="none" stroke="black" d="M3172.79,-3475.13C3201.34,-3442.98 3227.4,-3406.28 3243.68,-3367 3287.66,-3260.91 3216.05,-2429.61 3279.68,-2334 3306.84,-2293.2 3355.57,-2269.09 3399.58,-2255.01"/>
<polygon fill="black" stroke="black" points="3400.64,-2258.35 3409.18,-2252.07 3398.59,-2251.65 3400.64,-2258.35"/>
</g>
<!-- scan_ontology.collect_ontology&#45;&gt;message_utils.gather_chop_input -->
<g id="edge175" class="edge">
<title>scan_ontology.collect_ontology&#45;&gt;message_utils.gather_chop_input</title>
<path fill="none" stroke="black" d="M3172.72,-3704.34C3200.89,-3731.19 3226.81,-3762.42 3243.68,-3797 3295.15,-3902.5 3215.24,-4225.89 3279.68,-4324 3311.75,-4372.82 3372.66,-4401.17 3421.16,-4416.82"/>
<polygon fill="black" stroke="black" points="3420.41,-4420.25 3431,-4419.88 3422.49,-4413.57 3420.41,-4420.25"/>
</g>
<!-- scan_ontology.main -->
<g id="node116" class="node">
<title>scan_ontology.main</title>
<polygon fill="none" stroke="black" points="2762.18,-2596 2534.18,-2596 2534.18,-2368 2762.18,-2368 2762.18,-2596"/>
<text text-anchor="middle" x="2648.18" y="-2478.3" font-family="Times,serif" font-size="14.00">scan_ontology.main</text>
</g>
<!-- scan_ontology.main&#45;&gt;notes_utils.write_json -->
<g id="edge178" class="edge">
<title>scan_ontology.main&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M2661.01,-2367.91C2680.7,-2202.09 2726.02,-1906.72 2804.68,-1838 2878.54,-1773.48 3149.21,-1819.31 3243.68,-1793 3260.73,-1788.25 3262.42,-1779.87 3279.68,-1776 3465.3,-1734.38 3525.59,-1721 3707.68,-1776 3887.52,-1830.32 3952.67,-1855.6 4059.68,-2010 4160.83,-2155.94 4177.35,-2375.4 4179.38,-2473.93"/>
<polygon fill="black" stroke="black" points="4175.89,-2474.26 4179.55,-2484.21 4182.89,-2474.15 4175.89,-2474.26"/>
</g>
<!-- scan_ontology.main&#45;&gt;log_utils.install_excepthook -->
<g id="edge179" class="edge">
<title>scan_ontology.main&#45;&gt;log_utils.install_excepthook</title>
<path fill="none" stroke="black" d="M2762.41,-2482.3C2822.9,-2482.46 2895.66,-2482.66 2948.94,-2482.8"/>
<polygon fill="black" stroke="black" points="2948.98,-2486.3 2958.99,-2482.83 2948.99,-2479.3 2948.98,-2486.3"/>
</g>
<!-- scan_ontology.main&#45;&gt;scan_ontology.collect_ontology -->
<g id="edge180" class="edge">
<title>scan_ontology.main&#45;&gt;scan_ontology.collect_ontology</title>
<path fill="none" stroke="black" d="M2762.34,-2592.09C2764.66,-2596.32 2766.79,-2600.63 2768.68,-2605 2836.11,-2760.53 2738.8,-3210.81 2804.68,-3367 2819.87,-3403 2843.19,-3436.87 2869.03,-3467.07"/>
<polygon fill="black" stroke="black" points="2866.44,-3469.43 2875.65,-3474.67 2871.72,-3464.83 2866.44,-3469.43"/>
</g>
<!-- tg_client._mark_activity -->
<g id="node117" class="node">
<title>tg_client._mark_activity</title>
<g id="a_node117"><a xlink:title="Update ``_last_event`` to the current time.">
<polygon fill="none" stroke="black" points="2394.18,-9295 2322.18,-9295 2322.18,-9223 2394.18,-9223 2394.18,-9295"/>
<text text-anchor="middle" x="2358.18" y="-9255.3" font-family="Times,serif" font-size="14.00">tg_client._mark_activity</text>
</a>
</g>
</g>
<!-- tg_client._heartbeat -->
<g id="node118" class="node">
<title>tg_client._heartbeat</title>
<g id="a_node118"><a xlink:title="Periodically log a heartbeat and warn if idle for too long.">
<polygon fill="none" stroke="black" points="865.18,-7567 757.18,-7567 757.18,-7459 865.18,-7459 865.18,-7567"/>
<text text-anchor="middle" x="811.18" y="-7509.3" font-family="Times,serif" font-size="14.00">tg_client._heartbeat</text>
</a>
</g>
</g>
<!-- tg_client._progress_logger -->
<g id="node119" class="node">
<title>tg_client._progress_logger</title>
<g id="a_node119"><a xlink:title="Return a progress callback that logs received bytes.">
<polygon fill="none" stroke="black" points="2425.68,-9009.5 2290.68,-9009.5 2290.68,-8874.5 2425.68,-8874.5 2425.68,-9009.5"/>
<text text-anchor="middle" x="2358.18" y="-8938.3" font-family="Times,serif" font-size="14.00">tg_client._progress_logger</text>
</a>
</g>
</g>
<!-- tg_client._write_md -->
<g id="node120" class="node">
<title>tg_client._write_md</title>
<g id="a_node120"><a xlink:title="Helper to store a raw post in Markdown format.">
<polygon fill="none" stroke="black" points="2679.68,-9231.5 2616.68,-9231.5 2616.68,-9168.5 2679.68,-9168.5 2679.68,-9231.5"/>
<text text-anchor="middle" x="2648.18" y="-9196.3" font-family="Times,serif" font-size="14.00">tg_client._write_md</text>
</a>
</g>
</g>
<!-- tg_client._write_md&#45;&gt;post_io.write_post -->
<g id="edge181" class="edge">
<title>tg_client._write_md&#45;&gt;post_io.write_post</title>
<path fill="none" stroke="black" d="M2679.79,-9202.21C2732.91,-9206.04 2844.29,-9214.09 2925.85,-9219.97"/>
<polygon fill="black" stroke="black" points="2925.92,-9223.49 2936.15,-9220.72 2926.43,-9216.51 2925.92,-9223.49"/>
</g>
<!-- tg_client._scan_group_cache -->
<g id="node121" class="node">
<title>tg_client._scan_group_cache</title>
<g id="a_node121"><a xlink:title="Build group_id &#45;&gt; Path mapping for ``chat`` quickly.">
<polygon fill="none" stroke="black" points="3576.18,-6061.5 3411.18,-6061.5 3411.18,-5896.5 3576.18,-5896.5 3576.18,-6061.5"/>
<text text-anchor="middle" x="3493.68" y="-5975.3" font-family="Times,serif" font-size="14.00">tg_client._scan_group_cache</text>
</a>
</g>
</g>
<!-- tg_client._scan_group_cache&#45;&gt;post_io.raw_post_path -->
<g id="edge182" class="edge">
<title>tg_client._scan_group_cache&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M3576.35,-5949.03C3662.47,-5917.42 3794.61,-5868.93 3860.47,-5844.76"/>
<polygon fill="black" stroke="black" points="3861.89,-5847.96 3870.07,-5841.23 3859.48,-5841.39 3861.89,-5847.96"/>
</g>
<!-- tg_client._find_group_path -->
<g id="node122" class="node">
<title>tg_client._find_group_path</title>
<g id="a_node122"><a xlink:title="Return stored message path for ``group_id`` if known.">
<polygon fill="none" stroke="black" points="3071.68,-6384.5 2976.68,-6384.5 2976.68,-6289.5 3071.68,-6289.5 3071.68,-6384.5"/>
<text text-anchor="middle" x="3024.18" y="-6333.3" font-family="Times,serif" font-size="14.00">tg_client._find_group_path</text>
</a>
</g>
</g>
<!-- tg_client._find_group_path&#45;&gt;tg_client._scan_group_cache -->
<g id="edge183" class="edge">
<title>tg_client._find_group_path&#45;&gt;tg_client._scan_group_cache</title>
<path fill="none" stroke="black" d="M3072.04,-6328.42C3122.26,-6316.69 3200.56,-6290.66 3243.68,-6237 3291.25,-6177.82 3231.37,-6128.57 3279.68,-6070 3310.19,-6033.01 3358.49,-6010.74 3401.38,-5997.5"/>
<polygon fill="black" stroke="black" points="3402.42,-6000.84 3411.01,-5994.64 3400.43,-5994.13 3402.42,-6000.84"/>
</g>
<!-- tg_client._get_message_path -->
<g id="node123" class="node">
<title>tg_client._get_message_path</title>
<g id="a_node123"><a xlink:title="Return path of stored message ``msg_id`` in ``chat`` if any.">
<polygon fill="none" stroke="black" points="1613.68,-6095.5 1532.68,-6095.5 1532.68,-6014.5 1613.68,-6014.5 1613.68,-6095.5"/>
<text text-anchor="middle" x="1573.18" y="-6051.3" font-family="Times,serif" font-size="14.00">tg_client._get_message_path</text>
</a>
</g>
</g>
<!-- tg_client._get_message_path&#45;&gt;post_io.raw_post_path -->
<g id="edge184" class="edge">
<title>tg_client._get_message_path&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M1613.69,-6056.29C1728.5,-6059.93 2072,-6070 2357.18,-6070 2357.18,-6070 2357.18,-6070 2649.18,-6070 2781.4,-6070 3144.98,-6133.97 3243.68,-6046 3320.93,-5977.16 3201.07,-5883.27 3279.68,-5816 3366.65,-5741.58 3736.4,-5800.21 3860.15,-5822.4"/>
<polygon fill="black" stroke="black" points="3859.52,-5825.85 3869.99,-5824.19 3860.77,-5818.96 3859.52,-5825.85"/>
</g>
<!-- tg_client._should_skip_media -->
<g id="node124" class="node">
<title>tg_client._should_skip_media</title>
<g id="a_node124"><a xlink:title="Return reason string if ``msg`` media should be skipped.">
<polygon fill="none" stroke="black" points="2440.68,-8817.5 2275.68,-8817.5 2275.68,-8652.5 2440.68,-8652.5 2440.68,-8817.5"/>
<text text-anchor="middle" x="2358.18" y="-8731.3" font-family="Times,serif" font-size="14.00">tg_client._should_skip_media</text>
</a>
</g>
</g>
<!-- tg_client._allowed_topic -->
<g id="node125" class="node">
<title>tg_client._allowed_topic</title>
<g id="a_node125"><a xlink:title="Return ``True`` if ``msg`` belongs to an allowed forum topic.">
<polygon fill="none" stroke="black" points="2734.68,-8932.5 2561.68,-8932.5 2561.68,-8759.5 2734.68,-8759.5 2734.68,-8932.5"/>
<text text-anchor="middle" x="2648.18" y="-8842.3" font-family="Times,serif" font-size="14.00">tg_client._allowed_topic</text>
</a>
</g>
</g>
<!-- tg_client._extract_author -->
<g id="node126" class="node">
<title>tg_client._extract_author</title>
<g id="a_node126"><a xlink:title="Return a metadata dictionary describing the message author.">
<polygon fill="none" stroke="black" points="3168.18,-9021 2880.18,-9021 2880.18,-8733 3168.18,-8733 3168.18,-9021"/>
<text text-anchor="middle" x="3024.18" y="-8873.3" font-family="Times,serif" font-size="14.00">tg_client._extract_author</text>
</a>
</g>
</g>
<!-- tg_client._extract_author&#45;&gt;phone_utils.format_georgian -->
<g id="edge185" class="edge">
<title>tg_client._extract_author&#45;&gt;phone_utils.format_georgian</title>
<path fill="none" stroke="black" d="M3168.49,-8951.24C3204.5,-8969.14 3243.26,-8987.77 3279.68,-9004 3323.55,-9023.55 3373.45,-9043.36 3413.92,-9058.82"/>
<polygon fill="black" stroke="black" points="3412.87,-9062.17 3423.46,-9062.46 3415.36,-9055.63 3412.87,-9062.17"/>
</g>
<!-- tg_client._schedule_caption -->
<g id="node127" class="node">
<title>tg_client._schedule_caption</title>
<g id="a_node127"><a xlink:title="Run captioning in a separate process so downloads continue.">
<polygon fill="none" stroke="black" points="3541.18,-6876.5 3446.18,-6876.5 3446.18,-6781.5 3541.18,-6781.5 3541.18,-6876.5"/>
<text text-anchor="middle" x="3493.68" y="-6825.3" font-family="Times,serif" font-size="14.00">tg_client._schedule_caption</text>
</a>
</g>
</g>
<!-- tg_client._schedule_chop -->
<g id="node128" class="node">
<title>tg_client._schedule_chop</title>
<g id="a_node128"><a xlink:title="Run lot extraction in a separate process.">
<polygon fill="none" stroke="black" points="3958.68,-7934 3844.68,-7934 3844.68,-7820 3958.68,-7820 3958.68,-7934"/>
<text text-anchor="middle" x="3901.68" y="-7873.3" font-family="Times,serif" font-size="14.00">tg_client._schedule_chop</text>
</a>
</g>
</g>
<!-- tg_client._enqueue_chop -->
<g id="node129" class="node">
<title>tg_client._enqueue_chop</title>
<g id="a_node129"><a xlink:title="Queue ``path`` for chopping once captions are available.">
<polygon fill="none" stroke="black" points="2455.18,-8334 2261.18,-8334 2261.18,-8140 2455.18,-8140 2455.18,-8334"/>
<text text-anchor="middle" x="2358.18" y="-8233.3" font-family="Times,serif" font-size="14.00">tg_client._enqueue_chop</text>
</a>
</g>
</g>
<!-- tg_client._enqueue_chop&#45;&gt;caption_io.has_caption -->
<g id="edge186" class="edge">
<title>tg_client._enqueue_chop&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M2455.38,-8253.7C2748.57,-8303.48 3616.59,-8442.29 3707.68,-8357 3796.45,-8273.89 3675.74,-7911.84 3743.68,-7811 3770.21,-7771.63 3823.12,-7751.98 3860.15,-7742.66"/>
<polygon fill="black" stroke="black" points="3861.22,-7746 3870.14,-7740.3 3859.61,-7739.19 3861.22,-7746"/>
</g>
<!-- tg_client._enqueue_chop&#45;&gt;moderation.should_skip_message -->
<g id="edge187" class="edge">
<title>tg_client._enqueue_chop&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M2358.63,-8139.95C2356.92,-7686.71 2359.92,-5791.99 2527.68,-5595 2609.54,-5498.88 2679.96,-5551.63 2804.68,-5532 2901.43,-5516.77 3159.25,-5542.63 3243.68,-5493 3268.23,-5478.57 3256.29,-5456.24 3279.68,-5440 3326.05,-5407.81 3390.17,-5395.47 3435.91,-5390.78"/>
<polygon fill="black" stroke="black" points="3436.33,-5394.25 3445.96,-5389.84 3435.68,-5387.28 3436.33,-5394.25"/>
</g>
<!-- tg_client._start_chop_worker -->
<g id="node130" class="node">
<title>tg_client._start_chop_worker</title>
<g id="a_node130"><a xlink:title="Ensure the chop queue worker task is running.">
<polygon fill="none" stroke="black" points="2692.18,-8010 2604.18,-8010 2604.18,-7922 2692.18,-7922 2692.18,-8010"/>
<text text-anchor="middle" x="2648.18" y="-7962.3" font-family="Times,serif" font-size="14.00">tg_client._start_chop_worker</text>
</a>
</g>
</g>
<!-- tg_client._enqueue_chop&#45;&gt;tg_client._start_chop_worker -->
<g id="edge188" class="edge">
<title>tg_client._enqueue_chop&#45;&gt;tg_client._start_chop_worker</title>
<path fill="none" stroke="black" d="M2455.24,-8145.44C2478.88,-8123 2504.16,-8099.09 2527.68,-8077 2550.21,-8055.85 2575.25,-8032.55 2596.56,-8012.79"/>
<polygon fill="black" stroke="black" points="2598.98,-8015.33 2603.93,-8005.96 2594.22,-8010.19 2598.98,-8015.33"/>
</g>
<!-- tg_client._chop_worker -->
<g id="node131" class="node">
<title>tg_client._chop_worker</title>
<g id="a_node131"><a xlink:title="Background task processing ``_CHOP_QUEUE``.">
<polygon fill="none" stroke="black" points="3075.18,-7960 2973.18,-7960 2973.18,-7858 3075.18,-7858 3075.18,-7960"/>
<text text-anchor="middle" x="3024.18" y="-7905.3" font-family="Times,serif" font-size="14.00">tg_client._chop_worker</text>
</a>
</g>
</g>
<!-- tg_client._start_chop_worker&#45;&gt;tg_client._chop_worker -->
<g id="edge189" class="edge">
<title>tg_client._start_chop_worker&#45;&gt;tg_client._chop_worker</title>
<path fill="none" stroke="black" d="M2692.45,-7959.41C2759.02,-7949.26 2886.79,-7929.79 2962.55,-7918.24"/>
<polygon fill="black" stroke="black" points="2963.53,-7921.63 2972.88,-7916.67 2962.47,-7914.71 2963.53,-7921.63"/>
</g>
<!-- tg_client._process_chop_queue -->
<g id="node132" class="node">
<title>tg_client._process_chop_queue</title>
<g id="a_node132"><a xlink:title="Check queued posts and chop cooled down ones.">
<polygon fill="none" stroke="black" points="3550.68,-7934 3436.68,-7934 3436.68,-7820 3550.68,-7820 3550.68,-7934"/>
<text text-anchor="middle" x="3493.68" y="-7873.3" font-family="Times,serif" font-size="14.00">tg_client._process_chop_queue</text>
</a>
</g>
</g>
<!-- tg_client._chop_worker&#45;&gt;tg_client._process_chop_queue -->
<g id="edge192" class="edge">
<title>tg_client._chop_worker&#45;&gt;tg_client._process_chop_queue</title>
<path fill="none" stroke="black" d="M3075.21,-7905.58C3159.99,-7899.77 3331.84,-7888.01 3426.48,-7881.53"/>
<polygon fill="black" stroke="black" points="3426.77,-7885.02 3436.51,-7880.85 3426.29,-7878.04 3426.77,-7885.02"/>
</g>
<!-- tg_client._process_chop_queue&#45;&gt;caption_io.has_caption -->
<g id="edge190" class="edge">
<title>tg_client._process_chop_queue&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M3550.9,-7858.78C3593.94,-7844.71 3654.71,-7824.57 3707.68,-7806 3760.8,-7787.38 3821.68,-7764.77 3860.63,-7750.14"/>
<polygon fill="black" stroke="black" points="3861.91,-7753.4 3870.04,-7746.61 3859.44,-7746.85 3861.91,-7753.4"/>
</g>
<!-- tg_client._process_chop_queue&#45;&gt;tg_client._schedule_chop -->
<g id="edge191" class="edge">
<title>tg_client._process_chop_queue&#45;&gt;tg_client._schedule_chop</title>
<path fill="none" stroke="black" d="M3550.71,-7877C3624.82,-7877 3755.27,-7877 3834.26,-7877"/>
<polygon fill="black" stroke="black" points="3834.58,-7880.5 3844.58,-7877 3834.58,-7873.5 3834.58,-7880.5"/>
</g>
<!-- tg_client._flush_chop_queue -->
<g id="node133" class="node">
<title>tg_client._flush_chop_queue</title>
<g id="a_node133"><a xlink:title="Run the chop worker until the queue is empty and cancel it.">
<polygon fill="none" stroke="black" points="1153.68,-7229.5 1000.68,-7229.5 1000.68,-7076.5 1153.68,-7076.5 1153.68,-7229.5"/>
<text text-anchor="middle" x="1077.18" y="-7149.3" font-family="Times,serif" font-size="14.00">tg_client._flush_chop_queue</text>
</a>
</g>
</g>
<!-- tg_client._flush_chop_queue&#45;&gt;tg_client._process_chop_queue -->
<g id="edge193" class="edge">
<title>tg_client._flush_chop_queue&#45;&gt;tg_client._process_chop_queue</title>
<path fill="none" stroke="black" d="M1131.42,-7229.94C1212.85,-7337.55 1379.33,-7520 1572.18,-7520 1572.18,-7520 1572.18,-7520 1940.18,-7520 2231.57,-7520 2245.83,-7737.09 2527.68,-7811 2681.81,-7851.42 3084.89,-7835.87 3243.68,-7849 3305.74,-7854.13 3376.24,-7862.28 3426.35,-7868.46"/>
<polygon fill="black" stroke="black" points="3426.05,-7871.95 3436.41,-7869.71 3426.91,-7865.01 3426.05,-7871.95"/>
</g>
<!-- tg_client._get_id_date -->
<g id="node134" class="node">
<title>tg_client._get_id_date</title>
<g id="a_node134"><a xlink:title="Return the stored date for ``msg_id`` in ``chat`` if available.">
<polygon fill="none" stroke="black" points="3570.18,-6232.5 3417.18,-6232.5 3417.18,-6079.5 3570.18,-6079.5 3570.18,-6232.5"/>
<text text-anchor="middle" x="3493.68" y="-6152.3" font-family="Times,serif" font-size="14.00">tg_client._get_id_date</text>
</a>
</g>
</g>
<!-- tg_client._get_id_date&#45;&gt;post_io.raw_post_path -->
<g id="edge194" class="edge">
<title>tg_client._get_id_date&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M3570.3,-6139.14C3614.44,-6126.2 3668.89,-6104.55 3707.68,-6070 3732.64,-6047.78 3724.36,-6031.26 3743.68,-6004 3779.78,-5953.08 3828.99,-5900.71 3862.64,-5866.91"/>
<polygon fill="black" stroke="black" points="3865.39,-5869.11 3869.99,-5859.57 3860.44,-5864.16 3865.39,-5869.11"/>
</g>
<!-- tg_client._get_id_date&#45;&gt;notes_utils.read_text -->
<g id="edge195" class="edge">
<title>tg_client._get_id_date&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M3570.44,-6137.31C3690.73,-6103.84 3925.51,-6022.49 4059.68,-5870 4218.34,-5689.69 4202.29,-5601.93 4264.68,-5370 4349.34,-5055.32 4378.49,-4663.19 4386.81,-4517.76"/>
<polygon fill="black" stroke="black" points="4390.31,-4517.9 4387.37,-4507.72 4383.32,-4517.51 4390.31,-4517.9"/>
</g>
<!-- tg_client._load_progress -->
<g id="node135" class="node">
<title>tg_client._load_progress</title>
<g id="a_node135"><a xlink:title="Return saved resume timestamp for ``chat`` if available.">
<polygon fill="none" stroke="black" points="1142.18,-4281 1012.18,-4281 1012.18,-4151 1142.18,-4151 1142.18,-4281"/>
<text text-anchor="middle" x="1077.18" y="-4212.3" font-family="Times,serif" font-size="14.00">tg_client._load_progress</text>
</a>
</g>
</g>
<!-- tg_client._load_progress&#45;&gt;notes_utils.read_text -->
<g id="edge196" class="edge">
<title>tg_client._load_progress&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M1085.19,-4150.93C1117.9,-3863.76 1266.92,-2724 1572.18,-2724 1572.18,-2724 1572.18,-2724 2649.18,-2724 2962.75,-2724 3763.67,-2659.56 4059.68,-2763 4167.01,-2800.51 4209.66,-2816.51 4264.68,-2916 4337.78,-3048.15 4378.84,-4137.12 4387.8,-4402.06"/>
<polygon fill="black" stroke="black" points="4384.31,-4402.36 4388.15,-4412.23 4391.31,-4402.12 4384.31,-4402.36"/>
</g>
<!-- tg_client._save_progress -->
<g id="node136" class="node">
<title>tg_client._save_progress</title>
<g id="a_node136"><a xlink:title="Persist resume timestamp for ``chat`` to ``STATE_DIR``.">
<polygon fill="none" stroke="black" points="1367.18,-6064 1279.18,-6064 1279.18,-5976 1367.18,-5976 1367.18,-6064"/>
<text text-anchor="middle" x="1323.18" y="-6016.3" font-family="Times,serif" font-size="14.00">tg_client._save_progress</text>
</a>
</g>
</g>
<!-- tg_client.get_first_id -->
<g id="node137" class="node">
<title>tg_client.get_first_id</title>
<g id="a_node137"><a xlink:title="Return the smallest saved message id for ``chat``.">
<polygon fill="none" stroke="black" points="1635.68,-5871.5 1510.68,-5871.5 1510.68,-5746.5 1635.68,-5746.5 1635.68,-5871.5"/>
<text text-anchor="middle" x="1573.18" y="-5805.3" font-family="Times,serif" font-size="14.00">tg_client.get_first_id</text>
</a>
</g>
</g>
<!-- tg_client.get_first_id&#45;&gt;post_io.raw_post_path -->
<g id="edge197" class="edge">
<title>tg_client.get_first_id&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M1635.86,-5828.67C1767.11,-5868.73 2084.36,-5956 2357.18,-5956 2357.18,-5956 2357.18,-5956 2649.18,-5956 2715.28,-5956 3194.25,-5979.87 3243.68,-5936 3322.38,-5866.15 3199.82,-5770.51 3279.68,-5702 3351.87,-5640.07 3624.57,-5655.76 3707.68,-5702 3734.2,-5716.75 3720.82,-5740.05 3743.68,-5760 3777.66,-5789.64 3826.22,-5808.68 3860.31,-5819.3"/>
<polygon fill="black" stroke="black" points="3859.37,-5822.67 3869.95,-5822.2 3861.39,-5815.97 3859.37,-5822.67"/>
</g>
<!-- tg_client.get_last_id -->
<g id="node138" class="node">
<title>tg_client.get_last_id</title>
<g id="a_node138"><a xlink:title="Return the highest saved message id for ``chat``.">
<polygon fill="none" stroke="black" points="1139.68,-5953.5 1014.68,-5953.5 1014.68,-5828.5 1139.68,-5828.5 1139.68,-5953.5"/>
<text text-anchor="middle" x="1077.18" y="-5887.3" font-family="Times,serif" font-size="14.00">tg_client.get_last_id</text>
</a>
</g>
</g>
<!-- tg_client.get_last_id&#45;&gt;post_io.raw_post_path -->
<g id="edge198" class="edge">
<title>tg_client.get_last_id&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M1139.94,-5895.4C1245.34,-5902.96 1466.67,-5919.04 1653.68,-5934 1966.49,-5959.02 2043.38,-5994 2357.18,-5994 2357.18,-5994 2357.18,-5994 2649.18,-5994 2781.46,-5994 3145.19,-6052.3 3243.68,-5964 3318.76,-5896.69 3202.93,-5805.4 3279.68,-5740 3352.08,-5678.31 3615.61,-5716.14 3707.68,-5740 3725.4,-5744.59 3727.31,-5751.82 3743.68,-5760 3782.76,-5779.52 3828.47,-5799.6 3860.46,-5813.22"/>
<polygon fill="black" stroke="black" points="3859.35,-5816.55 3869.92,-5817.23 3862.08,-5810.11 3859.35,-5816.55"/>
</g>
<!-- tg_client._save_message -->
<g id="node139" class="node">
<title>tg_client._save_message</title>
<g id="a_node139"><a xlink:title="Write ``msg`` to disk with metadata and any media references.&#10;&#10;Returns the path of the stored message or ``None`` when skipped.">
<polygon fill="none" stroke="black" points="2188.68,-8928.5 1689.68,-8928.5 1689.68,-8429.5 2188.68,-8429.5 2188.68,-8928.5"/>
<text text-anchor="middle" x="1939.18" y="-8675.3" font-family="Times,serif" font-size="14.00">tg_client._save_message</text>
</a>
</g>
</g>
<!-- tg_client._save_message&#45;&gt;post_io.read_post -->
<g id="edge201" class="edge">
<title>tg_client._save_message&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M1958.95,-8429.22C2018.27,-7642.97 2199.28,-5268.91 2224.68,-5238 2384.29,-5043.77 2560.82,-5224.4 2768.68,-5083 2790.44,-5068.2 2781.37,-5048.21 2804.68,-5036 2893.67,-4989.4 3607.42,-4999.02 3707.68,-4993 3716.06,-4992.5 3724.64,-4991.96 3733.3,-4991.4"/>
<polygon fill="black" stroke="black" points="3733.75,-4994.88 3743.5,-4990.73 3733.29,-4987.89 3733.75,-4994.88"/>
</g>
<!-- tg_client._save_message&#45;&gt;post_io.raw_post_path -->
<g id="edge202" class="edge">
<title>tg_client._save_message&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M1951.28,-8429.14C1987.59,-7935.16 2142.67,-6833.64 2804.68,-6280 2963.64,-6147.07 3111.89,-6282.9 3243.68,-6123 3311.17,-6041.13 3202.45,-5959.75 3279.68,-5887 3290.3,-5877 3723.63,-5843.4 3860.02,-5833.06"/>
<polygon fill="black" stroke="black" points="3860.36,-5836.54 3870.06,-5832.3 3859.83,-5829.56 3860.36,-5836.54"/>
</g>
<!-- tg_client._save_message&#45;&gt;moderation.should_skip_user -->
<g id="edge199" class="edge">
<title>tg_client._save_message&#45;&gt;moderation.should_skip_user</title>
<path fill="none" stroke="black" d="M2189.04,-8645.68C2201.08,-8644.64 2213.01,-8643.74 2224.68,-8643 2343.11,-8635.54 2373.56,-8631.62 2491.68,-8643 2507.91,-8644.56 2511.59,-8647.39 2527.68,-8650 2650.23,-8669.86 2681.26,-8672.64 2804.68,-8686 2853.36,-8691.27 3208,-8690.48 3243.68,-8724 3322.3,-8797.85 3198.49,-8893 3279.68,-8964 3312.31,-8992.53 4028.34,-9000.93 4059.68,-8971 4122.27,-8911.24 4051.28,-8267.28 4095.68,-8193 4103.72,-8179.56 4116.88,-8169.29 4130.41,-8161.67"/>
<polygon fill="black" stroke="black" points="4132.05,-8164.76 4139.3,-8157.03 4128.81,-8158.55 4132.05,-8164.76"/>
</g>
<!-- tg_client._save_message&#45;&gt;post_io.get_contact -->
<g id="edge200" class="edge">
<title>tg_client._save_message&#45;&gt;post_io.get_contact</title>
<path fill="none" stroke="black" d="M2080.04,-8928.67C2131.56,-9013.4 2186.58,-9094.21 2224.68,-9124 2323.34,-9201.13 2380.34,-9156.7 2491.68,-9214 2509.23,-9223.03 2510,-9231.24 2527.68,-9240 2642.96,-9297.11 2678.36,-9299.65 2804.68,-9324 2900.83,-9342.53 3165.15,-9303.51 3243.68,-9362 3278.56,-9387.98 3247.21,-9424.07 3279.68,-9453 3322.69,-9491.31 3388.72,-9504.28 3435.85,-9508.46"/>
<polygon fill="black" stroke="black" points="3435.67,-9511.96 3445.91,-9509.24 3436.21,-9504.98 3435.67,-9511.96"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._mark_activity -->
<g id="edge203" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._mark_activity</title>
<path fill="none" stroke="black" d="M2104.55,-8928.51C2134.98,-8980.61 2164.69,-9036.1 2188.68,-9090 2211.15,-9140.48 2186.94,-9168.64 2224.68,-9209 2247.52,-9233.42 2283.47,-9246 2312.17,-9252.44"/>
<polygon fill="black" stroke="black" points="2311.48,-9255.87 2321.99,-9254.46 2312.9,-9249.01 2311.48,-9255.87"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._progress_logger -->
<g id="edge204" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._progress_logger</title>
<path fill="none" stroke="black" d="M2188.71,-8837.37C2200.87,-8845.03 2212.91,-8852.61 2224.68,-8860 2243.08,-8871.54 2262.97,-8883.91 2281.61,-8895.45"/>
<polygon fill="black" stroke="black" points="2280.01,-8898.58 2290.36,-8900.87 2283.69,-8892.63 2280.01,-8898.58"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._write_md -->
<g id="edge205" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._write_md</title>
<path fill="none" stroke="black" d="M2097.86,-8928.61C2135.17,-8974.2 2177.89,-9018.02 2224.68,-9052 2346.71,-9140.61 2526.48,-9179.92 2606.36,-9193.76"/>
<polygon fill="black" stroke="black" points="2606.05,-9197.26 2616.5,-9195.47 2607.22,-9190.36 2606.05,-9197.26"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._find_group_path -->
<g id="edge206" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._find_group_path</title>
<path fill="none" stroke="black" d="M2013.06,-8429.15C2065.33,-8259.53 2141.06,-8031.57 2224.68,-7837 2442.6,-7329.95 2544.01,-7225.46 2804.68,-6739 2870.84,-6615.54 2949.52,-6471.43 2992.09,-6393.7"/>
<polygon fill="black" stroke="black" points="2995.37,-6395 2997.1,-6384.55 2989.23,-6391.64 2995.37,-6395"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._should_skip_media -->
<g id="edge207" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._should_skip_media</title>
<path fill="none" stroke="black" d="M2188.77,-8712.38C2215.82,-8716.02 2241.93,-8719.52 2265.19,-8722.65"/>
<polygon fill="black" stroke="black" points="2264.94,-8726.14 2275.32,-8724.01 2265.88,-8719.21 2264.94,-8726.14"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._allowed_topic -->
<g id="edge208" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._allowed_topic</title>
<path fill="none" stroke="black" d="M2188.73,-8814.84C2200.72,-8819.04 2212.74,-8822.79 2224.68,-8826 2333.84,-8855.28 2464.45,-8856.59 2551.27,-8852.97"/>
<polygon fill="black" stroke="black" points="2551.54,-8856.46 2561.38,-8852.52 2551.23,-8849.47 2551.54,-8856.46"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._extract_author -->
<g id="edge209" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._extract_author</title>
<path fill="none" stroke="black" d="M2103.79,-8928.71C2139.11,-8964.9 2179.59,-8996.98 2224.68,-9018 2332.23,-9068.15 2374.01,-9033.34 2491.68,-9018 2621.69,-9001.05 2765.18,-8961.7 2870.26,-8928.87"/>
<polygon fill="black" stroke="black" points="2871.5,-8932.15 2879.99,-8925.82 2869.4,-8925.47 2871.5,-8932.15"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._enqueue_chop -->
<g id="edge210" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._enqueue_chop</title>
<path fill="none" stroke="black" d="M2175.8,-8429.26C2204.81,-8398.51 2233.1,-8368.52 2258.39,-8341.72"/>
<polygon fill="black" stroke="black" points="2261.12,-8343.92 2265.44,-8334.24 2256.03,-8339.12 2261.12,-8343.92"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._save_message -->
<g id="edge211" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._save_message</title>
<path fill="none" stroke="black" d="M1896.7,-8928.78C1907.51,-8939.97 1921.67,-8946.5 1939.18,-8946.5 1952.87,-8946.5 1964.5,-8942.51 1974.09,-8935.43"/>
<polygon fill="black" stroke="black" points="1976.47,-8938.01 1981.67,-8928.78 1971.84,-8932.75 1976.47,-8938.01"/>
</g>
<!-- tg_client._save_media -->
<g id="node140" class="node">
<title>tg_client._save_media</title>
<g id="a_node140"><a xlink:title="Store ``data`` and return relative file path.">
<polygon fill="none" stroke="black" points="2756.18,-7802 2540.18,-7802 2540.18,-7586 2756.18,-7586 2756.18,-7802"/>
<text text-anchor="middle" x="2648.18" y="-7690.3" font-family="Times,serif" font-size="14.00">tg_client._save_media</text>
</a>
</g>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._save_media -->
<g id="edge212" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._save_media</title>
<path fill="none" stroke="black" d="M2050.73,-8429.37C2098.42,-8332.52 2158.48,-8223.02 2224.68,-8131 2315.5,-8004.77 2441.76,-7879.07 2532.56,-7795.11"/>
<polygon fill="black" stroke="black" points="2535.15,-7797.48 2540.13,-7788.13 2530.41,-7792.33 2535.15,-7797.48"/>
</g>
<!-- tg_client._save_media&#45;&gt;caption_io.caption_json_path -->
<g id="edge213" class="edge">
<title>tg_client._save_media&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M2667.55,-7585.64C2703.52,-7375.94 2781.73,-6932.96 2804.68,-6908 3081.37,-6607.18 3314.57,-6845.86 3707.68,-6734 3876.11,-6686.07 3920.49,-6663.25 4059.68,-6557 4078.69,-6542.49 4076.6,-6531.42 4095.68,-6517 4108.89,-6507.02 4124.92,-6498.45 4139.38,-6491.77"/>
<polygon fill="black" stroke="black" points="4140.91,-6494.92 4148.62,-6487.66 4138.06,-6488.53 4140.91,-6494.92"/>
</g>
<!-- tg_client._save_media&#45;&gt;caption_io.has_caption -->
<g id="edge214" class="edge">
<title>tg_client._save_media&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M2756.31,-7712.08C2947.49,-7741.95 3360.02,-7795.63 3707.68,-7767 3760.82,-7762.62 3821.36,-7751.58 3860.24,-7743.7"/>
<polygon fill="black" stroke="black" points="3861.03,-7747.11 3870.12,-7741.66 3859.62,-7740.25 3861.03,-7747.11"/>
</g>
<!-- tg_client._save_media&#45;&gt;image_io.write_image_meta -->
<g id="edge215" class="edge">
<title>tg_client._save_media&#45;&gt;image_io.write_image_meta</title>
<path fill="none" stroke="black" d="M2721.21,-7802.26C2740.23,-7836.3 2758.33,-7874.97 2768.68,-7913 2785,-7972.91 2765.21,-8982.08 2804.68,-9030 2844.96,-9078.9 2922.36,-9085.82 2973.39,-9084.39"/>
<polygon fill="black" stroke="black" points="2973.69,-9087.88 2983.54,-9083.98 2973.41,-9080.88 2973.69,-9087.88"/>
</g>
<!-- tg_client._save_media&#45;&gt;tg_client._schedule_caption -->
<g id="edge216" class="edge">
<title>tg_client._save_media&#45;&gt;tg_client._schedule_caption</title>
<path fill="none" stroke="black" d="M2756.48,-7585.95C2760.65,-7581.28 2764.73,-7576.62 2768.68,-7572 3015.81,-7283.1 2965.06,-7099.42 3279.68,-6886 3326.51,-6854.24 3390.28,-6840.15 3435.81,-6833.92"/>
<polygon fill="black" stroke="black" points="3436.34,-6837.38 3445.81,-6832.63 3435.45,-6830.43 3436.34,-6837.38"/>
</g>
<!-- tg_client._save_bounded -->
<g id="node141" class="node">
<title>tg_client._save_bounded</title>
<g id="a_node141"><a xlink:title="Run ``_save_message`` under the global semaphore and return path.">
<polygon fill="none" stroke="black" points="1653.68,-6619.5 1492.68,-6619.5 1492.68,-6458.5 1653.68,-6458.5 1653.68,-6619.5"/>
<text text-anchor="middle" x="1573.18" y="-6535.3" font-family="Times,serif" font-size="14.00">tg_client._save_bounded</text>
</a>
</g>
</g>
<!-- tg_client._save_bounded&#45;&gt;tg_client._save_message -->
<g id="edge217" class="edge">
<title>tg_client._save_bounded&#45;&gt;tg_client._save_message</title>
<path fill="none" stroke="black" d="M1587.9,-6619.63C1637.87,-6913.4 1811.56,-7934.56 1894.04,-8419.49"/>
<polygon fill="black" stroke="black" points="1890.6,-8420.15 1895.73,-8429.42 1897.5,-8418.98 1890.6,-8420.15"/>
</g>
<!-- tg_client._remove_local_message -->
<g id="node142" class="node">
<title>tg_client._remove_local_message</title>
<g id="a_node142"><a xlink:title="Delete ``path`` and related media if the post no longer exists.">
<polygon fill="none" stroke="black" points="3578.18,-6725.5 3409.18,-6725.5 3409.18,-6556.5 3578.18,-6556.5 3578.18,-6725.5"/>
<text text-anchor="middle" x="3493.68" y="-6637.3" font-family="Times,serif" font-size="14.00">tg_client._remove_local_message</text>
</a>
</g>
</g>
<!-- tg_client._remove_local_message&#45;&gt;caption_io.caption_json_path -->
<g id="edge218" class="edge">
<title>tg_client._remove_local_message&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M3578.27,-6620.85C3726.32,-6585.16 4029.3,-6512.13 4138.67,-6485.76"/>
<polygon fill="black" stroke="black" points="4139.74,-6489.11 4148.64,-6483.36 4138.1,-6482.3 4139.74,-6489.11"/>
</g>
<!-- tg_client._remove_local_message&#45;&gt;caption_io.caption_md_path -->
<g id="edge219" class="edge">
<title>tg_client._remove_local_message&#45;&gt;caption_io.caption_md_path</title>
<path fill="none" stroke="black" d="M3578.27,-6648.94C3726.32,-6663 4029.3,-6691.77 4138.67,-6702.15"/>
<polygon fill="black" stroke="black" points="4138.36,-6705.64 4148.64,-6703.1 4139.02,-6698.67 4138.36,-6705.64"/>
</g>
<!-- tg_client._remove_local_message&#45;&gt;post_io.read_post -->
<g id="edge220" class="edge">
<title>tg_client._remove_local_message&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M3578.23,-6626.6C3624.59,-6613.94 3678.6,-6590.4 3707.68,-6547 3792.83,-6419.95 3688.23,-5330.57 3743.83,-5146.53"/>
<polygon fill="black" stroke="black" points="3747.14,-5147.67 3747.16,-5137.08 3740.54,-5145.35 3747.14,-5147.67"/>
</g>
<!-- tg_client._download_messages -->
<g id="node143" class="node">
<title>tg_client._download_messages</title>
<g id="a_node143"><a xlink:title="Save ``messages`` with a progress bar and return count saved.">
<polygon fill="none" stroke="black" points="1438.18,-6636 1208.18,-6636 1208.18,-6406 1438.18,-6406 1438.18,-6636"/>
<text text-anchor="middle" x="1323.18" y="-6517.3" font-family="Times,serif" font-size="14.00">tg_client._download_messages</text>
</a>
</g>
</g>
<!-- tg_client._download_messages&#45;&gt;tg_client._save_bounded -->
<g id="edge221" class="edge">
<title>tg_client._download_messages&#45;&gt;tg_client._save_bounded</title>
<path fill="none" stroke="black" d="M1438.38,-6529.29C1453.11,-6530.36 1468.03,-6531.44 1482.29,-6532.48"/>
<polygon fill="black" stroke="black" points="1482.32,-6535.99 1492.55,-6533.22 1482.83,-6529.01 1482.32,-6535.99"/>
</g>
<!-- tg_client.ensure_chat_access -->
<g id="node144" class="node">
<title>tg_client.ensure_chat_access</title>
<g id="a_node144"><a xlink:title="Join chats listed in ``CHATS`` if not already joined.">
<polygon fill="none" stroke="black" points="1380.18,-7662 1266.18,-7662 1266.18,-7548 1380.18,-7548 1380.18,-7662"/>
<text text-anchor="middle" x="1323.18" y="-7601.3" font-family="Times,serif" font-size="14.00">tg_client.ensure_chat_access</text>
</a>
</g>
</g>
<!-- tg_client.refetch_messages -->
<g id="node145" class="node">
<title>tg_client.refetch_messages</title>
<g id="a_node145"><a xlink:title="Re&#45;fetch posts that failed parsing or are empty.">
<polygon fill="none" stroke="black" points="1456.68,-6349.5 1189.68,-6349.5 1189.68,-6082.5 1456.68,-6082.5 1456.68,-6349.5"/>
<text text-anchor="middle" x="1323.18" y="-6212.3" font-family="Times,serif" font-size="14.00">tg_client.refetch_messages</text>
</a>
</g>
</g>
<!-- tg_client.refetch_messages&#45;&gt;notes_utils.load_json -->
<g id="edge224" class="edge">
<title>tg_client.refetch_messages&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M1452.21,-6082.17C1453.79,-6079.14 1455.28,-6076.08 1456.68,-6073 1518.88,-5936.3 1460.3,-5883.65 1492.68,-5737 1551.3,-5471.57 1591.42,-5411.44 1689.68,-5158 1789.44,-4900.71 1662.23,-4589 1938.18,-4589 1938.18,-4589 1938.18,-4589 2649.18,-4589 2715.28,-4589 3195.46,-4614.2 3243.68,-4569 3303.15,-4513.26 3220.67,-4260.22 3279.68,-4204 3342.51,-4144.14 3979.35,-4197.81 4059.68,-4165 4082.71,-4155.59 4104.27,-4139.77 4122.56,-4123.18"/>
<polygon fill="black" stroke="black" points="4125.28,-4125.42 4130.2,-4116.03 4120.5,-4120.31 4125.28,-4125.42"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;notes_utils.write_json -->
<g id="edge225" class="edge">
<title>tg_client.refetch_messages&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M1452.48,-6082.29C1453.97,-6079.22 1455.38,-6076.12 1456.68,-6073 1491.91,-5988.64 1485.16,-5342.11 1492.68,-5251 1552.37,-4528.16 1545.75,-4341.88 1689.68,-3631 1769.4,-3237.29 1536.48,-2762 1938.18,-2762 1938.18,-2762 1938.18,-2762 2649.18,-2762 2806.34,-2762 3918.49,-2726.02 4059.68,-2657 4096.84,-2638.84 4127.8,-2603.6 4148.89,-2574.1"/>
<polygon fill="black" stroke="black" points="4152,-2575.76 4154.84,-2565.56 4146.25,-2571.76 4152,-2575.76"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;post_io.read_post -->
<g id="edge222" class="edge">
<title>tg_client.refetch_messages&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M1450.05,-6082.11C1452.31,-6079.08 1454.53,-6076.04 1456.68,-6073 1476.47,-6045.11 1470.69,-6031.18 1492.68,-6005 1550.96,-5935.64 1589.81,-5944.24 1653.68,-5880 1947.6,-5584.44 1868.18,-5351.98 2224.68,-5136 2341.61,-5065.16 2392.6,-5104.05 2527.68,-5083 2634.5,-5066.35 2677.05,-5107.38 2768.68,-5050 2793.13,-5034.69 2779.36,-5009.81 2804.68,-4996 2883.86,-4952.83 3446.74,-4964.27 3733.55,-4973.12"/>
<polygon fill="black" stroke="black" points="3733.54,-4976.62 3743.64,-4973.43 3733.75,-4969.62 3733.54,-4976.62"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;post_io.raw_post_path -->
<g id="edge223" class="edge">
<title>tg_client.refetch_messages&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M1456.93,-6211.4C1880.81,-6196.12 3178.02,-6144.6 3243.68,-6084 3322.95,-6010.85 3198.75,-5915.3 3279.68,-5844 3323.01,-5805.83 3728.59,-5821.73 3859.88,-5827.94"/>
<polygon fill="black" stroke="black" points="3859.78,-5831.44 3869.94,-5828.43 3860.11,-5824.45 3859.78,-5831.44"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;tg_client._get_message_path -->
<g id="edge226" class="edge">
<title>tg_client.refetch_messages&#45;&gt;tg_client._get_message_path</title>
<path fill="none" stroke="black" d="M1456.9,-6129.84C1480.97,-6114.21 1504.61,-6098.87 1524.15,-6086.18"/>
<polygon fill="black" stroke="black" points="1526.06,-6089.11 1532.54,-6080.73 1522.25,-6083.24 1526.06,-6089.11"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;tg_client._save_bounded -->
<g id="edge227" class="edge">
<title>tg_client.refetch_messages&#45;&gt;tg_client._save_bounded</title>
<path fill="none" stroke="black" d="M1426.84,-6349.71C1452.78,-6383.48 1479.99,-6418.93 1503.77,-6449.9"/>
<polygon fill="black" stroke="black" points="1501.19,-6452.29 1510.06,-6458.09 1506.75,-6448.03 1501.19,-6452.29"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;tg_client._remove_local_message -->
<g id="edge228" class="edge">
<title>tg_client.refetch_messages&#45;&gt;tg_client._remove_local_message</title>
<path fill="none" stroke="black" d="M1456.97,-6242.03C1858.73,-6320.77 3054.78,-6555.18 3399.02,-6622.64"/>
<polygon fill="black" stroke="black" points="3398.47,-6626.1 3408.96,-6624.59 3399.82,-6619.23 3398.47,-6626.1"/>
</g>
<!-- tg_client.fetch_missing -->
<g id="node146" class="node">
<title>tg_client.fetch_missing</title>
<g id="a_node146"><a xlink:title="Pull new messages and back&#45;fill history until fully synced.">
<polygon fill="none" stroke="black" points="964.68,-6154.5 657.68,-6154.5 657.68,-5847.5 964.68,-5847.5 964.68,-6154.5"/>
<text text-anchor="middle" x="811.18" y="-5997.3" font-family="Times,serif" font-size="14.00">tg_client.fetch_missing</text>
</a>
</g>
</g>
<!-- tg_client.fetch_missing&#45;&gt;post_io.raw_post_path -->
<g id="edge229" class="edge">
<title>tg_client.fetch_missing&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M964.88,-5984.11C1033.51,-5977.32 1115.56,-5970.33 1189.68,-5967 1708.85,-5943.67 1837.49,-6032 2357.18,-6032 2357.18,-6032 2357.18,-6032 2649.18,-6032 2715.32,-6032 3194.45,-6047.16 3243.68,-6003 3319.73,-5934.79 3202,-5842.33 3279.68,-5776 3352.01,-5714.24 3613.46,-5763.07 3707.68,-5776 3761.63,-5783.41 3821.76,-5801.94 3860.34,-5815.23"/>
<polygon fill="black" stroke="black" points="3859.55,-5818.66 3870.15,-5818.65 3861.86,-5812.05 3859.55,-5818.66"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client._get_id_date -->
<g id="edge230" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client._get_id_date</title>
<path fill="none" stroke="black" d="M926.89,-6154.88C993.94,-6231.59 1085.76,-6316.64 1189.68,-6358 1399.11,-6441.34 3014.22,-6222.89 3406.86,-6168.11"/>
<polygon fill="black" stroke="black" points="3407.6,-6171.54 3417.02,-6166.69 3406.63,-6164.61 3407.6,-6171.54"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client._load_progress -->
<g id="edge231" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client._load_progress</title>
<path fill="none" stroke="black" d="M834.92,-5847.27C889.28,-5479.69 1025.22,-4560.55 1065.05,-4291.26"/>
<polygon fill="black" stroke="black" points="1068.54,-4291.6 1066.54,-4281.19 1061.62,-4290.57 1068.54,-4291.6"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client._save_progress -->
<g id="edge232" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client._save_progress</title>
<path fill="none" stroke="black" d="M964.85,-6006.69C1067.79,-6010.52 1197.39,-6015.35 1268.81,-6018.01"/>
<polygon fill="black" stroke="black" points="1268.79,-6021.51 1278.91,-6018.39 1269.05,-6014.52 1268.79,-6021.51"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client.get_first_id -->
<g id="edge233" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client.get_first_id</title>
<path fill="none" stroke="black" d="M950.12,-5847.42C966.1,-5836.12 983.03,-5826.31 1000.68,-5819 1168.49,-5749.5 1388.49,-5774.27 1500.27,-5794.04"/>
<polygon fill="black" stroke="black" points="1499.95,-5797.54 1510.41,-5795.87 1501.2,-5790.65 1499.95,-5797.54"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client.get_last_id -->
<g id="edge234" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client.get_last_id</title>
<path fill="none" stroke="black" d="M964.99,-5937.33C978.89,-5931.54 992.48,-5925.88 1005.11,-5920.61"/>
<polygon fill="black" stroke="black" points="1006.69,-5923.75 1014.57,-5916.67 1004,-5917.29 1006.69,-5923.75"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client._download_messages -->
<g id="edge235" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client._download_messages</title>
<path fill="none" stroke="black" d="M856.4,-6154.77C886.05,-6234.47 932.41,-6328.2 1000.68,-6392 1055.33,-6443.07 1132.76,-6474.96 1197.93,-6494.26"/>
<polygon fill="black" stroke="black" points="1197.29,-6497.72 1207.87,-6497.14 1199.24,-6490.99 1197.29,-6497.72"/>
</g>
<!-- tg_client.remove_deleted -->
<g id="node147" class="node">
<title>tg_client.remove_deleted</title>
<g id="a_node147"><a xlink:title="Delete locally stored messages removed from Telegram recently.">
<polygon fill="none" stroke="black" points="3618.18,-6538.5 3369.18,-6538.5 3369.18,-6289.5 3618.18,-6289.5 3618.18,-6538.5"/>
<text text-anchor="middle" x="3493.68" y="-6410.3" font-family="Times,serif" font-size="14.00">tg_client.remove_deleted</text>
</a>
</g>
</g>
<!-- tg_client.remove_deleted&#45;&gt;caption_io.caption_json_path -->
<g id="edge236" class="edge">
<title>tg_client.remove_deleted&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M3618.24,-6425.19C3775.38,-6439.42 4038.35,-6463.24 4138.64,-6472.33"/>
<polygon fill="black" stroke="black" points="4138.39,-6475.82 4148.67,-6473.24 4139.03,-6468.85 4138.39,-6475.82"/>
</g>
<!-- tg_client.remove_deleted&#45;&gt;caption_io.caption_md_path -->
<g id="edge237" class="edge">
<title>tg_client.remove_deleted&#45;&gt;caption_io.caption_md_path</title>
<path fill="none" stroke="black" d="M3618.24,-6466.71C3775.7,-6533.88 4039.41,-6646.38 4139.25,-6688.97"/>
<polygon fill="black" stroke="black" points="4138.1,-6692.28 4148.67,-6692.98 4140.84,-6685.84 4138.1,-6692.28"/>
</g>
<!-- tg_client.remove_deleted&#45;&gt;post_io.read_post -->
<g id="edge238" class="edge">
<title>tg_client.remove_deleted&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M3618.42,-6342.25C3653.58,-6315.27 3687.72,-6281.22 3707.68,-6241 3760.59,-6134.42 3699.76,-5298.02 3743.83,-5146.78"/>
<polygon fill="black" stroke="black" points="3747.22,-5147.68 3747.19,-5137.09 3740.61,-5145.39 3747.22,-5147.68"/>
</g>
<!-- tg_client.remove_deleted&#45;&gt;post_io.raw_post_path -->
<g id="edge239" class="edge">
<title>tg_client.remove_deleted&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M3618.32,-6329.14C3650.12,-6303.38 3682.44,-6273.27 3707.68,-6241 3708.46,-6240 3832.75,-5974.93 3881.44,-5871.06"/>
<polygon fill="black" stroke="black" points="3884.69,-5872.36 3885.77,-5861.82 3878.36,-5869.39 3884.69,-5872.36"/>
</g>
<!-- tg_client.main -->
<g id="node148" class="node">
<title>tg_client.main</title>
<g id="a_node148"><a xlink:title="Synchronize configured chats and optional live updates.">
<polygon fill="none" stroke="black" points="621.68,-7107 229.68,-7107 229.68,-6715 621.68,-6715 621.68,-7107"/>
<text text-anchor="middle" x="425.68" y="-6907.3" font-family="Times,serif" font-size="14.00">tg_client.main</text>
</a>
</g>
</g>
<!-- tg_client.main&#45;&gt;tg_client._mark_activity -->
<g id="edge240" class="edge">
<title>tg_client.main&#45;&gt;tg_client._mark_activity</title>
<path fill="none" stroke="black" d="M442.49,-7107.06C491.22,-7644.94 661.61,-9104 1076.18,-9104 1076.18,-9104 1076.18,-9104 1574.18,-9104 1847.42,-9104 1953.02,-8984.72 2188.68,-9123 2215.5,-9138.74 2202.48,-9161.23 2224.68,-9183 2250.12,-9207.94 2285.34,-9227.63 2313.07,-9240.71"/>
<polygon fill="black" stroke="black" points="2311.62,-9243.9 2322.17,-9244.9 2314.54,-9237.54 2311.62,-9243.9"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client._heartbeat -->
<g id="edge241" class="edge">
<title>tg_client.main&#45;&gt;tg_client._heartbeat</title>
<path fill="none" stroke="black" d="M473.38,-7107.11C508.34,-7218 566.24,-7352.53 657.68,-7445 682.15,-7469.74 717.19,-7486.23 747.51,-7496.76"/>
<polygon fill="black" stroke="black" points="746.58,-7500.14 757.17,-7499.98 748.79,-7493.5 746.58,-7500.14"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client._flush_chop_queue -->
<g id="edge242" class="edge">
<title>tg_client.main&#45;&gt;tg_client._flush_chop_queue</title>
<path fill="none" stroke="black" d="M621.99,-6983.77C745.16,-7029.66 898.02,-7086.62 991.27,-7121.36"/>
<polygon fill="black" stroke="black" points="990.07,-7124.65 1000.67,-7124.86 992.52,-7118.09 990.07,-7124.65"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client._save_bounded -->
<g id="edge243" class="edge">
<title>tg_client.main&#45;&gt;tg_client._save_bounded</title>
<path fill="none" stroke="black" d="M608.77,-6714.88C624.46,-6704.5 640.82,-6695.35 657.68,-6688 820.7,-6617 1292.78,-6713.94 1456.68,-6645 1468.48,-6640.04 1479.84,-6633.32 1490.52,-6625.67"/>
<polygon fill="black" stroke="black" points="1492.65,-6628.44 1498.56,-6619.64 1488.46,-6622.84 1492.65,-6628.44"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client.ensure_chat_access -->
<g id="edge244" class="edge">
<title>tg_client.main&#45;&gt;tg_client.ensure_chat_access</title>
<path fill="none" stroke="black" d="M621.73,-7087.98C771.26,-7219.17 985.89,-7398.05 1189.68,-7534 1210.86,-7548.13 1235.14,-7561.8 1257.08,-7573.31"/>
<polygon fill="black" stroke="black" points="1255.52,-7576.44 1266.01,-7577.94 1258.74,-7570.23 1255.52,-7576.44"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client.refetch_messages -->
<g id="edge245" class="edge">
<title>tg_client.main&#45;&gt;tg_client.refetch_messages</title>
<path fill="none" stroke="black" d="M589.88,-6714.74C611.79,-6692.01 634.67,-6669.88 657.68,-6650 823.91,-6506.42 1040.78,-6373.37 1180.77,-6293.4"/>
<polygon fill="black" stroke="black" points="1182.51,-6296.44 1189.46,-6288.45 1179.04,-6290.36 1182.51,-6296.44"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client.fetch_missing -->
<g id="edge246" class="edge">
<title>tg_client.main&#45;&gt;tg_client.fetch_missing</title>
<path fill="none" stroke="black" d="M509.31,-6714.94C578.58,-6550.56 676.35,-6318.57 741.42,-6164.16"/>
<polygon fill="black" stroke="black" points="744.81,-6165.14 745.47,-6154.56 738.36,-6162.42 744.81,-6165.14"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client.remove_deleted -->
<g id="edge247" class="edge">
<title>tg_client.main&#45;&gt;tg_client.remove_deleted</title>
<path fill="none" stroke="black" d="M621.97,-6879.34C1196.75,-6786.17 2872.64,-6514.51 3358.94,-6435.68"/>
<polygon fill="black" stroke="black" points="3359.85,-6439.08 3369.16,-6434.02 3358.73,-6432.17 3359.85,-6439.08"/>
</g>
<!-- clean_data._parse_date -->
<g id="node149" class="node">
<title>clean_data._parse_date</title>
<g id="a_node149"><a xlink:title="Return the ``date`` field from a markdown file if present.">
<polygon fill="none" stroke="black" points="3958.68,-8526 3844.68,-8526 3844.68,-8412 3958.68,-8412 3958.68,-8526"/>
<text text-anchor="middle" x="3901.68" y="-8465.3" font-family="Times,serif" font-size="14.00">clean_data._parse_date</text>
</a>
</g>
</g>
<!-- clean_data._parse_date&#45;&gt;notes_utils.read_text -->
<g id="edge248" class="edge">
<title>clean_data._parse_date&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M3958.81,-8465.99C4041.47,-8458.22 4193.81,-8430.39 4264.68,-8331 4380.33,-8168.81 4388.98,-4989.07 4389.63,-4518.09"/>
<polygon fill="black" stroke="black" points="4393.13,-4517.8 4389.64,-4507.79 4386.13,-4517.79 4393.13,-4517.8"/>
</g>
<!-- clean_data._clean_raw -->
<g id="node150" class="node">
<title>clean_data._clean_raw</title>
<g id="a_node150"><a xlink:title="Delete raw posts older than ``cutoff``.">
<polygon fill="none" stroke="black" points="3558.68,-8534 3428.68,-8534 3428.68,-8404 3558.68,-8404 3558.68,-8534"/>
<text text-anchor="middle" x="3493.68" y="-8465.3" font-family="Times,serif" font-size="14.00">clean_data._clean_raw</text>
</a>
</g>
</g>
<!-- clean_data._clean_raw&#45;&gt;post_io.raw_post_path -->
<g id="edge249" class="edge">
<title>clean_data._clean_raw&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M3558.87,-8454.21C3608.93,-8438.97 3675.23,-8409.75 3707.68,-8357 3771.51,-8253.27 3716.23,-6283.66 3743.68,-6165 3769.9,-6051.68 3837.59,-5931.04 3874.96,-5870.15"/>
<polygon fill="black" stroke="black" points="3877.96,-5871.96 3880.24,-5861.61 3872,-5868.27 3877.96,-5871.96"/>
</g>
<!-- clean_data._clean_raw&#45;&gt;clean_data._parse_date -->
<g id="edge250" class="edge">
<title>clean_data._clean_raw&#45;&gt;clean_data._parse_date</title>
<path fill="none" stroke="black" d="M3559.01,-8469C3634.18,-8469 3757.95,-8469 3834.08,-8469"/>
<polygon fill="black" stroke="black" points="3834.5,-8472.5 3844.5,-8469 3834.5,-8465.5 3834.5,-8472.5"/>
</g>
<!-- clean_data._clean_media -->
<g id="node151" class="node">
<title>clean_data._clean_media</title>
<g id="a_node151"><a xlink:title="Remove unused media files older than ``cutoff``.">
<polygon fill="none" stroke="black" points="3567.68,-8700 3419.68,-8700 3419.68,-8552 3567.68,-8552 3567.68,-8700"/>
<text text-anchor="middle" x="3493.68" y="-8622.3" font-family="Times,serif" font-size="14.00">clean_data._clean_media</text>
</a>
</g>
</g>
<!-- clean_data._clean_media&#45;&gt;caption_io.has_caption -->
<g id="edge251" class="edge">
<title>clean_data._clean_media&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M3567.8,-8617.78C3615.85,-8608.24 3675.56,-8587.6 3707.68,-8543 3802.87,-8410.85 3653.81,-7946.82 3743.68,-7811 3769.88,-7771.41 3822.86,-7751.81 3860.01,-7742.56"/>
<polygon fill="black" stroke="black" points="3861.09,-7745.9 3870.03,-7740.22 3859.49,-7739.09 3861.09,-7745.9"/>
</g>
<!-- clean_data._clean_media&#45;&gt;clean_data._parse_date -->
<g id="edge252" class="edge">
<title>clean_data._clean_media&#45;&gt;clean_data._parse_date</title>
<path fill="none" stroke="black" d="M3567.74,-8597.75C3643.77,-8568.35 3761.77,-8522.72 3834.96,-8494.41"/>
<polygon fill="black" stroke="black" points="3836.48,-8497.58 3844.54,-8490.71 3833.95,-8491.05 3836.48,-8497.58"/>
</g>
<!-- clean_data._clean_lots -->
<g id="node152" class="node">
<title>clean_data._clean_lots</title>
<g id="a_node152"><a xlink:title="Drop lots missing translations or source posts.">
<polygon fill="none" stroke="black" points="3581.68,-7071 3405.68,-7071 3405.68,-6895 3581.68,-6895 3581.68,-7071"/>
<text text-anchor="middle" x="3493.68" y="-6979.3" font-family="Times,serif" font-size="14.00">clean_data._clean_lots</text>
</a>
</g>
</g>
<!-- clean_data._clean_lots&#45;&gt;lot_io.needs_cleanup -->
<g id="edge253" class="edge">
<title>clean_data._clean_lots&#45;&gt;lot_io.needs_cleanup</title>
<path fill="none" stroke="black" d="M3581.78,-6988.36C3663.83,-6993.42 3783.88,-7000.81 3850.84,-7004.93"/>
<polygon fill="black" stroke="black" points="3850.92,-7008.44 3861.11,-7005.56 3851.35,-7001.46 3850.92,-7008.44"/>
</g>
<!-- clean_data._clean_lots&#45;&gt;lot_io.read_lots -->
<g id="edge254" class="edge">
<title>clean_data._clean_lots&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M3581.86,-6966.25C3627.6,-6952.58 3679.78,-6928.16 3707.68,-6885 3773.15,-6783.73 3689.8,-2651.88 3743.68,-2544 3761.55,-2508.23 3795.69,-2480.16 3827.58,-2460.19"/>
<polygon fill="black" stroke="black" points="3829.77,-2462.96 3836.5,-2454.77 3826.13,-2456.97 3829.77,-2462.96"/>
</g>
<!-- clean_data._clean_lots&#45;&gt;post_io.raw_post_path -->
<g id="edge255" class="edge">
<title>clean_data._clean_lots&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M3581.72,-6965.63C3627.1,-6951.79 3679,-6927.4 3707.68,-6885 3752.56,-6818.65 3724.32,-6242.73 3743.68,-6165 3771.8,-6052.13 3838.7,-5931.31 3875.44,-5870.27"/>
<polygon fill="black" stroke="black" points="3878.45,-5872.07 3880.64,-5861.71 3872.46,-5868.44 3878.45,-5872.07"/>
</g>
<!-- clean_data._clean_embeddings -->
<g id="node153" class="node">
<title>clean_data._clean_embeddings</title>
<g id="a_node153"><a xlink:title="Delete embedding files when the matching lot JSON is absent.">
<polygon fill="none" stroke="black" points="3558.68,-8924 3428.68,-8924 3428.68,-8794 3558.68,-8794 3558.68,-8924"/>
<text text-anchor="middle" x="3493.68" y="-8855.3" font-family="Times,serif" font-size="14.00">clean_data._clean_embeddings</text>
</a>
</g>
</g>
<!-- clean_data._remove_empty_dirs -->
<g id="node154" class="node">
<title>clean_data._remove_empty_dirs</title>
<g id="a_node154"><a xlink:title="Recursively remove empty folders under ``root``.">
<polygon fill="none" stroke="black" points="3966.68,-8962 3836.68,-8962 3836.68,-8832 3966.68,-8832 3966.68,-8962"/>
<text text-anchor="middle" x="3901.68" y="-8893.3" font-family="Times,serif" font-size="14.00">clean_data._remove_empty_dirs</text>
</a>
</g>
</g>
<!-- clean_data.main -->
<g id="node155" class="node">
<title>clean_data.main</title>
<g id="a_node155"><a xlink:title="Clean up old or inconsistent files across data directories.">
<polygon fill="none" stroke="black" points="3078.18,-8677 2970.18,-8677 2970.18,-8569 3078.18,-8569 3078.18,-8677"/>
<text text-anchor="middle" x="3024.18" y="-8619.3" font-family="Times,serif" font-size="14.00">clean_data.main</text>
</a>
</g>
</g>
<!-- clean_data.main&#45;&gt;clean_data._clean_raw -->
<g id="edge256" class="edge">
<title>clean_data.main&#45;&gt;clean_data._clean_raw</title>
<path fill="none" stroke="black" d="M3078.36,-8605.48C3161.88,-8577.97 3324.06,-8524.55 3418.85,-8493.32"/>
<polygon fill="black" stroke="black" points="3419.97,-8496.64 3428.37,-8490.19 3417.78,-8489.99 3419.97,-8496.64"/>
</g>
<!-- clean_data.main&#45;&gt;clean_data._clean_media -->
<g id="edge257" class="edge">
<title>clean_data.main&#45;&gt;clean_data._clean_media</title>
<path fill="none" stroke="black" d="M3078.36,-8623.34C3159.17,-8623.86 3313.62,-8624.85 3409.42,-8625.47"/>
<polygon fill="black" stroke="black" points="3409.63,-8628.97 3419.65,-8625.53 3409.67,-8621.97 3409.63,-8628.97"/>
</g>
<!-- clean_data.main&#45;&gt;clean_data._clean_lots -->
<g id="edge258" class="edge">
<title>clean_data.main&#45;&gt;clean_data._clean_lots</title>
<path fill="none" stroke="black" d="M3067.39,-8568.97C3120.05,-8497.94 3207.58,-8367.09 3243.68,-8239 3277.52,-8118.95 3217.63,-7225.2 3279.68,-7117 3305.35,-7072.24 3352.67,-7040.26 3396.19,-7018.8"/>
<polygon fill="black" stroke="black" points="3397.91,-7021.85 3405.42,-7014.37 3394.89,-7015.54 3397.91,-7021.85"/>
</g>
<!-- clean_data.main&#45;&gt;clean_data._clean_embeddings -->
<g id="edge259" class="edge">
<title>clean_data.main&#45;&gt;clean_data._clean_embeddings</title>
<path fill="none" stroke="black" d="M3078.28,-8626.81C3126.92,-8632.96 3198.09,-8649.02 3243.68,-8691 3275.08,-8719.9 3249.07,-8750.27 3279.68,-8780 3317.38,-8816.61 3373.52,-8836.51 3418.71,-8847.18"/>
<polygon fill="black" stroke="black" points="3417.94,-8850.59 3428.47,-8849.38 3419.48,-8843.76 3417.94,-8850.59"/>
</g>
<!-- clean_data.main&#45;&gt;clean_data._remove_empty_dirs -->
<g id="edge260" class="edge">
<title>clean_data.main&#45;&gt;clean_data._remove_empty_dirs</title>
<path fill="none" stroke="black" d="M3078.3,-8624.27C3128.72,-8628.51 3202.71,-8643.18 3243.68,-8691 3314.43,-8773.58 3197.33,-8861.99 3279.68,-8933 3359.68,-9001.98 3680.06,-8944.51 3826.71,-8913.57"/>
<polygon fill="black" stroke="black" points="3827.49,-8916.98 3836.54,-8911.48 3826.03,-8910.14 3827.49,-8916.98"/>
</g>
<!-- caption._identify_size -->
<g id="node156" class="node">
<title>caption._identify_size</title>
<g id="a_node156"><a xlink:title="Return ``(width, height)`` for ``path`` using ImageMagick.">
<polygon fill="none" stroke="black" points="4237.18,-3340 4123.18,-3340 4123.18,-3226 4237.18,-3226 4237.18,-3340"/>
<text text-anchor="middle" x="4180.18" y="-3279.3" font-family="Times,serif" font-size="14.00">caption._identify_size</text>
</a>
</g>
</g>
<!-- caption._prepare_image -->
<g id="node157" class="node">
<title>caption._prepare_image</title>
<g id="a_node157"><a xlink:title="Resize ``path`` and return the processed JPEG bytes.">
<polygon fill="none" stroke="black" points="3989.68,-3368 3813.68,-3368 3813.68,-3192 3989.68,-3192 3989.68,-3368"/>
<text text-anchor="middle" x="3901.68" y="-3276.3" font-family="Times,serif" font-size="14.00">caption._prepare_image</text>
</a>
</g>
</g>
<!-- caption._prepare_image&#45;&gt;caption._identify_size -->
<g id="edge261" class="edge">
<title>caption._prepare_image&#45;&gt;caption._identify_size</title>
<path fill="none" stroke="black" d="M3989.79,-3280.95C4029.58,-3281.38 4075.95,-3281.88 4112.85,-3282.28"/>
<polygon fill="black" stroke="black" points="4112.95,-3285.78 4122.99,-3282.39 4113.03,-3278.78 4112.95,-3285.78"/>
</g>
<!-- caption._guess_chat -->
<g id="node158" class="node">
<title>caption._guess_chat</title>
<g id="a_node158"><a xlink:title="Return chat name for ``path`` relative to ``MEDIA_DIR``.">
<polygon fill="none" stroke="black" points="4224.18,-3208 4136.18,-3208 4136.18,-3120 4224.18,-3120 4224.18,-3208"/>
<text text-anchor="middle" x="4180.18" y="-3160.3" font-family="Times,serif" font-size="14.00">caption._guess_chat</text>
</a>
</g>
</g>
<!-- caption.caption_file -->
<g id="node159" class="node">
<title>caption.caption_file</title>
<g id="a_node159"><a xlink:title="Caption ``path`` with GPT&#45;4o and save ``.caption.json`` beside it.">
<polygon fill="none" stroke="black" points="3646.18,-3593.5 3341.18,-3593.5 3341.18,-3288.5 3646.18,-3288.5 3646.18,-3593.5"/>
<text text-anchor="middle" x="3493.68" y="-3437.3" font-family="Times,serif" font-size="14.00">caption.caption_file</text>
</a>
</g>
</g>
<!-- caption.caption_file&#45;&gt;notes_utils.load_json -->
<g id="edge265" class="edge">
<title>caption.caption_file&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M3646.4,-3494.66C3678.36,-3505.27 3712,-3515.92 3743.68,-3525 3882.44,-3564.78 3963.22,-3492.62 4059.68,-3600 4102.2,-3647.32 4077.76,-3822.96 4095.68,-3884 4106.65,-3921.33 4124.73,-3960.63 4141.28,-3992.51"/>
<polygon fill="black" stroke="black" points="4138.37,-3994.5 4146.12,-4001.72 4144.56,-3991.24 4138.37,-3994.5"/>
</g>
<!-- caption.caption_file&#45;&gt;caption_io.caption_json_path -->
<g id="edge262" class="edge">
<title>caption.caption_file&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M3611.19,-3593.91C3649.5,-3652.92 3687.43,-3723.02 3707.68,-3793 3736.43,-3892.33 3675.52,-5576.24 3743.68,-5654 3837.32,-5760.83 3963.97,-5597.03 4059.68,-5702 4105.8,-5752.58 4077.36,-6251.05 4095.68,-6317 4107.61,-6359.93 4132.24,-6404.47 4151.67,-6435.45"/>
<polygon fill="black" stroke="black" points="4148.93,-6437.66 4157.26,-6444.22 4154.83,-6433.9 4148.93,-6437.66"/>
</g>
<!-- caption.caption_file&#45;&gt;caption_io.has_caption -->
<g id="edge263" class="edge">
<title>caption.caption_file&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M3611.54,-3593.81C3649.88,-3652.81 3687.74,-3722.92 3707.68,-3793 3760.87,-3979.92 3709.83,-7099.63 3743.68,-7291 3770.96,-7445.22 3845.32,-7617.24 3881.03,-7694.08"/>
<polygon fill="black" stroke="black" points="3877.99,-7695.83 3885.39,-7703.4 3884.33,-7692.86 3877.99,-7695.83"/>
</g>
<!-- caption.caption_file&#45;&gt;caption_io.write_caption -->
<g id="edge264" class="edge">
<title>caption.caption_file&#45;&gt;caption_io.write_caption</title>
<path fill="none" stroke="black" d="M3646.44,-3444.74C3707.97,-3446.25 3776.22,-3447.93 3826.5,-3449.17"/>
<polygon fill="black" stroke="black" points="3826.54,-3452.67 3836.63,-3449.42 3826.72,-3445.68 3826.54,-3452.67"/>
</g>
<!-- caption.caption_file&#45;&gt;caption._prepare_image -->
<g id="edge266" class="edge">
<title>caption.caption_file&#45;&gt;caption._prepare_image</title>
<path fill="none" stroke="black" d="M3646.44,-3380.82C3699.22,-3359.89 3756.95,-3337 3804.04,-3318.32"/>
<polygon fill="black" stroke="black" points="3805.61,-3321.47 3813.62,-3314.53 3803.03,-3314.96 3805.61,-3321.47"/>
</g>
<!-- caption.caption_file&#45;&gt;caption._guess_chat -->
<g id="edge267" class="edge">
<title>caption.caption_file&#45;&gt;caption._guess_chat</title>
<path fill="none" stroke="black" d="M3646.23,-3338.86C3668.77,-3319.18 3690.25,-3297.35 3707.68,-3274 3733.7,-3239.15 3708.25,-3208.23 3743.68,-3183 3803.58,-3140.34 4023.48,-3151.5 4125.96,-3159.35"/>
<polygon fill="black" stroke="black" points="4125.85,-3162.85 4136.09,-3160.14 4126.4,-3155.87 4125.85,-3162.85"/>
</g>
<!-- caption.main -->
<g id="node160" class="node">
<title>caption.main</title>
<g id="a_node160"><a xlink:title="Caption a single image provided on the command line.">
<polygon fill="none" stroke="black" points="3089.18,-3106 2959.18,-3106 2959.18,-2976 3089.18,-2976 3089.18,-3106"/>
<text text-anchor="middle" x="3024.18" y="-3037.3" font-family="Times,serif" font-size="14.00">caption.main</text>
</a>
</g>
</g>
<!-- caption.main&#45;&gt;caption.caption_file -->
<g id="edge268" class="edge">
<title>caption.main&#45;&gt;caption.caption_file</title>
<path fill="none" stroke="black" d="M3089.46,-3062.22C3137.38,-3080.88 3201.56,-3112.26 3243.68,-3158 3270.92,-3187.58 3256.55,-3208.11 3279.68,-3241 3295.54,-3263.55 3314.27,-3285.53 3333.93,-3306.18"/>
<polygon fill="black" stroke="black" points="3331.45,-3308.66 3340.92,-3313.43 3336.49,-3303.8 3331.45,-3308.66"/>
</g>
<!-- pending_chop.main -->
<g id="node161" class="node">
<title>pending_chop.main</title>
<polygon fill="none" stroke="black" points="3104.68,-5702.5 2943.68,-5702.5 2943.68,-5541.5 3104.68,-5541.5 3104.68,-5702.5"/>
<text text-anchor="middle" x="3024.18" y="-5618.3" font-family="Times,serif" font-size="14.00">pending_chop.main</text>
</g>
<!-- pending_chop.main&#45;&gt;moderation.should_skip_message -->
<g id="edge269" class="edge">
<title>pending_chop.main&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M3104.92,-5602.53C3150.26,-5588.05 3205.44,-5564.21 3243.68,-5527 3270.76,-5500.65 3250.99,-5474.58 3279.68,-5450 3323.55,-5412.42 3389.14,-5397.59 3435.93,-5391.76"/>
<polygon fill="black" stroke="black" points="3436.37,-5395.23 3445.91,-5390.61 3435.58,-5388.27 3436.37,-5395.23"/>
</g>
<!-- pending_chop.main&#45;&gt;post_io.read_post -->
<g id="edge270" class="edge">
<title>pending_chop.main&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M3104.9,-5596.45C3148.24,-5580.39 3201.45,-5557.01 3243.68,-5527 3262.91,-5513.34 3258.59,-5498.55 3279.68,-5488 3365.19,-5445.22 3639.49,-5511.02 3707.68,-5444 3753.36,-5399.11 3718.55,-5221.78 3743.74,-5146.71"/>
<polygon fill="black" stroke="black" points="3747.07,-5147.82 3747.51,-5137.23 3740.56,-5145.23 3747.07,-5147.82"/>
</g>
<!-- pending_embed._needs_embedding -->
<g id="node162" class="node">
<title>pending_embed._needs_embedding</title>
<g id="a_node162"><a xlink:title="Return ``True`` when ``emb`` is missing or stale.&#10;&#10;The function also upgrades older vector files stored as a single object and&#10;removes corrupted or mismatched ones so ``embed.py`` always operates on&#10;clean data.">
<polygon fill="none" stroke="black" points="4016.68,-3136 3786.68,-3136 3786.68,-2906 4016.68,-2906 4016.68,-3136"/>
<text text-anchor="middle" x="3901.68" y="-3017.3" font-family="Times,serif" font-size="14.00">pending_embed._needs_embedding</text>
</a>
</g>
</g>
<!-- pending_embed._needs_embedding&#45;&gt;notes_utils.load_json -->
<g id="edge271" class="edge">
<title>pending_embed._needs_embedding&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M4016.71,-3117.08C4033.93,-3137.05 4049.37,-3159.3 4059.68,-3183 4121.93,-3326.02 4057.36,-3732.8 4095.68,-3884 4105.21,-3921.57 4123.05,-3960.74 4139.81,-3992.48"/>
<polygon fill="black" stroke="black" points="4136.92,-3994.49 4144.73,-4001.65 4143.09,-3991.18 4136.92,-3994.49"/>
</g>
<!-- pending_embed._needs_embedding&#45;&gt;notes_utils.write_json -->
<g id="edge272" class="edge">
<title>pending_embed._needs_embedding&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M3966.81,-2905.96C4025.22,-2801.19 4108.69,-2651.46 4151.51,-2574.64"/>
<polygon fill="black" stroke="black" points="4154.71,-2576.08 4156.53,-2565.64 4148.6,-2572.67 4154.71,-2576.08"/>
</g>
<!-- pending_embed.main -->
<g id="node163" class="node">
<title>pending_embed.main</title>
<polygon fill="none" stroke="black" points="2768.68,-3893.5 2527.68,-3893.5 2527.68,-3652.5 2768.68,-3652.5 2768.68,-3893.5"/>
<text text-anchor="middle" x="2648.18" y="-3769.3" font-family="Times,serif" font-size="14.00">pending_embed.main</text>
</g>
<!-- pending_embed.main&#45;&gt;lot_io.read_lots -->
<g id="edge273" class="edge">
<title>pending_embed.main&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M2692.21,-3652.28C2719.69,-3569.07 2753,-3455.28 2768.68,-3352 2780.75,-3272.55 2747.16,-1962.11 2804.68,-1906 2839.6,-1871.94 3196.21,-1894.79 3243.68,-1906 3261.09,-1910.11 3262.47,-1919.12 3279.68,-1924 3371.55,-1950.03 3635.57,-1899.41 3707.68,-1962 3760.76,-2008.08 3719.55,-2049.98 3743.68,-2116 3774.13,-2199.28 3821.72,-2289.01 3856.53,-2350.02"/>
<polygon fill="black" stroke="black" points="3853.56,-2351.87 3861.57,-2358.8 3859.63,-2348.39 3853.56,-2351.87"/>
</g>
<!-- pending_embed.main&#45;&gt;lot_io.embedding_path -->
<g id="edge274" class="edge">
<title>pending_embed.main&#45;&gt;lot_io.embedding_path</title>
<path fill="none" stroke="black" d="M2768.8,-3797.63C2836.53,-3811.57 2917.86,-3828.32 2970.01,-3839.05"/>
<polygon fill="black" stroke="black" points="2969.54,-3842.53 2980.04,-3841.12 2970.95,-3835.67 2969.54,-3842.53"/>
</g>
<!-- pending_embed.main&#45;&gt;lot_io.iter_lot_files -->
<g id="edge275" class="edge">
<title>pending_embed.main&#45;&gt;lot_io.iter_lot_files</title>
<path fill="none" stroke="black" d="M2768.77,-3770.75C2931.43,-3768.75 3206.55,-3769.58 3243.68,-3797 3282.36,-3825.55 3245.82,-3864.88 3279.68,-3899 3315.99,-3935.59 3370.96,-3954.89 3415.97,-3965.02"/>
<polygon fill="black" stroke="black" points="3415.48,-3968.5 3426,-3967.17 3416.95,-3961.65 3415.48,-3968.5"/>
</g>
<!-- pending_embed.main&#45;&gt;post_io.read_post -->
<g id="edge278" class="edge">
<title>pending_embed.main&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M2766.48,-3893.54C2767.24,-3895.02 2767.97,-3896.51 2768.68,-3898 2796.45,-3956.46 2757.81,-4142.37 2804.68,-4187 2875.53,-4254.46 3173.8,-4151.53 3243.68,-4220 3303.64,-4278.74 3224.44,-4532.8 3279.68,-4596 3408.25,-4743.07 3564.71,-4562.89 3707.68,-4696 3747.19,-4732.78 3716.5,-4765.36 3743.68,-4812 3743.74,-4812.09 3743.79,-4812.19 3743.85,-4812.28"/>
<polygon fill="black" stroke="black" points="3740.95,-4814.25 3749.13,-4820.99 3746.94,-4810.62 3740.95,-4814.25"/>
</g>
<!-- pending_embed.main&#45;&gt;moderation.message_skip_reason -->
<g id="edge276" class="edge">
<title>pending_embed.main&#45;&gt;moderation.message_skip_reason</title>
<path fill="none" stroke="black" d="M2670.94,-3893.84C2699.06,-4055.79 2747.01,-4352.46 2768.68,-4608 2774.92,-4681.54 2768.42,-5871.72 2804.68,-5936 2927.93,-6154.52 3040.11,-6166.5 3279.68,-6241 3374.77,-6270.57 3655.72,-6267.89 3804.97,-6264.1"/>
<polygon fill="black" stroke="black" points="3805.14,-6267.59 3815.05,-6263.84 3804.96,-6260.6 3805.14,-6267.59"/>
</g>
<!-- pending_embed.main&#45;&gt;moderation.lot_skip_reason -->
<g id="edge277" class="edge">
<title>pending_embed.main&#45;&gt;moderation.lot_skip_reason</title>
<path fill="none" stroke="black" d="M2672.17,-3652.21C2693.19,-3578.06 2732.48,-3488.79 2804.68,-3443 2845.87,-3416.87 3207.24,-3410.58 3243.68,-3443 3346.33,-3534.31 3181.74,-3653.67 3279.68,-3750 3347.83,-3817.03 3638.23,-3727.32 3707.68,-3793 3782.54,-3863.79 3681.47,-3939.88 3743.68,-4022 3764.61,-4049.62 3798.63,-4066.97 3829.66,-4077.7"/>
<polygon fill="black" stroke="black" points="3828.58,-4081.03 3839.17,-4080.82 3830.76,-4074.38 3828.58,-4081.03"/>
</g>
<!-- pending_embed.main&#45;&gt;post_io.raw_post_path_from_lot -->
<g id="edge279" class="edge">
<title>pending_embed.main&#45;&gt;post_io.raw_post_path_from_lot</title>
<path fill="none" stroke="black" d="M2683.9,-3893.78C2720.98,-4018.86 2778.01,-4199.01 2804.68,-4220 2881.71,-4280.63 3174.85,-4193.21 3243.68,-4263 3310.71,-4330.95 3218.6,-4617.66 3279.68,-4691 3318.27,-4737.33 3389.86,-4748.62 3439.33,-4750.44"/>
<polygon fill="black" stroke="black" points="3439.44,-4753.95 3449.53,-4750.7 3439.62,-4746.95 3439.44,-4753.95"/>
</g>
<!-- pending_embed.main&#45;&gt;pending_embed._needs_embedding -->
<g id="edge280" class="edge">
<title>pending_embed.main&#45;&gt;pending_embed._needs_embedding</title>
<path fill="none" stroke="black" d="M2683.39,-3652.5C2728.84,-3492.5 2803.59,-3229.82 2804.68,-3229 2960.46,-3111.51 3051.09,-3197.75 3243.68,-3229 3260.33,-3231.7 3263.04,-3238.3 3279.68,-3241 3373.57,-3256.24 3629.22,-3294.76 3707.68,-3241 3744.25,-3215.95 3717.57,-3183.81 3743.68,-3148 3753.87,-3134.03 3765.96,-3120.73 3778.84,-3108.35"/>
<polygon fill="black" stroke="black" points="3781.6,-3110.57 3786.51,-3101.18 3776.81,-3105.46 3781.6,-3110.57"/>
</g>
<!-- check_translations.parse_po -->
<g id="node164" class="node">
<title>check_translations.parse_po</title>
<polygon fill="none" stroke="black" points="913.18,-9416 709.18,-9416 709.18,-9212 913.18,-9212 913.18,-9416"/>
<text text-anchor="middle" x="811.18" y="-9310.3" font-family="Times,serif" font-size="14.00">check_translations.parse_po</text>
</g>
<!-- check_translations.check_translations -->
<g id="node165" class="node">
<title>check_translations.check_translations</title>
<polygon fill="none" stroke="black" points="512.18,-9400.5 339.18,-9400.5 339.18,-9227.5 512.18,-9227.5 512.18,-9400.5"/>
<text text-anchor="middle" x="425.68" y="-9310.3" font-family="Times,serif" font-size="14.00">check_translations.check_translations</text>
</g>
<!-- check_translations.check_translations&#45;&gt;check_translations.parse_po -->
<g id="edge281" class="edge">
<title>check_translations.check_translations&#45;&gt;check_translations.parse_po</title>
<path fill="none" stroke="black" d="M512.27,-9314C567.26,-9314 639.25,-9314 698.69,-9314"/>
<polygon fill="black" stroke="black" points="698.88,-9317.5 708.88,-9314 698.88,-9310.5 698.88,-9317.5"/>
</g>
<!-- pending_caption._get_message_path -->
<g id="node166" class="node">
<title>pending_caption._get_message_path</title>
<g id="a_node166"><a xlink:title="Return path of stored message ``msg_id`` in ``chat`` if any.">
<polygon fill="none" stroke="black" points="3942.18,-5402.5 3861.18,-5402.5 3861.18,-5321.5 3942.18,-5321.5 3942.18,-5402.5"/>
<text text-anchor="middle" x="3901.68" y="-5358.3" font-family="Times,serif" font-size="14.00">pending_caption._get_message_path</text>
</a>
</g>
</g>
<!-- pending_caption.main -->
<g id="node167" class="node">
<title>pending_caption.main</title>
<polygon fill="none" stroke="black" points="3127.68,-5927.5 2920.68,-5927.5 2920.68,-5720.5 3127.68,-5720.5 3127.68,-5927.5"/>
<text text-anchor="middle" x="3024.18" y="-5820.3" font-family="Times,serif" font-size="14.00">pending_caption.main</text>
</g>
<!-- pending_caption.main&#45;&gt;caption_io.has_caption -->
<g id="edge282" class="edge">
<title>pending_caption.main&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M3090.72,-5927.94C3143.19,-6017.42 3212.92,-6151.97 3243.68,-6280 3262.51,-6358.35 3222.23,-7673.5 3279.68,-7730 3361.37,-7810.33 3735.42,-7760.73 3860.1,-7741.57"/>
<polygon fill="black" stroke="black" points="3860.67,-7745.02 3870.02,-7740.03 3859.6,-7738.1 3860.67,-7745.02"/>
</g>
<!-- pending_caption.main&#45;&gt;moderation.should_skip_message -->
<g id="edge283" class="edge">
<title>pending_caption.main&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M3127.9,-5793.85C3170.1,-5776.33 3215.56,-5749.83 3243.68,-5711 3302.57,-5629.69 3219.25,-5568.17 3279.68,-5488 3317.53,-5437.8 3386.85,-5411.81 3436.12,-5399.08"/>
<polygon fill="black" stroke="black" points="3437.14,-5402.43 3446.01,-5396.63 3435.46,-5395.63 3437.14,-5402.43"/>
</g>
<!-- pending_caption.main&#45;&gt;post_io.read_post -->
<g id="edge285" class="edge">
<title>pending_caption.main&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M3127.77,-5793.43C3169.81,-5775.85 3215.19,-5749.42 3243.68,-5711 3296.18,-5640.21 3214.37,-5575.17 3279.68,-5516 3350.42,-5451.92 3639.42,-5546.71 3707.68,-5480 3759.14,-5429.72 3715.98,-5229.51 3743.72,-5146.71"/>
<polygon fill="black" stroke="black" points="3747.05,-5147.8 3747.47,-5137.21 3740.54,-5145.23 3747.05,-5147.8"/>
</g>
<!-- pending_caption.main&#45;&gt;image_io.read_image_meta -->
<g id="edge284" class="edge">
<title>pending_caption.main&#45;&gt;image_io.read_image_meta</title>
<path fill="none" stroke="black" d="M3127.96,-5782.36C3166.58,-5763.86 3209.39,-5739.72 3243.68,-5711 3263.85,-5694.11 3257.74,-5678.53 3279.68,-5664 3329.27,-5631.16 3397.34,-5617.92 3443.07,-5612.59"/>
<polygon fill="black" stroke="black" points="3443.47,-5616.07 3453.04,-5611.51 3442.72,-5609.11 3443.47,-5616.07"/>
</g>
<!-- pending_caption.main&#45;&gt;pending_caption._get_message_path -->
<g id="edge286" class="edge">
<title>pending_caption.main&#45;&gt;pending_caption._get_message_path</title>
<path fill="none" stroke="black" d="M3127.71,-5792.39C3169.35,-5774.69 3214.44,-5748.44 3243.68,-5711 3286.41,-5656.28 3227.45,-5604.73 3279.68,-5559 3351.6,-5496.03 3632.23,-5574.69 3707.68,-5516 3744.64,-5487.25 3710.38,-5449.91 3743.68,-5417 3772.45,-5388.58 3816.71,-5374.79 3850.92,-5368.14"/>
<polygon fill="black" stroke="black" points="3851.96,-5371.5 3861.18,-5366.29 3850.72,-5364.61 3851.96,-5371.5"/>
</g>
<!-- embed:cli -->
<g id="node169" class="node">
<title>embed:cli</title>
<g id="a_node169"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="1077.18" cy="-9176" rx="18" ry="18"/>
<text text-anchor="middle" x="1077.18" y="-9172.3" font-family="Times,serif" font-size="14.00">embed:cli</text>
</a>
</g>
</g>
<!-- moderation:cli&#45;&gt;embed:cli -->
<!-- debug_dump:cli -->
<g id="node170" class="node">
<title>debug_dump:cli</title>
<g id="a_node170"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="1323.18" cy="-9176" rx="18" ry="18"/>
<text text-anchor="middle" x="1323.18" y="-9172.3" font-family="Times,serif" font-size="14.00">debug_dump:cli</text>
</a>
</g>
</g>
<!-- embed:cli&#45;&gt;debug_dump:cli -->
<!-- chop:cli -->
<g id="node171" class="node">
<title>chop:cli</title>
<g id="a_node171"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="1573.18" cy="-9176" rx="18" ry="18"/>
<text text-anchor="middle" x="1573.18" y="-9172.3" font-family="Times,serif" font-size="14.00">chop:cli</text>
</a>
</g>
</g>
<!-- debug_dump:cli&#45;&gt;chop:cli -->
<!-- telegram_bot:cli -->
<g id="node172" class="node">
<title>telegram_bot:cli</title>
<g id="a_node172"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="1939.18" cy="-9176" rx="44" ry="44"/>
<text text-anchor="middle" x="1939.18" y="-9172.3" font-family="Times,serif" font-size="14.00">telegram_bot:cli</text>
</a>
</g>
</g>
<!-- chop:cli&#45;&gt;telegram_bot:cli -->
<!-- scan_ontology:cli -->
<g id="node173" class="node">
<title>scan_ontology:cli</title>
<g id="a_node173"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="96.84" cy="-9452" rx="18" ry="18"/>
<text text-anchor="middle" x="96.84" y="-9448.3" font-family="Times,serif" font-size="14.00">scan_ontology:cli</text>
</a>
</g>
</g>
<!-- tg_client:cli -->
<g id="node174" class="node">
<title>tg_client:cli</title>
<g id="a_node174"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="425.68" cy="-9452" rx="18" ry="18"/>
<text text-anchor="middle" x="425.68" y="-9448.3" font-family="Times,serif" font-size="14.00">tg_client:cli</text>
</a>
</g>
</g>
<!-- scan_ontology:cli&#45;&gt;tg_client:cli -->
<!-- clean_data:cli -->
<g id="node175" class="node">
<title>clean_data:cli</title>
<g id="a_node175"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="811.18" cy="-9452" rx="18" ry="18"/>
<text text-anchor="middle" x="811.18" y="-9448.3" font-family="Times,serif" font-size="14.00">clean_data:cli</text>
</a>
</g>
</g>
<!-- tg_client:cli&#45;&gt;clean_data:cli -->
<!-- caption:cli -->
<g id="node176" class="node">
<title>caption:cli</title>
<g id="a_node176"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="1077.18" cy="-9452" rx="18" ry="18"/>
<text text-anchor="middle" x="1077.18" y="-9448.3" font-family="Times,serif" font-size="14.00">caption:cli</text>
</a>
</g>
</g>
<!-- clean_data:cli&#45;&gt;caption:cli -->
<!-- pending_chop:cli -->
<g id="node177" class="node">
<title>pending_chop:cli</title>
<g id="a_node177"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="1323.18" cy="-9452" rx="18" ry="18"/>
<text text-anchor="middle" x="1323.18" y="-9448.3" font-family="Times,serif" font-size="14.00">pending_chop:cli</text>
</a>
</g>
</g>
<!-- caption:cli&#45;&gt;pending_chop:cli -->
<!-- pending_embed:cli -->
<g id="node178" class="node">
<title>pending_embed:cli</title>
<g id="a_node178"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="1573.18" cy="-9452" rx="18" ry="18"/>
<text text-anchor="middle" x="1573.18" y="-9448.3" font-family="Times,serif" font-size="14.00">pending_embed:cli</text>
</a>
</g>
</g>
<!-- pending_chop:cli&#45;&gt;pending_embed:cli -->
<!-- check_translations:cli -->
<g id="node179" class="node">
<title>check_translations:cli</title>
<g id="a_node179"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="1939.18" cy="-9452" rx="18" ry="18"/>
<text text-anchor="middle" x="1939.18" y="-9448.3" font-family="Times,serif" font-size="14.00">check_translations:cli</text>
</a>
</g>
</g>
<!-- pending_embed:cli&#45;&gt;check_translations:cli -->
<!-- pending_caption:cli -->
<g id="node180" class="node">
<title>pending_caption:cli</title>
<g id="a_node180"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="96.84" cy="-9506" rx="18" ry="18"/>
<text text-anchor="middle" x="96.84" y="-9502.3" font-family="Times,serif" font-size="14.00">pending_caption:cli</text>
</a>
</g>
</g>
<!-- build_site -->
<g id="node181" class="node">
<title>build_site</title>
<ellipse fill="none" stroke="black" cx="1939.18" cy="-1092" rx="55.79" ry="18"/>
<text text-anchor="middle" x="1939.18" y="-1088.3" font-family="Times,serif" font-size="14.00">build_site</text>
</g>
<!-- build_site&#45;&gt;build_site.main -->
<g id="edge298" class="edge">
<title>build_site:cli&#45;&gt;build_site.main</title>
<path fill="none" stroke="black" d="M1995.13,-1092C2050.69,-1092 2138.89,-1092 2214.33,-1092"/>
<polygon fill="black" stroke="black" points="2214.41,-1095.5 2224.41,-1092 2214.41,-1088.5 2214.41,-1095.5"/>
</g>
<!-- caption -->
<g id="node182" class="node">
<title>caption</title>
<ellipse fill="none" stroke="black" cx="2648.18" cy="-3083" rx="44.69" ry="18"/>
<text text-anchor="middle" x="2648.18" y="-3079.3" font-family="Times,serif" font-size="14.00">caption</text>
</g>
<!-- caption&#45;&gt;caption.main -->
<g id="edge299" class="edge">
<title>caption:cli&#45;&gt;caption.main</title>
<path fill="none" stroke="black" d="M2691.72,-3078.22C2754.29,-3071.2 2872.04,-3057.97 2949.03,-3049.33"/>
<polygon fill="black" stroke="black" points="2949.6,-3052.79 2959.14,-3048.19 2948.82,-3045.83 2949.6,-3052.79"/>
</g>
<!-- check_translations -->
<g id="node183" class="node">
<title>check_translations</title>
<ellipse fill="none" stroke="black" cx="96.84" cy="-9314" rx="96.68" ry="18"/>
<text text-anchor="middle" x="96.84" y="-9310.3" font-family="Times,serif" font-size="14.00">check_translations</text>
</g>
<!-- check_translations&#45;&gt;check_translations.check_translations -->
<g id="edge300" class="edge">
<title>check_translations:cli&#45;&gt;check_translations.check_translations</title>
<path fill="none" stroke="black" d="M193.7,-9314C236.33,-9314 286.42,-9314 329.03,-9314"/>
<polygon fill="black" stroke="black" points="329.13,-9317.5 339.13,-9314 329.13,-9310.5 329.13,-9317.5"/>
</g>
<!-- chop -->
<g id="node184" class="node">
<title>chop</title>
<ellipse fill="none" stroke="black" cx="2358.18" cy="-5265" rx="32.49" ry="18"/>
<text text-anchor="middle" x="2358.18" y="-5261.3" font-family="Times,serif" font-size="14.00">chop</text>
</g>
<!-- chop&#45;&gt;chop.main -->
<g id="edge301" class="edge">
<title>chop:cli&#45;&gt;chop.main</title>
<path fill="none" stroke="black" d="M2390.83,-5265C2434.34,-5265 2513.95,-5265 2572.95,-5265"/>
<polygon fill="black" stroke="black" points="2572.97,-5268.5 2582.97,-5265 2572.97,-5261.5 2572.97,-5268.5"/>
</g>
<!-- clean_data -->
<g id="node185" class="node">
<title>clean_data</title>
<ellipse fill="none" stroke="black" cx="2648.18" cy="-8623" rx="59.59" ry="18"/>
<text text-anchor="middle" x="2648.18" y="-8619.3" font-family="Times,serif" font-size="14.00">clean_data</text>
</g>
<!-- clean_data&#45;&gt;clean_data.main -->
<g id="edge302" class="edge">
<title>clean_data:cli&#45;&gt;clean_data.main</title>
<path fill="none" stroke="black" d="M2708.03,-8623C2776.66,-8623 2889.64,-8623 2960.05,-8623"/>
<polygon fill="black" stroke="black" points="2960.12,-8626.5 2970.12,-8623 2960.12,-8619.5 2960.12,-8626.5"/>
</g>
<!-- debug_dump -->
<g id="node186" class="node">
<title>debug_dump</title>
<ellipse fill="none" stroke="black" cx="2648.18" cy="-8104" rx="70.39" ry="18"/>
<text text-anchor="middle" x="2648.18" y="-8100.3" font-family="Times,serif" font-size="14.00">debug_dump</text>
</g>
<!-- debug_dump&#45;&gt;debug_dump.main -->
<g id="edge303" class="edge">
<title>debug_dump:cli&#45;&gt;debug_dump.main</title>
<path fill="none" stroke="black" d="M2718.65,-8104C2766.08,-8104 2830.47,-8104 2887.83,-8104"/>
<polygon fill="black" stroke="black" points="2888.08,-8107.5 2898.08,-8104 2888.08,-8100.5 2888.08,-8107.5"/>
</g>
<!-- embed -->
<g id="node187" class="node">
<title>embed</title>
<ellipse fill="none" stroke="black" cx="2648.18" cy="-2632" rx="42.49" ry="18"/>
<text text-anchor="middle" x="2648.18" y="-2628.3" font-family="Times,serif" font-size="14.00">embed</text>
</g>
<!-- embed&#45;&gt;embed.main -->
<g id="edge304" class="edge">
<title>embed:cli&#45;&gt;embed.main</title>
<path fill="none" stroke="black" d="M2690.64,-2631.89C2752.89,-2631.72 2871.45,-2631.41 2948.88,-2631.2"/>
<polygon fill="black" stroke="black" points="2949.07,-2634.7 2959.06,-2631.17 2949.05,-2627.7 2949.07,-2634.7"/>
</g>
<!-- moderation -->
<g id="node188" class="node">
<title>moderation</title>
<ellipse fill="none" stroke="black" cx="2648.18" cy="-4635" rx="63.89" ry="18"/>
<text text-anchor="middle" x="2648.18" y="-4631.3" font-family="Times,serif" font-size="14.00">moderation</text>
</g>
<!-- moderation&#45;&gt;moderation.apply_to_history -->
<g id="edge305" class="edge">
<title>moderation:cli&#45;&gt;moderation.apply_to_history</title>
<path fill="none" stroke="black" d="M2700.01,-4645.47C2721.32,-4650.13 2746.31,-4655.92 2768.68,-4662 2821.22,-4676.27 2879.1,-4694.49 2926.37,-4710.03"/>
<polygon fill="black" stroke="black" points="2925.39,-4713.39 2935.98,-4713.2 2927.59,-4706.75 2925.39,-4713.39"/>
</g>
<!-- pending_caption -->
<g id="node189" class="node">
<title>pending_caption</title>
<ellipse fill="none" stroke="black" cx="2648.18" cy="-5824" rx="87.18" ry="18"/>
<text text-anchor="middle" x="2648.18" y="-5820.3" font-family="Times,serif" font-size="14.00">pending_caption</text>
</g>
<!-- pending_caption&#45;&gt;pending_caption.main -->
<g id="edge306" class="edge">
<title>pending_caption:cli&#45;&gt;pending_caption.main</title>
<path fill="none" stroke="black" d="M2735.46,-5824C2787.34,-5824 2853.98,-5824 2910.06,-5824"/>
<polygon fill="black" stroke="black" points="2910.4,-5827.5 2920.4,-5824 2910.4,-5820.5 2910.4,-5827.5"/>
</g>
<!-- pending_chop -->
<g id="node190" class="node">
<title>pending_chop</title>
<ellipse fill="none" stroke="black" cx="2648.18" cy="-5622" rx="74.99" ry="18"/>
<text text-anchor="middle" x="2648.18" y="-5618.3" font-family="Times,serif" font-size="14.00">pending_chop</text>
</g>
<!-- pending_chop&#45;&gt;pending_chop.main -->
<g id="edge307" class="edge">
<title>pending_chop:cli&#45;&gt;pending_chop.main</title>
<path fill="none" stroke="black" d="M2723.07,-5622C2783.49,-5622 2869.15,-5622 2933.49,-5622"/>
<polygon fill="black" stroke="black" points="2933.63,-5625.5 2943.63,-5622 2933.63,-5618.5 2933.63,-5625.5"/>
</g>
<!-- pending_embed -->
<g id="node191" class="node">
<title>pending_embed</title>
<ellipse fill="none" stroke="black" cx="2358.18" cy="-3773" rx="83.69" ry="18"/>
<text text-anchor="middle" x="2358.18" y="-3769.3" font-family="Times,serif" font-size="14.00">pending_embed</text>
</g>
<!-- pending_embed&#45;&gt;pending_embed.main -->
<g id="edge308" class="edge">
<title>pending_embed:cli&#45;&gt;pending_embed.main</title>
<path fill="none" stroke="black" d="M2442.1,-3773C2465.64,-3773 2491.86,-3773 2517.47,-3773"/>
<polygon fill="black" stroke="black" points="2517.63,-3776.5 2527.63,-3773 2517.63,-3769.5 2517.63,-3776.5"/>
</g>
<!-- scan_ontology -->
<g id="node192" class="node">
<title>scan_ontology</title>
<ellipse fill="none" stroke="black" cx="2358.18" cy="-2482" rx="76.09" ry="18"/>
<text text-anchor="middle" x="2358.18" y="-2478.3" font-family="Times,serif" font-size="14.00">scan_ontology</text>
</g>
<!-- scan_ontology&#45;&gt;scan_ontology.main -->
<g id="edge309" class="edge">
<title>scan_ontology:cli&#45;&gt;scan_ontology.main</title>
<path fill="none" stroke="black" d="M2434.48,-2482C2461.8,-2482 2493.44,-2482 2523.83,-2482"/>
<polygon fill="black" stroke="black" points="2524.08,-2485.5 2534.08,-2482 2524.08,-2478.5 2524.08,-2485.5"/>
</g>
<!-- telegram_bot -->
<g id="node193" class="node">
<title>telegram_bot</title>
<ellipse fill="none" stroke="black" cx="1939.18" cy="-3658" rx="72.29" ry="18"/>
<text text-anchor="middle" x="1939.18" y="-3654.3" font-family="Times,serif" font-size="14.00">telegram_bot</text>
</g>
<!-- telegram_bot&#45;&gt;telegram_bot.send_alert -->
<g id="edge310" class="edge">
<title>telegram_bot:cli&#45;&gt;telegram_bot.send_alert</title>
<path fill="none" stroke="black" d="M1963.5,-3640.95C2024.16,-3596.58 2188.88,-3476.1 2284.94,-3405.84"/>
<polygon fill="black" stroke="black" points="2287.16,-3408.55 2293.16,-3399.82 2283.03,-3402.9 2287.16,-3408.55"/>
</g>
<!-- telegram_bot&#45;&gt;telegram_bot.main -->
<g id="edge311" class="edge">
<title>telegram_bot:cli&#45;&gt;telegram_bot.main</title>
<path fill="none" stroke="black" d="M1966.58,-3674.71C2025.32,-3711.9 2169.18,-3802.98 2264.94,-3863.6"/>
<polygon fill="black" stroke="black" points="2263.16,-3866.61 2273.48,-3869.01 2266.9,-3860.7 2263.16,-3866.61"/>
</g>
<!-- tg_client -->
<g id="node194" class="node">
<title>tg_client</title>
<ellipse fill="none" stroke="black" cx="96.84" cy="-6911" rx="50.89" ry="18"/>
<text text-anchor="middle" x="96.84" y="-6907.3" font-family="Times,serif" font-size="14.00">tg_client</text>
</g>
<!-- tg_client&#45;&gt;tg_client.main -->
<g id="edge312" class="edge">
<title>tg_client:cli&#45;&gt;tg_client.main</title>
<path fill="none" stroke="black" d="M147.84,-6911C168.05,-6911 192.84,-6911 219.2,-6911"/>
<polygon fill="black" stroke="black" points="219.37,-6914.5 229.37,-6911 219.37,-6907.5 219.37,-6914.5"/>
</g>
</g>
</svg>
