<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: callgraph Pages: 1 -->
<svg width="10064pt" height="5946pt"
 viewBox="0.00 0.00 10064.00 5945.99" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 5941.99)">
<title>callgraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-5941.99 10060,-5941.99 10060,4 -4,4"/>
<!-- similar._iter_lots -->
<g id="node1" class="node">
<title>similar._iter_lots</title>
<g id="a_node1"><a xlink:title="Return lots filtered by moderation rules.">
<polygon fill="none" stroke="black" points="7392,-3108.99 7084,-3108.99 7084,-3061.99 7392,-3061.99 7392,-3108.99"/>
<text text-anchor="middle" x="7238" y="-3076.99" font-family="Times,serif" font-size="35.00">similar._iter_lots</text>
</a>
</g>
</g>
<!-- post_io.read_post -->
<g id="node2" class="node">
<title>post_io.read_post</title>
<g id="a_node2"><a xlink:title="Return metadata dictionary and body text for ``path``.">
<polygon fill="none" stroke="black" points="8583.5,-3071.49 8025.5,-3071.49 8025.5,-2995.49 8583.5,-2995.49 8583.5,-3071.49"/>
<text text-anchor="middle" x="8304.5" y="-3018.32" font-family="Times,serif" font-size="61.46">post_io.read_post</text>
</a>
</g>
</g>
<!-- similar._iter_lots&#45;&gt;post_io.read_post -->
<g id="edge1" class="edge">
<title>similar._iter_lots&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7392.08,-3078.01C7554.32,-3070.09 7814.32,-3057.39 8015.18,-3047.58"/>
<polygon fill="black" stroke="black" points="8015.48,-3051.07 8025.3,-3047.08 8015.14,-3044.07 8015.48,-3051.07"/>
</g>
<!-- post_io.raw_post_path -->
<g id="node3" class="node">
<title>post_io.raw_post_path</title>
<g id="a_node3"><a xlink:title="Return absolute message path for ``rel`` under ``root``.">
<polygon fill="none" stroke="black" points="8381,-3375.49 8228,-3375.49 8228,-3339.49 8381,-3339.49 8381,-3375.49"/>
<text text-anchor="middle" x="8304.5" y="-3354.25" font-family="Times,serif" font-size="12.18">post_io.raw_post_path</text>
</a>
</g>
</g>
<!-- similar._iter_lots&#45;&gt;post_io.raw_post_path -->
<g id="edge2" class="edge">
<title>similar._iter_lots&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7392.06,-3064C7505.68,-3055.07 7661.34,-3058.05 7783,-3117.49 7804.79,-3128.14 7799.26,-3144.4 7819,-3158.49 7946.31,-3249.38 8121.29,-3307.98 8222.4,-3336.64"/>
<polygon fill="black" stroke="black" points="8221.67,-3340.07 8232.24,-3339.4 8223.56,-3333.33 8221.67,-3340.07"/>
</g>
<!-- moderation.should_skip_message -->
<g id="node4" class="node">
<title>moderation.should_skip_message</title>
<g id="a_node4"><a xlink:title="Return ``True`` when the raw Telegram message should be ignored.">
<polygon fill="none" stroke="black" points="8471.5,-4134.49 8137.5,-4134.49 8137.5,-4098.49 8471.5,-4098.49 8471.5,-4134.49"/>
<text text-anchor="middle" x="8304.5" y="-4111.71" font-family="Times,serif" font-size="18.48">moderation.should_skip_message</text>
</a>
</g>
</g>
<!-- similar._iter_lots&#45;&gt;moderation.should_skip_message -->
<g id="edge3" class="edge">
<title>similar._iter_lots&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M7392.12,-3072.61C7533.88,-3064.43 7730.45,-3063.85 7783,-3117.49 7856.38,-3192.4 7747.76,-3983.55 7819,-4060.49 7918.86,-4168.34 8106.05,-4155.68 8216.23,-4136.35"/>
<polygon fill="black" stroke="black" points="8217.1,-4139.75 8226.32,-4134.53 8215.86,-4132.86 8217.1,-4139.75"/>
</g>
<!-- moderation.should_skip_lot -->
<g id="node5" class="node">
<title>moderation.should_skip_lot</title>
<g id="a_node5"><a xlink:title="Return ``True`` when the lot fails additional checks.">
<polygon fill="none" stroke="black" points="8442.5,-3149.49 8166.5,-3149.49 8166.5,-3113.49 8442.5,-3113.49 8442.5,-3149.49"/>
<text text-anchor="middle" x="8304.5" y="-3126.71" font-family="Times,serif" font-size="18.48">moderation.should_skip_lot</text>
</a>
</g>
</g>
<!-- similar._iter_lots&#45;&gt;moderation.should_skip_lot -->
<g id="edge4" class="edge">
<title>similar._iter_lots&#45;&gt;moderation.should_skip_lot</title>
<path fill="none" stroke="black" d="M7392.08,-3092.11C7596.19,-3100.93 7955.02,-3116.43 8156.17,-3125.13"/>
<polygon fill="black" stroke="black" points="8156.08,-3128.63 8166.22,-3125.56 8156.38,-3121.63 8156.08,-3128.63"/>
</g>
<!-- lot_io.read_lots -->
<g id="node6" class="node">
<title>lot_io.read_lots</title>
<g id="a_node6"><a xlink:title="Return a list of lots from ``path`` or ``None`` when invalid.">
<polygon fill="none" stroke="black" points="8410.5,-3727.49 8198.5,-3727.49 8198.5,-3691.49 8410.5,-3691.49 8410.5,-3727.49"/>
<text text-anchor="middle" x="8304.5" y="-3703.33" font-family="Times,serif" font-size="25.20">lot_io.read_lots</text>
</a>
</g>
</g>
<!-- similar._iter_lots&#45;&gt;lot_io.read_lots -->
<g id="edge5" class="edge">
<title>similar._iter_lots&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M7392.14,-3072.91C7533.64,-3064.98 7729.77,-3064.61 7783,-3117.49 7869.89,-3203.82 7733.31,-3579.97 7819,-3667.49 7924.68,-3775.43 8119.29,-3753.01 8226.91,-3729.72"/>
<polygon fill="black" stroke="black" points="8227.73,-3733.13 8236.73,-3727.54 8226.21,-3726.29 8227.73,-3733.13"/>
</g>
<!-- lot_io.iter_lot_files -->
<g id="node7" class="node">
<title>lot_io.iter_lot_files</title>
<g id="a_node7"><a xlink:title="Return ``*.json`` files under ``root``.&#10;&#10;When ``newest_first`` is ``True`` the result is ordered by modification&#10;time with the most recently changed files first. &#160;Both ``build_site.py`` and&#10;``pending_embed.py`` rely on this helper so they scan the lot directory in&#10;the same order.">
<polygon fill="none" stroke="black" points="8433,-1635.99 8176,-1635.99 8176,-1598.99 8433,-1598.99 8433,-1635.99"/>
<text text-anchor="middle" x="8304.5" y="-1611.05" font-family="Times,serif" font-size="26.18">lot_io.iter_lot_files</text>
</a>
</g>
</g>
<!-- similar._iter_lots&#45;&gt;lot_io.iter_lot_files -->
<g id="edge6" class="edge">
<title>similar._iter_lots&#45;&gt;lot_io.iter_lot_files</title>
<path fill="none" stroke="black" d="M7392.25,-3086.83C7534.68,-3084.45 7732.23,-3070.67 7783,-3014.49 7876.53,-2910.99 7733.78,-1869.94 7819,-1759.49 7899.63,-1655 8053.04,-1624.3 8165.71,-1616.74"/>
<polygon fill="black" stroke="black" points="8166.03,-1620.23 8175.79,-1616.12 8165.6,-1613.24 8166.03,-1620.23"/>
</g>
<!-- notes_utils.read_md -->
<g id="node58" class="node">
<title>notes_utils.read_md</title>
<g id="a_node58"><a xlink:title="Alias for :func:`read_text` used for Markdown files.">
<polygon fill="none" stroke="black" points="9225.5,-3284.49 9085.5,-3284.49 9085.5,-3248.49 9225.5,-3248.49 9225.5,-3284.49"/>
<text text-anchor="middle" x="9155.5" y="-3263.25" font-family="Times,serif" font-size="12.18">notes_utils.read_md</text>
</a>
</g>
</g>
<!-- post_io.read_post&#45;&gt;notes_utils.read_md -->
<g id="edge99" class="edge">
<title>post_io.read_post&#45;&gt;notes_utils.read_md</title>
<path fill="none" stroke="black" d="M8583.73,-3061.01C8651.96,-3071.37 8724.27,-3085.46 8790,-3104.49 8912.29,-3139.91 9046.93,-3208.01 9113.11,-3243.58"/>
<polygon fill="black" stroke="black" points="9111.52,-3246.7 9121.98,-3248.38 9114.85,-3240.55 9111.52,-3246.7"/>
</g>
<!-- notes_utils._parse_block -->
<g id="node68" class="node">
<title>notes_utils._parse_block</title>
<g id="a_node68"><a xlink:title="Return metadata dict and remaining body from ``text``.">
<polygon fill="none" stroke="black" points="9324.5,-3572.99 8986.5,-3572.99 8986.5,-3535.99 9324.5,-3535.99 9324.5,-3572.99"/>
<text text-anchor="middle" x="9155.5" y="-3548.05" font-family="Times,serif" font-size="26.18">notes_utils._parse_block</text>
</a>
</g>
</g>
<!-- post_io.read_post&#45;&gt;notes_utils._parse_block -->
<g id="edge100" class="edge">
<title>post_io.read_post&#45;&gt;notes_utils._parse_block</title>
<path fill="none" stroke="black" d="M8583.72,-3017.68C8659.11,-3027.27 8734.99,-3051.78 8790,-3104.49 8851.74,-3163.65 8781.76,-3220.32 8826,-3293.49 8895.21,-3407.96 9034.17,-3492.51 9107.2,-3531.16"/>
<polygon fill="black" stroke="black" points="9105.71,-3534.34 9116.19,-3535.87 9108.95,-3528.13 9105.71,-3534.34"/>
</g>
<!-- moderation.message_skip_reason -->
<g id="node143" class="node">
<title>moderation.message_skip_reason</title>
<g id="a_node143"><a xlink:title="Return the moderation reason for ``meta`` and ``text`` or ``None``.">
<polygon fill="none" stroke="black" points="9450.5,-4213.99 8860.5,-4213.99 8860.5,-4168.99 9450.5,-4168.99 9450.5,-4213.99"/>
<text text-anchor="middle" x="9155.5" y="-4183.11" font-family="Times,serif" font-size="33.60">moderation.message_skip_reason</text>
</a>
</g>
</g>
<!-- moderation.should_skip_message&#45;&gt;moderation.message_skip_reason -->
<g id="edge245" class="edge">
<title>moderation.should_skip_message&#45;&gt;moderation.message_skip_reason</title>
<path fill="none" stroke="black" d="M8471.72,-4131.18C8590.51,-4141.67 8752.85,-4156.01 8889.43,-4168.08"/>
<polygon fill="black" stroke="black" points="8889.36,-4171.58 8899.63,-4168.98 8889.98,-4164.61 8889.36,-4171.58"/>
</g>
<!-- moderation.lot_skip_reason -->
<g id="node144" class="node">
<title>moderation.lot_skip_reason</title>
<g id="a_node144"><a xlink:title="Return the moderation reason for ``lot`` or ``None``.">
<polygon fill="none" stroke="black" points="9332,-1466.49 8979,-1466.49 8979,-1430.49 9332,-1430.49 9332,-1466.49"/>
<text text-anchor="middle" x="9155.5" y="-1442.62" font-family="Times,serif" font-size="24.22">moderation.lot_skip_reason</text>
</a>
</g>
</g>
<!-- moderation.should_skip_lot&#45;&gt;moderation.lot_skip_reason -->
<g id="edge246" class="edge">
<title>moderation.should_skip_lot&#45;&gt;moderation.lot_skip_reason</title>
<path fill="none" stroke="black" d="M8377.35,-3149.51C8484.71,-3171.62 8685.51,-3193.53 8790,-3080.49 8841.57,-3024.71 8792.33,-1781.59 8826,-1713.49 8885.64,-1592.86 9028.76,-1508.93 9104.9,-1471.12"/>
<polygon fill="black" stroke="black" points="9106.85,-1474.07 9114.29,-1466.53 9103.77,-1467.78 9106.85,-1474.07"/>
</g>
<!-- notes_utils.load_json -->
<g id="node24" class="node">
<title>notes_utils.load_json</title>
<g id="a_node24"><a xlink:title="Return parsed JSON or ``None`` when invalid.">
<polygon fill="none" stroke="black" points="9279.5,-1412.49 9031.5,-1412.49 9031.5,-1376.49 9279.5,-1376.49 9279.5,-1412.49"/>
<text text-anchor="middle" x="9155.5" y="-1388.8" font-family="Times,serif" font-size="22.12">notes_utils.load_json</text>
</a>
</g>
</g>
<!-- lot_io.read_lots&#45;&gt;notes_utils.load_json -->
<g id="edge254" class="edge">
<title>lot_io.read_lots&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M8370.35,-3727.56C8475.68,-3752.49 8682.94,-3782.38 8790,-3667.49 8875.08,-3576.2 8740.72,-1512.6 8826,-1421.49 8888.13,-1355.12 8999.66,-1360.73 9075.34,-1374.54"/>
<polygon fill="black" stroke="black" points="9074.84,-1378.01 9085.31,-1376.44 9076.15,-1371.13 9074.84,-1378.01"/>
</g>
<!-- lot_io._clean_lot -->
<g id="node146" class="node">
<title>lot_io._clean_lot</title>
<g id="a_node146"><a xlink:title="Return ``lot`` without empty or null fields.">
<polygon fill="none" stroke="black" points="9213,-3924.49 9098,-3924.49 9098,-3888.49 9213,-3888.49 9213,-3924.49"/>
<text text-anchor="middle" x="9155.5" y="-3903.25" font-family="Times,serif" font-size="12.18">lot_io._clean_lot</text>
</a>
</g>
</g>
<!-- lot_io.read_lots&#45;&gt;lot_io._clean_lot -->
<g id="edge255" class="edge">
<title>lot_io.read_lots&#45;&gt;lot_io._clean_lot</title>
<path fill="none" stroke="black" d="M8383.09,-3727.5C8548.42,-3765.86 8932.93,-3855.08 9087.95,-3891.05"/>
<polygon fill="black" stroke="black" points="9087.29,-3894.49 9097.82,-3893.34 9088.87,-3887.67 9087.29,-3894.49"/>
</g>
<!-- similar.main -->
<g id="node8" class="node">
<title>similar.main</title>
<g id="a_node8"><a xlink:title="Update ``data/similar`` using available embeddings.">
<polygon fill="none" stroke="black" points="6239,-630.49 6029,-630.49 6029,-588.49 6239,-588.49 6239,-630.49"/>
<text text-anchor="middle" x="6134" y="-601.4" font-family="Times,serif" font-size="31.36">similar.main</text>
</a>
</g>
</g>
<!-- similar.main&#45;&gt;similar._iter_lots -->
<g id="edge7" class="edge">
<title>similar.main&#45;&gt;similar._iter_lots</title>
<path fill="none" stroke="black" d="M6239.22,-606.45C6361.46,-609.21 6559.73,-634.77 6657,-762.49 6732.81,-862.04 6609.7,-2921.13 6693,-3014.49 6742.27,-3069.71 6932.17,-3084.05 7073.82,-3086.8"/>
<polygon fill="black" stroke="black" points="7073.87,-3090.3 7083.93,-3086.98 7073.99,-3083.3 7073.87,-3090.3"/>
</g>
<!-- similar_utils._load_embeddings -->
<g id="node9" class="node">
<title>similar_utils._load_embeddings</title>
<g id="a_node9"><a xlink:title="Return mapping of lot id to embedding vector.&#10;&#10;Vectors are stored as ``numpy.float16`` arrays which halves the&#10;memory footprint compared to ``float32`` and drastically reduces&#10;memory usage compared to plain Python lists.">
<polygon fill="none" stroke="black" points="8590.5,-967.99 8018.5,-967.99 8018.5,-920.99 8590.5,-920.99 8590.5,-967.99"/>
<text text-anchor="middle" x="8304.5" y="-935.99" font-family="Times,serif" font-size="35.00">similar_utils._load_embeddings</text>
</a>
</g>
</g>
<!-- similar.main&#45;&gt;similar_utils._load_embeddings -->
<g id="edge8" class="edge">
<title>similar.main&#45;&gt;similar_utils._load_embeddings</title>
<path fill="none" stroke="black" d="M6239.05,-601.5C6351.06,-593.32 6534.52,-581.17 6693,-576.49 6814.06,-572.92 7692.9,-495.56 7783,-576.49 7838.7,-626.53 7765.03,-859.59 7819,-911.49 7848.34,-939.71 7924.5,-951.34 8007.97,-954.87"/>
<polygon fill="black" stroke="black" points="8008.06,-958.38 8018.18,-955.26 8008.32,-951.38 8008.06,-958.38"/>
</g>
<!-- similar_utils._load_similar -->
<g id="node10" class="node">
<title>similar_utils._load_similar</title>
<g id="a_node10"><a xlink:title="Return cached similar lots mapping.">
<polygon fill="none" stroke="black" points="7487,-633.49 6989,-633.49 6989,-585.49 7487,-585.49 7487,-633.49"/>
<text text-anchor="middle" x="7238" y="-600.37" font-family="Times,serif" font-size="36.40">similar_utils._load_similar</text>
</a>
</g>
</g>
<!-- similar.main&#45;&gt;similar_utils._load_similar -->
<g id="edge9" class="edge">
<title>similar.main&#45;&gt;similar_utils._load_similar</title>
<path fill="none" stroke="black" d="M6239.17,-609.49C6407.3,-609.49 6743.43,-609.49 6978.91,-609.49"/>
<polygon fill="black" stroke="black" points="6979,-612.99 6989,-609.49 6979,-605.99 6979,-612.99"/>
</g>
<!-- similar_utils._save_similar -->
<g id="node11" class="node">
<title>similar_utils._save_similar</title>
<g id="a_node11"><a xlink:title="Write ``sim_map`` to ``SIMILAR_DIR`` mirroring ``LOTS_DIR`` layout.">
<polygon fill="none" stroke="black" points="7386,-1590.49 7090,-1590.49 7090,-1554.49 7386,-1554.49 7386,-1590.49"/>
<text text-anchor="middle" x="7238" y="-1567.19" font-family="Times,serif" font-size="21.00">similar_utils._save_similar</text>
</a>
</g>
</g>
<!-- similar.main&#45;&gt;similar_utils._save_similar -->
<g id="edge10" class="edge">
<title>similar.main&#45;&gt;similar_utils._save_similar</title>
<path fill="none" stroke="black" d="M6239,-607.05C6360.55,-610.44 6557.66,-636.68 6657,-762.49 6754.21,-885.61 6590.08,-1349.1 6693,-1467.49 6786.85,-1575.46 6955.26,-1593.42 7079.92,-1589.51"/>
<polygon fill="black" stroke="black" points="7080.08,-1593 7089.95,-1589.14 7079.83,-1586.01 7080.08,-1593"/>
</g>
<!-- similar_utils._save_more_user -->
<g id="node12" class="node">
<title>similar_utils._save_more_user</title>
<g id="a_node12"><a xlink:title="Write ``more_map`` to ``MORE_USER_DIR`` mirroring ``LOTS_DIR`` layout.">
<polygon fill="none" stroke="black" points="7405.5,-1458.49 7070.5,-1458.49 7070.5,-1422.49 7405.5,-1422.49 7405.5,-1458.49"/>
<text text-anchor="middle" x="7238" y="-1435.19" font-family="Times,serif" font-size="21.00">similar_utils._save_more_user</text>
</a>
</g>
</g>
<!-- similar.main&#45;&gt;similar_utils._save_more_user -->
<g id="edge11" class="edge">
<title>similar.main&#45;&gt;similar_utils._save_more_user</title>
<path fill="none" stroke="black" d="M6239.02,-607.26C6360.33,-610.88 6556.98,-637.36 6657,-762.49 6736.38,-861.81 6609.19,-1237.89 6693,-1333.49 6782.41,-1435.48 6938.22,-1457.61 7060.23,-1456.9"/>
<polygon fill="black" stroke="black" points="7060.48,-1460.4 7070.44,-1456.79 7060.4,-1453.4 7060.48,-1460.4"/>
</g>
<!-- similar_utils._prune_similar -->
<g id="node13" class="node">
<title>similar_utils._prune_similar</title>
<g id="a_node13"><a xlink:title="Drop cache entries referring to ids not in ``valid_ids``.">
<polygon fill="none" stroke="black" points="7377,-529.49 7099,-529.49 7099,-493.49 7377,-493.49 7377,-529.49"/>
<text text-anchor="middle" x="7238" y="-506.71" font-family="Times,serif" font-size="18.48">similar_utils._prune_similar</text>
</a>
</g>
</g>
<!-- similar.main&#45;&gt;similar_utils._prune_similar -->
<g id="edge12" class="edge">
<title>similar.main&#45;&gt;similar_utils._prune_similar</title>
<path fill="none" stroke="black" d="M6239.19,-595.31C6351.14,-580.5 6534.37,-557.53 6693,-543.49 6826.65,-531.67 6979.18,-523.12 7088.65,-517.85"/>
<polygon fill="black" stroke="black" points="7088.95,-521.34 7098.77,-517.37 7088.62,-514.35 7088.95,-521.34"/>
</g>
<!-- similar_utils._calc_similar_nn -->
<g id="node14" class="node">
<title>similar_utils._calc_similar_nn</title>
<g id="a_node14"><a xlink:title="Fill ``sim_map`` for ``new_ids`` using a nearest neighbour search.&#10;&#10;``vec_ids`` lists all lots that have an embedding. &#160;``new_ids`` is a subset&#10;for which we still need recommendations. &#160;We gather vectors for&#10;``vec_ids`` and use ``NearestNeighbors`` from scikit&#45;learn to find the&#10;closest items. &#160;Embeddings of lots without a vector are skipped.">
<polygon fill="none" stroke="black" points="8761.5,-530.99 7847.5,-530.99 7847.5,-455.99 8761.5,-455.99 8761.5,-530.99"/>
<text text-anchor="middle" x="8304.5" y="-478.5" font-family="Times,serif" font-size="60.62">similar_utils._calc_similar_nn</text>
</a>
</g>
</g>
<!-- similar.main&#45;&gt;similar_utils._calc_similar_nn -->
<g id="edge13" class="edge">
<title>similar.main&#45;&gt;similar_utils._calc_similar_nn</title>
<path fill="none" stroke="black" d="M6205.5,-588.43C6310.54,-558.26 6514.89,-504.2 6693,-484.49 7076.52,-442.06 7514.55,-447.99 7836.88,-462.47"/>
<polygon fill="black" stroke="black" points="7837.19,-465.99 7847.34,-462.95 7837.51,-459 7837.19,-465.99"/>
</g>
<!-- similar_utils._sync_embeddings -->
<g id="node15" class="node">
<title>similar_utils._sync_embeddings</title>
<g id="a_node15"><a xlink:title="Drop lots or vectors that do not match and return cleaned data.">
<polygon fill="none" stroke="black" points="7476.5,-691.49 6999.5,-691.49 6999.5,-651.49 7476.5,-651.49 7476.5,-691.49"/>
<text text-anchor="middle" x="7238" y="-664.42" font-family="Times,serif" font-size="28.84">similar_utils._sync_embeddings</text>
</a>
</g>
</g>
<!-- similar.main&#45;&gt;similar_utils._sync_embeddings -->
<g id="edge14" class="edge">
<title>similar.main&#45;&gt;similar_utils._sync_embeddings</title>
<path fill="none" stroke="black" d="M6239.12,-615.83C6351.19,-622.61 6534.7,-633.59 6693,-642.49 6789.8,-647.94 6896.31,-653.67 6989.23,-658.59"/>
<polygon fill="black" stroke="black" points="6989.16,-662.09 6999.33,-659.12 6989.53,-655.1 6989.16,-662.09"/>
</g>
<!-- similar_utils._similar_by_user -->
<g id="node16" class="node">
<title>similar_utils._similar_by_user</title>
<g id="a_node16"><a xlink:title="Return map of lot id to other lots from the same user.">
<polygon fill="none" stroke="black" points="9485,-454.99 8826,-454.99 8826,-399.99 9485,-399.99 9485,-454.99"/>
<text text-anchor="middle" x="9155.5" y="-416.5" font-family="Times,serif" font-size="43.12">similar_utils._similar_by_user</text>
</a>
</g>
</g>
<!-- similar.main&#45;&gt;similar_utils._similar_by_user -->
<g id="edge15" class="edge">
<title>similar.main&#45;&gt;similar_utils._similar_by_user</title>
<path fill="none" stroke="black" d="M6189.34,-588.42C6287.88,-551.42 6503.43,-476.12 6693,-448.49 6896.84,-418.79 8189.83,-421.91 8815.8,-425.27"/>
<polygon fill="black" stroke="black" points="8815.87,-428.77 8825.89,-425.32 8815.9,-421.77 8815.87,-428.77"/>
</g>
<!-- similar_utils._load_embeddings&#45;&gt;notes_utils.load_json -->
<g id="edge263" class="edge">
<title>similar_utils._load_embeddings&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M8590.69,-953.18C8664.44,-969.01 8737.7,-998.98 8790,-1053.49 8851.92,-1118.03 8770.45,-1181.39 8826,-1251.49 8878.94,-1318.31 8969.35,-1354.57 9041.93,-1373.84"/>
<polygon fill="black" stroke="black" points="9041.5,-1377.34 9052.05,-1376.45 9043.24,-1370.56 9041.5,-1377.34"/>
</g>
<!-- similar_utils._load_similar&#45;&gt;notes_utils.load_json -->
<g id="edge264" class="edge">
<title>similar_utils._load_similar&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M7487.28,-592.64C7879.26,-571.95 8615.02,-559.08 8790,-738.49 8869.79,-820.3 8760.05,-1158.16 8826,-1251.49 8873.65,-1318.93 8960.22,-1354.88 9032.53,-1373.87"/>
<polygon fill="black" stroke="black" points="9032.08,-1377.36 9042.64,-1376.43 9033.81,-1370.58 9032.08,-1377.36"/>
</g>
<!-- notes_utils.write_json -->
<g id="node27" class="node">
<title>notes_utils.write_json</title>
<g id="a_node27"><a xlink:title="Serialise ``data`` to ``path`` with standard options.">
<polygon fill="none" stroke="black" points="9249.5,-2322.49 9061.5,-2322.49 9061.5,-2286.49 9249.5,-2286.49 9249.5,-2322.49"/>
<text text-anchor="middle" x="9155.5" y="-2300.45" font-family="Times,serif" font-size="15.68">notes_utils.write_json</text>
</a>
</g>
</g>
<!-- similar_utils._save_similar&#45;&gt;notes_utils.write_json -->
<g id="edge266" class="edge">
<title>similar_utils._save_similar&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M7386.06,-1558.13C7510.48,-1554.82 7683.9,-1572.63 7783,-1680.49 7880.43,-1786.53 7719.49,-1898.41 7819,-2002.49 7969.95,-2160.39 8579.6,-2096.77 8790,-2155.49 8909.02,-2188.71 9041.68,-2249.3 9109.38,-2282.05"/>
<polygon fill="black" stroke="black" points="9107.97,-2285.25 9118.5,-2286.48 9111.03,-2278.96 9107.97,-2285.25"/>
</g>
<!-- lot_io.lot_json_path -->
<g id="node45" class="node">
<title>lot_io.lot_json_path</title>
<g id="a_node45"><a xlink:title="Return full JSON path for ``lot_id`` given ``root`` directory.">
<polygon fill="none" stroke="black" points="8381,-2296.49 8228,-2296.49 8228,-2260.49 8381,-2260.49 8381,-2296.49"/>
<text text-anchor="middle" x="8304.5" y="-2274.79" font-family="Times,serif" font-size="14.00">lot_io.lot_json_path</text>
</a>
</g>
</g>
<!-- similar_utils._save_similar&#45;&gt;lot_io.lot_json_path -->
<g id="edge267" class="edge">
<title>similar_utils._save_similar&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M7386.23,-1566.91C7512.09,-1570.89 7687.53,-1598.9 7783,-1713.49 7854.16,-1798.91 7742.92,-2131.43 7819,-2212.49 7920.27,-2320.39 8108.25,-2311.95 8217.91,-2295.58"/>
<polygon fill="black" stroke="black" points="8218.6,-2299.02 8227.95,-2294.03 8217.53,-2292.1 8218.6,-2299.02"/>
</g>
<!-- similar_utils._similar_path -->
<g id="node151" class="node">
<title>similar_utils._similar_path</title>
<g id="a_node151"><a xlink:title="Return cache file path for ``lot_path`` under ``SIMILAR_DIR``.">
<polygon fill="none" stroke="black" points="8406.5,-1428.49 8202.5,-1428.49 8202.5,-1392.49 8406.5,-1392.49 8406.5,-1428.49"/>
<text text-anchor="middle" x="8304.5" y="-1406.79" font-family="Times,serif" font-size="14.00">similar_utils._similar_path</text>
</a>
</g>
</g>
<!-- similar_utils._save_similar&#45;&gt;similar_utils._similar_path -->
<g id="edge268" class="edge">
<title>similar_utils._save_similar&#45;&gt;similar_utils._similar_path</title>
<path fill="none" stroke="black" d="M7386.1,-1560.77C7498.38,-1547.92 7655.03,-1521.42 7783,-1467.49 7800.95,-1459.93 7800.61,-1448.92 7819,-1442.49 7941.51,-1399.64 8091.9,-1396.76 8192.33,-1401.27"/>
<polygon fill="black" stroke="black" points="8192.34,-1404.77 8202.5,-1401.76 8192.68,-1397.78 8192.34,-1404.77"/>
</g>
<!-- similar_utils._save_more_user&#45;&gt;notes_utils.write_json -->
<g id="edge269" class="edge">
<title>similar_utils._save_more_user&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M7405.79,-1424.95C7528.07,-1423.47 7688.61,-1443.96 7783,-1545.49 7875.64,-1645.14 7721,-1755.12 7819,-1849.49 7974.93,-1999.65 8629.49,-1782.24 8790,-1927.49 8856.32,-1987.51 8773.6,-2053 8826,-2125.49 8886.84,-2209.67 8999.85,-2258.53 9076.11,-2283.35"/>
<polygon fill="black" stroke="black" points="9075.1,-2286.7 9085.69,-2286.4 9077.23,-2280.03 9075.1,-2286.7"/>
</g>
<!-- similar_utils._save_more_user&#45;&gt;lot_io.lot_json_path -->
<g id="edge270" class="edge">
<title>similar_utils._save_more_user&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M7405.76,-1423.29C7529.28,-1420.67 7691.43,-1440.45 7783,-1545.49 7880.55,-1657.38 7718.4,-2103.34 7819,-2212.49 7919.28,-2321.3 8107.62,-2312.53 8217.61,-2295.86"/>
<polygon fill="black" stroke="black" points="8218.34,-2299.29 8227.68,-2294.28 8217.26,-2292.37 8218.34,-2299.29"/>
</g>
<!-- similar_utils._more_user_path -->
<g id="node152" class="node">
<title>similar_utils._more_user_path</title>
<g id="a_node152"><a xlink:title="Return cache file path for ``lot_path`` under ``MORE_USER_DIR``.">
<polygon fill="none" stroke="black" points="8419.5,-1374.49 8189.5,-1374.49 8189.5,-1338.49 8419.5,-1338.49 8419.5,-1374.49"/>
<text text-anchor="middle" x="8304.5" y="-1352.79" font-family="Times,serif" font-size="14.00">similar_utils._more_user_path</text>
</a>
</g>
</g>
<!-- similar_utils._save_more_user&#45;&gt;similar_utils._more_user_path -->
<g id="edge271" class="edge">
<title>similar_utils._save_more_user&#45;&gt;similar_utils._more_user_path</title>
<path fill="none" stroke="black" d="M7403.21,-1422.49C7519.26,-1410.22 7678.52,-1394.3 7819,-1383.49 7941.3,-1374.08 8081.2,-1366.64 8179.13,-1361.97"/>
<polygon fill="black" stroke="black" points="8179.54,-1365.46 8189.36,-1361.49 8179.21,-1358.47 8179.54,-1365.46"/>
</g>
<!-- similar_utils._update_reciprocal -->
<g id="node153" class="node">
<title>similar_utils._update_reciprocal</title>
<g id="a_node153"><a xlink:title="Insert ``lot_id`` into caches of lots listed in ``sims`` if closer.">
<polygon fill="none" stroke="black" points="9396.5,-513.49 8914.5,-513.49 8914.5,-473.49 9396.5,-473.49 9396.5,-513.49"/>
<text text-anchor="middle" x="9155.5" y="-486.42" font-family="Times,serif" font-size="28.84">similar_utils._update_reciprocal</text>
</a>
</g>
</g>
<!-- similar_utils._calc_similar_nn&#45;&gt;similar_utils._update_reciprocal -->
<g id="edge272" class="edge">
<title>similar_utils._calc_similar_nn&#45;&gt;similar_utils._update_reciprocal</title>
<path fill="none" stroke="black" d="M8761.69,-493.49C8810.64,-493.49 8859.02,-493.49 8904.22,-493.49"/>
<polygon fill="black" stroke="black" points="8904.42,-496.99 8914.42,-493.49 8904.42,-489.99 8904.42,-496.99"/>
</g>
<!-- caption._identify_size -->
<g id="node17" class="node">
<title>caption._identify_size</title>
<g id="a_node17"><a xlink:title="Return ``(width, height)`` for ``path`` using ImageMagick.">
<polygon fill="none" stroke="black" points="9284,-1242.49 9027,-1242.49 9027,-1206.49 9284,-1206.49 9284,-1242.49"/>
<text text-anchor="middle" x="9155.5" y="-1218.8" font-family="Times,serif" font-size="22.12">caption._identify_size</text>
</a>
</g>
</g>
<!-- caption._prepare_image -->
<g id="node18" class="node">
<title>caption._prepare_image</title>
<g id="a_node18"><a xlink:title="Resize ``path`` and return the processed JPEG bytes.">
<polygon fill="none" stroke="black" points="8521.5,-1244.49 8087.5,-1244.49 8087.5,-1198.49 8521.5,-1198.49 8521.5,-1244.49"/>
<text text-anchor="middle" x="8304.5" y="-1213.05" font-family="Times,serif" font-size="34.30">caption._prepare_image</text>
</a>
</g>
</g>
<!-- caption._prepare_image&#45;&gt;caption._identify_size -->
<g id="edge16" class="edge">
<title>caption._prepare_image&#45;&gt;caption._identify_size</title>
<path fill="none" stroke="black" d="M8521.66,-1222.26C8677.27,-1222.81 8882.55,-1223.53 9016.49,-1224.01"/>
<polygon fill="black" stroke="black" points="9016.79,-1227.51 9026.81,-1224.04 9016.82,-1220.51 9016.79,-1227.51"/>
</g>
<!-- caption._guess_chat -->
<g id="node19" class="node">
<title>caption._guess_chat</title>
<g id="a_node19"><a xlink:title="Return chat name for ``path`` relative to ``MEDIA_DIR``.">
<polygon fill="none" stroke="black" points="9251.5,-1188.49 9059.5,-1188.49 9059.5,-1152.49 9251.5,-1152.49 9251.5,-1188.49"/>
<text text-anchor="middle" x="9155.5" y="-1166.33" font-family="Times,serif" font-size="17.08">caption._guess_chat</text>
</a>
</g>
</g>
<!-- caption.caption_file -->
<g id="node20" class="node">
<title>caption.caption_file</title>
<g id="a_node20"><a xlink:title="Caption ``path`` with GPT&#45;4o and save ``.caption.json`` beside it.">
<polygon fill="none" stroke="black" points="7541,-1324.99 6935,-1324.99 6935,-1251.99 7541,-1251.99 7541,-1324.99"/>
<text text-anchor="middle" x="7238" y="-1273.5" font-family="Times,serif" font-size="59.36">caption.caption_file</text>
</a>
</g>
</g>
<!-- caption.caption_file&#45;&gt;caption._prepare_image -->
<g id="edge17" class="edge">
<title>caption.caption_file&#45;&gt;caption._prepare_image</title>
<path fill="none" stroke="black" d="M7541.2,-1269.47C7711.56,-1258.75 7920.87,-1245.58 8077.03,-1235.75"/>
<polygon fill="black" stroke="black" points="8077.48,-1239.23 8087.24,-1235.1 8077.04,-1232.24 8077.48,-1239.23"/>
</g>
<!-- caption.caption_file&#45;&gt;caption._guess_chat -->
<g id="edge18" class="edge">
<title>caption.caption_file&#45;&gt;caption._guess_chat</title>
<path fill="none" stroke="black" d="M7498.14,-1251.99C7588.67,-1237.68 7690.7,-1219.8 7783,-1199.49 7799.22,-1195.92 7802.56,-1191.85 7819,-1189.49 8272.8,-1124.34 8822.23,-1148.49 9048.9,-1162.87"/>
<polygon fill="black" stroke="black" points="9048.92,-1166.38 9059.12,-1163.52 9049.37,-1159.39 9048.92,-1166.38"/>
</g>
<!-- caption_io.caption_json_path -->
<g id="node21" class="node">
<title>caption_io.caption_json_path</title>
<g id="a_node21"><a xlink:title="Return new&#45;style caption path for ``image``.">
<polygon fill="none" stroke="black" points="9252,-2116.49 9059,-2116.49 9059,-2080.49 9252,-2080.49 9252,-2116.49"/>
<text text-anchor="middle" x="9155.5" y="-2095.25" font-family="Times,serif" font-size="12.18">caption_io.caption_json_path</text>
</a>
</g>
</g>
<!-- caption.caption_file&#45;&gt;caption_io.caption_json_path -->
<g id="edge19" class="edge">
<title>caption.caption_file&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M7541.34,-1292.18C7631.49,-1308.84 7722.32,-1343.94 7783,-1413.49 7841.67,-1480.75 7754.47,-1751.84 7819,-1813.49 7897.08,-1888.1 8687.33,-1823.02 8790,-1856.49 8932.43,-1902.93 9071.74,-2021.45 9128.2,-2073.42"/>
<polygon fill="black" stroke="black" points="9125.9,-2076.06 9135.61,-2080.3 9130.67,-2070.93 9125.9,-2076.06"/>
</g>
<!-- caption_io.has_caption -->
<g id="node22" class="node">
<title>caption_io.has_caption</title>
<g id="a_node22"><a xlink:title="Return ``True`` when any caption exists for ``image``.">
<polygon fill="none" stroke="black" points="8382,-2552.49 8227,-2552.49 8227,-2516.49 8382,-2516.49 8382,-2552.49"/>
<text text-anchor="middle" x="8304.5" y="-2531.25" font-family="Times,serif" font-size="12.18">caption_io.has_caption</text>
</a>
</g>
</g>
<!-- caption.caption_file&#45;&gt;caption_io.has_caption -->
<g id="edge20" class="edge">
<title>caption.caption_file&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M7541.21,-1289.72C7632.34,-1306.06 7723.78,-1341.59 7783,-1413.49 7860.25,-1507.29 7734.15,-2419.51 7819,-2506.49 7872.22,-2561.05 8092.19,-2552.48 8216.64,-2542.76"/>
<polygon fill="black" stroke="black" points="8217.22,-2546.22 8226.91,-2541.94 8216.66,-2539.25 8217.22,-2546.22"/>
</g>
<!-- caption_io.write_caption -->
<g id="node23" class="node">
<title>caption_io.write_caption</title>
<g id="a_node23"><a xlink:title="Write ``text`` as ``lang`` caption for ``image``.">
<polygon fill="none" stroke="black" points="8471,-1804.49 8138,-1804.49 8138,-1768.49 8471,-1768.49 8471,-1804.49"/>
<text text-anchor="middle" x="8304.5" y="-1780.33" font-family="Times,serif" font-size="25.20">caption_io.write_caption</text>
</a>
</g>
</g>
<!-- caption.caption_file&#45;&gt;caption_io.write_caption -->
<g id="edge21" class="edge">
<title>caption.caption_file&#45;&gt;caption_io.write_caption</title>
<path fill="none" stroke="black" d="M7541.19,-1295.02C7630.37,-1311.99 7720.68,-1346.56 7783,-1413.49 7853.81,-1489.54 7750.47,-1566.39 7819,-1644.49 7895.65,-1731.86 8022.88,-1766.82 8127.73,-1780.22"/>
<polygon fill="black" stroke="black" points="8127.45,-1783.71 8137.8,-1781.45 8128.3,-1776.76 8127.45,-1783.71"/>
</g>
<!-- caption.caption_file&#45;&gt;notes_utils.load_json -->
<g id="edge22" class="edge">
<title>caption.caption_file&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M7541.35,-1280.84C7922.92,-1272.78 8557.49,-1265.17 8790,-1296.49 8899.47,-1311.24 9022.82,-1349.06 9094.3,-1373.17"/>
<polygon fill="black" stroke="black" points="9093.44,-1376.57 9104.04,-1376.48 9095.7,-1369.95 9093.44,-1376.57"/>
</g>
<!-- caption_io.has_caption&#45;&gt;caption_io.caption_json_path -->
<g id="edge79" class="edge">
<title>caption_io.has_caption&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M8382.32,-2541.23C8503.72,-2550.1 8732.1,-2558.97 8790,-2506.49 8866.34,-2437.3 8766.65,-2361.71 8826,-2277.49 8885.65,-2192.85 8998.41,-2144.21 9075,-2119.56"/>
<polygon fill="black" stroke="black" points="9076.13,-2122.87 9084.62,-2116.52 9074.03,-2116.19 9076.13,-2122.87"/>
</g>
<!-- caption_io.caption_md_path -->
<g id="node51" class="node">
<title>caption_io.caption_md_path</title>
<g id="a_node51"><a xlink:title="Return legacy Markdown caption path for ``image``.">
<polygon fill="none" stroke="black" points="9249,-2497.49 9062,-2497.49 9062,-2461.49 9249,-2461.49 9249,-2497.49"/>
<text text-anchor="middle" x="9155.5" y="-2476.25" font-family="Times,serif" font-size="12.18">caption_io.caption_md_path</text>
</a>
</g>
</g>
<!-- caption_io.has_caption&#45;&gt;caption_io.caption_md_path -->
<g id="edge80" class="edge">
<title>caption_io.has_caption&#45;&gt;caption_io.caption_md_path</title>
<path fill="none" stroke="black" d="M8382.3,-2530.44C8477.87,-2525.31 8646.03,-2515.98 8790,-2506.49 8878.29,-2500.67 8978.54,-2493.18 9051.53,-2487.57"/>
<polygon fill="black" stroke="black" points="9051.94,-2491.05 9061.64,-2486.79 9051.4,-2484.07 9051.94,-2491.05"/>
</g>
<!-- caption_io.write_caption&#45;&gt;caption_io.caption_json_path -->
<g id="edge87" class="edge">
<title>caption_io.write_caption&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M8471.18,-1773.96C8567.2,-1772.39 8688.74,-1780.32 8790,-1818.49 8939.76,-1874.95 9078.59,-2014.81 9131.69,-2072.73"/>
<polygon fill="black" stroke="black" points="9129.3,-2075.3 9138.61,-2080.35 9134.48,-2070.59 9129.3,-2075.3"/>
</g>
<!-- caption_io.write_caption&#45;&gt;notes_utils.load_json -->
<g id="edge88" class="edge">
<title>caption_io.write_caption&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M8410.74,-1804.5C8521.37,-1816.83 8692.61,-1816.05 8790,-1716.49 8882.36,-1622.07 8730.78,-1513.03 8826,-1421.49 8889.34,-1360.61 8994.85,-1363.04 9069.18,-1374.74"/>
<polygon fill="black" stroke="black" points="9069.01,-1378.26 9079.45,-1376.45 9070.16,-1371.36 9069.01,-1378.26"/>
</g>
<!-- caption_io.write_caption&#45;&gt;notes_utils.write_json -->
<g id="edge89" class="edge">
<title>caption_io.write_caption&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M8471.07,-1779.02C8577.15,-1783.66 8709.55,-1808.66 8790,-1894.49 8861.06,-1970.3 8766.2,-2040.52 8826,-2125.49 8885.59,-2210.17 8998.37,-2258.8 9074.97,-2283.45"/>
<polygon fill="black" stroke="black" points="9074.01,-2286.81 9084.6,-2286.48 9076.11,-2280.13 9074.01,-2286.81"/>
</g>
<!-- caption_io._get_langs -->
<g id="node57" class="node">
<title>caption_io._get_langs</title>
<g id="a_node57"><a xlink:title="Return configured languages, caching the result.">
<polygon fill="none" stroke="black" points="9264.5,-1812.49 9046.5,-1812.49 9046.5,-1776.49 9264.5,-1776.49 9264.5,-1812.49"/>
<text text-anchor="middle" x="9155.5" y="-1789.71" font-family="Times,serif" font-size="18.48">caption_io._get_langs</text>
</a>
</g>
</g>
<!-- caption_io.write_caption&#45;&gt;caption_io._get_langs -->
<g id="edge86" class="edge">
<title>caption_io.write_caption&#45;&gt;caption_io._get_langs</title>
<path fill="none" stroke="black" d="M8471.21,-1788.05C8637.33,-1789.62 8888.95,-1791.99 9036,-1793.38"/>
<polygon fill="black" stroke="black" points="9036.37,-1796.88 9046.41,-1793.47 9036.44,-1789.88 9036.37,-1796.88"/>
</g>
<!-- notes_utils.read_text -->
<g id="node47" class="node">
<title>notes_utils.read_text</title>
<g id="a_node47"><a xlink:title="Return file contents as UTF&#45;8 or empty string when missing.">
<polygon fill="none" stroke="black" points="9895.5,-4427.49 9681.5,-4427.49 9681.5,-4391.49 9895.5,-4391.49 9895.5,-4427.49"/>
<text text-anchor="middle" x="9788.5" y="-4404.71" font-family="Times,serif" font-size="18.48">notes_utils.read_text</text>
</a>
</g>
</g>
<!-- notes_utils.load_json&#45;&gt;notes_utils.read_text -->
<g id="edge242" class="edge">
<title>notes_utils.load_json&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M9225.39,-1376.47C9300.95,-1361.34 9420.1,-1351.94 9485,-1421.49 9538.01,-1478.3 9485.06,-4149.61 9521,-4218.49 9565.3,-4303.39 9666.46,-4359.19 9730.62,-4387.47"/>
<polygon fill="black" stroke="black" points="9729.24,-4390.69 9739.81,-4391.44 9732.02,-4384.26 9729.24,-4390.69"/>
</g>
<!-- caption.main -->
<g id="node25" class="node">
<title>caption.main</title>
<g id="a_node25"><a xlink:title="Caption a single image provided on the command line.">
<polygon fill="none" stroke="black" points="6226.5,-1316.49 6041.5,-1316.49 6041.5,-1280.49 6226.5,-1280.49 6226.5,-1316.49"/>
<text text-anchor="middle" x="6134" y="-1292.33" font-family="Times,serif" font-size="25.20">caption.main</text>
</a>
</g>
</g>
<!-- caption.main&#45;&gt;caption.caption_file -->
<g id="edge23" class="edge">
<title>caption.main&#45;&gt;caption.caption_file</title>
<path fill="none" stroke="black" d="M6226.59,-1297.66C6378.13,-1296.29 6687.81,-1293.48 6924.61,-1291.33"/>
<polygon fill="black" stroke="black" points="6924.8,-1294.83 6934.77,-1291.24 6924.74,-1287.83 6924.8,-1294.83"/>
</g>
<!-- embed.embed_file -->
<g id="node26" class="node">
<title>embed.embed_file</title>
<g id="a_node26"><a xlink:title="Embed ``path`` and write the result beside it under ``EMBED_DIR``.">
<polygon fill="none" stroke="black" points="7443,-4162.99 7033,-4162.99 7033,-4107.99 7443,-4107.99 7443,-4162.99"/>
<text text-anchor="middle" x="7238" y="-4124.94" font-family="Times,serif" font-size="42.56">embed.embed_file</text>
</a>
</g>
</g>
<!-- embed.embed_file&#45;&gt;lot_io.read_lots -->
<g id="edge25" class="edge">
<title>embed.embed_file&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M7443.07,-4139.93C7555.73,-4131.81 7691.03,-4103.21 7783,-4021.49 7820.51,-3988.17 7784.89,-3951.29 7819,-3914.49 7917.52,-3808.21 8080.04,-3754.93 8189.38,-3729.77"/>
<polygon fill="black" stroke="black" points="8190.47,-3733.11 8199.46,-3727.5 8188.93,-3726.28 8190.47,-3733.11"/>
</g>
<!-- embed.embed_file&#45;&gt;notes_utils.write_json -->
<g id="edge24" class="edge">
<title>embed.embed_file&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M7392.19,-4163C7509.96,-4175.4 7670.94,-4172.41 7783,-4091.49 7816.26,-4067.47 7785.25,-4029.81 7819,-4006.49 7907.83,-3945.11 8714.24,-4045.42 8790,-3968.49 8849.11,-3908.47 8779.44,-2522.7 8826,-2452.49 8876.13,-2376.91 8974.85,-2339.47 9051.04,-2321.21"/>
<polygon fill="black" stroke="black" points="9052.21,-2324.53 9061.16,-2318.86 9050.63,-2317.71 9052.21,-2324.53"/>
</g>
<!-- lot_io.make_lot_id -->
<g id="node28" class="node">
<title>lot_io.make_lot_id</title>
<g id="a_node28"><a xlink:title="Return lot id string for ``rel`` and ``index``.&#10;&#10;``rel`` is the JSON file path relative to the ``data/lots`` directory&#10;without the ``.json`` suffix.">
<polygon fill="none" stroke="black" points="8397,-3546.49 8212,-3546.49 8212,-3510.49 8397,-3510.49 8397,-3546.49"/>
<text text-anchor="middle" x="8304.5" y="-3523.71" font-family="Times,serif" font-size="18.48">lot_io.make_lot_id</text>
</a>
</g>
</g>
<!-- embed.embed_file&#45;&gt;lot_io.make_lot_id -->
<g id="edge26" class="edge">
<title>embed.embed_file&#45;&gt;lot_io.make_lot_id</title>
<path fill="none" stroke="black" d="M7443.08,-4148.04C7559.92,-4143.39 7699.47,-4115.57 7783,-4021.49 7843.43,-3953.43 7757.45,-3680.55 7819,-3613.49 7914.9,-3509.01 8090.26,-3504.31 8201.63,-3513.91"/>
<polygon fill="black" stroke="black" points="8201.59,-3517.42 8211.87,-3514.85 8202.23,-3510.45 8201.59,-3517.42"/>
</g>
<!-- embed.main -->
<g id="node29" class="node">
<title>embed.main</title>
<g id="a_node29"><a xlink:title="Embed the file given on the command line.">
<polygon fill="none" stroke="black" points="6222,-4260.49 6046,-4260.49 6046,-4224.49 6222,-4224.49 6222,-4260.49"/>
<text text-anchor="middle" x="6134" y="-4236.33" font-family="Times,serif" font-size="25.20">embed.main</text>
</a>
</g>
</g>
<!-- embed.main&#45;&gt;embed.embed_file -->
<g id="edge27" class="edge">
<title>embed.main&#45;&gt;embed.embed_file</title>
<path fill="none" stroke="black" d="M6222.44,-4239.99C6326.25,-4236.51 6504.53,-4228.94 6657,-4214.49 6789.7,-4201.92 6938.68,-4181.49 7052.42,-4164.56"/>
<polygon fill="black" stroke="black" points="7053.25,-4167.97 7062.62,-4163.03 7052.22,-4161.05 7053.25,-4167.97"/>
</g>
<!-- config_utils.load_config -->
<g id="node30" class="node">
<title>config_utils.load_config</title>
<g id="a_node30"><a xlink:title="Return the ``config`` module or exit with a helpful message.&#10;&#10;When running the scripts directly from ``src/`` the repository root isn&#39;t on&#10;``sys.path`` and ``config.py`` can&#39;t be imported. &#160;Try adding the parent&#10;directory before failing so the configuration can live alongside&#10;``config.example.py`` in the project root.">
<polygon fill="none" stroke="black" points="10005,-1011.99 9572,-1011.99 9572,-964.99 10005,-964.99 10005,-1011.99"/>
<text text-anchor="middle" x="9788.5" y="-979.99" font-family="Times,serif" font-size="35.00">config_utils.load_config</text>
</a>
</g>
</g>
<!-- scan_ontology.collect_ontology -->
<g id="node31" class="node">
<title>scan_ontology.collect_ontology</title>
<g id="a_node31"><a xlink:title="Return counts per field, value counters, misparsed lots and broken metadata.">
<polygon fill="none" stroke="black" points="6592,-3722.99 5676,-3722.99 5676,-3651.99 6592,-3651.99 6592,-3722.99"/>
<text text-anchor="middle" x="6134" y="-3672.85" font-family="Times,serif" font-size="57.68">scan_ontology.collect_ontology</text>
</a>
</g>
</g>
<!-- scan_ontology.collect_ontology&#45;&gt;post_io.read_post -->
<g id="edge29" class="edge">
<title>scan_ontology.collect_ontology&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M6305.77,-3651.95C6424.54,-3617.76 6575.65,-3553.38 6657,-3436.49 6705.96,-3366.15 6629.97,-3110.57 6693,-3052.49 6740.67,-3008.57 7564.52,-3018.31 8014.91,-3027.02"/>
<polygon fill="black" stroke="black" points="8015.09,-3030.52 8025.15,-3027.22 8015.22,-3023.53 8015.09,-3030.52"/>
</g>
<!-- scan_ontology.collect_ontology&#45;&gt;post_io.raw_post_path -->
<g id="edge30" class="edge">
<title>scan_ontology.collect_ontology&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M6592.15,-3677.26C7063.26,-3664.82 7735.68,-3640.99 7783,-3605.49 7822.13,-3576.14 7783.65,-3535.3 7819,-3501.49 7928.5,-3396.75 8110.72,-3367.79 8217.74,-3360.04"/>
<polygon fill="black" stroke="black" points="8218.11,-3363.52 8227.85,-3359.35 8217.64,-3356.54 8218.11,-3363.52"/>
</g>
<!-- scan_ontology.collect_ontology&#45;&gt;lot_io.read_lots -->
<g id="edge32" class="edge">
<title>scan_ontology.collect_ontology&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M6592.23,-3692.13C7102.02,-3697.3 7893.58,-3705.33 8188.03,-3708.32"/>
<polygon fill="black" stroke="black" points="8188.26,-3711.82 8198.29,-3708.43 8188.33,-3704.82 8188.26,-3711.82"/>
</g>
<!-- message_utils.gather_chop_input -->
<g id="node32" class="node">
<title>message_utils.gather_chop_input</title>
<g id="a_node32"><a xlink:title="Return the exact text fed to the lot parser for ``msg_path``.">
<polygon fill="none" stroke="black" points="7450.5,-3005.49 7025.5,-3005.49 7025.5,-2969.49 7450.5,-2969.49 7450.5,-3005.49"/>
<text text-anchor="middle" x="7238" y="-2981.62" font-family="Times,serif" font-size="24.22">message_utils.gather_chop_input</text>
</a>
</g>
</g>
<!-- scan_ontology.collect_ontology&#45;&gt;message_utils.gather_chop_input -->
<g id="edge28" class="edge">
<title>scan_ontology.collect_ontology&#45;&gt;message_utils.gather_chop_input</title>
<path fill="none" stroke="black" d="M6306.65,-3651.95C6425.46,-3617.8 6576.22,-3553.47 6657,-3436.49 6709.85,-3359.96 6626.34,-3084.36 6693,-3019.49 6738.43,-2975.29 6885.37,-2968.59 7015.09,-2972.25"/>
<polygon fill="black" stroke="black" points="7015.09,-2975.75 7025.19,-2972.56 7015.3,-2968.76 7015.09,-2975.75"/>
</g>
<!-- moderation.is_misparsed -->
<g id="node33" class="node">
<title>moderation.is_misparsed</title>
<g id="a_node33"><a xlink:title="Return ``True`` for obviously invalid lots or source posts.">
<polygon fill="none" stroke="black" points="8522.5,-4347.49 8086.5,-4347.49 8086.5,-4303.49 8522.5,-4303.49 8522.5,-4347.49"/>
<text text-anchor="middle" x="8304.5" y="-4317.17" font-family="Times,serif" font-size="32.90">moderation.is_misparsed</text>
</a>
</g>
</g>
<!-- scan_ontology.collect_ontology&#45;&gt;moderation.is_misparsed -->
<g id="edge31" class="edge">
<title>scan_ontology.collect_ontology&#45;&gt;moderation.is_misparsed</title>
<path fill="none" stroke="black" d="M6555.35,-3723C6593.83,-3741 6628.85,-3765.21 6657,-3797.49 6730.94,-3882.29 6611.22,-4225.23 6693,-4302.49 6742.35,-4349.11 7643.8,-4338.23 8076.01,-4330.27"/>
<polygon fill="black" stroke="black" points="8076.2,-4333.76 8086.14,-4330.08 8076.07,-4326.76 8076.2,-4333.76"/>
</g>
<!-- message_utils.gather_chop_input&#45;&gt;post_io.read_post -->
<g id="edge97" class="edge">
<title>message_utils.gather_chop_input&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7450.58,-2996.64C7612.3,-3003.62 7836.97,-3013.33 8015.13,-3021.03"/>
<polygon fill="black" stroke="black" points="8015.05,-3024.53 8025.19,-3021.47 8015.35,-3017.54 8015.05,-3024.53"/>
</g>
<!-- caption_io.read_caption -->
<g id="node49" class="node">
<title>caption_io.read_caption</title>
<g id="a_node49"><a xlink:title="Return caption for ``image`` in ``lang`` or empty string when missing.">
<polygon fill="none" stroke="black" points="8470,-2497.99 8139,-2497.99 8139,-2460.99 8470,-2460.99 8470,-2497.99"/>
<text text-anchor="middle" x="8304.5" y="-2473.05" font-family="Times,serif" font-size="26.18">caption_io.read_caption</text>
</a>
</g>
</g>
<!-- message_utils.gather_chop_input&#45;&gt;caption_io.read_caption -->
<g id="edge95" class="edge">
<title>message_utils.gather_chop_input&#45;&gt;caption_io.read_caption</title>
<path fill="none" stroke="black" d="M7450.52,-2987.86C7565.99,-2976.19 7701.61,-2940.89 7783,-2846.49 7832.47,-2789.12 7764.16,-2559.76 7819,-2507.49 7862.57,-2465.97 8008.39,-2462.07 8128.77,-2466.74"/>
<polygon fill="black" stroke="black" points="8128.73,-2470.24 8138.86,-2467.15 8129.01,-2463.24 8128.73,-2470.24"/>
</g>
<!-- message_utils.build_prompt -->
<g id="node63" class="node">
<title>message_utils.build_prompt</title>
<g id="a_node63"><a xlink:title="Return prompt combining message text with captioned file names.">
<polygon fill="none" stroke="black" points="8454,-3658.49 8155,-3658.49 8155,-3622.49 8454,-3622.49 8454,-3658.49"/>
<text text-anchor="middle" x="8304.5" y="-3635.7" font-family="Times,serif" font-size="19.74">message_utils.build_prompt</text>
</a>
</g>
</g>
<!-- message_utils.gather_chop_input&#45;&gt;message_utils.build_prompt -->
<g id="edge96" class="edge">
<title>message_utils.gather_chop_input&#45;&gt;message_utils.build_prompt</title>
<path fill="none" stroke="black" d="M7450.68,-2985.93C7583.45,-2989.85 7737.75,-3005.04 7783,-3052.49 7860.34,-3133.59 7743.91,-3472.31 7819,-3555.49 7899.18,-3644.32 8036.75,-3661.37 8144.85,-3658.61"/>
<polygon fill="black" stroke="black" points="8145,-3662.11 8154.89,-3658.3 8144.78,-3655.11 8145,-3662.11"/>
</g>
<!-- lot_io.get_seller -->
<g id="node104" class="node">
<title>lot_io.get_seller</title>
<g id="a_node104"><a xlink:title="Return the seller identifier or ``None`` when missing.">
<polygon fill="none" stroke="black" points="9256,-4420.49 9055,-4420.49 9055,-4384.49 9256,-4384.49 9256,-4420.49"/>
<text text-anchor="middle" x="9155.5" y="-4396.9" font-family="Times,serif" font-size="23.24">lot_io.get_seller</text>
</a>
</g>
</g>
<!-- moderation.is_misparsed&#45;&gt;lot_io.get_seller -->
<g id="edge247" class="edge">
<title>moderation.is_misparsed&#45;&gt;lot_io.get_seller</title>
<path fill="none" stroke="black" d="M8522.71,-4339.87C8606.32,-4345.87 8702.66,-4353.34 8790,-4361.49 8875.69,-4369.49 8972.49,-4380.47 9044.78,-4389.06"/>
<polygon fill="black" stroke="black" points="9044.47,-4392.54 9054.82,-4390.25 9045.3,-4385.59 9044.47,-4392.54"/>
</g>
<!-- scan_ontology.main -->
<g id="node34" class="node">
<title>scan_ontology.main</title>
<polygon fill="none" stroke="black" points="5529,-3731.99 5070,-3731.99 5070,-3674.99 5529,-3674.99 5529,-3731.99"/>
<text text-anchor="middle" x="5299.5" y="-3692.15" font-family="Times,serif" font-size="44.80">scan_ontology.main</text>
</g>
<!-- scan_ontology.main&#45;&gt;notes_utils.write_json -->
<g id="edge35" class="edge">
<title>scan_ontology.main&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M5346.84,-3674.87C5411.2,-3632.19 5525.34,-3545.22 5575,-3437.49 5628.41,-3321.63 5530.03,-2963.09 5611,-2864.49 5926.68,-2480.1 6199.74,-2642.58 6693,-2578.49 6933.2,-2547.28 7569.92,-2463.3 7783,-2578.49 7808.7,-2592.39 7793.3,-2619.6 7819,-2633.49 7913.91,-2684.8 8706.6,-2701.94 8790,-2633.49 8853.4,-2581.46 8774.94,-2516.68 8826,-2452.49 8881.71,-2382.45 8977.76,-2344.47 9051.65,-2324.59"/>
<polygon fill="black" stroke="black" points="9052.68,-2327.94 9061.47,-2322.02 9050.91,-2321.17 9052.68,-2327.94"/>
</g>
<!-- scan_ontology.main&#45;&gt;scan_ontology.collect_ontology -->
<g id="edge33" class="edge">
<title>scan_ontology.main&#45;&gt;scan_ontology.collect_ontology</title>
<path fill="none" stroke="black" d="M5529.09,-3699.1C5572.11,-3698.27 5618.53,-3697.38 5665.83,-3696.47"/>
<polygon fill="black" stroke="black" points="5666.01,-3699.97 5675.94,-3696.28 5665.87,-3692.97 5666.01,-3699.97"/>
</g>
<!-- log_utils.install_excepthook -->
<g id="node35" class="node">
<title>log_utils.install_excepthook</title>
<g id="a_node35"><a xlink:title="Redirect uncaught exceptions to ``logger.exception``.">
<polygon fill="none" stroke="black" points="6320.5,-5523.49 5947.5,-5523.49 5947.5,-5487.49 6320.5,-5487.49 6320.5,-5523.49"/>
<text text-anchor="middle" x="6134" y="-5499.33" font-family="Times,serif" font-size="25.20">log_utils.install_excepthook</text>
</a>
</g>
</g>
<!-- scan_ontology.main&#45;&gt;log_utils.install_excepthook -->
<g id="edge34" class="edge">
<title>scan_ontology.main&#45;&gt;log_utils.install_excepthook</title>
<path fill="none" stroke="black" d="M5325.63,-3732.13C5383.02,-3799.6 5522.79,-3976.19 5575,-4152.49 5595.93,-4223.15 5559.53,-5425.75 5611,-5478.49 5655.51,-5524.11 5808.33,-5527.79 5937.2,-5521.83"/>
<polygon fill="black" stroke="black" points="5937.41,-5525.33 5947.22,-5521.35 5937.07,-5518.33 5937.41,-5525.33"/>
</g>
<!-- oom_utils.prefer_oom_kill -->
<g id="node36" class="node">
<title>oom_utils.prefer_oom_kill</title>
<g id="a_node36"><a xlink:title="Make this process the first OOM victim.">
<polygon fill="none" stroke="black" points="8469.5,-3959.49 8139.5,-3959.49 8139.5,-3923.49 8469.5,-3923.49 8469.5,-3959.49"/>
<text text-anchor="middle" x="8304.5" y="-3935.62" font-family="Times,serif" font-size="24.22">oom_utils.prefer_oom_kill</text>
</a>
</g>
</g>
<!-- scan_ontology.main&#45;&gt;oom_utils.prefer_oom_kill -->
<g id="edge36" class="edge">
<title>scan_ontology.main&#45;&gt;oom_utils.prefer_oom_kill</title>
<path fill="none" stroke="black" d="M5311.79,-3732.06C5344.28,-3809.79 5446.36,-4024.63 5611,-4105.49 5663.16,-4131.11 6605.28,-4131.99 6657,-4105.49 6681.37,-4093.01 6668.83,-4068.36 6693,-4055.49 6799.97,-3998.58 7677.81,-4081.63 7783,-4021.49 7809.01,-4006.62 7793.11,-3979.57 7819,-3964.49 7939.42,-3894.35 8106.62,-3905.28 8209.79,-3921.78"/>
<polygon fill="black" stroke="black" points="8209.45,-3925.27 8219.88,-3923.44 8210.58,-3918.36 8209.45,-3925.27"/>
</g>
<!-- log_utils._extract_tb_lineno -->
<g id="node59" class="node">
<title>log_utils._extract_tb_lineno</title>
<g id="a_node59"><a xlink:title="Return the last line number from a traceback.">
<polygon fill="none" stroke="black" points="7353.5,-5699.49 7122.5,-5699.49 7122.5,-5663.49 7353.5,-5663.49 7353.5,-5699.49"/>
<text text-anchor="middle" x="7238" y="-5677.45" font-family="Times,serif" font-size="15.68">log_utils._extract_tb_lineno</text>
</a>
</g>
</g>
<!-- log_utils.install_excepthook&#45;&gt;log_utils._extract_tb_lineno -->
<g id="edge94" class="edge">
<title>log_utils.install_excepthook&#45;&gt;log_utils._extract_tb_lineno</title>
<path fill="none" stroke="black" d="M6247.75,-5523.5C6455.79,-5556.73 6898.36,-5627.41 7113.9,-5661.83"/>
<polygon fill="black" stroke="black" points="7113.57,-5665.32 7123.99,-5663.44 7114.67,-5658.41 7113.57,-5665.32"/>
</g>
<!-- cluster_items._iter_items -->
<g id="node37" class="node">
<title>cluster_items._iter_items</title>
<g id="a_node37"><a xlink:title="Yield ``(id, item:type, embedding)`` for ``sell_item`` lots.&#10;&#10;Embeddings are loaded on demand so memory usage stays minimal.">
<polygon fill="none" stroke="black" points="7496,-2757.49 6980,-2757.49 6980,-2705.49 7496,-2705.49 7496,-2757.49"/>
<text text-anchor="middle" x="7238" y="-2721.8" font-family="Times,serif" font-size="39.62">cluster_items._iter_items</text>
</a>
</g>
</g>
<!-- cluster_items._iter_items&#45;&gt;lot_io.read_lots -->
<g id="edge38" class="edge">
<title>cluster_items._iter_items&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M7496.23,-2716.27C7616.72,-2715.25 7742.6,-2725.09 7783,-2766.49 7852.98,-2838.19 7749.82,-3595.02 7819,-3667.49 7923.72,-3777.21 8120.05,-3753.62 8227.85,-3729.79"/>
<polygon fill="black" stroke="black" points="8228.7,-3733.19 8237.68,-3727.57 8227.16,-3726.36 8228.7,-3733.19"/>
</g>
<!-- cluster_items._iter_items&#45;&gt;lot_io.iter_lot_files -->
<g id="edge41" class="edge">
<title>cluster_items._iter_items&#45;&gt;lot_io.iter_lot_files</title>
<path fill="none" stroke="black" d="M7382.96,-2757.5C7508.22,-2770.97 7684.66,-2766.14 7783,-2657.49 7858.13,-2574.49 7741.12,-1730.93 7819,-1650.49 7865.39,-1602.58 8039.5,-1601.28 8165.74,-1607.29"/>
<polygon fill="black" stroke="black" points="8165.73,-1610.79 8175.89,-1607.79 8166.07,-1603.8 8165.73,-1610.79"/>
</g>
<!-- cluster_items._iter_items&#45;&gt;notes_utils.load_json -->
<g id="edge37" class="edge">
<title>cluster_items._iter_items&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M7383.23,-2757.5C7508.44,-2770.91 7684.66,-2765.98 7783,-2657.49 7855.36,-2577.67 7743.13,-1764.99 7819,-1688.49 7895.06,-1611.81 8709.38,-1716.35 8790,-1644.49 8864.94,-1577.69 8752.3,-1489.66 8826,-1421.49 8889.6,-1362.68 8992.85,-1363.98 9066.62,-1374.87"/>
<polygon fill="black" stroke="black" points="9066.4,-1378.37 9076.82,-1376.46 9067.48,-1371.46 9066.4,-1378.37"/>
</g>
<!-- cluster_items._iter_items&#45;&gt;lot_io.make_lot_id -->
<g id="edge39" class="edge">
<title>cluster_items._iter_items&#45;&gt;lot_io.make_lot_id</title>
<path fill="none" stroke="black" d="M7496.29,-2716.57C7616.59,-2715.66 7742.26,-2725.51 7783,-2766.49 7879.98,-2864.06 7733.57,-3276.67 7819,-3384.49 7909.99,-3499.33 8088.37,-3525.62 8201.46,-3530.03"/>
<polygon fill="black" stroke="black" points="8201.4,-3533.53 8211.52,-3530.37 8201.64,-3526.53 8201.4,-3533.53"/>
</g>
<!-- lot_io.embedding_path -->
<g id="node38" class="node">
<title>lot_io.embedding_path</title>
<g id="a_node38"><a xlink:title="Return embedding file path for ``lot_path``.">
<polygon fill="none" stroke="black" points="8411,-2796.49 8198,-2796.49 8198,-2760.49 8411,-2760.49 8411,-2796.49"/>
<text text-anchor="middle" x="8304.5" y="-2774.33" font-family="Times,serif" font-size="17.08">lot_io.embedding_path</text>
</a>
</g>
</g>
<!-- cluster_items._iter_items&#45;&gt;lot_io.embedding_path -->
<g id="edge40" class="edge">
<title>cluster_items._iter_items&#45;&gt;lot_io.embedding_path</title>
<path fill="none" stroke="black" d="M7496.01,-2742.84C7716.12,-2752.56 8022.89,-2766.1 8187.74,-2773.38"/>
<polygon fill="black" stroke="black" points="8187.76,-2776.89 8197.9,-2773.83 8188.06,-2769.89 8187.76,-2776.89"/>
</g>
<!-- cluster_items.collect_clusters -->
<g id="node39" class="node">
<title>cluster_items.collect_clusters</title>
<g id="a_node39"><a xlink:title="Return mapping of cluster name to lot ids.&#10;&#10;``MiniBatchKMeans`` processes item embeddings in chunks so only a&#10;small batch resides in memory at a time. &#160;Initial centroids come from&#10;the most common ``item:type`` values so existing categories guide the&#10;clustering.">
<polygon fill="none" stroke="black" points="6615,-3427.99 5653,-3427.99 5653,-3350.99 6615,-3350.99 6615,-3427.99"/>
<text text-anchor="middle" x="6134" y="-3373.59" font-family="Times,serif" font-size="63.00">cluster_items.collect_clusters</text>
</a>
</g>
</g>
<!-- cluster_items.collect_clusters&#45;&gt;cluster_items._iter_items -->
<g id="edge42" class="edge">
<title>cluster_items.collect_clusters&#45;&gt;cluster_items._iter_items</title>
<path fill="none" stroke="black" d="M6204.56,-3350.94C6318.65,-3283.84 6544.09,-3134.23 6657,-2942.49 6697.51,-2873.69 6632.8,-2818.94 6693,-2766.49 6735.08,-2729.83 6853.85,-2719.52 6969.71,-2719.07"/>
<polygon fill="black" stroke="black" points="6969.84,-2722.57 6979.83,-2719.05 6969.83,-2715.57 6969.84,-2722.57"/>
</g>
<!-- similar_utils._cos_sim -->
<g id="node40" class="node">
<title>similar_utils._cos_sim</title>
<g id="a_node40"><a xlink:title="Return cosine similarity between two embeddings.">
<polygon fill="none" stroke="black" points="7367,-3596.49 7109,-3596.49 7109,-3560.49 7367,-3560.49 7367,-3596.49"/>
<text text-anchor="middle" x="7238" y="-3572.8" font-family="Times,serif" font-size="22.12">similar_utils._cos_sim</text>
</a>
</g>
</g>
<!-- cluster_items.collect_clusters&#45;&gt;similar_utils._cos_sim -->
<g id="edge43" class="edge">
<title>cluster_items.collect_clusters&#45;&gt;similar_utils._cos_sim</title>
<path fill="none" stroke="black" d="M6359.67,-3428.02C6590.85,-3467.67 6941.86,-3527.87 7121.79,-3558.73"/>
<polygon fill="black" stroke="black" points="7121.36,-3562.21 7131.81,-3560.45 7122.54,-3555.31 7121.36,-3562.21"/>
</g>
<!-- cluster_items.main -->
<g id="node41" class="node">
<title>cluster_items.main</title>
<g id="a_node41"><a xlink:title="Cluster items and save the result.">
<polygon fill="none" stroke="black" points="5409,-3428.49 5190,-3428.49 5190,-3392.49 5409,-3392.49 5409,-3428.49"/>
<text text-anchor="middle" x="5299.5" y="-3405.19" font-family="Times,serif" font-size="21.00">cluster_items.main</text>
</a>
</g>
</g>
<!-- cluster_items.main&#45;&gt;notes_utils.write_json -->
<g id="edge46" class="edge">
<title>cluster_items.main&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M5409.14,-3414.1C5467.46,-3409.77 5535.33,-3393.4 5575,-3345.49 5631.75,-3276.96 5548.88,-2609.2 5611,-2545.49 5695.3,-2459.05 7686.53,-2396.89 7783,-2469.49 7829.19,-2504.26 7772.81,-2559.73 7819,-2594.49 7905.2,-2659.37 8704.85,-2660.75 8790,-2594.49 8841.38,-2554.51 8784.16,-2502.38 8826,-2452.49 8883.8,-2383.58 8980.31,-2345.39 9053.81,-2325.15"/>
<polygon fill="black" stroke="black" points="9054.81,-2328.5 9063.56,-2322.53 9053,-2321.74 9054.81,-2328.5"/>
</g>
<!-- cluster_items.main&#45;&gt;log_utils.install_excepthook -->
<g id="edge45" class="edge">
<title>cluster_items.main&#45;&gt;log_utils.install_excepthook</title>
<path fill="none" stroke="black" d="M5333.34,-3428.68C5394.4,-3464.61 5523.82,-3551.21 5575,-3665.49 5616.17,-3757.44 5540.91,-5406.13 5611,-5478.49 5655.38,-5524.31 5808.45,-5527.95 5937.44,-5521.91"/>
<polygon fill="black" stroke="black" points="5937.65,-5525.41 5947.47,-5521.42 5937.31,-5518.42 5937.65,-5525.41"/>
</g>
<!-- cluster_items.main&#45;&gt;oom_utils.prefer_oom_kill -->
<g id="edge47" class="edge">
<title>cluster_items.main&#45;&gt;oom_utils.prefer_oom_kill</title>
<path fill="none" stroke="black" d="M5331.09,-3428.76C5389.49,-3465.45 5516.26,-3554.18 5575,-3665.49 5625.34,-3760.89 5529.79,-3834.51 5611,-3905.49 5658.48,-3947 7540.11,-3944.11 8129.11,-3942.18"/>
<polygon fill="black" stroke="black" points="8129.41,-3945.68 8139.39,-3942.14 8129.38,-3938.68 8129.41,-3945.68"/>
</g>
<!-- cluster_items.main&#45;&gt;cluster_items.collect_clusters -->
<g id="edge44" class="edge">
<title>cluster_items.main&#45;&gt;cluster_items.collect_clusters</title>
<path fill="none" stroke="black" d="M5409.33,-3407.75C5471.72,-3406.17 5554.92,-3404.07 5642.66,-3401.86"/>
<polygon fill="black" stroke="black" points="5642.91,-3405.36 5652.82,-3401.61 5642.73,-3398.36 5642.91,-3405.36"/>
</g>
<!-- debug_dump.parse_url -->
<g id="node42" class="node">
<title>debug_dump.parse_url</title>
<g id="a_node42"><a xlink:title="Return ``(lot_id, lang)`` extracted from ``url``.">
<polygon fill="none" stroke="black" points="7387.5,-2241.49 7088.5,-2241.49 7088.5,-2205.49 7387.5,-2205.49 7387.5,-2241.49"/>
<text text-anchor="middle" x="7238" y="-2217.62" font-family="Times,serif" font-size="24.22">debug_dump.parse_url</text>
</a>
</g>
</g>
<!-- debug_dump.guess_source_from_lot -->
<g id="node43" class="node">
<title>debug_dump.guess_source_from_lot</title>
<g id="a_node43"><a xlink:title="Guess ``(chat, message_id)`` directly from ``lot_id``.">
<polygon fill="none" stroke="black" points="8525.5,-2442.49 8083.5,-2442.49 8083.5,-2406.49 8525.5,-2406.49 8525.5,-2442.49"/>
<text text-anchor="middle" x="8304.5" y="-2418.9" font-family="Times,serif" font-size="23.24">debug_dump.guess_source_from_lot</text>
</a>
</g>
</g>
<!-- debug_dump.load_source_info -->
<g id="node44" class="node">
<title>debug_dump.load_source_info</title>
<g id="a_node44"><a xlink:title="Return ``(chat, message_id)`` for ``lot_id`` if available.">
<polygon fill="none" stroke="black" points="7492,-2302.99 6984,-2302.99 6984,-2259.99 7492,-2259.99 7492,-2302.99"/>
<text text-anchor="middle" x="7238" y="-2273.34" font-family="Times,serif" font-size="32.06">debug_dump.load_source_info</text>
</a>
</g>
</g>
<!-- debug_dump.load_source_info&#45;&gt;notes_utils.load_json -->
<g id="edge48" class="edge">
<title>debug_dump.load_source_info&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M7492.18,-2298.41C7613.69,-2300.52 7741.75,-2291.85 7783,-2250.49 7886.89,-2146.34 7715.36,-1693.89 7819,-1589.49 7971.31,-1436.07 8618.6,-1661.25 8790,-1529.49 8830.11,-1498.66 8786.2,-1452.73 8826,-1421.49 8888.31,-1372.58 8979.3,-1368.67 9049.73,-1375.4"/>
<polygon fill="black" stroke="black" points="9049.65,-1378.91 9059.96,-1376.46 9050.38,-1371.95 9049.65,-1378.91"/>
</g>
<!-- debug_dump.load_source_info&#45;&gt;lot_io.lot_json_path -->
<g id="edge49" class="edge">
<title>debug_dump.load_source_info&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M7492.28,-2280.78C7726.57,-2280.12 8061.37,-2279.18 8217.37,-2278.74"/>
<polygon fill="black" stroke="black" points="8217.84,-2282.23 8227.83,-2278.71 8217.82,-2275.23 8217.84,-2282.23"/>
</g>
<!-- lot_io.parse_lot_id -->
<g id="node149" class="node">
<title>lot_io.parse_lot_id</title>
<g id="a_node149"><a xlink:title="Return ``(relative_path, index)`` extracted from ``lot_id``.">
<polygon fill="none" stroke="black" points="9280.5,-5217.49 9030.5,-5217.49 9030.5,-5181.49 9280.5,-5181.49 9280.5,-5217.49"/>
<text text-anchor="middle" x="9155.5" y="-5193.33" font-family="Times,serif" font-size="25.20">lot_io.parse_lot_id</text>
</a>
</g>
</g>
<!-- lot_io.lot_json_path&#45;&gt;lot_io.parse_lot_id -->
<g id="edge260" class="edge">
<title>lot_io.lot_json_path&#45;&gt;lot_io.parse_lot_id</title>
<path fill="none" stroke="black" d="M8381.01,-2262.12C8489.77,-2243.51 8688.55,-2229 8790,-2343.49 8842.1,-2402.29 8772.49,-5113.97 8826,-5171.49 8852.17,-5199.63 8941.24,-5205.95 9020.04,-5205.61"/>
<polygon fill="black" stroke="black" points="9020.12,-5209.11 9030.09,-5205.53 9020.06,-5202.11 9020.12,-5209.11"/>
</g>
<!-- debug_dump.run_tg_fetch -->
<g id="node46" class="node">
<title>debug_dump.run_tg_fetch</title>
<g id="a_node46"><a xlink:title="Run ``tg_client.py &#45;&#45;fetch`` and return combined logs.">
<polygon fill="none" stroke="black" points="9381.5,-1101.49 8929.5,-1101.49 8929.5,-1057.49 9381.5,-1057.49 9381.5,-1101.49"/>
<text text-anchor="middle" x="9155.5" y="-1071.17" font-family="Times,serif" font-size="32.90">debug_dump.run_tg_fetch</text>
</a>
</g>
</g>
<!-- debug_dump.run_tg_fetch&#45;&gt;notes_utils.read_text -->
<g id="edge50" class="edge">
<title>debug_dump.run_tg_fetch&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M9381.82,-1081.82C9421.55,-1092.78 9458.58,-1111.81 9485,-1143.49 9539.71,-1209.1 9481.53,-4142.74 9521,-4218.49 9565.25,-4303.42 9666.42,-4359.21 9730.6,-4387.48"/>
<polygon fill="black" stroke="black" points="9729.22,-4390.7 9739.79,-4391.45 9732,-4384.27 9729.22,-4390.7"/>
</g>
<!-- notes_utils.read_text&#45;&gt;notes_utils.read_text -->
<g id="edge238" class="edge">
<title>notes_utils.read_text&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M9681.28,-4424.75C9649.38,-4435.22 9685.12,-4445.49 9788.5,-4445.49 9878.15,-4445.49 9916.93,-4437.77 9904.85,-4428.89"/>
<polygon fill="black" stroke="black" points="9906.27,-4425.69 9895.72,-4424.75 9903.38,-4432.07 9906.27,-4425.69"/>
</g>
<!-- debug_dump.collect_files -->
<g id="node48" class="node">
<title>debug_dump.collect_files</title>
<g id="a_node48"><a xlink:title="Return ``[(name, content), ...]`` for files related to ``lot_id``.">
<polygon fill="none" stroke="black" points="7485,-1771.99 6991,-1771.99 6991,-1722.99 7485,-1722.99 7485,-1771.99"/>
<text text-anchor="middle" x="7238" y="-1738.31" font-family="Times,serif" font-size="37.10">debug_dump.collect_files</text>
</a>
</g>
</g>
<!-- debug_dump.collect_files&#45;&gt;post_io.raw_post_path -->
<g id="edge54" class="edge">
<title>debug_dump.collect_files&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7485.33,-1731.21C7609.15,-1728.96 7741.58,-1737.62 7783,-1780.49 7836.21,-1835.57 7775.53,-3095.44 7819,-3158.49 7909.81,-3290.21 8104.64,-3334.87 8217.63,-3349.93"/>
<polygon fill="black" stroke="black" points="8217.26,-3353.41 8227.63,-3351.21 8218.15,-3346.46 8217.26,-3353.41"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;caption_io.caption_json_path -->
<g id="edge51" class="edge">
<title>debug_dump.collect_files&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M7326.71,-1722.94C7445.99,-1695.42 7658.71,-1668.07 7783,-1780.49 7857.13,-1847.54 7745.25,-1935.03 7819,-2002.49 7824.67,-2007.68 8734.26,-2069.94 9048.88,-2091.33"/>
<polygon fill="black" stroke="black" points="9048.7,-2094.83 9058.92,-2092.01 9049.18,-2087.84 9048.7,-2094.83"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;caption_io.has_caption -->
<g id="edge52" class="edge">
<title>debug_dump.collect_files&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M7485.31,-1731.59C7608.91,-1729.47 7741.12,-1738.15 7783,-1780.49 7839.79,-1837.92 7762.12,-2449.15 7819,-2506.49 7872.6,-2560.53 8091.86,-2552.24 8216.26,-2542.68"/>
<polygon fill="black" stroke="black" points="8216.83,-2546.15 8226.52,-2541.88 8216.28,-2539.17 8216.83,-2546.15"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;notes_utils.load_json -->
<g id="edge56" class="edge">
<title>debug_dump.collect_files&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M7485.05,-1732.59C7588.92,-1714.3 7703.88,-1676.42 7783,-1599.49 7822.62,-1560.97 7775.37,-1514.4 7819,-1480.49 7904.27,-1414.22 8684.88,-1462.24 8790,-1437.49 8807.04,-1433.48 8809.04,-1425.83 8826,-1421.49 8888.89,-1405.43 8960.55,-1398.3 9020.85,-1395.34"/>
<polygon fill="black" stroke="black" points="9021.37,-1398.82 9031.2,-1394.87 9021.05,-1391.83 9021.37,-1398.82"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;lot_io.lot_json_path -->
<g id="edge57" class="edge">
<title>debug_dump.collect_files&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M7485.14,-1732.13C7608.45,-1730.21 7740.46,-1738.9 7783,-1780.49 7851.88,-1847.84 7752.69,-2142.62 7819,-2212.49 7920.72,-2319.67 8108.11,-2311.61 8217.64,-2295.48"/>
<polygon fill="black" stroke="black" points="8218.31,-2298.91 8227.66,-2293.94 8217.25,-2291.99 8218.31,-2298.91"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;notes_utils.read_text -->
<g id="edge55" class="edge">
<title>debug_dump.collect_files&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M7330,-1722.89C7438.06,-1693.65 7623.74,-1643.28 7783,-1599.49 7799.01,-1595.09 7802.55,-1591.74 7819,-1589.49 8246.6,-1531.21 8360.12,-1551.44 8790,-1589.49 9102.54,-1617.16 9281.83,-1474.38 9485,-1713.49 9575.12,-1819.56 9456.52,-4095.15 9521,-4218.49 9565.36,-4303.36 9666.5,-4359.17 9730.64,-4387.46"/>
<polygon fill="black" stroke="black" points="9729.26,-4390.67 9739.83,-4391.43 9732.04,-4384.25 9729.26,-4390.67"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;caption_io.read_caption -->
<g id="edge53" class="edge">
<title>debug_dump.collect_files&#45;&gt;caption_io.read_caption</title>
<path fill="none" stroke="black" d="M7485.25,-1731.65C7608.82,-1729.56 7741.04,-1738.24 7783,-1780.49 7888.22,-1886.45 7713.63,-2345.69 7819,-2451.49 7861.54,-2494.21 8007.91,-2497.92 8128.74,-2492.88"/>
<polygon fill="black" stroke="black" points="8129.03,-2496.37 8138.87,-2492.44 8128.73,-2489.38 8129.03,-2496.37"/>
</g>
<!-- caption_io.read_caption&#45;&gt;caption_io.caption_json_path -->
<g id="edge82" class="edge">
<title>caption_io.read_caption&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M8470.27,-2490.66C8591.63,-2495.16 8743.33,-2491.79 8790,-2451.49 8849.77,-2399.88 8778.97,-2340.93 8826,-2277.49 8888.13,-2193.69 9001.63,-2144.58 9077.56,-2119.62"/>
<polygon fill="black" stroke="black" points="9078.65,-2122.94 9087.1,-2116.55 9076.5,-2116.28 9078.65,-2122.94"/>
</g>
<!-- caption_io.read_caption&#45;&gt;notes_utils.load_json -->
<g id="edge85" class="edge">
<title>caption_io.read_caption&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M8470.04,-2492.64C8592.86,-2498.45 8746.64,-2495.85 8790,-2451.49 8870.05,-2369.6 8746.95,-1504.35 8826,-1421.49 8888.47,-1356.01 8999.12,-1361.13 9074.59,-1374.61"/>
<polygon fill="black" stroke="black" points="9074.06,-1378.07 9084.53,-1376.47 9075.35,-1371.19 9074.06,-1378.07"/>
</g>
<!-- caption_io.read_caption&#45;&gt;caption_io.caption_md_path -->
<g id="edge83" class="edge">
<title>caption_io.read_caption&#45;&gt;caption_io.caption_md_path</title>
<path fill="none" stroke="black" d="M8470.2,-2479.49C8642.32,-2479.49 8907.03,-2479.49 9051.58,-2479.49"/>
<polygon fill="black" stroke="black" points="9051.78,-2482.99 9061.78,-2479.49 9051.78,-2475.99 9051.78,-2482.99"/>
</g>
<!-- caption_io.read_caption&#45;&gt;caption_io._get_langs -->
<g id="edge81" class="edge">
<title>caption_io.read_caption&#45;&gt;caption_io._get_langs</title>
<path fill="none" stroke="black" d="M8470.27,-2491.97C8592.54,-2497.32 8745.45,-2494.43 8790,-2451.49 8851.07,-2392.63 8786.65,-2146.64 8826,-2071.49 8890.55,-1948.22 9035.42,-1857.53 9109.31,-1817.39"/>
<polygon fill="black" stroke="black" points="9111.23,-1820.33 9118.39,-1812.52 9107.92,-1814.16 9111.23,-1820.33"/>
</g>
<!-- caption_io.read_caption&#45;&gt;notes_utils.read_md -->
<g id="edge84" class="edge">
<title>caption_io.read_caption&#45;&gt;notes_utils.read_md</title>
<path fill="none" stroke="black" d="M8470.23,-2471.56C8589.79,-2469 8739.12,-2473.4 8790,-2507.49 9058.51,-2687.43 9135.11,-3122.78 9151,-3238.08"/>
<polygon fill="black" stroke="black" points="9147.56,-3238.77 9152.35,-3248.22 9154.5,-3237.84 9147.56,-3238.77"/>
</g>
<!-- debug_dump.delete_files -->
<g id="node50" class="node">
<title>debug_dump.delete_files</title>
<g id="a_node50"><a xlink:title="Remove files related to ``lot_id`` from the filesystem.">
<polygon fill="none" stroke="black" points="7453.5,-1953.49 7022.5,-1953.49 7022.5,-1909.49 7453.5,-1909.49 7453.5,-1953.49"/>
<text text-anchor="middle" x="7238" y="-1923.17" font-family="Times,serif" font-size="32.90">debug_dump.delete_files</text>
</a>
</g>
</g>
<!-- debug_dump.delete_files&#45;&gt;post_io.raw_post_path -->
<g id="edge60" class="edge">
<title>debug_dump.delete_files&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7453.56,-1931.07C7586.14,-1935.84 7739.09,-1952.2 7783,-2000.49 7869.6,-2095.74 7745.67,-3052.69 7819,-3158.49 7910.14,-3289.99 8104.85,-3334.73 8217.72,-3349.86"/>
<polygon fill="black" stroke="black" points="8217.35,-3353.34 8227.71,-3351.15 8218.24,-3346.4 8217.35,-3353.34"/>
</g>
<!-- debug_dump.delete_files&#45;&gt;caption_io.caption_json_path -->
<g id="edge58" class="edge">
<title>debug_dump.delete_files&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M7453.71,-1920.57C7583.75,-1918.64 7733.73,-1926.26 7783,-1967.49 7833.92,-2010.1 7766.7,-2071.59 7819,-2112.49 7903.98,-2178.96 8682.13,-2114.56 8790,-2112.49 8877.23,-2110.82 8976.14,-2106.89 9048.89,-2103.62"/>
<polygon fill="black" stroke="black" points="9049.15,-2107.11 9058.98,-2103.16 9048.83,-2100.12 9049.15,-2107.11"/>
</g>
<!-- debug_dump.delete_files&#45;&gt;notes_utils.load_json -->
<g id="edge61" class="edge">
<title>debug_dump.delete_files&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M7453.77,-1946.67C7585,-1950.9 7736.32,-1945.01 7783,-1900.49 7838.62,-1847.44 7764.14,-1610.32 7819,-1556.49 7973.58,-1404.82 8602.63,-1582.09 8790,-1473.49 8814.32,-1459.4 8801.66,-1435.55 8826,-1421.49 8884.21,-1387.88 8958.17,-1379.43 9021.16,-1380.13"/>
<polygon fill="black" stroke="black" points="9021.11,-1383.63 9031.17,-1380.32 9021.24,-1376.63 9021.11,-1383.63"/>
</g>
<!-- debug_dump.delete_files&#45;&gt;lot_io.lot_json_path -->
<g id="edge62" class="edge">
<title>debug_dump.delete_files&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M7453.53,-1918.78C7584.66,-1915.97 7735.97,-1923.3 7783,-1967.49 7874.12,-2053.11 7727.88,-2160.88 7819,-2246.49 7874.65,-2298.77 8094.16,-2293.09 8217.75,-2285.29"/>
<polygon fill="black" stroke="black" points="8218.19,-2288.77 8227.94,-2284.63 8217.73,-2281.79 8218.19,-2288.77"/>
</g>
<!-- debug_dump.delete_files&#45;&gt;caption_io.caption_md_path -->
<g id="edge59" class="edge">
<title>debug_dump.delete_files&#45;&gt;caption_io.caption_md_path</title>
<path fill="none" stroke="black" d="M7453.84,-1918.01C7585.1,-1914.81 7736.43,-1921.82 7783,-1966.49 7837.67,-2018.94 7763.68,-2253.74 7819,-2305.49 7858.43,-2342.37 8737.07,-2332.87 8790,-2343.49 8909.38,-2367.46 9041.37,-2425.11 9109.02,-2457.12"/>
<polygon fill="black" stroke="black" points="9107.6,-2460.32 9118.13,-2461.46 9110.61,-2454 9107.6,-2460.32"/>
</g>
<!-- debug_dump._message_reason -->
<g id="node52" class="node">
<title>debug_dump._message_reason</title>
<g id="a_node52"><a xlink:title="Return explanation why a message would be skipped.">
<polygon fill="none" stroke="black" points="9428,-5162.99 8883,-5162.99 8883,-5117.99 9428,-5117.99 9428,-5162.99"/>
<text text-anchor="middle" x="9155.5" y="-5132.11" font-family="Times,serif" font-size="33.60">debug_dump._message_reason</text>
</a>
</g>
</g>
<!-- moderation.should_skip_user -->
<g id="node53" class="node">
<title>moderation.should_skip_user</title>
<g id="a_node53"><a xlink:title="Return ``True`` if ``username`` is blacklisted.">
<polygon fill="none" stroke="black" points="9912.5,-5158.49 9664.5,-5158.49 9664.5,-5122.49 9912.5,-5122.49 9912.5,-5158.49"/>
<text text-anchor="middle" x="9788.5" y="-5136.45" font-family="Times,serif" font-size="15.68">moderation.should_skip_user</text>
</a>
</g>
</g>
<!-- debug_dump._message_reason&#45;&gt;moderation.should_skip_user -->
<g id="edge63" class="edge">
<title>debug_dump._message_reason&#45;&gt;moderation.should_skip_user</title>
<path fill="none" stroke="black" d="M9428.22,-5140.49C9506.48,-5140.49 9588.41,-5140.49 9654.23,-5140.49"/>
<polygon fill="black" stroke="black" points="9654.24,-5143.99 9664.24,-5140.49 9654.24,-5136.99 9654.24,-5143.99"/>
</g>
<!-- debug_dump._lot_reason -->
<g id="node54" class="node">
<title>debug_dump._lot_reason</title>
<g id="a_node54"><a xlink:title="Return explanation why ``lot`` would be skipped.">
<polygon fill="none" stroke="black" points="9309.5,-1758.49 9001.5,-1758.49 9001.5,-1722.49 9309.5,-1722.49 9309.5,-1758.49"/>
<text text-anchor="middle" x="9155.5" y="-1734.9" font-family="Times,serif" font-size="23.24">debug_dump._lot_reason</text>
</a>
</g>
</g>
<!-- debug_dump.moderation_summary -->
<g id="node55" class="node">
<title>debug_dump.moderation_summary</title>
<g id="a_node55"><a xlink:title="Return a multi&#45;line summary of moderation checks for ``lot_id``.">
<polygon fill="none" stroke="black" points="7684.5,-2837.49 6791.5,-2837.49 6791.5,-2775.49 7684.5,-2775.49 7684.5,-2837.49"/>
<text text-anchor="middle" x="7238" y="-2794.29" font-family="Times,serif" font-size="49.00">debug_dump.moderation_summary</text>
</a>
</g>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;post_io.read_post -->
<g id="edge66" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7684.56,-2834.05C7718.02,-2838.95 7751.14,-2844.72 7783,-2851.49 7935.32,-2883.87 8104.23,-2948.59 8207.14,-2991.47"/>
<polygon fill="black" stroke="black" points="8206.01,-2994.79 8216.58,-2995.42 8208.71,-2988.33 8206.01,-2994.79"/>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;post_io.raw_post_path -->
<g id="edge67" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7565.69,-2837.57C7646.69,-2860.35 7726.41,-2898.19 7783,-2960.49 7843.14,-3026.7 7762.73,-3088.97 7819,-3158.49 7918.86,-3281.87 8107.79,-3329.51 8217.9,-3347.34"/>
<polygon fill="black" stroke="black" points="8217.56,-3350.83 8227.98,-3348.93 8218.64,-3343.92 8217.56,-3350.83"/>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;notes_utils.load_json -->
<g id="edge68" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M7684.77,-2806C7729.38,-2797.87 7764.9,-2785.3 7783,-2766.49 7863.16,-2683.16 7737.76,-1808.77 7819,-1726.49 7894.89,-1649.63 8710.24,-1753.32 8790,-1680.49 8875.82,-1602.13 8741.55,-1501.33 8826,-1421.49 8889.44,-1361.51 8993.95,-1363.44 9068.03,-1374.78"/>
<polygon fill="black" stroke="black" points="9067.85,-1378.3 9078.28,-1376.44 9068.97,-1371.39 9067.85,-1378.3"/>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;lot_io.lot_json_path -->
<g id="edge69" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M7684.51,-2805.04C7728.97,-2797.03 7764.52,-2784.76 7783,-2766.49 7850.09,-2700.17 7753.93,-2411.8 7819,-2343.49 7920.9,-2236.53 8108.22,-2244.98 8217.69,-2261.34"/>
<polygon fill="black" stroke="black" points="8217.29,-2264.82 8227.71,-2262.89 8218.37,-2257.9 8217.29,-2264.82"/>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;debug_dump._message_reason -->
<g id="edge64" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;debug_dump._message_reason</title>
<path fill="none" stroke="black" d="M7592.07,-2837.55C7666,-2860.99 7735.77,-2899.15 7783,-2960.49 7853.2,-3051.67 7738.52,-4949.24 7819,-5031.49 7856.76,-5070.08 8736.38,-5063.26 8790,-5069.49 8878.38,-5079.77 8977.4,-5099.6 9049.91,-5115.7"/>
<polygon fill="black" stroke="black" points="9049.43,-5119.18 9059.96,-5117.94 9050.96,-5112.35 9049.43,-5119.18"/>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;debug_dump._lot_reason -->
<g id="edge65" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;debug_dump._lot_reason</title>
<path fill="none" stroke="black" d="M7684.75,-2805.99C7729.36,-2797.85 7764.89,-2785.29 7783,-2766.49 7860.66,-2685.85 7738.99,-1837.8 7819,-1759.49 7860.2,-1719.17 8643.67,-1730.04 8991.04,-1736.89"/>
<polygon fill="black" stroke="black" points="8991.12,-1740.39 9001.18,-1737.09 8991.26,-1733.39 8991.12,-1740.39"/>
</g>
<!-- debug_dump.main -->
<g id="node56" class="node">
<title>debug_dump.main</title>
<g id="a_node56"><a xlink:title="Collect log and data files related to a single lot.">
<polygon fill="none" stroke="black" points="6374,-2290.99 5894,-2290.99 5894,-2227.99 6374,-2227.99 6374,-2290.99"/>
<text text-anchor="middle" x="6134" y="-2247.34" font-family="Times,serif" font-size="49.56">debug_dump.main</text>
</a>
</g>
</g>
<!-- debug_dump.main&#45;&gt;oom_utils.prefer_oom_kill -->
<g id="edge77" class="edge">
<title>debug_dump.main&#45;&gt;oom_utils.prefer_oom_kill</title>
<path fill="none" stroke="black" d="M6175.75,-2291.21C6277.69,-2373.21 6543.62,-2604.06 6657,-2864.49 6686.27,-2931.72 6639.28,-3142.58 6693,-3192.49 6781.79,-3274.98 7695.8,-3147.33 7783,-3231.49 7863.95,-3309.63 7753.55,-3644.98 7819,-3736.49 7897.46,-3846.2 8046.61,-3897.55 8158.8,-3921.37"/>
<polygon fill="black" stroke="black" points="8158.35,-3924.85 8168.85,-3923.45 8159.77,-3917.99 8158.35,-3924.85"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.parse_url -->
<g id="edge70" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.parse_url</title>
<path fill="none" stroke="black" d="M6374.12,-2251.68C6587.48,-2244.71 6893.86,-2234.7 7078.34,-2228.68"/>
<polygon fill="black" stroke="black" points="7078.51,-2232.17 7088.4,-2228.35 7078.29,-2225.18 7078.51,-2232.17"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.guess_source_from_lot -->
<g id="edge71" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.guess_source_from_lot</title>
<path fill="none" stroke="black" d="M6374.07,-2284.56C6472.73,-2294.17 6588.28,-2304.5 6693,-2311.49 6813.94,-2319.56 7673.92,-2302.63 7783,-2355.49 7805.12,-2366.21 7796.96,-2386.6 7819,-2397.49 7931.2,-2452.93 8076.33,-2453.12 8178.39,-2443.51"/>
<polygon fill="black" stroke="black" points="8178.83,-2446.99 8188.44,-2442.52 8178.15,-2440.02 8178.83,-2446.99"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.load_source_info -->
<g id="edge72" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.load_source_info</title>
<path fill="none" stroke="black" d="M6374.12,-2264.27C6550.96,-2267.8 6791.71,-2272.6 6973.98,-2276.24"/>
<polygon fill="black" stroke="black" points="6973.91,-2279.74 6983.98,-2276.44 6974.05,-2272.74 6973.91,-2279.74"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.run_tg_fetch -->
<g id="edge73" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.run_tg_fetch</title>
<path fill="none" stroke="black" d="M6357.65,-2227.92C6466.25,-2200.28 6588.04,-2148.49 6657,-2051.49 6709.14,-1978.16 6630.33,-1307.05 6693,-1242.49 6862.18,-1068.21 7591.36,-1310.72 7783,-1161.49 7822.92,-1130.41 7777.95,-1083.08 7819,-1053.49 7906.52,-990.41 8682.18,-1049.65 8790,-1053.49 8831.76,-1054.98 8876.16,-1057.42 8919.08,-1060.23"/>
<polygon fill="black" stroke="black" points="8918.88,-1063.73 8929.08,-1060.9 8919.34,-1056.74 8918.88,-1063.73"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.collect_files -->
<g id="edge74" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.collect_files</title>
<path fill="none" stroke="black" d="M6344,-2227.99C6454.08,-2200.26 6581.53,-2148.36 6657,-2051.49 6731.67,-1955.64 6604.07,-1863.28 6693,-1780.49 6735.27,-1741.14 6860.91,-1731.82 6980.81,-1732.83"/>
<polygon fill="black" stroke="black" points="6980.87,-1736.33 6990.91,-1732.94 6980.95,-1729.33 6980.87,-1736.33"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.delete_files -->
<g id="edge75" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.delete_files</title>
<path fill="none" stroke="black" d="M6272.81,-2227.95C6385.01,-2197.09 6542.95,-2141.41 6657,-2051.49 6678.79,-2034.31 6669.22,-2014.78 6693,-2000.49 6787.76,-1943.54 6908.5,-1924.06 7012.14,-1919.78"/>
<polygon fill="black" stroke="black" points="7012.57,-1923.26 7022.44,-1919.4 7012.32,-1916.27 7012.57,-1923.26"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.moderation_summary -->
<g id="edge76" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.moderation_summary</title>
<path fill="none" stroke="black" d="M6342.51,-2290.99C6453.18,-2318.93 6581.7,-2371.36 6657,-2469.49 6737.94,-2574.98 6596.79,-2674.72 6693,-2766.49 6710.29,-2782.99 6741.9,-2794.53 6781.52,-2802.44"/>
<polygon fill="black" stroke="black" points="6781,-2805.9 6791.48,-2804.32 6782.3,-2799.02 6781,-2805.9"/>
</g>
<!-- caption_io._get_langs&#45;&gt;config_utils.load_config -->
<g id="edge78" class="edge">
<title>caption_io._get_langs&#45;&gt;config_utils.load_config</title>
<path fill="none" stroke="black" d="M9259.31,-1812.51C9329.56,-1818.96 9421.14,-1815.16 9485,-1767.49 9738.62,-1578.18 9779.66,-1145.87 9786.25,-1022.14"/>
<polygon fill="black" stroke="black" points="9789.75,-1022.28 9786.74,-1012.12 9782.76,-1021.94 9789.75,-1022.28"/>
</g>
<!-- notes_utils.read_md&#45;&gt;notes_utils.read_text -->
<g id="edge239" class="edge">
<title>notes_utils.read_md&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M9197.24,-3284.53C9270.17,-3319.3 9421.35,-3403.22 9485,-3526.49 9555.65,-3663.32 9447.11,-4083.39 9521,-4218.49 9566.98,-4302.57 9667.75,-4358.67 9731.35,-4387.23"/>
<polygon fill="black" stroke="black" points="9730.28,-4390.58 9740.84,-4391.41 9733.1,-4384.17 9730.28,-4390.58"/>
</g>
<!-- log_utils._add_exc_line -->
<g id="node60" class="node">
<title>log_utils._add_exc_line</title>
<g id="a_node60"><a xlink:title="Attach ``line`` from traceback to structured log events.">
<polygon fill="none" stroke="black" points="6275.5,-5699.49 5992.5,-5699.49 5992.5,-5663.49 6275.5,-5663.49 6275.5,-5699.49"/>
<text text-anchor="middle" x="6134" y="-5675.9" font-family="Times,serif" font-size="23.24">log_utils._add_exc_line</text>
</a>
</g>
</g>
<!-- log_utils._add_exc_line&#45;&gt;log_utils._extract_tb_lineno -->
<g id="edge90" class="edge">
<title>log_utils._add_exc_line&#45;&gt;log_utils._extract_tb_lineno</title>
<path fill="none" stroke="black" d="M6275.69,-5681.49C6492.52,-5681.49 6904.93,-5681.49 7111.92,-5681.49"/>
<polygon fill="black" stroke="black" points="7112.23,-5684.99 7122.23,-5681.49 7112.23,-5677.99 7112.23,-5684.99"/>
</g>
<!-- log_utils.init_logger -->
<g id="node61" class="node">
<title>log_utils.init_logger</title>
<g id="a_node61"><a xlink:title="Initialize logger writing to ``LOGFILE``.&#10;&#10;``LOG_LEVEL`` may be set in ``config.py`` or via an environment&#10;variable. &#160;The level accepts ``DEBUG``, ``INFO`` or ``ERROR`` and&#10;defaults to ``INFO``. &#160;The function falls back to the standard&#10;``logging`` module if ``structlog`` isn&#39;t available so the scripts&#10;can still run in minimal environments.">
<polygon fill="none" stroke="black" points="6481.5,-5799.49 5786.5,-5799.49 5786.5,-5717.49 6481.5,-5717.49 6481.5,-5799.49"/>
<text text-anchor="middle" x="6134" y="-5741.51" font-family="Times,serif" font-size="67.48">log_utils.init_logger</text>
</a>
</g>
</g>
<!-- log_utils.init_logger&#45;&gt;log_utils._extract_tb_lineno -->
<g id="edge91" class="edge">
<title>log_utils.init_logger&#45;&gt;log_utils._extract_tb_lineno</title>
<path fill="none" stroke="black" d="M6481.79,-5734.26C6696.74,-5719.24 6960,-5700.85 7112.11,-5690.22"/>
<polygon fill="black" stroke="black" points="7112.69,-5693.69 7122.42,-5689.5 7112.2,-5686.7 7112.69,-5693.69"/>
</g>
<!-- log_utils.get_logger -->
<g id="node62" class="node">
<title>log_utils.get_logger</title>
<g id="a_node62"><a xlink:title="Return the singleton logger instance.">
<polygon fill="none" stroke="black" points="7306.5,-5776.49 7169.5,-5776.49 7169.5,-5740.49 7306.5,-5740.49 7306.5,-5776.49"/>
<text text-anchor="middle" x="7238" y="-5755.25" font-family="Times,serif" font-size="12.18">log_utils.get_logger</text>
</a>
</g>
</g>
<!-- log_utils.init_logger&#45;&gt;log_utils.get_logger -->
<g id="edge92" class="edge">
<title>log_utils.init_logger&#45;&gt;log_utils.get_logger</title>
<path fill="none" stroke="black" d="M6481.79,-5752.17C6721.09,-5751.12 7020.25,-5752 7159.29,-5754.82"/>
<polygon fill="black" stroke="black" points="7159.35,-5758.32 7169.42,-5755.04 7159.5,-5751.32 7159.35,-5758.32"/>
</g>
<!-- log_utils.get_logger&#45;&gt;log_utils.init_logger -->
<g id="edge93" class="edge">
<title>log_utils.get_logger&#45;&gt;log_utils.init_logger</title>
<path fill="none" stroke="black" d="M7169.42,-5761.95C7037.1,-5764.9 6735.47,-5765.87 6491.88,-5764.86"/>
<polygon fill="black" stroke="black" points="6491.8,-5761.36 6481.79,-5764.81 6491.77,-5768.36 6491.8,-5761.36"/>
</g>
<!-- testing_mode.apply_testing_mode -->
<g id="node64" class="node">
<title>testing_mode.apply_testing_mode</title>
<g id="a_node64"><a xlink:title="Tweak environment variables when ``TEST_MODE`` is set.">
<polygon fill="none" stroke="black" points="282,-5699.49 0,-5699.49 0,-5663.49 282,-5663.49 282,-5699.49"/>
<text text-anchor="middle" x="141" y="-5677.45" font-family="Times,serif" font-size="15.68">testing_mode.apply_testing_mode</text>
</a>
</g>
</g>
<!-- similar:cli -->
<g id="node65" class="node">
<title>similar:cli</title>
<g id="a_node65"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="602" cy="-5681.49" rx="29.05" ry="18"/>
<text text-anchor="middle" x="602" y="-5679.89" font-family="Times,serif" font-size="7.00">similar:cli</text>
</a>
</g>
</g>
<!-- testing_mode.apply_testing_mode&#45;&gt;similar:cli -->
<!-- caption:cli -->
<g id="node183" class="node">
<title>caption:cli</title>
<g id="a_node183"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="1278.5" cy="-5681.49" rx="30.28" ry="18"/>
<text text-anchor="middle" x="1278.5" y="-5679.89" font-family="Times,serif" font-size="7.00">caption:cli</text>
</a>
</g>
</g>
<!-- similar:cli&#45;&gt;caption:cli -->
<!-- post_io.get_contact -->
<g id="node66" class="node">
<title>post_io.get_contact</title>
<g id="a_node66"><a xlink:title="Return a contact identifier from ``meta`` or ``None`` when missing.">
<polygon fill="none" stroke="black" points="7337.5,-5569.49 7138.5,-5569.49 7138.5,-5533.49 7337.5,-5533.49 7337.5,-5569.49"/>
<text text-anchor="middle" x="7238" y="-5546.71" font-family="Times,serif" font-size="18.48">post_io.get_contact</text>
</a>
</g>
</g>
<!-- post_io.get_timestamp -->
<g id="node67" class="node">
<title>post_io.get_timestamp</title>
<g id="a_node67"><a xlink:title="Return ``meta[&#39;date&#39;]`` as a timezone&#45;aware ``datetime``.">
<polygon fill="none" stroke="black" points="7409.5,-5515.49 7066.5,-5515.49 7066.5,-5475.49 7409.5,-5475.49 7409.5,-5515.49"/>
<text text-anchor="middle" x="7238" y="-5488.42" font-family="Times,serif" font-size="28.84">post_io.get_timestamp</text>
</a>
</g>
</g>
<!-- post_io.write_post -->
<g id="node69" class="node">
<title>post_io.write_post</title>
<g id="a_node69"><a xlink:title="Write metadata and body as a Markdown post.">
<polygon fill="none" stroke="black" points="6300,-5469.49 5968,-5469.49 5968,-5423.49 6300,-5423.49 6300,-5469.49"/>
<text text-anchor="middle" x="6134" y="-5438.05" font-family="Times,serif" font-size="34.30">post_io.write_post</text>
</a>
</g>
</g>
<!-- post_io.write_post&#45;&gt;post_io.get_contact -->
<g id="edge101" class="edge">
<title>post_io.write_post&#45;&gt;post_io.get_contact</title>
<path fill="none" stroke="black" d="M6294.49,-5423.48C6402.81,-5415.44 6545.99,-5420.14 6657,-5478.49 6679.98,-5490.57 6669.95,-5512.55 6693,-5524.49 6831.34,-5596.19 7016.97,-5586.78 7131.7,-5570.96"/>
<polygon fill="black" stroke="black" points="7132.48,-5574.39 7141.89,-5569.52 7131.5,-5567.46 7132.48,-5574.39"/>
</g>
<!-- post_io.write_post&#45;&gt;post_io.get_timestamp -->
<g id="edge102" class="edge">
<title>post_io.write_post&#45;&gt;post_io.get_timestamp</title>
<path fill="none" stroke="black" d="M6300.28,-5453.84C6503.28,-5462.87 6846.43,-5478.13 7056.25,-5487.46"/>
<polygon fill="black" stroke="black" points="7056.31,-5490.96 7066.45,-5487.91 7056.62,-5483.97 7056.31,-5490.96"/>
</g>
<!-- notes_utils.write_md -->
<g id="node70" class="node">
<title>notes_utils.write_md</title>
<g id="a_node70"><a xlink:title="Write ``text`` to ``path`` ensuring a trailing newline.">
<polygon fill="none" stroke="black" points="7351,-5363.49 7125,-5363.49 7125,-5327.49 7351,-5327.49 7351,-5363.49"/>
<text text-anchor="middle" x="7238" y="-5340.7" font-family="Times,serif" font-size="19.74">notes_utils.write_md</text>
</a>
</g>
</g>
<!-- post_io.write_post&#45;&gt;notes_utils.write_md -->
<g id="edge103" class="edge">
<title>post_io.write_post&#45;&gt;notes_utils.write_md</title>
<path fill="none" stroke="black" d="M6283.25,-5423.45C6395.48,-5406.83 6553.59,-5385.18 6693,-5372.49 6837.52,-5359.35 7004.25,-5352.26 7114.64,-5348.69"/>
<polygon fill="black" stroke="black" points="7114.93,-5352.18 7124.81,-5348.37 7114.7,-5345.19 7114.93,-5352.18"/>
</g>
<!-- post_io.raw_post_path_from_lot -->
<g id="node71" class="node">
<title>post_io.raw_post_path_from_lot</title>
<g id="a_node71"><a xlink:title="Return raw post path referenced by ``lot`` or ``None``.">
<polygon fill="none" stroke="black" points="7383,-3276.49 7093,-3276.49 7093,-3240.49 7383,-3240.49 7383,-3276.49"/>
<text text-anchor="middle" x="7238" y="-3254.33" font-family="Times,serif" font-size="17.08">post_io.raw_post_path_from_lot</text>
</a>
</g>
</g>
<!-- post_io.raw_post_path_from_lot&#45;&gt;post_io.raw_post_path -->
<g id="edge104" class="edge">
<title>post_io.raw_post_path_from_lot&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7383.24,-3264.25C7493,-3269.3 7647.71,-3277.82 7783,-3290.49 7936.63,-3304.88 8114.79,-3329.56 8217.79,-3344.61"/>
<polygon fill="black" stroke="black" points="8217.43,-3348.09 8227.83,-3346.08 8218.44,-3341.17 8217.43,-3348.09"/>
</g>
<!-- image_io.read_image_meta -->
<g id="node72" class="node">
<title>image_io.read_image_meta</title>
<g id="a_node72"><a xlink:title="Return metadata from ``path.with_suffix(&#39;.md&#39;)``.">
<polygon fill="none" stroke="black" points="7352.5,-4293.49 7123.5,-4293.49 7123.5,-4257.49 7352.5,-4257.49 7352.5,-4293.49"/>
<text text-anchor="middle" x="7238" y="-4271.45" font-family="Times,serif" font-size="15.68">image_io.read_image_meta</text>
</a>
</g>
</g>
<!-- notes_utils.parse_md -->
<g id="node73" class="node">
<title>notes_utils.parse_md</title>
<g id="a_node73"><a xlink:title="Return metadata dictionary and body text from ``path``.">
<polygon fill="none" stroke="black" points="8388,-4051.49 8221,-4051.49 8221,-4015.49 8388,-4015.49 8388,-4051.49"/>
<text text-anchor="middle" x="8304.5" y="-4029.79" font-family="Times,serif" font-size="14.00">notes_utils.parse_md</text>
</a>
</g>
</g>
<!-- image_io.read_image_meta&#45;&gt;notes_utils.parse_md -->
<g id="edge105" class="edge">
<title>image_io.read_image_meta&#45;&gt;notes_utils.parse_md</title>
<path fill="none" stroke="black" d="M7352.6,-4282.95C7472.26,-4284.73 7660.07,-4269.49 7783,-4171.49 7814.12,-4146.68 7786.98,-4113.14 7819,-4089.49 7933.16,-4005.19 8105.49,-4007.27 8210.91,-4018.75"/>
<polygon fill="black" stroke="black" points="8210.56,-4022.24 8220.9,-4019.89 8211.36,-4015.28 8210.56,-4022.24"/>
</g>
<!-- notes_utils.parse_md&#45;&gt;notes_utils.read_md -->
<g id="edge240" class="edge">
<title>notes_utils.parse_md&#45;&gt;notes_utils.read_md</title>
<path fill="none" stroke="black" d="M8366.06,-4051.52C8468.89,-4077.99 8677.4,-4113.01 8790,-4001.49 8865.22,-3927 8776.32,-3619.97 8826,-3526.49 8888.52,-3408.85 9029.74,-3326.45 9105.04,-3289.09"/>
<polygon fill="black" stroke="black" points="9106.89,-3292.08 9114.33,-3284.54 9103.81,-3285.79 9106.89,-3292.08"/>
</g>
<!-- notes_utils.parse_md&#45;&gt;notes_utils._parse_block -->
<g id="edge241" class="edge">
<title>notes_utils.parse_md&#45;&gt;notes_utils._parse_block</title>
<path fill="none" stroke="black" d="M8375.64,-4051.5C8478.53,-4073.41 8671.04,-4096.7 8790,-4001.49 8834.14,-3966.17 8796.99,-3928.02 8826,-3879.49 8905.75,-3746.1 9052.9,-3628.49 9119.79,-3579.16"/>
<polygon fill="black" stroke="black" points="9121.92,-3581.94 9127.92,-3573.21 9117.78,-3576.29 9121.92,-3581.94"/>
</g>
<!-- image_io.write_image_meta -->
<g id="node74" class="node">
<title>image_io.write_image_meta</title>
<g id="a_node74"><a xlink:title="Write ``meta`` to ``path.with_suffix(&#39;.md&#39;)``.">
<polygon fill="none" stroke="black" points="6251.5,-5119.49 6016.5,-5119.49 6016.5,-5083.49 6251.5,-5083.49 6251.5,-5119.49"/>
<text text-anchor="middle" x="6134" y="-5097.45" font-family="Times,serif" font-size="15.68">image_io.write_image_meta</text>
</a>
</g>
</g>
<!-- image_io.write_image_meta&#45;&gt;notes_utils.write_md -->
<g id="edge106" class="edge">
<title>image_io.write_image_meta&#45;&gt;notes_utils.write_md</title>
<path fill="none" stroke="black" d="M6182.75,-5119.5C6278.25,-5154.81 6500.18,-5233.36 6693,-5275.49 6836.1,-5306.76 7003.64,-5325.73 7114.58,-5335.88"/>
<polygon fill="black" stroke="black" points="7114.53,-5339.39 7124.81,-5336.81 7115.16,-5332.42 7114.53,-5339.39"/>
</g>
<!-- chop.has_misc_deal -->
<g id="node75" class="node">
<title>chop.has_misc_deal</title>
<g id="a_node75"><a xlink:title="Return True when any lot is classified as misc or announcement.">
<polygon fill="none" stroke="black" points="7352,-4553.49 7124,-4553.49 7124,-4517.49 7352,-4517.49 7352,-4553.49"/>
<text text-anchor="middle" x="7238" y="-4530.19" font-family="Times,serif" font-size="21.00">chop.has_misc_deal</text>
</a>
</g>
</g>
<!-- chop.process_message -->
<g id="node76" class="node">
<title>chop.process_message</title>
<g id="a_node76"><a xlink:title="Extract lots from ``msg_path`` and save them under ``LOTS_DIR``.">
<polygon fill="none" stroke="black" points="6635,-4661.49 5633,-4661.49 5633,-4559.49 6635,-4559.49 6635,-4661.49"/>
<text text-anchor="middle" x="6134" y="-4589.17" font-family="Times,serif" font-size="85.40">chop.process_message</text>
</a>
</g>
</g>
<!-- chop.process_message&#45;&gt;post_io.read_post -->
<g id="edge111" class="edge">
<title>chop.process_message&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M6635.1,-4571.17C6642.75,-4564.79 6650.07,-4557.9 6657,-4550.49 6714.37,-4489.16 6635.9,-3857.08 6693,-3795.49 7024.88,-3437.53 7448.08,-4015.62 7783,-3660.49 7867.95,-3570.42 7735.06,-3195.51 7819,-3104.49 7869.4,-3049.84 7941.9,-3024.24 8015.53,-3014.23"/>
<polygon fill="black" stroke="black" points="8015.97,-3017.7 8025.45,-3012.97 8015.09,-3010.75 8015.97,-3017.7"/>
</g>
<!-- chop.process_message&#45;&gt;moderation.should_skip_message -->
<g id="edge113" class="edge">
<title>chop.process_message&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M6635.16,-4621.8C7104.31,-4629.97 7740.27,-4633.76 7783,-4595.49 7833.18,-4550.55 7777.23,-4347.34 7819,-4294.49 7893.09,-4200.75 8021.44,-4156.37 8127.43,-4135.37"/>
<polygon fill="black" stroke="black" points="8128.13,-4138.8 8137.28,-4133.47 8126.8,-4131.92 8128.13,-4138.8"/>
</g>
<!-- chop.process_message&#45;&gt;caption_io.has_caption -->
<g id="edge108" class="edge">
<title>chop.process_message&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M6635.15,-4571.66C6642.8,-4565.14 6650.1,-4558.09 6657,-4550.49 6730.67,-4469.38 6615.87,-2656.32 6693,-2578.49 6720.02,-2551.22 7885.76,-2538.36 8216.72,-2535.25"/>
<polygon fill="black" stroke="black" points="8216.77,-2538.75 8226.73,-2535.16 8216.7,-2531.75 8216.77,-2538.75"/>
</g>
<!-- chop.process_message&#45;&gt;embed.embed_file -->
<g id="edge107" class="edge">
<title>chop.process_message&#45;&gt;embed.embed_file</title>
<path fill="none" stroke="black" d="M6635.18,-4569.85C6642.77,-4563.86 6650.05,-4557.41 6657,-4550.49 6752.78,-4455.11 6601.62,-4348.1 6693,-4248.49 6775.29,-4158.79 6908.63,-4130.07 7022.71,-4124"/>
<polygon fill="black" stroke="black" points="7023.16,-4127.48 7032.98,-4123.51 7022.83,-4120.49 7023.16,-4127.48"/>
</g>
<!-- chop.process_message&#45;&gt;caption_io.read_caption -->
<g id="edge109" class="edge">
<title>chop.process_message&#45;&gt;caption_io.read_caption</title>
<path fill="none" stroke="black" d="M6635.15,-4571.67C6642.8,-4565.14 6650.1,-4558.09 6657,-4550.49 6732.18,-4467.68 6614.63,-2617.3 6693,-2537.49 6791.73,-2436.96 7732.36,-2458.73 8128.74,-2472.58"/>
<polygon fill="black" stroke="black" points="8128.75,-2476.08 8138.87,-2472.93 8129,-2469.08 8128.75,-2476.08"/>
</g>
<!-- chop.process_message&#45;&gt;message_utils.build_prompt -->
<g id="edge110" class="edge">
<title>chop.process_message&#45;&gt;message_utils.build_prompt</title>
<path fill="none" stroke="black" d="M6635.13,-4596.92C7119.13,-4583.64 7780.42,-4565.04 7783,-4562.49 7852.6,-4493.7 7751.4,-3753.25 7819,-3682.49 7923.78,-3572.83 8120.08,-3596.39 8227.86,-3620.2"/>
<polygon fill="black" stroke="black" points="8227.17,-3623.63 8237.7,-3622.43 8228.72,-3616.81 8227.17,-3623.63"/>
</g>
<!-- chop.process_message&#45;&gt;chop.has_misc_deal -->
<g id="edge112" class="edge">
<title>chop.process_message&#45;&gt;chop.has_misc_deal</title>
<path fill="none" stroke="black" d="M6635.01,-4571.52C6654.59,-4570.13 6673.98,-4568.79 6693,-4567.49 6837.39,-4557.68 7003.47,-4548.17 7113.75,-4542.1"/>
<polygon fill="black" stroke="black" points="7114.12,-4545.59 7123.92,-4541.55 7113.74,-4538.6 7114.12,-4545.59"/>
</g>
<!-- lot_io.valid_lots -->
<g id="node77" class="node">
<title>lot_io.valid_lots</title>
<g id="a_node77"><a xlink:title="Return ``True`` when every lot contains the required translations.">
<polygon fill="none" stroke="black" points="8406.5,-4914.49 8202.5,-4914.49 8202.5,-4878.49 8406.5,-4878.49 8406.5,-4914.49"/>
<text text-anchor="middle" x="8304.5" y="-4890.62" font-family="Times,serif" font-size="24.22">lot_io.valid_lots</text>
</a>
</g>
</g>
<!-- chop.process_message&#45;&gt;lot_io.valid_lots -->
<g id="edge114" class="edge">
<title>chop.process_message&#45;&gt;lot_io.valid_lots</title>
<path fill="none" stroke="black" d="M6435.93,-4661.51C6517.79,-4689.02 6599.6,-4731.35 6657,-4796.49 6706.33,-4852.48 6634.85,-4913.72 6693,-4960.49 6740.19,-4998.45 7727.21,-4984.05 7783,-4960.49 7804.14,-4951.57 7798.12,-4933 7819,-4923.49 7937.9,-4869.34 8090.55,-4870.89 8192.42,-4880.53"/>
<polygon fill="black" stroke="black" points="8192.13,-4884.01 8202.43,-4881.51 8192.82,-4877.05 8192.13,-4884.01"/>
</g>
<!-- lot_io.needs_cleanup -->
<g id="node78" class="node">
<title>lot_io.needs_cleanup</title>
<g id="a_node78"><a xlink:title="Return ``True`` when ``clean_data`` would drop ``lots``.">
<polygon fill="none" stroke="black" points="8394,-4742.49 8215,-4742.49 8215,-4706.49 8394,-4706.49 8394,-4742.49"/>
<text text-anchor="middle" x="8304.5" y="-4720.45" font-family="Times,serif" font-size="15.68">lot_io.needs_cleanup</text>
</a>
</g>
</g>
<!-- chop.process_message&#45;&gt;lot_io.needs_cleanup -->
<g id="edge115" class="edge">
<title>chop.process_message&#45;&gt;lot_io.needs_cleanup</title>
<path fill="none" stroke="black" d="M6286.86,-4661.5C6397.91,-4696.01 6552.96,-4738.48 6693,-4756.49 7173.48,-4818.31 7299.71,-4789.89 7783,-4756.49 7799.12,-4755.38 7802.92,-4753.05 7819,-4751.49 7952.22,-4738.55 8106.69,-4731.27 8204.73,-4727.61"/>
<polygon fill="black" stroke="black" points="8205.06,-4731.1 8214.92,-4727.24 8204.8,-4724.11 8205.06,-4731.1"/>
</g>
<!-- token_utils.estimate_tokens -->
<g id="node79" class="node">
<title>token_utils.estimate_tokens</title>
<g id="a_node79"><a xlink:title="Return a naive token count approximation.">
<polygon fill="none" stroke="black" points="9273.5,-5271.49 9037.5,-5271.49 9037.5,-5235.49 9273.5,-5235.49 9273.5,-5271.49"/>
<text text-anchor="middle" x="9155.5" y="-5249.45" font-family="Times,serif" font-size="15.68">token_utils.estimate_tokens</text>
</a>
</g>
</g>
<!-- chop.process_message&#45;&gt;token_utils.estimate_tokens -->
<g id="edge116" class="edge">
<title>chop.process_message&#45;&gt;token_utils.estimate_tokens</title>
<path fill="none" stroke="black" d="M6455.26,-4661.51C6532.51,-4689.07 6607.07,-4731.43 6657,-4796.49 6717.53,-4875.38 6620.07,-5174.91 6693,-5242.49 6736.17,-5282.5 8528.83,-5261.78 9027.16,-5255.24"/>
<polygon fill="black" stroke="black" points="9027.31,-5258.74 9037.26,-5255.11 9027.22,-5251.74 9027.31,-5258.74"/>
</g>
<!-- chop.main -->
<g id="node80" class="node">
<title>chop.main</title>
<g id="a_node80"><a xlink:title="Process a single message file passed on the command line.">
<polygon fill="none" stroke="black" points="5375,-4628.49 5224,-4628.49 5224,-4592.49 5375,-4592.49 5375,-4628.49"/>
<text text-anchor="middle" x="5299.5" y="-4604.33" font-family="Times,serif" font-size="25.20">chop.main</text>
</a>
</g>
</g>
<!-- chop.main&#45;&gt;chop.process_message -->
<g id="edge117" class="edge">
<title>chop.main&#45;&gt;chop.process_message</title>
<path fill="none" stroke="black" d="M5375.11,-4610.49C5435.11,-4610.49 5525.22,-4610.49 5622.58,-4610.49"/>
<polygon fill="black" stroke="black" points="5622.63,-4613.99 5632.63,-4610.49 5622.63,-4606.99 5622.63,-4613.99"/>
</g>
<!-- price_train._iter_lots -->
<g id="node81" class="node">
<title>price_train._iter_lots</title>
<g id="a_node81"><a xlink:title="Return all lots with generated ids.">
<polygon fill="none" stroke="black" points="7393.5,-1828.99 7082.5,-1828.99 7082.5,-1789.99 7393.5,-1789.99 7393.5,-1828.99"/>
<text text-anchor="middle" x="7238" y="-1802.59" font-family="Times,serif" font-size="28.00">price_train._iter_lots</text>
</a>
</g>
</g>
<!-- price_train._iter_lots&#45;&gt;lot_io.read_lots -->
<g id="edge118" class="edge">
<title>price_train._iter_lots&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M7393.62,-1795.42C7535.4,-1786.33 7730.98,-1784.7 7783,-1838.49 7853.65,-1911.55 7749.58,-3593.27 7819,-3667.49 7923.03,-3778.71 8120.98,-3754.06 8228.86,-3729.78"/>
<polygon fill="black" stroke="black" points="8229.74,-3733.17 8238.7,-3727.51 8228.17,-3726.35 8229.74,-3733.17"/>
</g>
<!-- price_train._iter_lots&#45;&gt;lot_io.iter_lot_files -->
<g id="edge119" class="edge">
<title>price_train._iter_lots&#45;&gt;lot_io.iter_lot_files</title>
<path fill="none" stroke="black" d="M7393.51,-1820.67C7533.02,-1827.37 7725.04,-1827.07 7783,-1780.49 7829.73,-1742.94 7772.55,-1688.39 7819,-1650.49 7932.6,-1557.82 8115.42,-1575.82 8221,-1596.9"/>
<polygon fill="black" stroke="black" points="8220.48,-1600.36 8230.98,-1598.94 8221.88,-1593.5 8220.48,-1600.36"/>
</g>
<!-- price_train.main -->
<g id="node82" class="node">
<title>price_train.main</title>
<g id="a_node82"><a xlink:title="Train price regression model and save it.">
<polygon fill="none" stroke="black" points="6249,-1079.49 6019,-1079.49 6019,-1043.49 6249,-1043.49 6249,-1079.49"/>
<text text-anchor="middle" x="6134" y="-1055.33" font-family="Times,serif" font-size="25.20">price_train.main</text>
</a>
</g>
</g>
<!-- price_train.main&#45;&gt;similar_utils._load_embeddings -->
<g id="edge123" class="edge">
<title>price_train.main&#45;&gt;similar_utils._load_embeddings</title>
<path fill="none" stroke="black" d="M6249.04,-1062.66C6611.28,-1065.99 7715.85,-1073.09 7783,-1036.49 7808.33,-1022.69 7794.12,-997.09 7819,-982.49 7875.59,-949.3 7942.5,-932.76 8008.24,-925.83"/>
<polygon fill="black" stroke="black" points="8008.75,-929.29 8018.36,-924.83 8008.06,-922.33 8008.75,-929.29"/>
</g>
<!-- price_train.main&#45;&gt;similar_utils._sync_embeddings -->
<g id="edge124" class="edge">
<title>price_train.main&#45;&gt;similar_utils._sync_embeddings</title>
<path fill="none" stroke="black" d="M6202.27,-1079.58C6310.09,-1104.26 6523.04,-1134.71 6657,-1033.49 6696.36,-1003.75 6660.11,-965.26 6693,-928.49 6811.58,-795.95 7013.07,-726.03 7134.72,-694.06"/>
<polygon fill="black" stroke="black" points="7135.62,-697.45 7144.43,-691.55 7133.87,-690.67 7135.62,-697.45"/>
</g>
<!-- price_train.main&#45;&gt;price_train._iter_lots -->
<g id="edge120" class="edge">
<title>price_train.main&#45;&gt;price_train._iter_lots</title>
<path fill="none" stroke="black" d="M6249.18,-1072.72C6371.83,-1091.4 6561.9,-1140.91 6657,-1271.49 6723.76,-1363.15 6612.13,-1701.01 6693,-1780.49 6745.04,-1831.64 6931.97,-1831.67 7072.28,-1823.61"/>
<polygon fill="black" stroke="black" points="7072.53,-1827.11 7082.3,-1823.02 7072.11,-1820.12 7072.53,-1827.11"/>
</g>
<!-- price_utils.train_price_regression -->
<g id="node83" class="node">
<title>price_utils.train_price_regression</title>
<g id="a_node83"><a xlink:title="Return ``(model, currency_map, counts)`` trained on ``lots``.&#10;&#10;``lots`` must contain ``price`` and ``price:currency`` fields. Only lots with&#10;embeddings present in ``id_to_vec`` are considered. Prices are regressed on&#10;the logarithm scale so coefficients are interpretable as multiplicative&#10;factors. ``USD`` is treated as the base currency so coefficients can be&#10;interpreted as exchange rate multipliers. The returned ``counts`` dictionary&#10;maps each currency to the number of training samples observed.">
<polygon fill="none" stroke="black" points="7783,-398.99 6693,-398.99 6693,-321.99 7783,-321.99 7783,-398.99"/>
<text text-anchor="middle" x="7238" y="-344.59" font-family="Times,serif" font-size="63.00">price_utils.train_price_regression</text>
</a>
</g>
</g>
<!-- price_train.main&#45;&gt;price_utils.train_price_regression -->
<g id="edge121" class="edge">
<title>price_train.main&#45;&gt;price_utils.train_price_regression</title>
<path fill="none" stroke="black" d="M6191.64,-1079.61C6298.99,-1110 6532.41,-1156.61 6657,-1033.49 6743.96,-947.56 6613.67,-577.52 6693,-484.49 6723.01,-449.3 6760.75,-422.92 6802.29,-403.29"/>
<polygon fill="black" stroke="black" points="6803.86,-406.43 6811.5,-399.08 6800.95,-400.06 6803.86,-406.43"/>
</g>
<!-- price_utils.save_price_model -->
<g id="node84" class="node">
<title>price_utils.save_price_model</title>
<g id="a_node84"><a xlink:title="Write ``model`` parameters to ``path`` as JSON.">
<polygon fill="none" stroke="black" points="8517,-2203.99 8092,-2203.99 8092,-2164.99 8517,-2164.99 8517,-2203.99"/>
<text text-anchor="middle" x="8304.5" y="-2177.59" font-family="Times,serif" font-size="28.00">price_utils.save_price_model</text>
</a>
</g>
</g>
<!-- price_train.main&#45;&gt;price_utils.save_price_model -->
<g id="edge122" class="edge">
<title>price_train.main&#45;&gt;price_utils.save_price_model</title>
<path fill="none" stroke="black" d="M6249.07,-1073.55C6370.91,-1092.95 6559.61,-1143.07 6657,-1271.49 6701.31,-1329.92 6641.02,-1547.78 6693,-1599.49 6865.65,-1771.26 7611.63,-1540.44 7783,-1713.49 7842.69,-1773.76 7761.82,-2030.84 7819,-2093.49 7884.62,-2165.39 7987.56,-2191.36 8081.71,-2198.03"/>
<polygon fill="black" stroke="black" points="8081.76,-2201.54 8091.96,-2198.68 8082.2,-2194.55 8081.76,-2201.54"/>
</g>
<!-- price_utils.canonical_currency -->
<g id="node85" class="node">
<title>price_utils.canonical_currency</title>
<g id="a_node85"><a xlink:title="Return canonical currency code or ``None`` when unknown.">
<polygon fill="none" stroke="black" points="9335,-79.49 8976,-79.49 8976,-43.49 9335,-43.49 9335,-79.49"/>
<text text-anchor="middle" x="9155.5" y="-55.8" font-family="Times,serif" font-size="22.12">price_utils.canonical_currency</text>
</a>
</g>
</g>
<!-- price_utils.train_price_regression&#45;&gt;price_utils.canonical_currency -->
<g id="edge125" class="edge">
<title>price_utils.train_price_regression&#45;&gt;price_utils.canonical_currency</title>
<path fill="none" stroke="black" d="M7783.02,-397.05C8168.88,-410.66 8643.23,-398.37 8790,-270.49 8852.17,-216.32 8764.49,-143.4 8826,-88.49 8889.7,-31.62 8990.77,-31.88 9063.98,-41.99"/>
<polygon fill="black" stroke="black" points="9063.72,-45.49 9074.12,-43.48 9064.74,-38.56 9063.72,-45.49"/>
</g>
<!-- price_utils.save_price_model&#45;&gt;notes_utils.write_json -->
<g id="edge126" class="edge">
<title>price_utils.save_price_model&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M8517.08,-2191.91C8602.22,-2196.82 8701.11,-2204.98 8790,-2218.49 8892.53,-2234.08 9008.79,-2263.63 9081.87,-2283.69"/>
<polygon fill="black" stroke="black" points="9081.32,-2287.17 9091.89,-2286.45 9083.18,-2280.42 9081.32,-2287.17"/>
</g>
<!-- price_utils.fetch_official_rates -->
<g id="node86" class="node">
<title>price_utils.fetch_official_rates</title>
<g id="a_node86"><a xlink:title="Return currency multipliers relative to USD from NBG.">
<polygon fill="none" stroke="black" points="6451.5,-926.99 5816.5,-926.99 5816.5,-873.99 6451.5,-873.99 6451.5,-926.99"/>
<text text-anchor="middle" x="6134" y="-890.29" font-family="Times,serif" font-size="40.88">price_utils.fetch_official_rates</text>
</a>
</g>
</g>
<!-- price_utils.load_price_model -->
<g id="node87" class="node">
<title>price_utils.load_price_model</title>
<g id="a_node87"><a xlink:title="Return ``(model, currencies, counts)`` loaded from ``path``.">
<polygon fill="none" stroke="black" points="8539,-1104.49 8070,-1104.49 8070,-1062.49 8539,-1062.49 8539,-1104.49"/>
<text text-anchor="middle" x="8304.5" y="-1075.4" font-family="Times,serif" font-size="31.36">price_utils.load_price_model</text>
</a>
</g>
</g>
<!-- price_utils.load_price_model&#45;&gt;notes_utils.load_json -->
<g id="edge127" class="edge">
<title>price_utils.load_price_model&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M8539.01,-1075.4C8643.19,-1076.71 8751.16,-1086.48 8790,-1118.49 8837.26,-1157.44 8785.98,-1205.14 8826,-1251.49 8883.07,-1317.59 8976.35,-1354.2 9048.95,-1373.78"/>
<polygon fill="black" stroke="black" points="9048.49,-1377.28 9059.05,-1376.43 9050.27,-1370.51 9048.49,-1377.28"/>
</g>
<!-- price_utils.predict_price -->
<g id="node88" class="node">
<title>price_utils.predict_price</title>
<g id="a_node88"><a xlink:title="Return predicted price for ``vec`` in ``currency``.&#10;&#10;When ``model`` is ``None`` or ``vec`` is missing, ``None`` is returned.">
<polygon fill="none" stroke="black" points="7443,-303.99 7033,-303.99 7033,-260.99 7443,-260.99 7443,-303.99"/>
<text text-anchor="middle" x="7238" y="-274.34" font-family="Times,serif" font-size="32.06">price_utils.predict_price</text>
</a>
</g>
</g>
<!-- price_utils.currency_rates -->
<g id="node89" class="node">
<title>price_utils.currency_rates</title>
<g id="a_node89"><a xlink:title="Return estimated currency multipliers relative to the base.&#10;&#10;The regression model learns one coefficient per currency dummy feature. &#160;The&#10;coefficient is the logarithm of the multiplier relative to USD.">
<polygon fill="none" stroke="black" points="8498,-261.99 8111,-261.99 8111,-222.99 8498,-222.99 8498,-261.99"/>
<text text-anchor="middle" x="8304.5" y="-235.59" font-family="Times,serif" font-size="28.00">price_utils.currency_rates</text>
</a>
</g>
</g>
<!-- price_utils.guess_currency -->
<g id="node90" class="node">
<title>price_utils.guess_currency</title>
<g id="a_node90"><a xlink:title="Return currency with multiplier closest to ``price/pred_usd``.&#10;&#10;``pred_usd`` is the predicted price in USD. &#160;``price`` is the numeric value&#10;provided by the user without a currency. &#160;The function compares the implied&#10;multiplier ``price / pred_usd`` against the learnt exchange rates and picks&#10;the closest match. &#160;``counts`` may be provided to ignore rarely seen&#10;currencies when guessing. &#160;Any currency with fewer than ``min_samples``&#10;samples in the training set is skipped.">
<polygon fill="none" stroke="black" points="10056,-141.49 9521,-141.49 9521,-91.49 10056,-91.49 10056,-141.49"/>
<text text-anchor="middle" x="9788.5" y="-106.8" font-family="Times,serif" font-size="38.36">price_utils.guess_currency</text>
</a>
</g>
</g>
<!-- price_utils._guess_currency_verified -->
<g id="node91" class="node">
<title>price_utils._guess_currency_verified</title>
<g id="a_node91"><a xlink:title="Return currency when both AI and official rates agree.">
<polygon fill="none" stroke="black" points="9412,-135.49 8899,-135.49 8899,-97.49 9412,-97.49 9412,-135.49"/>
<text text-anchor="middle" x="9155.5" y="-109.76" font-family="Times,serif" font-size="27.16">price_utils._guess_currency_verified</text>
</a>
</g>
</g>
<!-- price_utils._guess_currency_verified&#45;&gt;price_utils.guess_currency -->
<g id="edge128" class="edge">
<title>price_utils._guess_currency_verified&#45;&gt;price_utils.guess_currency</title>
<path fill="none" stroke="black" d="M9412.24,-116.49C9444.67,-116.49 9477.98,-116.49 9510.72,-116.49"/>
<polygon fill="black" stroke="black" points="9510.86,-119.99 9520.86,-116.49 9510.86,-112.99 9510.86,-119.99"/>
</g>
<!-- price_utils.apply_price_model -->
<g id="node92" class="node">
<title>price_utils.apply_price_model</title>
<g id="a_node92"><a xlink:title="Predict prices in USD and guess missing currencies.">
<polygon fill="none" stroke="black" points="6494.5,-311.99 5773.5,-311.99 5773.5,-252.99 6494.5,-252.99 6494.5,-311.99"/>
<text text-anchor="middle" x="6134" y="-270.81" font-family="Times,serif" font-size="46.48">price_utils.apply_price_model</text>
</a>
</g>
</g>
<!-- price_utils.apply_price_model&#45;&gt;price_utils.train_price_regression -->
<g id="edge129" class="edge">
<title>price_utils.apply_price_model&#45;&gt;price_utils.train_price_regression</title>
<path fill="none" stroke="black" d="M6494.69,-307.95C6554.9,-312.21 6618.59,-316.72 6682.34,-321.23"/>
<polygon fill="black" stroke="black" points="6682.35,-324.74 6692.57,-321.96 6682.84,-317.76 6682.35,-324.74"/>
</g>
<!-- price_utils.apply_price_model&#45;&gt;price_utils.predict_price -->
<g id="edge130" class="edge">
<title>price_utils.apply_price_model&#45;&gt;price_utils.predict_price</title>
<path fill="none" stroke="black" d="M6494.69,-282.49C6669.19,-282.49 6872.92,-282.49 7022.76,-282.49"/>
<polygon fill="black" stroke="black" points="7023,-285.99 7033,-282.49 7023,-278.99 7023,-285.99"/>
</g>
<!-- price_utils.apply_price_model&#45;&gt;price_utils.currency_rates -->
<g id="edge131" class="edge">
<title>price_utils.apply_price_model&#45;&gt;price_utils.currency_rates</title>
<path fill="none" stroke="black" d="M6494.71,-259.86C6560.64,-256.47 6628.87,-253.45 6693,-251.49 7199.04,-236.03 7794.92,-237.94 8100.4,-240.38"/>
<polygon fill="black" stroke="black" points="8100.67,-243.88 8110.7,-240.46 8100.73,-236.88 8100.67,-243.88"/>
</g>
<!-- price_utils.apply_price_model&#45;&gt;price_utils._guess_currency_verified -->
<g id="edge132" class="edge">
<title>price_utils.apply_price_model&#45;&gt;price_utils._guess_currency_verified</title>
<path fill="none" stroke="black" d="M6462,-252.98C6537.8,-246.69 6618.18,-240.45 6693,-235.49 7113.22,-207.65 8342.82,-152.25 8888.44,-128.15"/>
<polygon fill="black" stroke="black" points="8888.97,-131.63 8898.81,-127.69 8888.66,-124.64 8888.97,-131.63"/>
</g>
<!-- price_utils.prepare_price_fields -->
<g id="node93" class="node">
<title>price_utils.prepare_price_fields</title>
<g id="a_node93"><a xlink:title="Add display price helpers to ``lots``.&#10;&#10;``rates`` maps currency codes to multipliers relative to USD and&#10;``cur`` is the display currency. ``_display_price`` is a formatted&#10;string in ``cur``. ``_usd_value`` stores the numeric USD value so&#10;the front&#45;end can switch currencies without rebuilding the site.&#10;Prices predicted by AI get ``_price_class`` set to ``ai&#45;price`` for&#10;styling.">
<polygon fill="none" stroke="black" points="8674.5,-90.49 7934.5,-90.49 7934.5,-32.49 8674.5,-32.49 8674.5,-90.49"/>
<text text-anchor="middle" x="8304.5" y="-50.2" font-family="Times,serif" font-size="45.36">price_utils.prepare_price_fields</text>
</a>
</g>
</g>
<!-- price_utils.prepare_price_fields&#45;&gt;price_utils.canonical_currency -->
<g id="edge133" class="edge">
<title>price_utils.prepare_price_fields&#45;&gt;price_utils.canonical_currency</title>
<path fill="none" stroke="black" d="M8674.8,-61.49C8775.24,-61.49 8879.87,-61.49 8965.69,-61.49"/>
<polygon fill="black" stroke="black" points="8965.79,-64.99 8975.79,-61.49 8965.79,-57.99 8965.79,-64.99"/>
</g>
<!-- build_site._load_ontology -->
<g id="node94" class="node">
<title>build_site._load_ontology</title>
<g id="a_node94"><a xlink:title="Return sorted field list from ``ONTOLOGY`` or empty list when missing.">
<polygon fill="none" stroke="black" points="8461,-839.49 8148,-839.49 8148,-803.49 8461,-803.49 8461,-839.49"/>
<text text-anchor="middle" x="8304.5" y="-815.9" font-family="Times,serif" font-size="23.24">build_site._load_ontology</text>
</a>
</g>
</g>
<!-- build_site._load_ontology&#45;&gt;notes_utils.load_json -->
<g id="edge134" class="edge">
<title>build_site._load_ontology&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M8461.01,-809.03C8584.73,-802.83 8744.39,-804.38 8790,-848.49 8854.63,-911 8773.42,-1178.56 8826,-1251.49 8874.55,-1318.84 8961.77,-1354.83 9034.14,-1373.86"/>
<polygon fill="black" stroke="black" points="9033.7,-1377.35 9044.25,-1376.43 9035.42,-1370.57 9033.7,-1377.35"/>
</g>
<!-- build_site._load_clusters -->
<g id="node95" class="node">
<title>build_site._load_clusters</title>
<g id="a_node95"><a xlink:title="Return precomputed item clusters.">
<polygon fill="none" stroke="black" points="8482,-785.49 8127,-785.49 8127,-747.49 8482,-747.49 8482,-785.49"/>
<text text-anchor="middle" x="8304.5" y="-759.76" font-family="Times,serif" font-size="27.16">build_site._load_clusters</text>
</a>
</g>
</g>
<!-- build_site._load_clusters&#45;&gt;notes_utils.load_json -->
<g id="edge135" class="edge">
<title>build_site._load_clusters&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M8482.1,-753.33C8602.36,-748.59 8747.19,-752.56 8790,-794.49 8862.78,-865.77 8766.86,-1168.55 8826,-1251.49 8874.03,-1318.85 8960.81,-1354.81 9033.12,-1373.83"/>
<polygon fill="black" stroke="black" points="9032.67,-1377.32 9043.22,-1376.4 9034.4,-1370.54 9032.67,-1377.32"/>
</g>
<!-- build_site._compile_locale -->
<g id="node96" class="node">
<title>build_site._compile_locale</title>
<g id="a_node96"><a xlink:title="Compile ``lang`` gettext catalogue when out of date.">
<polygon fill="none" stroke="black" points="7405,-1027.49 7071,-1027.49 7071,-991.49 7405,-991.49 7405,-1027.49"/>
<text text-anchor="middle" x="7238" y="-1003.62" font-family="Times,serif" font-size="24.22">build_site._compile_locale</text>
</a>
</g>
</g>
<!-- build_site._env_for_lang -->
<g id="node97" class="node">
<title>build_site._env_for_lang</title>
<g id="a_node97"><a xlink:title="Return Jinja environment configured for ``lang``.">
<polygon fill="none" stroke="black" points="6322.5,-1024.99 5945.5,-1024.99 5945.5,-983.99 6322.5,-983.99 6322.5,-1024.99"/>
<text text-anchor="middle" x="6134" y="-997.25" font-family="Times,serif" font-size="29.68">build_site._env_for_lang</text>
</a>
</g>
</g>
<!-- build_site._env_for_lang&#45;&gt;build_site._compile_locale -->
<g id="edge136" class="edge">
<title>build_site._env_for_lang&#45;&gt;build_site._compile_locale</title>
<path fill="none" stroke="black" d="M6322.56,-1005.34C6529.05,-1006.28 6858.46,-1007.78 7060.45,-1008.69"/>
<polygon fill="black" stroke="black" points="7060.55,-1012.19 7070.57,-1008.74 7060.58,-1005.19 7060.55,-1012.19"/>
</g>
<!-- build_site._iter_lots -->
<g id="node98" class="node">
<title>build_site._iter_lots</title>
<g id="a_node98"><a xlink:title="Return all lots ready for rendering.">
<polygon fill="none" stroke="black" points="7464,-3183.99 7012,-3183.99 7012,-3126.99 7464,-3126.99 7464,-3183.99"/>
<text text-anchor="middle" x="7238" y="-3144.6" font-family="Times,serif" font-size="44.24">build_site._iter_lots</text>
</a>
</g>
</g>
<!-- build_site._iter_lots&#45;&gt;post_io.read_post -->
<g id="edge137" class="edge">
<title>build_site._iter_lots&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7464.25,-3153.7C7562.94,-3149.35 7679.6,-3139.33 7783,-3117.49 7799.64,-3113.98 7802.5,-3108.64 7819,-3104.49 7881.84,-3088.71 7950.2,-3076.04 8015.24,-3066.01"/>
<polygon fill="black" stroke="black" points="8015.86,-3069.46 8025.22,-3064.49 8014.81,-3062.54 8015.86,-3069.46"/>
</g>
<!-- build_site._iter_lots&#45;&gt;post_io.raw_post_path -->
<g id="edge138" class="edge">
<title>build_site._iter_lots&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7464.11,-3162.29C7562.65,-3168.09 7679.22,-3178.78 7783,-3198.49 7955.81,-3231.31 8152.53,-3300.48 8247.01,-3335.78"/>
<polygon fill="black" stroke="black" points="8246.06,-3339.16 8256.65,-3339.39 8248.51,-3332.6 8246.06,-3339.16"/>
</g>
<!-- build_site._iter_lots&#45;&gt;moderation.should_skip_message -->
<g id="edge139" class="edge">
<title>build_site._iter_lots&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M7422.77,-3126.98C7543.32,-3119.63 7694.49,-3134.11 7783,-3231.49 7845.01,-3299.72 7756.18,-3993 7819,-4060.49 7919,-4167.93 8105.71,-4155.55 8215.86,-4136.35"/>
<polygon fill="black" stroke="black" points="8216.72,-4139.75 8225.94,-4134.54 8215.48,-4132.86 8216.72,-4139.75"/>
</g>
<!-- build_site._iter_lots&#45;&gt;moderation.should_skip_lot -->
<g id="edge140" class="edge">
<title>build_site._iter_lots&#45;&gt;moderation.should_skip_lot</title>
<path fill="none" stroke="black" d="M7464.1,-3150.42C7672.79,-3145.71 7977.26,-3138.85 8156.4,-3134.81"/>
<polygon fill="black" stroke="black" points="8156.51,-3138.31 8166.43,-3134.58 8156.35,-3131.31 8156.51,-3138.31"/>
</g>
<!-- build_site._iter_lots&#45;&gt;lot_io.read_lots -->
<g id="edge141" class="edge">
<title>build_site._iter_lots&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M7464.25,-3144.85C7593.41,-3144.03 7738.5,-3153.89 7783,-3198.49 7856.83,-3272.49 7745.45,-3593.22 7819,-3667.49 7925.14,-3774.69 8119.13,-3752.71 8226.64,-3729.65"/>
<polygon fill="black" stroke="black" points="8227.44,-3733.06 8236.45,-3727.49 8225.93,-3726.23 8227.44,-3733.06"/>
</g>
<!-- build_site._iter_lots&#45;&gt;lot_io.iter_lot_files -->
<g id="edge142" class="edge">
<title>build_site._iter_lots&#45;&gt;lot_io.iter_lot_files</title>
<path fill="none" stroke="black" d="M7464.18,-3169.08C7593.78,-3171.48 7739.37,-3163.05 7783,-3117.49 7835.2,-3062.99 7772.96,-1819.29 7819,-1759.49 7899.52,-1654.91 8052.94,-1624.23 8165.65,-1616.7"/>
<polygon fill="black" stroke="black" points="8165.97,-1620.18 8175.74,-1616.08 8165.54,-1613.2 8165.97,-1620.18"/>
</g>
<!-- build_site._copy_images -->
<g id="node99" class="node">
<title>build_site._copy_images</title>
<g id="a_node99"><a xlink:title="Copy media referenced by ``lots`` into ``VIEWS_DIR``.">
<polygon fill="none" stroke="black" points="9319,-737.49 8992,-737.49 8992,-701.49 9319,-701.49 9319,-737.49"/>
<text text-anchor="middle" x="9155.5" y="-713.33" font-family="Times,serif" font-size="25.20">build_site._copy_images</text>
</a>
</g>
</g>
<!-- build_site._copy_static -->
<g id="node100" class="node">
<title>build_site._copy_static</title>
<g id="a_node100"><a xlink:title="Copy CSS and JS so generated pages are standalone.">
<polygon fill="none" stroke="black" points="7366,-973.49 7110,-973.49 7110,-937.49 7366,-937.49 7366,-973.49"/>
<text text-anchor="middle" x="7238" y="-950.19" font-family="Times,serif" font-size="21.00">build_site._copy_static</text>
</a>
</g>
</g>
<!-- build_site._load_state -->
<g id="node101" class="node">
<title>build_site._load_state</title>
<g id="a_node101"><a xlink:title="Return ontology fields, embeddings, lots and similarity caches.">
<polygon fill="none" stroke="black" points="6325,-816.99 5943,-816.99 5943,-771.99 6325,-771.99 6325,-816.99"/>
<text text-anchor="middle" x="6134" y="-786.11" font-family="Times,serif" font-size="33.60">build_site._load_state</text>
</a>
</g>
</g>
<!-- build_site._load_state&#45;&gt;similar_utils._load_embeddings -->
<g id="edge147" class="edge">
<title>build_site._load_state&#45;&gt;similar_utils._load_embeddings</title>
<path fill="none" stroke="black" d="M6325.13,-787.39C6425.8,-788.72 6550.33,-798.56 6657,-831.49 6674.7,-836.96 6675.22,-847.31 6693,-852.49 6925.72,-920.36 7546.91,-840.51 7783,-895.49 7800.05,-899.46 7802.01,-907.28 7819,-911.49 7879.39,-926.47 7945.23,-935.56 8008.36,-940.9"/>
<polygon fill="black" stroke="black" points="8008.21,-944.4 8018.46,-941.73 8008.78,-937.42 8008.21,-944.4"/>
</g>
<!-- build_site._load_state&#45;&gt;similar_utils._load_similar -->
<g id="edge148" class="edge">
<title>build_site._load_state&#45;&gt;similar_utils._load_similar</title>
<path fill="none" stroke="black" d="M6200.59,-771.89C6303.9,-737.38 6511.45,-672.4 6693,-642.49 6785.46,-627.26 6887.8,-618.88 6978.54,-614.32"/>
<polygon fill="black" stroke="black" points="6978.87,-617.81 6988.69,-613.82 6978.53,-610.82 6978.87,-617.81"/>
</g>
<!-- build_site._load_state&#45;&gt;build_site._load_ontology -->
<g id="edge143" class="edge">
<title>build_site._load_state&#45;&gt;build_site._load_ontology</title>
<path fill="none" stroke="black" d="M6325.07,-796.86C6744.23,-802.08 7742.11,-814.5 8137.77,-819.43"/>
<polygon fill="black" stroke="black" points="8137.82,-822.93 8147.86,-819.55 8137.91,-815.93 8137.82,-822.93"/>
</g>
<!-- build_site._load_state&#45;&gt;build_site._load_clusters -->
<g id="edge144" class="edge">
<title>build_site._load_state&#45;&gt;build_site._load_clusters</title>
<path fill="none" stroke="black" d="M6325.07,-792.04C6736.91,-786.72 7707.43,-774.19 8116.49,-768.91"/>
<polygon fill="black" stroke="black" points="8116.69,-772.41 8126.64,-768.78 8116.6,-765.41 8116.69,-772.41"/>
</g>
<!-- build_site._load_state&#45;&gt;build_site._iter_lots -->
<g id="edge145" class="edge">
<title>build_site._load_state&#45;&gt;build_site._iter_lots</title>
<path fill="none" stroke="black" d="M6248.26,-771.96C6369.17,-755.25 6556.83,-751.83 6657,-864.49 6740.18,-958.05 6606.89,-3026.63 6693,-3117.49 6735.24,-3162.07 6874.39,-3171.23 7001.36,-3169.41"/>
<polygon fill="black" stroke="black" points="7001.71,-3172.91 7011.65,-3169.24 7001.59,-3165.91 7001.71,-3172.91"/>
</g>
<!-- build_site._load_state&#45;&gt;build_site._copy_images -->
<g id="edge146" class="edge">
<title>build_site._load_state&#45;&gt;build_site._copy_images</title>
<path fill="none" stroke="black" d="M6325.11,-785.16C6433,-780.07 6570.53,-773.92 6693,-769.49 7193.31,-751.4 7318.48,-748.94 7819,-738.49 8236.37,-729.78 8727.2,-723.92 8981.75,-721.22"/>
<polygon fill="black" stroke="black" points="8981.86,-724.72 8991.82,-721.11 8981.78,-717.72 8981.86,-724.72"/>
</g>
<!-- similar_utils._load_more_user -->
<g id="node102" class="node">
<title>similar_utils._load_more_user</title>
<g id="a_node102"><a xlink:title="Return cached per&#45;user lot mapping.">
<polygon fill="none" stroke="black" points="8563.5,-902.99 8045.5,-902.99 8045.5,-857.99 8563.5,-857.99 8563.5,-902.99"/>
<text text-anchor="middle" x="8304.5" y="-872.11" font-family="Times,serif" font-size="33.60">similar_utils._load_more_user</text>
</a>
</g>
</g>
<!-- build_site._load_state&#45;&gt;similar_utils._load_more_user -->
<g id="edge149" class="edge">
<title>build_site._load_state&#45;&gt;similar_utils._load_more_user</title>
<path fill="none" stroke="black" d="M6325.13,-803.48C6433.01,-808.46 6570.55,-814.62 6693,-819.49 7177.35,-838.79 7298.64,-838.35 7783,-857.49 7864.91,-860.73 7954.05,-864.56 8035.04,-868.15"/>
<polygon fill="black" stroke="black" points="8035.25,-871.66 8045.39,-868.61 8035.56,-864.67 8035.25,-871.66"/>
</g>
<!-- similar_utils._load_more_user&#45;&gt;notes_utils.load_json -->
<g id="edge265" class="edge">
<title>similar_utils._load_more_user&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M8563.57,-867.9C8660.89,-869 8756.28,-879.15 8790,-911.49 8844.83,-964.09 8781.06,-1190.23 8826,-1251.49 8875.37,-1318.79 8963.24,-1354.83 9035.68,-1373.89"/>
<polygon fill="black" stroke="black" points="9035.24,-1377.39 9045.8,-1376.47 9036.97,-1370.6 9035.24,-1377.39"/>
</g>
<!-- build_site._categorise -->
<g id="node103" class="node">
<title>build_site._categorise</title>
<g id="a_node103"><a xlink:title="Return category info and recent lot list.&#10;&#10;Categories are split by ``market:deal``. ``sell_item`` lots are further&#10;grouped by ``clusters`` when available and fall back to ``item:type``.&#10;Stats include price range, last timestamp and embedding centroid so the&#10;sorting logic used on item pages also works for categories.">
<polygon fill="none" stroke="black" points="8790,-4527.99 7819,-4527.99 7819,-4424.99 8790,-4424.99 8790,-4527.99"/>
<text text-anchor="middle" x="8304.5" y="-4454.55" font-family="Times,serif" font-size="86.80">build_site._categorise</text>
</a>
</g>
</g>
<!-- build_site._categorise&#45;&gt;lot_io.get_seller -->
<g id="edge150" class="edge">
<title>build_site._categorise&#45;&gt;lot_io.get_seller</title>
<path fill="none" stroke="black" d="M8790.14,-4434.25C8885.83,-4425.91 8977.36,-4417.93 9044.74,-4412.06"/>
<polygon fill="black" stroke="black" points="9045.27,-4415.53 9054.93,-4411.17 9044.66,-4408.55 9045.27,-4415.53"/>
</g>
<!-- build_site._render_site -->
<g id="node105" class="node">
<title>build_site._render_site</title>
<g id="a_node105"><a xlink:title="Render all HTML pages for ``lots`` using cached templates.&#10;&#10;``envs`` supplies jinja environments for every language so they are&#10;initialised only once. ``rates`` maps currency codes to multipliers relative&#10;to USD. &#160;The values are embedded into the pages so the front&#45;end can&#10;convert prices on the fly.">
<polygon fill="none" stroke="black" points="6657,-2042.99 5611,-2042.99 5611,-1935.99 6657,-1935.99 6657,-2042.99"/>
<text text-anchor="middle" x="6134" y="-1966.86" font-family="Times,serif" font-size="90.16">build_site._render_site</text>
</a>
</g>
</g>
<!-- build_site._render_site&#45;&gt;notes_utils.read_text -->
<g id="edge152" class="edge">
<title>build_site._render_site&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M6191.48,-1935.96C6299.61,-1830.13 6535.85,-1582.07 6657,-1325.49 6688.86,-1258.01 6635.56,-1209.14 6693,-1161.49 6786.26,-1084.13 7685.69,-1200.68 7783,-1128.49 7823.3,-1098.6 7778.25,-1050.77 7819,-1021.49 7906.61,-958.53 8682.13,-1019.4 8790,-1021.49 9099.06,-1027.49 9269.44,-826.93 9485,-1048.49 9546.41,-1111.61 9480.32,-4140.39 9521,-4218.49 9565.23,-4303.42 9666.41,-4359.21 9730.6,-4387.48"/>
<polygon fill="black" stroke="black" points="9729.22,-4390.7 9739.79,-4391.45 9732,-4384.27 9729.22,-4390.7"/>
</g>
<!-- build_site._render_site&#45;&gt;lot_io.get_seller -->
<g id="edge153" class="edge">
<title>build_site._render_site&#45;&gt;lot_io.get_seller</title>
<path fill="none" stroke="black" d="M6402.02,-2043.08C6498.86,-2076.69 6598.68,-2131 6657,-2218.49 6717.19,-2308.79 6617.82,-4093.23 6693,-4171.49 6733.42,-4213.57 8732.52,-4284.43 8790,-4294.49 8900.99,-4313.92 9026.05,-4355.47 9097.05,-4380.99"/>
<polygon fill="black" stroke="black" points="9096.11,-4384.37 9106.7,-4384.48 9098.49,-4377.79 9096.11,-4384.37"/>
</g>
<!-- build_site.build_page -->
<g id="node106" class="node">
<title>build_site.build_page</title>
<g id="a_node106"><a xlink:title="Render ``lot`` into separate HTML files for every language.&#10;&#10;``rates`` provides currency multipliers used by the front&#45;end for dynamic&#10;conversion. ``envs`` preloads jinja environments to avoid expensive&#10;reinitialisation for each page.">
<polygon fill="none" stroke="black" points="7707.5,-2111.49 6768.5,-2111.49 6768.5,-2009.49 7707.5,-2009.49 7707.5,-2111.49"/>
<text text-anchor="middle" x="7238" y="-2038.95" font-family="Times,serif" font-size="85.68">build_site.build_page</text>
</a>
</g>
</g>
<!-- build_site._render_site&#45;&gt;build_site.build_page -->
<g id="edge151" class="edge">
<title>build_site._render_site&#45;&gt;build_site.build_page</title>
<path fill="none" stroke="black" d="M6657.36,-2023.15C6690.87,-2025.31 6724.52,-2027.47 6757.82,-2029.62"/>
<polygon fill="black" stroke="black" points="6757.94,-2033.13 6768.14,-2030.29 6758.39,-2026.15 6757.94,-2033.13"/>
</g>
<!-- similar_utils._format_vector -->
<g id="node107" class="node">
<title>similar_utils._format_vector</title>
<g id="a_node107"><a xlink:title="Return compact JSON representation for ``vec``.">
<polygon fill="none" stroke="black" points="8469,-2388.49 8140,-2388.49 8140,-2352.49 8469,-2352.49 8469,-2388.49"/>
<text text-anchor="middle" x="8304.5" y="-2364.8" font-family="Times,serif" font-size="22.12">similar_utils._format_vector</text>
</a>
</g>
</g>
<!-- build_site._render_site&#45;&gt;similar_utils._format_vector -->
<g id="edge154" class="edge">
<title>build_site._render_site&#45;&gt;similar_utils._format_vector</title>
<path fill="none" stroke="black" d="M6657.03,-1976.41C7123.9,-1967.26 7741.13,-1962.59 7783,-2000.49 7839,-2051.18 7764.53,-2286.16 7819,-2338.49 7862.53,-2380.31 8009.01,-2385.36 8129.61,-2381.68"/>
<polygon fill="black" stroke="black" points="8129.84,-2385.18 8139.72,-2381.35 8129.61,-2378.18 8129.84,-2385.18"/>
</g>
<!-- build_site.build_page&#45;&gt;post_io.read_post -->
<g id="edge156" class="edge">
<title>build_site.build_page&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7671.43,-2111.59C7714.02,-2132.27 7752.62,-2159.87 7783,-2196.49 7869.55,-2300.84 7743.01,-2693.22 7819,-2805.49 7885.07,-2903.11 8004.54,-2959.96 8108.31,-2992.48"/>
<polygon fill="black" stroke="black" points="8107.39,-2995.86 8117.98,-2995.45 8109.45,-2989.17 8107.39,-2995.86"/>
</g>
<!-- build_site.build_page&#45;&gt;post_io.raw_post_path -->
<g id="edge157" class="edge">
<title>build_site.build_page&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7673.52,-2111.59C7715.45,-2132.32 7753.33,-2159.92 7783,-2196.49 7850.39,-2279.56 7757.79,-3070.77 7819,-3158.49 7910.55,-3289.7 8105.11,-3334.55 8217.84,-3349.77"/>
<polygon fill="black" stroke="black" points="8217.45,-3353.25 8227.82,-3351.07 8218.36,-3346.31 8217.45,-3353.25"/>
</g>
<!-- build_site.build_page&#45;&gt;caption_io.read_caption -->
<g id="edge155" class="edge">
<title>build_site.build_page&#45;&gt;caption_io.read_caption</title>
<path fill="none" stroke="black" d="M7707.6,-2071.62C7735.27,-2085.44 7760.82,-2103.11 7783,-2125.49 7885.61,-2229.03 7713.27,-2351.15 7819,-2451.49 7862.65,-2492.92 8008.46,-2496.83 8128.82,-2492.2"/>
<polygon fill="black" stroke="black" points="8129.06,-2495.69 8138.91,-2491.79 8128.78,-2488.7 8129.06,-2495.69"/>
</g>
<!-- build_site.build_page&#45;&gt;similar_utils._format_vector -->
<g id="edge158" class="edge">
<title>build_site.build_page&#45;&gt;similar_utils._format_vector</title>
<path fill="none" stroke="black" d="M7707.74,-2073.86C7735.15,-2087.21 7760.62,-2104.17 7783,-2125.49 7852.52,-2191.72 7747.76,-2274.13 7819,-2338.49 7863.72,-2378.89 8009.62,-2384.14 8129.73,-2380.91"/>
<polygon fill="black" stroke="black" points="8129.9,-2384.41 8139.8,-2380.62 8129.7,-2377.41 8129.9,-2384.41"/>
</g>
<!-- build_site.main -->
<g id="node108" class="node">
<title>build_site.main</title>
<g id="a_node108"><a xlink:title="Build the static site under ``VIEWS_DIR``.">
<polygon fill="none" stroke="black" points="5508.5,-851.99 5090.5,-851.99 5090.5,-786.99 5508.5,-786.99 5508.5,-851.99"/>
<text text-anchor="middle" x="5299.5" y="-806.44" font-family="Times,serif" font-size="51.94">build_site.main</text>
</a>
</g>
</g>
<!-- build_site.main&#45;&gt;similar_utils._sync_embeddings -->
<g id="edge170" class="edge">
<title>build_site.main&#45;&gt;similar_utils._sync_embeddings</title>
<path fill="none" stroke="black" d="M5456.28,-786.94C5505.57,-777.7 5560.39,-768.53 5611,-762.49 6097.02,-704.51 6669.29,-683.34 6988.9,-675.7"/>
<polygon fill="black" stroke="black" points="6989.3,-679.19 6999.22,-675.46 6989.14,-672.19 6989.3,-679.19"/>
</g>
<!-- build_site.main&#45;&gt;config_utils.load_config -->
<g id="edge159" class="edge">
<title>build_site.main&#45;&gt;config_utils.load_config</title>
<path fill="none" stroke="black" d="M5385.29,-786.96C5448.95,-757.76 5532.22,-708.34 5575,-636.49 5619.87,-561.14 5546.62,-303.05 5611,-243.49 5740.65,-123.55 8614.75,-191.53 8790,-213.49 9106.27,-253.13 9236.34,-191.08 9485,-390.49 9677.2,-544.63 9758.41,-852.93 9780.74,-954.89"/>
<polygon fill="black" stroke="black" points="9777.37,-955.88 9782.89,-964.93 9784.22,-954.42 9777.37,-955.88"/>
</g>
<!-- build_site.main&#45;&gt;price_utils.canonical_currency -->
<g id="edge160" class="edge">
<title>build_site.main&#45;&gt;price_utils.canonical_currency</title>
<path fill="none" stroke="black" d="M5386.32,-786.88C5450.1,-757.76 5533.03,-708.49 5575,-636.49 5630.43,-541.4 5530.9,-217.98 5611,-142.49 5675.27,-81.92 8702.75,-113.13 8790,-99.49 8806.53,-96.91 8809.57,-91.64 8826,-88.49 8870.9,-79.89 8919.77,-74.03 8965.75,-70.03"/>
<polygon fill="black" stroke="black" points="8966.15,-73.51 8975.82,-69.18 8965.57,-66.54 8966.15,-73.51"/>
</g>
<!-- build_site.main&#45;&gt;price_utils.fetch_official_rates -->
<g id="edge161" class="edge">
<title>build_site.main&#45;&gt;price_utils.fetch_official_rates</title>
<path fill="none" stroke="black" d="M5508.69,-847.76C5542.84,-851.98 5577.89,-856.06 5611,-859.49 5673.98,-866.02 5741.32,-872.03 5806,-877.32"/>
<polygon fill="black" stroke="black" points="5806.11,-880.84 5816.36,-878.16 5806.68,-873.86 5806.11,-880.84"/>
</g>
<!-- build_site.main&#45;&gt;price_utils.load_price_model -->
<g id="edge162" class="edge">
<title>build_site.main&#45;&gt;price_utils.load_price_model</title>
<path fill="none" stroke="black" d="M5508.81,-823.41C5875.65,-830.73 6603.47,-847.31 6657,-864.49 6675.31,-870.37 6674.7,-882.58 6693,-888.49 6808.33,-925.73 7675.61,-872.31 7783,-928.49 7806.63,-940.85 7796.58,-962.05 7819,-976.49 7890.33,-1022.44 7978.49,-1048.88 8059.97,-1064.01"/>
<polygon fill="black" stroke="black" points="8059.41,-1067.46 8069.87,-1065.79 8060.66,-1060.57 8059.41,-1067.46"/>
</g>
<!-- build_site.main&#45;&gt;price_utils.apply_price_model -->
<g id="edge163" class="edge">
<title>build_site.main&#45;&gt;price_utils.apply_price_model</title>
<path fill="none" stroke="black" d="M5364.59,-786.97C5424.04,-754.59 5512.5,-700.55 5575,-636.49 5595.92,-615.05 5589.33,-600.19 5611,-579.49 5741.97,-454.42 5935.51,-362.35 6046.43,-316.07"/>
<polygon fill="black" stroke="black" points="6048.01,-319.2 6055.91,-312.14 6045.33,-312.73 6048.01,-319.2"/>
</g>
<!-- build_site.main&#45;&gt;price_utils.prepare_price_fields -->
<g id="edge164" class="edge">
<title>build_site.main&#45;&gt;price_utils.prepare_price_fields</title>
<path fill="none" stroke="black" d="M5386.42,-786.94C5450.26,-757.85 5533.22,-708.6 5575,-636.49 5634.41,-533.97 5525.08,-186.09 5611,-104.49 5774.58,50.85 7222.07,-3.61 7924.44,-39.81"/>
<polygon fill="black" stroke="black" points="7924.3,-43.31 7934.47,-40.33 7924.66,-36.32 7924.3,-43.31"/>
</g>
<!-- build_site.main&#45;&gt;build_site._env_for_lang -->
<g id="edge165" class="edge">
<title>build_site.main&#45;&gt;build_site._env_for_lang</title>
<path fill="none" stroke="black" d="M5351.94,-852.01C5411.66,-887.89 5514.34,-943.94 5611,-969.49 5715.85,-997.21 5836.44,-1006.69 5935.29,-1008.91"/>
<polygon fill="black" stroke="black" points="5935.33,-1012.41 5945.4,-1009.11 5935.47,-1005.41 5935.33,-1012.41"/>
</g>
<!-- build_site.main&#45;&gt;build_site._copy_static -->
<g id="edge166" class="edge">
<title>build_site.main&#45;&gt;build_site._copy_static</title>
<path fill="none" stroke="black" d="M5367.01,-852.03C5428.61,-880.28 5523.61,-919.15 5611,-935.49 5894.56,-988.53 6761.66,-969.63 7099.87,-959.85"/>
<polygon fill="black" stroke="black" points="7100.07,-963.35 7109.97,-959.56 7099.87,-956.35 7100.07,-963.35"/>
</g>
<!-- build_site.main&#45;&gt;build_site._load_state -->
<g id="edge167" class="edge">
<title>build_site.main&#45;&gt;build_site._load_state</title>
<path fill="none" stroke="black" d="M5508.7,-813.24C5638.35,-809.35 5804.26,-804.36 5932.45,-800.52"/>
<polygon fill="black" stroke="black" points="5932.89,-804 5942.78,-800.2 5932.68,-797.01 5932.89,-804"/>
</g>
<!-- build_site.main&#45;&gt;build_site._categorise -->
<g id="edge168" class="edge">
<title>build_site.main&#45;&gt;build_site._categorise</title>
<path fill="none" stroke="black" d="M5371.45,-852.03C5437.71,-886.74 5532.58,-948.6 5575,-1034.49 5614.79,-1115.07 5550.93,-4202.65 5611,-4269.49 5934.68,-4629.66 6210.44,-4357.16 6693,-4397.49 6801.85,-4406.59 7376.65,-4433.96 7808.75,-4453.94"/>
<polygon fill="black" stroke="black" points="7808.78,-4457.45 7818.93,-4454.41 7809.11,-4450.45 7808.78,-4457.45"/>
</g>
<!-- build_site.main&#45;&gt;build_site._render_site -->
<g id="edge169" class="edge">
<title>build_site.main&#45;&gt;build_site._render_site</title>
<path fill="none" stroke="black" d="M5367.54,-852.12C5432.31,-887.48 5527.39,-950.32 5575,-1034.49 5639.16,-1147.93 5560.89,-1205.19 5611,-1325.49 5717.34,-1580.8 5950.33,-1820.33 6065.63,-1928.75"/>
<polygon fill="black" stroke="black" points="6063.36,-1931.42 6073.05,-1935.7 6068.15,-1926.31 6063.36,-1931.42"/>
</g>
<!-- tg_client._mark_activity -->
<g id="node109" class="node">
<title>tg_client._mark_activity</title>
<g id="a_node109"><a xlink:title="Update ``_last_event`` to the current time.">
<polygon fill="none" stroke="black" points="4836.5,-5645.49 4650.5,-5645.49 4650.5,-5609.49 4836.5,-5609.49 4836.5,-5645.49"/>
<text text-anchor="middle" x="4743.5" y="-5623.79" font-family="Times,serif" font-size="14.00">tg_client._mark_activity</text>
</a>
</g>
</g>
<!-- tg_client._heartbeat -->
<g id="node110" class="node">
<title>tg_client._heartbeat</title>
<g id="a_node110"><a xlink:title="Periodically log a heartbeat and warn if idle for too long.">
<polygon fill="none" stroke="black" points="1393.5,-5344.49 1163.5,-5344.49 1163.5,-5308.49 1393.5,-5308.49 1393.5,-5344.49"/>
<text text-anchor="middle" x="1278.5" y="-5321.19" font-family="Times,serif" font-size="21.00">tg_client._heartbeat</text>
</a>
</g>
</g>
<!-- tg_client._progress_logger -->
<g id="node111" class="node">
<title>tg_client._progress_logger</title>
<g id="a_node111"><a xlink:title="Return a progress callback that logs received bytes.">
<polygon fill="none" stroke="black" points="4927,-5334.99 4560,-5334.99 4560,-5297.99 4927,-5297.99 4927,-5334.99"/>
<text text-anchor="middle" x="4743.5" y="-5310.05" font-family="Times,serif" font-size="26.18">tg_client._progress_logger</text>
</a>
</g>
</g>
<!-- tg_client._write_md -->
<g id="node112" class="node">
<title>tg_client._write_md</title>
<g id="a_node112"><a xlink:title="Helper to store a raw post in Markdown format.">
<polygon fill="none" stroke="black" points="5368,-5515.49 5231,-5515.49 5231,-5479.49 5368,-5479.49 5368,-5515.49"/>
<text text-anchor="middle" x="5299.5" y="-5494.25" font-family="Times,serif" font-size="12.18">tg_client._write_md</text>
</a>
</g>
</g>
<!-- tg_client._write_md&#45;&gt;post_io.write_post -->
<g id="edge171" class="edge">
<title>tg_client._write_md&#45;&gt;post_io.write_post</title>
<path fill="none" stroke="black" d="M5368.27,-5493.34C5495.62,-5485.54 5774.3,-5468.47 5957.73,-5457.23"/>
<polygon fill="black" stroke="black" points="5957.99,-5460.72 5967.76,-5456.62 5957.56,-5453.73 5957.99,-5460.72"/>
</g>
<!-- tg_client._scan_group_cache -->
<g id="node113" class="node">
<title>tg_client._scan_group_cache</title>
<g id="a_node113"><a xlink:title="Build group_id &#45;&gt; Path mapping for ``chat`` quickly.">
<polygon fill="none" stroke="black" points="7477.5,-3847.99 6998.5,-3847.99 6998.5,-3804.99 7477.5,-3804.99 7477.5,-3847.99"/>
<text text-anchor="middle" x="7238" y="-3818.34" font-family="Times,serif" font-size="32.06">tg_client._scan_group_cache</text>
</a>
</g>
</g>
<!-- tg_client._scan_group_cache&#45;&gt;post_io.raw_post_path -->
<g id="edge172" class="edge">
<title>tg_client._scan_group_cache&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7477.59,-3839.67C7602.68,-3841.09 7738.9,-3832.11 7783,-3790.49 7877.13,-3701.65 7735.33,-3600.25 7819,-3501.49 7918.02,-3384.63 8107.25,-3360.18 8217.64,-3356.46"/>
<polygon fill="black" stroke="black" points="8217.85,-3359.95 8227.75,-3356.17 8217.65,-3352.96 8217.85,-3359.95"/>
</g>
<!-- tg_client._find_group_path -->
<g id="node114" class="node">
<title>tg_client._find_group_path</title>
<g id="a_node114"><a xlink:title="Return stored message path for ``group_id`` if known.">
<polygon fill="none" stroke="black" points="6267,-3842.49 6001,-3842.49 6001,-3806.49 6267,-3806.49 6267,-3842.49"/>
<text text-anchor="middle" x="6134" y="-3819.71" font-family="Times,serif" font-size="18.48">tg_client._find_group_path</text>
</a>
</g>
</g>
<!-- tg_client._find_group_path&#45;&gt;tg_client._scan_group_cache -->
<g id="edge173" class="edge">
<title>tg_client._find_group_path&#45;&gt;tg_client._scan_group_cache</title>
<path fill="none" stroke="black" d="M6267.11,-3824.73C6444.85,-3825.06 6764.47,-3825.64 6988.06,-3826.04"/>
<polygon fill="black" stroke="black" points="6988.29,-3829.54 6998.3,-3826.06 6988.3,-3822.54 6988.29,-3829.54"/>
</g>
<!-- tg_client._get_message_path -->
<g id="node115" class="node">
<title>tg_client._get_message_path</title>
<g id="a_node115"><a xlink:title="Return path of stored message ``msg_id`` in ``chat`` if any.">
<polygon fill="none" stroke="black" points="3128,-2886.49 2889,-2886.49 2889,-2850.49 3128,-2850.49 3128,-2886.49"/>
<text text-anchor="middle" x="3008.5" y="-2864.45" font-family="Times,serif" font-size="15.68">tg_client._get_message_path</text>
</a>
</g>
</g>
<!-- tg_client._get_message_path&#45;&gt;post_io.raw_post_path -->
<g id="edge174" class="edge">
<title>tg_client._get_message_path&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M3128.03,-2873.04C3678.65,-2895.39 5988.19,-3003.05 6657,-3259.49 6675.43,-3266.56 6674.34,-3279.05 6693,-3285.49 6807.57,-3325.05 7661.93,-3322.73 7783,-3328.49 7936.11,-3335.78 8114.44,-3346.12 8217.61,-3352.28"/>
<polygon fill="black" stroke="black" points="8217.47,-3355.78 8227.66,-3352.88 8217.89,-3348.79 8217.47,-3355.78"/>
</g>
<!-- tg_client._should_skip_media -->
<g id="node116" class="node">
<title>tg_client._should_skip_media</title>
<g id="a_node116"><a xlink:title="Return reason string if ``msg`` media should be skipped.">
<polygon fill="none" stroke="black" points="4988,-5240.99 4499,-5240.99 4499,-5197.99 4988,-5197.99 4988,-5240.99"/>
<text text-anchor="middle" x="4743.5" y="-5211.34" font-family="Times,serif" font-size="32.06">tg_client._should_skip_media</text>
</a>
</g>
</g>
<!-- tg_client._allowed_topic -->
<g id="node117" class="node">
<title>tg_client._allowed_topic</title>
<g id="a_node117"><a xlink:title="Return ``True`` if ``msg`` belongs to an allowed forum topic.">
<polygon fill="none" stroke="black" points="5511.5,-5204.99 5087.5,-5204.99 5087.5,-5159.99 5511.5,-5159.99 5511.5,-5204.99"/>
<text text-anchor="middle" x="5299.5" y="-5174.11" font-family="Times,serif" font-size="33.60">tg_client._allowed_topic</text>
</a>
</g>
</g>
<!-- tg_client._extract_author -->
<g id="node118" class="node">
<title>tg_client._extract_author</title>
<g id="a_node118"><a xlink:title="Return a metadata dictionary describing the message author.">
<polygon fill="none" stroke="black" points="6497,-5365.49 5771,-5365.49 5771,-5295.49 6497,-5295.49 6497,-5365.49"/>
<text text-anchor="middle" x="6134" y="-5316.69" font-family="Times,serif" font-size="56.00">tg_client._extract_author</text>
</a>
</g>
</g>
<!-- phone_utils.format_georgian -->
<g id="node119" class="node">
<title>phone_utils.format_georgian</title>
<g id="a_node119"><a xlink:title="Return ``phone`` in ``+995...`` format if possible.">
<polygon fill="none" stroke="black" points="7444,-5419.49 7032,-5419.49 7032,-5381.49 7444,-5381.49 7444,-5419.49"/>
<text text-anchor="middle" x="7238" y="-5393.76" font-family="Times,serif" font-size="27.16">phone_utils.format_georgian</text>
</a>
</g>
</g>
<!-- tg_client._extract_author&#45;&gt;phone_utils.format_georgian -->
<g id="edge175" class="edge">
<title>tg_client._extract_author&#45;&gt;phone_utils.format_georgian</title>
<path fill="none" stroke="black" d="M6497.36,-5359.02C6562.47,-5363.79 6629.74,-5368.48 6693,-5372.49 6801.24,-5379.35 6921.68,-5385.68 7021.66,-5390.59"/>
<polygon fill="black" stroke="black" points="7021.73,-5394.09 7031.89,-5391.09 7022.07,-5387.1 7021.73,-5394.09"/>
</g>
<!-- tg_client._schedule_caption -->
<g id="node120" class="node">
<title>tg_client._schedule_caption</title>
<g id="a_node120"><a xlink:title="Run captioning in a separate process so downloads continue.">
<polygon fill="none" stroke="black" points="7377,-5081.49 7099,-5081.49 7099,-5045.49 7377,-5045.49 7377,-5081.49"/>
<text text-anchor="middle" x="7238" y="-5058.71" font-family="Times,serif" font-size="18.48">tg_client._schedule_caption</text>
</a>
</g>
</g>
<!-- tg_client._schedule_chop -->
<g id="node121" class="node">
<title>tg_client._schedule_chop</title>
<g id="a_node121"><a xlink:title="Run lot extraction in a separate process.">
<polygon fill="none" stroke="black" points="8452.5,-5114.49 8156.5,-5114.49 8156.5,-5078.49 8452.5,-5078.49 8452.5,-5114.49"/>
<text text-anchor="middle" x="8304.5" y="-5090.8" font-family="Times,serif" font-size="22.12">tg_client._schedule_chop</text>
</a>
</g>
</g>
<!-- tg_client._enqueue_chop -->
<g id="node122" class="node">
<title>tg_client._enqueue_chop</title>
<g id="a_node122"><a xlink:title="Queue ``path`` for chopping once captions are available.">
<polygon fill="none" stroke="black" points="4986,-4564.99 4501,-4564.99 4501,-4515.99 4986,-4515.99 4986,-4564.99"/>
<text text-anchor="middle" x="4743.5" y="-4530.86" font-family="Times,serif" font-size="37.66">tg_client._enqueue_chop</text>
</a>
</g>
</g>
<!-- tg_client._enqueue_chop&#45;&gt;moderation.should_skip_message -->
<g id="edge178" class="edge">
<title>tg_client._enqueue_chop&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M4965.99,-4565.16C4973.92,-4570.45 4981.31,-4576.53 4988,-4583.49 5070.93,-4669.87 4940.88,-4764.3 5024,-4850.49 5207.75,-5041.05 5349.01,-4913.58 5611,-4951.49 6074.27,-5018.54 6205.57,-4950.7 6657,-5074.49 6673.89,-5079.12 6675.87,-5086.86 6693,-5090.49 6752.24,-5103.06 7739.22,-5132.33 7783,-5090.49 7847,-5029.32 7766.7,-4365.93 7819,-4294.49 7890.1,-4197.38 8019.95,-4153.17 8127.34,-4133.09"/>
<polygon fill="black" stroke="black" points="8128.11,-4136.5 8137.33,-4131.28 8126.86,-4129.62 8128.11,-4136.5"/>
</g>
<!-- tg_client._enqueue_chop&#45;&gt;caption_io.has_caption -->
<g id="edge176" class="edge">
<title>tg_client._enqueue_chop&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M4754.58,-4515.87C4793.87,-4418.42 4937.16,-4049.52 4988,-3730.49 5001.1,-3648.28 4967.42,-2293.55 5024,-2232.49 5202.21,-2040.16 5349.14,-2186.86 5611,-2173.49 5731.51,-2167.34 7693.23,-2090.86 7783,-2171.49 7838.7,-2221.53 7764.77,-2454.87 7819,-2506.49 7874.13,-2558.97 8092.76,-2551.32 8216.66,-2542.28"/>
<polygon fill="black" stroke="black" points="8217.16,-2545.75 8226.88,-2541.51 8216.64,-2538.77 8217.16,-2545.75"/>
</g>
<!-- tg_client._start_chop_worker -->
<g id="node123" class="node">
<title>tg_client._start_chop_worker</title>
<g id="a_node123"><a xlink:title="Ensure the chop queue worker task is running.">
<polygon fill="none" stroke="black" points="5432.5,-4550.49 5166.5,-4550.49 5166.5,-4514.49 5432.5,-4514.49 5432.5,-4550.49"/>
<text text-anchor="middle" x="5299.5" y="-4528.33" font-family="Times,serif" font-size="17.08">tg_client._start_chop_worker</text>
</a>
</g>
</g>
<!-- tg_client._enqueue_chop&#45;&gt;tg_client._start_chop_worker -->
<g id="edge177" class="edge">
<title>tg_client._enqueue_chop&#45;&gt;tg_client._start_chop_worker</title>
<path fill="none" stroke="black" d="M4986.28,-4537C5044.19,-4536.17 5104.19,-4535.3 5155.93,-4534.55"/>
<polygon fill="black" stroke="black" points="5156.22,-4538.05 5166.16,-4534.4 5156.11,-4531.05 5156.22,-4538.05"/>
</g>
<!-- tg_client._chop_worker -->
<g id="node124" class="node">
<title>tg_client._chop_worker</title>
<g id="a_node124"><a xlink:title="Background task processing ``_CHOP_QUEUE``.">
<polygon fill="none" stroke="black" points="6259.5,-4541.49 6008.5,-4541.49 6008.5,-4505.49 6259.5,-4505.49 6259.5,-4541.49"/>
<text text-anchor="middle" x="6134" y="-4518.7" font-family="Times,serif" font-size="19.74">tg_client._chop_worker</text>
</a>
</g>
</g>
<!-- tg_client._start_chop_worker&#45;&gt;tg_client._chop_worker -->
<g id="edge179" class="edge">
<title>tg_client._start_chop_worker&#45;&gt;tg_client._chop_worker</title>
<path fill="none" stroke="black" d="M5432.87,-4531.06C5587.64,-4529.39 5842.4,-4526.63 5998.2,-4524.95"/>
<polygon fill="black" stroke="black" points="5998.35,-4528.45 6008.31,-4524.84 5998.28,-4521.45 5998.35,-4528.45"/>
</g>
<!-- tg_client._process_chop_queue -->
<g id="node125" class="node">
<title>tg_client._process_chop_queue</title>
<g id="a_node125"><a xlink:title="Check queued posts and chop cooled down ones.">
<polygon fill="none" stroke="black" points="7419.5,-4499.49 7056.5,-4499.49 7056.5,-4463.49 7419.5,-4463.49 7419.5,-4499.49"/>
<text text-anchor="middle" x="7238" y="-4475.8" font-family="Times,serif" font-size="22.12">tg_client._process_chop_queue</text>
</a>
</g>
</g>
<!-- tg_client._chop_worker&#45;&gt;tg_client._process_chop_queue -->
<g id="edge182" class="edge">
<title>tg_client._chop_worker&#45;&gt;tg_client._process_chop_queue</title>
<path fill="none" stroke="black" d="M6259.54,-4518.75C6451.32,-4511.44 6820.35,-4497.37 7046.04,-4488.77"/>
<polygon fill="black" stroke="black" points="7046.49,-4492.26 7056.35,-4488.38 7046.22,-4485.26 7046.49,-4492.26"/>
</g>
<!-- tg_client._process_chop_queue&#45;&gt;caption_io.has_caption -->
<g id="edge180" class="edge">
<title>tg_client._process_chop_queue&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M7419.81,-4473.67C7543.51,-4457.81 7699.65,-4414.9 7783,-4302.49 7885.68,-4164.03 7723.6,-2895.07 7819,-2751.49 7908.62,-2616.62 8103.44,-2564.66 8216.84,-2545.34"/>
<polygon fill="black" stroke="black" points="8217.59,-2548.76 8226.88,-2543.68 8216.45,-2541.86 8217.59,-2548.76"/>
</g>
<!-- tg_client._process_chop_queue&#45;&gt;tg_client._schedule_chop -->
<g id="edge181" class="edge">
<title>tg_client._process_chop_queue&#45;&gt;tg_client._schedule_chop</title>
<path fill="none" stroke="black" d="M7419.75,-4465.71C7557.94,-4458.03 7732.98,-4459.22 7783,-4508.49 7871.21,-4595.38 7731.51,-4976.89 7819,-5064.49 7863.69,-5109.24 8022.41,-5112.53 8146.15,-5107.58"/>
<polygon fill="black" stroke="black" points="8146.66,-5111.06 8156.5,-5107.15 8146.36,-5104.07 8146.66,-5111.06"/>
</g>
<!-- tg_client._flush_chop_queue -->
<g id="node126" class="node">
<title>tg_client._flush_chop_queue</title>
<g id="a_node126"><a xlink:title="Run the chop worker until the queue is empty and cancel it.">
<polygon fill="none" stroke="black" points="4097.5,-4782.49 3612.5,-4782.49 3612.5,-4738.49 4097.5,-4738.49 4097.5,-4782.49"/>
<text text-anchor="middle" x="3855" y="-4752.17" font-family="Times,serif" font-size="32.90">tg_client._flush_chop_queue</text>
</a>
</g>
</g>
<!-- tg_client._flush_chop_queue&#45;&gt;tg_client._process_chop_queue -->
<g id="edge183" class="edge">
<title>tg_client._flush_chop_queue&#45;&gt;tg_client._process_chop_queue</title>
<path fill="none" stroke="black" d="M3896.52,-4738.34C3995.66,-4685.53 4259.86,-4553.15 4499,-4506.49 4987.38,-4411.21 6508.04,-4455.05 7046.03,-4474.19"/>
<polygon fill="black" stroke="black" points="7046.1,-4477.69 7056.22,-4474.55 7046.35,-4470.7 7046.1,-4477.69"/>
</g>
<!-- tg_client._get_id_date -->
<g id="node127" class="node">
<title>tg_client._get_id_date</title>
<g id="a_node127"><a xlink:title="Return the stored date for ``msg_id`` in ``chat`` if available.">
<polygon fill="none" stroke="black" points="7410,-5178.99 7066,-5178.99 7066,-5137.99 7410,-5137.99 7410,-5178.99"/>
<text text-anchor="middle" x="7238" y="-5151.25" font-family="Times,serif" font-size="29.68">tg_client._get_id_date</text>
</a>
</g>
</g>
<!-- tg_client._get_id_date&#45;&gt;post_io.raw_post_path -->
<g id="edge184" class="edge">
<title>tg_client._get_id_date&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7410.01,-5160.55C7550.62,-5158.17 7734.36,-5144.35 7783,-5090.49 7842.18,-5024.96 7765.4,-3571.67 7819,-3501.49 7912.49,-3379.09 8105.54,-3356.84 8217.68,-3354.95"/>
<polygon fill="black" stroke="black" points="8217.98,-3358.45 8227.94,-3354.83 8217.9,-3351.45 8217.98,-3358.45"/>
</g>
<!-- tg_client._get_id_date&#45;&gt;notes_utils.read_text -->
<g id="edge185" class="edge">
<title>tg_client._get_id_date&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M7410.11,-5162.6C7756.83,-5169.61 8531.28,-5178.28 8790,-5123.49 8806.96,-5119.9 8809.22,-5112.85 8826,-5108.49 8968.66,-5071.45 9364.73,-5118.69 9485,-5033.49 9698.5,-4882.24 9767.52,-4538.07 9783.49,-4437.55"/>
<polygon fill="black" stroke="black" points="9786.97,-4437.97 9785.03,-4427.55 9780.05,-4436.9 9786.97,-4437.97"/>
</g>
<!-- tg_client._load_progress -->
<g id="node128" class="node">
<title>tg_client._load_progress</title>
<g id="a_node128"><a xlink:title="Return saved resume timestamp for ``chat`` if available.">
<polygon fill="none" stroke="black" points="2001,-5096.49 1671,-5096.49 1671,-5060.49 2001,-5060.49 2001,-5096.49"/>
<text text-anchor="middle" x="1836" y="-5072.33" font-family="Times,serif" font-size="25.20">tg_client._load_progress</text>
</a>
</g>
</g>
<!-- tg_client._load_progress&#45;&gt;notes_utils.read_text -->
<g id="edge186" class="edge">
<title>tg_client._load_progress&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M2001.02,-5085.72C2344.62,-5100.23 3165.23,-5131.49 3854,-5131.49 3854,-5131.49 3854,-5131.49 4744.5,-5131.49 4929.1,-5131.49 5397.88,-5098.46 5575,-5150.49 5592.99,-5155.78 5593.19,-5166.62 5611,-5172.49 6069.49,-5323.68 6210.77,-5245.43 6693,-5268.49 7192.89,-5292.4 7318.55,-5273.72 7819,-5276.49 8266.55,-5278.97 8378.44,-5279.6 8826,-5280.49 8899.22,-5280.64 9428.03,-5326.49 9485,-5280.49 9544.08,-5232.8 9499.5,-5186.31 9521,-5113.49 9600.62,-4843.82 9734.66,-4530.15 9775.4,-4436.94"/>
<polygon fill="black" stroke="black" points="9778.66,-4438.2 9779.47,-4427.64 9772.25,-4435.39 9778.66,-4438.2"/>
</g>
<!-- tg_client._save_progress -->
<g id="node129" class="node">
<title>tg_client._save_progress</title>
<g id="a_node129"><a xlink:title="Persist resume timestamp for ``chat`` to ``STATE_DIR``.">
<polygon fill="none" stroke="black" points="2518,-5008.49 2289,-5008.49 2289,-4972.49 2518,-4972.49 2518,-5008.49"/>
<text text-anchor="middle" x="2403.5" y="-4986.33" font-family="Times,serif" font-size="17.08">tg_client._save_progress</text>
</a>
</g>
</g>
<!-- tg_client.get_first_id -->
<g id="node130" class="node">
<title>tg_client.get_first_id</title>
<g id="a_node130"><a xlink:title="Return the smallest saved message id for ``chat``.">
<polygon fill="none" stroke="black" points="3142,-3466.49 2875,-3466.49 2875,-3430.49 3142,-3430.49 3142,-3466.49"/>
<text text-anchor="middle" x="3008.5" y="-3442.62" font-family="Times,serif" font-size="24.22">tg_client.get_first_id</text>
</a>
</g>
</g>
<!-- tg_client.get_first_id&#45;&gt;post_io.raw_post_path -->
<g id="edge187" class="edge">
<title>tg_client.get_first_id&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M3142.12,-3449.52C3432.28,-3451.68 4145.27,-3456.49 4742.5,-3456.49 4742.5,-3456.49 4742.5,-3456.49 6135,-3456.49 6946.01,-3456.49 7925.87,-3386.54 8217.61,-3364.24"/>
<polygon fill="black" stroke="black" points="8217.99,-3367.72 8227.69,-3363.46 8217.46,-3360.74 8217.99,-3367.72"/>
</g>
<!-- tg_client.get_last_id -->
<g id="node131" class="node">
<title>tg_client.get_last_id</title>
<g id="a_node131"><a xlink:title="Return the highest saved message id for ``chat``.">
<polygon fill="none" stroke="black" points="1966.5,-4250.49 1705.5,-4250.49 1705.5,-4214.49 1966.5,-4214.49 1966.5,-4250.49"/>
<text text-anchor="middle" x="1836" y="-4226.62" font-family="Times,serif" font-size="24.22">tg_client.get_last_id</text>
</a>
</g>
</g>
<!-- tg_client.get_last_id&#45;&gt;post_io.raw_post_path -->
<g id="edge188" class="edge">
<title>tg_client.get_last_id&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M1852.05,-4214.49C1945.4,-4104.92 2459.36,-3532.49 3007.5,-3532.49 3007.5,-3532.49 3007.5,-3532.49 6135,-3532.49 6501.26,-3532.49 7420.77,-3562.67 7783,-3508.49 7828.12,-3501.74 8103.62,-3418.55 8234.53,-3378.62"/>
<polygon fill="black" stroke="black" points="8235.92,-3381.85 8244.46,-3375.59 8233.88,-3375.16 8235.92,-3381.85"/>
</g>
<!-- tg_client._save_message -->
<g id="node132" class="node">
<title>tg_client._save_message</title>
<g id="a_node132"><a xlink:title="Write ``msg`` to disk with metadata and any media references.&#10;&#10;Returns the path of the stored message or ``None`` when skipped.">
<polygon fill="none" stroke="black" points="4463,-5275.99 3247,-5275.99 3247,-5160.99 4463,-5160.99 4463,-5275.99"/>
<text text-anchor="middle" x="3855" y="-5194.38" font-family="Times,serif" font-size="97.02">tg_client._save_message</text>
</a>
</g>
</g>
<!-- tg_client._save_message&#45;&gt;post_io.read_post -->
<g id="edge190" class="edge">
<title>tg_client._save_message&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M4004.95,-5160.97C4150.9,-5095.73 4365.22,-4974.08 4463,-4791.49 4499.94,-4722.51 4443.94,-3439.09 4499,-3383.49 4541.09,-3340.99 5516.19,-3356.41 5575,-3345.49 6091.71,-3249.61 6174.68,-3047.24 6693,-2960.49 6931.9,-2920.51 7541.37,-2943.63 7783,-2960.49 7877.98,-2967.12 7982,-2980.47 8071.91,-2993.97"/>
<polygon fill="black" stroke="black" points="8071.55,-2997.45 8081.96,-2995.48 8072.6,-2990.53 8071.55,-2997.45"/>
</g>
<!-- tg_client._save_message&#45;&gt;post_io.raw_post_path -->
<g id="edge191" class="edge">
<title>tg_client._save_message&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M4003.49,-5160.85C4148.84,-5095.35 4363.19,-4973.34 4463,-4791.49 4504.64,-4715.63 4447.32,-4082.91 4499,-4013.49 4720.32,-3716.22 4927.88,-3776.49 5298.5,-3776.49 5298.5,-3776.49 5298.5,-3776.49 6135,-3776.49 6318.61,-3776.49 7643.37,-3773.73 7783,-3654.49 7836.12,-3609.13 7771.05,-3552.3 7819,-3501.49 7923.44,-3390.83 8108.7,-3364.02 8217.36,-3358.23"/>
<polygon fill="black" stroke="black" points="8217.81,-3361.71 8227.63,-3357.74 8217.47,-3354.72 8217.81,-3361.71"/>
</g>
<!-- tg_client._save_message&#45;&gt;moderation.should_skip_user -->
<g id="edge202" class="edge">
<title>tg_client._save_message&#45;&gt;moderation.should_skip_user</title>
<path fill="none" stroke="black" d="M3967.6,-5276.12C4093.68,-5339.16 4306.44,-5439.34 4499,-5500.49 4710.42,-5567.64 4776.74,-5532.83 4988,-5600.49 5004.67,-5605.83 5006.9,-5612.71 5024,-5616.49 5264.66,-5669.72 5886.52,-5635.49 6133,-5635.49 6133,-5635.49 6133,-5635.49 8305.5,-5635.49 8831.42,-5635.49 9026.66,-5798.41 9485,-5540.49 9642.94,-5451.61 9744.03,-5242.82 9776.3,-5167.87"/>
<polygon fill="black" stroke="black" points="9779.55,-5169.18 9780.23,-5158.61 9773.1,-5166.45 9779.55,-5169.18"/>
</g>
<!-- tg_client._save_message&#45;&gt;post_io.get_contact -->
<g id="edge189" class="edge">
<title>tg_client._save_message&#45;&gt;post_io.get_contact</title>
<path fill="none" stroke="black" d="M3989.9,-5276C4118.25,-5328.91 4318.59,-5405.74 4499,-5450.49 4727.71,-5507.23 4789.06,-5506.41 5024,-5524.49 5830.05,-5586.54 6806.01,-5564.84 7128.1,-5555.13"/>
<polygon fill="black" stroke="black" points="7128.48,-5558.62 7138.36,-5554.82 7128.26,-5551.63 7128.48,-5558.62"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._mark_activity -->
<g id="edge192" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._mark_activity</title>
<path fill="none" stroke="black" d="M4086.78,-5276.05C4212.9,-5318.11 4363.26,-5387.16 4463,-5495.49 4494.99,-5530.24 4462.21,-5565.87 4499,-5595.49 4538.06,-5626.95 4592.64,-5636.26 4640.23,-5637.12"/>
<polygon fill="black" stroke="black" points="4640.25,-5640.62 4650.27,-5637.19 4640.29,-5633.62 4640.25,-5640.62"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._progress_logger -->
<g id="edge193" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._progress_logger</title>
<path fill="none" stroke="black" d="M4376.17,-5276C4443.63,-5283.45 4508.65,-5290.64 4564.69,-5296.84"/>
<polygon fill="black" stroke="black" points="4564.37,-5300.32 4574.69,-5297.94 4565.14,-5293.36 4564.37,-5300.32"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._write_md -->
<g id="edge194" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._write_md</title>
<path fill="none" stroke="black" d="M4024.68,-5276.02C4153.28,-5317.86 4335.52,-5372.86 4499,-5406.49 4729.24,-5453.86 4790.35,-5444.76 5024,-5470.49 5090.32,-5477.8 5165.76,-5485.15 5220.75,-5490.33"/>
<polygon fill="black" stroke="black" points="5220.49,-5493.82 5230.77,-5491.27 5221.14,-5486.85 5220.49,-5493.82"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._find_group_path -->
<g id="edge195" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._find_group_path</title>
<path fill="none" stroke="black" d="M3996.9,-5160.86C4139.9,-5094.4 4355.13,-4970.75 4463,-4791.49 4528.83,-4682.1 4442.34,-4620.9 4499,-4506.49 4644.2,-4213.31 4737.61,-4148.67 5024,-3990.49 5336.17,-3818.07 5769.43,-3807.41 5990.64,-3815.29"/>
<polygon fill="black" stroke="black" points="5990.57,-3818.79 6000.69,-3815.67 5990.83,-3811.8 5990.57,-3818.79"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._should_skip_media -->
<g id="edge196" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._should_skip_media</title>
<path fill="none" stroke="black" d="M4463.22,-5219.18C4471.85,-5219.19 4480.37,-5219.2 4488.79,-5219.21"/>
<polygon fill="black" stroke="black" points="4488.99,-5222.71 4499,-5219.22 4489,-5215.71 4488.99,-5222.71"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._allowed_topic -->
<g id="edge197" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._allowed_topic</title>
<path fill="none" stroke="black" d="M4463.06,-5189.53C4475.14,-5189.16 4487.13,-5188.81 4499,-5188.49 4694.37,-5183.2 4916.69,-5181.92 5077.21,-5181.83"/>
<polygon fill="black" stroke="black" points="5077.21,-5185.33 5087.21,-5181.83 5077.2,-5178.33 5077.21,-5185.33"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._extract_author -->
<g id="edge198" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._extract_author</title>
<path fill="none" stroke="black" d="M4463.07,-5247.96C4475.15,-5248.48 4487.14,-5248.99 4499,-5249.49 4977.11,-5269.68 5097.21,-5261.86 5575,-5288.49 5634.95,-5291.83 5698.49,-5296.01 5760.37,-5300.42"/>
<polygon fill="black" stroke="black" points="5760.47,-5303.94 5770.69,-5301.16 5760.97,-5296.96 5760.47,-5303.94"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._enqueue_chop -->
<g id="edge199" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._enqueue_chop</title>
<path fill="none" stroke="black" d="M3992.98,-5160.93C4134.61,-5093.9 4350.46,-4969.19 4463,-4791.49 4513.2,-4712.23 4432.77,-4649.95 4499,-4583.49 4503.57,-4578.9 4508.45,-4574.71 4513.59,-4570.87"/>
<polygon fill="black" stroke="black" points="4515.64,-4573.71 4521.86,-4565.13 4511.65,-4567.95 4515.64,-4573.71"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._save_message -->
<g id="edge200" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._save_message</title>
<path fill="none" stroke="black" d="M3705.09,-5276.1C3724.06,-5286.62 3774.04,-5293.99 3855,-5293.99 3925.21,-5293.99 3972.12,-5288.45 3995.71,-5280.11"/>
<polygon fill="black" stroke="black" points="3997.15,-5283.31 4004.91,-5276.1 3994.35,-5276.89 3997.15,-5283.31"/>
</g>
<!-- tg_client._save_media -->
<g id="node133" class="node">
<title>tg_client._save_media</title>
<g id="a_node133"><a xlink:title="Store ``data`` and return relative file path.">
<polygon fill="none" stroke="black" points="5540.5,-3336.49 5058.5,-3336.49 5058.5,-3282.49 5540.5,-3282.49 5540.5,-3336.49"/>
<text text-anchor="middle" x="5299.5" y="-3298.89" font-family="Times,serif" font-size="42.00">tg_client._save_media</text>
</a>
</g>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._save_media -->
<g id="edge201" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._save_media</title>
<path fill="none" stroke="black" d="M4004.98,-5160.98C4150.94,-5095.75 4365.28,-4974.11 4463,-4791.49 4500.78,-4720.89 4443.12,-3407.86 4499,-3350.49 4572.95,-3274.58 4842.51,-3274.56 5048.39,-3286.95"/>
<polygon fill="black" stroke="black" points="5048.26,-3290.45 5058.45,-3287.57 5048.69,-3283.47 5048.26,-3290.45"/>
</g>
<!-- tg_client._save_media&#45;&gt;caption_io.caption_json_path -->
<g id="edge203" class="edge">
<title>tg_client._save_media&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M5329.68,-3282.05C5389.13,-3223.96 5523.07,-3081.45 5575,-2930.49 5611.31,-2824.94 5540.98,-2013.43 5611,-1926.49 5922.36,-1539.89 6200.49,-1711.53 6693,-1649.49 6813.16,-1634.36 7690.09,-1571.81 7783,-1649.49 7852.29,-1707.42 7752.09,-1788.83 7819,-1849.49 7979.38,-1994.89 8580.77,-1871.97 8790,-1927.49 8916.15,-1960.97 9052.18,-2036.58 9116.58,-2075.05"/>
<polygon fill="black" stroke="black" points="9114.81,-2078.07 9125.18,-2080.23 9118.41,-2072.07 9114.81,-2078.07"/>
</g>
<!-- tg_client._save_media&#45;&gt;caption_io.has_caption -->
<g id="edge204" class="edge">
<title>tg_client._save_media&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M5329.05,-3282.43C5387.94,-3224.51 5521.83,-3081.45 5575,-2930.49 5601.32,-2855.78 5554.15,-2273.65 5611,-2218.49 5654.3,-2176.48 7737.94,-2156.36 7783,-2196.49 7886.58,-2288.74 7718.12,-2411.29 7819,-2506.49 7874.35,-2558.73 8092.89,-2551.18 8216.71,-2542.22"/>
<polygon fill="black" stroke="black" points="8217.21,-2545.69 8226.93,-2541.46 8216.7,-2538.71 8217.21,-2545.69"/>
</g>
<!-- tg_client._save_media&#45;&gt;image_io.write_image_meta -->
<g id="edge205" class="edge">
<title>tg_client._save_media&#45;&gt;image_io.write_image_meta</title>
<path fill="none" stroke="black" d="M5514.47,-3336.61C5537.85,-3347.81 5558.94,-3363 5575,-3383.49 5631.48,-3455.58 5549.95,-4963.23 5611,-5031.49 5716.87,-5149.87 5919.37,-5139.84 6038.64,-5121.15"/>
<polygon fill="black" stroke="black" points="6039.54,-5124.55 6048.85,-5119.5 6038.42,-5117.64 6039.54,-5124.55"/>
</g>
<!-- tg_client._save_media&#45;&gt;tg_client._schedule_caption -->
<g id="edge206" class="edge">
<title>tg_client._save_media&#45;&gt;tg_client._schedule_caption</title>
<path fill="none" stroke="black" d="M5514.42,-3336.65C5537.8,-3347.84 5558.91,-3363.02 5575,-3383.49 5625.37,-3447.6 5557.37,-4789.09 5611,-4850.49 5707.68,-4961.18 6706.2,-5031.88 7088.87,-5055.09"/>
<polygon fill="black" stroke="black" points="7088.71,-5058.59 7098.91,-5055.7 7089.14,-5051.6 7088.71,-5058.59"/>
</g>
<!-- tg_client._save_bounded -->
<g id="node134" class="node">
<title>tg_client._save_bounded</title>
<g id="a_node134"><a xlink:title="Run ``_save_message`` under the global semaphore and return path.">
<polygon fill="none" stroke="black" points="3211,-5220.49 2806,-5220.49 2806,-5178.49 3211,-5178.49 3211,-5220.49"/>
<text text-anchor="middle" x="3008.5" y="-5191.4" font-family="Times,serif" font-size="31.36">tg_client._save_bounded</text>
</a>
</g>
</g>
<!-- tg_client._save_bounded&#45;&gt;tg_client._save_message -->
<g id="edge207" class="edge">
<title>tg_client._save_bounded&#45;&gt;tg_client._save_message</title>
<path fill="none" stroke="black" d="M3211.24,-5204.03C3219.57,-5204.22 3228.06,-5204.41 3236.69,-5204.6"/>
<polygon fill="black" stroke="black" points="3236.8,-5208.11 3246.88,-5204.83 3236.96,-5201.11 3236.8,-5208.11"/>
</g>
<!-- tg_client._remove_local_message -->
<g id="node135" class="node">
<title>tg_client._remove_local_message</title>
<g id="a_node135"><a xlink:title="Delete ``path`` and related media if the post no longer exists.">
<polygon fill="none" stroke="black" points="7523,-1891.49 6953,-1891.49 6953,-1847.49 7523,-1847.49 7523,-1891.49"/>
<text text-anchor="middle" x="7238" y="-1861.17" font-family="Times,serif" font-size="32.90">tg_client._remove_local_message</text>
</a>
</g>
</g>
<!-- tg_client._remove_local_message&#45;&gt;post_io.read_post -->
<g id="edge210" class="edge">
<title>tg_client._remove_local_message&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7523.15,-1852.03C7634.9,-1851.85 7745.49,-1862.33 7783,-1900.49 7853.55,-1972.26 7763.4,-2721.61 7819,-2805.49 7883.81,-2903.27 8002.45,-2960.05 8106.1,-2992.49"/>
<polygon fill="black" stroke="black" points="8105.17,-2995.87 8115.76,-2995.46 8107.23,-2989.18 8105.17,-2995.87"/>
</g>
<!-- tg_client._remove_local_message&#45;&gt;caption_io.caption_json_path -->
<g id="edge208" class="edge">
<title>tg_client._remove_local_message&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M7523.29,-1855.03C7633.51,-1855.61 7742.85,-1865.85 7783,-1900.49 7842.79,-1952.08 7758.21,-2024.08 7819,-2074.49 7866.03,-2113.5 8741.09,-2104.54 9048.67,-2100.16"/>
<polygon fill="black" stroke="black" points="9048.98,-2103.66 9058.93,-2100.01 9048.88,-2096.66 9048.98,-2103.66"/>
</g>
<!-- tg_client._remove_local_message&#45;&gt;caption_io.caption_md_path -->
<g id="edge209" class="edge">
<title>tg_client._remove_local_message&#45;&gt;caption_io.caption_md_path</title>
<path fill="none" stroke="black" d="M7523.31,-1853.37C7634.31,-1853.54 7744.26,-1863.93 7783,-1900.49 7884.52,-1996.29 7716.68,-2117.55 7819,-2212.49 7898.15,-2285.94 8700.52,-2191.06 8790,-2251.49 8822.31,-2273.32 8798.44,-2303.92 8826,-2331.49 8892.41,-2397.94 8993.96,-2437.36 9066.57,-2458.59"/>
<polygon fill="black" stroke="black" points="9066.03,-2462.08 9076.61,-2461.47 9067.96,-2455.35 9066.03,-2462.08"/>
</g>
<!-- tg_client._download_messages -->
<g id="node136" class="node">
<title>tg_client._download_messages</title>
<g id="a_node136"><a xlink:title="Save ``messages`` with a progress bar and return count saved.">
<polygon fill="none" stroke="black" points="2758.5,-5197.99 2048.5,-5197.99 2048.5,-5140.99 2758.5,-5140.99 2758.5,-5197.99"/>
<text text-anchor="middle" x="2403.5" y="-5158.15" font-family="Times,serif" font-size="44.80">tg_client._download_messages</text>
</a>
</g>
</g>
<!-- tg_client._download_messages&#45;&gt;tg_client._save_bounded -->
<g id="edge211" class="edge">
<title>tg_client._download_messages&#45;&gt;tg_client._save_bounded</title>
<path fill="none" stroke="black" d="M2758.76,-5187.12C2771.17,-5187.74 2783.47,-5188.35 2795.55,-5188.95"/>
<polygon fill="black" stroke="black" points="2795.49,-5192.45 2805.65,-5189.45 2795.83,-5185.46 2795.49,-5192.45"/>
</g>
<!-- tg_client.ensure_chat_access -->
<g id="node137" class="node">
<title>tg_client.ensure_chat_access</title>
<g id="a_node137"><a xlink:title="Join chats listed in ``CHATS`` if not already joined.">
<polygon fill="none" stroke="black" points="2574.5,-5252.49 2232.5,-5252.49 2232.5,-5216.49 2574.5,-5216.49 2574.5,-5252.49"/>
<text text-anchor="middle" x="2403.5" y="-5228.8" font-family="Times,serif" font-size="22.12">tg_client.ensure_chat_access</text>
</a>
</g>
</g>
<!-- tg_client.refetch_messages -->
<g id="node138" class="node">
<title>tg_client.refetch_messages</title>
<g id="a_node138"><a xlink:title="Re&#45;fetch posts that failed parsing or are empty.">
<polygon fill="none" stroke="black" points="2770,-2707.99 2037,-2707.99 2037,-2642.99 2770,-2642.99 2770,-2707.99"/>
<text text-anchor="middle" x="2403.5" y="-2662.44" font-family="Times,serif" font-size="51.94">tg_client.refetch_messages</text>
</a>
</g>
</g>
<!-- tg_client.refetch_messages&#45;&gt;post_io.read_post -->
<g id="edge212" class="edge">
<title>tg_client.refetch_messages&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M2551.54,-2642.98C2812.43,-2588.21 3374.07,-2483.49 3854,-2483.49 3854,-2483.49 3854,-2483.49 5300.5,-2483.49 5940.07,-2483.49 6060.01,-2755 6693,-2846.49 7172.71,-2915.83 7304.35,-2805.18 7783,-2881.49 7927.24,-2904.49 8087.83,-2955.45 8191.98,-2992.02"/>
<polygon fill="black" stroke="black" points="8190.97,-2995.38 8201.56,-2995.4 8193.3,-2988.78 8190.97,-2995.38"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;post_io.raw_post_path -->
<g id="edge213" class="edge">
<title>tg_client.refetch_messages&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M2449.1,-2708.07C2620.94,-2830.28 3260.21,-3254.49 3854,-3254.49 3854,-3254.49 3854,-3254.49 4744.5,-3254.49 5611.01,-3254.49 5826.95,-3293.22 6693,-3321.49 7275.47,-3340.5 7976.78,-3352.42 8217.52,-3356.19"/>
<polygon fill="black" stroke="black" points="8217.56,-3359.69 8227.61,-3356.35 8217.67,-3352.69 8217.56,-3359.69"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;notes_utils.load_json -->
<g id="edge217" class="edge">
<title>tg_client.refetch_messages&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M2417.26,-2642.78C2503.57,-2427.6 3023.63,-1223.49 3854,-1223.49 3854,-1223.49 3854,-1223.49 6135,-1223.49 6430.02,-1223.49 8534.32,-1042.3 8790,-1189.49 8817.61,-1205.39 8802.21,-1230.3 8826,-1251.49 8896.09,-1313.92 8997.69,-1352.44 9069.3,-1373.54"/>
<polygon fill="black" stroke="black" points="9068.62,-1376.99 9079.2,-1376.41 9070.57,-1370.27 9068.62,-1376.99"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;notes_utils.write_json -->
<g id="edge218" class="edge">
<title>tg_client.refetch_messages&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M2479.18,-2642.93C2558.66,-2609.65 2688.86,-2559.05 2806,-2531.49 3262.56,-2424.08 3384.97,-2407.49 3854,-2407.49 3854,-2407.49 3854,-2407.49 6135,-2407.49 6318.14,-2407.49 7637.82,-2322.86 7783,-2434.49 7829.51,-2470.25 7772.2,-2526.11 7819,-2561.49 7862.03,-2594.02 8746.28,-2593.09 8790,-2561.49 8831.35,-2531.6 8791.85,-2490.4 8826,-2452.49 8887.3,-2384.44 8985.95,-2345.82 9059.16,-2325.22"/>
<polygon fill="black" stroke="black" points="9060.15,-2328.58 9068.87,-2322.56 9058.3,-2321.83 9060.15,-2328.58"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;tg_client._get_message_path -->
<g id="edge214" class="edge">
<title>tg_client.refetch_messages&#45;&gt;tg_client._get_message_path</title>
<path fill="none" stroke="black" d="M2506.11,-2708.01C2630.12,-2747.71 2836.24,-2813.68 2941.39,-2847.33"/>
<polygon fill="black" stroke="black" points="2940.35,-2850.68 2950.94,-2850.39 2942.48,-2844.01 2940.35,-2850.68"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;tg_client._save_bounded -->
<g id="edge215" class="edge">
<title>tg_client.refetch_messages&#45;&gt;tg_client._save_bounded</title>
<path fill="none" stroke="black" d="M2412.34,-2708.33C2478.08,-2983.46 2936.26,-4901.29 3000.12,-5168.59"/>
<polygon fill="black" stroke="black" points="2996.74,-5169.5 3002.46,-5178.41 3003.54,-5167.87 2996.74,-5169.5"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;tg_client._remove_local_message -->
<g id="edge216" class="edge">
<title>tg_client.refetch_messages&#45;&gt;tg_client._remove_local_message</title>
<path fill="none" stroke="black" d="M2439.11,-2642.82C2504.87,-2582.77 2654.85,-2455.39 2806,-2393.49 3975.58,-1914.59 4353.49,-2052.68 5611,-1926.49 6074.85,-1879.95 6616.43,-1869.73 6942.72,-1868.34"/>
<polygon fill="black" stroke="black" points="6942.81,-1871.84 6952.79,-1868.3 6942.78,-1864.84 6942.81,-1871.84"/>
</g>
<!-- tg_client.fetch_missing -->
<g id="node139" class="node">
<title>tg_client.fetch_missing</title>
<g id="a_node139"><a xlink:title="Pull new messages and back&#45;fill history until fully synced.">
<polygon fill="none" stroke="black" points="1635,-5048.49 922,-5048.49 922,-4974.49 1635,-4974.49 1635,-5048.49"/>
<text text-anchor="middle" x="1278.5" y="-4996.67" font-family="Times,serif" font-size="59.78">tg_client.fetch_missing</text>
</a>
</g>
</g>
<!-- tg_client.fetch_missing&#45;&gt;post_io.raw_post_path -->
<g id="edge219" class="edge">
<title>tg_client.fetch_missing&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M1286.41,-4974.19C1323.27,-4786.67 1514.95,-3941.22 2037,-3566.49 2171.5,-3469.95 2236.93,-3494.49 2402.5,-3494.49 2402.5,-3494.49 2402.5,-3494.49 6135,-3494.49 6867.91,-3494.49 7053.2,-3503.02 7783,-3435.49 7937.09,-3421.23 8115.11,-3391.7 8217.95,-3373.35"/>
<polygon fill="black" stroke="black" points="8218.74,-3376.76 8227.97,-3371.55 8217.51,-3369.87 8218.74,-3376.76"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client._get_id_date -->
<g id="edge220" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client._get_id_date</title>
<path fill="none" stroke="black" d="M1635.2,-5029.98C2131.81,-5054.17 3061.22,-5093.49 3854,-5093.49 3854,-5093.49 3854,-5093.49 4744.5,-5093.49 5113.77,-5093.49 5210.61,-5057.67 5575,-5117.49 5591.51,-5120.2 5594.48,-5125.87 5611,-5128.49 6130.03,-5210.92 6753.9,-5189.34 7055.76,-5171.43"/>
<polygon fill="black" stroke="black" points="7056.15,-5174.91 7065.92,-5170.82 7055.73,-5167.92 7056.15,-5174.91"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client._load_progress -->
<g id="edge221" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client._load_progress</title>
<path fill="none" stroke="black" d="M1586.5,-5048.52C1617.11,-5052.21 1647.25,-5055.85 1675.4,-5059.24"/>
<polygon fill="black" stroke="black" points="1675.33,-5062.76 1685.67,-5060.48 1676.16,-5055.81 1675.33,-5062.76"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client._save_progress -->
<g id="edge222" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client._save_progress</title>
<path fill="none" stroke="black" d="M1635.21,-5004.84C1855.35,-5000.72 2124.46,-4995.69 2278.42,-4992.81"/>
<polygon fill="black" stroke="black" points="2278.92,-4996.3 2288.85,-4992.62 2278.79,-4989.31 2278.92,-4996.3"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client.get_first_id -->
<g id="edge223" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client.get_first_id</title>
<path fill="none" stroke="black" d="M1283.05,-4974.46C1304.45,-4759.73 1423.73,-3677.28 1671,-3480.49 2062.31,-3169.08 2741.72,-3359.22 2947.04,-3427.23"/>
<polygon fill="black" stroke="black" points="2946.15,-3430.62 2956.74,-3430.47 2948.36,-3423.98 2946.15,-3430.62"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client.get_last_id -->
<g id="edge224" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client.get_last_id</title>
<path fill="none" stroke="black" d="M1305.92,-4974.44C1402.27,-4839.33 1733.45,-4374.9 1816.16,-4258.91"/>
<polygon fill="black" stroke="black" points="1819.16,-4260.74 1822.12,-4250.56 1813.46,-4256.67 1819.16,-4260.74"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client._download_messages -->
<g id="edge225" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client._download_messages</title>
<path fill="none" stroke="black" d="M1412.14,-5048.52C1487.49,-5068.25 1583.9,-5091.31 1671,-5105.49 1789.75,-5124.83 1920.35,-5138.61 2037.94,-5148.3"/>
<polygon fill="black" stroke="black" points="2037.93,-5151.81 2048.19,-5149.14 2038.5,-5144.84 2037.93,-5151.81"/>
</g>
<!-- tg_client.remove_deleted -->
<g id="node140" class="node">
<title>tg_client.remove_deleted</title>
<g id="a_node140"><a xlink:title="Delete locally stored messages removed from Telegram recently.">
<polygon fill="none" stroke="black" points="7554.5,-2648.99 6921.5,-2648.99 6921.5,-2587.99 7554.5,-2587.99 7554.5,-2648.99"/>
<text text-anchor="middle" x="7238" y="-2606.24" font-family="Times,serif" font-size="48.44">tg_client.remove_deleted</text>
</a>
</g>
</g>
<!-- tg_client.remove_deleted&#45;&gt;post_io.read_post -->
<g id="edge228" class="edge">
<title>tg_client.remove_deleted&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7554.72,-2606.01C7636.62,-2617.27 7719.54,-2643.36 7783,-2696.49 7822.12,-2729.25 7785.17,-2767.3 7819,-2805.49 7902.69,-2899.96 8033.88,-2958.36 8138.64,-2992.37"/>
<polygon fill="black" stroke="black" points="8137.79,-2995.77 8148.38,-2995.48 8139.92,-2989.1 8137.79,-2995.77"/>
</g>
<!-- tg_client.remove_deleted&#45;&gt;post_io.raw_post_path -->
<g id="edge229" class="edge">
<title>tg_client.remove_deleted&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7554.85,-2595.37C7639.84,-2605.68 7724.36,-2633.93 7783,-2696.49 7853.43,-2771.62 7758.38,-3075.25 7819,-3158.49 7912.92,-3287.47 8105.69,-3333.13 8217.69,-3349.09"/>
<polygon fill="black" stroke="black" points="8217.22,-3352.56 8227.6,-3350.46 8218.17,-3345.63 8217.22,-3352.56"/>
</g>
<!-- tg_client.remove_deleted&#45;&gt;caption_io.caption_json_path -->
<g id="edge226" class="edge">
<title>tg_client.remove_deleted&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M7554.53,-2628.28C7981.7,-2638.33 8701.23,-2642.66 8790,-2561.49 8883.9,-2475.63 8754.27,-2382.58 8826,-2277.49 8884.12,-2192.36 8996.44,-2143.98 9073.41,-2119.51"/>
<polygon fill="black" stroke="black" points="9074.58,-2122.82 9083.09,-2116.5 9072.5,-2116.13 9074.58,-2122.82"/>
</g>
<!-- tg_client.remove_deleted&#45;&gt;caption_io.caption_md_path -->
<g id="edge227" class="edge">
<title>tg_client.remove_deleted&#45;&gt;caption_io.caption_md_path</title>
<path fill="none" stroke="black" d="M7554.71,-2600.65C7632.95,-2607.65 7714.06,-2625.39 7783,-2662.49 7805.86,-2674.8 7795.66,-2697.12 7819,-2708.49 7915.99,-2755.75 8686.33,-2738.36 8790,-2708.49 8930.95,-2667.89 9070.02,-2554.94 9127.25,-2504.44"/>
<polygon fill="black" stroke="black" points="9129.63,-2507.01 9134.77,-2497.75 9124.98,-2501.78 9129.63,-2507.01"/>
</g>
<!-- tg_client.main -->
<g id="node141" class="node">
<title>tg_client.main</title>
<g id="a_node141"><a xlink:title="Synchronize configured chats and optional live updates.">
<polygon fill="none" stroke="black" points="886,-5223.49 318,-5223.49 318,-5131.49 886,-5131.49 886,-5223.49"/>
<text text-anchor="middle" x="602" y="-5158.45" font-family="Times,serif" font-size="76.30">tg_client.main</text>
</a>
</g>
</g>
<!-- tg_client.main&#45;&gt;tg_client._mark_activity -->
<g id="edge230" class="edge">
<title>tg_client.main&#45;&gt;tg_client._mark_activity</title>
<path fill="none" stroke="black" d="M670.48,-5223.53C732.98,-5263.97 829.91,-5321.26 922,-5353.49 1310.54,-5489.49 1423.34,-5509.49 1835,-5509.49 1835,-5509.49 1835,-5509.49 3009.5,-5509.49 3629.91,-5509.49 4372.37,-5585.7 4640.04,-5615.63"/>
<polygon fill="black" stroke="black" points="4639.8,-5619.12 4650.13,-5616.76 4640.58,-5612.17 4639.8,-5619.12"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client._heartbeat -->
<g id="edge231" class="edge">
<title>tg_client.main&#45;&gt;tg_client._heartbeat</title>
<path fill="none" stroke="black" d="M707.24,-5223.6C768.57,-5248.72 848.32,-5277.97 922,-5294.49 997.79,-5311.49 1084.58,-5319.52 1153.43,-5323.28"/>
<polygon fill="black" stroke="black" points="1153.29,-5326.78 1163.46,-5323.8 1153.65,-5319.79 1153.29,-5326.78"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client._flush_chop_queue -->
<g id="edge232" class="edge">
<title>tg_client.main&#45;&gt;tg_client._flush_chop_queue</title>
<path fill="none" stroke="black" d="M886.15,-5174.52C1302.09,-5166.12 2101.38,-5134.58 2770,-5017.49 3143.91,-4952.01 3581.63,-4835.88 3765.55,-4785.25"/>
<polygon fill="black" stroke="black" points="3766.74,-4788.55 3775.45,-4782.52 3764.87,-4781.8 3766.74,-4788.55"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client._save_bounded -->
<g id="edge233" class="edge">
<title>tg_client.main&#45;&gt;tg_client._save_bounded</title>
<path fill="none" stroke="black" d="M886.41,-5210.51C898.43,-5211.58 910.33,-5212.58 922,-5213.49 1741.13,-5277.27 1955.08,-5366.11 2770,-5261.49 2826.43,-5254.25 2888.59,-5237.7 2935.16,-5223.52"/>
<polygon fill="black" stroke="black" points="2936.33,-5226.82 2944.86,-5220.53 2934.27,-5220.13 2936.33,-5226.82"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client.ensure_chat_access -->
<g id="edge234" class="edge">
<title>tg_client.main&#45;&gt;tg_client.ensure_chat_access</title>
<path fill="none" stroke="black" d="M886.15,-5186.46C1260.31,-5198.31 1908.56,-5218.85 2222.2,-5228.78"/>
<polygon fill="black" stroke="black" points="2222.2,-5232.28 2232.3,-5229.1 2222.42,-5225.29 2222.2,-5232.28"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client.refetch_messages -->
<g id="edge235" class="edge">
<title>tg_client.main&#45;&gt;tg_client.refetch_messages</title>
<path fill="none" stroke="black" d="M623.08,-5131.29C718.8,-4914.1 1145.79,-3978.16 1671,-3331.49 1888.83,-3063.29 2219.9,-2808.82 2348.64,-2714.26"/>
<polygon fill="black" stroke="black" points="2350.83,-2717 2356.83,-2708.27 2346.69,-2711.35 2350.83,-2717"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client.fetch_missing -->
<g id="edge236" class="edge">
<title>tg_client.main&#45;&gt;tg_client.fetch_missing</title>
<path fill="none" stroke="black" d="M789.99,-5131.47C892.81,-5106.17 1019.04,-5075.1 1117.3,-5050.92"/>
<polygon fill="black" stroke="black" points="1118.14,-5054.32 1127.02,-5048.53 1116.47,-5047.52 1118.14,-5054.32"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client.remove_deleted -->
<g id="edge237" class="edge">
<title>tg_client.main&#45;&gt;tg_client.remove_deleted</title>
<path fill="none" stroke="black" d="M602.51,-5131.33C601.98,-4920.18 618.66,-4029.38 922,-3391.49 1189.02,-2829.98 1213.23,-2331.49 1835,-2331.49 1835,-2331.49 1835,-2331.49 2404.5,-2331.49 3350.32,-2331.49 5717.38,-2400.42 6657,-2508.49 6808.12,-2525.87 6978.97,-2560.08 7095.88,-2585.75"/>
<polygon fill="black" stroke="black" points="7095.44,-2589.24 7105.96,-2587.98 7096.95,-2582.4 7095.44,-2589.24"/>
</g>
<!-- moderation.should_skip_text -->
<g id="node142" class="node">
<title>moderation.should_skip_text</title>
<g id="a_node142"><a xlink:title="Return ``True`` if ``text`` contains banned phrases.">
<polygon fill="none" stroke="black" points="9932.5,-4209.49 9644.5,-4209.49 9644.5,-4173.49 9932.5,-4173.49 9932.5,-4209.49"/>
<text text-anchor="middle" x="9788.5" y="-4186.71" font-family="Times,serif" font-size="18.48">moderation.should_skip_text</text>
</a>
</g>
</g>
<!-- moderation.message_skip_reason&#45;&gt;moderation.should_skip_user -->
<g id="edge244" class="edge">
<title>moderation.message_skip_reason&#45;&gt;moderation.should_skip_user</title>
<path fill="none" stroke="black" d="M9224.94,-4214.06C9298.42,-4241.49 9414.12,-4294.41 9485,-4375.49 9498.3,-4390.7 9724.57,-4977.09 9776.8,-5112.7"/>
<polygon fill="black" stroke="black" points="9773.66,-5114.29 9780.52,-5122.36 9780.2,-5111.77 9773.66,-5114.29"/>
</g>
<!-- moderation.message_skip_reason&#45;&gt;moderation.should_skip_text -->
<g id="edge243" class="edge">
<title>moderation.message_skip_reason&#45;&gt;moderation.should_skip_text</title>
<path fill="none" stroke="black" d="M9450.76,-4191.49C9514.12,-4191.49 9578.64,-4191.49 9634.01,-4191.49"/>
<polygon fill="black" stroke="black" points="9634.25,-4194.99 9644.25,-4191.49 9634.25,-4187.99 9634.25,-4194.99"/>
</g>
<!-- moderation.apply_to_history -->
<g id="node145" class="node">
<title>moderation.apply_to_history</title>
<g id="a_node145"><a xlink:title="Remove processed lots now failing moderation.">
<polygon fill="none" stroke="black" points="7498.5,-3912.99 6977.5,-3912.99 6977.5,-3865.99 7498.5,-3865.99 7498.5,-3912.99"/>
<text text-anchor="middle" x="7238" y="-3880.99" font-family="Times,serif" font-size="35.00">moderation.apply_to_history</text>
</a>
</g>
</g>
<!-- moderation.apply_to_history&#45;&gt;post_io.read_post -->
<g id="edge248" class="edge">
<title>moderation.apply_to_history&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7498.63,-3905.61C7618.28,-3906.89 7742.66,-3897.35 7783,-3856.49 7841.77,-3796.97 7762.81,-3166.46 7819,-3104.49 7869.08,-3049.27 7941.69,-3023.55 8015.53,-3013.6"/>
<polygon fill="black" stroke="black" points="8016,-3017.07 8025.48,-3012.35 8015.13,-3010.12 8016,-3017.07"/>
</g>
<!-- moderation.apply_to_history&#45;&gt;post_io.raw_post_path -->
<g id="edge249" class="edge">
<title>moderation.apply_to_history&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7498.84,-3904.72C7617.92,-3905.68 7741.71,-3896.14 7783,-3856.49 7840.19,-3801.57 7768.44,-3562.57 7819,-3501.49 7916.81,-3383.34 8106.93,-3359.4 8217.7,-3356.1"/>
<polygon fill="black" stroke="black" points="8217.93,-3359.6 8227.84,-3355.85 8217.75,-3352.6 8217.93,-3359.6"/>
</g>
<!-- moderation.apply_to_history&#45;&gt;moderation.should_skip_message -->
<g id="edge250" class="edge">
<title>moderation.apply_to_history&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M7498.72,-3868.83C7597.05,-3874.05 7704.15,-3897.06 7783,-3960.49 7819.8,-3990.1 7781.98,-4031.15 7819,-4060.49 7921.14,-4141.44 8075.59,-4145.29 8182.53,-4135.5"/>
<polygon fill="black" stroke="black" points="8183.11,-4138.96 8192.73,-4134.51 8182.44,-4131.99 8183.11,-4138.96"/>
</g>
<!-- moderation.apply_to_history&#45;&gt;moderation.should_skip_lot -->
<g id="edge251" class="edge">
<title>moderation.apply_to_history&#45;&gt;moderation.should_skip_lot</title>
<path fill="none" stroke="black" d="M7498.65,-3905.27C7618.1,-3906.43 7742.28,-3896.9 7783,-3856.49 7866.17,-3773.97 7750.48,-3425.53 7819,-3330.49 7896.95,-3222.38 8044.47,-3172.83 8156.34,-3150.23"/>
<polygon fill="black" stroke="black" points="8157.23,-3153.62 8166.37,-3148.25 8155.88,-3146.75 8157.23,-3153.62"/>
</g>
<!-- moderation.apply_to_history&#45;&gt;lot_io.read_lots -->
<g id="edge252" class="edge">
<title>moderation.apply_to_history&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M7498.68,-3885.09C7589.14,-3880.57 7691,-3872.09 7783,-3856.49 7953.51,-3827.59 8148.08,-3764.19 8243.84,-3730.89"/>
<polygon fill="black" stroke="black" points="8245.06,-3734.17 8253.35,-3727.57 8242.76,-3727.56 8245.06,-3734.17"/>
</g>
<!-- moderation.apply_to_history&#45;&gt;oom_utils.prefer_oom_kill -->
<g id="edge253" class="edge">
<title>moderation.apply_to_history&#45;&gt;oom_utils.prefer_oom_kill</title>
<path fill="none" stroke="black" d="M7498.73,-3902.18C7694.54,-3911.75 7957.76,-3924.6 8128.99,-3932.97"/>
<polygon fill="black" stroke="black" points="8128.96,-3936.47 8139.12,-3933.46 8129.3,-3929.48 8128.96,-3936.47"/>
</g>
<!-- lot_io.get_timestamp -->
<g id="node147" class="node">
<title>lot_io.get_timestamp</title>
<g id="a_node147"><a xlink:title="Return ``lot[&#39;timestamp&#39;]`` as a timezone&#45;aware ``datetime``.">
<polygon fill="none" stroke="black" points="9314.5,-5024.49 8996.5,-5024.49 8996.5,-4984.49 9314.5,-4984.49 9314.5,-5024.49"/>
<text text-anchor="middle" x="9155.5" y="-4997.42" font-family="Times,serif" font-size="28.84">lot_io.get_timestamp</text>
</a>
</g>
</g>
<!-- lot_io.write_lots -->
<g id="node148" class="node">
<title>lot_io.write_lots</title>
<g id="a_node148"><a xlink:title="Write lots to ``path`` using consistent JSON formatting.">
<polygon fill="none" stroke="black" points="8406,-5022.49 8203,-5022.49 8203,-4986.49 8406,-4986.49 8406,-5022.49"/>
<text text-anchor="middle" x="8304.5" y="-4998.9" font-family="Times,serif" font-size="23.24">lot_io.write_lots</text>
</a>
</g>
</g>
<!-- lot_io.write_lots&#45;&gt;notes_utils.write_json -->
<g id="edge256" class="edge">
<title>lot_io.write_lots&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M8406.08,-5014.15C8532.48,-5023.81 8739.11,-5030.53 8790,-4977.49 8838.56,-4926.88 8787.51,-2511.13 8826,-2452.49 8875.85,-2376.55 8974.86,-2339.14 9051.21,-2320.99"/>
<polygon fill="black" stroke="black" points="9052.39,-2324.31 9061.35,-2318.65 9050.82,-2317.48 9052.39,-2324.31"/>
</g>
<!-- lot_io.write_lots&#45;&gt;lot_io.get_seller -->
<g id="edge258" class="edge">
<title>lot_io.write_lots&#45;&gt;lot_io.get_seller</title>
<path fill="none" stroke="black" d="M8406.24,-5012.73C8531.21,-5020.65 8734.58,-5025.3 8790,-4977.49 8850.13,-4925.63 8791.8,-4874.16 8826,-4802.49 8903.57,-4639.94 9061.03,-4486.73 9125.75,-4427.88"/>
<polygon fill="black" stroke="black" points="9128.45,-4430.15 9133.53,-4420.85 9123.76,-4424.96 9128.45,-4430.15"/>
</g>
<!-- lot_io.write_lots&#45;&gt;lot_io._clean_lot -->
<g id="edge257" class="edge">
<title>lot_io.write_lots&#45;&gt;lot_io._clean_lot</title>
<path fill="none" stroke="black" d="M8406.11,-5013.94C8532.28,-5023.33 8738.37,-5029.73 8790,-4977.49 8853.95,-4912.79 8784.05,-4240.22 8826,-4159.49 8886.16,-4043.72 9025.8,-3965.06 9102.22,-3929"/>
<polygon fill="black" stroke="black" points="9104.07,-3931.99 9111.67,-3924.6 9101.12,-3925.65 9104.07,-3931.99"/>
</g>
<!-- lot_io.write_lots&#45;&gt;lot_io.get_timestamp -->
<g id="edge259" class="edge">
<title>lot_io.write_lots&#45;&gt;lot_io.get_timestamp</title>
<path fill="none" stroke="black" d="M8406.23,-5004.49C8549.21,-5004.49 8812.84,-5004.49 8985.91,-5004.49"/>
<polygon fill="black" stroke="black" points="8986.15,-5007.99 8996.15,-5004.49 8986.15,-5000.99 8986.15,-5007.99"/>
</g>
<!-- lot_io.get_lot -->
<g id="node150" class="node">
<title>lot_io.get_lot</title>
<g id="a_node150"><a xlink:title="Return the lot identified by ``lot_id`` or ``None`` when missing.">
<polygon fill="none" stroke="black" points="7310.5,-5233.49 7165.5,-5233.49 7165.5,-5197.49 7310.5,-5197.49 7310.5,-5233.49"/>
<text text-anchor="middle" x="7238" y="-5210.7" font-family="Times,serif" font-size="19.74">lot_io.get_lot</text>
</a>
</g>
</g>
<!-- lot_io.get_lot&#45;&gt;lot_io.read_lots -->
<g id="edge261" class="edge">
<title>lot_io.get_lot&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M7310.55,-5223.15C7443.13,-5235.58 7719.3,-5252.68 7783,-5187.49 7832.45,-5136.89 7779.09,-3972.91 7819,-3914.49 7902.3,-3792.58 8073.6,-3742.89 8188.55,-3722.82"/>
<polygon fill="black" stroke="black" points="8189.18,-3726.27 8198.45,-3721.14 8188,-3719.37 8189.18,-3726.27"/>
</g>
<!-- lot_io.get_lot&#45;&gt;lot_io.parse_lot_id -->
<g id="edge262" class="edge">
<title>lot_io.get_lot&#45;&gt;lot_io.parse_lot_id</title>
<path fill="none" stroke="black" d="M7310.59,-5214.89C7594.7,-5212.52 8645.4,-5203.75 9020.41,-5200.61"/>
<polygon fill="black" stroke="black" points="9020.53,-5204.11 9030.5,-5200.53 9020.47,-5197.11 9020.53,-5204.11"/>
</g>
<!-- telegram_bot._t -->
<g id="node154" class="node">
<title>telegram_bot._t</title>
<g id="a_node154"><a xlink:title="Return ``text`` translated to ``lang`` using gettext files.">
<polygon fill="none" stroke="black" points="5403.5,-5907.49 5195.5,-5907.49 5195.5,-5871.49 5403.5,-5871.49 5403.5,-5907.49"/>
<text text-anchor="middle" x="5299.5" y="-5883.62" font-family="Times,serif" font-size="24.22">telegram_bot._t</text>
</a>
</g>
</g>
<!-- telegram_bot.ensure_profile -->
<g id="node155" class="node">
<title>telegram_bot.ensure_profile</title>
<g id="a_node155"><a xlink:title="Return profile for ``uid`` creating one if needed.">
<polygon fill="none" stroke="black" points="5450.5,-5853.49 5148.5,-5853.49 5148.5,-5817.49 5450.5,-5817.49 5450.5,-5853.49"/>
<text text-anchor="middle" x="5299.5" y="-5830.7" font-family="Times,serif" font-size="19.74">telegram_bot.ensure_profile</text>
</a>
</g>
</g>
<!-- telegram_bot.save_profiles -->
<g id="node156" class="node">
<title>telegram_bot.save_profiles</title>
<g id="a_node156"><a xlink:title="Write ``profiles`` to disk.">
<polygon fill="none" stroke="black" points="6238,-5853.49 6030,-5853.49 6030,-5817.49 6238,-5817.49 6238,-5853.49"/>
<text text-anchor="middle" x="6134" y="-5831.79" font-family="Times,serif" font-size="14.00">telegram_bot.save_profiles</text>
</a>
</g>
</g>
<!-- telegram_bot.ensure_profile&#45;&gt;telegram_bot.save_profiles -->
<g id="edge273" class="edge">
<title>telegram_bot.ensure_profile&#45;&gt;telegram_bot.save_profiles</title>
<path fill="none" stroke="black" d="M5450.78,-5835.49C5614.29,-5835.49 5872.01,-5835.49 6019.44,-5835.49"/>
<polygon fill="black" stroke="black" points="6019.86,-5838.99 6029.86,-5835.49 6019.86,-5831.99 6019.86,-5838.99"/>
</g>
<!-- telegram_bot.load_profiles -->
<g id="node157" class="node">
<title>telegram_bot.load_profiles</title>
<g id="a_node157"><a xlink:title="Populate the global ``profiles`` mapping.">
<polygon fill="none" stroke="black" points="5450.5,-5607.49 5148.5,-5607.49 5148.5,-5571.49 5450.5,-5571.49 5450.5,-5607.49"/>
<text text-anchor="middle" x="5299.5" y="-5584.19" font-family="Times,serif" font-size="21.00">telegram_bot.load_profiles</text>
</a>
</g>
</g>
<!-- telegram_bot.load_profiles&#45;&gt;notes_utils.read_text -->
<g id="edge274" class="edge">
<title>telegram_bot.load_profiles&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M5450.54,-5590.53C5775.94,-5592.7 6570.9,-5597.49 7237,-5597.49 7237,-5597.49 7237,-5597.49 8305.5,-5597.49 8569.56,-5597.49 9299.78,-5641.7 9485,-5453.49 9538.29,-5399.34 9503.41,-5187.41 9521,-5113.49 9586.04,-4840.26 9729.7,-4529.62 9774.14,-4436.95"/>
<polygon fill="black" stroke="black" points="9777.41,-4438.23 9778.59,-4427.7 9771.1,-4435.2 9777.41,-4438.23"/>
</g>
<!-- telegram_bot.load_state -->
<g id="node158" class="node">
<title>telegram_bot.load_state</title>
<g id="a_node158"><a xlink:title="Populate ``processed_ids`` from ``STATE_PATH``.">
<polygon fill="none" stroke="black" points="5443,-5333.49 5156,-5333.49 5156,-5297.49 5443,-5297.49 5443,-5333.49"/>
<text text-anchor="middle" x="5299.5" y="-5309.8" font-family="Times,serif" font-size="22.12">telegram_bot.load_state</text>
</a>
</g>
</g>
<!-- telegram_bot.load_state&#45;&gt;notes_utils.read_text -->
<g id="edge275" class="edge">
<title>telegram_bot.load_state&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M5443.02,-5312.69C5486.82,-5316.2 5534.2,-5324.65 5575,-5342.49 5594.61,-5351.07 5591.14,-5366.5 5611,-5374.49 5826.81,-5461.3 6429.24,-5367.24 6657,-5414.49 6673.81,-5417.98 6676.13,-5425.33 6693,-5428.49 6931.07,-5473.15 7540.92,-5436.66 7783,-5428.49 8540.74,-5402.92 8920.07,-5819.14 9485,-5313.49 9552.3,-5253.26 9496.91,-5200.54 9521,-5113.49 9596,-4842.49 9733.18,-4529.73 9775.04,-4436.84"/>
<polygon fill="black" stroke="black" points="9778.3,-4438.12 9779.23,-4427.57 9771.92,-4435.24 9778.3,-4438.12"/>
</g>
<!-- telegram_bot.save_state -->
<g id="node159" class="node">
<title>telegram_bot.save_state</title>
<polygon fill="none" stroke="black" points="6218,-3988.49 6050,-3988.49 6050,-3952.49 6218,-3952.49 6218,-3988.49"/>
<text text-anchor="middle" x="6134" y="-3967.25" font-family="Times,serif" font-size="12.18">telegram_bot.save_state</text>
</g>
<!-- telegram_bot.scan_embeddings -->
<g id="node160" class="node">
<title>telegram_bot.scan_embeddings</title>
<g id="a_node160"><a xlink:title="Load new embeddings and return list of new lot ids.">
<polygon fill="none" stroke="black" points="7384,-1119.49 7092,-1119.49 7092,-1083.49 7384,-1083.49 7384,-1119.49"/>
<text text-anchor="middle" x="7238" y="-1097.33" font-family="Times,serif" font-size="17.08">telegram_bot.scan_embeddings</text>
</a>
</g>
</g>
<!-- telegram_bot.scan_embeddings&#45;&gt;similar_utils._load_embeddings -->
<g id="edge276" class="edge">
<title>telegram_bot.scan_embeddings&#45;&gt;similar_utils._load_embeddings</title>
<path fill="none" stroke="black" d="M7384.13,-1109.85C7523.33,-1114.92 7721.19,-1113.49 7783,-1069.49 7817.09,-1045.23 7785.15,-1007.09 7819,-982.49 7919.76,-909.28 8065.41,-907.87 8170.68,-919.79"/>
<polygon fill="black" stroke="black" points="8170.39,-923.28 8180.74,-920.98 8171.22,-916.33 8170.39,-923.28"/>
</g>
<!-- telegram_bot._should_suggest -->
<g id="node161" class="node">
<title>telegram_bot._should_suggest</title>
<polygon fill="none" stroke="black" points="6295.5,-4042.49 5972.5,-4042.49 5972.5,-4006.49 6295.5,-4006.49 6295.5,-4042.49"/>
<text text-anchor="middle" x="6134" y="-4019.7" font-family="Times,serif" font-size="19.74">telegram_bot._should_suggest</text>
</g>
<!-- telegram_bot._should_suggest&#45;&gt;similar_utils._cos_sim -->
<g id="edge277" class="edge">
<title>telegram_bot._should_suggest&#45;&gt;similar_utils._cos_sim</title>
<path fill="none" stroke="black" d="M6295.53,-4038.2C6429.66,-4045.82 6606.83,-4045.64 6657,-3997.49 6719.32,-3937.69 6630.9,-3670.52 6693,-3610.49 6748.84,-3556.52 6956.82,-3558.61 7098.82,-3567.06"/>
<polygon fill="black" stroke="black" points="7098.73,-3570.56 7108.92,-3567.68 7099.16,-3563.57 7098.73,-3570.56"/>
</g>
<!-- telegram_bot.enqueue_new_ids -->
<g id="node162" class="node">
<title>telegram_bot.enqueue_new_ids</title>
<polygon fill="none" stroke="black" points="5538,-5391.49 5061,-5391.49 5061,-5351.49 5538,-5351.49 5538,-5391.49"/>
<text text-anchor="middle" x="5299.5" y="-5364.42" font-family="Times,serif" font-size="28.84">telegram_bot.enqueue_new_ids</text>
</g>
<!-- telegram_bot.enqueue_new_ids&#45;&gt;telegram_bot.save_profiles -->
<g id="edge278" class="edge">
<title>telegram_bot.enqueue_new_ids&#45;&gt;telegram_bot.save_profiles</title>
<path fill="none" stroke="black" d="M5538.2,-5373.97C5551.71,-5380.77 5564.17,-5389.47 5575,-5400.49 5638.8,-5465.41 5545.48,-5745.31 5611,-5808.49 5733.22,-5926.35 5955.62,-5886.35 6066.48,-5856.29"/>
<polygon fill="black" stroke="black" points="6067.5,-5859.64 6076.21,-5853.6 6065.64,-5852.89 6067.5,-5859.64"/>
</g>
<!-- telegram_bot.enqueue_new_ids&#45;&gt;telegram_bot._should_suggest -->
<g id="edge279" class="edge">
<title>telegram_bot.enqueue_new_ids&#45;&gt;telegram_bot._should_suggest</title>
<path fill="none" stroke="black" d="M5538.04,-5370.24C5551.73,-5363.2 5564.26,-5354.1 5575,-5342.49 5672.47,-5237.17 5510.74,-4154.16 5611,-4051.49 5658.42,-4002.93 5828.69,-4001.9 5962.02,-4009.44"/>
<polygon fill="black" stroke="black" points="5962.18,-4012.96 5972.36,-4010.05 5962.59,-4005.97 5962.18,-4012.96"/>
</g>
<!-- telegram_bot._send_queue -->
<g id="node163" class="node">
<title>telegram_bot._send_queue</title>
<g id="a_node163"><a xlink:title="Send next lot from each user queue via ``app``.">
<polygon fill="none" stroke="black" points="5575,-5461.49 5024,-5461.49 5024,-5409.49 5575,-5409.49 5575,-5461.49"/>
<text text-anchor="middle" x="5299.5" y="-5425.8" font-family="Times,serif" font-size="39.62">telegram_bot._send_queue</text>
</a>
</g>
</g>
<!-- telegram_bot._send_queue&#45;&gt;lot_io.get_lot -->
<g id="edge280" class="edge">
<title>telegram_bot._send_queue&#45;&gt;lot_io.get_lot</title>
<path fill="none" stroke="black" d="M5563.27,-5409.38C5567.3,-5406.61 5571.22,-5403.65 5575,-5400.49 5615.78,-5366.43 5568.84,-5318.83 5611,-5286.49 5734.07,-5192.1 6842.17,-5207.4 7155.06,-5213.66"/>
<polygon fill="black" stroke="black" points="7155.34,-5217.17 7165.41,-5213.87 7155.48,-5210.17 7155.34,-5217.17"/>
</g>
<!-- telegram_bot._send_queue&#45;&gt;telegram_bot.save_profiles -->
<g id="edge281" class="edge">
<title>telegram_bot._send_queue&#45;&gt;telegram_bot.save_profiles</title>
<path fill="none" stroke="black" d="M5565.28,-5461.51C5568.65,-5464.33 5571.89,-5467.32 5575,-5470.49 5627.86,-5524.45 5556.15,-5756.55 5611,-5808.49 5734.12,-5925.09 5955.62,-5885.86 6066.28,-5856.16"/>
<polygon fill="black" stroke="black" points="6067.27,-5859.52 6075.99,-5853.5 6065.42,-5852.77 6067.27,-5859.52"/>
</g>
<!-- telegram_bot.send_alert -->
<g id="node164" class="node">
<title>telegram_bot.send_alert</title>
<g id="a_node164"><a xlink:title="Broadcast ``text`` to all registered users.">
<polygon fill="none" stroke="black" points="4908.5,-5699.49 4578.5,-5699.49 4578.5,-5663.49 4908.5,-5663.49 4908.5,-5699.49"/>
<text text-anchor="middle" x="4743.5" y="-5675.33" font-family="Times,serif" font-size="25.20">telegram_bot.send_alert</text>
</a>
</g>
</g>
<!-- telegram_bot.send_alert&#45;&gt;telegram_bot.load_profiles -->
<g id="edge282" class="edge">
<title>telegram_bot.send_alert&#45;&gt;telegram_bot.load_profiles</title>
<path fill="none" stroke="black" d="M4908.52,-5665.48C4935.14,-5662.26 4962.38,-5658.59 4988,-5654.49 5064.53,-5642.27 5150.75,-5623.84 5212.88,-5609.73"/>
<polygon fill="black" stroke="black" points="5213.66,-5613.14 5222.63,-5607.5 5212.11,-5606.31 5213.66,-5613.14"/>
</g>
<!-- telegram_bot.start_cmd -->
<g id="node165" class="node">
<title>telegram_bot.start_cmd</title>
<g id="a_node165"><a xlink:title="Register the user and confirm startup.">
<polygon fill="none" stroke="black" points="4855.5,-5880.49 4631.5,-5880.49 4631.5,-5844.49 4855.5,-5844.49 4855.5,-5880.49"/>
<text text-anchor="middle" x="4743.5" y="-5858.33" font-family="Times,serif" font-size="17.08">telegram_bot.start_cmd</text>
</a>
</g>
</g>
<!-- telegram_bot.start_cmd&#45;&gt;telegram_bot._t -->
<g id="edge283" class="edge">
<title>telegram_bot.start_cmd&#45;&gt;telegram_bot._t</title>
<path fill="none" stroke="black" d="M4855.61,-5867.91C4951.25,-5872.57 5088.66,-5879.27 5184.99,-5883.96"/>
<polygon fill="black" stroke="black" points="5184.9,-5887.46 5195.06,-5884.45 5185.24,-5880.47 5184.9,-5887.46"/>
</g>
<!-- telegram_bot.start_cmd&#45;&gt;telegram_bot.ensure_profile -->
<g id="edge284" class="edge">
<title>telegram_bot.start_cmd&#45;&gt;telegram_bot.ensure_profile</title>
<path fill="none" stroke="black" d="M4855.61,-5857.08C4936.67,-5853.13 5047.74,-5847.71 5138.37,-5843.3"/>
<polygon fill="black" stroke="black" points="5138.66,-5846.79 5148.47,-5842.8 5138.31,-5839.8 5138.66,-5846.79"/>
</g>
<!-- telegram_bot.lang_cmd -->
<g id="node166" class="node">
<title>telegram_bot.lang_cmd</title>
<g id="a_node166"><a xlink:title="Set preferred language or list available choices.">
<polygon fill="none" stroke="black" points="4918,-5937.99 4569,-5937.99 4569,-5898.99 4918,-5898.99 4918,-5937.99"/>
<text text-anchor="middle" x="4743.5" y="-5911.59" font-family="Times,serif" font-size="28.00">telegram_bot.lang_cmd</text>
</a>
</g>
</g>
<!-- telegram_bot.lang_cmd&#45;&gt;telegram_bot._t -->
<g id="edge285" class="edge">
<title>telegram_bot.lang_cmd&#45;&gt;telegram_bot._t</title>
<path fill="none" stroke="black" d="M4918.27,-5909.4C5005.28,-5904.84 5108.14,-5899.46 5184.92,-5895.44"/>
<polygon fill="black" stroke="black" points="5185.3,-5898.92 5195.11,-5894.91 5184.94,-5891.93 5185.3,-5898.92"/>
</g>
<!-- telegram_bot.lang_cmd&#45;&gt;telegram_bot.ensure_profile -->
<g id="edge286" class="edge">
<title>telegram_bot.lang_cmd&#45;&gt;telegram_bot.ensure_profile</title>
<path fill="none" stroke="black" d="M4918.27,-5909.16C4942.2,-5904.62 4966.07,-5898.28 4988,-5889.49 5006.57,-5882.06 5005.36,-5869.74 5024,-5862.49 5059.64,-5848.64 5099.76,-5840.8 5138.1,-5836.57"/>
<polygon fill="black" stroke="black" points="5138.74,-5840.02 5148.33,-5835.52 5138.02,-5833.06 5138.74,-5840.02"/>
</g>
<!-- telegram_bot.lang_cmd&#45;&gt;telegram_bot.save_profiles -->
<g id="edge287" class="edge">
<title>telegram_bot.lang_cmd&#45;&gt;telegram_bot.save_profiles</title>
<path fill="none" stroke="black" d="M4918.15,-5925.22C5086.36,-5930.04 5348.52,-5933.12 5575,-5916.49 5733.74,-5904.84 5915.93,-5875.31 6027.75,-5855.32"/>
<polygon fill="black" stroke="black" points="6028.45,-5858.75 6037.68,-5853.54 6027.22,-5851.86 6028.45,-5858.75"/>
</g>
<!-- telegram_bot.vote_callback -->
<g id="node167" class="node">
<title>telegram_bot.vote_callback</title>
<g id="a_node167"><a xlink:title="Handle inline button presses for lot feedback.">
<polygon fill="none" stroke="black" points="4958.5,-5825.99 4528.5,-5825.99 4528.5,-5784.99 4958.5,-5784.99 4958.5,-5825.99"/>
<text text-anchor="middle" x="4743.5" y="-5798.25" font-family="Times,serif" font-size="29.68">telegram_bot.vote_callback</text>
</a>
</g>
</g>
<!-- telegram_bot.vote_callback&#45;&gt;telegram_bot._t -->
<g id="edge288" class="edge">
<title>telegram_bot.vote_callback&#45;&gt;telegram_bot._t</title>
<path fill="none" stroke="black" d="M4958.62,-5825.34C4968.67,-5828.3 4978.52,-5831.67 4988,-5835.49 5006.55,-5842.97 5005.36,-5855.25 5024,-5862.49 5074.73,-5882.22 5134.53,-5889.75 5185.35,-5892.02"/>
<polygon fill="black" stroke="black" points="5185.26,-5895.52 5195.38,-5892.41 5185.53,-5888.53 5185.26,-5895.52"/>
</g>
<!-- telegram_bot.vote_callback&#45;&gt;telegram_bot.ensure_profile -->
<g id="edge289" class="edge">
<title>telegram_bot.vote_callback&#45;&gt;telegram_bot.ensure_profile</title>
<path fill="none" stroke="black" d="M4958.69,-5817.09C5018.44,-5820.33 5082.3,-5823.78 5138.34,-5826.82"/>
<polygon fill="black" stroke="black" points="5138.18,-5830.32 5148.35,-5827.36 5138.56,-5823.33 5138.18,-5830.32"/>
</g>
<!-- telegram_bot.vote_callback&#45;&gt;telegram_bot.save_profiles -->
<g id="edge290" class="edge">
<title>telegram_bot.vote_callback&#45;&gt;telegram_bot.save_profiles</title>
<path fill="none" stroke="black" d="M4958.77,-5803.64C5126.5,-5802.82 5365.64,-5803.05 5575,-5808.49 5729.23,-5812.5 5907.24,-5821.95 6019.93,-5828.54"/>
<polygon fill="black" stroke="black" points="6019.76,-5832.03 6029.95,-5829.12 6020.17,-5825.04 6019.76,-5832.03"/>
</g>
<!-- telegram_bot.main -->
<g id="node168" class="node">
<title>telegram_bot.main</title>
<g id="a_node168"><a xlink:title="Run the Telegram recommendation bot.">
<polygon fill="none" stroke="black" points="4909,-5397.49 4578,-5397.49 4578,-5353.49 4909,-5353.49 4909,-5397.49"/>
<text text-anchor="middle" x="4743.5" y="-5367.17" font-family="Times,serif" font-size="32.90">telegram_bot.main</text>
</a>
</g>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot.load_profiles -->
<g id="edge291" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot.load_profiles</title>
<path fill="none" stroke="black" d="M4778.86,-5397.58C4830.28,-5429.73 4931.15,-5489.42 5024,-5524.49 5075.43,-5543.92 5134.55,-5558.81 5184.71,-5569.4"/>
<polygon fill="black" stroke="black" points="5184.12,-5572.85 5194.62,-5571.46 5185.54,-5566 5184.12,-5572.85"/>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot.load_state -->
<g id="edge292" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot.load_state</title>
<path fill="none" stroke="black" d="M4909.23,-5355.5C4946.93,-5351.08 4986.84,-5346.51 5024,-5342.49 5063.5,-5338.22 5106.23,-5333.88 5145.95,-5329.97"/>
<polygon fill="black" stroke="black" points="5146.37,-5333.44 5155.97,-5328.98 5145.68,-5326.47 5146.37,-5333.44"/>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot.save_state -->
<g id="edge293" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot.save_state</title>
<path fill="none" stroke="black" d="M4909.14,-5384.95C4939.14,-5378.76 4967.41,-5366.26 4988,-5343.49 5076.8,-5245.29 4941.64,-4256.15 5024,-4152.49 5149.49,-3994.56 5795.81,-3973.02 6039.69,-3970.57"/>
<polygon fill="black" stroke="black" points="6039.98,-3974.07 6049.95,-3970.48 6039.92,-3967.07 6039.98,-3974.07"/>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot.scan_embeddings -->
<g id="edge294" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot.scan_embeddings</title>
<path fill="none" stroke="black" d="M4909.21,-5385.36C4939.3,-5379.16 4967.58,-5366.56 4988,-5343.49 5062.8,-5258.98 4947.41,-1363.39 5024,-1280.49 5163.2,-1129.84 6600.87,-1105.96 7081.49,-1102.19"/>
<polygon fill="black" stroke="black" points="7081.65,-1105.69 7091.62,-1102.12 7081.6,-1098.69 7081.65,-1105.69"/>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot.enqueue_new_ids -->
<g id="edge295" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot.enqueue_new_ids</title>
<path fill="none" stroke="black" d="M4909.22,-5374.3C4953.66,-5373.98 5002.75,-5373.63 5050.65,-5373.28"/>
<polygon fill="black" stroke="black" points="5050.88,-5376.78 5060.86,-5373.21 5050.83,-5369.78 5050.88,-5376.78"/>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot._send_queue -->
<g id="edge296" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot._send_queue</title>
<path fill="none" stroke="black" d="M4909.22,-5393.33C4952.92,-5398.06 5001.1,-5403.28 5048.25,-5408.39"/>
<polygon fill="black" stroke="black" points="5047.97,-5411.88 5058.29,-5409.48 5048.72,-5404.92 5047.97,-5411.88"/>
</g>
<!-- clean_data._parse_date -->
<g id="node169" class="node">
<title>clean_data._parse_date</title>
<g id="a_node169"><a xlink:title="Return the ``date`` field from a markdown file if present.">
<polygon fill="none" stroke="black" points="8444,-4796.49 8165,-4796.49 8165,-4760.49 8444,-4760.49 8444,-4796.49"/>
<text text-anchor="middle" x="8304.5" y="-4772.8" font-family="Times,serif" font-size="22.12">clean_data._parse_date</text>
</a>
</g>
</g>
<!-- clean_data._parse_date&#45;&gt;notes_utils.read_text -->
<g id="edge297" class="edge">
<title>clean_data._parse_date&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M8444.06,-4780.81C8541.63,-4780 8674.87,-4773.99 8790,-4751.49 9166.75,-4677.87 9595.53,-4495.41 9738.35,-4431.8"/>
<polygon fill="black" stroke="black" points="9740.04,-4434.88 9747.74,-4427.6 9737.18,-4428.49 9740.04,-4434.88"/>
</g>
<!-- clean_data._clean_raw -->
<g id="node170" class="node">
<title>clean_data._clean_raw</title>
<g id="a_node170"><a xlink:title="Delete raw posts older than ``cutoff``.">
<polygon fill="none" stroke="black" points="7391.5,-4897.49 7084.5,-4897.49 7084.5,-4861.49 7391.5,-4861.49 7391.5,-4897.49"/>
<text text-anchor="middle" x="7238" y="-4873.33" font-family="Times,serif" font-size="25.20">clean_data._clean_raw</text>
</a>
</g>
</g>
<!-- clean_data._clean_raw&#45;&gt;post_io.raw_post_path -->
<g id="edge298" class="edge">
<title>clean_data._clean_raw&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7391.82,-4893.98C7533.64,-4903.66 7730.5,-4906.21 7783,-4852.49 7835.48,-4798.8 7773.31,-3561.07 7819,-3501.49 7912.6,-3379.45 8105.16,-3357.02 8217.28,-3355.01"/>
<polygon fill="black" stroke="black" points="8217.59,-3358.51 8227.54,-3354.88 8217.5,-3351.51 8217.59,-3358.51"/>
</g>
<!-- clean_data._clean_raw&#45;&gt;clean_data._parse_date -->
<g id="edge299" class="edge">
<title>clean_data._clean_raw&#45;&gt;clean_data._parse_date</title>
<path fill="none" stroke="black" d="M7391.64,-4886C7528.46,-4889.32 7717.43,-4886.91 7783,-4852.49 7806.3,-4840.26 7795.74,-4817.79 7819,-4805.49 7934.32,-4744.51 8087.39,-4747.42 8190.35,-4759.24"/>
<polygon fill="black" stroke="black" points="8190.13,-4762.74 8200.47,-4760.45 8190.96,-4755.79 8190.13,-4762.74"/>
</g>
<!-- clean_data._clean_media -->
<g id="node171" class="node">
<title>clean_data._clean_media</title>
<g id="a_node171"><a xlink:title="Remove unused media files older than ``cutoff``.">
<polygon fill="none" stroke="black" points="7428,-4843.49 7048,-4843.49 7048,-4803.49 7428,-4803.49 7428,-4843.49"/>
<text text-anchor="middle" x="7238" y="-4816.42" font-family="Times,serif" font-size="28.84">clean_data._clean_media</text>
</a>
</g>
</g>
<!-- clean_data._clean_media&#45;&gt;caption_io.has_caption -->
<g id="edge300" class="edge">
<title>clean_data._clean_media&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M7428.26,-4825.6C7566.11,-4822.65 7736.52,-4808.11 7783,-4756.49 7857.55,-4673.71 7757.59,-2844.45 7819,-2751.49 7908.26,-2616.38 8103.21,-2564.52 8216.74,-2545.27"/>
<polygon fill="black" stroke="black" points="8217.49,-2548.69 8226.79,-2543.62 8216.35,-2541.79 8217.49,-2548.69"/>
</g>
<!-- clean_data._clean_media&#45;&gt;clean_data._parse_date -->
<g id="edge301" class="edge">
<title>clean_data._clean_media&#45;&gt;clean_data._parse_date</title>
<path fill="none" stroke="black" d="M7428.08,-4815.5C7635.72,-4806.72 7964.81,-4792.81 8154.81,-4784.78"/>
<polygon fill="black" stroke="black" points="8155.04,-4788.27 8164.88,-4784.35 8154.74,-4781.28 8155.04,-4788.27"/>
</g>
<!-- clean_data._clean_lots -->
<g id="node172" class="node">
<title>clean_data._clean_lots</title>
<g id="a_node172"><a xlink:title="Drop lots missing translations or source posts.">
<polygon fill="none" stroke="black" points="7440,-4747.49 7036,-4747.49 7036,-4701.49 7440,-4701.49 7440,-4747.49"/>
<text text-anchor="middle" x="7238" y="-4716.05" font-family="Times,serif" font-size="34.30">clean_data._clean_lots</text>
</a>
</g>
</g>
<!-- clean_data._clean_lots&#45;&gt;post_io.raw_post_path -->
<g id="edge302" class="edge">
<title>clean_data._clean_lots&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7440.13,-4739.82C7575.07,-4745.21 7736.35,-4740.49 7783,-4692.49 7875.27,-4597.55 7738.24,-3606.4 7819,-3501.49 7912.82,-3379.61 8105.3,-3357.13 8217.35,-3355.06"/>
<polygon fill="black" stroke="black" points="8217.65,-3358.56 8227.6,-3354.93 8217.56,-3351.56 8217.65,-3358.56"/>
</g>
<!-- clean_data._clean_lots&#45;&gt;lot_io.read_lots -->
<g id="edge304" class="edge">
<title>clean_data._clean_lots&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M7440.26,-4739.61C7575.01,-4744.86 7736.01,-4740.08 7783,-4692.49 7843.81,-4630.92 7769.54,-3985.5 7819,-3914.49 7903.26,-3793.51 8073.9,-3743.59 8188.47,-3723.22"/>
<polygon fill="black" stroke="black" points="8189.09,-3726.67 8198.35,-3721.52 8187.9,-3719.77 8189.09,-3726.67"/>
</g>
<!-- clean_data._clean_lots&#45;&gt;lot_io.needs_cleanup -->
<g id="edge303" class="edge">
<title>clean_data._clean_lots&#45;&gt;lot_io.needs_cleanup</title>
<path fill="none" stroke="black" d="M7440.16,-4724.49C7668.38,-4724.49 8031.32,-4724.49 8204.83,-4724.49"/>
<polygon fill="black" stroke="black" points="8204.97,-4727.99 8214.97,-4724.49 8204.97,-4720.99 8204.97,-4727.99"/>
</g>
<!-- clean_data._clean_embeddings -->
<g id="node173" class="node">
<title>clean_data._clean_embeddings</title>
<g id="a_node173"><a xlink:title="Delete embedding files when the matching lot JSON is absent.">
<polygon fill="none" stroke="black" points="7446,-4683.49 7030,-4683.49 7030,-4647.49 7446,-4647.49 7446,-4683.49"/>
<text text-anchor="middle" x="7238" y="-4659.33" font-family="Times,serif" font-size="25.20">clean_data._clean_embeddings</text>
</a>
</g>
</g>
<!-- clean_data._remove_empty_dirs -->
<g id="node174" class="node">
<title>clean_data._remove_empty_dirs</title>
<g id="a_node174"><a xlink:title="Recursively remove empty folders under ``root``.">
<polygon fill="none" stroke="black" points="8518,-4968.49 8091,-4968.49 8091,-4932.49 8518,-4932.49 8518,-4968.49"/>
<text text-anchor="middle" x="8304.5" y="-4944.33" font-family="Times,serif" font-size="25.20">clean_data._remove_empty_dirs</text>
</a>
</g>
</g>
<!-- clean_data.main -->
<g id="node175" class="node">
<title>clean_data.main</title>
<g id="a_node175"><a xlink:title="Clean up old or inconsistent files across data directories.">
<polygon fill="none" stroke="black" points="6230,-4841.49 6038,-4841.49 6038,-4805.49 6230,-4805.49 6230,-4841.49"/>
<text text-anchor="middle" x="6134" y="-4818.19" font-family="Times,serif" font-size="21.00">clean_data.main</text>
</a>
</g>
</g>
<!-- clean_data.main&#45;&gt;clean_data._clean_raw -->
<g id="edge305" class="edge">
<title>clean_data.main&#45;&gt;clean_data._clean_raw</title>
<path fill="none" stroke="black" d="M6230.28,-4828.51C6341.36,-4834.35 6530.48,-4844.24 6693,-4852.49 6821.1,-4859 6966.17,-4866.19 7074.27,-4871.52"/>
<polygon fill="black" stroke="black" points="7074.13,-4875.01 7084.29,-4872.01 7074.47,-4868.02 7074.13,-4875.01"/>
</g>
<!-- clean_data.main&#45;&gt;clean_data._clean_media -->
<g id="edge306" class="edge">
<title>clean_data.main&#45;&gt;clean_data._clean_media</title>
<path fill="none" stroke="black" d="M6230.39,-4823.49C6409.38,-4823.49 6799.03,-4823.49 7037.61,-4823.49"/>
<polygon fill="black" stroke="black" points="7037.8,-4826.99 7047.8,-4823.49 7037.8,-4819.99 7037.8,-4826.99"/>
</g>
<!-- clean_data.main&#45;&gt;clean_data._clean_lots -->
<g id="edge307" class="edge">
<title>clean_data.main&#45;&gt;clean_data._clean_lots</title>
<path fill="none" stroke="black" d="M6230.39,-4814.92C6406.42,-4799.11 6786.18,-4764.99 7025.64,-4743.48"/>
<polygon fill="black" stroke="black" points="7026.22,-4746.94 7035.87,-4742.56 7025.59,-4739.97 7026.22,-4746.94"/>
</g>
<!-- clean_data.main&#45;&gt;clean_data._clean_embeddings -->
<g id="edge308" class="edge">
<title>clean_data.main&#45;&gt;clean_data._clean_embeddings</title>
<path fill="none" stroke="black" d="M6195.83,-4805.38C6297.64,-4775.93 6509.48,-4718.37 6693,-4692.49 6799.93,-4677.41 6919.72,-4670.41 7019.61,-4667.29"/>
<polygon fill="black" stroke="black" points="7019.94,-4670.78 7029.83,-4666.98 7019.73,-4663.78 7019.94,-4670.78"/>
</g>
<!-- clean_data.main&#45;&gt;clean_data._remove_empty_dirs -->
<g id="edge309" class="edge">
<title>clean_data.main&#45;&gt;clean_data._remove_empty_dirs</title>
<path fill="none" stroke="black" d="M6178.46,-4841.59C6271.04,-4879.06 6495.42,-4964.06 6693,-4993.49 6932.58,-5029.18 7546.05,-5043.78 7783,-4993.49 7800.13,-4989.86 7801.98,-4981.6 7819,-4977.49 7903.1,-4957.18 7997.7,-4948.82 8080.84,-4946.09"/>
<polygon fill="black" stroke="black" points="8081.03,-4949.59 8090.92,-4945.79 8080.82,-4942.59 8081.03,-4949.59"/>
</g>
<!-- pending_caption._get_message_path -->
<g id="node176" class="node">
<title>pending_caption._get_message_path</title>
<g id="a_node176"><a xlink:title="Return path of stored message ``msg_id`` in ``chat`` if any.">
<polygon fill="none" stroke="black" points="8455,-4406.49 8154,-4406.49 8154,-4370.49 8455,-4370.49 8455,-4406.49"/>
<text text-anchor="middle" x="8304.5" y="-4384.45" font-family="Times,serif" font-size="15.68">pending_caption._get_message_path</text>
</a>
</g>
</g>
<!-- pending_caption.main -->
<g id="node177" class="node">
<title>pending_caption.main</title>
<polygon fill="none" stroke="black" points="6370.5,-4205.99 5897.5,-4205.99 5897.5,-4152.99 6370.5,-4152.99 6370.5,-4205.99"/>
<text text-anchor="middle" x="6134" y="-4169.29" font-family="Times,serif" font-size="40.88">pending_caption.main</text>
</g>
<!-- pending_caption.main&#45;&gt;post_io.read_post -->
<g id="edge311" class="edge">
<title>pending_caption.main&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M6325.32,-4205.99C6437.76,-4210.18 6573.95,-4193.25 6657,-4105.49 6721.24,-4037.61 6626.54,-3752.19 6693,-3686.49 6865.74,-3515.74 7611.46,-3777.45 7783,-3605.49 7861.83,-3526.47 7743.04,-3186.28 7819,-3104.49 7869.42,-3050.21 7941.66,-3024.65 8015.03,-3014.56"/>
<polygon fill="black" stroke="black" points="8015.91,-3017.98 8025.38,-3013.24 8015.02,-3011.03 8015.91,-3017.98"/>
</g>
<!-- pending_caption.main&#45;&gt;moderation.should_skip_message -->
<g id="edge313" class="edge">
<title>pending_caption.main&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M6264.88,-4152.98C6378.95,-4137.33 6543.9,-4134.13 6657,-4215.49 6690.97,-4239.93 6658.21,-4279.24 6693,-4302.49 6894.38,-4437.1 7544.34,-4343.86 7783,-4302.49 7876.48,-4286.29 8136.09,-4184.15 8249.42,-4138.49"/>
<polygon fill="black" stroke="black" points="8250.98,-4141.64 8258.94,-4134.65 8248.36,-4135.14 8250.98,-4141.64"/>
</g>
<!-- pending_caption.main&#45;&gt;caption_io.has_caption -->
<g id="edge310" class="edge">
<title>pending_caption.main&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M6297.66,-4206.02C6415.76,-4215.08 6569.6,-4203.84 6657,-4105.49 6714.59,-4040.69 6631.21,-2606.29 6693,-2545.49 6747.61,-2491.77 7889.28,-2521.98 8216.54,-2531.78"/>
<polygon fill="black" stroke="black" points="8216.81,-2535.29 8226.91,-2532.09 8217.02,-2528.29 8216.81,-2535.29"/>
</g>
<!-- pending_caption.main&#45;&gt;oom_utils.prefer_oom_kill -->
<g id="edge314" class="edge">
<title>pending_caption.main&#45;&gt;oom_utils.prefer_oom_kill</title>
<path fill="none" stroke="black" d="M6370.67,-4197.72C6464.01,-4195.77 6569.66,-4181.57 6657,-4138.49 6678.45,-4127.91 6671.35,-4108.65 6693,-4098.49 6802.73,-4047.01 7682.85,-4123.76 7783,-4055.49 7815.89,-4033.08 7786.41,-3996.34 7819,-3973.49 7935.68,-3891.68 8109.53,-3903.96 8214.17,-3921.74"/>
<polygon fill="black" stroke="black" points="8213.62,-3925.2 8224.07,-3923.48 8214.83,-3918.31 8213.62,-3925.2"/>
</g>
<!-- pending_caption.main&#45;&gt;image_io.read_image_meta -->
<g id="edge312" class="edge">
<title>pending_caption.main&#45;&gt;image_io.read_image_meta</title>
<path fill="none" stroke="black" d="M6370.63,-4166.71C6462.59,-4169.1 6567.26,-4181.21 6657,-4215.49 6675.93,-4222.73 6674.03,-4236.35 6693,-4243.49 6829.99,-4295.04 7000.08,-4295.97 7113.23,-4288.64"/>
<polygon fill="black" stroke="black" points="7113.58,-4292.12 7123.32,-4287.95 7113.1,-4285.14 7113.58,-4292.12"/>
</g>
<!-- pending_caption.main&#45;&gt;pending_caption._get_message_path -->
<g id="edge315" class="edge">
<title>pending_caption.main&#45;&gt;pending_caption._get_message_path</title>
<path fill="none" stroke="black" d="M6246.19,-4152.96C6362.22,-4132.32 6542.84,-4121.02 6657,-4215.49 6705.5,-4255.63 6643.58,-4313.49 6693,-4352.49 6804.83,-4440.75 7758.88,-4411.32 8143.63,-4395.63"/>
<polygon fill="black" stroke="black" points="8143.88,-4399.13 8153.73,-4395.22 8143.59,-4392.13 8143.88,-4399.13"/>
</g>
<!-- pending_chop.main -->
<g id="node178" class="node">
<title>pending_chop.main</title>
<polygon fill="none" stroke="black" points="7405.5,-4012.99 7070.5,-4012.99 7070.5,-3969.99 7405.5,-3969.99 7405.5,-4012.99"/>
<text text-anchor="middle" x="7238" y="-3983.34" font-family="Times,serif" font-size="32.06">pending_chop.main</text>
</g>
<!-- pending_chop.main&#45;&gt;post_io.read_post -->
<g id="edge316" class="edge">
<title>pending_chop.main&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7342.1,-4013.03C7466.49,-4032.3 7672.63,-4041.54 7783,-3921.49 7844.5,-3854.6 7758.09,-3171.92 7819,-3104.49 7868.97,-3049.18 7941.55,-3023.42 8015.4,-3013.47"/>
<polygon fill="black" stroke="black" points="8015.86,-3016.94 8025.35,-3012.23 8014.99,-3010 8015.86,-3016.94"/>
</g>
<!-- pending_chop.main&#45;&gt;moderation.should_skip_message -->
<g id="edge317" class="edge">
<title>pending_chop.main&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M7405.55,-4011.46C7521.47,-4025.31 7679.64,-4044.15 7819,-4060.49 7924.48,-4072.86 8042.91,-4086.56 8136.28,-4097.3"/>
<polygon fill="black" stroke="black" points="8136.05,-4100.8 8146.38,-4098.47 8136.85,-4093.85 8136.05,-4100.8"/>
</g>
<!-- pending_chop.main&#45;&gt;oom_utils.prefer_oom_kill -->
<g id="edge318" class="edge">
<title>pending_chop.main&#45;&gt;oom_utils.prefer_oom_kill</title>
<path fill="none" stroke="black" d="M7405.62,-3983.67C7602.64,-3974.41 7929,-3959.08 8129.28,-3949.68"/>
<polygon fill="black" stroke="black" points="8129.49,-3953.17 8139.31,-3949.2 8129.16,-3946.18 8129.49,-3953.17"/>
</g>
<!-- pending_embed._needs_embedding -->
<g id="node179" class="node">
<title>pending_embed._needs_embedding</title>
<g id="a_node179"><a xlink:title="Return ``True`` when ``emb`` is missing or stale.&#10;&#10;The function also upgrades older vector files stored as a single object and&#10;removes corrupted or mismatched ones so ``embed.py`` always operates on&#10;clean data.">
<polygon fill="none" stroke="black" points="8713.5,-1993.99 7895.5,-1993.99 7895.5,-1936.99 8713.5,-1936.99 8713.5,-1993.99"/>
<text text-anchor="middle" x="8304.5" y="-1954.15" font-family="Times,serif" font-size="44.80">pending_embed._needs_embedding</text>
</a>
</g>
</g>
<!-- pending_embed._needs_embedding&#45;&gt;notes_utils.load_json -->
<g id="edge319" class="edge">
<title>pending_embed._needs_embedding&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M8581.05,-1936.95C8659.85,-1915.09 8738.29,-1877.54 8790,-1813.49 8844.95,-1745.43 8763.85,-1483.05 8826,-1421.49 8889.23,-1358.87 8996.87,-1362.37 9071.62,-1374.76"/>
<polygon fill="black" stroke="black" points="9071.03,-1378.21 9081.49,-1376.48 9072.24,-1371.32 9071.03,-1378.21"/>
</g>
<!-- pending_embed._needs_embedding&#45;&gt;notes_utils.write_json -->
<g id="edge320" class="edge">
<title>pending_embed._needs_embedding&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M8470.8,-1936.98C8573.42,-1928.86 8702.04,-1937.3 8790,-2008.49 8832.29,-2042.72 8791.57,-2083.37 8826,-2125.49 8892.87,-2207.31 9007.42,-2257.43 9082.04,-2283.1"/>
<polygon fill="black" stroke="black" points="9081.25,-2286.52 9091.85,-2286.41 9083.49,-2279.89 9081.25,-2286.52"/>
</g>
<!-- pending_embed.main -->
<g id="node180" class="node">
<title>pending_embed.main</title>
<polygon fill="none" stroke="black" points="6400.5,-2933.49 5867.5,-2933.49 5867.5,-2873.49 6400.5,-2873.49 6400.5,-2933.49"/>
<text text-anchor="middle" x="6134" y="-2891.52" font-family="Times,serif" font-size="47.46">pending_embed.main</text>
</g>
<!-- pending_embed.main&#45;&gt;post_io.read_post -->
<g id="edge321" class="edge">
<title>pending_embed.main&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M6400.66,-2892.2C6727.16,-2881.82 7297.6,-2875 7783,-2927.49 7905.68,-2940.76 8042.32,-2969.12 8144.8,-2993.17"/>
<polygon fill="black" stroke="black" points="8144.08,-2996.59 8154.61,-2995.48 8145.68,-2989.78 8144.08,-2996.59"/>
</g>
<!-- pending_embed.main&#45;&gt;lot_io.read_lots -->
<g id="edge325" class="edge">
<title>pending_embed.main&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M6166.32,-2933.53C6246.34,-3008.2 6467.85,-3202.15 6693,-3285.49 6921.51,-3370.08 7608.37,-3234.57 7783,-3404.49 7867.55,-3486.77 7733.53,-3586.16 7819,-3667.49 7926.95,-3770.22 8116.33,-3751.26 8223.56,-3729.58"/>
<polygon fill="black" stroke="black" points="8224.28,-3733.01 8233.36,-3727.55 8222.85,-3726.15 8224.28,-3733.01"/>
</g>
<!-- pending_embed.main&#45;&gt;lot_io.iter_lot_files -->
<g id="edge327" class="edge">
<title>pending_embed.main&#45;&gt;lot_io.iter_lot_files</title>
<path fill="none" stroke="black" d="M6175.21,-2873.42C6278.27,-2793.6 6551.17,-2564.29 6657,-2299.49 6688.13,-2221.61 6632.29,-1603.37 6693,-1545.49 6780.66,-1461.92 7662.17,-1537.18 7783,-1545.49 7924.06,-1555.2 8085.12,-1579.55 8190.25,-1597.25"/>
<polygon fill="black" stroke="black" points="8189.8,-1600.72 8200.24,-1598.94 8190.97,-1593.82 8189.8,-1600.72"/>
</g>
<!-- pending_embed.main&#45;&gt;oom_utils.prefer_oom_kill -->
<g id="edge328" class="edge">
<title>pending_embed.main&#45;&gt;oom_utils.prefer_oom_kill</title>
<path fill="none" stroke="black" d="M6167.39,-2933.72C6267.45,-3026.47 6572.16,-3304.11 6693,-3359.49 7140.17,-3564.44 7432.08,-3206.78 7783,-3551.49 7842.76,-3610.19 7766.24,-3671.43 7819,-3736.49 7907.02,-3845.04 8062.9,-3897.06 8174.08,-3921.35"/>
<polygon fill="black" stroke="black" points="8173.51,-3924.81 8184.02,-3923.48 8174.97,-3917.97 8173.51,-3924.81"/>
</g>
<!-- pending_embed.main&#45;&gt;lot_io.embedding_path -->
<g id="edge326" class="edge">
<title>pending_embed.main&#45;&gt;lot_io.embedding_path</title>
<path fill="none" stroke="black" d="M6194.51,-2873.34C6294.43,-2824.59 6503.58,-2730.49 6693,-2696.49 6812.21,-2675.09 7675.21,-2641.28 7783,-2696.49 7807.37,-2708.98 7795.05,-2733.21 7819,-2746.49 7932.26,-2809.31 8084.07,-2808.25 8187.38,-2797.36"/>
<polygon fill="black" stroke="black" points="8187.98,-2800.82 8197.53,-2796.25 8187.21,-2793.86 8187.98,-2800.82"/>
</g>
<!-- pending_embed.main&#45;&gt;post_io.raw_post_path_from_lot -->
<g id="edge322" class="edge">
<title>pending_embed.main&#45;&gt;post_io.raw_post_path_from_lot</title>
<path fill="none" stroke="black" d="M6186.75,-2933.66C6323.77,-3013.5 6686.05,-3224.41 6693,-3226.49 6820.41,-3264.75 6971.97,-3270.64 7082.72,-3268.17"/>
<polygon fill="black" stroke="black" points="7083.06,-3271.66 7092.97,-3267.92 7082.89,-3264.66 7083.06,-3271.66"/>
</g>
<!-- pending_embed.main&#45;&gt;moderation.message_skip_reason -->
<g id="edge323" class="edge">
<title>pending_embed.main&#45;&gt;moderation.message_skip_reason</title>
<path fill="none" stroke="black" d="M6197.28,-2933.5C6312.52,-2992.88 6556.44,-3137.5 6657,-3341.49 6697.82,-3424.29 6626.59,-4107.38 6693,-4171.49 6769.32,-4245.17 8208.42,-4216.58 8850.1,-4200.04"/>
<polygon fill="black" stroke="black" points="8850.52,-4203.54 8860.43,-4199.78 8850.34,-4196.54 8850.52,-4203.54"/>
</g>
<!-- pending_embed.main&#45;&gt;moderation.lot_skip_reason -->
<g id="edge324" class="edge">
<title>pending_embed.main&#45;&gt;moderation.lot_skip_reason</title>
<path fill="none" stroke="black" d="M6175.32,-2873.46C6278.64,-2793.75 6552.11,-2564.66 6657,-2299.49 6693.24,-2207.87 6624.48,-1484.29 6693,-1413.49 6777.46,-1326.23 7662.08,-1344.64 7783,-1333.49 7799.03,-1332.01 7802.93,-1330.38 7819,-1329.49 7926.72,-1323.53 8700.89,-1268.67 8790,-1329.49 8826.27,-1354.25 8790.78,-1395.27 8826,-1421.49 8886.7,-1466.68 8972.35,-1472.39 9040.98,-1467.34"/>
<polygon fill="black" stroke="black" points="9041.29,-1470.83 9050.97,-1466.53 9040.72,-1463.85 9041.29,-1470.83"/>
</g>
<!-- pending_embed.main&#45;&gt;pending_embed._needs_embedding -->
<g id="edge329" class="edge">
<title>pending_embed.main&#45;&gt;pending_embed._needs_embedding</title>
<path fill="none" stroke="black" d="M6175,-2873.34C6277.56,-2793.31 6549.37,-2563.56 6657,-2299.49 6681.62,-2239.08 6645.48,-1758.18 6693,-1713.49 6781.23,-1630.52 7689.69,-1636.28 7783,-1713.49 7848.88,-1768.01 7756.78,-1843.84 7819,-1902.49 7839.06,-1921.41 7861.84,-1936.53 7886.33,-1948.53"/>
<polygon fill="black" stroke="black" points="7884.89,-1951.72 7895.42,-1952.81 7887.87,-1945.39 7884.89,-1951.72"/>
</g>
<!-- check_translations.parse_po -->
<g id="node181" class="node">
<title>check_translations.parse_po</title>
<polygon fill="none" stroke="black" points="9447.5,-4863.49 8863.5,-4863.49 8863.5,-4811.49 9447.5,-4811.49 9447.5,-4863.49"/>
<text text-anchor="middle" x="9155.5" y="-4827.8" font-family="Times,serif" font-size="39.62">check_translations.parse_po</text>
</g>
<!-- check_translations.check_translations -->
<g id="node182" class="node">
<title>check_translations.check_translations</title>
<polygon fill="none" stroke="black" points="8637,-4859.99 7972,-4859.99 7972,-4814.99 8637,-4814.99 8637,-4859.99"/>
<text text-anchor="middle" x="8304.5" y="-4829.11" font-family="Times,serif" font-size="33.60">check_translations.check_translations</text>
</g>
<!-- check_translations.check_translations&#45;&gt;check_translations.parse_po -->
<g id="edge330" class="edge">
<title>check_translations.check_translations&#45;&gt;check_translations.parse_po</title>
<path fill="none" stroke="black" d="M8637.09,-4837.49C8708.25,-4837.49 8783.08,-4837.49 8853.03,-4837.49"/>
<polygon fill="black" stroke="black" points="8853.32,-4840.99 8863.32,-4837.49 8853.32,-4833.99 8853.32,-4840.99"/>
</g>
<!-- embed:cli -->
<g id="node184" class="node">
<title>embed:cli</title>
<g id="a_node184"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="1836" cy="-5681.49" rx="29.05" ry="18"/>
<text text-anchor="middle" x="1836" y="-5679.89" font-family="Times,serif" font-size="7.00">embed:cli</text>
</a>
</g>
</g>
<!-- caption:cli&#45;&gt;embed:cli -->
<!-- scan_ontology:cli -->
<g id="node185" class="node">
<title>scan_ontology:cli</title>
<g id="a_node185"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="2403.5" cy="-5681.49" rx="44.19" ry="18"/>
<text text-anchor="middle" x="2403.5" y="-5679.89" font-family="Times,serif" font-size="7.00">scan_ontology:cli</text>
</a>
</g>
</g>
<!-- embed:cli&#45;&gt;scan_ontology:cli -->
<!-- cluster_items:cli -->
<g id="node186" class="node">
<title>cluster_items:cli</title>
<g id="a_node186"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="3008.5" cy="-5681.49" rx="42.34" ry="18"/>
<text text-anchor="middle" x="3008.5" y="-5679.89" font-family="Times,serif" font-size="7.00">cluster_items:cli</text>
</a>
</g>
</g>
<!-- scan_ontology:cli&#45;&gt;cluster_items:cli -->
<!-- debug_dump:cli -->
<g id="node187" class="node">
<title>debug_dump:cli</title>
<g id="a_node187"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="3855" cy="-5681.49" rx="41.11" ry="18"/>
<text text-anchor="middle" x="3855" y="-5679.89" font-family="Times,serif" font-size="7.00">debug_dump:cli</text>
</a>
</g>
</g>
<!-- cluster_items:cli&#45;&gt;debug_dump:cli -->
<!-- chop:cli -->
<g id="node188" class="node">
<title>chop:cli</title>
<g id="a_node188"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="141" cy="-5736.49" rx="27" ry="18"/>
<text text-anchor="middle" x="141" y="-5734.89" font-family="Times,serif" font-size="7.00">chop:cli</text>
</a>
</g>
</g>
<!-- price_train:cli -->
<g id="node189" class="node">
<title>price_train:cli</title>
<g id="a_node189"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="602" cy="-5736.49" rx="36.68" ry="18"/>
<text text-anchor="middle" x="602" y="-5734.89" font-family="Times,serif" font-size="7.00">price_train:cli</text>
</a>
</g>
</g>
<!-- chop:cli&#45;&gt;price_train:cli -->
<!-- build_site:cli -->
<g id="node190" class="node">
<title>build_site:cli</title>
<g id="a_node190"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="1278.5" cy="-5736.49" rx="34.71" ry="18"/>
<text text-anchor="middle" x="1278.5" y="-5734.89" font-family="Times,serif" font-size="7.00">build_site:cli</text>
</a>
</g>
</g>
<!-- price_train:cli&#45;&gt;build_site:cli -->
<!-- tg_client:cli -->
<g id="node191" class="node">
<title>tg_client:cli</title>
<g id="a_node191"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="1836" cy="-5736.49" rx="32.86" ry="18"/>
<text text-anchor="middle" x="1836" y="-5734.89" font-family="Times,serif" font-size="7.00">tg_client:cli</text>
</a>
</g>
</g>
<!-- build_site:cli&#45;&gt;tg_client:cli -->
<!-- moderation:cli -->
<g id="node192" class="node">
<title>moderation:cli</title>
<g id="a_node192"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="2403.5" cy="-5736.49" rx="38.53" ry="18"/>
<text text-anchor="middle" x="2403.5" y="-5734.89" font-family="Times,serif" font-size="7.00">moderation:cli</text>
</a>
</g>
</g>
<!-- tg_client:cli&#45;&gt;moderation:cli -->
<!-- telegram_bot:cli -->
<g id="node193" class="node">
<title>telegram_bot:cli</title>
<g id="a_node193"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="3008.5" cy="-5736.49" rx="111.95" ry="19.18"/>
<text text-anchor="middle" x="3008.5" y="-5732.33" font-family="Times,serif" font-size="17.08">telegram_bot:cli</text>
</a>
</g>
</g>
<!-- moderation:cli&#45;&gt;telegram_bot:cli -->
<!-- clean_data:cli -->
<g id="node194" class="node">
<title>clean_data:cli</title>
<g id="a_node194"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="3855" cy="-5736.49" rx="37.29" ry="18"/>
<text text-anchor="middle" x="3855" y="-5734.89" font-family="Times,serif" font-size="7.00">clean_data:cli</text>
</a>
</g>
</g>
<!-- telegram_bot:cli&#45;&gt;clean_data:cli -->
<!-- pending_caption:cli -->
<g id="node195" class="node">
<title>pending_caption:cli</title>
<g id="a_node195"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="141" cy="-5790.49" rx="48.62" ry="18"/>
<text text-anchor="middle" x="141" y="-5788.89" font-family="Times,serif" font-size="7.00">pending_caption:cli</text>
</a>
</g>
</g>
<!-- pending_chop:cli -->
<g id="node196" class="node">
<title>pending_chop:cli</title>
<g id="a_node196"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="602" cy="-5790.49" rx="42.96" ry="18"/>
<text text-anchor="middle" x="602" y="-5788.89" font-family="Times,serif" font-size="7.00">pending_chop:cli</text>
</a>
</g>
</g>
<!-- pending_caption:cli&#45;&gt;pending_chop:cli -->
<!-- pending_embed:cli -->
<g id="node197" class="node">
<title>pending_embed:cli</title>
<g id="a_node197"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="1278.5" cy="-5790.49" rx="47.39" ry="18"/>
<text text-anchor="middle" x="1278.5" y="-5788.89" font-family="Times,serif" font-size="7.00">pending_embed:cli</text>
</a>
</g>
</g>
<!-- pending_chop:cli&#45;&gt;pending_embed:cli -->
<!-- check_translations:cli -->
<g id="node198" class="node">
<title>check_translations:cli</title>
<g id="a_node198"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="1836" cy="-5790.49" rx="73.67" ry="18"/>
<text text-anchor="middle" x="1836" y="-5788.04" font-family="Times,serif" font-size="9.94">check_translations:cli</text>
</a>
</g>
</g>
<!-- pending_embed:cli&#45;&gt;check_translations:cli -->
<!-- build_site -->
<g id="node199" class="node">
<title>build_site</title>
<ellipse fill="none" stroke="black" cx="4743.5" cy="-819.49" rx="55.79" ry="18"/>
<text text-anchor="middle" x="4743.5" y="-815.79" font-family="Times,serif" font-size="14.00">build_site</text>
</g>
<!-- build_site&#45;&gt;build_site.main -->
<g id="edge345" class="edge">
<title>build_site:cli&#45;&gt;build_site.main</title>
<path fill="none" stroke="black" d="M4799.65,-819.49C4865.07,-819.49 4978.14,-819.49 5080.11,-819.49"/>
<polygon fill="black" stroke="black" points="5080.25,-822.99 5090.25,-819.49 5080.25,-815.99 5080.25,-822.99"/>
</g>
<!-- caption -->
<g id="node200" class="node">
<title>caption</title>
<ellipse fill="none" stroke="black" cx="5299.5" cy="-1307.49" rx="44.69" ry="18"/>
<text text-anchor="middle" x="5299.5" y="-1303.79" font-family="Times,serif" font-size="14.00">caption</text>
</g>
<!-- caption&#45;&gt;caption.main -->
<g id="edge346" class="edge">
<title>caption:cli&#45;&gt;caption.main</title>
<path fill="none" stroke="black" d="M5344.38,-1307.02C5472.49,-1305.63 5848.48,-1301.57 6031.11,-1299.59"/>
<polygon fill="black" stroke="black" points="6031.3,-1303.09 6041.26,-1299.48 6031.22,-1296.09 6031.3,-1303.09"/>
</g>
<!-- check_translations -->
<g id="node201" class="node">
<title>check_translations</title>
<ellipse fill="none" stroke="black" cx="7238" cy="-4933.49" rx="96.68" ry="18"/>
<text text-anchor="middle" x="7238" y="-4929.79" font-family="Times,serif" font-size="14.00">check_translations</text>
</g>
<!-- check_translations&#45;&gt;oom_utils.prefer_oom_kill -->
<g id="edge347" class="edge">
<title>check_translations:cli&#45;&gt;oom_utils.prefer_oom_kill</title>
<path fill="none" stroke="black" d="M7322.42,-4942.33C7458.84,-4954.74 7720.74,-4969.35 7783,-4906.49 7853.43,-4835.39 7751.61,-4080.49 7819,-4006.49 7915.24,-3900.82 8094.55,-3906.05 8205.97,-3922"/>
<polygon fill="black" stroke="black" points="8205.46,-3925.47 8215.87,-3923.47 8206.49,-3918.54 8205.46,-3925.47"/>
</g>
<!-- check_translations&#45;&gt;check_translations.check_translations -->
<g id="edge348" class="edge">
<title>check_translations:cli&#45;&gt;check_translations.check_translations</title>
<path fill="none" stroke="black" d="M7309.33,-4945.73C7416.8,-4961.06 7625.95,-4977.45 7783,-4906.49 7803.91,-4897.05 7798.17,-4879.11 7819,-4869.49 7863.4,-4849 7912.55,-4836.14 7962.02,-4828.53"/>
<polygon fill="black" stroke="black" points="7962.54,-4831.99 7971.92,-4827.07 7961.52,-4825.06 7962.54,-4831.99"/>
</g>
<!-- chop -->
<g id="node202" class="node">
<title>chop</title>
<ellipse fill="none" stroke="black" cx="4743.5" cy="-4610.49" rx="32.49" ry="18"/>
<text text-anchor="middle" x="4743.5" y="-4606.79" font-family="Times,serif" font-size="14.00">chop</text>
</g>
<!-- chop&#45;&gt;chop.main -->
<g id="edge349" class="edge">
<title>chop:cli&#45;&gt;chop.main</title>
<path fill="none" stroke="black" d="M4776.28,-4610.49C4859.91,-4610.49 5088.32,-4610.49 5213.56,-4610.49"/>
<polygon fill="black" stroke="black" points="5213.88,-4613.99 5223.88,-4610.49 5213.88,-4606.99 5213.88,-4613.99"/>
</g>
<!-- clean_data -->
<g id="node203" class="node">
<title>clean_data</title>
<ellipse fill="none" stroke="black" cx="5299.5" cy="-4823.49" rx="59.59" ry="18"/>
<text text-anchor="middle" x="5299.5" y="-4819.79" font-family="Times,serif" font-size="14.00">clean_data</text>
</g>
<!-- clean_data&#45;&gt;clean_data.main -->
<g id="edge350" class="edge">
<title>clean_data:cli&#45;&gt;clean_data.main</title>
<path fill="none" stroke="black" d="M5359.37,-4823.49C5498.77,-4823.49 5850.57,-4823.49 6027.69,-4823.49"/>
<polygon fill="black" stroke="black" points="6027.8,-4826.99 6037.8,-4823.49 6027.8,-4819.99 6027.8,-4826.99"/>
</g>
<!-- cluster_items -->
<g id="node204" class="node">
<title>cluster_items</title>
<ellipse fill="none" stroke="black" cx="4743.5" cy="-3410.49" rx="73.39" ry="18"/>
<text text-anchor="middle" x="4743.5" y="-3406.79" font-family="Times,serif" font-size="14.00">cluster_items</text>
</g>
<!-- cluster_items&#45;&gt;cluster_items.main -->
<g id="edge351" class="edge">
<title>cluster_items:cli&#45;&gt;cluster_items.main</title>
<path fill="none" stroke="black" d="M4817.21,-3410.49C4909.44,-3410.49 5069.72,-3410.49 5179.79,-3410.49"/>
<polygon fill="black" stroke="black" points="5179.95,-3413.99 5189.95,-3410.49 5179.95,-3406.99 5179.95,-3413.99"/>
</g>
<!-- debug_dump -->
<g id="node205" class="node">
<title>debug_dump</title>
<ellipse fill="none" stroke="black" cx="5299.5" cy="-2259.49" rx="70.39" ry="18"/>
<text text-anchor="middle" x="5299.5" y="-2255.79" font-family="Times,serif" font-size="14.00">debug_dump</text>
</g>
<!-- debug_dump&#45;&gt;debug_dump.main -->
<g id="edge352" class="edge">
<title>debug_dump:cli&#45;&gt;debug_dump.main</title>
<path fill="none" stroke="black" d="M5370.05,-2259.49C5481.79,-2259.49 5706.7,-2259.49 5883.51,-2259.49"/>
<polygon fill="black" stroke="black" points="5883.75,-2262.99 5893.75,-2259.49 5883.75,-2255.99 5883.75,-2262.99"/>
</g>
<!-- embed -->
<g id="node206" class="node">
<title>embed</title>
<ellipse fill="none" stroke="black" cx="5299.5" cy="-4242.49" rx="42.49" ry="18"/>
<text text-anchor="middle" x="5299.5" y="-4238.79" font-family="Times,serif" font-size="14.00">embed</text>
</g>
<!-- embed&#45;&gt;embed.main -->
<g id="edge353" class="edge">
<title>embed:cli&#45;&gt;embed.main</title>
<path fill="none" stroke="black" d="M5341.78,-4242.49C5468.41,-4242.49 5853.73,-4242.49 6035.77,-4242.49"/>
<polygon fill="black" stroke="black" points="6035.88,-4245.99 6045.88,-4242.49 6035.88,-4238.99 6035.88,-4245.99"/>
</g>
<!-- moderation -->
<g id="node207" class="node">
<title>moderation</title>
<ellipse fill="none" stroke="black" cx="6134" cy="-3878.49" rx="63.89" ry="18"/>
<text text-anchor="middle" x="6134" y="-3874.79" font-family="Times,serif" font-size="14.00">moderation</text>
</g>
<!-- moderation&#45;&gt;moderation.apply_to_history -->
<g id="edge354" class="edge">
<title>moderation:cli&#45;&gt;moderation.apply_to_history</title>
<path fill="none" stroke="black" d="M6197.81,-3879.12C6343.31,-3880.57 6710.64,-3884.24 6967.06,-3886.8"/>
<polygon fill="black" stroke="black" points="6967.25,-3890.3 6977.28,-3886.9 6967.32,-3883.3 6967.25,-3890.3"/>
</g>
<!-- pending_caption -->
<g id="node208" class="node">
<title>pending_caption</title>
<ellipse fill="none" stroke="black" cx="5299.5" cy="-4179.49" rx="87.18" ry="18"/>
<text text-anchor="middle" x="5299.5" y="-4175.79" font-family="Times,serif" font-size="14.00">pending_caption</text>
</g>
<!-- pending_caption&#45;&gt;pending_caption.main -->
<g id="edge355" class="edge">
<title>pending_caption:cli&#45;&gt;pending_caption.main</title>
<path fill="none" stroke="black" d="M5386.85,-4179.49C5504.09,-4179.49 5718.41,-4179.49 5887.37,-4179.49"/>
<polygon fill="black" stroke="black" points="5887.41,-4182.99 5897.41,-4179.49 5887.41,-4175.99 5887.41,-4182.99"/>
</g>
<!-- pending_chop -->
<g id="node209" class="node">
<title>pending_chop</title>
<ellipse fill="none" stroke="black" cx="6134" cy="-4078.49" rx="74.99" ry="18"/>
<text text-anchor="middle" x="6134" y="-4074.79" font-family="Times,serif" font-size="14.00">pending_chop</text>
</g>
<!-- pending_chop&#45;&gt;pending_chop.main -->
<g id="edge356" class="edge">
<title>pending_chop:cli&#45;&gt;pending_chop.main</title>
<path fill="none" stroke="black" d="M6202.17,-4086.12C6303.61,-4095.21 6500.65,-4103.28 6657,-4051.49 6675.25,-4045.45 6674.79,-4033.67 6693,-4027.49 6810.99,-3987.47 6951.48,-3979.09 7060.13,-3980.39"/>
<polygon fill="black" stroke="black" points="7060.16,-3983.89 7070.22,-3980.54 7060.27,-3976.89 7060.16,-3983.89"/>
</g>
<!-- pending_embed -->
<g id="node210" class="node">
<title>pending_embed</title>
<ellipse fill="none" stroke="black" cx="5299.5" cy="-2903.49" rx="83.69" ry="18"/>
<text text-anchor="middle" x="5299.5" y="-2899.79" font-family="Times,serif" font-size="14.00">pending_embed</text>
</g>
<!-- pending_embed&#45;&gt;pending_embed.main -->
<g id="edge357" class="edge">
<title>pending_embed:cli&#45;&gt;pending_embed.main</title>
<path fill="none" stroke="black" d="M5383.37,-2903.49C5493.04,-2903.49 5691.82,-2903.49 5857.14,-2903.49"/>
<polygon fill="black" stroke="black" points="5857.48,-2906.99 5867.48,-2903.49 5857.48,-2899.99 5857.48,-2906.99"/>
</g>
<!-- price_train -->
<g id="node211" class="node">
<title>price_train</title>
<ellipse fill="none" stroke="black" cx="5299.5" cy="-1061.49" rx="61.19" ry="18"/>
<text text-anchor="middle" x="5299.5" y="-1057.79" font-family="Times,serif" font-size="14.00">price_train</text>
</g>
<!-- price_train&#45;&gt;price_train.main -->
<g id="edge358" class="edge">
<title>price_train:cli&#45;&gt;price_train.main</title>
<path fill="none" stroke="black" d="M5360.71,-1061.49C5496.15,-1061.49 5827.17,-1061.49 6008.76,-1061.49"/>
<polygon fill="black" stroke="black" points="6008.9,-1064.99 6018.9,-1061.49 6008.9,-1057.99 6008.9,-1064.99"/>
</g>
<!-- scan_ontology -->
<g id="node212" class="node">
<title>scan_ontology</title>
<ellipse fill="none" stroke="black" cx="4743.5" cy="-3703.49" rx="76.09" ry="18"/>
<text text-anchor="middle" x="4743.5" y="-3699.79" font-family="Times,serif" font-size="14.00">scan_ontology</text>
</g>
<!-- scan_ontology&#45;&gt;scan_ontology.main -->
<g id="edge359" class="edge">
<title>scan_ontology:cli&#45;&gt;scan_ontology.main</title>
<path fill="none" stroke="black" d="M4819.79,-3703.49C4881.76,-3703.49 4973.14,-3703.49 5059.5,-3703.49"/>
<polygon fill="black" stroke="black" points="5059.73,-3706.99 5069.73,-3703.49 5059.73,-3699.99 5059.73,-3706.99"/>
</g>
<!-- similar -->
<g id="node213" class="node">
<title>similar</title>
<ellipse fill="none" stroke="black" cx="5299.5" cy="-609.49" rx="42.79" ry="18"/>
<text text-anchor="middle" x="5299.5" y="-605.79" font-family="Times,serif" font-size="14.00">similar</text>
</g>
<!-- similar&#45;&gt;similar.main -->
<g id="edge360" class="edge">
<title>similar:cli&#45;&gt;similar.main</title>
<path fill="none" stroke="black" d="M5342.64,-609.49C5466.3,-609.49 5831.23,-609.49 6018.82,-609.49"/>
<polygon fill="black" stroke="black" points="6018.99,-612.99 6028.99,-609.49 6018.99,-605.99 6018.99,-612.99"/>
</g>
<!-- telegram_bot -->
<g id="node214" class="node">
<title>telegram_bot</title>
<ellipse fill="none" stroke="black" cx="3855" cy="-5627.49" rx="72.29" ry="18"/>
<text text-anchor="middle" x="3855" y="-5623.79" font-family="Times,serif" font-size="14.00">telegram_bot</text>
</g>
<!-- telegram_bot&#45;&gt;telegram_bot.send_alert -->
<g id="edge361" class="edge">
<title>telegram_bot:cli&#45;&gt;telegram_bot.send_alert</title>
<path fill="none" stroke="black" d="M3927.09,-5629.46C4040.51,-5632.87 4269.39,-5640.84 4463,-5654.49 4496.97,-5656.89 4533.21,-5659.99 4567.96,-5663.22"/>
<polygon fill="black" stroke="black" points="4567.92,-5666.74 4578.2,-5664.19 4568.57,-5659.77 4567.92,-5666.74"/>
</g>
<!-- telegram_bot&#45;&gt;telegram_bot.main -->
<g id="edge362" class="edge">
<title>telegram_bot:cli&#45;&gt;telegram_bot.main</title>
<path fill="none" stroke="black" d="M3903.35,-5614.03C4045.58,-5573.6 4470.59,-5452.79 4655.25,-5400.3"/>
<polygon fill="black" stroke="black" points="4656.26,-5403.65 4664.92,-5397.54 4654.35,-5396.91 4656.26,-5403.65"/>
</g>
<!-- tg_client -->
<g id="node215" class="node">
<title>tg_client</title>
<ellipse fill="none" stroke="black" cx="141" cy="-5177.49" rx="50.89" ry="18"/>
<text text-anchor="middle" x="141" y="-5173.79" font-family="Times,serif" font-size="14.00">tg_client</text>
</g>
<!-- tg_client&#45;&gt;tg_client.main -->
<g id="edge363" class="edge">
<title>tg_client:cli&#45;&gt;tg_client.main</title>
<path fill="none" stroke="black" d="M191.99,-5177.49C222.07,-5177.49 263.09,-5177.49 307.59,-5177.49"/>
<polygon fill="black" stroke="black" points="307.75,-5180.99 317.75,-5177.49 307.75,-5173.99 307.75,-5180.99"/>
</g>
</g>
</svg>
