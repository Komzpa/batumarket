<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: callgraph Pages: 1 -->
<svg width="10343pt" height="5896pt"
 viewBox="0.00 0.00 10343.00 5896.31" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 5892.31)">
<title>callgraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-5892.31 10339,-5892.31 10339,4 -4,4"/>
<!-- similar_utils._load_embeddings -->
<g id="node1" class="node">
<title>similar_utils._load_embeddings</title>
<g id="a_node1"><a xlink:title="Return mapping of lot id to embedding vector.">
<polygon fill="none" stroke="black" points="8868,-4875.31 8356,-4875.31 8356,-4833.31 8868,-4833.31 8868,-4875.31"/>
<text text-anchor="middle" x="8612" y="-4846.22" font-family="Times,serif" font-size="31.36">similar_utils._load_embeddings</text>
</a>
</g>
</g>
<!-- notes_utils.load_json -->
<g id="node2" class="node">
<title>notes_utils.load_json</title>
<g id="a_node2"><a xlink:title="Return parsed JSON or ``None`` when invalid.">
<polygon fill="none" stroke="black" points="9558.5,-3928.31 9310.5,-3928.31 9310.5,-3892.31 9558.5,-3892.31 9558.5,-3928.31"/>
<text text-anchor="middle" x="9434.5" y="-3904.61" font-family="Times,serif" font-size="22.12">notes_utils.load_json</text>
</a>
</g>
</g>
<!-- similar_utils._load_embeddings&#45;&gt;notes_utils.load_json -->
<g id="edge1" class="edge">
<title>similar_utils._load_embeddings&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M8689.03,-4875.36C8791.3,-4898.52 8971.56,-4920.3 9069,-4819.31 9137.1,-4748.72 9037.09,-4008.08 9105,-3937.31 9167.57,-3872.11 9277.94,-3877.07 9353.33,-3890.45"/>
<polygon fill="black" stroke="black" points="9352.79,-3893.91 9363.27,-3892.29 9354.07,-3887.02 9352.79,-3893.91"/>
</g>
<!-- notes_utils.read_text -->
<g id="node29" class="node">
<title>notes_utils.read_text</title>
<g id="a_node29"><a xlink:title="Return file contents as UTF&#45;8 or empty string when missing.">
<polygon fill="none" stroke="black" points="10174.5,-4474.31 9960.5,-4474.31 9960.5,-4438.31 10174.5,-4438.31 10174.5,-4474.31"/>
<text text-anchor="middle" x="10067.5" y="-4451.52" font-family="Times,serif" font-size="18.48">notes_utils.read_text</text>
</a>
</g>
</g>
<!-- notes_utils.load_json&#45;&gt;notes_utils.read_text -->
<g id="edge22" class="edge">
<title>notes_utils.load_json&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M9558.78,-3894.28C9624.39,-3891.89 9703.74,-3899.31 9764,-3937.31 9952.6,-4056.22 10037.16,-4338.47 10059.92,-4428.33"/>
<polygon fill="black" stroke="black" points="10056.53,-4429.21 10062.34,-4438.07 10063.33,-4427.52 10056.53,-4429.21"/>
</g>
<!-- similar_utils._cos_sim -->
<g id="node3" class="node">
<title>similar_utils._cos_sim</title>
<g id="a_node3"><a xlink:title="Return cosine similarity between two embeddings.">
<polygon fill="none" stroke="black" points="7690.5,-5019.31 7457.5,-5019.31 7457.5,-4983.31 7690.5,-4983.31 7690.5,-5019.31"/>
<text text-anchor="middle" x="7574" y="-4996.52" font-family="Times,serif" font-size="19.74">similar_utils._cos_sim</text>
</a>
</g>
</g>
<!-- similar_utils._format_vector -->
<g id="node4" class="node">
<title>similar_utils._format_vector</title>
<g id="a_node4"><a xlink:title="Return compact JSON representation for ``vec``.">
<polygon fill="none" stroke="black" points="8740.5,-1022.31 8483.5,-1022.31 8483.5,-986.31 8740.5,-986.31 8740.5,-1022.31"/>
<text text-anchor="middle" x="8612" y="-1000.14" font-family="Times,serif" font-size="17.08">similar_utils._format_vector</text>
</a>
</g>
</g>
<!-- similar_utils._similar_path -->
<g id="node5" class="node">
<title>similar_utils._similar_path</title>
<g id="a_node5"><a xlink:title="Return cache file path for ``lot_path`` under ``SIMILAR_DIR``.">
<polygon fill="none" stroke="black" points="8714,-5225.31 8510,-5225.31 8510,-5189.31 8714,-5189.31 8714,-5225.31"/>
<text text-anchor="middle" x="8612" y="-5203.61" font-family="Times,serif" font-size="14.00">similar_utils._similar_path</text>
</a>
</g>
</g>
<!-- similar_utils._more_user_path -->
<g id="node6" class="node">
<title>similar_utils._more_user_path</title>
<g id="a_node6"><a xlink:title="Return cache file path for ``lot_path`` under ``MORE_USER_DIR``.">
<polygon fill="none" stroke="black" points="8727,-5171.31 8497,-5171.31 8497,-5135.31 8727,-5135.31 8727,-5171.31"/>
<text text-anchor="middle" x="8612" y="-5149.61" font-family="Times,serif" font-size="14.00">similar_utils._more_user_path</text>
</a>
</g>
</g>
<!-- similar_utils._load_similar -->
<g id="node7" class="node">
<title>similar_utils._load_similar</title>
<g id="a_node7"><a xlink:title="Return cached similar lots mapping.">
<polygon fill="none" stroke="black" points="7823,-4467.31 7325,-4467.31 7325,-4419.31 7823,-4419.31 7823,-4467.31"/>
<text text-anchor="middle" x="7574" y="-4434.19" font-family="Times,serif" font-size="36.40">similar_utils._load_similar</text>
</a>
</g>
</g>
<!-- similar_utils._load_similar&#45;&gt;notes_utils.load_json -->
<g id="edge2" class="edge">
<title>similar_utils._load_similar&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M7823.38,-4447.77C8236.59,-4453.99 9024.57,-4460.23 9069,-4418.31 9146.96,-4344.74 9029.48,-4013.38 9105,-3937.31 9167.99,-3873.86 9276.45,-3877.8 9351.41,-3890.51"/>
<polygon fill="black" stroke="black" points="9350.84,-3893.96 9361.3,-3892.27 9352.07,-3887.07 9350.84,-3893.96"/>
</g>
<!-- similar_utils._load_more_user -->
<g id="node8" class="node">
<title>similar_utils._load_more_user</title>
<g id="a_node8"><a xlink:title="Return cached per&#45;user lot mapping.">
<polygon fill="none" stroke="black" points="6729,-3880.81 6211,-3880.81 6211,-3835.81 6729,-3835.81 6729,-3880.81"/>
<text text-anchor="middle" x="6470" y="-3849.93" font-family="Times,serif" font-size="33.60">similar_utils._load_more_user</text>
</a>
</g>
</g>
<!-- similar_utils._load_more_user&#45;&gt;notes_utils.load_json -->
<g id="edge3" class="edge">
<title>similar_utils._load_more_user&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M6729.19,-3858.96C7196.19,-3860.76 8212.33,-3867.57 9069,-3893.31 9145.65,-3895.61 9231.31,-3899.54 9300.32,-3903.04"/>
<polygon fill="black" stroke="black" points="9300.21,-3906.54 9310.37,-3903.55 9300.57,-3899.54 9300.21,-3906.54"/>
</g>
<!-- similar_utils._save_similar -->
<g id="node9" class="node">
<title>similar_utils._save_similar</title>
<g id="a_node9"><a xlink:title="Write ``sim_map`` to ``SIMILAR_DIR`` mirroring ``LOTS_DIR`` layout.">
<polygon fill="none" stroke="black" points="7722,-5225.31 7426,-5225.31 7426,-5189.31 7722,-5189.31 7722,-5225.31"/>
<text text-anchor="middle" x="7574" y="-5202.01" font-family="Times,serif" font-size="21.00">similar_utils._save_similar</text>
</a>
</g>
</g>
<!-- similar_utils._save_similar&#45;&gt;similar_utils._similar_path -->
<g id="edge4" class="edge">
<title>similar_utils._save_similar&#45;&gt;similar_utils._similar_path</title>
<path fill="none" stroke="black" d="M7722.06,-5207.31C7931.66,-5207.31 8311.69,-5207.31 8499.62,-5207.31"/>
<polygon fill="black" stroke="black" points="8499.79,-5210.81 8509.79,-5207.31 8499.79,-5203.81 8499.79,-5210.81"/>
</g>
<!-- notes_utils.write_json -->
<g id="node10" class="node">
<title>notes_utils.write_json</title>
<g id="a_node10"><a xlink:title="Serialise ``data`` to ``path`` with standard options.">
<polygon fill="none" stroke="black" points="8706,-4670.31 8518,-4670.31 8518,-4634.31 8706,-4634.31 8706,-4670.31"/>
<text text-anchor="middle" x="8612" y="-4648.26" font-family="Times,serif" font-size="15.68">notes_utils.write_json</text>
</a>
</g>
</g>
<!-- similar_utils._save_similar&#45;&gt;notes_utils.write_json -->
<g id="edge5" class="edge">
<title>similar_utils._save_similar&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M7722,-5220.62C7863.5,-5229.91 8063.9,-5232.66 8119,-5180.31 8176.65,-5125.54 8106.54,-4887.35 8155,-4824.31 8239.06,-4714.98 8400.93,-4675.14 8507.45,-4660.63"/>
<polygon fill="black" stroke="black" points="8508.12,-4664.07 8517.58,-4659.3 8507.21,-4657.13 8508.12,-4664.07"/>
</g>
<!-- lot_io.lot_json_path -->
<g id="node11" class="node">
<title>lot_io.lot_json_path</title>
<g id="a_node11"><a xlink:title="Return full JSON path for ``lot_id`` given ``root`` directory.">
<polygon fill="none" stroke="black" points="8688.5,-4550.31 8535.5,-4550.31 8535.5,-4514.31 8688.5,-4514.31 8688.5,-4550.31"/>
<text text-anchor="middle" x="8612" y="-4528.61" font-family="Times,serif" font-size="14.00">lot_io.lot_json_path</text>
</a>
</g>
</g>
<!-- similar_utils._save_similar&#45;&gt;lot_io.lot_json_path -->
<g id="edge6" class="edge">
<title>similar_utils._save_similar&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M7722.07,-5221C7863.9,-5230.64 8064.81,-5233.68 8119,-5180.31 8207.05,-5093.58 8073.77,-4718.45 8155,-4625.31 8246.22,-4520.71 8420.34,-4514.61 8525.03,-4521.92"/>
<polygon fill="black" stroke="black" points="8525.02,-4525.43 8535.25,-4522.69 8525.55,-4518.45 8525.02,-4525.43"/>
</g>
<!-- lot_io.parse_lot_id -->
<g id="node48" class="node">
<title>lot_io.parse_lot_id</title>
<g id="a_node48"><a xlink:title="Return ``(relative_path, index)`` extracted from ``lot_id``.">
<polygon fill="none" stroke="black" points="9559.5,-4366.31 9309.5,-4366.31 9309.5,-4330.31 9559.5,-4330.31 9559.5,-4366.31"/>
<text text-anchor="middle" x="9434.5" y="-4342.15" font-family="Times,serif" font-size="25.20">lot_io.parse_lot_id</text>
</a>
</g>
</g>
<!-- lot_io.lot_json_path&#45;&gt;lot_io.parse_lot_id -->
<g id="edge44" class="edge">
<title>lot_io.lot_json_path&#45;&gt;lot_io.parse_lot_id</title>
<path fill="none" stroke="black" d="M8688.76,-4534.43C8780.17,-4535.3 8937.91,-4531.36 9069,-4500.31 9191.34,-4471.33 9325.44,-4405.88 9391.68,-4371.07"/>
<polygon fill="black" stroke="black" points="9393.36,-4374.14 9400.57,-4366.37 9390.09,-4367.95 9393.36,-4374.14"/>
</g>
<!-- similar_utils._save_more_user -->
<g id="node12" class="node">
<title>similar_utils._save_more_user</title>
<g id="a_node12"><a xlink:title="Write ``more_map`` to ``MORE_USER_DIR`` mirroring ``LOTS_DIR`` layout.">
<polygon fill="none" stroke="black" points="7741.5,-5171.31 7406.5,-5171.31 7406.5,-5135.31 7741.5,-5135.31 7741.5,-5171.31"/>
<text text-anchor="middle" x="7574" y="-5148.01" font-family="Times,serif" font-size="21.00">similar_utils._save_more_user</text>
</a>
</g>
</g>
<!-- similar_utils._save_more_user&#45;&gt;similar_utils._more_user_path -->
<g id="edge7" class="edge">
<title>similar_utils._save_more_user&#45;&gt;similar_utils._more_user_path</title>
<path fill="none" stroke="black" d="M7741.74,-5153.31C7949.75,-5153.31 8300.65,-5153.31 8486.62,-5153.31"/>
<polygon fill="black" stroke="black" points="8486.72,-5156.81 8496.72,-5153.31 8486.72,-5149.81 8486.72,-5156.81"/>
</g>
<!-- similar_utils._save_more_user&#45;&gt;notes_utils.write_json -->
<g id="edge8" class="edge">
<title>similar_utils._save_more_user&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M7741.63,-5167.29C7881.25,-5175.06 8066.01,-5174.83 8119,-5125.31 8217.43,-5033.31 8071.91,-4930.37 8155,-4824.31 8240.05,-4715.75 8401.65,-4675.7 8507.84,-4660.93"/>
<polygon fill="black" stroke="black" points="8508.5,-4664.38 8517.94,-4659.58 8507.57,-4657.44 8508.5,-4664.38"/>
</g>
<!-- similar_utils._save_more_user&#45;&gt;lot_io.lot_json_path -->
<g id="edge9" class="edge">
<title>similar_utils._save_more_user&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M7741.52,-5167.85C7881.6,-5176.05 8067.11,-5176.15 8119,-5125.31 8198.57,-5047.35 8081.48,-4709 8155,-4625.31 8246.59,-4521.03 8420.59,-4514.82 8525.15,-4522.02"/>
<polygon fill="black" stroke="black" points="8525.13,-4525.53 8535.36,-4522.78 8525.65,-4518.55 8525.13,-4525.53"/>
</g>
<!-- similar_utils._update_reciprocal -->
<g id="node13" class="node">
<title>similar_utils._update_reciprocal</title>
<g id="a_node13"><a xlink:title="Insert ``lot_id`` into caches of lots listed in ``sims`` if closer.">
<polygon fill="none" stroke="black" points="9675.5,-5515.31 9193.5,-5515.31 9193.5,-5475.31 9675.5,-5475.31 9675.5,-5515.31"/>
<text text-anchor="middle" x="9434.5" y="-5488.24" font-family="Times,serif" font-size="28.84">similar_utils._update_reciprocal</text>
</a>
</g>
</g>
<!-- similar_utils._prune_similar -->
<g id="node14" class="node">
<title>similar_utils._prune_similar</title>
<g id="a_node14"><a xlink:title="Drop cache entries referring to ids not in ``valid_ids``.">
<polygon fill="none" stroke="black" points="7713,-5457.31 7435,-5457.31 7435,-5421.31 7713,-5421.31 7713,-5457.31"/>
<text text-anchor="middle" x="7574" y="-5434.52" font-family="Times,serif" font-size="18.48">similar_utils._prune_similar</text>
</a>
</g>
</g>
<!-- similar_utils._calc_similar_nn -->
<g id="node15" class="node">
<title>similar_utils._calc_similar_nn</title>
<g id="a_node15"><a xlink:title="Fill ``sim_map`` for ``new_ids`` using a nearest neighbour search.&#10;&#10;``vec_ids`` lists all lots that have an embedding. &#160;``new_ids`` is a subset&#10;for which we still need recommendations. &#160;We gather vectors for&#10;``vec_ids`` and use ``NearestNeighbors`` from scikit&#45;learn to find the&#10;closest items. &#160;Embeddings of lots without a vector are skipped.">
<polygon fill="none" stroke="black" points="9069,-5532.81 8155,-5532.81 8155,-5457.81 9069,-5457.81 9069,-5532.81"/>
<text text-anchor="middle" x="8612" y="-5480.31" font-family="Times,serif" font-size="60.62">similar_utils._calc_similar_nn</text>
</a>
</g>
</g>
<!-- similar_utils._calc_similar_nn&#45;&gt;similar_utils._update_reciprocal -->
<g id="edge10" class="edge">
<title>similar_utils._calc_similar_nn&#45;&gt;similar_utils._update_reciprocal</title>
<path fill="none" stroke="black" d="M9069.14,-5495.31C9108.14,-5495.31 9146.58,-5495.31 9183.03,-5495.31"/>
<polygon fill="black" stroke="black" points="9183.26,-5498.81 9193.26,-5495.31 9183.26,-5491.81 9183.26,-5498.81"/>
</g>
<!-- similar_utils._sync_embeddings -->
<g id="node16" class="node">
<title>similar_utils._sync_embeddings</title>
<g id="a_node16"><a xlink:title="Drop lots or vectors that do not match and return cleaned data.">
<polygon fill="none" stroke="black" points="7812.5,-4965.31 7335.5,-4965.31 7335.5,-4925.31 7812.5,-4925.31 7812.5,-4965.31"/>
<text text-anchor="middle" x="7574" y="-4938.24" font-family="Times,serif" font-size="28.84">similar_utils._sync_embeddings</text>
</a>
</g>
</g>
<!-- similar_utils._similar_by_user -->
<g id="node17" class="node">
<title>similar_utils._similar_by_user</title>
<g id="a_node17"><a xlink:title="Return map of lot id to other lots from the same user.">
<polygon fill="none" stroke="black" points="9764,-5456.81 9105,-5456.81 9105,-5401.81 9764,-5401.81 9764,-5456.81"/>
<text text-anchor="middle" x="9434.5" y="-5418.31" font-family="Times,serif" font-size="43.12">similar_utils._similar_by_user</text>
</a>
</g>
</g>
<!-- post_io.get_contact -->
<g id="node18" class="node">
<title>post_io.get_contact</title>
<g id="a_node18"><a xlink:title="Return a contact identifier from ``meta`` or ``None`` when missing.">
<polygon fill="none" stroke="black" points="7673.5,-2354.31 7474.5,-2354.31 7474.5,-2318.31 7673.5,-2318.31 7673.5,-2354.31"/>
<text text-anchor="middle" x="7574" y="-2331.52" font-family="Times,serif" font-size="18.48">post_io.get_contact</text>
</a>
</g>
</g>
<!-- post_io.get_timestamp -->
<g id="node19" class="node">
<title>post_io.get_timestamp</title>
<g id="a_node19"><a xlink:title="Return ``meta[&#39;date&#39;]`` as a timezone&#45;aware ``datetime``.">
<polygon fill="none" stroke="black" points="7745.5,-2300.31 7402.5,-2300.31 7402.5,-2260.31 7745.5,-2260.31 7745.5,-2300.31"/>
<text text-anchor="middle" x="7574" y="-2273.24" font-family="Times,serif" font-size="28.84">post_io.get_timestamp</text>
</a>
</g>
</g>
<!-- post_io.read_post -->
<g id="node20" class="node">
<title>post_io.read_post</title>
<g id="a_node20"><a xlink:title="Return metadata dictionary and body text for ``path``.">
<polygon fill="none" stroke="black" points="8891,-1721.31 8333,-1721.31 8333,-1645.31 8891,-1645.31 8891,-1721.31"/>
<text text-anchor="middle" x="8612" y="-1668.14" font-family="Times,serif" font-size="61.46">post_io.read_post</text>
</a>
</g>
</g>
<!-- notes_utils.read_md -->
<g id="node21" class="node">
<title>notes_utils.read_md</title>
<g id="a_node21"><a xlink:title="Alias for :func:`read_text` used for Markdown files.">
<polygon fill="none" stroke="black" points="9504.5,-1877.31 9364.5,-1877.31 9364.5,-1841.31 9504.5,-1841.31 9504.5,-1877.31"/>
<text text-anchor="middle" x="9434.5" y="-1856.06" font-family="Times,serif" font-size="12.18">notes_utils.read_md</text>
</a>
</g>
</g>
<!-- post_io.read_post&#45;&gt;notes_utils.read_md -->
<g id="edge11" class="edge">
<title>post_io.read_post&#45;&gt;notes_utils.read_md</title>
<path fill="none" stroke="black" d="M8810.81,-1721.34C8891.06,-1737.15 8984.57,-1756.05 9069,-1774.31 9167.57,-1795.63 9280.59,-1822.34 9354.31,-1840.07"/>
<polygon fill="black" stroke="black" points="9353.91,-1843.57 9364.45,-1842.51 9355.55,-1836.77 9353.91,-1843.57"/>
</g>
<!-- notes_utils._parse_block -->
<g id="node22" class="node">
<title>notes_utils._parse_block</title>
<g id="a_node22"><a xlink:title="Return metadata dict and remaining body from ``text``.">
<polygon fill="none" stroke="black" points="9603.5,-1605.81 9265.5,-1605.81 9265.5,-1568.81 9603.5,-1568.81 9603.5,-1605.81"/>
<text text-anchor="middle" x="9434.5" y="-1580.86" font-family="Times,serif" font-size="26.18">notes_utils._parse_block</text>
</a>
</g>
</g>
<!-- post_io.read_post&#45;&gt;notes_utils._parse_block -->
<g id="edge12" class="edge">
<title>post_io.read_post&#45;&gt;notes_utils._parse_block</title>
<path fill="none" stroke="black" d="M8891.07,-1656.03C8949.86,-1649.88 9011.5,-1643.13 9069,-1636.31 9142.88,-1627.54 9225.02,-1616.6 9292.59,-1607.28"/>
<polygon fill="black" stroke="black" points="9293.45,-1610.7 9302.88,-1605.86 9292.49,-1603.76 9293.45,-1610.7"/>
</g>
<!-- notes_utils.read_md&#45;&gt;notes_utils.read_text -->
<g id="edge19" class="edge">
<title>notes_utils.read_md&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M9504.72,-1862.46C9580.87,-1869.93 9700.83,-1894.25 9764,-1972.31 9927.33,-2174.15 10049.41,-4165.26 10064.85,-4427.79"/>
<polygon fill="black" stroke="black" points="10061.37,-4428.24 10065.45,-4438.02 10068.36,-4427.83 10061.37,-4428.24"/>
</g>
<!-- post_io.write_post -->
<g id="node23" class="node">
<title>post_io.write_post</title>
<g id="a_node23"><a xlink:title="Write metadata and body as a Markdown post.">
<polygon fill="none" stroke="black" points="6636,-2303.31 6304,-2303.31 6304,-2257.31 6636,-2257.31 6636,-2303.31"/>
<text text-anchor="middle" x="6470" y="-2271.87" font-family="Times,serif" font-size="34.30">post_io.write_post</text>
</a>
</g>
</g>
<!-- post_io.write_post&#45;&gt;post_io.get_contact -->
<g id="edge13" class="edge">
<title>post_io.write_post&#45;&gt;post_io.get_contact</title>
<path fill="none" stroke="black" d="M6636.11,-2288.99C6747.17,-2294.81 6896.88,-2302.6 7029,-2309.31 7179.88,-2316.97 7354.31,-2325.59 7464.13,-2330.98"/>
<polygon fill="black" stroke="black" points="7464.07,-2334.48 7474.23,-2331.48 7464.41,-2327.49 7464.07,-2334.48"/>
</g>
<!-- post_io.write_post&#45;&gt;post_io.get_timestamp -->
<g id="edge14" class="edge">
<title>post_io.write_post&#45;&gt;post_io.get_timestamp</title>
<path fill="none" stroke="black" d="M6636.28,-2280.31C6839.28,-2280.31 7182.43,-2280.31 7392.25,-2280.31"/>
<polygon fill="black" stroke="black" points="7392.45,-2283.81 7402.45,-2280.31 7392.45,-2276.81 7392.45,-2283.81"/>
</g>
<!-- notes_utils.write_md -->
<g id="node24" class="node">
<title>notes_utils.write_md</title>
<g id="a_node24"><a xlink:title="Write ``text`` to ``path`` ensuring a trailing newline.">
<polygon fill="none" stroke="black" points="7687,-2242.31 7461,-2242.31 7461,-2206.31 7687,-2206.31 7687,-2242.31"/>
<text text-anchor="middle" x="7574" y="-2219.52" font-family="Times,serif" font-size="19.74">notes_utils.write_md</text>
</a>
</g>
</g>
<!-- post_io.write_post&#45;&gt;notes_utils.write_md -->
<g id="edge15" class="edge">
<title>post_io.write_post&#45;&gt;notes_utils.write_md</title>
<path fill="none" stroke="black" d="M6636.11,-2271.63C6747.17,-2265.81 6896.88,-2258.02 7029,-2251.31 7173.93,-2243.95 7340.58,-2235.71 7450.84,-2230.29"/>
<polygon fill="black" stroke="black" points="7451.18,-2233.78 7461,-2229.79 7450.84,-2226.79 7451.18,-2233.78"/>
</g>
<!-- post_io.raw_post_path -->
<g id="node25" class="node">
<title>post_io.raw_post_path</title>
<g id="a_node25"><a xlink:title="Return absolute message path for ``rel`` under ``root``.">
<polygon fill="none" stroke="black" points="8688.5,-3138.31 8535.5,-3138.31 8535.5,-3102.31 8688.5,-3102.31 8688.5,-3138.31"/>
<text text-anchor="middle" x="8612" y="-3117.06" font-family="Times,serif" font-size="12.18">post_io.raw_post_path</text>
</a>
</g>
</g>
<!-- post_io.raw_post_path_from_lot -->
<g id="node26" class="node">
<title>post_io.raw_post_path_from_lot</title>
<g id="a_node26"><a xlink:title="Return raw post path referenced by ``lot`` or ``None``.">
<polygon fill="none" stroke="black" points="7719,-3099.31 7429,-3099.31 7429,-3063.31 7719,-3063.31 7719,-3099.31"/>
<text text-anchor="middle" x="7574" y="-3077.14" font-family="Times,serif" font-size="17.08">post_io.raw_post_path_from_lot</text>
</a>
</g>
</g>
<!-- post_io.raw_post_path_from_lot&#45;&gt;post_io.raw_post_path -->
<g id="edge16" class="edge">
<title>post_io.raw_post_path_from_lot&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7719.05,-3086.73C7938.03,-3094.97 8347.91,-3110.4 8525.42,-3117.09"/>
<polygon fill="black" stroke="black" points="8525.36,-3120.59 8535.49,-3117.47 8525.63,-3113.59 8525.36,-3120.59"/>
</g>
<!-- testing_mode.apply_testing_mode -->
<g id="node27" class="node">
<title>testing_mode.apply_testing_mode</title>
<g id="a_node27"><a xlink:title="Tweak environment variables when ``TEST_MODE`` is set.">
<polygon fill="none" stroke="black" points="282,-5709.31 0,-5709.31 0,-5673.31 282,-5673.31 282,-5709.31"/>
<text text-anchor="middle" x="141" y="-5687.26" font-family="Times,serif" font-size="15.68">testing_mode.apply_testing_mode</text>
</a>
</g>
</g>
<!-- scan_ontology:cli -->
<g id="node28" class="node">
<title>scan_ontology:cli</title>
<g id="a_node28"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="650.5" cy="-5691.31" rx="44.19" ry="18"/>
<text text-anchor="middle" x="650.5" y="-5689.71" font-family="Times,serif" font-size="7.00">scan_ontology:cli</text>
</a>
</g>
</g>
<!-- testing_mode.apply_testing_mode&#45;&gt;scan_ontology:cli -->
<!-- telegram_bot:cli -->
<g id="node182" class="node">
<title>telegram_bot:cli</title>
<g id="a_node182"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="1375.5" cy="-5691.31" rx="111.95" ry="19.18"/>
<text text-anchor="middle" x="1375.5" y="-5687.14" font-family="Times,serif" font-size="17.08">telegram_bot:cli</text>
</a>
</g>
</g>
<!-- scan_ontology:cli&#45;&gt;telegram_bot:cli -->
<!-- notes_utils.read_text&#45;&gt;notes_utils.read_text -->
<g id="edge18" class="edge">
<title>notes_utils.read_text&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M9960.28,-4471.57C9928.38,-4482.03 9964.12,-4492.31 10067.5,-4492.31 10157.15,-4492.31 10195.93,-4484.58 10183.85,-4475.7"/>
<polygon fill="black" stroke="black" points="10185.27,-4472.51 10174.72,-4471.57 10182.38,-4478.88 10185.27,-4472.51"/>
</g>
<!-- notes_utils.parse_md -->
<g id="node30" class="node">
<title>notes_utils.parse_md</title>
<g id="a_node30"><a xlink:title="Return metadata dictionary and body text from ``path``.">
<polygon fill="none" stroke="black" points="8695.5,-1497.31 8528.5,-1497.31 8528.5,-1461.31 8695.5,-1461.31 8695.5,-1497.31"/>
<text text-anchor="middle" x="8612" y="-1475.61" font-family="Times,serif" font-size="14.00">notes_utils.parse_md</text>
</a>
</g>
</g>
<!-- notes_utils.parse_md&#45;&gt;notes_utils.read_md -->
<g id="edge20" class="edge">
<title>notes_utils.parse_md&#45;&gt;notes_utils.read_md</title>
<path fill="none" stroke="black" d="M8695.66,-1474.59C8810.98,-1469.74 9012.4,-1468.07 9069,-1511.31 9107.54,-1540.74 9076.31,-1575.21 9105,-1614.31 9182.05,-1719.29 9316.84,-1799.39 9387.43,-1836.53"/>
<polygon fill="black" stroke="black" points="9386.05,-1839.76 9396.54,-1841.27 9389.28,-1833.55 9386.05,-1839.76"/>
</g>
<!-- notes_utils.parse_md&#45;&gt;notes_utils._parse_block -->
<g id="edge21" class="edge">
<title>notes_utils.parse_md&#45;&gt;notes_utils._parse_block</title>
<path fill="none" stroke="black" d="M8695.73,-1481.75C8787.36,-1485.23 8939.3,-1493.32 9069,-1511.31 9165.93,-1524.75 9275.68,-1548.87 9349.19,-1566.34"/>
<polygon fill="black" stroke="black" points="9348.78,-1569.84 9359.32,-1568.76 9350.41,-1563.03 9348.78,-1569.84"/>
</g>
<!-- caption_io._get_langs -->
<g id="node31" class="node">
<title>caption_io._get_langs</title>
<g id="a_node31"><a xlink:title="Return configured languages, caching the result.">
<polygon fill="none" stroke="black" points="9543.5,-2071.31 9325.5,-2071.31 9325.5,-2035.31 9543.5,-2035.31 9543.5,-2071.31"/>
<text text-anchor="middle" x="9434.5" y="-2048.52" font-family="Times,serif" font-size="18.48">caption_io._get_langs</text>
</a>
</g>
</g>
<!-- config_utils.load_config -->
<g id="node32" class="node">
<title>config_utils.load_config</title>
<g id="a_node32"><a xlink:title="Return the ``config`` module or exit with a helpful message.&#10;&#10;When running the scripts directly from ``src/`` the repository root isn&#39;t on&#10;``sys.path`` and ``config.py`` can&#39;t be imported. &#160;Try adding the parent&#10;directory before failing so the configuration can live alongside&#10;``config.example.py`` in the project root.">
<polygon fill="none" stroke="black" points="10284,-974.81 9851,-974.81 9851,-927.81 10284,-927.81 10284,-974.81"/>
<text text-anchor="middle" x="10067.5" y="-942.81" font-family="Times,serif" font-size="35.00">config_utils.load_config</text>
</a>
</g>
</g>
<!-- caption_io._get_langs&#45;&gt;config_utils.load_config -->
<g id="edge23" class="edge">
<title>caption_io._get_langs&#45;&gt;config_utils.load_config</title>
<path fill="none" stroke="black" d="M9505.47,-2071.33C9580.85,-2086.08 9698.74,-2094.74 9764,-2026.31 9843.95,-1942.47 9721.79,-1069.77 9800,-984.31 9811.9,-971.3 9826.11,-961.41 9841.68,-954.01"/>
<polygon fill="black" stroke="black" points="9843.23,-957.15 9850.99,-949.94 9840.43,-950.74 9843.23,-957.15"/>
</g>
<!-- caption_io.caption_json_path -->
<g id="node33" class="node">
<title>caption_io.caption_json_path</title>
<g id="a_node33"><a xlink:title="Return new&#45;style caption path for ``image``.">
<polygon fill="none" stroke="black" points="9531,-2017.31 9338,-2017.31 9338,-1981.31 9531,-1981.31 9531,-2017.31"/>
<text text-anchor="middle" x="9434.5" y="-1996.06" font-family="Times,serif" font-size="12.18">caption_io.caption_json_path</text>
</a>
</g>
</g>
<!-- caption_io.caption_md_path -->
<g id="node34" class="node">
<title>caption_io.caption_md_path</title>
<g id="a_node34"><a xlink:title="Return legacy Markdown caption path for ``image``.">
<polygon fill="none" stroke="black" points="9528,-1392.31 9341,-1392.31 9341,-1356.31 9528,-1356.31 9528,-1392.31"/>
<text text-anchor="middle" x="9434.5" y="-1371.06" font-family="Times,serif" font-size="12.18">caption_io.caption_md_path</text>
</a>
</g>
</g>
<!-- caption_io.has_caption -->
<g id="node35" class="node">
<title>caption_io.has_caption</title>
<g id="a_node35"><a xlink:title="Return ``True`` when any caption exists for ``image``.">
<polygon fill="none" stroke="black" points="8689.5,-1890.31 8534.5,-1890.31 8534.5,-1854.31 8689.5,-1854.31 8689.5,-1890.31"/>
<text text-anchor="middle" x="8612" y="-1869.06" font-family="Times,serif" font-size="12.18">caption_io.has_caption</text>
</a>
</g>
</g>
<!-- caption_io.has_caption&#45;&gt;caption_io.caption_json_path -->
<g id="edge24" class="edge">
<title>caption_io.has_caption&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M8689.77,-1872.54C8780.82,-1873.89 8936.91,-1879.57 9069,-1901.31 9176.45,-1918.99 9298,-1955.01 9370.06,-1978.11"/>
<polygon fill="black" stroke="black" points="9369.3,-1981.55 9379.89,-1981.28 9371.45,-1974.88 9369.3,-1981.55"/>
</g>
<!-- caption_io.has_caption&#45;&gt;caption_io.caption_md_path -->
<g id="edge25" class="edge">
<title>caption_io.has_caption&#45;&gt;caption_io.caption_md_path</title>
<path fill="none" stroke="black" d="M8689.66,-1876.21C8805.66,-1880.32 9017.71,-1880.22 9069,-1828.31 9135.93,-1760.57 9037.59,-1468.57 9105,-1401.31 9168.09,-1338.35 9276.01,-1342.01 9350.86,-1354.53"/>
<polygon fill="black" stroke="black" points="9350.28,-1357.98 9360.73,-1356.26 9351.49,-1351.08 9350.28,-1357.98"/>
</g>
<!-- caption_io.read_caption -->
<g id="node36" class="node">
<title>caption_io.read_caption</title>
<g id="a_node36"><a xlink:title="Return caption for ``image`` in ``lang`` or empty string when missing.">
<polygon fill="none" stroke="black" points="8777.5,-1947.81 8446.5,-1947.81 8446.5,-1910.81 8777.5,-1910.81 8777.5,-1947.81"/>
<text text-anchor="middle" x="8612" y="-1922.86" font-family="Times,serif" font-size="26.18">caption_io.read_caption</text>
</a>
</g>
</g>
<!-- caption_io.read_caption&#45;&gt;notes_utils.load_json -->
<g id="edge27" class="edge">
<title>caption_io.read_caption&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M8777.62,-1917.18C8891.46,-1912.78 9029.3,-1916.74 9069,-1957.31 9104.19,-1993.27 9096.4,-2812.73 9105,-2862.31 9177.51,-3280.34 9372.15,-3763.44 9421.83,-3882.66"/>
<polygon fill="black" stroke="black" points="9418.71,-3884.28 9425.8,-3892.15 9425.17,-3881.58 9418.71,-3884.28"/>
</g>
<!-- caption_io.read_caption&#45;&gt;notes_utils.read_md -->
<g id="edge26" class="edge">
<title>caption_io.read_caption&#45;&gt;notes_utils.read_md</title>
<path fill="none" stroke="black" d="M8777.76,-1920.21C8864.5,-1914.98 8972.58,-1907.77 9069,-1899.31 9167.42,-1890.67 9280.48,-1877.81 9354.25,-1869.01"/>
<polygon fill="black" stroke="black" points="9354.88,-1872.46 9364.39,-1867.8 9354.04,-1865.51 9354.88,-1872.46"/>
</g>
<!-- caption_io.read_caption&#45;&gt;caption_io._get_langs -->
<g id="edge28" class="edge">
<title>caption_io.read_caption&#45;&gt;caption_io._get_langs</title>
<path fill="none" stroke="black" d="M8701.06,-1910.75C8799.13,-1895.17 8958.39,-1885.53 9069,-1957.31 9098.02,-1976.14 9076.18,-2007.18 9105,-2026.31 9166.11,-2066.87 9248.37,-2073.58 9315.29,-2070.17"/>
<polygon fill="black" stroke="black" points="9315.69,-2073.66 9325.47,-2069.57 9315.28,-2066.67 9315.69,-2073.66"/>
</g>
<!-- caption_io.read_caption&#45;&gt;caption_io.caption_json_path -->
<g id="edge29" class="edge">
<title>caption_io.read_caption&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M8777.52,-1937.29C8864.31,-1942.03 8972.51,-1948.79 9069,-1957.31 9156.27,-1965.01 9254.97,-1976.56 9327.64,-1985.6"/>
<polygon fill="black" stroke="black" points="9327.36,-1989.09 9337.71,-1986.86 9328.22,-1982.14 9327.36,-1989.09"/>
</g>
<!-- caption_io.read_caption&#45;&gt;caption_io.caption_md_path -->
<g id="edge30" class="edge">
<title>caption_io.read_caption&#45;&gt;caption_io.caption_md_path</title>
<path fill="none" stroke="black" d="M8777.58,-1940.3C8891.19,-1943.97 9028.76,-1939.29 9069,-1899.31 9147.71,-1821.11 9026.93,-1480.15 9105,-1401.31 9168,-1337.68 9276.71,-1341.75 9351.72,-1354.53"/>
<polygon fill="black" stroke="black" points="9351.15,-1357.98 9361.61,-1356.3 9352.38,-1351.09 9351.15,-1357.98"/>
</g>
<!-- caption_io.write_caption -->
<g id="node37" class="node">
<title>caption_io.write_caption</title>
<g id="a_node37"><a xlink:title="Write ``text`` as ``lang`` caption for ``image``.">
<polygon fill="none" stroke="black" points="7740.5,-4287.31 7407.5,-4287.31 7407.5,-4251.31 7740.5,-4251.31 7740.5,-4287.31"/>
<text text-anchor="middle" x="7574" y="-4263.15" font-family="Times,serif" font-size="25.20">caption_io.write_caption</text>
</a>
</g>
</g>
<!-- caption_io.write_caption&#45;&gt;notes_utils.load_json -->
<g id="edge31" class="edge">
<title>caption_io.write_caption&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M7740.6,-4277.24C8109.2,-4293.23 8972.6,-4320.79 9069,-4233.31 9167.14,-4144.25 9009.48,-4029.17 9105,-3937.31 9168.32,-3876.41 9273.84,-3878.84 9348.17,-3890.55"/>
<polygon fill="black" stroke="black" points="9348.01,-3894.07 9358.45,-3892.26 9349.16,-3887.17 9348.01,-3894.07"/>
</g>
<!-- caption_io.write_caption&#45;&gt;notes_utils.write_json -->
<g id="edge32" class="edge">
<title>caption_io.write_caption&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M7740.73,-4255.26C7880.28,-4247.32 8065.47,-4247.22 8119,-4296.31 8205.95,-4376.05 8074.34,-4473.21 8155,-4559.31 8244.41,-4654.74 8403.05,-4666.68 8507.63,-4662.55"/>
<polygon fill="black" stroke="black" points="8508.06,-4666.03 8517.9,-4662.08 8507.75,-4659.04 8508.06,-4666.03"/>
</g>
<!-- caption_io.write_caption&#45;&gt;caption_io._get_langs -->
<g id="edge33" class="edge">
<title>caption_io.write_caption&#45;&gt;caption_io._get_langs</title>
<path fill="none" stroke="black" d="M7740.68,-4269.46C7848.88,-4267.5 7992.96,-4261.01 8119,-4242.31 8135.31,-4239.89 8138.78,-4236.31 8155,-4233.31 8356.19,-4196.09 8931.33,-4273.67 9069,-4122.31 9120.49,-4065.7 9087.21,-2819.74 9105,-2745.31 9171.37,-2467.7 9357.36,-2169.17 9415.74,-2079.93"/>
<polygon fill="black" stroke="black" points="9418.72,-2081.77 9421.29,-2071.49 9412.87,-2077.92 9418.72,-2081.77"/>
</g>
<!-- caption_io.write_caption&#45;&gt;caption_io.caption_json_path -->
<g id="edge34" class="edge">
<title>caption_io.write_caption&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M7740.67,-4281.38C7878.86,-4287.85 8062.05,-4286.92 8119,-4242.31 8162.84,-4207.97 8111.9,-4157.56 8155,-4122.31 8312.89,-3993.19 8930.19,-4187.75 9069,-4038.31 9145.08,-3956.4 9028.52,-2107.85 9105,-2026.31 9167.19,-1960 9278.7,-1965.59 9354.37,-1979.38"/>
<polygon fill="black" stroke="black" points="9353.86,-1982.85 9364.34,-1981.28 9355.17,-1975.97 9353.86,-1982.85"/>
</g>
<!-- message_utils.build_prompt -->
<g id="node38" class="node">
<title>message_utils.build_prompt</title>
<g id="a_node38"><a xlink:title="Return prompt combining message text with captioned file names.">
<polygon fill="none" stroke="black" points="8761.5,-1819.31 8462.5,-1819.31 8462.5,-1783.31 8761.5,-1783.31 8761.5,-1819.31"/>
<text text-anchor="middle" x="8612" y="-1796.52" font-family="Times,serif" font-size="19.74">message_utils.build_prompt</text>
</a>
</g>
</g>
<!-- message_utils.gather_chop_input -->
<g id="node39" class="node">
<title>message_utils.gather_chop_input</title>
<g id="a_node39"><a xlink:title="Return the exact text fed to the lot parser for ``msg_path``.">
<polygon fill="none" stroke="black" points="7786.5,-1804.31 7361.5,-1804.31 7361.5,-1768.31 7786.5,-1768.31 7786.5,-1804.31"/>
<text text-anchor="middle" x="7574" y="-1780.43" font-family="Times,serif" font-size="24.22">message_utils.gather_chop_input</text>
</a>
</g>
</g>
<!-- message_utils.gather_chop_input&#45;&gt;post_io.read_post -->
<g id="edge35" class="edge">
<title>message_utils.gather_chop_input&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7786.52,-1778.03C7887.36,-1773.02 8009.58,-1765.4 8119,-1754.31 8199.69,-1746.13 8287.45,-1734.38 8366.2,-1722.8"/>
<polygon fill="black" stroke="black" points="8366.87,-1726.24 8376.26,-1721.31 8365.85,-1719.31 8366.87,-1726.24"/>
</g>
<!-- message_utils.gather_chop_input&#45;&gt;caption_io.read_caption -->
<g id="edge36" class="edge">
<title>message_utils.gather_chop_input&#45;&gt;caption_io.read_caption</title>
<path fill="none" stroke="black" d="M7651.43,-1804.41C7761.89,-1829.85 7972.9,-1875.68 8155,-1899.31 8247.52,-1911.32 8351.26,-1918.62 8436.39,-1923.01"/>
<polygon fill="black" stroke="black" points="8436.25,-1926.51 8446.41,-1923.52 8436.6,-1919.52 8436.25,-1926.51"/>
</g>
<!-- message_utils.gather_chop_input&#45;&gt;message_utils.build_prompt -->
<g id="edge37" class="edge">
<title>message_utils.gather_chop_input&#45;&gt;message_utils.build_prompt</title>
<path fill="none" stroke="black" d="M7786.52,-1789.37C7983.76,-1792.23 8273.57,-1796.42 8451.86,-1799"/>
<polygon fill="black" stroke="black" points="8452.06,-1802.51 8462.11,-1799.15 8452.16,-1795.51 8452.06,-1802.51"/>
</g>
<!-- lot_io._clean_lot -->
<g id="node40" class="node">
<title>lot_io._clean_lot</title>
<g id="a_node40"><a xlink:title="Return ``lot`` without empty or null fields.">
<polygon fill="none" stroke="black" points="9492,-2790.31 9377,-2790.31 9377,-2754.31 9492,-2754.31 9492,-2790.31"/>
<text text-anchor="middle" x="9434.5" y="-2769.06" font-family="Times,serif" font-size="12.18">lot_io._clean_lot</text>
</a>
</g>
</g>
<!-- lot_io.valid_lots -->
<g id="node41" class="node">
<title>lot_io.valid_lots</title>
<g id="a_node41"><a xlink:title="Return ``True`` when every lot contains the required translations.">
<polygon fill="none" stroke="black" points="7676,-2086.31 7472,-2086.31 7472,-2050.31 7676,-2050.31 7676,-2086.31"/>
<text text-anchor="middle" x="7574" y="-2062.43" font-family="Times,serif" font-size="24.22">lot_io.valid_lots</text>
</a>
</g>
</g>
<!-- lot_io.needs_cleanup -->
<g id="node42" class="node">
<title>lot_io.needs_cleanup</title>
<g id="a_node42"><a xlink:title="Return ``True`` when ``clean_data`` would drop ``lots``.">
<polygon fill="none" stroke="black" points="8701.5,-2463.31 8522.5,-2463.31 8522.5,-2427.31 8701.5,-2427.31 8701.5,-2463.31"/>
<text text-anchor="middle" x="8612" y="-2441.26" font-family="Times,serif" font-size="15.68">lot_io.needs_cleanup</text>
</a>
</g>
</g>
<!-- lot_io.get_seller -->
<g id="node43" class="node">
<title>lot_io.get_seller</title>
<g id="a_node43"><a xlink:title="Return the seller identifier or ``None`` when missing.">
<polygon fill="none" stroke="black" points="8712.5,-733.31 8511.5,-733.31 8511.5,-697.31 8712.5,-697.31 8712.5,-733.31"/>
<text text-anchor="middle" x="8612" y="-709.72" font-family="Times,serif" font-size="23.24">lot_io.get_seller</text>
</a>
</g>
</g>
<!-- lot_io.get_timestamp -->
<g id="node44" class="node">
<title>lot_io.get_timestamp</title>
<g id="a_node44"><a xlink:title="Return ``lot[&#39;timestamp&#39;]`` as a timezone&#45;aware ``datetime``.">
<polygon fill="none" stroke="black" points="8771,-2622.31 8453,-2622.31 8453,-2582.31 8771,-2582.31 8771,-2622.31"/>
<text text-anchor="middle" x="8612" y="-2595.24" font-family="Times,serif" font-size="28.84">lot_io.get_timestamp</text>
</a>
</g>
</g>
<!-- lot_io.read_lots -->
<g id="node45" class="node">
<title>lot_io.read_lots</title>
<g id="a_node45"><a xlink:title="Return a list of lots from ``path`` or ``None`` when invalid.">
<polygon fill="none" stroke="black" points="8718,-3192.31 8506,-3192.31 8506,-3156.31 8718,-3156.31 8718,-3192.31"/>
<text text-anchor="middle" x="8612" y="-3168.15" font-family="Times,serif" font-size="25.20">lot_io.read_lots</text>
</a>
</g>
</g>
<!-- lot_io.read_lots&#45;&gt;notes_utils.load_json -->
<g id="edge38" class="edge">
<title>lot_io.read_lots&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M8633.28,-3192.5C8744.23,-3292.02 9277.35,-3770.24 9405.67,-3885.35"/>
<polygon fill="black" stroke="black" points="9403.41,-3888.02 9413.19,-3892.09 9408.09,-3882.81 9403.41,-3888.02"/>
</g>
<!-- lot_io.read_lots&#45;&gt;lot_io._clean_lot -->
<g id="edge39" class="edge">
<title>lot_io.read_lots&#45;&gt;lot_io._clean_lot</title>
<path fill="none" stroke="black" d="M8673.49,-3192.4C8770.96,-3217.43 8962.58,-3248.88 9069,-3147.31 9123.8,-3095 9051.52,-2861.97 9105,-2808.31 9172.69,-2740.39 9292.02,-2745.81 9366.7,-2757.76"/>
<polygon fill="black" stroke="black" points="9366.49,-2761.27 9376.94,-2759.48 9367.66,-2754.37 9366.49,-2761.27"/>
</g>
<!-- lot_io.write_lots -->
<g id="node46" class="node">
<title>lot_io.write_lots</title>
<g id="a_node46"><a xlink:title="Write lots to ``path`` using consistent JSON formatting.">
<polygon fill="none" stroke="black" points="7675.5,-2618.31 7472.5,-2618.31 7472.5,-2582.31 7675.5,-2582.31 7675.5,-2618.31"/>
<text text-anchor="middle" x="7574" y="-2594.72" font-family="Times,serif" font-size="23.24">lot_io.write_lots</text>
</a>
</g>
</g>
<!-- lot_io.write_lots&#45;&gt;notes_utils.write_json -->
<g id="edge40" class="edge">
<title>lot_io.write_lots&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M7675.77,-2597.3C7816.64,-2595.5 8061.65,-2601.92 8119,-2665.31 8189.61,-2743.35 8087.66,-4478.43 8155,-4559.31 8239.26,-4660.51 8401.08,-4670.55 8507.53,-4664.48"/>
<polygon fill="black" stroke="black" points="8507.9,-4667.96 8517.66,-4663.84 8507.46,-4660.97 8507.9,-4667.96"/>
</g>
<!-- lot_io.write_lots&#45;&gt;lot_io._clean_lot -->
<g id="edge41" class="edge">
<title>lot_io.write_lots&#45;&gt;lot_io._clean_lot</title>
<path fill="none" stroke="black" d="M7675.57,-2593.36C7813.38,-2585.95 8051.56,-2581.4 8119,-2632.31 8157.7,-2661.53 8115.87,-2706.67 8155,-2735.31 8204.21,-2771.32 9110.63,-2772.77 9366.66,-2772.46"/>
<polygon fill="black" stroke="black" points="9366.93,-2775.96 9376.92,-2772.45 9366.92,-2768.96 9366.93,-2775.96"/>
</g>
<!-- lot_io.write_lots&#45;&gt;lot_io.get_seller -->
<g id="edge42" class="edge">
<title>lot_io.write_lots&#45;&gt;lot_io.get_seller</title>
<path fill="none" stroke="black" d="M7675.57,-2607.14C7801.62,-2609.52 8013.86,-2591.82 8119,-2459.31 8170.19,-2394.79 8112.88,-1048.08 8155,-977.31 8236.61,-840.16 8419.36,-768.16 8527.09,-736.27"/>
<polygon fill="black" stroke="black" points="8528.33,-739.56 8536.96,-733.4 8526.38,-732.84 8528.33,-739.56"/>
</g>
<!-- lot_io.write_lots&#45;&gt;lot_io.get_timestamp -->
<g id="edge43" class="edge">
<title>lot_io.write_lots&#45;&gt;lot_io.get_timestamp</title>
<path fill="none" stroke="black" d="M7675.75,-2600.5C7853.69,-2600.85 8225.3,-2601.56 8442.71,-2601.98"/>
<polygon fill="black" stroke="black" points="8442.94,-2605.48 8452.94,-2602 8442.95,-2598.48 8442.94,-2605.48"/>
</g>
<!-- lot_io.make_lot_id -->
<g id="node47" class="node">
<title>lot_io.make_lot_id</title>
<g id="a_node47"><a xlink:title="Return lot id string for ``rel`` and ``index``.&#10;&#10;``rel`` is the JSON file path relative to the ``data/lots`` directory&#10;without the ``.json`` suffix.">
<polygon fill="none" stroke="black" points="8704.5,-3712.31 8519.5,-3712.31 8519.5,-3676.31 8704.5,-3676.31 8704.5,-3712.31"/>
<text text-anchor="middle" x="8612" y="-3689.52" font-family="Times,serif" font-size="18.48">lot_io.make_lot_id</text>
</a>
</g>
</g>
<!-- lot_io.embedding_path -->
<g id="node49" class="node">
<title>lot_io.embedding_path</title>
<g id="a_node49"><a xlink:title="Return embedding file path for ``lot_path``.">
<polygon fill="none" stroke="black" points="8718.5,-2526.31 8505.5,-2526.31 8505.5,-2490.31 8718.5,-2490.31 8718.5,-2526.31"/>
<text text-anchor="middle" x="8612" y="-2504.14" font-family="Times,serif" font-size="17.08">lot_io.embedding_path</text>
</a>
</g>
</g>
<!-- lot_io.iter_lot_files -->
<g id="node50" class="node">
<title>lot_io.iter_lot_files</title>
<g id="a_node50"><a xlink:title="Return ``*.json`` files under ``root``.&#10;&#10;When ``newest_first`` is ``True`` the result is ordered by modification&#10;time with the most recently changed files first. &#160;Both ``build_site.py`` and&#10;``pending_embed.py`` rely on this helper so they scan the lot directory in&#10;the same order.">
<polygon fill="none" stroke="black" points="8740.5,-4029.81 8483.5,-4029.81 8483.5,-3992.81 8740.5,-3992.81 8740.5,-4029.81"/>
<text text-anchor="middle" x="8612" y="-4004.86" font-family="Times,serif" font-size="26.18">lot_io.iter_lot_files</text>
</a>
</g>
</g>
<!-- lot_io.get_lot -->
<g id="node51" class="node">
<title>lot_io.get_lot</title>
<g id="a_node51"><a xlink:title="Return the lot identified by ``lot_id`` or ``None`` when missing.">
<polygon fill="none" stroke="black" points="7646.5,-4177.31 7501.5,-4177.31 7501.5,-4141.31 7646.5,-4141.31 7646.5,-4177.31"/>
<text text-anchor="middle" x="7574" y="-4154.52" font-family="Times,serif" font-size="19.74">lot_io.get_lot</text>
</a>
</g>
</g>
<!-- lot_io.get_lot&#45;&gt;lot_io.read_lots -->
<g id="edge45" class="edge">
<title>lot_io.get_lot&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M7646.52,-4166.7C7778.7,-4178.63 8053.76,-4194.87 8119,-4131.31 8193.07,-4059.14 8113.59,-3762.08 8155,-3667.31 8251.09,-3447.38 8487.51,-3262.36 8576.43,-3198.33"/>
<polygon fill="black" stroke="black" points="8578.47,-3201.17 8584.57,-3192.51 8574.4,-3195.48 8578.47,-3201.17"/>
</g>
<!-- lot_io.get_lot&#45;&gt;lot_io.parse_lot_id -->
<g id="edge46" class="edge">
<title>lot_io.get_lot&#45;&gt;lot_io.parse_lot_id</title>
<path fill="none" stroke="black" d="M7646.83,-4161.2C7751.03,-4164.33 7950.13,-4171.73 8119,-4186.31 8553.18,-4223.79 9064.96,-4294.56 9301.47,-4328.79"/>
<polygon fill="black" stroke="black" points="9301.09,-4332.28 9311.49,-4330.25 9302.09,-4325.35 9301.09,-4332.28"/>
</g>
<!-- image_io.read_image_meta -->
<g id="node52" class="node">
<title>image_io.read_image_meta</title>
<g id="a_node52"><a xlink:title="Return metadata from ``path.with_suffix(&#39;.md&#39;)``.">
<polygon fill="none" stroke="black" points="7688.5,-1054.31 7459.5,-1054.31 7459.5,-1018.31 7688.5,-1018.31 7688.5,-1054.31"/>
<text text-anchor="middle" x="7574" y="-1032.26" font-family="Times,serif" font-size="15.68">image_io.read_image_meta</text>
</a>
</g>
</g>
<!-- image_io.read_image_meta&#45;&gt;notes_utils.parse_md -->
<g id="edge47" class="edge">
<title>image_io.read_image_meta&#45;&gt;notes_utils.parse_md</title>
<path fill="none" stroke="black" d="M7688.59,-1044C7801.46,-1054.79 7977.66,-1080.23 8119,-1139.31 8315.47,-1221.43 8512.93,-1390.2 8583.68,-1454.07"/>
<polygon fill="black" stroke="black" points="8581.53,-1456.84 8591.29,-1460.97 8586.24,-1451.66 8581.53,-1456.84"/>
</g>
<!-- image_io.write_image_meta -->
<g id="node53" class="node">
<title>image_io.write_image_meta</title>
<g id="a_node53"><a xlink:title="Write ``meta`` to ``path.with_suffix(&#39;.md&#39;)``.">
<polygon fill="none" stroke="black" points="6587.5,-2238.31 6352.5,-2238.31 6352.5,-2202.31 6587.5,-2202.31 6587.5,-2238.31"/>
<text text-anchor="middle" x="6470" y="-2216.26" font-family="Times,serif" font-size="15.68">image_io.write_image_meta</text>
</a>
</g>
</g>
<!-- image_io.write_image_meta&#45;&gt;notes_utils.write_md -->
<g id="edge48" class="edge">
<title>image_io.write_image_meta&#45;&gt;notes_utils.write_md</title>
<path fill="none" stroke="black" d="M6587.63,-2220.73C6797.57,-2221.49 7237.1,-2223.09 7450.94,-2223.87"/>
<polygon fill="black" stroke="black" points="7450.93,-2227.37 7460.95,-2223.9 7450.96,-2220.37 7450.93,-2227.37"/>
</g>
<!-- scan_ontology.collect_ontology -->
<g id="node54" class="node">
<title>scan_ontology.collect_ontology</title>
<g id="a_node54"><a xlink:title="Return counts per field, value counters, misparsed lots and broken metadata.">
<polygon fill="none" stroke="black" points="6928,-1821.81 6012,-1821.81 6012,-1750.81 6928,-1750.81 6928,-1821.81"/>
<text text-anchor="middle" x="6470" y="-1771.66" font-family="Times,serif" font-size="57.68">scan_ontology.collect_ontology</text>
</a>
</g>
</g>
<!-- scan_ontology.collect_ontology&#45;&gt;post_io.read_post -->
<g id="edge49" class="edge">
<title>scan_ontology.collect_ontology&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M6630.89,-1750.75C6741.94,-1727.9 6893.68,-1700.32 7029,-1688.31 7479.45,-1648.34 8004.88,-1657.71 8322.51,-1669.49"/>
<polygon fill="black" stroke="black" points="8322.66,-1673 8332.78,-1669.88 8322.92,-1666.01 8322.66,-1673"/>
</g>
<!-- scan_ontology.collect_ontology&#45;&gt;post_io.raw_post_path -->
<g id="edge50" class="edge">
<title>scan_ontology.collect_ontology&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M6905.35,-1821.89C6938.4,-1838.79 6968.4,-1860.82 6993,-1889.31 7046.66,-1951.44 6970.55,-2569.66 7029,-2627.31 7115.28,-2712.4 8027.6,-2585.74 8119,-2665.31 8189.1,-2726.34 8100.85,-2795.77 8155,-2871.31 8246.52,-2998.96 8424.52,-3068.16 8529,-3099.37"/>
<polygon fill="black" stroke="black" points="8528.3,-3102.81 8538.88,-3102.27 8530.27,-3096.09 8528.3,-3102.81"/>
</g>
<!-- scan_ontology.collect_ontology&#45;&gt;message_utils.gather_chop_input -->
<g id="edge51" class="edge">
<title>scan_ontology.collect_ontology&#45;&gt;message_utils.gather_chop_input</title>
<path fill="none" stroke="black" d="M6928.38,-1786.31C7074.52,-1786.31 7229.72,-1786.31 7351.2,-1786.31"/>
<polygon fill="black" stroke="black" points="7351.37,-1789.81 7361.37,-1786.31 7351.37,-1782.81 7351.37,-1789.81"/>
</g>
<!-- scan_ontology.collect_ontology&#45;&gt;lot_io.read_lots -->
<g id="edge52" class="edge">
<title>scan_ontology.collect_ontology&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M6906.77,-1821.92C6939.35,-1838.85 6968.86,-1860.88 6993,-1889.31 7074.09,-1984.81 6940.54,-2927.59 7029,-3016.31 7114.57,-3102.12 8020.24,-2984.08 8119,-3054.31 8155.12,-3079.99 8119.19,-3121.19 8155,-3147.31 8263.7,-3226.62 8428.63,-3212.66 8527.49,-3194.22"/>
<polygon fill="black" stroke="black" points="8528.28,-3197.64 8537.44,-3192.31 8526.96,-3190.76 8528.28,-3197.64"/>
</g>
<!-- moderation.is_misparsed -->
<g id="node55" class="node">
<title>moderation.is_misparsed</title>
<g id="a_node55"><a xlink:title="Return ``True`` for obviously invalid lots or source posts.">
<polygon fill="none" stroke="black" points="7792,-750.31 7356,-750.31 7356,-706.31 7792,-706.31 7792,-750.31"/>
<text text-anchor="middle" x="7574" y="-719.99" font-family="Times,serif" font-size="32.90">moderation.is_misparsed</text>
</a>
</g>
</g>
<!-- scan_ontology.collect_ontology&#45;&gt;moderation.is_misparsed -->
<g id="edge53" class="edge">
<title>scan_ontology.collect_ontology&#45;&gt;moderation.is_misparsed</title>
<path fill="none" stroke="black" d="M6692.93,-1750.78C6801.69,-1721.23 6923.83,-1667.34 6993,-1569.31 7081.64,-1443.67 6932.69,-998.17 7029,-878.31 7104.35,-784.53 7232.58,-746.21 7345.62,-731.71"/>
<polygon fill="black" stroke="black" points="7346.31,-735.15 7355.81,-730.46 7345.46,-728.21 7346.31,-735.15"/>
</g>
<!-- moderation.is_misparsed&#45;&gt;lot_io.get_seller -->
<g id="edge260" class="edge">
<title>moderation.is_misparsed&#45;&gt;lot_io.get_seller</title>
<path fill="none" stroke="black" d="M7792.18,-725.58C8008.92,-722.86 8333.18,-718.79 8501.22,-716.69"/>
<polygon fill="black" stroke="black" points="8501.37,-720.18 8511.32,-716.56 8501.28,-713.18 8501.37,-720.18"/>
</g>
<!-- scan_ontology.main -->
<g id="node56" class="node">
<title>scan_ontology.main</title>
<polygon fill="none" stroke="black" points="5821,-1814.81 5366,-1814.81 5366,-1757.81 5821,-1757.81 5821,-1814.81"/>
<text text-anchor="middle" x="5593.5" y="-1775.42" font-family="Times,serif" font-size="44.24">scan_ontology.main</text>
</g>
<!-- scan_ontology.main&#45;&gt;notes_utils.write_json -->
<g id="edge54" class="edge">
<title>scan_ontology.main&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M5748.92,-1814.85C5809.9,-1834.43 5874.11,-1867.3 5911,-1922.31 5978.01,-2022.21 5875.07,-3990.89 5947,-4087.31 6238.47,-4478.05 6662.65,-4058.84 6993,-4417.31 7041.81,-4470.27 6973.41,-4529.52 7029,-4575.31 7075.77,-4613.83 8058.52,-4605.73 8119,-4609.31 8253.47,-4617.28 8408.19,-4631.66 8507.66,-4641.58"/>
<polygon fill="black" stroke="black" points="8507.41,-4645.07 8517.71,-4642.59 8508.11,-4638.11 8507.41,-4645.07"/>
</g>
<!-- scan_ontology.main&#45;&gt;scan_ontology.collect_ontology -->
<g id="edge55" class="edge">
<title>scan_ontology.main&#45;&gt;scan_ontology.collect_ontology</title>
<path fill="none" stroke="black" d="M5821.13,-1786.31C5876.97,-1786.31 5938.84,-1786.31 6001.54,-1786.31"/>
<polygon fill="black" stroke="black" points="6001.6,-1789.81 6011.6,-1786.31 6001.6,-1782.81 6001.6,-1789.81"/>
</g>
<!-- log_utils.install_excepthook -->
<g id="node57" class="node">
<title>log_utils.install_excepthook</title>
<g id="a_node57"><a xlink:title="Redirect uncaught exceptions to ``logger.exception``.">
<polygon fill="none" stroke="black" points="6656.5,-288.31 6283.5,-288.31 6283.5,-252.31 6656.5,-252.31 6656.5,-288.31"/>
<text text-anchor="middle" x="6470" y="-264.15" font-family="Times,serif" font-size="25.20">log_utils.install_excepthook</text>
</a>
</g>
</g>
<!-- scan_ontology.main&#45;&gt;log_utils.install_excepthook -->
<g id="edge56" class="edge">
<title>scan_ontology.main&#45;&gt;log_utils.install_excepthook</title>
<path fill="none" stroke="black" d="M5681.25,-1757.67C5756.68,-1727.69 5861.42,-1672.62 5911,-1585.31 5946.35,-1523.06 5896.99,-348.52 5947,-297.31 6066.55,-174.89 6293.18,-218.16 6404.3,-249.45"/>
<polygon fill="black" stroke="black" points="6403.46,-252.85 6414.03,-252.25 6405.39,-246.13 6403.46,-252.85"/>
</g>
<!-- log_utils._extract_tb_lineno -->
<g id="node74" class="node">
<title>log_utils._extract_tb_lineno</title>
<g id="a_node74"><a xlink:title="Return the last line number from a traceback.">
<polygon fill="none" stroke="black" points="7689.5,-181.31 7458.5,-181.31 7458.5,-145.31 7689.5,-145.31 7689.5,-181.31"/>
<text text-anchor="middle" x="7574" y="-159.26" font-family="Times,serif" font-size="15.68">log_utils._extract_tb_lineno</text>
</a>
</g>
</g>
<!-- log_utils.install_excepthook&#45;&gt;log_utils._extract_tb_lineno -->
<g id="edge85" class="edge">
<title>log_utils.install_excepthook&#45;&gt;log_utils._extract_tb_lineno</title>
<path fill="none" stroke="black" d="M6586.13,-252.27C6698.75,-235.23 6875.27,-210.14 7029,-195.31 7172.49,-181.46 7337.88,-172.76 7448.28,-167.99"/>
<polygon fill="black" stroke="black" points="7448.61,-171.48 7458.45,-167.55 7448.31,-164.48 7448.61,-171.48"/>
</g>
<!-- token_utils.estimate_tokens -->
<g id="node58" class="node">
<title>token_utils.estimate_tokens</title>
<g id="a_node58"><a xlink:title="Return a naive token count approximation.">
<polygon fill="none" stroke="black" points="8730,-2002.31 8494,-2002.31 8494,-1966.31 8730,-1966.31 8730,-2002.31"/>
<text text-anchor="middle" x="8612" y="-1980.26" font-family="Times,serif" font-size="15.68">token_utils.estimate_tokens</text>
</a>
</g>
</g>
<!-- telegram_bot._t -->
<g id="node59" class="node">
<title>telegram_bot._t</title>
<g id="a_node59"><a xlink:title="Return ``text`` translated to ``lang`` using gettext files.">
<polygon fill="none" stroke="black" points="5697.5,-5187.31 5489.5,-5187.31 5489.5,-5151.31 5697.5,-5151.31 5697.5,-5187.31"/>
<text text-anchor="middle" x="5593.5" y="-5163.43" font-family="Times,serif" font-size="24.22">telegram_bot._t</text>
</a>
</g>
</g>
<!-- telegram_bot.ensure_profile -->
<g id="node60" class="node">
<title>telegram_bot.ensure_profile</title>
<g id="a_node60"><a xlink:title="Return profile for ``uid`` creating one if needed.">
<polygon fill="none" stroke="black" points="5744.5,-5241.31 5442.5,-5241.31 5442.5,-5205.31 5744.5,-5205.31 5744.5,-5241.31"/>
<text text-anchor="middle" x="5593.5" y="-5218.52" font-family="Times,serif" font-size="19.74">telegram_bot.ensure_profile</text>
</a>
</g>
</g>
<!-- telegram_bot.save_profiles -->
<g id="node61" class="node">
<title>telegram_bot.save_profiles</title>
<g id="a_node61"><a xlink:title="Write ``profiles`` to disk.">
<polygon fill="none" stroke="black" points="6574,-5149.31 6366,-5149.31 6366,-5113.31 6574,-5113.31 6574,-5149.31"/>
<text text-anchor="middle" x="6470" y="-5127.61" font-family="Times,serif" font-size="14.00">telegram_bot.save_profiles</text>
</a>
</g>
</g>
<!-- telegram_bot.ensure_profile&#45;&gt;telegram_bot.save_profiles -->
<g id="edge57" class="edge">
<title>telegram_bot.ensure_profile&#45;&gt;telegram_bot.save_profiles</title>
<path fill="none" stroke="black" d="M5744.72,-5211.45C5797.34,-5207.04 5856.82,-5201.77 5911,-5196.31 6065.24,-5180.75 6243.07,-5159.45 6355.73,-5145.54"/>
<polygon fill="black" stroke="black" points="6356.25,-5149 6365.75,-5144.3 6355.39,-5142.06 6356.25,-5149"/>
</g>
<!-- telegram_bot.load_profiles -->
<g id="node62" class="node">
<title>telegram_bot.load_profiles</title>
<g id="a_node62"><a xlink:title="Populate the global ``profiles`` mapping.">
<polygon fill="none" stroke="black" points="5744.5,-5613.31 5442.5,-5613.31 5442.5,-5577.31 5744.5,-5577.31 5744.5,-5613.31"/>
<text text-anchor="middle" x="5593.5" y="-5590.01" font-family="Times,serif" font-size="21.00">telegram_bot.load_profiles</text>
</a>
</g>
</g>
<!-- telegram_bot.load_profiles&#45;&gt;notes_utils.read_text -->
<g id="edge58" class="edge">
<title>telegram_bot.load_profiles&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M5744.66,-5595.82C6075.12,-5596.9 6890.31,-5599.31 7573,-5599.31 7573,-5599.31 7573,-5599.31 8613,-5599.31 8740.91,-5599.31 9663.15,-5657.99 9764,-5579.31 9947.05,-5436.5 10045.33,-4644.06 10063.43,-4484.36"/>
<polygon fill="black" stroke="black" points="10066.91,-4484.69 10064.55,-4474.37 10059.96,-4483.91 10066.91,-4484.69"/>
</g>
<!-- telegram_bot.load_state -->
<g id="node63" class="node">
<title>telegram_bot.load_state</title>
<g id="a_node63"><a xlink:title="Populate ``processed_ids`` from ``STATE_PATH``.">
<polygon fill="none" stroke="black" points="9578,-5570.31 9291,-5570.31 9291,-5534.31 9578,-5534.31 9578,-5570.31"/>
<text text-anchor="middle" x="9434.5" y="-5546.61" font-family="Times,serif" font-size="22.12">telegram_bot.load_state</text>
</a>
</g>
</g>
<!-- telegram_bot.load_state&#45;&gt;notes_utils.read_text -->
<g id="edge59" class="edge">
<title>telegram_bot.load_state&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M9526.68,-5570.35C9599.08,-5579.16 9698.66,-5578.22 9764,-5524.31 9934.19,-5383.87 10041.96,-4640.06 10062.8,-4484.75"/>
<polygon fill="black" stroke="black" points="10066.3,-4484.97 10064.15,-4474.6 10059.36,-4484.05 10066.3,-4484.97"/>
</g>
<!-- telegram_bot.save_state -->
<g id="node64" class="node">
<title>telegram_bot.save_state</title>
<polygon fill="none" stroke="black" points="6554,-4581.31 6386,-4581.31 6386,-4545.31 6554,-4545.31 6554,-4581.31"/>
<text text-anchor="middle" x="6470" y="-4560.06" font-family="Times,serif" font-size="12.18">telegram_bot.save_state</text>
</g>
<!-- telegram_bot.scan_embeddings -->
<g id="node65" class="node">
<title>telegram_bot.scan_embeddings</title>
<g id="a_node65"><a xlink:title="Load new embeddings and return list of new lot ids.">
<polygon fill="none" stroke="black" points="7720,-4869.31 7428,-4869.31 7428,-4833.31 7720,-4833.31 7720,-4869.31"/>
<text text-anchor="middle" x="7574" y="-4847.14" font-family="Times,serif" font-size="17.08">telegram_bot.scan_embeddings</text>
</a>
</g>
</g>
<!-- telegram_bot.scan_embeddings&#45;&gt;similar_utils._load_embeddings -->
<g id="edge60" class="edge">
<title>telegram_bot.scan_embeddings&#45;&gt;similar_utils._load_embeddings</title>
<path fill="none" stroke="black" d="M7720.14,-4851.73C7881.9,-4852.2 8146.85,-4852.96 8345.84,-4853.54"/>
<polygon fill="black" stroke="black" points="8345.85,-4857.04 8355.86,-4853.57 8345.87,-4850.04 8345.85,-4857.04"/>
</g>
<!-- telegram_bot._should_suggest -->
<g id="node66" class="node">
<title>telegram_bot._should_suggest</title>
<polygon fill="none" stroke="black" points="6631.5,-5019.31 6308.5,-5019.31 6308.5,-4983.31 6631.5,-4983.31 6631.5,-5019.31"/>
<text text-anchor="middle" x="6470" y="-4996.52" font-family="Times,serif" font-size="19.74">telegram_bot._should_suggest</text>
</g>
<!-- telegram_bot._should_suggest&#45;&gt;similar_utils._cos_sim -->
<g id="edge61" class="edge">
<title>telegram_bot._should_suggest&#45;&gt;similar_utils._cos_sim</title>
<path fill="none" stroke="black" d="M6631.54,-5001.31C6852.64,-5001.31 7246.29,-5001.31 7447.31,-5001.31"/>
<polygon fill="black" stroke="black" points="7447.33,-5004.81 7457.33,-5001.31 7447.33,-4997.81 7447.33,-5004.81"/>
</g>
<!-- telegram_bot.enqueue_new_ids -->
<g id="node67" class="node">
<title>telegram_bot.enqueue_new_ids</title>
<polygon fill="none" stroke="black" points="5832,-5019.31 5355,-5019.31 5355,-4979.31 5832,-4979.31 5832,-5019.31"/>
<text text-anchor="middle" x="5593.5" y="-4992.24" font-family="Times,serif" font-size="28.84">telegram_bot.enqueue_new_ids</text>
</g>
<!-- telegram_bot.enqueue_new_ids&#45;&gt;telegram_bot.save_profiles -->
<g id="edge62" class="edge">
<title>telegram_bot.enqueue_new_ids&#45;&gt;telegram_bot.save_profiles</title>
<path fill="none" stroke="black" d="M5727.32,-5019.36C5898.84,-5045.25 6194.45,-5089.87 6355.82,-5114.22"/>
<polygon fill="black" stroke="black" points="6355.37,-5117.7 6365.78,-5115.73 6356.41,-5110.77 6355.37,-5117.7"/>
</g>
<!-- telegram_bot.enqueue_new_ids&#45;&gt;telegram_bot._should_suggest -->
<g id="edge63" class="edge">
<title>telegram_bot.enqueue_new_ids&#45;&gt;telegram_bot._should_suggest</title>
<path fill="none" stroke="black" d="M5832.02,-4999.85C5979.29,-5000.19 6165.06,-5000.61 6297.91,-5000.92"/>
<polygon fill="black" stroke="black" points="6298.18,-5004.42 6308.18,-5000.94 6298.19,-4997.42 6298.18,-5004.42"/>
</g>
<!-- telegram_bot._send_queue -->
<g id="node68" class="node">
<title>telegram_bot._send_queue</title>
<g id="a_node68"><a xlink:title="Send next lot from each user queue via ``app``.">
<polygon fill="none" stroke="black" points="5869,-4961.31 5318,-4961.31 5318,-4909.31 5869,-4909.31 5869,-4961.31"/>
<text text-anchor="middle" x="5593.5" y="-4925.61" font-family="Times,serif" font-size="39.62">telegram_bot._send_queue</text>
</a>
</g>
</g>
<!-- telegram_bot._send_queue&#45;&gt;lot_io.get_lot -->
<g id="edge64" class="edge">
<title>telegram_bot._send_queue&#45;&gt;lot_io.get_lot</title>
<path fill="none" stroke="black" d="M5760.47,-4909.27C5815.75,-4892.59 5872.88,-4865.21 5911,-4820.31 5967.18,-4754.12 5881.21,-4684.96 5947,-4628.31 6035.13,-4552.42 6908.63,-4670.35 6993,-4590.31 7058.39,-4528.27 6964.03,-4248.78 7029,-4186.31 7092.94,-4124.83 7355.34,-4138.96 7490.97,-4150.9"/>
<polygon fill="black" stroke="black" points="7491.03,-4154.42 7501.3,-4151.82 7491.66,-4147.44 7491.03,-4154.42"/>
</g>
<!-- telegram_bot._send_queue&#45;&gt;telegram_bot.save_profiles -->
<g id="edge65" class="edge">
<title>telegram_bot._send_queue&#45;&gt;telegram_bot.save_profiles</title>
<path fill="none" stroke="black" d="M5869.31,-4949.49C5883.89,-4955.18 5897.91,-4962.05 5911,-4970.31 5936.66,-4986.49 5922.05,-5011.05 5947,-5028.31 6068.78,-5112.53 6242.7,-5131.66 6355.73,-5134.2"/>
<polygon fill="black" stroke="black" points="6355.73,-5137.7 6365.79,-5134.38 6355.86,-5130.7 6355.73,-5137.7"/>
</g>
<!-- telegram_bot.send_alert -->
<g id="node69" class="node">
<title>telegram_bot.send_alert</title>
<g id="a_node69"><a xlink:title="Broadcast ``text`` to all registered users.">
<polygon fill="none" stroke="black" points="5160.5,-5475.31 4830.5,-5475.31 4830.5,-5439.31 5160.5,-5439.31 5160.5,-5475.31"/>
<text text-anchor="middle" x="4995.5" y="-5451.15" font-family="Times,serif" font-size="25.20">telegram_bot.send_alert</text>
</a>
</g>
</g>
<!-- telegram_bot.send_alert&#45;&gt;telegram_bot.load_profiles -->
<g id="edge66" class="edge">
<title>telegram_bot.send_alert&#45;&gt;telegram_bot.load_profiles</title>
<path fill="none" stroke="black" d="M5034.38,-5475.34C5087.21,-5499.62 5186.6,-5542.22 5276,-5563.31 5326.14,-5575.13 5381.76,-5582.59 5432.22,-5587.29"/>
<polygon fill="black" stroke="black" points="5431.96,-5590.78 5442.24,-5588.2 5432.59,-5583.81 5431.96,-5590.78"/>
</g>
<!-- telegram_bot.start_cmd -->
<g id="node70" class="node">
<title>telegram_bot.start_cmd</title>
<g id="a_node70"><a xlink:title="Register the user and confirm startup.">
<polygon fill="none" stroke="black" points="5107.5,-5220.31 4883.5,-5220.31 4883.5,-5184.31 5107.5,-5184.31 5107.5,-5220.31"/>
<text text-anchor="middle" x="4995.5" y="-5198.14" font-family="Times,serif" font-size="17.08">telegram_bot.start_cmd</text>
</a>
</g>
</g>
<!-- telegram_bot.start_cmd&#45;&gt;telegram_bot._t -->
<g id="edge67" class="edge">
<title>telegram_bot.start_cmd&#45;&gt;telegram_bot._t</title>
<path fill="none" stroke="black" d="M5107.55,-5196.16C5213.59,-5190.29 5372.59,-5181.48 5479.32,-5175.57"/>
<polygon fill="black" stroke="black" points="5479.7,-5179.06 5489.49,-5175.01 5479.31,-5172.07 5479.7,-5179.06"/>
</g>
<!-- telegram_bot.start_cmd&#45;&gt;telegram_bot.ensure_profile -->
<g id="edge68" class="edge">
<title>telegram_bot.start_cmd&#45;&gt;telegram_bot.ensure_profile</title>
<path fill="none" stroke="black" d="M5107.55,-5206.22C5198.9,-5209.44 5329.55,-5214.04 5432.23,-5217.66"/>
<polygon fill="black" stroke="black" points="5432.27,-5221.16 5442.39,-5218.02 5432.52,-5214.17 5432.27,-5221.16"/>
</g>
<!-- telegram_bot.lang_cmd -->
<g id="node71" class="node">
<title>telegram_bot.lang_cmd</title>
<g id="a_node71"><a xlink:title="Set preferred language or list available choices.">
<polygon fill="none" stroke="black" points="5170,-5277.81 4821,-5277.81 4821,-5238.81 5170,-5238.81 5170,-5277.81"/>
<text text-anchor="middle" x="4995.5" y="-5251.41" font-family="Times,serif" font-size="28.00">telegram_bot.lang_cmd</text>
</a>
</g>
</g>
<!-- telegram_bot.lang_cmd&#45;&gt;telegram_bot._t -->
<g id="edge69" class="edge">
<title>telegram_bot.lang_cmd&#45;&gt;telegram_bot._t</title>
<path fill="none" stroke="black" d="M5170.14,-5251.14C5194.28,-5246.3 5218.24,-5239.3 5240,-5229.31 5259.73,-5220.26 5256.12,-5205.03 5276,-5196.31 5339.38,-5168.49 5416.69,-5161.46 5479.04,-5161.52"/>
<polygon fill="black" stroke="black" points="5479.28,-5165.02 5489.31,-5161.6 5479.33,-5158.02 5479.28,-5165.02"/>
</g>
<!-- telegram_bot.lang_cmd&#45;&gt;telegram_bot.ensure_profile -->
<g id="edge70" class="edge">
<title>telegram_bot.lang_cmd&#45;&gt;telegram_bot.ensure_profile</title>
<path fill="none" stroke="black" d="M5170.09,-5248.11C5252.81,-5243.26 5351.11,-5237.48 5432.06,-5232.73"/>
<polygon fill="black" stroke="black" points="5432.57,-5236.21 5442.35,-5232.13 5432.16,-5229.22 5432.57,-5236.21"/>
</g>
<!-- telegram_bot.lang_cmd&#45;&gt;telegram_bot.save_profiles -->
<g id="edge71" class="edge">
<title>telegram_bot.lang_cmd&#45;&gt;telegram_bot.save_profiles</title>
<path fill="none" stroke="black" d="M5170.36,-5266.53C5395.71,-5275.49 5775.81,-5284.42 5911,-5250.31 5928.54,-5245.88 5929.93,-5237.3 5947,-5231.31 6083.22,-5183.51 6247.91,-5156.79 6355.39,-5143.23"/>
<polygon fill="black" stroke="black" points="6356.12,-5146.67 6365.61,-5141.96 6355.25,-5139.72 6356.12,-5146.67"/>
</g>
<!-- telegram_bot.vote_callback -->
<g id="node72" class="node">
<title>telegram_bot.vote_callback</title>
<g id="a_node72"><a xlink:title="Handle inline button presses for lot feedback.">
<polygon fill="none" stroke="black" points="5210.5,-5165.81 4780.5,-5165.81 4780.5,-5124.81 5210.5,-5124.81 5210.5,-5165.81"/>
<text text-anchor="middle" x="4995.5" y="-5138.06" font-family="Times,serif" font-size="29.68">telegram_bot.vote_callback</text>
</a>
</g>
</g>
<!-- telegram_bot.vote_callback&#45;&gt;telegram_bot._t -->
<g id="edge72" class="edge">
<title>telegram_bot.vote_callback&#45;&gt;telegram_bot._t</title>
<path fill="none" stroke="black" d="M5210.83,-5153.94C5301.53,-5157.59 5403.49,-5161.7 5479.2,-5164.75"/>
<polygon fill="black" stroke="black" points="5479.1,-5168.24 5489.23,-5165.15 5479.38,-5161.25 5479.1,-5168.24"/>
</g>
<!-- telegram_bot.vote_callback&#45;&gt;telegram_bot.ensure_profile -->
<g id="edge73" class="edge">
<title>telegram_bot.vote_callback&#45;&gt;telegram_bot.ensure_profile</title>
<path fill="none" stroke="black" d="M5207.56,-5165.87C5218.63,-5168.64 5229.51,-5171.77 5240,-5175.31 5257.55,-5181.23 5258.34,-5190.72 5276,-5196.31 5325.41,-5211.95 5381.2,-5219.75 5432.03,-5223.35"/>
<polygon fill="black" stroke="black" points="5431.91,-5226.85 5442.12,-5224.02 5432.37,-5219.86 5431.91,-5226.85"/>
</g>
<!-- telegram_bot.vote_callback&#45;&gt;telegram_bot.save_profiles -->
<g id="edge74" class="edge">
<title>telegram_bot.vote_callback&#45;&gt;telegram_bot.save_profiles</title>
<path fill="none" stroke="black" d="M5210.52,-5142.98C5232.63,-5142.75 5254.77,-5142.52 5276,-5142.31 5672.61,-5138.35 6143.38,-5134.16 6355.46,-5132.3"/>
<polygon fill="black" stroke="black" points="6355.7,-5135.8 6365.67,-5132.21 6355.64,-5128.8 6355.7,-5135.8"/>
</g>
<!-- telegram_bot.main -->
<g id="node73" class="node">
<title>telegram_bot.main</title>
<g id="a_node73"><a xlink:title="Run the Telegram recommendation bot.">
<polygon fill="none" stroke="black" points="5161,-5019.31 4830,-5019.31 4830,-4975.31 5161,-4975.31 5161,-5019.31"/>
<text text-anchor="middle" x="4995.5" y="-4988.99" font-family="Times,serif" font-size="32.90">telegram_bot.main</text>
</a>
</g>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot.load_profiles -->
<g id="edge75" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot.load_profiles</title>
<path fill="none" stroke="black" d="M5093.71,-5019.39C5145.89,-5036.52 5206.25,-5065.97 5240,-5115.31 5296.38,-5197.75 5206.11,-5491.96 5276,-5563.31 5332.18,-5620.65 5426.59,-5623.19 5497.71,-5614.68"/>
<polygon fill="black" stroke="black" points="5498.56,-5618.1 5508.03,-5613.35 5497.67,-5611.16 5498.56,-5618.1"/>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot.load_state -->
<g id="edge76" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot.load_state</title>
<path fill="none" stroke="black" d="M5089.25,-5019.39C5141.62,-5036.72 5203.68,-5066.36 5240,-5115.31 5300.87,-5197.34 5201.95,-5271.94 5276,-5342.31 5508.44,-5563.19 7834.36,-5538.22 8155,-5541.31 8561.45,-5545.22 9040.6,-5549.17 9280.47,-5551.09"/>
<polygon fill="black" stroke="black" points="9280.63,-5554.59 9290.65,-5551.17 9280.68,-5547.59 9280.63,-5554.59"/>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot.save_state -->
<g id="edge77" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot.save_state</title>
<path fill="none" stroke="black" d="M5046.4,-4975.25C5102.88,-4947.56 5193.08,-4894.52 5240,-4820.31 5286.4,-4746.92 5210.72,-4685.55 5276,-4628.31 5357.94,-4556.45 6109.44,-4558.77 6375.87,-4561.9"/>
<polygon fill="black" stroke="black" points="6375.87,-4565.4 6385.91,-4562.02 6375.95,-4558.4 6375.87,-4565.4"/>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot.scan_embeddings -->
<g id="edge78" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot.scan_embeddings</title>
<path fill="none" stroke="black" d="M5047.14,-4975.24C5102.29,-4952.29 5193.64,-4917.36 5276,-4900.31 5649.79,-4822.9 6611.28,-4849.98 6993,-4850.31 7136.95,-4850.43 7301,-4850.73 7417.81,-4850.97"/>
<polygon fill="black" stroke="black" points="7417.89,-4854.47 7427.9,-4850.99 7417.91,-4847.47 7417.89,-4854.47"/>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot.enqueue_new_ids -->
<g id="edge79" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot.enqueue_new_ids</title>
<path fill="none" stroke="black" d="M5161.33,-4997.86C5218.04,-4998.05 5282.84,-4998.27 5344.68,-4998.48"/>
<polygon fill="black" stroke="black" points="5344.96,-5001.98 5354.97,-4998.51 5344.99,-4994.98 5344.96,-5001.98"/>
</g>
<!-- telegram_bot.main&#45;&gt;telegram_bot._send_queue -->
<g id="edge80" class="edge">
<title>telegram_bot.main&#45;&gt;telegram_bot._send_queue</title>
<path fill="none" stroke="black" d="M5161.33,-4980.16C5214.26,-4974.66 5274.24,-4968.42 5332.27,-4962.38"/>
<polygon fill="black" stroke="black" points="5332.74,-4965.85 5342.32,-4961.33 5332.01,-4958.89 5332.74,-4965.85"/>
</g>
<!-- log_utils._add_exc_line -->
<g id="node75" class="node">
<title>log_utils._add_exc_line</title>
<g id="a_node75"><a xlink:title="Attach ``line`` from traceback to structured log events.">
<polygon fill="none" stroke="black" points="6611.5,-185.31 6328.5,-185.31 6328.5,-149.31 6611.5,-149.31 6611.5,-185.31"/>
<text text-anchor="middle" x="6470" y="-161.72" font-family="Times,serif" font-size="23.24">log_utils._add_exc_line</text>
</a>
</g>
</g>
<!-- log_utils._add_exc_line&#45;&gt;log_utils._extract_tb_lineno -->
<g id="edge81" class="edge">
<title>log_utils._add_exc_line&#45;&gt;log_utils._extract_tb_lineno</title>
<path fill="none" stroke="black" d="M6611.69,-166.8C6828.52,-166.01 7240.93,-164.51 7447.92,-163.76"/>
<polygon fill="black" stroke="black" points="7448.24,-167.26 7458.23,-163.72 7448.21,-160.26 7448.24,-167.26"/>
</g>
<!-- log_utils.init_logger -->
<g id="node76" class="node">
<title>log_utils.init_logger</title>
<g id="a_node76"><a xlink:title="Initialize logger writing to ``LOGFILE``.&#10;&#10;``LOG_LEVEL`` may be set in ``config.py`` or via an environment&#10;variable. &#160;The level accepts ``DEBUG``, ``INFO`` or ``ERROR`` and&#10;defaults to ``INFO``. &#160;The function falls back to the standard&#10;``logging`` module if ``structlog`` isn&#39;t available so the scripts&#10;can still run in minimal environments.">
<polygon fill="none" stroke="black" points="6817.5,-93.31 6122.5,-93.31 6122.5,-11.31 6817.5,-11.31 6817.5,-93.31"/>
<text text-anchor="middle" x="6470" y="-35.32" font-family="Times,serif" font-size="67.48">log_utils.init_logger</text>
</a>
</g>
</g>
<!-- log_utils.init_logger&#45;&gt;log_utils._extract_tb_lineno -->
<g id="edge82" class="edge">
<title>log_utils.init_logger&#45;&gt;log_utils._extract_tb_lineno</title>
<path fill="none" stroke="black" d="M6707.93,-93.32C6806.89,-109.05 6923.23,-125.75 7029,-136.31 7172.37,-150.62 7337.79,-157.46 7448.22,-160.65"/>
<polygon fill="black" stroke="black" points="7448.3,-164.16 7458.4,-160.94 7448.5,-157.16 7448.3,-164.16"/>
</g>
<!-- log_utils.get_logger -->
<g id="node77" class="node">
<title>log_utils.get_logger</title>
<g id="a_node77"><a xlink:title="Return the singleton logger instance.">
<polygon fill="none" stroke="black" points="7642.5,-51.31 7505.5,-51.31 7505.5,-15.31 7642.5,-15.31 7642.5,-51.31"/>
<text text-anchor="middle" x="7574" y="-30.06" font-family="Times,serif" font-size="12.18">log_utils.get_logger</text>
</a>
</g>
</g>
<!-- log_utils.init_logger&#45;&gt;log_utils.get_logger -->
<g id="edge83" class="edge">
<title>log_utils.init_logger&#45;&gt;log_utils.get_logger</title>
<path fill="none" stroke="black" d="M6817.79,-40.01C7057.09,-34.83 7356.25,-30.55 7495.29,-30.98"/>
<polygon fill="black" stroke="black" points="7495.41,-34.48 7505.42,-31.02 7495.44,-27.48 7495.41,-34.48"/>
</g>
<!-- log_utils.get_logger&#45;&gt;log_utils.init_logger -->
<g id="edge84" class="edge">
<title>log_utils.get_logger&#45;&gt;log_utils.init_logger</title>
<path fill="none" stroke="black" d="M7505.42,-37.93C7373.1,-43.16 7071.47,-49.33 6827.88,-52.52"/>
<polygon fill="black" stroke="black" points="6827.74,-49.02 6817.79,-52.65 6827.83,-56.02 6827.74,-49.02"/>
</g>
<!-- price_utils.canonical_currency -->
<g id="node78" class="node">
<title>price_utils.canonical_currency</title>
<g id="a_node78"><a xlink:title="Return canonical currency code or ``None`` when unknown.">
<polygon fill="none" stroke="black" points="8791.5,-116.31 8432.5,-116.31 8432.5,-80.31 8791.5,-80.31 8791.5,-116.31"/>
<text text-anchor="middle" x="8612" y="-92.61" font-family="Times,serif" font-size="22.12">price_utils.canonical_currency</text>
</a>
</g>
</g>
<!-- price_utils.fetch_official_rates -->
<g id="node79" class="node">
<title>price_utils.fetch_official_rates</title>
<g id="a_node79"><a xlink:title="Return currency multipliers relative to USD from NBG.">
<polygon fill="none" stroke="black" points="5911,-564.81 5276,-564.81 5276,-511.81 5911,-511.81 5911,-564.81"/>
<text text-anchor="middle" x="5593.5" y="-528.1" font-family="Times,serif" font-size="40.88">price_utils.fetch_official_rates</text>
</a>
</g>
</g>
<!-- price_utils.train_price_regression -->
<g id="node80" class="node">
<title>price_utils.train_price_regression</title>
<g id="a_node80"><a xlink:title="Return ``(model, currency_map, counts)`` trained on ``lots``.&#10;&#10;``lots`` must contain ``price`` and ``price:currency`` fields. Only lots with&#10;embeddings present in ``id_to_vec`` are considered. Prices are regressed on&#10;the logarithm scale so coefficients are interpretable as multiplicative&#10;factors. ``USD`` is treated as the base currency so coefficients can be&#10;interpreted as exchange rate multipliers. The returned ``counts`` dictionary&#10;maps each currency to the number of training samples observed.">
<polygon fill="none" stroke="black" points="8119,-413.81 7029,-413.81 7029,-336.81 8119,-336.81 8119,-413.81"/>
<text text-anchor="middle" x="7574" y="-359.41" font-family="Times,serif" font-size="63.00">price_utils.train_price_regression</text>
</a>
</g>
</g>
<!-- price_utils.train_price_regression&#45;&gt;price_utils.canonical_currency -->
<g id="edge86" class="edge">
<title>price_utils.train_price_regression&#45;&gt;price_utils.canonical_currency</title>
<path fill="none" stroke="black" d="M8106.09,-336.7C8110.46,-333.69 8114.77,-330.56 8119,-327.31 8156.13,-298.79 8120.74,-260.22 8155,-228.31 8227.22,-161.05 8331.8,-128.27 8422.59,-112.44"/>
<polygon fill="black" stroke="black" points="8423.18,-115.89 8432.46,-110.77 8422.01,-108.98 8423.18,-115.89"/>
</g>
<!-- price_utils.save_price_model -->
<g id="node81" class="node">
<title>price_utils.save_price_model</title>
<g id="a_node81"><a xlink:title="Write ``model`` parameters to ``path`` as JSON.">
<polygon fill="none" stroke="black" points="7786.5,-4700.81 7361.5,-4700.81 7361.5,-4661.81 7786.5,-4661.81 7786.5,-4700.81"/>
<text text-anchor="middle" x="7574" y="-4674.41" font-family="Times,serif" font-size="28.00">price_utils.save_price_model</text>
</a>
</g>
</g>
<!-- price_utils.save_price_model&#45;&gt;notes_utils.write_json -->
<g id="edge87" class="edge">
<title>price_utils.save_price_model&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M7786.52,-4675.39C8006.04,-4669.24 8340.21,-4659.89 8507.7,-4655.2"/>
<polygon fill="black" stroke="black" points="8507.86,-4658.7 8517.76,-4654.92 8507.66,-4651.7 8507.86,-4658.7"/>
</g>
<!-- price_utils.load_price_model -->
<g id="node82" class="node">
<title>price_utils.load_price_model</title>
<g id="a_node82"><a xlink:title="Return ``(model, currencies, counts)`` loaded from ``path``.">
<polygon fill="none" stroke="black" points="6704.5,-3941.31 6235.5,-3941.31 6235.5,-3899.31 6704.5,-3899.31 6704.5,-3941.31"/>
<text text-anchor="middle" x="6470" y="-3912.22" font-family="Times,serif" font-size="31.36">price_utils.load_price_model</text>
</a>
</g>
</g>
<!-- price_utils.load_price_model&#45;&gt;notes_utils.load_json -->
<g id="edge88" class="edge">
<title>price_utils.load_price_model&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M6704.78,-3911.09C6804.65,-3907.58 6922.52,-3904.03 7029,-3902.31 7894.82,-3888.35 8936.22,-3902.26 9300.19,-3908.05"/>
<polygon fill="black" stroke="black" points="9300.19,-3911.55 9310.24,-3908.21 9300.3,-3904.55 9300.19,-3911.55"/>
</g>
<!-- price_utils.predict_price -->
<g id="node83" class="node">
<title>price_utils.predict_price</title>
<g id="a_node83"><a xlink:title="Return predicted price for ``vec`` in ``currency``.&#10;&#10;When ``model`` is ``None`` or ``vec`` is missing, ``None`` is returned.">
<polygon fill="none" stroke="black" points="7779,-318.81 7369,-318.81 7369,-275.81 7779,-275.81 7779,-318.81"/>
<text text-anchor="middle" x="7574" y="-289.16" font-family="Times,serif" font-size="32.06">price_utils.predict_price</text>
</a>
</g>
</g>
<!-- price_utils.currency_rates -->
<g id="node84" class="node">
<title>price_utils.currency_rates</title>
<g id="a_node84"><a xlink:title="Return estimated currency multipliers relative to the base.&#10;&#10;The regression model learns one coefficient per currency dummy feature. &#160;The&#10;coefficient is the logarithm of the multiplier relative to USD.">
<polygon fill="none" stroke="black" points="8805.5,-276.81 8418.5,-276.81 8418.5,-237.81 8805.5,-237.81 8805.5,-276.81"/>
<text text-anchor="middle" x="8612" y="-250.41" font-family="Times,serif" font-size="28.00">price_utils.currency_rates</text>
</a>
</g>
</g>
<!-- price_utils.guess_currency -->
<g id="node85" class="node">
<title>price_utils.guess_currency</title>
<g id="a_node85"><a xlink:title="Return currency with multiplier closest to ``price/pred_usd``.&#10;&#10;``pred_usd`` is the predicted price in USD. &#160;``price`` is the numeric value&#10;provided by the user without a currency. &#160;The function compares the implied&#10;multiplier ``price / pred_usd`` against the learnt exchange rates and picks&#10;the closest match. &#160;``counts`` may be provided to ignore rarely seen&#10;currencies when guessing. &#160;Any currency with fewer than ``min_samples``&#10;samples in the training set is skipped.">
<polygon fill="none" stroke="black" points="10335,-234.31 9800,-234.31 9800,-184.31 10335,-184.31 10335,-234.31"/>
<text text-anchor="middle" x="10067.5" y="-199.62" font-family="Times,serif" font-size="38.36">price_utils.guess_currency</text>
</a>
</g>
</g>
<!-- price_utils._guess_currency_verified -->
<g id="node86" class="node">
<title>price_utils._guess_currency_verified</title>
<g id="a_node86"><a xlink:title="Return currency when both AI and official rates agree.">
<polygon fill="none" stroke="black" points="9691,-228.31 9178,-228.31 9178,-190.31 9691,-190.31 9691,-228.31"/>
<text text-anchor="middle" x="9434.5" y="-202.58" font-family="Times,serif" font-size="27.16">price_utils._guess_currency_verified</text>
</a>
</g>
</g>
<!-- price_utils._guess_currency_verified&#45;&gt;price_utils.guess_currency -->
<g id="edge89" class="edge">
<title>price_utils._guess_currency_verified&#45;&gt;price_utils.guess_currency</title>
<path fill="none" stroke="black" d="M9691.24,-209.31C9723.67,-209.31 9756.98,-209.31 9789.72,-209.31"/>
<polygon fill="black" stroke="black" points="9789.86,-212.81 9799.86,-209.31 9789.86,-205.81 9789.86,-212.81"/>
</g>
<!-- price_utils.apply_price_model -->
<g id="node87" class="node">
<title>price_utils.apply_price_model</title>
<g id="a_node87"><a xlink:title="Predict prices in USD and guess missing currencies.">
<polygon fill="none" stroke="black" points="6830.5,-365.81 6109.5,-365.81 6109.5,-306.81 6830.5,-306.81 6830.5,-365.81"/>
<text text-anchor="middle" x="6470" y="-324.62" font-family="Times,serif" font-size="46.48">price_utils.apply_price_model</text>
</a>
</g>
</g>
<!-- price_utils.apply_price_model&#45;&gt;price_utils.train_price_regression -->
<g id="edge90" class="edge">
<title>price_utils.apply_price_model&#45;&gt;price_utils.train_price_regression</title>
<path fill="none" stroke="black" d="M6830.69,-349.04C6890.9,-351.17 6954.59,-353.42 7018.34,-355.68"/>
<polygon fill="black" stroke="black" points="7018.45,-359.18 7028.57,-356.04 7018.7,-352.19 7018.45,-359.18"/>
</g>
<!-- price_utils.apply_price_model&#45;&gt;price_utils.predict_price -->
<g id="edge91" class="edge">
<title>price_utils.apply_price_model&#45;&gt;price_utils.predict_price</title>
<path fill="none" stroke="black" d="M6830.69,-323.58C7005.19,-317.4 7208.92,-310.19 7358.76,-304.89"/>
<polygon fill="black" stroke="black" points="7359.13,-308.38 7369,-304.53 7358.88,-301.38 7359.13,-308.38"/>
</g>
<!-- price_utils.apply_price_model&#45;&gt;price_utils.currency_rates -->
<g id="edge92" class="edge">
<title>price_utils.apply_price_model&#45;&gt;price_utils.currency_rates</title>
<path fill="none" stroke="black" d="M6830.79,-339.58C6886.5,-331.57 6942.31,-318.31 6993,-297.31 7012.51,-289.23 7009.23,-273.71 7029,-266.31 7154.64,-219.26 8009.97,-238.78 8408.02,-250.67"/>
<polygon fill="black" stroke="black" points="8408.1,-254.17 8418.2,-250.97 8408.31,-247.18 8408.1,-254.17"/>
</g>
<!-- price_utils.apply_price_model&#45;&gt;price_utils._guess_currency_verified -->
<g id="edge93" class="edge">
<title>price_utils.apply_price_model&#45;&gt;price_utils._guess_currency_verified</title>
<path fill="none" stroke="black" d="M6830.66,-355.74C6888.1,-346.14 6944.5,-328.16 6993,-297.31 7020.54,-279.79 7000.91,-249.92 7029,-233.31 7119.62,-179.7 8561.03,-195.69 9167.68,-204.87"/>
<polygon fill="black" stroke="black" points="9167.83,-208.37 9177.88,-205.02 9167.94,-201.37 9167.83,-208.37"/>
</g>
<!-- price_utils.prepare_price_fields -->
<g id="node88" class="node">
<title>price_utils.prepare_price_fields</title>
<g id="a_node88"><a xlink:title="Add display price helpers to ``lots``.&#10;&#10;``rates`` maps currency codes to multipliers relative to USD and&#10;``cur`` is the display currency. ``_display_price`` is a formatted&#10;string in ``cur``. ``_usd_value`` stores the numeric USD value so&#10;the front&#45;end can switch currencies without rebuilding the site.&#10;Prices predicted by AI get ``_price_class`` set to ``ai&#45;price`` for&#10;styling.">
<polygon fill="none" stroke="black" points="7944,-127.31 7204,-127.31 7204,-69.31 7944,-69.31 7944,-127.31"/>
<text text-anchor="middle" x="7574" y="-87.02" font-family="Times,serif" font-size="45.36">price_utils.prepare_price_fields</text>
</a>
</g>
</g>
<!-- price_utils.prepare_price_fields&#45;&gt;price_utils.canonical_currency -->
<g id="edge94" class="edge">
<title>price_utils.prepare_price_fields&#45;&gt;price_utils.canonical_currency</title>
<path fill="none" stroke="black" d="M7944.27,-98.31C8105.99,-98.31 8288.85,-98.31 8422.11,-98.31"/>
<polygon fill="black" stroke="black" points="8422.43,-101.81 8432.43,-98.31 8422.43,-94.81 8422.43,-101.81"/>
</g>
<!-- caption._identify_size -->
<g id="node89" class="node">
<title>caption._identify_size</title>
<g id="a_node89"><a xlink:title="Return ``(width, height)`` for ``path`` using ImageMagick.">
<polygon fill="none" stroke="black" points="8740.5,-5398.31 8483.5,-5398.31 8483.5,-5362.31 8740.5,-5362.31 8740.5,-5398.31"/>
<text text-anchor="middle" x="8612" y="-5374.61" font-family="Times,serif" font-size="22.12">caption._identify_size</text>
</a>
</g>
</g>
<!-- caption._prepare_image -->
<g id="node90" class="node">
<title>caption._prepare_image</title>
<g id="a_node90"><a xlink:title="Resize ``path`` and return the processed JPEG bytes.">
<polygon fill="none" stroke="black" points="7791,-5403.31 7357,-5403.31 7357,-5357.31 7791,-5357.31 7791,-5403.31"/>
<text text-anchor="middle" x="7574" y="-5371.87" font-family="Times,serif" font-size="34.30">caption._prepare_image</text>
</a>
</g>
</g>
<!-- caption._prepare_image&#45;&gt;caption._identify_size -->
<g id="edge95" class="edge">
<title>caption._prepare_image&#45;&gt;caption._identify_size</title>
<path fill="none" stroke="black" d="M7791.23,-5380.31C7996.46,-5380.31 8298.73,-5380.31 8473.12,-5380.31"/>
<polygon fill="black" stroke="black" points="8473.13,-5383.81 8483.13,-5380.31 8473.13,-5376.81 8473.13,-5383.81"/>
</g>
<!-- caption._guess_chat -->
<g id="node91" class="node">
<title>caption._guess_chat</title>
<g id="a_node91"><a xlink:title="Return chat name for ``path`` relative to ``MEDIA_DIR``.">
<polygon fill="none" stroke="black" points="8708,-5317.31 8516,-5317.31 8516,-5281.31 8708,-5281.31 8708,-5317.31"/>
<text text-anchor="middle" x="8612" y="-5295.14" font-family="Times,serif" font-size="17.08">caption._guess_chat</text>
</a>
</g>
</g>
<!-- caption.caption_file -->
<g id="node92" class="node">
<title>caption.caption_file</title>
<g id="a_node92"><a xlink:title="Caption ``path`` with GPT&#45;4o and save ``.caption.json`` beside it.">
<polygon fill="none" stroke="black" points="6773,-4764.81 6167,-4764.81 6167,-4691.81 6773,-4691.81 6773,-4764.81"/>
<text text-anchor="middle" x="6470" y="-4713.32" font-family="Times,serif" font-size="59.36">caption.caption_file</text>
</a>
</g>
</g>
<!-- caption.caption_file&#45;&gt;notes_utils.load_json -->
<g id="edge96" class="edge">
<title>caption.caption_file&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M6773.17,-4745.35C7423.2,-4778.81 8908.71,-4836.91 9069,-4679.31 9127.86,-4621.44 9047.62,-3996.64 9105,-3937.31 9167.63,-3872.55 9277.46,-3877.23 9352.75,-3890.43"/>
<polygon fill="black" stroke="black" points="9352.21,-3893.89 9362.68,-3892.26 9353.48,-3887.01 9352.21,-3893.89"/>
</g>
<!-- caption.caption_file&#45;&gt;caption_io.caption_json_path -->
<g id="edge97" class="edge">
<title>caption.caption_file&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M6773.27,-4735.39C6870.32,-4730.73 6961.06,-4716.59 6993,-4682.31 7072.88,-4596.57 6946.2,-2656.23 7029,-2573.31 7109.09,-2493.09 8986.79,-2613.35 9069,-2535.31 9151.24,-2457.24 9025.28,-2106.95 9105,-2026.31 9167.95,-1962.63 9276.68,-1966.71 9351.7,-1979.51"/>
<polygon fill="black" stroke="black" points="9351.13,-1982.96 9361.59,-1981.28 9352.37,-1976.07 9351.13,-1982.96"/>
</g>
<!-- caption.caption_file&#45;&gt;caption_io.has_caption -->
<g id="edge98" class="edge">
<title>caption.caption_file&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M6633.28,-4764.81C6750.78,-4780.73 6904.03,-4777.84 6993,-4682.31 7074.11,-4595.21 6947.29,-2626.85 7029,-2540.31 7195.75,-2363.7 7948.09,-2631.89 8119,-2459.31 8206.43,-2371.02 8067.1,-1989.13 8155,-1901.31 8256.02,-1800.39 8440.43,-1827.05 8541.01,-1851.78"/>
<polygon fill="black" stroke="black" points="8540.22,-1855.19 8550.78,-1854.24 8541.93,-1848.4 8540.22,-1855.19"/>
</g>
<!-- caption.caption_file&#45;&gt;caption_io.write_caption -->
<g id="edge99" class="edge">
<title>caption.caption_file&#45;&gt;caption_io.write_caption</title>
<path fill="none" stroke="black" d="M6648.18,-4764.82C6762.14,-4777.17 6904.89,-4769.97 6993,-4682.31 7054.07,-4621.55 6966.78,-4355.89 7029,-4296.31 7080.27,-4247.22 7258.47,-4246.42 7397.11,-4254.15"/>
<polygon fill="black" stroke="black" points="7397.26,-4257.67 7407.44,-4254.75 7397.66,-4250.68 7397.26,-4257.67"/>
</g>
<!-- caption.caption_file&#45;&gt;caption._prepare_image -->
<g id="edge100" class="edge">
<title>caption.caption_file&#45;&gt;caption._prepare_image</title>
<path fill="none" stroke="black" d="M6773.21,-4734.98C6855.87,-4752.11 6937.79,-4786.09 6993,-4850.31 7059.12,-4927.22 6959.39,-5231.54 7029,-5305.31 7131.09,-5413.5 7310.81,-5417.67 7435.61,-5404.43"/>
<polygon fill="black" stroke="black" points="7436.07,-5407.9 7445.63,-5403.32 7435.3,-5400.94 7436.07,-5407.9"/>
</g>
<!-- caption.caption_file&#45;&gt;caption._guess_chat -->
<g id="edge101" class="edge">
<title>caption.caption_file&#45;&gt;caption._guess_chat</title>
<path fill="none" stroke="black" d="M6773.26,-4735.3C6855.8,-4752.45 6937.64,-4786.37 6993,-4850.31 7053.89,-4920.62 6961.1,-5203.74 7029,-5267.31 7136.28,-5367.74 8169.41,-5322.64 8505.75,-5305.12"/>
<polygon fill="black" stroke="black" points="8506.18,-5308.61 8515.98,-5304.59 8505.81,-5301.62 8506.18,-5308.61"/>
</g>
<!-- caption.main -->
<g id="node93" class="node">
<title>caption.main</title>
<g id="a_node93"><a xlink:title="Caption a single image provided on the command line.">
<polygon fill="none" stroke="black" points="5686,-4746.31 5501,-4746.31 5501,-4710.31 5686,-4710.31 5686,-4746.31"/>
<text text-anchor="middle" x="5593.5" y="-4722.15" font-family="Times,serif" font-size="25.20">caption.main</text>
</a>
</g>
</g>
<!-- caption.main&#45;&gt;caption.caption_file -->
<g id="edge102" class="edge">
<title>caption.main&#45;&gt;caption.caption_file</title>
<path fill="none" stroke="black" d="M5686.02,-4728.31C5796.92,-4728.31 5989.62,-4728.31 6156.09,-4728.31"/>
<polygon fill="black" stroke="black" points="6156.51,-4731.81 6166.51,-4728.31 6156.51,-4724.81 6156.51,-4731.81"/>
</g>
<!-- embed.embed_file -->
<g id="node94" class="node">
<title>embed.embed_file</title>
<g id="a_node94"><a xlink:title="Embed ``path`` and write the result beside it under ``EMBED_DIR``.">
<polygon fill="none" stroke="black" points="7779,-3740.81 7369,-3740.81 7369,-3685.81 7779,-3685.81 7779,-3740.81"/>
<text text-anchor="middle" x="7574" y="-3702.76" font-family="Times,serif" font-size="42.56">embed.embed_file</text>
</a>
</g>
</g>
<!-- embed.embed_file&#45;&gt;notes_utils.write_json -->
<g id="edge103" class="edge">
<title>embed.embed_file&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M7779.04,-3729.3C7897.98,-3750.12 8039.75,-3797.09 8119,-3902.31 8206.97,-4019.1 8059.45,-4448.63 8155,-4559.31 8240.93,-4658.84 8401.9,-4669.41 8507.77,-4663.9"/>
<polygon fill="black" stroke="black" points="8508.06,-4667.39 8517.84,-4663.32 8507.66,-4660.4 8508.06,-4667.39"/>
</g>
<!-- embed.embed_file&#45;&gt;lot_io.read_lots -->
<g id="edge104" class="edge">
<title>embed.embed_file&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M7779.24,-3733.21C7885.11,-3735.34 8013.89,-3724.73 8119,-3676.31 8356.65,-3566.83 8541.34,-3288.59 8595.08,-3201.08"/>
<polygon fill="black" stroke="black" points="8598.08,-3202.88 8600.29,-3192.52 8592.1,-3199.24 8598.08,-3202.88"/>
</g>
<!-- embed.embed_file&#45;&gt;lot_io.make_lot_id -->
<g id="edge105" class="edge">
<title>embed.embed_file&#45;&gt;lot_io.make_lot_id</title>
<path fill="none" stroke="black" d="M7779.06,-3709.57C7999.02,-3705.53 8340.22,-3699.27 8509.13,-3696.18"/>
<polygon fill="black" stroke="black" points="8509.33,-3699.67 8519.27,-3695.99 8509.2,-3692.67 8509.33,-3699.67"/>
</g>
<!-- embed.main -->
<g id="node95" class="node">
<title>embed.main</title>
<g id="a_node95"><a xlink:title="Embed the file given on the command line.">
<polygon fill="none" stroke="black" points="6558,-3731.31 6382,-3731.31 6382,-3695.31 6558,-3695.31 6558,-3731.31"/>
<text text-anchor="middle" x="6470" y="-3707.15" font-family="Times,serif" font-size="25.20">embed.main</text>
</a>
</g>
</g>
<!-- embed.main&#45;&gt;embed.embed_file -->
<g id="edge106" class="edge">
<title>embed.main&#45;&gt;embed.embed_file</title>
<path fill="none" stroke="black" d="M6558.39,-3713.31C6729.99,-3713.31 7115.41,-3713.31 7358.73,-3713.31"/>
<polygon fill="black" stroke="black" points="7358.76,-3716.81 7368.76,-3713.31 7358.76,-3709.81 7358.76,-3716.81"/>
</g>
<!-- cluster_items._iter_lots -->
<g id="node96" class="node">
<title>cluster_items._iter_lots</title>
<g id="a_node96"><a xlink:title="Return all lots with generated ids.">
<polygon fill="none" stroke="black" points="7742.5,-4233.31 7405.5,-4233.31 7405.5,-4195.31 7742.5,-4195.31 7742.5,-4233.31"/>
<text text-anchor="middle" x="7574" y="-4207.58" font-family="Times,serif" font-size="27.16">cluster_items._iter_lots</text>
</a>
</g>
</g>
<!-- cluster_items._iter_lots&#45;&gt;lot_io.read_lots -->
<g id="edge107" class="edge">
<title>cluster_items._iter_lots&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M7742.58,-4228.94C7882.55,-4237.11 8067.31,-4237.09 8119,-4186.31 8201.47,-4105.29 8109.15,-3773.44 8155,-3667.31 8250.19,-3446.98 8487.16,-3262.21 8576.33,-3198.28"/>
<polygon fill="black" stroke="black" points="8578.37,-3201.12 8584.49,-3192.47 8574.31,-3195.42 8578.37,-3201.12"/>
</g>
<!-- cluster_items._iter_lots&#45;&gt;lot_io.iter_lot_files -->
<g id="edge108" class="edge">
<title>cluster_items._iter_lots&#45;&gt;lot_io.iter_lot_files</title>
<path fill="none" stroke="black" d="M7742.53,-4225.01C7879.85,-4230.33 8060.7,-4228.34 8119,-4186.31 8154.62,-4160.63 8121.11,-4122.22 8155,-4094.31 8243.35,-4021.55 8374.3,-4004.02 8473.23,-4002.81"/>
<polygon fill="black" stroke="black" points="8473.33,-4006.31 8483.31,-4002.74 8473.28,-3999.31 8473.33,-4006.31"/>
</g>
<!-- cluster_items.collect_clusters -->
<g id="node97" class="node">
<title>cluster_items.collect_clusters</title>
<g id="a_node97"><a xlink:title="Return mapping of cluster name to lot ids.">
<polygon fill="none" stroke="black" points="6880.5,-4926.81 6059.5,-4926.81 6059.5,-4859.81 6880.5,-4859.81 6880.5,-4926.81"/>
<text text-anchor="middle" x="6470" y="-4879.8" font-family="Times,serif" font-size="53.76">cluster_items.collect_clusters</text>
</a>
</g>
</g>
<!-- cluster_items.collect_clusters&#45;&gt;similar_utils._load_embeddings -->
<g id="edge109" class="edge">
<title>cluster_items.collect_clusters&#45;&gt;similar_utils._load_embeddings</title>
<path fill="none" stroke="black" d="M6880.83,-4894.09C7214.32,-4893.63 7697.15,-4890.51 8119,-4878.31 8192.48,-4876.18 8272.08,-4872.78 8345.41,-4869.19"/>
<polygon fill="black" stroke="black" points="8345.9,-4872.67 8355.72,-4868.69 8345.56,-4865.68 8345.9,-4872.67"/>
</g>
<!-- cluster_items.collect_clusters&#45;&gt;similar_utils._cos_sim -->
<g id="edge110" class="edge">
<title>cluster_items.collect_clusters&#45;&gt;similar_utils._cos_sim</title>
<path fill="none" stroke="black" d="M6669.95,-4926.85C6776.21,-4943.59 6909.4,-4962.69 7029,-4974.31 7171.95,-4988.2 7336.76,-4995.11 7447.18,-4998.44"/>
<polygon fill="black" stroke="black" points="7447.26,-5001.94 7457.36,-4998.74 7447.47,-4994.94 7447.26,-5001.94"/>
</g>
<!-- cluster_items.collect_clusters&#45;&gt;similar_utils._sync_embeddings -->
<g id="edge111" class="edge">
<title>cluster_items.collect_clusters&#45;&gt;similar_utils._sync_embeddings</title>
<path fill="none" stroke="black" d="M6880.56,-4912.63C7029.88,-4919.68 7194.07,-4927.43 7325.08,-4933.61"/>
<polygon fill="black" stroke="black" points="7325.09,-4937.11 7335.25,-4934.09 7325.42,-4930.12 7325.09,-4937.11"/>
</g>
<!-- cluster_items.collect_clusters&#45;&gt;cluster_items._iter_lots -->
<g id="edge112" class="edge">
<title>cluster_items.collect_clusters&#45;&gt;cluster_items._iter_lots</title>
<path fill="none" stroke="black" d="M6869.04,-4859.77C6916.39,-4840.2 6959.66,-4812.39 6993,-4773.31 7069.76,-4683.33 6944.69,-4325.26 7029,-4242.31 7079.39,-4192.73 7256.47,-4191.51 7395.07,-4199.07"/>
<polygon fill="black" stroke="black" points="7395.22,-4202.59 7405.4,-4199.66 7395.62,-4195.6 7395.22,-4202.59"/>
</g>
<!-- cluster_items.main -->
<g id="node98" class="node">
<title>cluster_items.main</title>
<g id="a_node98"><a xlink:title="Cluster items and save the result.">
<polygon fill="none" stroke="black" points="5697.5,-4811.31 5489.5,-4811.31 5489.5,-4775.31 5697.5,-4775.31 5697.5,-4811.31"/>
<text text-anchor="middle" x="5593.5" y="-4788.52" font-family="Times,serif" font-size="19.74">cluster_items.main</text>
</a>
</g>
</g>
<!-- cluster_items.main&#45;&gt;notes_utils.write_json -->
<g id="edge113" class="edge">
<title>cluster_items.main&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M5697.61,-4793.33C5929.27,-4793.06 6508.58,-4790.53 6993,-4773.31 7493.94,-4755.5 7619.6,-4752.39 8119,-4709.31 8253.59,-4697.7 8408.28,-4678.87 8507.71,-4666.06"/>
<polygon fill="black" stroke="black" points="8508.29,-4669.51 8517.76,-4664.76 8507.39,-4662.57 8508.29,-4669.51"/>
</g>
<!-- cluster_items.main&#45;&gt;log_utils.install_excepthook -->
<g id="edge114" class="edge">
<title>cluster_items.main&#45;&gt;log_utils.install_excepthook</title>
<path fill="none" stroke="black" d="M5686.81,-4811.32C5759.15,-4819.52 5856.4,-4816.36 5911,-4755.31 5993.55,-4663 5861.36,-386.76 5947,-297.31 6065.63,-173.39 6293.71,-217.76 6404.9,-249.45"/>
<polygon fill="black" stroke="black" points="6404.06,-252.85 6414.64,-252.28 6406.02,-246.13 6404.06,-252.85"/>
</g>
<!-- cluster_items.main&#45;&gt;cluster_items.collect_clusters -->
<g id="edge115" class="edge">
<title>cluster_items.main&#45;&gt;cluster_items.collect_clusters</title>
<path fill="none" stroke="black" d="M5697.52,-4804.09C5759.42,-4810.64 5839.75,-4819.27 5911,-4827.31 5998.62,-4837.2 6093.93,-4848.33 6180.58,-4858.6"/>
<polygon fill="black" stroke="black" points="6180.22,-4862.08 6190.56,-4859.78 6181.04,-4855.13 6180.22,-4862.08"/>
</g>
<!-- build_site._load_ontology -->
<g id="node99" class="node">
<title>build_site._load_ontology</title>
<g id="a_node99"><a xlink:title="Return sorted field list from ``ONTOLOGY`` or empty list when missing.">
<polygon fill="none" stroke="black" points="8768.5,-3766.31 8455.5,-3766.31 8455.5,-3730.31 8768.5,-3730.31 8768.5,-3766.31"/>
<text text-anchor="middle" x="8612" y="-3742.72" font-family="Times,serif" font-size="23.24">build_site._load_ontology</text>
</a>
</g>
</g>
<!-- build_site._load_ontology&#45;&gt;notes_utils.load_json -->
<g id="edge116" class="edge">
<title>build_site._load_ontology&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M8768.59,-3746.2C8857.44,-3747.81 8970.43,-3754.62 9069,-3775.31 9187.42,-3800.17 9318.78,-3856.44 9386.85,-3887.92"/>
<polygon fill="black" stroke="black" points="9385.49,-3891.14 9396.03,-3892.19 9388.44,-3884.8 9385.49,-3891.14"/>
</g>
<!-- build_site._load_clusters -->
<g id="node100" class="node">
<title>build_site._load_clusters</title>
<g id="a_node100"><a xlink:title="Return precomputed item clusters.">
<polygon fill="none" stroke="black" points="8789.5,-3822.31 8434.5,-3822.31 8434.5,-3784.31 8789.5,-3784.31 8789.5,-3822.31"/>
<text text-anchor="middle" x="8612" y="-3796.58" font-family="Times,serif" font-size="27.16">build_site._load_clusters</text>
</a>
</g>
</g>
<!-- build_site._load_clusters&#45;&gt;notes_utils.load_json -->
<g id="edge117" class="edge">
<title>build_site._load_clusters&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M8789.76,-3810.82C8874.5,-3815.77 8977.29,-3823.73 9069,-3836.31 9165.69,-3849.57 9275.26,-3872.96 9348.8,-3889.91"/>
<polygon fill="black" stroke="black" points="9348.4,-3893.41 9358.93,-3892.25 9349.98,-3886.59 9348.4,-3893.41"/>
</g>
<!-- build_site._compile_locale -->
<g id="node101" class="node">
<title>build_site._compile_locale</title>
<g id="a_node101"><a xlink:title="Compile ``lang`` gettext catalogue when out of date.">
<polygon fill="none" stroke="black" points="6637,-621.31 6303,-621.31 6303,-585.31 6637,-585.31 6637,-621.31"/>
<text text-anchor="middle" x="6470" y="-597.43" font-family="Times,serif" font-size="24.22">build_site._compile_locale</text>
</a>
</g>
</g>
<!-- build_site._env_for_lang -->
<g id="node102" class="node">
<title>build_site._env_for_lang</title>
<g id="a_node102"><a xlink:title="Return Jinja environment configured for ``lang``.">
<polygon fill="none" stroke="black" points="5782,-623.81 5405,-623.81 5405,-582.81 5782,-582.81 5782,-623.81"/>
<text text-anchor="middle" x="5593.5" y="-596.06" font-family="Times,serif" font-size="29.68">build_site._env_for_lang</text>
</a>
</g>
</g>
<!-- build_site._env_for_lang&#45;&gt;build_site._compile_locale -->
<g id="edge118" class="edge">
<title>build_site._env_for_lang&#45;&gt;build_site._compile_locale</title>
<path fill="none" stroke="black" d="M5782.1,-603.31C5933.33,-603.31 6144.47,-603.31 6292.62,-603.31"/>
<polygon fill="black" stroke="black" points="6292.74,-606.81 6302.74,-603.31 6292.74,-599.81 6292.74,-606.81"/>
</g>
<!-- build_site._iter_lots -->
<g id="node103" class="node">
<title>build_site._iter_lots</title>
<g id="a_node103"><a xlink:title="Return all lots ready for rendering.">
<polygon fill="none" stroke="black" points="7800,-2877.81 7348,-2877.81 7348,-2820.81 7800,-2820.81 7800,-2877.81"/>
<text text-anchor="middle" x="7574" y="-2838.42" font-family="Times,serif" font-size="44.24">build_site._iter_lots</text>
</a>
</g>
</g>
<!-- build_site._iter_lots&#45;&gt;post_io.read_post -->
<g id="edge119" class="edge">
<title>build_site._iter_lots&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7755.73,-2877.83C7876.91,-2885.73 8030.05,-2871.91 8119,-2773.31 8193.4,-2690.84 8083.03,-1858.91 8155,-1774.31 8197.48,-1724.38 8258.89,-1696.97 8322.95,-1682.81"/>
<polygon fill="black" stroke="black" points="8323.77,-1686.22 8332.84,-1680.74 8322.33,-1679.37 8323.77,-1686.22"/>
</g>
<!-- build_site._iter_lots&#45;&gt;post_io.raw_post_path -->
<g id="edge120" class="edge">
<title>build_site._iter_lots&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7800.04,-2845.77C7899.22,-2849.01 8016.32,-2859.44 8119,-2886.31 8299.84,-2933.63 8494.69,-3047.35 8574.14,-3096.74"/>
<polygon fill="black" stroke="black" points="8572.47,-3099.83 8582.8,-3102.16 8576.18,-3093.89 8572.47,-3099.83"/>
</g>
<!-- build_site._iter_lots&#45;&gt;lot_io.read_lots -->
<g id="edge121" class="edge">
<title>build_site._iter_lots&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M7800.29,-2836.97C7928.76,-2835.1 8073.1,-2843.48 8119,-2886.31 8204.61,-2966.2 8069.04,-3067.8 8155,-3147.31 8258.99,-3243.49 8439.85,-3218.6 8539.7,-3194.77"/>
<polygon fill="black" stroke="black" points="8540.81,-3198.1 8549.69,-3192.32 8539.14,-3191.3 8540.81,-3198.1"/>
</g>
<!-- build_site._iter_lots&#45;&gt;lot_io.iter_lot_files -->
<g id="edge122" class="edge">
<title>build_site._iter_lots&#45;&gt;lot_io.iter_lot_files</title>
<path fill="none" stroke="black" d="M7800.34,-2835.45C7929.76,-2832.9 8075.11,-2841.09 8119,-2886.31 8192.18,-2961.71 8094.25,-3745.57 8155,-3831.31 8227.46,-3933.57 8367.43,-3977.74 8473.27,-3996.82"/>
<polygon fill="black" stroke="black" points="8472.95,-4000.32 8483.41,-3998.59 8474.16,-3993.42 8472.95,-4000.32"/>
</g>
<!-- moderation.should_skip_message -->
<g id="node104" class="node">
<title>moderation.should_skip_message</title>
<g id="a_node104"><a xlink:title="Return ``True`` when the raw Telegram message should be ignored.">
<polygon fill="none" stroke="black" points="8779,-1087.31 8445,-1087.31 8445,-1051.31 8779,-1051.31 8779,-1087.31"/>
<text text-anchor="middle" x="8612" y="-1064.52" font-family="Times,serif" font-size="18.48">moderation.should_skip_message</text>
</a>
</g>
</g>
<!-- build_site._iter_lots&#45;&gt;moderation.should_skip_message -->
<g id="edge123" class="edge">
<title>build_site._iter_lots&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M7751.82,-2877.82C7873.79,-2886.45 8029.53,-2873.52 8119,-2773.31 8170.89,-2715.19 8117.25,-1439.47 8155,-1371.31 8239.98,-1217.86 8439.77,-1128.61 8544.42,-1090.81"/>
<polygon fill="black" stroke="black" points="8545.69,-1094.08 8553.93,-1087.42 8543.34,-1087.48 8545.69,-1094.08"/>
</g>
<!-- moderation.should_skip_lot -->
<g id="node105" class="node">
<title>moderation.should_skip_lot</title>
<g id="a_node105"><a xlink:title="Return ``True`` when the lot fails additional checks.">
<polygon fill="none" stroke="black" points="8750,-2862.31 8474,-2862.31 8474,-2826.31 8750,-2826.31 8750,-2862.31"/>
<text text-anchor="middle" x="8612" y="-2839.52" font-family="Times,serif" font-size="18.48">moderation.should_skip_lot</text>
</a>
</g>
</g>
<!-- build_site._iter_lots&#45;&gt;moderation.should_skip_lot -->
<g id="edge124" class="edge">
<title>build_site._iter_lots&#45;&gt;moderation.should_skip_lot</title>
<path fill="none" stroke="black" d="M7800.12,-2848.22C8001.3,-2847.25 8290.27,-2845.86 8463.42,-2845.02"/>
<polygon fill="black" stroke="black" points="8463.65,-2848.52 8473.63,-2844.97 8463.62,-2841.52 8463.65,-2848.52"/>
</g>
<!-- moderation.message_skip_reason -->
<g id="node160" class="node">
<title>moderation.message_skip_reason</title>
<g id="a_node160"><a xlink:title="Return the moderation reason for ``meta`` and ``text`` or ``None``.">
<polygon fill="none" stroke="black" points="9729.5,-973.81 9139.5,-973.81 9139.5,-928.81 9729.5,-928.81 9729.5,-973.81"/>
<text text-anchor="middle" x="9434.5" y="-942.93" font-family="Times,serif" font-size="33.60">moderation.message_skip_reason</text>
</a>
</g>
</g>
<!-- moderation.should_skip_message&#45;&gt;moderation.message_skip_reason -->
<g id="edge258" class="edge">
<title>moderation.should_skip_message&#45;&gt;moderation.message_skip_reason</title>
<path fill="none" stroke="black" d="M8779.05,-1060.79C8865.77,-1055 8973.46,-1045.71 9069,-1031.31 9160.47,-1017.52 9263.3,-994.23 9336.36,-976.32"/>
<polygon fill="black" stroke="black" points="9337.59,-979.62 9346.46,-973.83 9335.92,-972.82 9337.59,-979.62"/>
</g>
<!-- moderation.lot_skip_reason -->
<g id="node161" class="node">
<title>moderation.lot_skip_reason</title>
<g id="a_node161"><a xlink:title="Return the moderation reason for ``lot`` or ``None``.">
<polygon fill="none" stroke="black" points="9611,-2853.31 9258,-2853.31 9258,-2817.31 9611,-2817.31 9611,-2853.31"/>
<text text-anchor="middle" x="9434.5" y="-2829.43" font-family="Times,serif" font-size="24.22">moderation.lot_skip_reason</text>
</a>
</g>
</g>
<!-- moderation.should_skip_lot&#45;&gt;moderation.lot_skip_reason -->
<g id="edge259" class="edge">
<title>moderation.should_skip_lot&#45;&gt;moderation.lot_skip_reason</title>
<path fill="none" stroke="black" d="M8750.33,-2842.8C8886.57,-2841.31 9096.3,-2839.01 9247.44,-2837.35"/>
<polygon fill="black" stroke="black" points="9247.81,-2840.85 9257.77,-2837.24 9247.73,-2833.85 9247.81,-2840.85"/>
</g>
<!-- build_site._copy_images -->
<g id="node106" class="node">
<title>build_site._copy_images</title>
<g id="a_node106"><a xlink:title="Copy media referenced by ``lots`` into ``VIEWS_DIR``.">
<polygon fill="none" stroke="black" points="6633.5,-943.31 6306.5,-943.31 6306.5,-907.31 6633.5,-907.31 6633.5,-943.31"/>
<text text-anchor="middle" x="6470" y="-919.15" font-family="Times,serif" font-size="25.20">build_site._copy_images</text>
</a>
</g>
</g>
<!-- build_site._copy_static -->
<g id="node107" class="node">
<title>build_site._copy_static</title>
<g id="a_node107"><a xlink:title="Copy CSS and JS so generated pages are standalone.">
<polygon fill="none" stroke="black" points="6598,-506.31 6342,-506.31 6342,-470.31 6598,-470.31 6598,-506.31"/>
<text text-anchor="middle" x="6470" y="-483.01" font-family="Times,serif" font-size="21.00">build_site._copy_static</text>
</a>
</g>
</g>
<!-- build_site._load_state -->
<g id="node108" class="node">
<title>build_site._load_state</title>
<g id="a_node108"><a xlink:title="Return ontology fields, embeddings, lots and similarity caches.">
<polygon fill="none" stroke="black" points="5784.5,-3811.81 5402.5,-3811.81 5402.5,-3766.81 5784.5,-3766.81 5784.5,-3811.81"/>
<text text-anchor="middle" x="5593.5" y="-3780.93" font-family="Times,serif" font-size="33.60">build_site._load_state</text>
</a>
</g>
</g>
<!-- build_site._load_state&#45;&gt;similar_utils._load_embeddings -->
<g id="edge125" class="edge">
<title>build_site._load_state&#45;&gt;similar_utils._load_embeddings</title>
<path fill="none" stroke="black" d="M5648.03,-3811.93C5720.8,-3845.72 5848.97,-3916.71 5911,-4020.31 5970.47,-4119.64 5869.46,-4192.33 5947,-4278.31 6267.67,-4633.9 6619.85,-4236.26 6993,-4536.31 7021.19,-4558.98 6998.66,-4589.6 7029,-4609.31 7130.65,-4675.33 8004.79,-4611.72 8119,-4652.31 8137.85,-4659.01 8137.5,-4669.63 8155,-4679.31 8278.82,-4747.75 8434.94,-4801.32 8528.66,-4830.32"/>
<polygon fill="black" stroke="black" points="8527.78,-4833.71 8538.37,-4833.31 8529.84,-4827.02 8527.78,-4833.71"/>
</g>
<!-- build_site._load_state&#45;&gt;similar_utils._load_similar -->
<g id="edge126" class="edge">
<title>build_site._load_state&#45;&gt;similar_utils._load_similar</title>
<path fill="none" stroke="black" d="M5636.81,-3811.9C5702.28,-3848.52 5829.11,-3926.32 5911,-4020.31 5933.21,-4045.8 5920.7,-4066.07 5947,-4087.31 6343.72,-4407.63 6966.02,-4455.51 7314.46,-4454.34"/>
<polygon fill="black" stroke="black" points="7314.71,-4457.84 7324.69,-4454.29 7314.68,-4450.84 7314.71,-4457.84"/>
</g>
<!-- build_site._load_state&#45;&gt;similar_utils._load_more_user -->
<g id="edge127" class="edge">
<title>build_site._load_state&#45;&gt;similar_utils._load_more_user</title>
<path fill="none" stroke="black" d="M5784.7,-3807.27C5837.26,-3812.04 5894.33,-3817.05 5947,-3821.31 6029.28,-3827.96 6118.92,-3834.55 6200.32,-3840.29"/>
<polygon fill="black" stroke="black" points="6200.5,-3843.81 6210.72,-3841.02 6200.99,-3836.82 6200.5,-3843.81"/>
</g>
<!-- build_site._load_state&#45;&gt;build_site._load_ontology -->
<g id="edge128" class="edge">
<title>build_site._load_state&#45;&gt;build_site._load_ontology</title>
<path fill="none" stroke="black" d="M5784.62,-3786.72C6335.39,-3779.24 7925.74,-3757.62 8444.91,-3750.57"/>
<polygon fill="black" stroke="black" points="8445.15,-3754.06 8455.1,-3750.43 8445.06,-3747.06 8445.15,-3754.06"/>
</g>
<!-- build_site._load_state&#45;&gt;build_site._load_clusters -->
<g id="edge129" class="edge">
<title>build_site._load_state&#45;&gt;build_site._load_clusters</title>
<path fill="none" stroke="black" d="M5784.62,-3790.19C6328.14,-3792.71 7884.04,-3799.93 8423.85,-3802.44"/>
<polygon fill="black" stroke="black" points="8424.05,-3805.94 8434.07,-3802.49 8424.08,-3798.94 8424.05,-3805.94"/>
</g>
<!-- build_site._load_state&#45;&gt;build_site._iter_lots -->
<g id="edge130" class="edge">
<title>build_site._load_state&#45;&gt;build_site._iter_lots</title>
<path fill="none" stroke="black" d="M5784.84,-3785.54C5828.82,-3777.92 5873.62,-3764.17 5911,-3740.31 5935.31,-3724.79 5923.94,-3703.63 5947,-3686.31 6336.78,-3393.55 6689.97,-3738.15 6993,-3356.31 7058.12,-3274.26 6954.61,-2960.06 7029,-2886.31 7072.52,-2843.15 7211.21,-2834.19 7337.64,-2835.87"/>
<polygon fill="black" stroke="black" points="7337.83,-2839.37 7347.89,-2836.03 7337.94,-2832.37 7337.83,-2839.37"/>
</g>
<!-- build_site._load_state&#45;&gt;build_site._copy_images -->
<g id="edge131" class="edge">
<title>build_site._load_state&#45;&gt;build_site._copy_images</title>
<path fill="none" stroke="black" d="M5784.72,-3801.19C5832.57,-3794.19 5879.28,-3776.83 5911,-3740.31 5961.78,-3681.83 5893.31,-1008.13 5947,-952.31 6065.78,-828.83 6293.28,-872.8 6404.53,-904.39"/>
<polygon fill="black" stroke="black" points="6403.7,-907.79 6414.28,-907.21 6405.65,-901.07 6403.7,-907.79"/>
</g>
<!-- build_site._categorise -->
<g id="node109" class="node">
<title>build_site._categorise</title>
<g id="a_node109"><a xlink:title="Return category info and recent lot list.&#10;&#10;Categories are split by ``market:deal``. ``sell_item`` lots are further&#10;grouped by ``clusters`` when available and fall back to ``item:type``.&#10;Stats include price range, last timestamp and embedding centroid so the&#10;sorting logic used on item pages also works for categories.">
<polygon fill="none" stroke="black" points="8059.5,-573.81 7088.5,-573.81 7088.5,-470.81 8059.5,-470.81 8059.5,-573.81"/>
<text text-anchor="middle" x="7574" y="-500.37" font-family="Times,serif" font-size="86.80">build_site._categorise</text>
</a>
</g>
</g>
<!-- build_site._categorise&#45;&gt;lot_io.get_seller -->
<g id="edge132" class="edge">
<title>build_site._categorise&#45;&gt;lot_io.get_seller</title>
<path fill="none" stroke="black" d="M7780.59,-573.84C7882.62,-599.96 8007.59,-632.76 8119,-664.31 8135.1,-668.87 8138.58,-672.12 8155,-675.31 8271.92,-698.04 8408.24,-707.87 8501.17,-712.1"/>
<polygon fill="black" stroke="black" points="8501.29,-715.61 8511.43,-712.56 8501.6,-708.62 8501.29,-715.61"/>
</g>
<!-- build_site._render_site -->
<g id="node110" class="node">
<title>build_site._render_site</title>
<g id="a_node110"><a xlink:title="Render all HTML pages for ``lots`` using cached templates.&#10;&#10;``envs`` supplies jinja environments for every language so they are&#10;initialised only once. ``rates`` maps currency codes to multipliers relative&#10;to USD. &#160;The values are embedded into the pages so the front&#45;end can&#10;convert prices on the fly.">
<polygon fill="none" stroke="black" points="6993,-825.81 5947,-825.81 5947,-718.81 6993,-718.81 6993,-825.81"/>
<text text-anchor="middle" x="6470" y="-749.68" font-family="Times,serif" font-size="90.16">build_site._render_site</text>
</a>
</g>
</g>
<!-- build_site._render_site&#45;&gt;similar_utils._format_vector -->
<g id="edge133" class="edge">
<title>build_site._render_site&#45;&gt;similar_utils._format_vector</title>
<path fill="none" stroke="black" d="M6993.13,-792.12C7473.73,-810.61 8113.3,-836 8119,-840.31 8160.02,-871.35 8115.2,-917.72 8155,-950.31 8247.28,-1025.88 8387.44,-1031.56 8488,-1023.24"/>
<polygon fill="black" stroke="black" points="8488.57,-1026.7 8498.22,-1022.33 8487.95,-1019.73 8488.57,-1026.7"/>
</g>
<!-- build_site._render_site&#45;&gt;notes_utils.read_text -->
<g id="edge134" class="edge">
<title>build_site._render_site&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M6993.01,-768.44C7392.22,-767.4 7908.72,-770.74 8119,-792.31 8546.91,-836.21 8663.58,-833.55 9069,-977.31 9398.81,-1094.26 9569.52,-1056.4 9764,-1347.31 9945.52,-1618.83 10053.28,-4132.44 10065.36,-4427.98"/>
<polygon fill="black" stroke="black" points="10061.88,-4428.42 10065.78,-4438.27 10068.87,-4428.13 10061.88,-4428.42"/>
</g>
<!-- build_site._render_site&#45;&gt;lot_io.get_seller -->
<g id="edge135" class="edge">
<title>build_site._render_site&#45;&gt;lot_io.get_seller</title>
<path fill="none" stroke="black" d="M6898.98,-718.76C6930.83,-714.1 6962.44,-709.26 6993,-704.31 7009.09,-701.7 7012.78,-698.87 7029,-697.31 7511.21,-650.86 7634.64,-688.45 8119,-697.31 8250.37,-699.71 8401.37,-705.72 8501.06,-710.13"/>
<polygon fill="black" stroke="black" points="8501,-713.64 8511.15,-710.58 8501.31,-706.64 8501,-713.64"/>
</g>
<!-- build_site.build_page -->
<g id="node111" class="node">
<title>build_site.build_page</title>
<g id="a_node111"><a xlink:title="Render ``lot`` into separate HTML files for every language.&#10;&#10;``rates`` provides currency multipliers used by the front&#45;end for dynamic&#10;conversion. ``envs`` preloads jinja environments to avoid expensive&#10;reinitialisation for each page.">
<polygon fill="none" stroke="black" points="8043.5,-1468.31 7104.5,-1468.31 7104.5,-1366.31 8043.5,-1366.31 8043.5,-1468.31"/>
<text text-anchor="middle" x="7574" y="-1395.76" font-family="Times,serif" font-size="85.68">build_site.build_page</text>
</a>
</g>
</g>
<!-- build_site._render_site&#45;&gt;build_site.build_page -->
<g id="edge136" class="edge">
<title>build_site._render_site&#45;&gt;build_site.build_page</title>
<path fill="none" stroke="black" d="M6899.25,-825.92C6934.59,-844.34 6966.75,-868.01 6993,-898.31 7048.83,-962.75 6973.48,-1215.59 7029,-1280.31 7058.76,-1315 7095.89,-1341.58 7136.69,-1361.85"/>
<polygon fill="black" stroke="black" points="7135.2,-1365.02 7145.73,-1366.21 7138.25,-1358.71 7135.2,-1365.02"/>
</g>
<!-- build_site.build_page&#45;&gt;similar_utils._format_vector -->
<g id="edge137" class="edge">
<title>build_site.build_page&#45;&gt;similar_utils._format_vector</title>
<path fill="none" stroke="black" d="M7996.27,-1366.26C8042.51,-1345.59 8085.04,-1317.72 8119,-1280.31 8190.91,-1201.1 8076.86,-1115.38 8155,-1042.31 8255.65,-948.18 8429.28,-964.17 8530.77,-984.26"/>
<polygon fill="black" stroke="black" points="8530.16,-987.71 8540.66,-986.28 8531.56,-980.85 8530.16,-987.71"/>
</g>
<!-- build_site.build_page&#45;&gt;post_io.read_post -->
<g id="edge138" class="edge">
<title>build_site.build_page&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M8043.53,-1432.89C8070.81,-1445.77 8096.32,-1462.01 8119,-1482.31 8171.38,-1529.18 8102.25,-1589.86 8155,-1636.31 8201.33,-1677.1 8261.44,-1697.49 8322.73,-1706.09"/>
<polygon fill="black" stroke="black" points="8322.6,-1709.6 8332.97,-1707.42 8323.5,-1702.66 8322.6,-1709.6"/>
</g>
<!-- build_site.build_page&#45;&gt;post_io.raw_post_path -->
<g id="edge139" class="edge">
<title>build_site.build_page&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M8043.58,-1454.04C8071.79,-1470.06 8097.43,-1490.19 8119,-1515.31 8168.1,-1572.48 8115.69,-2807.01 8155,-2871.31 8236.79,-3005.08 8417.74,-3071.99 8525.49,-3101.16"/>
<polygon fill="black" stroke="black" points="8524.79,-3104.6 8535.36,-3103.78 8526.59,-3097.83 8524.79,-3104.6"/>
</g>
<!-- build_site.build_page&#45;&gt;caption_io.read_caption -->
<g id="edge140" class="edge">
<title>build_site.build_page&#45;&gt;caption_io.read_caption</title>
<path fill="none" stroke="black" d="M8043.58,-1456.72C8071.5,-1472.19 8097.09,-1491.46 8119,-1515.31 8176.98,-1578.43 8093.56,-1839.55 8155,-1899.31 8194.44,-1937.67 8324.98,-1943.27 8436.34,-1940.35"/>
<polygon fill="black" stroke="black" points="8436.47,-1943.85 8446.37,-1940.06 8436.27,-1936.85 8436.47,-1943.85"/>
</g>
<!-- build_site.main -->
<g id="node112" class="node">
<title>build_site.main</title>
<g id="a_node112"><a xlink:title="Build the static site under ``VIEWS_DIR``.">
<polygon fill="none" stroke="black" points="5204.5,-603.81 4786.5,-603.81 4786.5,-538.81 5204.5,-538.81 5204.5,-603.81"/>
<text text-anchor="middle" x="4995.5" y="-558.26" font-family="Times,serif" font-size="51.94">build_site.main</text>
</a>
</g>
</g>
<!-- build_site.main&#45;&gt;similar_utils._sync_embeddings -->
<g id="edge141" class="edge">
<title>build_site.main&#45;&gt;similar_utils._sync_embeddings</title>
<path fill="none" stroke="black" d="M5010.03,-604.1C5053.99,-712.52 5192.6,-1070.29 5240,-1381.31 5247.2,-1428.53 5244.22,-4784.65 5276,-4820.31 5370.63,-4926.48 5782.83,-4838.66 5911,-4900.31 5931.11,-4909.98 5926.35,-4926.85 5947,-4935.31 6070.69,-4985.97 6901.37,-4967.14 7325.22,-4953.92"/>
<polygon fill="black" stroke="black" points="7325.58,-4957.41 7335.47,-4953.6 7325.36,-4950.41 7325.58,-4957.41"/>
</g>
<!-- build_site.main&#45;&gt;config_utils.load_config -->
<g id="edge142" class="edge">
<title>build_site.main&#45;&gt;config_utils.load_config</title>
<path fill="none" stroke="black" d="M5062.66,-538.8C5118.13,-513.37 5200.21,-479.95 5276,-465.31 5796.69,-364.69 5938.68,-442.31 6469,-442.31 6469,-442.31 6469,-442.31 8613,-442.31 9158.01,-442.31 9334.51,-529.8 9764,-865.31 9786.44,-882.84 9775.7,-903.46 9800,-918.31 9812.89,-926.19 9826.78,-932.6 9841.23,-937.79"/>
<polygon fill="black" stroke="black" points="9840.19,-941.14 9850.79,-941.03 9842.44,-934.51 9840.19,-941.14"/>
</g>
<!-- build_site.main&#45;&gt;price_utils.canonical_currency -->
<g id="edge143" class="edge">
<title>build_site.main&#45;&gt;price_utils.canonical_currency</title>
<path fill="none" stroke="black" d="M5007.66,-538.66C5037.26,-457.33 5125.92,-244.88 5276,-142.31 5527.52,29.59 5643.97,-33.58 5947,-2.31 6012.61,4.46 8115.78,-6 8119,-6.31 8264.11,-20.02 8430.29,-55.26 8527.63,-77.93"/>
<polygon fill="black" stroke="black" points="8526.87,-81.35 8537.41,-80.22 8528.47,-74.53 8526.87,-81.35"/>
</g>
<!-- build_site.main&#45;&gt;price_utils.fetch_official_rates -->
<g id="edge144" class="edge">
<title>build_site.main&#45;&gt;price_utils.fetch_official_rates</title>
<path fill="none" stroke="black" d="M5204.53,-559.79C5224.45,-558.69 5244.95,-557.55 5265.64,-556.41"/>
<polygon fill="black" stroke="black" points="5266.02,-559.89 5275.81,-555.84 5265.63,-552.9 5266.02,-559.89"/>
</g>
<!-- build_site.main&#45;&gt;price_utils.load_price_model -->
<g id="edge145" class="edge">
<title>build_site.main&#45;&gt;price_utils.load_price_model</title>
<path fill="none" stroke="black" d="M5009.98,-604.1C5053.77,-712.55 5191.93,-1070.39 5240,-1381.31 5250.35,-1448.27 5230.23,-3770.34 5276,-3820.31 5399.12,-3954.73 5913.61,-3951.89 6225.35,-3936.78"/>
<polygon fill="black" stroke="black" points="6225.61,-3940.27 6235.43,-3936.29 6225.27,-3933.28 6225.61,-3940.27"/>
</g>
<!-- build_site.main&#45;&gt;price_utils.apply_price_model -->
<g id="edge146" class="edge">
<title>build_site.main&#45;&gt;price_utils.apply_price_model</title>
<path fill="none" stroke="black" d="M5045.51,-538.58C5099.46,-504.44 5189.97,-452.58 5276,-428.31 5544.67,-352.52 5860.01,-330.95 6098.99,-327.56"/>
<polygon fill="black" stroke="black" points="6099.28,-331.05 6109.24,-327.42 6099.19,-324.05 6099.28,-331.05"/>
</g>
<!-- build_site.main&#45;&gt;price_utils.prepare_price_fields -->
<g id="edge147" class="edge">
<title>build_site.main&#45;&gt;price_utils.prepare_price_fields</title>
<path fill="none" stroke="black" d="M5025.41,-538.68C5072.77,-487.19 5172.07,-387.2 5276,-331.31 5549.08,-184.45 5640.49,-187.13 5947,-140.31 6066.34,-122.08 6751.81,-109.46 7193.8,-103.09"/>
<polygon fill="black" stroke="black" points="7193.92,-106.59 7203.87,-102.95 7193.82,-99.59 7193.92,-106.59"/>
</g>
<!-- build_site.main&#45;&gt;build_site._env_for_lang -->
<g id="edge148" class="edge">
<title>build_site.main&#45;&gt;build_site._env_for_lang</title>
<path fill="none" stroke="black" d="M5204.53,-582.48C5266.25,-585.79 5333.64,-589.41 5394.68,-592.69"/>
<polygon fill="black" stroke="black" points="5394.64,-596.19 5404.82,-593.23 5395.02,-589.2 5394.64,-596.19"/>
</g>
<!-- build_site.main&#45;&gt;build_site._copy_static -->
<g id="edge149" class="edge">
<title>build_site.main&#45;&gt;build_site._copy_static</title>
<path fill="none" stroke="black" d="M5103.58,-538.74C5155.17,-524.63 5218.24,-509.68 5276,-502.31 5655.67,-453.87 6108.81,-468.07 6331.54,-479.71"/>
<polygon fill="black" stroke="black" points="6331.48,-483.21 6341.65,-480.25 6331.85,-476.22 6331.48,-483.21"/>
</g>
<!-- build_site.main&#45;&gt;build_site._load_state -->
<g id="edge150" class="edge">
<title>build_site.main&#45;&gt;build_site._load_state</title>
<path fill="none" stroke="black" d="M5009.98,-604.1C5053.74,-712.56 5191.85,-1070.41 5240,-1381.31 5250.03,-1446.07 5232.97,-3690.88 5276,-3740.31 5305.53,-3774.23 5347.99,-3791.61 5392.27,-3799.51"/>
<polygon fill="black" stroke="black" points="5391.91,-3803 5402.34,-3801.14 5393.03,-3796.09 5391.91,-3803"/>
</g>
<!-- build_site.main&#45;&gt;build_site._categorise -->
<g id="edge151" class="edge">
<title>build_site.main&#45;&gt;build_site._categorise</title>
<path fill="none" stroke="black" d="M5118.36,-603.86C5167.01,-615.29 5223.78,-626.68 5276,-632.31 5556.59,-662.57 5628.78,-632.57 5911,-632.31 6151.44,-632.09 6774.65,-730.98 6993,-630.31 7015.33,-620.01 7007.32,-599.91 7029,-588.31 7045.01,-579.74 7061.66,-572.08 7078.76,-565.24"/>
<polygon fill="black" stroke="black" points="7080.26,-568.42 7088.31,-561.53 7077.72,-561.89 7080.26,-568.42"/>
</g>
<!-- build_site.main&#45;&gt;build_site._render_site -->
<g id="edge152" class="edge">
<title>build_site.main&#45;&gt;build_site._render_site</title>
<path fill="none" stroke="black" d="M5075.5,-603.82C5130.71,-625.13 5206.68,-651.67 5276,-666.31 5489.68,-711.44 5728.84,-737.38 5936.6,-752.28"/>
<polygon fill="black" stroke="black" points="5936.56,-755.78 5946.78,-753 5937.05,-748.8 5936.56,-755.78"/>
</g>
<!-- phone_utils.format_georgian -->
<g id="node113" class="node">
<title>phone_utils.format_georgian</title>
<g id="a_node113"><a xlink:title="Return ``phone`` in ``+995...`` format if possible.">
<polygon fill="none" stroke="black" points="7780,-3347.31 7368,-3347.31 7368,-3309.31 7780,-3309.31 7780,-3347.31"/>
<text text-anchor="middle" x="7574" y="-3321.58" font-family="Times,serif" font-size="27.16">phone_utils.format_georgian</text>
</a>
</g>
</g>
<!-- tg_client._mark_activity -->
<g id="node114" class="node">
<title>tg_client._mark_activity</title>
<g id="a_node114"><a xlink:title="Update ``_last_event`` to the current time.">
<polygon fill="none" stroke="black" points="5088.5,-1426.31 4902.5,-1426.31 4902.5,-1390.31 5088.5,-1390.31 5088.5,-1426.31"/>
<text text-anchor="middle" x="4995.5" y="-1404.61" font-family="Times,serif" font-size="14.00">tg_client._mark_activity</text>
</a>
</g>
</g>
<!-- tg_client._heartbeat -->
<g id="node115" class="node">
<title>tg_client._heartbeat</title>
<g id="a_node115"><a xlink:title="Periodically log a heartbeat and warn if idle for too long.">
<polygon fill="none" stroke="black" points="1490.5,-1278.31 1260.5,-1278.31 1260.5,-1242.31 1490.5,-1242.31 1490.5,-1278.31"/>
<text text-anchor="middle" x="1375.5" y="-1255.01" font-family="Times,serif" font-size="21.00">tg_client._heartbeat</text>
</a>
</g>
</g>
<!-- tg_client._progress_logger -->
<g id="node116" class="node">
<title>tg_client._progress_logger</title>
<g id="a_node116"><a xlink:title="Return a progress callback that logs received bytes.">
<polygon fill="none" stroke="black" points="5179,-2258.81 4812,-2258.81 4812,-2221.81 5179,-2221.81 5179,-2258.81"/>
<text text-anchor="middle" x="4995.5" y="-2233.86" font-family="Times,serif" font-size="26.18">tg_client._progress_logger</text>
</a>
</g>
</g>
<!-- tg_client._write_md -->
<g id="node117" class="node">
<title>tg_client._write_md</title>
<g id="a_node117"><a xlink:title="Helper to store a raw post in Markdown format.">
<polygon fill="none" stroke="black" points="5662,-2300.31 5525,-2300.31 5525,-2264.31 5662,-2264.31 5662,-2300.31"/>
<text text-anchor="middle" x="5593.5" y="-2279.06" font-family="Times,serif" font-size="12.18">tg_client._write_md</text>
</a>
</g>
</g>
<!-- tg_client._write_md&#45;&gt;post_io.write_post -->
<g id="edge153" class="edge">
<title>tg_client._write_md&#45;&gt;post_io.write_post</title>
<path fill="none" stroke="black" d="M5662.03,-2282.15C5796.11,-2281.85 6099.71,-2281.15 6293.92,-2280.71"/>
<polygon fill="black" stroke="black" points="6293.96,-2284.21 6303.95,-2280.69 6293.94,-2277.21 6293.96,-2284.21"/>
</g>
<!-- tg_client._scan_group_cache -->
<g id="node118" class="node">
<title>tg_client._scan_group_cache</title>
<g id="a_node118"><a xlink:title="Build group_id &#45;&gt; Path mapping for ``chat`` quickly.">
<polygon fill="none" stroke="black" points="7813.5,-3290.81 7334.5,-3290.81 7334.5,-3247.81 7813.5,-3247.81 7813.5,-3290.81"/>
<text text-anchor="middle" x="7574" y="-3261.16" font-family="Times,serif" font-size="32.06">tg_client._scan_group_cache</text>
</a>
</g>
</g>
<!-- tg_client._scan_group_cache&#45;&gt;post_io.raw_post_path -->
<g id="edge154" class="edge">
<title>tg_client._scan_group_cache&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7813.66,-3277.71C7936.35,-3277.34 8070.19,-3268.17 8119,-3233.31 8152.72,-3209.23 8121.2,-3171.27 8155,-3147.31 8263.83,-3070.15 8426.54,-3082.73 8525.32,-3100.44"/>
<polygon fill="black" stroke="black" points="8524.79,-3103.9 8535.26,-3102.28 8526.07,-3097.02 8524.79,-3103.9"/>
</g>
<!-- tg_client._find_group_path -->
<g id="node119" class="node">
<title>tg_client._find_group_path</title>
<g id="a_node119"><a xlink:title="Return stored message path for ``group_id`` if known.">
<polygon fill="none" stroke="black" points="6603,-3259.31 6337,-3259.31 6337,-3223.31 6603,-3223.31 6603,-3259.31"/>
<text text-anchor="middle" x="6470" y="-3236.52" font-family="Times,serif" font-size="18.48">tg_client._find_group_path</text>
</a>
</g>
</g>
<!-- tg_client._find_group_path&#45;&gt;tg_client._scan_group_cache -->
<g id="edge155" class="edge">
<title>tg_client._find_group_path&#45;&gt;tg_client._scan_group_cache</title>
<path fill="none" stroke="black" d="M6603.11,-3244.66C6780.85,-3249.18 7100.47,-3257.3 7324.06,-3262.98"/>
<polygon fill="black" stroke="black" points="7324.21,-3266.49 7334.3,-3263.24 7324.39,-3259.49 7324.21,-3266.49"/>
</g>
<!-- tg_client._get_message_path -->
<g id="node120" class="node">
<title>tg_client._get_message_path</title>
<g id="a_node120"><a xlink:title="Return path of stored message ``msg_id`` in ``chat`` if any.">
<polygon fill="none" stroke="black" points="3380,-2940.31 3141,-2940.31 3141,-2904.31 3380,-2904.31 3380,-2940.31"/>
<text text-anchor="middle" x="3260.5" y="-2918.26" font-family="Times,serif" font-size="15.68">tg_client._get_message_path</text>
</a>
</g>
</g>
<!-- tg_client._get_message_path&#45;&gt;post_io.raw_post_path -->
<g id="edge156" class="edge">
<title>tg_client._get_message_path&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M3300.19,-2940.35C3484.54,-3024.6 4294.02,-3375.31 4994.5,-3375.31 4994.5,-3375.31 4994.5,-3375.31 6471,-3375.31 6562.56,-3375.31 8049.32,-3415.7 8119,-3356.31 8190.73,-3295.16 8084.74,-3210.14 8155,-3147.31 8259.87,-3053.52 8438.38,-3076.75 8538.11,-3099.86"/>
<polygon fill="black" stroke="black" points="8537.56,-3103.33 8548.1,-3102.24 8539.18,-3096.52 8537.56,-3103.33"/>
</g>
<!-- tg_client._should_skip_media -->
<g id="node121" class="node">
<title>tg_client._should_skip_media</title>
<g id="a_node121"><a xlink:title="Return reason string if ``msg`` media should be skipped.">
<polygon fill="none" stroke="black" points="5240,-2402.81 4751,-2402.81 4751,-2359.81 5240,-2359.81 5240,-2402.81"/>
<text text-anchor="middle" x="4995.5" y="-2373.16" font-family="Times,serif" font-size="32.06">tg_client._should_skip_media</text>
</a>
</g>
</g>
<!-- tg_client._allowed_topic -->
<g id="node122" class="node">
<title>tg_client._allowed_topic</title>
<g id="a_node122"><a xlink:title="Return ``True`` if ``msg`` belongs to an allowed forum topic.">
<polygon fill="none" stroke="black" points="5805.5,-3344.81 5381.5,-3344.81 5381.5,-3299.81 5805.5,-3299.81 5805.5,-3344.81"/>
<text text-anchor="middle" x="5593.5" y="-3313.93" font-family="Times,serif" font-size="33.60">tg_client._allowed_topic</text>
</a>
</g>
</g>
<!-- tg_client._extract_author -->
<g id="node123" class="node">
<title>tg_client._extract_author</title>
<g id="a_node123"><a xlink:title="Return a metadata dictionary describing the message author.">
<polygon fill="none" stroke="black" points="6833,-3347.31 6107,-3347.31 6107,-3277.31 6833,-3277.31 6833,-3347.31"/>
<text text-anchor="middle" x="6470" y="-3298.51" font-family="Times,serif" font-size="56.00">tg_client._extract_author</text>
</a>
</g>
</g>
<!-- tg_client._extract_author&#45;&gt;phone_utils.format_georgian -->
<g id="edge157" class="edge">
<title>tg_client._extract_author&#45;&gt;phone_utils.format_georgian</title>
<path fill="none" stroke="black" d="M6833.36,-3317.57C7006.75,-3320.09 7208.49,-3323.02 7357.44,-3325.18"/>
<polygon fill="black" stroke="black" points="7357.57,-3328.68 7367.62,-3325.33 7357.67,-3321.68 7357.57,-3328.68"/>
</g>
<!-- tg_client._schedule_caption -->
<g id="node124" class="node">
<title>tg_client._schedule_caption</title>
<g id="a_node124"><a xlink:title="Run captioning in a separate process so downloads continue.">
<polygon fill="none" stroke="black" points="7713,-3191.31 7435,-3191.31 7435,-3155.31 7713,-3155.31 7713,-3191.31"/>
<text text-anchor="middle" x="7574" y="-3168.52" font-family="Times,serif" font-size="18.48">tg_client._schedule_caption</text>
</a>
</g>
</g>
<!-- tg_client._schedule_chop -->
<g id="node125" class="node">
<title>tg_client._schedule_chop</title>
<g id="a_node125"><a xlink:title="Run lot extraction in a separate process.">
<polygon fill="none" stroke="black" points="8760,-1627.31 8464,-1627.31 8464,-1591.31 8760,-1591.31 8760,-1627.31"/>
<text text-anchor="middle" x="8612" y="-1603.61" font-family="Times,serif" font-size="22.12">tg_client._schedule_chop</text>
</a>
</g>
</g>
<!-- tg_client._enqueue_chop -->
<g id="node126" class="node">
<title>tg_client._enqueue_chop</title>
<g id="a_node126"><a xlink:title="Queue ``path`` for chopping once captions are available.">
<polygon fill="none" stroke="black" points="5238,-1614.81 4753,-1614.81 4753,-1565.81 5238,-1565.81 5238,-1614.81"/>
<text text-anchor="middle" x="4995.5" y="-1580.68" font-family="Times,serif" font-size="37.66">tg_client._enqueue_chop</text>
</a>
</g>
</g>
<!-- tg_client._enqueue_chop&#45;&gt;caption_io.has_caption -->
<g id="edge158" class="edge">
<title>tg_client._enqueue_chop&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M5238.27,-1589.77C5929.39,-1590.12 7879.21,-1604.93 8119,-1759.31 8148.08,-1778.03 8126.32,-1808.98 8155,-1828.31 8265.2,-1902.58 8425.8,-1898.64 8524.07,-1886.95"/>
<polygon fill="black" stroke="black" points="8524.77,-1890.39 8534.26,-1885.68 8523.91,-1883.44 8524.77,-1890.39"/>
</g>
<!-- tg_client._enqueue_chop&#45;&gt;moderation.should_skip_message -->
<g id="edge160" class="edge">
<title>tg_client._enqueue_chop&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M5096.28,-1565.78C5147.92,-1547.69 5206.92,-1517.43 5240,-1468.31 5296.54,-1384.37 5207.81,-1089.09 5276,-1014.31 5479.93,-790.69 5645.46,-924.18 5947,-898.31 6010.57,-892.85 8113.6,-895.18 8119,-899.31 8167.31,-936.24 8108.25,-992.42 8155,-1031.31 8196.9,-1066.16 8324.89,-1074.57 8434.65,-1074.87"/>
<polygon fill="black" stroke="black" points="8434.87,-1078.37 8444.87,-1074.87 8434.87,-1071.37 8434.87,-1078.37"/>
</g>
<!-- tg_client._start_chop_worker -->
<g id="node127" class="node">
<title>tg_client._start_chop_worker</title>
<g id="a_node127"><a xlink:title="Ensure the chop queue worker task is running.">
<polygon fill="none" stroke="black" points="5726.5,-1576.31 5460.5,-1576.31 5460.5,-1540.31 5726.5,-1540.31 5726.5,-1576.31"/>
<text text-anchor="middle" x="5593.5" y="-1554.14" font-family="Times,serif" font-size="17.08">tg_client._start_chop_worker</text>
</a>
</g>
</g>
<!-- tg_client._enqueue_chop&#45;&gt;tg_client._start_chop_worker -->
<g id="edge159" class="edge">
<title>tg_client._enqueue_chop&#45;&gt;tg_client._start_chop_worker</title>
<path fill="none" stroke="black" d="M5238.06,-1577.34C5310.03,-1573.47 5386.57,-1569.36 5450.04,-1565.96"/>
<polygon fill="black" stroke="black" points="5450.31,-1569.45 5460.11,-1565.42 5449.93,-1562.46 5450.31,-1569.45"/>
</g>
<!-- tg_client._chop_worker -->
<g id="node128" class="node">
<title>tg_client._chop_worker</title>
<g id="a_node128"><a xlink:title="Background task processing ``_CHOP_QUEUE``.">
<polygon fill="none" stroke="black" points="6595.5,-1560.31 6344.5,-1560.31 6344.5,-1524.31 6595.5,-1524.31 6595.5,-1560.31"/>
<text text-anchor="middle" x="6470" y="-1537.52" font-family="Times,serif" font-size="19.74">tg_client._chop_worker</text>
</a>
</g>
</g>
<!-- tg_client._start_chop_worker&#45;&gt;tg_client._chop_worker -->
<g id="edge161" class="edge">
<title>tg_client._start_chop_worker&#45;&gt;tg_client._chop_worker</title>
<path fill="none" stroke="black" d="M5726.84,-1555.89C5890.88,-1552.89 6168.94,-1547.8 6334.14,-1544.78"/>
<polygon fill="black" stroke="black" points="6334.43,-1548.27 6344.36,-1544.59 6334.3,-1541.27 6334.43,-1548.27"/>
</g>
<!-- tg_client._process_chop_queue -->
<g id="node129" class="node">
<title>tg_client._process_chop_queue</title>
<g id="a_node129"><a xlink:title="Check queued posts and chop cooled down ones.">
<polygon fill="none" stroke="black" points="7755.5,-1560.31 7392.5,-1560.31 7392.5,-1524.31 7755.5,-1524.31 7755.5,-1560.31"/>
<text text-anchor="middle" x="7574" y="-1536.61" font-family="Times,serif" font-size="22.12">tg_client._process_chop_queue</text>
</a>
</g>
</g>
<!-- tg_client._chop_worker&#45;&gt;tg_client._process_chop_queue -->
<g id="edge164" class="edge">
<title>tg_client._chop_worker&#45;&gt;tg_client._process_chop_queue</title>
<path fill="none" stroke="black" d="M6595.54,-1542.31C6787.32,-1542.31 7156.35,-1542.31 7382.04,-1542.31"/>
<polygon fill="black" stroke="black" points="7382.35,-1545.81 7392.35,-1542.31 7382.35,-1538.81 7382.35,-1545.81"/>
</g>
<!-- tg_client._process_chop_queue&#45;&gt;caption_io.has_caption -->
<g id="edge162" class="edge">
<title>tg_client._process_chop_queue&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M7667.1,-1524.29C7787.95,-1506.47 7998.74,-1496.44 8119,-1612.31 8189.09,-1679.84 8083.85,-1761.9 8155,-1828.31 8206.77,-1876.62 8407.13,-1879.01 8524.33,-1875.99"/>
<polygon fill="black" stroke="black" points="8524.46,-1879.49 8534.36,-1875.71 8524.27,-1872.49 8524.46,-1879.49"/>
</g>
<!-- tg_client._process_chop_queue&#45;&gt;tg_client._schedule_chop -->
<g id="edge163" class="edge">
<title>tg_client._process_chop_queue&#45;&gt;tg_client._schedule_chop</title>
<path fill="none" stroke="black" d="M7755.79,-1551.84C7861.68,-1557.69 7997.97,-1565.71 8119,-1574.31 8135.02,-1575.45 8138.99,-1576.08 8155,-1577.31 8254.34,-1584.93 8365.9,-1592.77 8453.82,-1598.79"/>
<polygon fill="black" stroke="black" points="8453.66,-1602.28 8463.87,-1599.47 8454.14,-1595.3 8453.66,-1602.28"/>
</g>
<!-- tg_client._flush_chop_queue -->
<g id="node130" class="node">
<title>tg_client._flush_chop_queue</title>
<g id="a_node130"><a xlink:title="Run the chop worker until the queue is empty and cancel it.">
<polygon fill="none" stroke="black" points="2253,-1378.31 1768,-1378.31 1768,-1334.31 2253,-1334.31 2253,-1378.31"/>
<text text-anchor="middle" x="2010.5" y="-1347.99" font-family="Times,serif" font-size="32.90">tg_client._flush_chop_queue</text>
</a>
</g>
</g>
<!-- tg_client._flush_chop_queue&#45;&gt;tg_client._process_chop_queue -->
<g id="edge165" class="edge">
<title>tg_client._flush_chop_queue&#45;&gt;tg_client._process_chop_queue</title>
<path fill="none" stroke="black" d="M2253.08,-1358.16C2504.48,-1359.92 2909.58,-1362.31 3259.5,-1362.31 3259.5,-1362.31 3259.5,-1362.31 4108,-1362.31 4611.18,-1362.31 4737.31,-1358.98 5240,-1381.31 6036.39,-1416.68 6233.53,-1458.23 7029,-1510.31 7146.29,-1517.99 7277.87,-1525.75 7382.24,-1531.71"/>
<polygon fill="black" stroke="black" points="7382.07,-1535.2 7392.25,-1532.28 7382.46,-1528.21 7382.07,-1535.2"/>
</g>
<!-- tg_client._get_id_date -->
<g id="node131" class="node">
<title>tg_client._get_id_date</title>
<g id="a_node131"><a xlink:title="Return the stored date for ``msg_id`` in ``chat`` if available.">
<polygon fill="none" stroke="black" points="7746,-5116.81 7402,-5116.81 7402,-5075.81 7746,-5075.81 7746,-5116.81"/>
<text text-anchor="middle" x="7574" y="-5089.06" font-family="Times,serif" font-size="29.68">tg_client._get_id_date</text>
</a>
</g>
</g>
<!-- tg_client._get_id_date&#45;&gt;post_io.raw_post_path -->
<g id="edge166" class="edge">
<title>tg_client._get_id_date&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7746.05,-5098.4C7886.7,-5096.06 8070.45,-5082.25 8119,-5028.31 8188.92,-4950.62 8082.59,-3222.68 8155,-3147.31 8254.97,-3043.26 8443.17,-3073.47 8543.69,-3099.66"/>
<polygon fill="black" stroke="black" points="8542.87,-3103.06 8553.44,-3102.25 8544.67,-3096.3 8542.87,-3103.06"/>
</g>
<!-- tg_client._get_id_date&#45;&gt;notes_utils.read_text -->
<g id="edge167" class="edge">
<title>tg_client._get_id_date&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M7746.09,-5090.57C7853.48,-5085.66 7994.69,-5076.83 8119,-5061.31 8545.18,-5008.09 8658.03,-5009.08 9069,-4884.31 9452.38,-4767.91 9887,-4549.63 10023.3,-4478.99"/>
<polygon fill="black" stroke="black" points="10024.95,-4482.07 10032.21,-4474.36 10021.73,-4475.86 10024.95,-4482.07"/>
</g>
<!-- tg_client._load_progress -->
<g id="node132" class="node">
<title>tg_client._load_progress</title>
<g id="a_node132"><a xlink:title="Return saved resume timestamp for ``chat`` if available.">
<polygon fill="none" stroke="black" points="2175.5,-5404.31 1845.5,-5404.31 1845.5,-5368.31 2175.5,-5368.31 2175.5,-5404.31"/>
<text text-anchor="middle" x="2010.5" y="-5380.15" font-family="Times,serif" font-size="25.20">tg_client._load_progress</text>
</a>
</g>
</g>
<!-- tg_client._load_progress&#45;&gt;notes_utils.read_text -->
<g id="edge168" class="edge">
<title>tg_client._load_progress&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M2062.15,-5404.34C2230.18,-5462.49 2785.42,-5641.31 3259.5,-5641.31 3259.5,-5641.31 3259.5,-5641.31 8613,-5641.31 9124.71,-5641.31 9362.82,-5930.95 9764,-5613.31 9951.36,-5464.96 10046.37,-4647.79 10063.61,-4484.65"/>
<polygon fill="black" stroke="black" points="10067.12,-4484.77 10064.68,-4474.46 10060.16,-4484.04 10067.12,-4484.77"/>
</g>
<!-- tg_client._save_progress -->
<g id="node133" class="node">
<title>tg_client._save_progress</title>
<g id="a_node133"><a xlink:title="Persist resume timestamp for ``chat`` to ``STATE_DIR``.">
<polygon fill="none" stroke="black" points="2770,-3515.31 2541,-3515.31 2541,-3479.31 2770,-3479.31 2770,-3515.31"/>
<text text-anchor="middle" x="2655.5" y="-3493.14" font-family="Times,serif" font-size="17.08">tg_client._save_progress</text>
</a>
</g>
</g>
<!-- tg_client.get_first_id -->
<g id="node134" class="node">
<title>tg_client.get_first_id</title>
<g id="a_node134"><a xlink:title="Return the smallest saved message id for ``chat``.">
<polygon fill="none" stroke="black" points="3394,-5057.31 3127,-5057.31 3127,-5021.31 3394,-5021.31 3394,-5057.31"/>
<text text-anchor="middle" x="3260.5" y="-5033.43" font-family="Times,serif" font-size="24.22">tg_client.get_first_id</text>
</a>
</g>
</g>
<!-- tg_client.get_first_id&#45;&gt;post_io.raw_post_path -->
<g id="edge169" class="edge">
<title>tg_client.get_first_id&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M3280.16,-5020.95C3421.18,-4883.62 4339.18,-4013.03 5276,-3686.31 6014,-3428.93 6248.79,-3592.83 7029,-3546.31 7089.5,-3542.7 8074.85,-3544.83 8119,-3503.31 8176.92,-3448.83 8097.62,-3202.35 8155,-3147.31 8257.88,-3048.62 8441.13,-3075.22 8541.14,-3099.81"/>
<polygon fill="black" stroke="black" points="8540.3,-3103.21 8550.85,-3102.26 8542.01,-3096.42 8540.3,-3103.21"/>
</g>
<!-- tg_client.get_last_id -->
<g id="node135" class="node">
<title>tg_client.get_last_id</title>
<g id="a_node135"><a xlink:title="Return the highest saved message id for ``chat``.">
<polygon fill="none" stroke="black" points="2141,-3561.31 1880,-3561.31 1880,-3525.31 2141,-3525.31 2141,-3561.31"/>
<text text-anchor="middle" x="2010.5" y="-3537.43" font-family="Times,serif" font-size="24.22">tg_client.get_last_id</text>
</a>
</g>
</g>
<!-- tg_client.get_last_id&#45;&gt;post_io.raw_post_path -->
<g id="edge170" class="edge">
<title>tg_client.get_last_id&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M2141.45,-3540.89C2706.18,-3530.4 4922.21,-3489.31 4994.5,-3489.31 4994.5,-3489.31 4994.5,-3489.31 6471,-3489.31 6562.57,-3489.31 8051.15,-3526.8 8119,-3465.31 8224.39,-3369.79 8051.77,-3245.15 8155,-3147.31 8258.23,-3049.47 8440.61,-3075.46 8540.59,-3099.8"/>
<polygon fill="black" stroke="black" points="8540.04,-3103.27 8550.59,-3102.3 8541.74,-3096.48 8540.04,-3103.27"/>
</g>
<!-- tg_client._save_message -->
<g id="node136" class="node">
<title>tg_client._save_message</title>
<g id="a_node136"><a xlink:title="Write ``msg`` to disk with metadata and any media references.&#10;&#10;Returns the path of the stored message or ``None`` when skipped.">
<polygon fill="none" stroke="black" points="4715,-2320.81 3499,-2320.81 3499,-2205.81 4715,-2205.81 4715,-2320.81"/>
<text text-anchor="middle" x="4107" y="-2239.19" font-family="Times,serif" font-size="97.02">tg_client._save_message</text>
</a>
</g>
</g>
<!-- tg_client._save_message&#45;&gt;post_io.get_contact -->
<g id="edge171" class="edge">
<title>tg_client._save_message&#45;&gt;post_io.get_contact</title>
<path fill="none" stroke="black" d="M4715.08,-2287.89C4727.15,-2288.37 4739.14,-2288.84 4751,-2289.31 4984.32,-2298.47 5042.57,-2303.49 5276,-2309.31 6118.47,-2330.3 7135.17,-2335.03 7464.46,-2336.05"/>
<polygon fill="black" stroke="black" points="7464.47,-2339.55 7474.48,-2336.08 7464.49,-2332.55 7464.47,-2339.55"/>
</g>
<!-- tg_client._save_message&#45;&gt;post_io.read_post -->
<g id="edge172" class="edge">
<title>tg_client._save_message&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M4157.48,-2205.77C4256.77,-2095.07 4492.99,-1854.95 4751,-1759.31 5404.29,-1517.14 7542.15,-1618.17 8322.53,-1664.7"/>
<polygon fill="black" stroke="black" points="8322.6,-1668.21 8332.79,-1665.31 8323.01,-1661.22 8322.6,-1668.21"/>
</g>
<!-- tg_client._save_message&#45;&gt;post_io.raw_post_path -->
<g id="edge173" class="edge">
<title>tg_client._save_message&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M4182.44,-2320.86C4360.58,-2455.58 4829.91,-2792.88 5276,-2963.31 5559.69,-3071.69 5646.49,-3048.52 5947,-3092.31 6186.11,-3127.15 7905.47,-3313.4 8119,-3200.31 8144.16,-3186.98 8130.24,-3161.37 8155,-3147.31 8270.05,-3081.95 8428.83,-3090.32 8525.46,-3104.07"/>
<polygon fill="black" stroke="black" points="8525.08,-3107.55 8535.49,-3105.55 8526.1,-3100.63 8525.08,-3107.55"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._mark_activity -->
<g id="edge174" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._mark_activity</title>
<path fill="none" stroke="black" d="M4133.45,-2205.7C4205.04,-2051.22 4424.52,-1626.85 4751,-1440.31 4793.33,-1416.12 4846.43,-1407.16 4892.23,-1404.64"/>
<polygon fill="black" stroke="black" points="4892.66,-1408.13 4902.49,-1404.18 4892.34,-1401.13 4892.66,-1408.13"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._progress_logger -->
<g id="edge175" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._progress_logger</title>
<path fill="none" stroke="black" d="M4715.22,-2247.55C4745.34,-2246.77 4774.28,-2246.02 4801.37,-2245.32"/>
<polygon fill="black" stroke="black" points="4801.75,-2248.81 4811.66,-2245.05 4801.57,-2241.81 4801.75,-2248.81"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._write_md -->
<g id="edge176" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._write_md</title>
<path fill="none" stroke="black" d="M4715.02,-2271.08C5023.8,-2275.03 5364.9,-2279.4 5514.71,-2281.31"/>
<polygon fill="black" stroke="black" points="5514.69,-2284.81 5524.74,-2281.44 5514.78,-2277.81 5514.69,-2284.81"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._find_group_path -->
<g id="edge177" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._find_group_path</title>
<path fill="none" stroke="black" d="M4126.05,-2321C4183.71,-2494.09 4381.65,-3009.34 4751,-3209.31 4819.72,-3246.51 5927.25,-3244.25 6326.74,-3242.2"/>
<polygon fill="black" stroke="black" points="6326.93,-3245.7 6336.91,-3242.15 6326.89,-3238.7 6326.93,-3245.7"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._should_skip_media -->
<g id="edge178" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._should_skip_media</title>
<path fill="none" stroke="black" d="M4540.21,-2320.84C4640.41,-2334.18 4741.36,-2347.61 4822.56,-2358.42"/>
<polygon fill="black" stroke="black" points="4822.5,-2361.94 4832.87,-2359.79 4823.42,-2355.01 4822.5,-2361.94"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._allowed_topic -->
<g id="edge179" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._allowed_topic</title>
<path fill="none" stroke="black" d="M4123.56,-2320.81C4175.97,-2501.76 4364.76,-3060.77 4751,-3285.31 4852.5,-3344.32 5157.75,-3343.86 5371.21,-3335.31"/>
<polygon fill="black" stroke="black" points="5371.46,-3338.81 5381.31,-3334.9 5371.17,-3331.81 5371.46,-3338.81"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._extract_author -->
<g id="edge180" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._extract_author</title>
<path fill="none" stroke="black" d="M4125.31,-2321.04C4181.47,-2496.83 4376.98,-3026.43 4751,-3238.31 4758.26,-3242.42 5593.45,-3276.89 6096.51,-3297.3"/>
<polygon fill="black" stroke="black" points="6096.72,-3300.81 6106.85,-3297.72 6097,-3293.82 6096.72,-3300.81"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._enqueue_chop -->
<g id="edge181" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._enqueue_chop</title>
<path fill="none" stroke="black" d="M4150.27,-2205.72C4243.83,-2082.66 4481.59,-1793.42 4751,-1647.31 4773.76,-1634.97 4799.13,-1625.28 4824.65,-1617.68"/>
<polygon fill="black" stroke="black" points="4825.79,-1621 4834.44,-1614.87 4823.86,-1614.27 4825.79,-1621"/>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._save_message -->
<g id="edge182" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._save_message</title>
<path fill="none" stroke="black" d="M3957.09,-2320.92C3976.06,-2331.43 4026.04,-2338.81 4107,-2338.81 4177.21,-2338.81 4224.12,-2333.26 4247.71,-2324.93"/>
<polygon fill="black" stroke="black" points="4249.15,-2328.12 4256.91,-2320.92 4246.35,-2321.71 4249.15,-2328.12"/>
</g>
<!-- tg_client._save_media -->
<g id="node137" class="node">
<title>tg_client._save_media</title>
<g id="a_node137"><a xlink:title="Store ``data`` and return relative file path.">
<polygon fill="none" stroke="black" points="5834.5,-2220.31 5352.5,-2220.31 5352.5,-2166.31 5834.5,-2166.31 5834.5,-2220.31"/>
<text text-anchor="middle" x="5593.5" y="-2182.71" font-family="Times,serif" font-size="42.00">tg_client._save_media</text>
</a>
</g>
</g>
<!-- tg_client._save_message&#45;&gt;tg_client._save_media -->
<g id="edge183" class="edge">
<title>tg_client._save_message&#45;&gt;tg_client._save_media</title>
<path fill="none" stroke="black" d="M4715.02,-2214.23C4727.11,-2213.56 4739.12,-2212.91 4751,-2212.31 4949.44,-2202.21 5174.48,-2197.48 5341.88,-2195.26"/>
<polygon fill="black" stroke="black" points="5342.11,-2198.76 5352.06,-2195.13 5342.02,-2191.76 5342.11,-2198.76"/>
</g>
<!-- moderation.should_skip_user -->
<g id="node138" class="node">
<title>moderation.should_skip_user</title>
<g id="a_node138"><a xlink:title="Return ``True`` if ``username`` is blacklisted.">
<polygon fill="none" stroke="black" points="10191.5,-909.31 9943.5,-909.31 9943.5,-873.31 10191.5,-873.31 10191.5,-909.31"/>
<text text-anchor="middle" x="10067.5" y="-887.26" font-family="Times,serif" font-size="15.68">moderation.should_skip_user</text>
</a>
</g>
</g>
<!-- tg_client._save_message&#45;&gt;moderation.should_skip_user -->
<g id="edge184" class="edge">
<title>tg_client._save_message&#45;&gt;moderation.should_skip_user</title>
<path fill="none" stroke="black" d="M4143.02,-2205.62C4228.64,-2069.76 4462.78,-1728.16 4751,-1556.31 4943.3,-1441.65 5096.39,-1607.07 5240,-1435.31 5319.56,-1340.15 5196.64,-973.63 5276,-878.31 5472.78,-641.97 5642.62,-753.27 5947,-709.31 6062.12,-692.68 6888.62,-718.63 6993,-667.31 7015.37,-656.31 7006.43,-634.88 7029,-624.31 7142.29,-571.22 8029.89,-621.47 8155,-621.31 8561.22,-620.77 8666.32,-567.77 9069,-621.31 9434.88,-669.95 9856.92,-814.79 10008.55,-869.79"/>
<polygon fill="black" stroke="black" points="10007.55,-873.15 10018.14,-873.28 10009.94,-866.58 10007.55,-873.15"/>
</g>
<!-- tg_client._save_media&#45;&gt;caption_io.caption_json_path -->
<g id="edge185" class="edge">
<title>tg_client._save_media&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M5738.88,-2166.27C5802.46,-2155.54 5878.2,-2144.33 5947,-2138.31 6908.85,-2054.14 7154.51,-2140.04 8119,-2095.31 8353.84,-2084.42 9058.58,-2029.16 9327.58,-2007.78"/>
<polygon fill="black" stroke="black" points="9328.04,-2011.25 9337.73,-2006.97 9327.49,-2004.27 9328.04,-2011.25"/>
</g>
<!-- tg_client._save_media&#45;&gt;caption_io.has_caption -->
<g id="edge186" class="edge">
<title>tg_client._save_media&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M5653.21,-2166.24C5723.18,-2131.32 5839.59,-2064.43 5911,-1976.31 5937.35,-1943.8 5912.28,-1912.67 5947,-1889.31 6056.18,-1815.82 8077.73,-1859.59 8524.21,-1870.18"/>
<polygon fill="black" stroke="black" points="8524.38,-1873.69 8534.46,-1870.43 8524.55,-1866.69 8524.38,-1873.69"/>
</g>
<!-- tg_client._save_media&#45;&gt;image_io.write_image_meta -->
<g id="edge187" class="edge">
<title>tg_client._save_media&#45;&gt;image_io.write_image_meta</title>
<path fill="none" stroke="black" d="M5834.62,-2200.72C5998.72,-2205.79 6209.68,-2212.3 6342.15,-2216.39"/>
<polygon fill="black" stroke="black" points="6342.24,-2219.9 6352.34,-2216.71 6342.45,-2212.9 6342.24,-2219.9"/>
</g>
<!-- tg_client._save_media&#45;&gt;tg_client._schedule_caption -->
<g id="edge188" class="edge">
<title>tg_client._save_media&#45;&gt;tg_client._schedule_caption</title>
<path fill="none" stroke="black" d="M5834.61,-2204.3C5863.78,-2215.3 5890.47,-2231.6 5911,-2255.31 5963.43,-2315.86 5893.33,-2915.85 5947,-2975.31 6141.68,-3190.99 7061.51,-3188.51 7424.85,-3178.72"/>
<polygon fill="black" stroke="black" points="7425.01,-3182.22 7434.91,-3178.45 7424.81,-3175.22 7425.01,-3182.22"/>
</g>
<!-- tg_client._save_bounded -->
<g id="node139" class="node">
<title>tg_client._save_bounded</title>
<g id="a_node139"><a xlink:title="Run ``_save_message`` under the global semaphore and return path.">
<polygon fill="none" stroke="black" points="3463,-1476.31 3058,-1476.31 3058,-1434.31 3463,-1434.31 3463,-1476.31"/>
<text text-anchor="middle" x="3260.5" y="-1447.22" font-family="Times,serif" font-size="31.36">tg_client._save_bounded</text>
</a>
</g>
</g>
<!-- tg_client._save_bounded&#45;&gt;tg_client._save_message -->
<g id="edge189" class="edge">
<title>tg_client._save_bounded&#45;&gt;tg_client._save_message</title>
<path fill="none" stroke="black" d="M3283.65,-1476.51C3391.28,-1579.48 3861.57,-2029.44 4038.43,-2198.66"/>
<polygon fill="black" stroke="black" points="4036.22,-2201.39 4045.87,-2205.77 4041.06,-2196.33 4036.22,-2201.39"/>
</g>
<!-- tg_client._remove_local_message -->
<g id="node140" class="node">
<title>tg_client._remove_local_message</title>
<g id="a_node140"><a xlink:title="Delete ``path`` and related media if the post no longer exists.">
<polygon fill="none" stroke="black" points="7859,-1192.31 7289,-1192.31 7289,-1148.31 7859,-1148.31 7859,-1192.31"/>
<text text-anchor="middle" x="7574" y="-1161.99" font-family="Times,serif" font-size="32.90">tg_client._remove_local_message</text>
</a>
</g>
</g>
<!-- tg_client._remove_local_message&#45;&gt;post_io.read_post -->
<g id="edge190" class="edge">
<title>tg_client._remove_local_message&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7859.14,-1153.6C7970.49,-1153.61 8080.77,-1164.04 8119,-1201.31 8188.46,-1269.01 8087.11,-1567.03 8155,-1636.31 8199.28,-1681.49 8260.04,-1703.15 8322.76,-1711.53"/>
<polygon fill="black" stroke="black" points="8322.49,-1715.02 8332.84,-1712.76 8323.34,-1708.07 8322.49,-1715.02"/>
</g>
<!-- tg_client._remove_local_message&#45;&gt;caption_io.caption_json_path -->
<g id="edge191" class="edge">
<title>tg_client._remove_local_message&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M7859.27,-1154.23C7970.26,-1154.41 8080.21,-1164.8 8119,-1201.31 8218.4,-1294.86 8054.64,-1413.8 8155,-1506.31 8229.72,-1575.18 8994.77,-1469.91 9069,-1539.31 9125.63,-1592.25 9056.77,-1825.61 9105,-1886.31 9158.21,-1953.28 9253.29,-1980.73 9327.52,-1991.89"/>
<polygon fill="black" stroke="black" points="9327.45,-1995.42 9337.85,-1993.36 9328.44,-1988.49 9327.45,-1995.42"/>
</g>
<!-- tg_client._remove_local_message&#45;&gt;caption_io.caption_md_path -->
<g id="edge192" class="edge">
<title>tg_client._remove_local_message&#45;&gt;caption_io.caption_md_path</title>
<path fill="none" stroke="black" d="M7859.12,-1175.77C8161.08,-1185.21 8651.59,-1210.98 9069,-1281.31 9173.87,-1298.98 9292.81,-1331.8 9365.49,-1353.34"/>
<polygon fill="black" stroke="black" points="9364.84,-1356.81 9375.43,-1356.31 9366.84,-1350.1 9364.84,-1356.81"/>
</g>
<!-- tg_client._download_messages -->
<g id="node141" class="node">
<title>tg_client._download_messages</title>
<g id="a_node141"><a xlink:title="Save ``messages`` with a progress bar and return count saved.">
<polygon fill="none" stroke="black" points="3010.5,-1755.81 2300.5,-1755.81 2300.5,-1698.81 3010.5,-1698.81 3010.5,-1755.81"/>
<text text-anchor="middle" x="2655.5" y="-1715.97" font-family="Times,serif" font-size="44.80">tg_client._download_messages</text>
</a>
</g>
</g>
<!-- tg_client._download_messages&#45;&gt;tg_client._save_bounded -->
<g id="edge193" class="edge">
<title>tg_client._download_messages&#45;&gt;tg_client._save_bounded</title>
<path fill="none" stroke="black" d="M2694.02,-1698.76C2762.42,-1648.24 2913.67,-1543.42 3058,-1490.31 3069.7,-1486 3081.98,-1482.22 3094.47,-1478.9"/>
<polygon fill="black" stroke="black" points="3095.69,-1482.2 3104.51,-1476.33 3093.96,-1475.41 3095.69,-1482.2"/>
</g>
<!-- tg_client.ensure_chat_access -->
<g id="node142" class="node">
<title>tg_client.ensure_chat_access</title>
<g id="a_node142"><a xlink:title="Join chats listed in ``CHATS`` if not already joined.">
<polygon fill="none" stroke="black" points="2826.5,-1232.31 2484.5,-1232.31 2484.5,-1196.31 2826.5,-1196.31 2826.5,-1232.31"/>
<text text-anchor="middle" x="2655.5" y="-1208.61" font-family="Times,serif" font-size="22.12">tg_client.ensure_chat_access</text>
</a>
</g>
</g>
<!-- tg_client.refetch_messages -->
<g id="node143" class="node">
<title>tg_client.refetch_messages</title>
<g id="a_node143"><a xlink:title="Re&#45;fetch posts that failed parsing or are empty.">
<polygon fill="none" stroke="black" points="3022,-2729.81 2289,-2729.81 2289,-2664.81 3022,-2664.81 3022,-2729.81"/>
<text text-anchor="middle" x="2655.5" y="-2684.26" font-family="Times,serif" font-size="51.94">tg_client.refetch_messages</text>
</a>
</g>
</g>
<!-- tg_client.refetch_messages&#45;&gt;notes_utils.load_json -->
<g id="edge196" class="edge">
<title>tg_client.refetch_messages&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M2678.22,-2729.95C2733.29,-2810.68 2886.31,-3022.48 3058,-3151.31 3382.79,-3395 3787.66,-3549.76 5276,-4074.31 5569.98,-4177.92 5644.09,-4204.8 5947,-4278.31 6422.09,-4393.6 6542.13,-4432.13 7029,-4476.31 7511.46,-4520.09 7634.6,-4483.19 8119,-4476.31 8224.59,-4474.81 8992.79,-4522.4 9069,-4449.31 9151.32,-4370.36 9024.83,-4018.43 9105,-3937.31 9167.94,-3873.62 9276.67,-3877.7 9351.69,-3890.5"/>
<polygon fill="black" stroke="black" points="9351.13,-3893.95 9361.59,-3892.27 9352.36,-3887.06 9351.13,-3893.95"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;notes_utils.write_json -->
<g id="edge197" class="edge">
<title>tg_client.refetch_messages&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M2667.26,-2730C2706.41,-2845.92 2850.06,-3244.96 3058,-3519.31 3210.21,-3720.13 4516.55,-4935.95 4751,-5028.31 4925.03,-5096.87 5405.45,-5047.31 5592.5,-5047.31 5592.5,-5047.31 5592.5,-5047.31 6471,-5047.31 6562.56,-5047.31 8049.2,-5087.56 8119,-5028.31 8189.19,-4968.73 8096.23,-4895.17 8155,-4824.31 8242.65,-4718.63 8402.39,-4677.82 8507.62,-4662.1"/>
<polygon fill="black" stroke="black" points="8508.23,-4665.54 8517.63,-4660.65 8507.23,-4658.62 8508.23,-4665.54"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;post_io.read_post -->
<g id="edge194" class="edge">
<title>tg_client.refetch_messages&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M2698.99,-2664.62C2907.83,-2506.14 3851.58,-1814.79 4751,-1556.31 4931.15,-1504.54 7978.24,-1233.54 8119,-1357.31 8212.89,-1439.87 8065.47,-1549.04 8155,-1636.31 8199.97,-1680.14 8260.54,-1701.42 8322.82,-1709.88"/>
<polygon fill="black" stroke="black" points="8322.47,-1713.36 8332.82,-1711.13 8323.33,-1706.42 8322.47,-1713.36"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;post_io.raw_post_path -->
<g id="edge195" class="edge">
<title>tg_client.refetch_messages&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M2691.35,-2729.93C2844.75,-2870 3480.09,-3413.31 4106,-3413.31 4106,-3413.31 4106,-3413.31 6471,-3413.31 6562.57,-3413.31 8050.09,-3447.61 8119,-3387.31 8200.17,-3316.28 8075.39,-3220.08 8155,-3147.31 8259.27,-3052 8439.22,-3076.25 8539.04,-3099.83"/>
<polygon fill="black" stroke="black" points="8538.49,-3103.3 8549.03,-3102.25 8540.14,-3096.49 8538.49,-3103.3"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;tg_client._get_message_path -->
<g id="edge198" class="edge">
<title>tg_client.refetch_messages&#45;&gt;tg_client._get_message_path</title>
<path fill="none" stroke="black" d="M2743.86,-2729.91C2868.88,-2776.56 3095.44,-2861.09 3201.64,-2900.72"/>
<polygon fill="black" stroke="black" points="3200.63,-2904.08 3211.22,-2904.3 3203.08,-2897.52 3200.63,-2904.08"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;tg_client._save_bounded -->
<g id="edge199" class="edge">
<title>tg_client.refetch_messages&#45;&gt;tg_client._save_bounded</title>
<path fill="none" stroke="black" d="M2672.61,-2664.81C2730.25,-2547.04 2927.76,-2130.31 3022,-1764.31 3037.31,-1704.84 3015.48,-1534.62 3058,-1490.31 3060.68,-1487.52 3063.49,-1484.9 3066.43,-1482.45"/>
<polygon fill="black" stroke="black" points="3068.62,-1485.18 3074.46,-1476.34 3064.39,-1479.6 3068.62,-1485.18"/>
</g>
<!-- tg_client.refetch_messages&#45;&gt;tg_client._remove_local_message -->
<g id="edge200" class="edge">
<title>tg_client.refetch_messages&#45;&gt;tg_client._remove_local_message</title>
<path fill="none" stroke="black" d="M2672.35,-2664.74C2729.1,-2546.73 2923.97,-2129.31 3022,-1764.31 3035.76,-1713.07 3018.5,-1563.73 3058,-1528.31 3148.33,-1447.3 5142.79,-1507.92 5240,-1435.31 5279.52,-1405.79 5236.94,-1360.44 5276,-1330.31 5894.6,-853.2 6249.44,-1252.2 7029,-1201.31 7109.91,-1196.03 7197.62,-1190.81 7278.5,-1186.2"/>
<polygon fill="black" stroke="black" points="7279.06,-1189.67 7288.84,-1185.61 7278.66,-1182.68 7279.06,-1189.67"/>
</g>
<!-- tg_client.fetch_missing -->
<g id="node144" class="node">
<title>tg_client.fetch_missing</title>
<g id="a_node144"><a xlink:title="Pull new messages and back&#45;fill history until fully synced.">
<polygon fill="none" stroke="black" points="1732,-3557.31 1019,-3557.31 1019,-3483.31 1732,-3483.31 1732,-3557.31"/>
<text text-anchor="middle" x="1375.5" y="-3505.48" font-family="Times,serif" font-size="59.78">tg_client.fetch_missing</text>
</a>
</g>
</g>
<!-- tg_client.fetch_missing&#45;&gt;post_io.raw_post_path -->
<g id="edge201" class="edge">
<title>tg_client.fetch_missing&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M1732.23,-3490.8C1988.48,-3472.06 2342.59,-3451.31 2654.5,-3451.31 2654.5,-3451.31 2654.5,-3451.31 6471,-3451.31 6562.57,-3451.31 8050.72,-3480.33 8119,-3419.31 8209.92,-3338.05 8065.71,-3230.36 8155,-3147.31 8258.72,-3050.84 8439.69,-3075.84 8539.62,-3099.77"/>
<polygon fill="black" stroke="black" points="8539.08,-3103.24 8549.63,-3102.23 8540.75,-3096.45 8539.08,-3103.24"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client._get_id_date -->
<g id="edge202" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client._get_id_date</title>
<path fill="none" stroke="black" d="M1386.21,-3557.45C1450.63,-3794.44 1838.92,-5085.31 2654.5,-5085.31 2654.5,-5085.31 2654.5,-5085.31 5594.5,-5085.31 6256.71,-5085.31 7043.58,-5091.55 7391.8,-5094.63"/>
<polygon fill="black" stroke="black" points="7391.94,-5098.13 7401.97,-5094.72 7392.01,-5091.13 7391.94,-5098.13"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client._load_progress -->
<g id="edge203" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client._load_progress</title>
<path fill="none" stroke="black" d="M1379.48,-3557.44C1395.14,-3737.17 1478.52,-4531.22 1768,-5099.31 1824.27,-5209.73 1930.35,-5314.59 1981.08,-5361.13"/>
<polygon fill="black" stroke="black" points="1978.98,-5363.95 1988.73,-5368.09 1983.69,-5358.77 1978.98,-5363.95"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client._save_progress -->
<g id="edge204" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client._save_progress</title>
<path fill="none" stroke="black" d="M1732.07,-3513.91C1998.65,-3509.11 2347.77,-3502.83 2530.59,-3499.54"/>
<polygon fill="black" stroke="black" points="2530.85,-3503.03 2540.78,-3499.35 2530.72,-3496.04 2530.85,-3503.03"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client.get_first_id -->
<g id="edge205" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client.get_first_id</title>
<path fill="none" stroke="black" d="M1404.57,-3557.43C1551.52,-3748.75 2256.17,-4629.05 3058,-5007.31 3076.31,-5015.94 3096.48,-5022.32 3116.78,-5027.01"/>
<polygon fill="black" stroke="black" points="3116.23,-5030.48 3126.75,-5029.18 3117.72,-5023.64 3116.23,-5030.48"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client.get_last_id -->
<g id="edge206" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client.get_last_id</title>
<path fill="none" stroke="black" d="M1732.32,-3533.24C1780.94,-3535 1828.31,-3536.72 1869.74,-3538.23"/>
<polygon fill="black" stroke="black" points="1869.74,-3541.73 1879.86,-3538.6 1869.99,-3534.74 1869.74,-3541.73"/>
</g>
<!-- tg_client.fetch_missing&#45;&gt;tg_client._download_messages -->
<g id="edge207" class="edge">
<title>tg_client.fetch_missing&#45;&gt;tg_client._download_messages</title>
<path fill="none" stroke="black" d="M1402.9,-3483.27C1568.46,-3250.99 2461.99,-1997.39 2627.96,-1764.54"/>
<polygon fill="black" stroke="black" points="2631.05,-1766.24 2634,-1756.07 2625.35,-1762.18 2631.05,-1766.24"/>
</g>
<!-- tg_client.remove_deleted -->
<g id="node145" class="node">
<title>tg_client.remove_deleted</title>
<g id="a_node145"><a xlink:title="Delete locally stored messages removed from Telegram recently.">
<polygon fill="none" stroke="black" points="7890.5,-1271.81 7257.5,-1271.81 7257.5,-1210.81 7890.5,-1210.81 7890.5,-1271.81"/>
<text text-anchor="middle" x="7574" y="-1229.06" font-family="Times,serif" font-size="48.44">tg_client.remove_deleted</text>
</a>
</g>
</g>
<!-- tg_client.remove_deleted&#45;&gt;post_io.read_post -->
<g id="edge208" class="edge">
<title>tg_client.remove_deleted&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7890.53,-1233.81C7990.66,-1238.39 8084.4,-1252.39 8119,-1286.31 8174.84,-1341.04 8099.72,-1581.02 8155,-1636.31 8199.6,-1680.92 8260.29,-1702.41 8322.84,-1710.82"/>
<polygon fill="black" stroke="black" points="8322.54,-1714.31 8332.89,-1712.06 8323.4,-1707.36 8322.54,-1714.31"/>
</g>
<!-- tg_client.remove_deleted&#45;&gt;post_io.raw_post_path -->
<g id="edge209" class="edge">
<title>tg_client.remove_deleted&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7890.69,-1239.25C7977.26,-1255.17 8062.68,-1289.38 8119,-1357.31 8172.7,-1422.08 8111.21,-2799.47 8155,-2871.31 8236.6,-3005.19 8417.62,-3072.06 8525.43,-3101.19"/>
<polygon fill="black" stroke="black" points="8524.74,-3104.63 8535.31,-3103.81 8526.54,-3097.87 8524.74,-3104.63"/>
</g>
<!-- tg_client.remove_deleted&#45;&gt;caption_io.caption_json_path -->
<g id="edge210" class="edge">
<title>tg_client.remove_deleted&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M7890.74,-1228.38C7990.36,-1231.22 8083.71,-1243.47 8119,-1276.31 8205.36,-1356.68 8067.95,-1459.68 8155,-1539.31 8230.02,-1607.93 8994.61,-1513.01 9069,-1582.31 9168.55,-1675.05 9019.59,-1780.4 9105,-1886.31 9158.61,-1952.78 9253.41,-1980.29 9327.43,-1991.6"/>
<polygon fill="black" stroke="black" points="9327.33,-1995.12 9337.73,-1993.09 9328.34,-1988.2 9327.33,-1995.12"/>
</g>
<!-- tg_client.remove_deleted&#45;&gt;caption_io.caption_md_path -->
<g id="edge211" class="edge">
<title>tg_client.remove_deleted&#45;&gt;caption_io.caption_md_path</title>
<path fill="none" stroke="black" d="M7890.53,-1263.89C8318.24,-1294.5 9059.71,-1347.56 9330.61,-1366.94"/>
<polygon fill="black" stroke="black" points="9330.6,-1370.45 9340.82,-1367.68 9331.1,-1363.47 9330.6,-1370.45"/>
</g>
<!-- tg_client.main -->
<g id="node146" class="node">
<title>tg_client.main</title>
<g id="a_node146"><a xlink:title="Synchronize configured chats and optional live updates.">
<polygon fill="none" stroke="black" points="934.5,-1433.31 366.5,-1433.31 366.5,-1341.31 934.5,-1341.31 934.5,-1433.31"/>
<text text-anchor="middle" x="650.5" y="-1368.27" font-family="Times,serif" font-size="76.30">tg_client.main</text>
</a>
</g>
</g>
<!-- tg_client.main&#45;&gt;tg_client._mark_activity -->
<g id="edge212" class="edge">
<title>tg_client.main&#45;&gt;tg_client._mark_activity</title>
<path fill="none" stroke="black" d="M934.66,-1393.58C1209.36,-1399.11 1637.99,-1406.31 2009.5,-1406.31 2009.5,-1406.31 2009.5,-1406.31 3261.5,-1406.31 3880.85,-1406.31 4624.7,-1407.6 4892.35,-1408.11"/>
<polygon fill="black" stroke="black" points="4892.44,-1411.61 4902.44,-1408.13 4892.45,-1404.61 4892.44,-1411.61"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client._heartbeat -->
<g id="edge213" class="edge">
<title>tg_client.main&#45;&gt;tg_client._heartbeat</title>
<path fill="none" stroke="black" d="M806.3,-1341.3C871.45,-1323.51 948.38,-1304.53 1019,-1292.31 1095.24,-1279.11 1181.68,-1271.18 1250.23,-1266.51"/>
<polygon fill="black" stroke="black" points="1250.47,-1270 1260.21,-1265.84 1250,-1263.02 1250.47,-1270"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client._flush_chop_queue -->
<g id="edge214" class="edge">
<title>tg_client.main&#45;&gt;tg_client._flush_chop_queue</title>
<path fill="none" stroke="black" d="M934.53,-1380.85C1177.43,-1375.3 1524.24,-1367.39 1757.66,-1362.06"/>
<polygon fill="black" stroke="black" points="1758.08,-1365.55 1767.99,-1361.82 1757.92,-1358.55 1758.08,-1365.55"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client._save_bounded -->
<g id="edge215" class="edge">
<title>tg_client.main&#45;&gt;tg_client._save_bounded</title>
<path fill="none" stroke="black" d="M934.75,-1414.86C963.19,-1416.99 991.65,-1418.87 1019,-1420.31 1763.81,-1459.51 2649.66,-1459.63 3047.55,-1457.21"/>
<polygon fill="black" stroke="black" points="3047.75,-1460.71 3057.73,-1457.15 3047.71,-1453.71 3047.75,-1460.71"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client.ensure_chat_access -->
<g id="edge216" class="edge">
<title>tg_client.main&#45;&gt;tg_client.ensure_chat_access</title>
<path fill="none" stroke="black" d="M735.36,-1341.16C807.96,-1303.94 917.05,-1254.42 1019,-1233.31 1545.33,-1124.3 2187.48,-1166.11 2486.42,-1195.3"/>
<polygon fill="black" stroke="black" points="2486.17,-1198.79 2496.47,-1196.29 2486.86,-1191.83 2486.17,-1198.79"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client.refetch_messages -->
<g id="edge217" class="edge">
<title>tg_client.main&#45;&gt;tg_client.refetch_messages</title>
<path fill="none" stroke="black" d="M721.91,-1433.36C1036.12,-1638.86 2307.48,-2470.35 2596.05,-2659.08"/>
<polygon fill="black" stroke="black" points="2594.41,-2662.19 2604.7,-2664.74 2598.25,-2656.34 2594.41,-2662.19"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client.fetch_missing -->
<g id="edge218" class="edge">
<title>tg_client.main&#45;&gt;tg_client.fetch_missing</title>
<path fill="none" stroke="black" d="M667.1,-1433.34C762.19,-1713.86 1262.75,-3190.62 1358.62,-3473.45"/>
<polygon fill="black" stroke="black" points="1355.33,-3474.66 1361.86,-3483.01 1361.96,-3472.41 1355.33,-3474.66"/>
</g>
<!-- tg_client.main&#45;&gt;tg_client.remove_deleted -->
<g id="edge219" class="edge">
<title>tg_client.main&#45;&gt;tg_client.remove_deleted</title>
<path fill="none" stroke="black" d="M934.71,-1360.56C1209.22,-1336.97 1637.51,-1306.31 2009.5,-1306.31 2009.5,-1306.31 2009.5,-1306.31 5594.5,-1306.31 6176.95,-1306.31 6855.33,-1277.82 7247.35,-1258.56"/>
<polygon fill="black" stroke="black" points="7247.61,-1262.06 7257.43,-1258.07 7247.27,-1255.06 7247.61,-1262.06"/>
</g>
<!-- price_train._iter_lots -->
<g id="node147" class="node">
<title>price_train._iter_lots</title>
<g id="a_node147"><a xlink:title="Return all lots with generated ids.">
<polygon fill="none" stroke="black" points="7729.5,-4122.81 7418.5,-4122.81 7418.5,-4083.81 7729.5,-4083.81 7729.5,-4122.81"/>
<text text-anchor="middle" x="7574" y="-4096.41" font-family="Times,serif" font-size="28.00">price_train._iter_lots</text>
</a>
</g>
</g>
<!-- price_train._iter_lots&#45;&gt;lot_io.read_lots -->
<g id="edge220" class="edge">
<title>price_train._iter_lots&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M7729.83,-4116.65C7870.94,-4125.09 8065.29,-4126.17 8119,-4074.31 8184.32,-4011.24 8118.2,-3750.31 8155,-3667.31 8252.3,-3447.86 8488.05,-3262.51 8576.61,-3198.35"/>
<polygon fill="black" stroke="black" points="8578.88,-3201.03 8584.96,-3192.35 8574.8,-3195.35 8578.88,-3201.03"/>
</g>
<!-- price_train._iter_lots&#45;&gt;lot_io.iter_lot_files -->
<g id="edge221" class="edge">
<title>price_train._iter_lots&#45;&gt;lot_io.iter_lot_files</title>
<path fill="none" stroke="black" d="M7729.69,-4098.11C7838.68,-4093.71 7987.95,-4086.17 8119,-4074.31 8240.37,-4063.32 8377.9,-4045.23 8476.63,-4031.24"/>
<polygon fill="black" stroke="black" points="8477.26,-4034.69 8486.67,-4029.82 8476.28,-4027.76 8477.26,-4034.69"/>
</g>
<!-- price_train.main -->
<g id="node148" class="node">
<title>price_train.main</title>
<g id="a_node148"><a xlink:title="Train price regression model and save it.">
<polygon fill="none" stroke="black" points="6585,-4673.31 6355,-4673.31 6355,-4637.31 6585,-4637.31 6585,-4673.31"/>
<text text-anchor="middle" x="6470" y="-4649.15" font-family="Times,serif" font-size="25.20">price_train.main</text>
</a>
</g>
</g>
<!-- price_train.main&#45;&gt;similar_utils._load_embeddings -->
<g id="edge222" class="edge">
<title>price_train.main&#45;&gt;similar_utils._load_embeddings</title>
<path fill="none" stroke="black" d="M6585.24,-4642.49C6693.59,-4634.62 6859.26,-4633.86 6993,-4682.31 7011.8,-4689.12 7010.34,-4702.12 7029,-4709.31 7148.48,-4755.3 7926.89,-4810.86 8345.52,-4837.91"/>
<polygon fill="black" stroke="black" points="8345.44,-4841.41 8355.65,-4838.56 8345.89,-4834.42 8345.44,-4841.41"/>
</g>
<!-- price_train.main&#45;&gt;similar_utils._sync_embeddings -->
<g id="edge223" class="edge">
<title>price_train.main&#45;&gt;similar_utils._sync_embeddings</title>
<path fill="none" stroke="black" d="M6585.25,-4645.39C6720.44,-4636.29 6934.56,-4631.01 6993,-4682.31 7059.56,-4740.74 6964.55,-4817.56 7029,-4878.31 7072.23,-4919.06 7202.71,-4936 7325.04,-4942.66"/>
<polygon fill="black" stroke="black" points="7325.17,-4946.17 7335.34,-4943.19 7325.53,-4939.18 7325.17,-4946.17"/>
</g>
<!-- price_train.main&#45;&gt;price_utils.train_price_regression -->
<g id="edge224" class="edge">
<title>price_train.main&#45;&gt;price_utils.train_price_regression</title>
<path fill="none" stroke="black" d="M6585.25,-4657.85C6722.44,-4658.16 6940.68,-4649.03 6993,-4590.31 7069.3,-4504.67 6954.12,-548.19 7029,-461.31 7042.68,-445.44 7058,-431.65 7074.59,-419.71"/>
<polygon fill="black" stroke="black" points="7076.61,-422.57 7082.83,-414 7072.62,-416.82 7076.61,-422.57"/>
</g>
<!-- price_train.main&#45;&gt;price_utils.save_price_model -->
<g id="edge225" class="edge">
<title>price_train.main&#45;&gt;price_utils.save_price_model</title>
<path fill="none" stroke="black" d="M6585.04,-4658C6765.32,-4662.25 7119.42,-4670.61 7351.07,-4676.07"/>
<polygon fill="black" stroke="black" points="7351.24,-4679.58 7361.32,-4676.31 7351.4,-4672.58 7351.24,-4679.58"/>
</g>
<!-- price_train.main&#45;&gt;price_train._iter_lots -->
<g id="edge226" class="edge">
<title>price_train.main&#45;&gt;price_train._iter_lots</title>
<path fill="none" stroke="black" d="M6585.2,-4657.25C6721.75,-4656.91 6938.74,-4647.09 6993,-4590.31 7063.53,-4516.5 6955.91,-4203.58 7029,-4132.31 7081.24,-4081.37 7268.13,-4081.3 7408.38,-4089.28"/>
<polygon fill="black" stroke="black" points="7408.2,-4092.78 7418.39,-4089.87 7408.61,-4085.79 7408.2,-4092.78"/>
</g>
<!-- debug_dump.parse_url -->
<g id="node149" class="node">
<title>debug_dump.parse_url</title>
<g id="a_node149"><a xlink:title="Return ``(lot_id, lang)`` extracted from ``url``.">
<polygon fill="none" stroke="black" points="7723.5,-4065.31 7424.5,-4065.31 7424.5,-4029.31 7723.5,-4029.31 7723.5,-4065.31"/>
<text text-anchor="middle" x="7574" y="-4041.43" font-family="Times,serif" font-size="24.22">debug_dump.parse_url</text>
</a>
</g>
</g>
<!-- debug_dump.guess_source_from_lot -->
<g id="node150" class="node">
<title>debug_dump.guess_source_from_lot</title>
<g id="a_node150"><a xlink:title="Guess ``(chat, message_id)`` directly from ``lot_id``.">
<polygon fill="none" stroke="black" points="8833,-4409.31 8391,-4409.31 8391,-4373.31 8833,-4373.31 8833,-4409.31"/>
<text text-anchor="middle" x="8612" y="-4385.72" font-family="Times,serif" font-size="23.24">debug_dump.guess_source_from_lot</text>
</a>
</g>
</g>
<!-- debug_dump.load_source_info -->
<g id="node151" class="node">
<title>debug_dump.load_source_info</title>
<g id="a_node151"><a xlink:title="Return ``(chat, message_id)`` for ``lot_id`` if available.">
<polygon fill="none" stroke="black" points="7828,-4566.81 7320,-4566.81 7320,-4523.81 7828,-4523.81 7828,-4566.81"/>
<text text-anchor="middle" x="7574" y="-4537.16" font-family="Times,serif" font-size="32.06">debug_dump.load_source_info</text>
</a>
</g>
</g>
<!-- debug_dump.load_source_info&#45;&gt;notes_utils.load_json -->
<g id="edge227" class="edge">
<title>debug_dump.load_source_info&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M7828.33,-4556.71C8242.85,-4574.09 9024.76,-4601.06 9069,-4559.31 9169.69,-4464.28 9008.29,-4036.39 9105,-3937.31 9167.83,-3872.94 9277.36,-3877.44 9352.55,-3890.5"/>
<polygon fill="black" stroke="black" points="9351.99,-3893.96 9362.46,-3892.31 9353.25,-3887.07 9351.99,-3893.96"/>
</g>
<!-- debug_dump.load_source_info&#45;&gt;lot_io.lot_json_path -->
<g id="edge228" class="edge">
<title>debug_dump.load_source_info&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M7828.1,-4542.13C8054.71,-4539.29 8373.87,-4535.28 8525.09,-4533.39"/>
<polygon fill="black" stroke="black" points="8525.29,-4536.88 8535.24,-4533.26 8525.2,-4529.88 8525.29,-4536.88"/>
</g>
<!-- debug_dump.run_tg_fetch -->
<g id="node152" class="node">
<title>debug_dump.run_tg_fetch</title>
<g id="a_node152"><a xlink:title="Run ``tg_client.py &#45;&#45;fetch`` and return combined logs.">
<polygon fill="none" stroke="black" points="9660.5,-5173.31 9208.5,-5173.31 9208.5,-5129.31 9660.5,-5129.31 9660.5,-5173.31"/>
<text text-anchor="middle" x="9434.5" y="-5142.99" font-family="Times,serif" font-size="32.90">debug_dump.run_tg_fetch</text>
</a>
</g>
</g>
<!-- debug_dump.run_tg_fetch&#45;&gt;notes_utils.read_text -->
<g id="edge229" class="edge">
<title>debug_dump.run_tg_fetch&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M9531.93,-5129.29C9602.93,-5109.02 9698.18,-5072.87 9764,-5013.31 9938.24,-4855.64 10032.28,-4573.44 10058.68,-4484.18"/>
<polygon fill="black" stroke="black" points="10062.06,-4485.08 10061.5,-4474.5 10055.34,-4483.12 10062.06,-4485.08"/>
</g>
<!-- debug_dump.collect_files -->
<g id="node153" class="node">
<title>debug_dump.collect_files</title>
<g id="a_node153"><a xlink:title="Return ``[(name, content), ...]`` for files related to ``lot_id``.">
<polygon fill="none" stroke="black" points="7821,-3604.81 7327,-3604.81 7327,-3555.81 7821,-3555.81 7821,-3604.81"/>
<text text-anchor="middle" x="7574" y="-3571.13" font-family="Times,serif" font-size="37.10">debug_dump.collect_files</text>
</a>
</g>
</g>
<!-- debug_dump.collect_files&#45;&gt;notes_utils.load_json -->
<g id="edge232" class="edge">
<title>debug_dump.collect_files&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M7821.03,-3585.34C8230.16,-3594.25 9011.45,-3613.81 9069,-3634.31 9218.98,-3687.72 9357.69,-3826.85 9410.73,-3884.6"/>
<polygon fill="black" stroke="black" points="9408.31,-3887.15 9417.63,-3892.19 9413.49,-3882.44 9408.31,-3887.15"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;lot_io.lot_json_path -->
<g id="edge236" class="edge">
<title>debug_dump.collect_files&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M7821.05,-3564.81C7944.78,-3562.88 8077.22,-3571.78 8119,-3614.31 8181.67,-3678.1 8098.41,-4349.07 8155,-4418.31 8243.97,-4527.15 8419.68,-4541.13 8525.11,-4538.63"/>
<polygon fill="black" stroke="black" points="8525.51,-4542.12 8535.4,-4538.33 8525.3,-4535.12 8525.51,-4542.12"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;post_io.raw_post_path -->
<g id="edge230" class="edge">
<title>debug_dump.collect_files&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7821.16,-3592.67C7944.49,-3593.13 8076.49,-3582.99 8119,-3541.31 8181.77,-3479.75 8091.85,-3208.48 8155,-3147.31 8257.54,-3047.99 8441.33,-3074.99 8541.42,-3099.78"/>
<polygon fill="black" stroke="black" points="8540.58,-3103.18 8551.13,-3102.24 8542.3,-3096.39 8540.58,-3103.18"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;notes_utils.read_text -->
<g id="edge231" class="edge">
<title>debug_dump.collect_files&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M7821.24,-3570.35C8182.48,-3557.71 8838.2,-3542.84 9069,-3590.31 9397.34,-3657.84 9516.91,-3656.78 9764,-3883.31 9941.47,-4046.01 10033.63,-4337.17 10059.08,-4428.27"/>
<polygon fill="black" stroke="black" points="10055.77,-4429.41 10061.79,-4438.13 10062.52,-4427.56 10055.77,-4429.41"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;caption_io.caption_json_path -->
<g id="edge233" class="edge">
<title>debug_dump.collect_files&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M7821.28,-3588.12C7942.27,-3587 8072.01,-3576.79 8119,-3541.31 8156.36,-3513.09 8120.42,-3473.87 8155,-3442.31 8465.26,-3159.06 8807.52,-3530.12 9069,-3201.31 9150.3,-3099.07 9015.04,-2121.01 9105,-2026.31 9167.42,-1960.59 9278.35,-1965.86 9353.87,-1979.43"/>
<polygon fill="black" stroke="black" points="9353.34,-1982.89 9363.82,-1981.3 9354.64,-1976.01 9353.34,-1982.89"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;caption_io.has_caption -->
<g id="edge234" class="edge">
<title>debug_dump.collect_files&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M7762.61,-3555.79C7885.91,-3528.97 8038.77,-3472.97 8119,-3356.31 8164.82,-3289.69 8098.94,-1959.58 8155,-1901.31 8204.03,-1850.34 8405.97,-1856.3 8524.03,-1864.62"/>
<polygon fill="black" stroke="black" points="8523.91,-1868.12 8534.14,-1865.35 8524.42,-1861.13 8523.91,-1868.12"/>
</g>
<!-- debug_dump.collect_files&#45;&gt;caption_io.read_caption -->
<g id="edge235" class="edge">
<title>debug_dump.collect_files&#45;&gt;caption_io.read_caption</title>
<path fill="none" stroke="black" d="M7762.57,-3555.77C7885.86,-3528.93 8038.71,-3472.93 8119,-3356.31 8163.09,-3292.27 8101.01,-2013.25 8155,-1957.31 8193.26,-1917.66 8324.3,-1912.8 8436.14,-1916.65"/>
<polygon fill="black" stroke="black" points="8436.09,-1920.15 8446.21,-1917.02 8436.35,-1913.15 8436.09,-1920.15"/>
</g>
<!-- debug_dump.delete_files -->
<g id="node154" class="node">
<title>debug_dump.delete_files</title>
<g id="a_node154"><a xlink:title="Remove files related to ``lot_id`` from the filesystem.">
<polygon fill="none" stroke="black" points="7789.5,-3667.31 7358.5,-3667.31 7358.5,-3623.31 7789.5,-3623.31 7789.5,-3667.31"/>
<text text-anchor="middle" x="7574" y="-3636.99" font-family="Times,serif" font-size="32.90">debug_dump.delete_files</text>
</a>
</g>
</g>
<!-- debug_dump.delete_files&#45;&gt;notes_utils.load_json -->
<g id="edge238" class="edge">
<title>debug_dump.delete_files&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M7789.52,-3641.77C8173.74,-3636.42 8950.45,-3630.46 9069,-3667.31 9212.58,-3711.94 9351.79,-3832.56 9407.74,-3885.19"/>
<polygon fill="black" stroke="black" points="9405.41,-3887.8 9415.07,-3892.14 9410.23,-3882.72 9405.41,-3887.8"/>
</g>
<!-- debug_dump.delete_files&#45;&gt;lot_io.lot_json_path -->
<g id="edge241" class="edge">
<title>debug_dump.delete_files&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M7789.51,-3629.32C7921.34,-3624.67 8073.46,-3630.38 8119,-3676.31 8177.12,-3734.92 8102.64,-4354.5 8155,-4418.31 8244.17,-4526.98 8419.81,-4541.02 8525.17,-4538.58"/>
<polygon fill="black" stroke="black" points="8525.56,-4542.07 8535.46,-4538.28 8525.36,-4535.07 8525.56,-4542.07"/>
</g>
<!-- debug_dump.delete_files&#45;&gt;post_io.raw_post_path -->
<g id="edge237" class="edge">
<title>debug_dump.delete_files&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7789.83,-3660.47C7921.32,-3664.64 8072.93,-3658.55 8119,-3613.31 8193.11,-3540.54 8080.9,-3220.09 8155,-3147.31 8257.12,-3047.01 8441.91,-3074.72 8542.04,-3099.79"/>
<polygon fill="black" stroke="black" points="8541.2,-3103.19 8551.75,-3102.28 8542.94,-3096.41 8541.2,-3103.19"/>
</g>
<!-- debug_dump.delete_files&#45;&gt;caption_io.caption_json_path -->
<g id="edge239" class="edge">
<title>debug_dump.delete_files&#45;&gt;caption_io.caption_json_path</title>
<path fill="none" stroke="black" d="M7789.75,-3643.79C7890.34,-3640.24 8011.44,-3631.91 8119,-3613.31 8552.37,-3538.37 8800.3,-3684.48 9069,-3336.31 9157.96,-3221.03 9004.88,-2132.04 9105,-2026.31 9167.32,-1960.5 9278.27,-1965.78 9353.82,-1979.39"/>
<polygon fill="black" stroke="black" points="9353.3,-1982.85 9363.78,-1981.26 9354.6,-1975.97 9353.3,-1982.85"/>
</g>
<!-- debug_dump.delete_files&#45;&gt;caption_io.caption_md_path -->
<g id="edge240" class="edge">
<title>debug_dump.delete_files&#45;&gt;caption_io.caption_md_path</title>
<path fill="none" stroke="black" d="M7789.65,-3661.33C7921.79,-3665.96 8074.2,-3660.05 8119,-3613.31 8203.36,-3525.3 8069.61,-1506.31 8155,-1419.31 8236.53,-1336.23 9041.9,-1359.04 9330.92,-1370.03"/>
<polygon fill="black" stroke="black" points="9330.85,-1373.53 9340.98,-1370.41 9331.12,-1366.53 9330.85,-1373.53"/>
</g>
<!-- debug_dump._message_reason -->
<g id="node155" class="node">
<title>debug_dump._message_reason</title>
<g id="a_node155"><a xlink:title="Return explanation why a message would be skipped.">
<polygon fill="none" stroke="black" points="9707,-1455.81 9162,-1455.81 9162,-1410.81 9707,-1410.81 9707,-1455.81"/>
<text text-anchor="middle" x="9434.5" y="-1424.93" font-family="Times,serif" font-size="33.60">debug_dump._message_reason</text>
</a>
</g>
</g>
<!-- debug_dump._message_reason&#45;&gt;moderation.should_skip_user -->
<g id="edge242" class="edge">
<title>debug_dump._message_reason&#45;&gt;moderation.should_skip_user</title>
<path fill="none" stroke="black" d="M9551.64,-1455.84C9622.84,-1462.41 9710.33,-1456.22 9764,-1401.31 9839.24,-1324.34 9724.91,-995.42 9800,-918.31 9840.55,-876.67 9905.01,-869.25 9960.39,-872.56"/>
<polygon fill="black" stroke="black" points="9960.39,-876.07 9970.61,-873.3 9960.89,-869.09 9960.39,-876.07"/>
</g>
<!-- debug_dump._lot_reason -->
<g id="node156" class="node">
<title>debug_dump._lot_reason</title>
<g id="a_node156"><a xlink:title="Return explanation why ``lot`` would be skipped.">
<polygon fill="none" stroke="black" points="9588.5,-3982.31 9280.5,-3982.31 9280.5,-3946.31 9588.5,-3946.31 9588.5,-3982.31"/>
<text text-anchor="middle" x="9434.5" y="-3958.72" font-family="Times,serif" font-size="23.24">debug_dump._lot_reason</text>
</a>
</g>
</g>
<!-- debug_dump.moderation_summary -->
<g id="node157" class="node">
<title>debug_dump.moderation_summary</title>
<g id="a_node157"><a xlink:title="Return a multi&#45;line summary of moderation checks for ``lot_id``.">
<polygon fill="none" stroke="black" points="8020.5,-3973.31 7127.5,-3973.31 7127.5,-3911.31 8020.5,-3911.31 8020.5,-3973.31"/>
<text text-anchor="middle" x="7574" y="-3930.11" font-family="Times,serif" font-size="49.00">debug_dump.moderation_summary</text>
</a>
</g>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;notes_utils.load_json -->
<g id="edge245" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M8020.75,-3934.63C8438.3,-3927.44 9036.37,-3917.15 9300.01,-3912.61"/>
<polygon fill="black" stroke="black" points="9300.46,-3916.1 9310.39,-3912.43 9300.34,-3909.1 9300.46,-3916.1"/>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;lot_io.lot_json_path -->
<g id="edge246" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;lot_io.lot_json_path</title>
<path fill="none" stroke="black" d="M8020.75,-3953.2C8057.45,-3969.1 8091.09,-3990.9 8119,-4020.31 8180.13,-4084.72 8097.25,-4350.85 8155,-4418.31 8246.16,-4524.8 8420.3,-4539.7 8525.01,-4537.99"/>
<polygon fill="black" stroke="black" points="8525.32,-4541.48 8535.24,-4537.76 8525.16,-4534.48 8525.32,-4541.48"/>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;post_io.read_post -->
<g id="edge243" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7847.53,-3911.26C7949.55,-3884.99 8055.91,-3836.94 8119,-3749.31 8183.12,-3660.25 8084.64,-1858.52 8155,-1774.31 8197.16,-1723.85 8258.64,-1696.29 8322.89,-1682.16"/>
<polygon fill="black" stroke="black" points="8323.73,-1685.56 8332.81,-1680.09 8322.3,-1678.71 8323.73,-1685.56"/>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;post_io.raw_post_path -->
<g id="edge244" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7840.41,-3911.29C7943.74,-3885.1 8052.97,-3837.11 8119,-3749.31 8199.55,-3642.2 8060.21,-3242.04 8155,-3147.31 8256.52,-3045.85 8442.39,-3074.35 8542.62,-3099.76"/>
<polygon fill="black" stroke="black" points="8541.78,-3103.16 8552.34,-3102.29 8543.54,-3096.39 8541.78,-3103.16"/>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;debug_dump._message_reason -->
<g id="edge247" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;debug_dump._message_reason</title>
<path fill="none" stroke="black" d="M7848,-3911.25C7949.93,-3884.97 8056.09,-3836.91 8119,-3749.31 8193.44,-3645.64 8064.72,-1542.52 8155,-1452.31 8189.69,-1417.65 8785.73,-1421.79 9151.58,-1427.67"/>
<polygon fill="black" stroke="black" points="9151.74,-1431.18 9161.79,-1427.84 9151.85,-1424.18 9151.74,-1431.18"/>
</g>
<!-- debug_dump.moderation_summary&#45;&gt;debug_dump._lot_reason -->
<g id="edge248" class="edge">
<title>debug_dump.moderation_summary&#45;&gt;debug_dump._lot_reason</title>
<path fill="none" stroke="black" d="M8020.75,-3947.58C8423.19,-3952.35 8993.35,-3959.1 9270.12,-3962.37"/>
<polygon fill="black" stroke="black" points="9270.2,-3965.88 9280.24,-3962.49 9270.28,-3958.88 9270.2,-3965.88"/>
</g>
<!-- debug_dump.main -->
<g id="node158" class="node">
<title>debug_dump.main</title>
<g id="a_node158"><a xlink:title="Collect log and data files related to a single lot.">
<polygon fill="none" stroke="black" points="6708,-4078.31 6232,-4078.31 6232,-4016.31 6708,-4016.31 6708,-4078.31"/>
<text text-anchor="middle" x="6470" y="-4035.11" font-family="Times,serif" font-size="49.00">debug_dump.main</text>
</a>
</g>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.parse_url -->
<g id="edge249" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.parse_url</title>
<path fill="none" stroke="black" d="M6708.08,-4047.31C6921.45,-4047.31 7229.06,-4047.31 7414.14,-4047.31"/>
<polygon fill="black" stroke="black" points="7414.23,-4050.81 7424.23,-4047.31 7414.23,-4043.81 7414.23,-4050.81"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.guess_source_from_lot -->
<g id="edge250" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.guess_source_from_lot</title>
<path fill="none" stroke="black" d="M6508.42,-4078.48C6593.94,-4147.47 6813.04,-4311.69 7029,-4371.31 7155.36,-4406.19 7972.99,-4400.17 8380.65,-4394.85"/>
<polygon fill="black" stroke="black" points="8380.85,-4398.35 8390.8,-4394.72 8380.75,-4391.35 8380.85,-4398.35"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.load_source_info -->
<g id="edge251" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.load_source_info</title>
<path fill="none" stroke="black" d="M6545.11,-4078.44C6656.46,-4128.64 6867.25,-4237.43 6993,-4389.31 7019.69,-4421.54 6995.75,-4450.91 7029,-4476.31 7107.91,-4536.59 7212.84,-4559.2 7309.47,-4564.83"/>
<polygon fill="black" stroke="black" points="7309.53,-4568.34 7319.7,-4565.37 7309.89,-4561.35 7309.53,-4568.34"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.run_tg_fetch -->
<g id="edge252" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.run_tg_fetch</title>
<path fill="none" stroke="black" d="M6525.83,-4078.41C6637.67,-4145.33 6890.22,-4315 6993,-4536.31 7025.71,-4606.74 6972.69,-5180.83 7029,-5234.31 7070.09,-5273.33 9012.69,-5240.64 9069,-5234.31 9166.68,-5223.33 9276.36,-5196.29 9349.65,-5176.04"/>
<polygon fill="black" stroke="black" points="9350.6,-5179.41 9359.3,-5173.35 9348.72,-5172.66 9350.6,-5179.41"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.collect_files -->
<g id="edge253" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.collect_files</title>
<path fill="none" stroke="black" d="M6708.09,-4062.1C6809.8,-4055.21 6921.45,-4027.59 6993,-3950.31 7044.02,-3895.2 6974.74,-3666.22 7029,-3614.31 7070.78,-3574.34 7196.61,-3564.78 7316.73,-3565.71"/>
<polygon fill="black" stroke="black" points="7316.81,-3569.21 7326.85,-3565.81 7316.89,-3562.21 7316.81,-3569.21"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.delete_files -->
<g id="edge254" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.delete_files</title>
<path fill="none" stroke="black" d="M6708.24,-4061.24C6809.52,-4054.07 6920.77,-4026.47 6993,-3950.31 7077.51,-3861.18 6939.01,-3759.9 7029,-3676.31 7075.02,-3633.56 7219.67,-3626.82 7348.24,-3630.23"/>
<polygon fill="black" stroke="black" points="7348.16,-3633.73 7358.26,-3630.52 7348.36,-3626.74 7348.16,-3633.73"/>
</g>
<!-- debug_dump.main&#45;&gt;debug_dump.moderation_summary -->
<g id="edge255" class="edge">
<title>debug_dump.main&#45;&gt;debug_dump.moderation_summary</title>
<path fill="none" stroke="black" d="M6708.08,-4024.72C6862.52,-4010 7066.33,-3990.58 7237.31,-3974.29"/>
<polygon fill="black" stroke="black" points="7237.87,-3977.76 7247.49,-3973.32 7237.2,-3970.79 7237.87,-3977.76"/>
</g>
<!-- moderation.should_skip_text -->
<g id="node159" class="node">
<title>moderation.should_skip_text</title>
<g id="a_node159"><a xlink:title="Return ``True`` if ``text`` contains banned phrases.">
<polygon fill="none" stroke="black" points="10211.5,-1029.31 9923.5,-1029.31 9923.5,-993.31 10211.5,-993.31 10211.5,-1029.31"/>
<text text-anchor="middle" x="10067.5" y="-1006.52" font-family="Times,serif" font-size="18.48">moderation.should_skip_text</text>
</a>
</g>
</g>
<!-- moderation.message_skip_reason&#45;&gt;moderation.should_skip_user -->
<g id="edge257" class="edge">
<title>moderation.message_skip_reason&#45;&gt;moderation.should_skip_user</title>
<path fill="none" stroke="black" d="M9672.26,-928.8C9760.44,-920.41 9857.4,-911.19 9933.09,-903.99"/>
<polygon fill="black" stroke="black" points="9933.53,-907.47 9943.16,-903.04 9932.87,-900.5 9933.53,-907.47"/>
</g>
<!-- moderation.message_skip_reason&#45;&gt;moderation.should_skip_text -->
<g id="edge256" class="edge">
<title>moderation.message_skip_reason&#45;&gt;moderation.should_skip_text</title>
<path fill="none" stroke="black" d="M9672.26,-973.82C9752.92,-981.49 9840.91,-989.86 9913.26,-996.74"/>
<polygon fill="black" stroke="black" points="9913.08,-1000.24 9923.37,-997.7 9913.74,-993.27 9913.08,-1000.24"/>
</g>
<!-- moderation.apply_to_history -->
<g id="node162" class="node">
<title>moderation.apply_to_history</title>
<g id="a_node162"><a xlink:title="Remove processed lots now failing moderation.">
<polygon fill="none" stroke="black" points="7830,-2188.31 7318,-2188.31 7318,-2142.31 7830,-2142.31 7830,-2188.31"/>
<text text-anchor="middle" x="7574" y="-2156.87" font-family="Times,serif" font-size="34.30">moderation.apply_to_history</text>
</a>
</g>
</g>
<!-- moderation.apply_to_history&#45;&gt;post_io.read_post -->
<g id="edge261" class="edge">
<title>moderation.apply_to_history&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7696.84,-2188.33C7821.12,-2204.09 8010.65,-2205.44 8119,-2095.31 8219.68,-1992.97 8057.91,-1880.06 8155,-1774.31 8198.66,-1726.75 8259.55,-1700.03 8322.63,-1685.76"/>
<polygon fill="black" stroke="black" points="8323.73,-1689.11 8332.77,-1683.58 8322.26,-1682.26 8323.73,-1689.11"/>
</g>
<!-- moderation.apply_to_history&#45;&gt;post_io.raw_post_path -->
<g id="edge262" class="edge">
<title>moderation.apply_to_history&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7830.07,-2148.84C7951.04,-2147.08 8078.01,-2156.1 8119,-2197.31 8171.89,-2250.48 8115.03,-2807.85 8155,-2871.31 8238.46,-3003.78 8418.39,-3071.09 8525.59,-3100.69"/>
<polygon fill="black" stroke="black" points="8524.85,-3104.12 8535.41,-3103.36 8526.68,-3097.36 8524.85,-3104.12"/>
</g>
<!-- moderation.apply_to_history&#45;&gt;lot_io.read_lots -->
<g id="edge263" class="edge">
<title>moderation.apply_to_history&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M7830.33,-2148.58C7951.38,-2146.75 8078.33,-2155.78 8119,-2197.31 8192.91,-2272.78 8081.11,-3071.83 8155,-3147.31 8255.67,-3250.14 8442.73,-3220.76 8543.13,-3194.93"/>
<polygon fill="black" stroke="black" points="8544.09,-3198.3 8552.87,-3192.37 8542.31,-3191.53 8544.09,-3198.3"/>
</g>
<!-- moderation.apply_to_history&#45;&gt;moderation.should_skip_message -->
<g id="edge264" class="edge">
<title>moderation.apply_to_history&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M7830.37,-2163.1C7951.85,-2156.18 8079.2,-2138.35 8119,-2095.31 8173.68,-2036.17 8115.14,-1441.3 8155,-1371.31 8242.05,-1218.49 8441.83,-1128.71 8545.66,-1090.75"/>
<polygon fill="black" stroke="black" points="8546.88,-1094.04 8555.1,-1087.35 8544.5,-1087.45 8546.88,-1094.04"/>
</g>
<!-- moderation.apply_to_history&#45;&gt;moderation.should_skip_lot -->
<g id="edge265" class="edge">
<title>moderation.apply_to_history&#45;&gt;moderation.should_skip_lot</title>
<path fill="none" stroke="black" d="M7830.22,-2149.06C7951.01,-2147.38 8077.78,-2156.42 8119,-2197.31 8204.07,-2281.69 8077.67,-2643.78 8155,-2735.31 8229.35,-2823.31 8360.87,-2847.32 8463.63,-2851.2"/>
<polygon fill="black" stroke="black" points="8463.69,-2854.71 8473.79,-2851.52 8463.91,-2847.71 8463.69,-2854.71"/>
</g>
<!-- clean_data._parse_date -->
<g id="node163" class="node">
<title>clean_data._parse_date</title>
<g id="a_node163"><a xlink:title="Return the ``date`` field from a markdown file if present.">
<polygon fill="none" stroke="black" points="8751.5,-2726.31 8472.5,-2726.31 8472.5,-2690.31 8751.5,-2690.31 8751.5,-2726.31"/>
<text text-anchor="middle" x="8612" y="-2702.61" font-family="Times,serif" font-size="22.12">clean_data._parse_date</text>
</a>
</g>
</g>
<!-- clean_data._parse_date&#45;&gt;notes_utils.read_text -->
<g id="edge266" class="edge">
<title>clean_data._parse_date&#45;&gt;notes_utils.read_text</title>
<path fill="none" stroke="black" d="M8751.51,-2692.01C9024.07,-2663.15 9616.44,-2617.45 9764,-2745.31 10031.66,-2977.22 10062.8,-4223.12 10066.13,-4427.83"/>
<polygon fill="black" stroke="black" points="10062.63,-4428.12 10066.28,-4438.06 10069.63,-4428.01 10062.63,-4428.12"/>
</g>
<!-- clean_data._clean_raw -->
<g id="node164" class="node">
<title>clean_data._clean_raw</title>
<g id="a_node164"><a xlink:title="Delete raw posts older than ``cutoff``.">
<polygon fill="none" stroke="black" points="7727.5,-2764.31 7420.5,-2764.31 7420.5,-2728.31 7727.5,-2728.31 7727.5,-2764.31"/>
<text text-anchor="middle" x="7574" y="-2740.15" font-family="Times,serif" font-size="25.20">clean_data._clean_raw</text>
</a>
</g>
</g>
<!-- clean_data._clean_raw&#45;&gt;post_io.raw_post_path -->
<g id="edge267" class="edge">
<title>clean_data._clean_raw&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7727.54,-2730.1C7843.81,-2725.43 8003.13,-2736.28 8119,-2811.31 8145.1,-2828.21 8132.57,-2849.77 8155,-2871.31 8273.73,-2985.31 8454.89,-3063.31 8549.16,-3098.7"/>
<polygon fill="black" stroke="black" points="8547.96,-3101.99 8558.55,-3102.2 8550.4,-3095.43 8547.96,-3101.99"/>
</g>
<!-- clean_data._clean_raw&#45;&gt;clean_data._parse_date -->
<g id="edge268" class="edge">
<title>clean_data._clean_raw&#45;&gt;clean_data._parse_date</title>
<path fill="none" stroke="black" d="M7727.59,-2740.71C7925.02,-2733.47 8266.77,-2720.93 8462.29,-2713.76"/>
<polygon fill="black" stroke="black" points="8462.49,-2717.26 8472.36,-2713.39 8462.24,-2710.26 8462.49,-2717.26"/>
</g>
<!-- clean_data._clean_media -->
<g id="node165" class="node">
<title>clean_data._clean_media</title>
<g id="a_node165"><a xlink:title="Remove unused media files older than ``cutoff``.">
<polygon fill="none" stroke="black" points="7764,-2450.31 7384,-2450.31 7384,-2410.31 7764,-2410.31 7764,-2450.31"/>
<text text-anchor="middle" x="7574" y="-2423.24" font-family="Times,serif" font-size="28.84">clean_data._clean_media</text>
</a>
</g>
</g>
<!-- clean_data._clean_media&#45;&gt;caption_io.has_caption -->
<g id="edge269" class="edge">
<title>clean_data._clean_media&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M7667.78,-2450.32C7790.14,-2470.67 8003.42,-2484.18 8119,-2363.31 8190.17,-2288.88 8081.67,-1973.6 8155,-1901.31 8256.55,-1801.2 8440.33,-1827.38 8540.78,-1851.86"/>
<polygon fill="black" stroke="black" points="8539.99,-1855.27 8550.54,-1854.29 8541.68,-1848.47 8539.99,-1855.27"/>
</g>
<!-- clean_data._clean_media&#45;&gt;clean_data._parse_date -->
<g id="edge270" class="edge">
<title>clean_data._clean_media&#45;&gt;clean_data._parse_date</title>
<path fill="none" stroke="black" d="M7764.16,-2444.98C7876.33,-2461.71 8016.2,-2497.38 8119,-2573.31 8143.4,-2591.33 8129.81,-2614.4 8155,-2631.31 8245.13,-2691.82 8367.26,-2709.89 8462.45,-2713.47"/>
<polygon fill="black" stroke="black" points="8462.34,-2716.97 8472.45,-2713.8 8462.57,-2709.98 8462.34,-2716.97"/>
</g>
<!-- clean_data._clean_lots -->
<g id="node166" class="node">
<title>clean_data._clean_lots</title>
<g id="a_node166"><a xlink:title="Drop lots missing translations or source posts.">
<polygon fill="none" stroke="black" points="7776,-3007.31 7372,-3007.31 7372,-2961.31 7776,-2961.31 7776,-3007.31"/>
<text text-anchor="middle" x="7574" y="-2975.87" font-family="Times,serif" font-size="34.30">clean_data._clean_lots</text>
</a>
</g>
</g>
<!-- clean_data._clean_lots&#45;&gt;post_io.raw_post_path -->
<g id="edge271" class="edge">
<title>clean_data._clean_lots&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7776.18,-2991.71C7879.05,-2997.09 8006.06,-3006.17 8119,-3021.31 8263.65,-3040.7 8429.63,-3077.09 8527.11,-3099.94"/>
<polygon fill="black" stroke="black" points="8526.37,-3103.37 8536.91,-3102.25 8527.98,-3096.55 8526.37,-3103.37"/>
</g>
<!-- clean_data._clean_lots&#45;&gt;lot_io.needs_cleanup -->
<g id="edge272" class="edge">
<title>clean_data._clean_lots&#45;&gt;lot_io.needs_cleanup</title>
<path fill="none" stroke="black" d="M7776.21,-2998.62C7910.69,-3003.38 8071.38,-2998.18 8119,-2951.31 8193.65,-2877.83 8081.02,-2555.46 8155,-2481.31 8203.3,-2432.9 8393.01,-2433.33 8511.99,-2438.8"/>
<polygon fill="black" stroke="black" points="8512.05,-2442.31 8522.21,-2439.29 8512.39,-2435.31 8512.05,-2442.31"/>
</g>
<!-- clean_data._clean_lots&#45;&gt;lot_io.read_lots -->
<g id="edge273" class="edge">
<title>clean_data._clean_lots&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M7776.07,-2974.56C7908.77,-2972.44 8067.35,-2979.52 8119,-3021.31 8164.28,-3057.94 8109.56,-3110.88 8155,-3147.31 8262.38,-3233.4 8433.72,-3215.18 8532.97,-3194.51"/>
<polygon fill="black" stroke="black" points="8533.88,-3197.89 8542.93,-3192.37 8532.42,-3191.04 8533.88,-3197.89"/>
</g>
<!-- clean_data._clean_embeddings -->
<g id="node167" class="node">
<title>clean_data._clean_embeddings</title>
<g id="a_node167"><a xlink:title="Delete embedding files when the matching lot JSON is absent.">
<polygon fill="none" stroke="black" points="7782,-2710.31 7366,-2710.31 7366,-2674.31 7782,-2674.31 7782,-2710.31"/>
<text text-anchor="middle" x="7574" y="-2686.15" font-family="Times,serif" font-size="25.20">clean_data._clean_embeddings</text>
</a>
</g>
</g>
<!-- clean_data._remove_empty_dirs -->
<g id="node168" class="node">
<title>clean_data._remove_empty_dirs</title>
<g id="a_node168"><a xlink:title="Recursively remove empty folders under ``root``.">
<polygon fill="none" stroke="black" points="8825.5,-2400.31 8398.5,-2400.31 8398.5,-2364.31 8825.5,-2364.31 8825.5,-2400.31"/>
<text text-anchor="middle" x="8612" y="-2376.15" font-family="Times,serif" font-size="25.20">clean_data._remove_empty_dirs</text>
</a>
</g>
</g>
<!-- clean_data.main -->
<g id="node169" class="node">
<title>clean_data.main</title>
<g id="a_node169"><a xlink:title="Clean up old or inconsistent files across data directories.">
<polygon fill="none" stroke="black" points="6566,-2710.31 6374,-2710.31 6374,-2674.31 6566,-2674.31 6566,-2710.31"/>
<text text-anchor="middle" x="6470" y="-2687.01" font-family="Times,serif" font-size="21.00">clean_data.main</text>
</a>
</g>
</g>
<!-- clean_data.main&#45;&gt;clean_data._clean_raw -->
<g id="edge274" class="edge">
<title>clean_data.main&#45;&gt;clean_data._clean_raw</title>
<path fill="none" stroke="black" d="M6566.39,-2696.98C6754.83,-2706.22 7176.72,-2726.89 7410.06,-2738.32"/>
<polygon fill="black" stroke="black" points="7410.18,-2741.83 7420.34,-2738.83 7410.52,-2734.84 7410.18,-2741.83"/>
</g>
<!-- clean_data.main&#45;&gt;clean_data._clean_media -->
<g id="edge275" class="edge">
<title>clean_data.main&#45;&gt;clean_data._clean_media</title>
<path fill="none" stroke="black" d="M6504.02,-2674.31C6588.43,-2629.31 6820.14,-2512.15 7029,-2464.31 7141.25,-2438.6 7269.72,-2429.65 7373.61,-2427.33"/>
<polygon fill="black" stroke="black" points="7373.98,-2430.83 7383.91,-2427.12 7373.84,-2423.83 7373.98,-2430.83"/>
</g>
<!-- clean_data.main&#45;&gt;clean_data._clean_lots -->
<g id="edge276" class="edge">
<title>clean_data.main&#45;&gt;clean_data._clean_lots</title>
<path fill="none" stroke="black" d="M6561.58,-2710.31C6672.91,-2736.12 6863.01,-2792.51 6993,-2897.31 7015.46,-2915.41 7003.99,-2936.93 7029,-2951.31 7151.85,-3021.92 7317.14,-3021.21 7433.17,-3008.46"/>
<polygon fill="black" stroke="black" points="7433.65,-3011.93 7443.18,-3007.32 7432.85,-3004.97 7433.65,-3011.93"/>
</g>
<!-- clean_data.main&#45;&gt;clean_data._clean_embeddings -->
<g id="edge277" class="edge">
<title>clean_data.main&#45;&gt;clean_data._clean_embeddings</title>
<path fill="none" stroke="black" d="M6566.39,-2692.31C6740.94,-2692.31 7115.8,-2692.31 7355.56,-2692.31"/>
<polygon fill="black" stroke="black" points="7355.81,-2695.81 7365.81,-2692.31 7355.81,-2688.81 7355.81,-2695.81"/>
</g>
<!-- clean_data.main&#45;&gt;clean_data._remove_empty_dirs -->
<g id="edge278" class="edge">
<title>clean_data.main&#45;&gt;clean_data._remove_empty_dirs</title>
<path fill="none" stroke="black" d="M6495.14,-2674.29C6569.67,-2619.91 6804.63,-2457.73 7029,-2401.31 7156.92,-2369.14 7983.49,-2374.55 8388.29,-2379.25"/>
<polygon fill="black" stroke="black" points="8388.33,-2382.75 8398.37,-2379.37 8388.41,-2375.76 8388.33,-2382.75"/>
</g>
<!-- chop.has_misc_deal -->
<g id="node170" class="node">
<title>chop.has_misc_deal</title>
<g id="a_node170"><a xlink:title="Return True when any lot is classified as misc or announcement.">
<polygon fill="none" stroke="black" points="9548.5,-910.31 9320.5,-910.31 9320.5,-874.31 9548.5,-874.31 9548.5,-910.31"/>
<text text-anchor="middle" x="9434.5" y="-887.01" font-family="Times,serif" font-size="21.00">chop.has_misc_deal</text>
</a>
</g>
</g>
<!-- chop.process_message -->
<g id="node171" class="node">
<title>chop.process_message</title>
<g id="a_node171"><a xlink:title="Extract lots from ``msg_path`` and save them under ``LOTS_DIR``.">
<polygon fill="none" stroke="black" points="6971,-2000.31 5969,-2000.31 5969,-1898.31 6971,-1898.31 6971,-2000.31"/>
<text text-anchor="middle" x="6470" y="-1927.99" font-family="Times,serif" font-size="85.40">chop.process_message</text>
</a>
</g>
</g>
<!-- chop.process_message&#45;&gt;post_io.read_post -->
<g id="edge279" class="edge">
<title>chop.process_message&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M6883.9,-1898.21C6923.71,-1881.09 6961.08,-1858.93 6993,-1830.31 7029.42,-1797.66 6989.55,-1755.22 7029,-1726.31 7054.69,-1707.48 7873.45,-1693.37 8322.71,-1687.02"/>
<polygon fill="black" stroke="black" points="8322.97,-1690.51 8332.92,-1686.87 8322.87,-1683.51 8322.97,-1690.51"/>
</g>
<!-- chop.process_message&#45;&gt;caption_io.has_caption -->
<g id="edge280" class="edge">
<title>chop.process_message&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M6971.05,-1931.32C7491.82,-1912.58 8266.97,-1884.69 8524.41,-1875.42"/>
<polygon fill="black" stroke="black" points="8524.59,-1878.92 8534.45,-1875.06 8524.33,-1871.92 8524.59,-1878.92"/>
</g>
<!-- chop.process_message&#45;&gt;caption_io.read_caption -->
<g id="edge281" class="edge">
<title>chop.process_message&#45;&gt;caption_io.read_caption</title>
<path fill="none" stroke="black" d="M6971.05,-1944.63C7441.64,-1940.24 8119.94,-1933.9 8436.26,-1930.94"/>
<polygon fill="black" stroke="black" points="8436.47,-1934.44 8446.43,-1930.85 8436.4,-1927.44 8436.47,-1934.44"/>
</g>
<!-- chop.process_message&#45;&gt;message_utils.build_prompt -->
<g id="edge282" class="edge">
<title>chop.process_message&#45;&gt;message_utils.build_prompt</title>
<path fill="none" stroke="black" d="M6909.02,-1898.27C6949.56,-1894.27 6990.02,-1890.53 7029,-1887.31 7549.15,-1844.31 8167.36,-1817.8 8452.49,-1806.97"/>
<polygon fill="black" stroke="black" points="8452.64,-1810.46 8462.5,-1806.59 8452.37,-1803.47 8452.64,-1810.46"/>
</g>
<!-- chop.process_message&#45;&gt;lot_io.valid_lots -->
<g id="edge283" class="edge">
<title>chop.process_message&#45;&gt;lot_io.valid_lots</title>
<path fill="none" stroke="black" d="M6763.52,-2000.32C6848.88,-2013.74 6942.48,-2027.04 7029,-2036.31 7178.38,-2052.31 7351.75,-2060.77 7461.87,-2064.89"/>
<polygon fill="black" stroke="black" points="7461.88,-2068.39 7472,-2065.27 7462.13,-2061.4 7461.88,-2068.39"/>
</g>
<!-- chop.process_message&#45;&gt;lot_io.needs_cleanup -->
<g id="edge284" class="edge">
<title>chop.process_message&#45;&gt;lot_io.needs_cleanup</title>
<path fill="none" stroke="black" d="M6971.04,-1978.04C6990.61,-1979.15 7009.99,-1980.24 7029,-1981.31 7089.55,-1984.71 8075.21,-1999.35 8119,-2041.31 8178.32,-2098.16 8096.36,-2351.75 8155,-2409.31 8203.81,-2457.21 8393.34,-2456.95 8512.15,-2451.65"/>
<polygon fill="black" stroke="black" points="8512.53,-2455.14 8522.36,-2451.18 8512.2,-2448.15 8512.53,-2455.14"/>
</g>
<!-- chop.process_message&#45;&gt;token_utils.estimate_tokens -->
<g id="edge285" class="edge">
<title>chop.process_message&#45;&gt;token_utils.estimate_tokens</title>
<path fill="none" stroke="black" d="M6971.05,-1957.49C7466.81,-1965.59 8193.09,-1977.47 8483.82,-1982.23"/>
<polygon fill="black" stroke="black" points="8483.92,-1985.73 8493.98,-1982.39 8484.04,-1978.73 8483.92,-1985.73"/>
</g>
<!-- chop.process_message&#45;&gt;embed.embed_file -->
<g id="edge286" class="edge">
<title>chop.process_message&#45;&gt;embed.embed_file</title>
<path fill="none" stroke="black" d="M6793.87,-2000.36C6871.12,-2028.36 6945.03,-2071.6 6993,-2138.31 7042.9,-2207.7 6969.92,-3614.54 7029,-3676.31 7073.8,-3723.15 7226.32,-3730.46 7358.5,-3727.14"/>
<polygon fill="black" stroke="black" points="7358.89,-3730.63 7368.79,-3726.86 7358.69,-3723.63 7358.89,-3730.63"/>
</g>
<!-- chop.process_message&#45;&gt;moderation.should_skip_message -->
<g id="edge287" class="edge">
<title>chop.process_message&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M6908.91,-1898.28C6940.65,-1880.71 6969.4,-1858.43 6993,-1830.31 7044.77,-1768.61 6971.3,-1162.51 7029,-1106.31 7078.62,-1057.98 8032.1,-1062.84 8434.36,-1067.07"/>
<polygon fill="black" stroke="black" points="8434.6,-1070.58 8444.64,-1067.18 8434.68,-1063.58 8434.6,-1070.58"/>
</g>
<!-- chop.process_message&#45;&gt;chop.has_misc_deal -->
<g id="edge288" class="edge">
<title>chop.process_message&#45;&gt;chop.has_misc_deal</title>
<path fill="none" stroke="black" d="M6909.78,-1898.17C6941.23,-1880.6 6969.67,-1858.36 6993,-1830.31 7055.64,-1754.98 6959.13,-1017.99 7029,-949.31 7353.25,-630.57 8865.9,-812.88 9310.38,-874.42"/>
<polygon fill="black" stroke="black" points="9309.97,-877.9 9320.36,-875.81 9310.94,-870.97 9309.97,-877.9"/>
</g>
<!-- chop.main -->
<g id="node172" class="node">
<title>chop.main</title>
<g id="a_node172"><a xlink:title="Process a single message file passed on the command line.">
<polygon fill="none" stroke="black" points="5669,-1967.31 5518,-1967.31 5518,-1931.31 5669,-1931.31 5669,-1967.31"/>
<text text-anchor="middle" x="5593.5" y="-1943.15" font-family="Times,serif" font-size="25.20">chop.main</text>
</a>
</g>
</g>
<!-- chop.main&#45;&gt;chop.process_message -->
<g id="edge289" class="edge">
<title>chop.main&#45;&gt;chop.process_message</title>
<path fill="none" stroke="black" d="M5669.06,-1949.31C5737.24,-1949.31 5844.6,-1949.31 5958.79,-1949.31"/>
<polygon fill="black" stroke="black" points="5958.79,-1952.81 5968.79,-1949.31 5958.79,-1945.81 5958.79,-1952.81"/>
</g>
<!-- similar._iter_lots -->
<g id="node173" class="node">
<title>similar._iter_lots</title>
<g id="a_node173"><a xlink:title="Return lots filtered by moderation rules.">
<polygon fill="none" stroke="black" points="7728,-2942.81 7420,-2942.81 7420,-2895.81 7728,-2895.81 7728,-2942.81"/>
<text text-anchor="middle" x="7574" y="-2910.81" font-family="Times,serif" font-size="35.00">similar._iter_lots</text>
</a>
</g>
</g>
<!-- similar._iter_lots&#45;&gt;post_io.read_post -->
<g id="edge290" class="edge">
<title>similar._iter_lots&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7728.21,-2931.95C7870.03,-2939.91 8066.65,-2940.16 8119,-2886.31 8205.17,-2797.67 8075.07,-1868.61 8155,-1774.31 8197.39,-1724.3 8258.77,-1696.86 8322.83,-1682.7"/>
<polygon fill="black" stroke="black" points="8323.64,-1686.11 8332.71,-1680.63 8322.2,-1679.26 8323.64,-1686.11"/>
</g>
<!-- similar._iter_lots&#45;&gt;post_io.raw_post_path -->
<g id="edge291" class="edge">
<title>similar._iter_lots&#45;&gt;post_io.raw_post_path</title>
<path fill="none" stroke="black" d="M7728.22,-2917.69C7837.99,-2919.17 7988.81,-2926.62 8119,-2952.31 8285.65,-2985.19 8473.17,-3060.52 8560.81,-3098.12"/>
<polygon fill="black" stroke="black" points="8559.67,-3101.44 8570.24,-3102.18 8562.44,-3095.01 8559.67,-3101.44"/>
</g>
<!-- similar._iter_lots&#45;&gt;lot_io.read_lots -->
<g id="edge292" class="edge">
<title>similar._iter_lots&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M7728.18,-2908.35C7868.61,-2901.81 8062.98,-2902.73 8119,-2952.31 8185,-3010.71 8088.96,-3088.95 8155,-3147.31 8260.29,-3240.34 8438.24,-3217.54 8537.86,-3194.67"/>
<polygon fill="black" stroke="black" points="8538.91,-3198.02 8547.84,-3192.32 8537.3,-3191.21 8538.91,-3198.02"/>
</g>
<!-- similar._iter_lots&#45;&gt;lot_io.iter_lot_files -->
<g id="edge293" class="edge">
<title>similar._iter_lots&#45;&gt;lot_io.iter_lot_files</title>
<path fill="none" stroke="black" d="M7728.11,-2906.76C7869.86,-2898.88 8066.42,-2898.68 8119,-2952.31 8187.44,-3022.1 8098.37,-3751.63 8155,-3831.31 8227.6,-3933.46 8367.55,-3977.65 8473.35,-3996.76"/>
<polygon fill="black" stroke="black" points="8473.03,-4000.26 8483.48,-3998.53 8474.23,-3993.36 8473.03,-4000.26"/>
</g>
<!-- similar._iter_lots&#45;&gt;moderation.should_skip_message -->
<g id="edge294" class="edge">
<title>similar._iter_lots&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M7728.31,-2932.05C7870.21,-2940.08 8066.88,-2940.38 8119,-2886.31 8177.43,-2825.69 8114.28,-1445 8155,-1371.31 8239.83,-1217.78 8439.68,-1128.57 8544.38,-1090.8"/>
<polygon fill="black" stroke="black" points="8545.65,-1094.06 8553.9,-1087.41 8543.31,-1087.46 8545.65,-1094.06"/>
</g>
<!-- similar._iter_lots&#45;&gt;moderation.should_skip_lot -->
<g id="edge295" class="edge">
<title>similar._iter_lots&#45;&gt;moderation.should_skip_lot</title>
<path fill="none" stroke="black" d="M7728.07,-2911.03C7837.11,-2904.89 7987.12,-2895.94 8119,-2886.31 8234.81,-2877.85 8365.82,-2866.59 8463.51,-2857.85"/>
<polygon fill="black" stroke="black" points="8464.1,-2861.31 8473.75,-2856.93 8463.48,-2854.34 8464.1,-2861.31"/>
</g>
<!-- similar.main -->
<g id="node174" class="node">
<title>similar.main</title>
<g id="a_node174"><a xlink:title="Update ``data/similar`` using available embeddings.">
<polygon fill="none" stroke="black" points="6575,-5282.31 6365,-5282.31 6365,-5240.31 6575,-5240.31 6575,-5282.31"/>
<text text-anchor="middle" x="6470" y="-5253.22" font-family="Times,serif" font-size="31.36">similar.main</text>
</a>
</g>
</g>
<!-- similar.main&#45;&gt;similar_utils._load_embeddings -->
<g id="edge296" class="edge">
<title>similar.main&#45;&gt;similar_utils._load_embeddings</title>
<path fill="none" stroke="black" d="M6575.2,-5274.67C6897.86,-5313.78 7873.53,-5414.31 8119,-5234.31 8159.8,-5204.39 8123.29,-5165.73 8155,-5126.31 8257.98,-4998.27 8438.63,-4916.66 8538.86,-4878.91"/>
<polygon fill="black" stroke="black" points="8540.16,-4882.16 8548.3,-4875.39 8537.71,-4875.6 8540.16,-4882.16"/>
</g>
<!-- similar.main&#45;&gt;similar_utils._load_similar -->
<g id="edge297" class="edge">
<title>similar.main&#45;&gt;similar_utils._load_similar</title>
<path fill="none" stroke="black" d="M6575.12,-5274.5C6695.58,-5283.26 6890.47,-5276.18 6993,-5158.31 7087.07,-5050.16 6931.46,-4619.34 7029,-4514.31 7131.31,-4404.14 7314.28,-4402.84 7439.54,-4418.03"/>
<polygon fill="black" stroke="black" points="7439.23,-4421.52 7449.59,-4419.3 7440.1,-4414.58 7439.23,-4421.52"/>
</g>
<!-- similar.main&#45;&gt;similar_utils._save_similar -->
<g id="edge298" class="edge">
<title>similar.main&#45;&gt;similar_utils._save_similar</title>
<path fill="none" stroke="black" d="M6575.17,-5256.2C6769.19,-5246.7 7186.91,-5226.23 7415.55,-5215.02"/>
<polygon fill="black" stroke="black" points="7415.8,-5218.52 7425.62,-5214.53 7415.46,-5211.52 7415.8,-5218.52"/>
</g>
<!-- similar.main&#45;&gt;similar_utils._save_more_user -->
<g id="edge299" class="edge">
<title>similar.main&#45;&gt;similar_utils._save_more_user</title>
<path fill="none" stroke="black" d="M6575.03,-5243.2C6686.83,-5224.45 6869.94,-5195.77 7029,-5180.31 7151.29,-5168.42 7289.58,-5161.65 7396.13,-5157.86"/>
<polygon fill="black" stroke="black" points="7396.47,-5161.35 7406.34,-5157.5 7396.22,-5154.35 7396.47,-5161.35"/>
</g>
<!-- similar.main&#45;&gt;similar_utils._prune_similar -->
<g id="edge300" class="edge">
<title>similar.main&#45;&gt;similar_utils._prune_similar</title>
<path fill="none" stroke="black" d="M6531.58,-5282.32C6633.04,-5316.46 6844.38,-5383.09 7029,-5412.31 7161.8,-5433.32 7314.9,-5439.32 7424.78,-5440.5"/>
<polygon fill="black" stroke="black" points="7424.91,-5444.01 7434.94,-5440.6 7424.98,-5437.01 7424.91,-5444.01"/>
</g>
<!-- similar.main&#45;&gt;similar_utils._calc_similar_nn -->
<g id="edge301" class="edge">
<title>similar.main&#45;&gt;similar_utils._calc_similar_nn</title>
<path fill="none" stroke="black" d="M6506.23,-5282.37C6591.96,-5332.24 6819.79,-5456.56 7029,-5499.31 7234.18,-5541.24 7756.29,-5531.79 8144.93,-5517.3"/>
<polygon fill="black" stroke="black" points="8145.09,-5520.8 8154.95,-5516.93 8144.83,-5513.8 8145.09,-5520.8"/>
</g>
<!-- similar.main&#45;&gt;similar_utils._sync_embeddings -->
<g id="edge302" class="edge">
<title>similar.main&#45;&gt;similar_utils._sync_embeddings</title>
<path fill="none" stroke="black" d="M6575.03,-5272.11C6693.1,-5278.15 6883.44,-5268.05 6993,-5158.31 7051.87,-5099.34 6966.1,-5028.97 7029,-4974.31 7073.44,-4935.69 7203.32,-4927.78 7325.02,-4929.83"/>
<polygon fill="black" stroke="black" points="7325.2,-4933.34 7335.27,-4930.03 7325.34,-4926.34 7325.2,-4933.34"/>
</g>
<!-- similar.main&#45;&gt;similar_utils._similar_by_user -->
<g id="edge303" class="edge">
<title>similar.main&#45;&gt;similar_utils._similar_by_user</title>
<path fill="none" stroke="black" d="M6512.62,-5282.43C6603.47,-5327.2 6827.56,-5430.48 7029,-5466.31 7148.24,-5487.52 8001.13,-5494.13 8119,-5466.31 8136.41,-5462.2 8137.62,-5452.55 8155,-5448.31 8326.21,-5406.55 8776.85,-5409.28 9094.44,-5417.38"/>
<polygon fill="black" stroke="black" points="9094.65,-5420.88 9104.74,-5417.64 9094.83,-5413.89 9094.65,-5420.88"/>
</g>
<!-- similar.main&#45;&gt;similar._iter_lots -->
<g id="edge304" class="edge">
<title>similar.main&#45;&gt;similar._iter_lots</title>
<path fill="none" stroke="black" d="M6575.13,-5275.13C6696.31,-5284.65 6892.6,-5278.45 6993,-5158.31 7071.6,-5064.26 6944.27,-3040.88 7029,-2952.31 7079.74,-2899.27 7268.79,-2898.4 7409.87,-2905.94"/>
<polygon fill="black" stroke="black" points="7409.76,-2909.44 7419.94,-2906.5 7410.15,-2902.45 7409.76,-2909.44"/>
</g>
<!-- pending_embed._needs_embedding -->
<g id="node175" class="node">
<title>pending_embed._needs_embedding</title>
<g id="a_node175"><a xlink:title="Return ``True`` when ``emb`` is missing or stale.&#10;&#10;The function also upgrades older vector files stored as a single object and&#10;removes corrupted or mismatched ones so ``embed.py`` always operates on&#10;clean data.">
<polygon fill="none" stroke="black" points="7983,-4362.81 7165,-4362.81 7165,-4305.81 7983,-4305.81 7983,-4362.81"/>
<text text-anchor="middle" x="7574" y="-4322.97" font-family="Times,serif" font-size="44.80">pending_embed._needs_embedding</text>
</a>
</g>
</g>
<!-- pending_embed._needs_embedding&#45;&gt;notes_utils.load_json -->
<g id="edge305" class="edge">
<title>pending_embed._needs_embedding&#45;&gt;notes_utils.load_json</title>
<path fill="none" stroke="black" d="M7983.15,-4345.93C8398.17,-4353.52 8991.13,-4351.08 9069,-4278.31 9124.67,-4226.28 9050.5,-3990.56 9105,-3937.31 9168.23,-3875.53 9274.77,-3878.48 9349.33,-3890.53"/>
<polygon fill="black" stroke="black" points="9349.18,-3894.06 9359.63,-3892.29 9350.36,-3887.16 9349.18,-3894.06"/>
</g>
<!-- pending_embed._needs_embedding&#45;&gt;notes_utils.write_json -->
<g id="edge306" class="edge">
<title>pending_embed._needs_embedding&#45;&gt;notes_utils.write_json</title>
<path fill="none" stroke="black" d="M7983.27,-4336.36C8033.29,-4351.71 8080.31,-4375.25 8119,-4410.31 8169.48,-4456.06 8105.97,-4512.01 8155,-4559.31 8248.55,-4649.57 8404.63,-4663.11 8507.69,-4660.71"/>
<polygon fill="black" stroke="black" points="8507.91,-4664.21 8517.8,-4660.42 8507.71,-4657.21 8507.91,-4664.21"/>
</g>
<!-- pending_embed.main -->
<g id="node176" class="node">
<title>pending_embed.main</title>
<polygon fill="none" stroke="black" points="6732,-2966.31 6208,-2966.31 6208,-2906.31 6732,-2906.31 6732,-2966.31"/>
<text text-anchor="middle" x="6470" y="-2924.79" font-family="Times,serif" font-size="46.90">pending_embed.main</text>
</g>
<!-- pending_embed.main&#45;&gt;post_io.read_post -->
<g id="edge307" class="edge">
<title>pending_embed.main&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M6673.97,-2906.26C6787.5,-2878.1 6920.42,-2823.79 6993,-2719.31 7053.9,-2631.64 6953.39,-1834.65 7029,-1759.31 7071.92,-1716.54 8058.51,-1725.73 8119,-1722.31 8184.91,-1718.58 8255.71,-1713.56 8322.49,-1708.37"/>
<polygon fill="black" stroke="black" points="8323.04,-1711.84 8332.74,-1707.57 8322.5,-1704.86 8323.04,-1711.84"/>
</g>
<!-- pending_embed.main&#45;&gt;post_io.raw_post_path_from_lot -->
<g id="edge308" class="edge">
<title>pending_embed.main&#45;&gt;post_io.raw_post_path_from_lot</title>
<path fill="none" stroke="black" d="M6593.72,-2966.36C6706.23,-2992.66 6877.81,-3029.65 7029,-3049.31 7159.78,-3066.31 7309.43,-3074.28 7418.63,-3078.02"/>
<polygon fill="black" stroke="black" points="7418.63,-3081.52 7428.74,-3078.36 7418.86,-3074.53 7418.63,-3081.52"/>
</g>
<!-- pending_embed.main&#45;&gt;lot_io.read_lots -->
<g id="edge309" class="edge">
<title>pending_embed.main&#45;&gt;lot_io.read_lots</title>
<path fill="none" stroke="black" d="M6546.17,-2966.48C6651.93,-3007.28 6851.56,-3078.41 7029,-3108.31 7268,-3148.58 7876.89,-3135.2 8119,-3146.31 8248.11,-3152.23 8396.16,-3160.91 8495.84,-3167.04"/>
<polygon fill="black" stroke="black" points="8495.75,-3170.54 8505.94,-3167.66 8496.18,-3163.55 8495.75,-3170.54"/>
</g>
<!-- pending_embed.main&#45;&gt;lot_io.embedding_path -->
<g id="edge310" class="edge">
<title>pending_embed.main&#45;&gt;lot_io.embedding_path</title>
<path fill="none" stroke="black" d="M6650.46,-2906.27C6765.21,-2877.65 6907.97,-2822.83 6993,-2719.31 7044.51,-2656.6 6966.74,-2592.35 7029,-2540.31 7140.56,-2447.05 8149.69,-2486.16 8495.42,-2502.48"/>
<polygon fill="black" stroke="black" points="8495.3,-2505.98 8505.45,-2502.96 8495.63,-2498.99 8495.3,-2505.98"/>
</g>
<!-- pending_embed.main&#45;&gt;lot_io.iter_lot_files -->
<g id="edge311" class="edge">
<title>pending_embed.main&#45;&gt;lot_io.iter_lot_files</title>
<path fill="none" stroke="black" d="M6601.44,-2966.38C6725.49,-3002.52 6905.71,-3076.35 6993,-3214.31 7038.68,-3286.5 6967.74,-3922.77 7029,-3982.31 7080.35,-4032.21 8097.8,-4020.06 8473.32,-4013.83"/>
<polygon fill="black" stroke="black" points="8473.49,-4017.33 8483.43,-4013.67 8473.37,-4010.33 8473.49,-4017.33"/>
</g>
<!-- pending_embed.main&#45;&gt;moderation.message_skip_reason -->
<g id="edge312" class="edge">
<title>pending_embed.main&#45;&gt;moderation.message_skip_reason</title>
<path fill="none" stroke="black" d="M6676.18,-2906.24C6789.55,-2878.1 6921.53,-2823.81 6993,-2719.31 7042.56,-2646.83 6966.86,-1201.34 7029,-1139.31 7069.11,-1099.26 9013.45,-1107.56 9069,-1096.31 9185.9,-1072.63 9313.45,-1013.49 9382.36,-978.48"/>
<polygon fill="black" stroke="black" points="9383.98,-981.59 9391.28,-973.92 9380.79,-975.36 9383.98,-981.59"/>
</g>
<!-- pending_embed.main&#45;&gt;moderation.lot_skip_reason -->
<g id="edge313" class="edge">
<title>pending_embed.main&#45;&gt;moderation.lot_skip_reason</title>
<path fill="none" stroke="black" d="M6573.21,-2906.28C6684.24,-2875.34 6867.42,-2829.18 7029,-2811.31 7479.59,-2761.46 8615.84,-2804.69 9069,-2817.31 9127.1,-2818.93 9190.37,-2821.7 9247.65,-2824.58"/>
<polygon fill="black" stroke="black" points="9247.73,-2828.09 9257.89,-2825.11 9248.09,-2821.1 9247.73,-2828.09"/>
</g>
<!-- pending_embed.main&#45;&gt;pending_embed._needs_embedding -->
<g id="edge314" class="edge">
<title>pending_embed.main&#45;&gt;pending_embed._needs_embedding</title>
<path fill="none" stroke="black" d="M6602.73,-2966.38C6727.05,-3002.42 6906.85,-3076.09 6993,-3214.31 7056.63,-3316.39 6945.51,-4209.71 7029,-4296.31 7050.7,-4318.82 7097.42,-4332.24 7154.81,-4339.77"/>
<polygon fill="black" stroke="black" points="7154.51,-4343.26 7164.87,-4341.02 7155.38,-4336.31 7154.51,-4343.26"/>
</g>
<!-- check_translations.parse_po -->
<g id="node177" class="node">
<title>check_translations.parse_po</title>
<polygon fill="none" stroke="black" points="1667.5,-5780.31 1083.5,-5780.31 1083.5,-5728.31 1667.5,-5728.31 1667.5,-5780.31"/>
<text text-anchor="middle" x="1375.5" y="-5744.61" font-family="Times,serif" font-size="39.62">check_translations.parse_po</text>
</g>
<!-- check_translations.check_translations -->
<g id="node178" class="node">
<title>check_translations.check_translations</title>
<polygon fill="none" stroke="black" points="983,-5776.81 318,-5776.81 318,-5731.81 983,-5731.81 983,-5776.81"/>
<text text-anchor="middle" x="650.5" y="-5745.93" font-family="Times,serif" font-size="33.60">check_translations.check_translations</text>
</g>
<!-- check_translations.check_translations&#45;&gt;check_translations.parse_po -->
<g id="edge315" class="edge">
<title>check_translations.check_translations&#45;&gt;check_translations.parse_po</title>
<path fill="none" stroke="black" d="M983.11,-5754.31C1013.14,-5754.31 1043.45,-5754.31 1073.19,-5754.31"/>
<polygon fill="black" stroke="black" points="1073.26,-5757.81 1083.26,-5754.31 1073.26,-5750.81 1073.26,-5757.81"/>
</g>
<!-- pending_caption._get_message_path -->
<g id="node179" class="node">
<title>pending_caption._get_message_path</title>
<g id="a_node179"><a xlink:title="Return path of stored message ``msg_id`` in ``chat`` if any.">
<polygon fill="none" stroke="black" points="8762.5,-666.31 8461.5,-666.31 8461.5,-630.31 8762.5,-630.31 8762.5,-666.31"/>
<text text-anchor="middle" x="8612" y="-644.26" font-family="Times,serif" font-size="15.68">pending_caption._get_message_path</text>
</a>
</g>
</g>
<!-- pending_caption.main -->
<g id="node180" class="node">
<title>pending_caption.main</title>
<polygon fill="none" stroke="black" points="6704,-1067.31 6236,-1067.31 6236,-1015.31 6704,-1015.31 6704,-1067.31"/>
<text text-anchor="middle" x="6470" y="-1031.16" font-family="Times,serif" font-size="40.18">pending_caption.main</text>
</g>
<!-- pending_caption.main&#45;&gt;post_io.read_post -->
<g id="edge316" class="edge">
<title>pending_caption.main&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M6516.09,-1067.43C6608.6,-1119.43 6828.05,-1234.84 7029,-1280.31 7147.22,-1307.06 8030.16,-1241.85 8119,-1324.31 8221.31,-1419.27 8055.7,-1538.21 8155,-1636.31 8199.81,-1680.57 8260.49,-1701.96 8322.95,-1710.39"/>
<polygon fill="black" stroke="black" points="8322.64,-1713.88 8332.99,-1711.63 8323.5,-1706.93 8322.64,-1713.88"/>
</g>
<!-- pending_caption.main&#45;&gt;caption_io.has_caption -->
<g id="edge317" class="edge">
<title>pending_caption.main&#45;&gt;caption_io.has_caption</title>
<path fill="none" stroke="black" d="M6542.37,-1067.43C6654.44,-1112.01 6871.41,-1213.27 6993,-1368.31 7024.48,-1408.45 6988.18,-1446.7 7029,-1477.31 7125.96,-1550 8029.97,-1433.1 8119,-1515.31 8221.88,-1610.3 8055.08,-1730.2 8155,-1828.31 8205.53,-1877.92 8406.37,-1879.8 8523.99,-1876.35"/>
<polygon fill="black" stroke="black" points="8524.17,-1879.85 8534.05,-1876.04 8523.95,-1872.85 8524.17,-1879.85"/>
</g>
<!-- pending_caption.main&#45;&gt;image_io.read_image_meta -->
<g id="edge318" class="edge">
<title>pending_caption.main&#45;&gt;image_io.read_image_meta</title>
<path fill="none" stroke="black" d="M6704.03,-1040.25C6931.54,-1039.22 7269.01,-1037.69 7449.12,-1036.87"/>
<polygon fill="black" stroke="black" points="7449.18,-1040.37 7459.17,-1036.82 7449.15,-1033.37 7449.18,-1040.37"/>
</g>
<!-- pending_caption.main&#45;&gt;moderation.should_skip_message -->
<g id="edge319" class="edge">
<title>pending_caption.main&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M6640.31,-1067.32C6748.51,-1075.35 6887.75,-1069 6993,-1006.31 7018.74,-990.97 7002.76,-963.77 7029,-949.31 7135.07,-890.85 8017.6,-883.08 8119,-949.31 8152.32,-971.07 8122.61,-1008.18 8155,-1031.31 8257.82,-1104.73 8408.88,-1101.59 8508.55,-1088.68"/>
<polygon fill="black" stroke="black" points="8509.2,-1092.13 8518.64,-1087.32 8508.26,-1085.19 8509.2,-1092.13"/>
</g>
<!-- pending_caption.main&#45;&gt;pending_caption._get_message_path -->
<g id="edge320" class="edge">
<title>pending_caption.main&#45;&gt;pending_caption._get_message_path</title>
<path fill="none" stroke="black" d="M6566.43,-1067.33C6683.4,-1092.83 6879.94,-1113.96 6993,-1006.31 7093.13,-910.97 6927.17,-790.83 7029,-697.31 7131.94,-602.77 8070.4,-627.55 8451.37,-641.7"/>
<polygon fill="black" stroke="black" points="8451.25,-645.2 8461.38,-642.08 8451.51,-638.21 8451.25,-645.2"/>
</g>
<!-- pending_chop.main -->
<g id="node181" class="node">
<title>pending_chop.main</title>
<polygon fill="none" stroke="black" points="7737.5,-1000.31 7410.5,-1000.31 7410.5,-958.31 7737.5,-958.31 7737.5,-1000.31"/>
<text text-anchor="middle" x="7574" y="-971.22" font-family="Times,serif" font-size="31.36">pending_chop.main</text>
</g>
<!-- pending_chop.main&#45;&gt;post_io.read_post -->
<g id="edge321" class="edge">
<title>pending_chop.main&#45;&gt;post_io.read_post</title>
<path fill="none" stroke="black" d="M7737.64,-965.47C7878.32,-957.46 8067.06,-957.49 8119,-1009.31 8217.8,-1107.88 8058.58,-1535.41 8155,-1636.31 8198.91,-1682.25 8259.79,-1704.11 8322.79,-1712.43"/>
<polygon fill="black" stroke="black" points="8322.57,-1715.93 8332.91,-1713.65 8323.41,-1708.98 8322.57,-1715.93"/>
</g>
<!-- pending_chop.main&#45;&gt;moderation.should_skip_message -->
<g id="edge322" class="edge">
<title>pending_chop.main&#45;&gt;moderation.should_skip_message</title>
<path fill="none" stroke="black" d="M7737.55,-967.77C7847.64,-964.88 7995.05,-970.72 8119,-1009.31 8136.9,-1014.88 8137.18,-1025.48 8155,-1031.31 8244.34,-1060.5 8348.5,-1070.83 8434.7,-1073.49"/>
<polygon fill="black" stroke="black" points="8434.76,-1076.99 8444.86,-1073.77 8434.96,-1070 8434.76,-1076.99"/>
</g>
<!-- caption:cli -->
<g id="node183" class="node">
<title>caption:cli</title>
<g id="a_node183"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="2010.5" cy="-5691.31" rx="30.28" ry="18"/>
<text text-anchor="middle" x="2010.5" y="-5689.71" font-family="Times,serif" font-size="7.00">caption:cli</text>
</a>
</g>
</g>
<!-- telegram_bot:cli&#45;&gt;caption:cli -->
<!-- embed:cli -->
<g id="node184" class="node">
<title>embed:cli</title>
<g id="a_node184"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="2655.5" cy="-5691.31" rx="29.05" ry="18"/>
<text text-anchor="middle" x="2655.5" y="-5689.71" font-family="Times,serif" font-size="7.00">embed:cli</text>
</a>
</g>
</g>
<!-- caption:cli&#45;&gt;embed:cli -->
<!-- cluster_items:cli -->
<g id="node185" class="node">
<title>cluster_items:cli</title>
<g id="a_node185"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="3260.5" cy="-5691.31" rx="42.34" ry="18"/>
<text text-anchor="middle" x="3260.5" y="-5689.71" font-family="Times,serif" font-size="7.00">cluster_items:cli</text>
</a>
</g>
</g>
<!-- embed:cli&#45;&gt;cluster_items:cli -->
<!-- build_site:cli -->
<g id="node186" class="node">
<title>build_site:cli</title>
<g id="a_node186"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="4107" cy="-5691.31" rx="34.71" ry="18"/>
<text text-anchor="middle" x="4107" y="-5689.71" font-family="Times,serif" font-size="7.00">build_site:cli</text>
</a>
</g>
</g>
<!-- cluster_items:cli&#45;&gt;build_site:cli -->
<!-- tg_client:cli -->
<g id="node187" class="node">
<title>tg_client:cli</title>
<g id="a_node187"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="141" cy="-5816.31" rx="32.86" ry="18"/>
<text text-anchor="middle" x="141" y="-5814.71" font-family="Times,serif" font-size="7.00">tg_client:cli</text>
</a>
</g>
</g>
<!-- price_train:cli -->
<g id="node188" class="node">
<title>price_train:cli</title>
<g id="a_node188"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="650.5" cy="-5816.31" rx="36.68" ry="18"/>
<text text-anchor="middle" x="650.5" y="-5814.71" font-family="Times,serif" font-size="7.00">price_train:cli</text>
</a>
</g>
</g>
<!-- tg_client:cli&#45;&gt;price_train:cli -->
<!-- debug_dump:cli -->
<g id="node189" class="node">
<title>debug_dump:cli</title>
<g id="a_node189"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="1375.5" cy="-5816.31" rx="41.11" ry="18"/>
<text text-anchor="middle" x="1375.5" y="-5814.71" font-family="Times,serif" font-size="7.00">debug_dump:cli</text>
</a>
</g>
</g>
<!-- price_train:cli&#45;&gt;debug_dump:cli -->
<!-- moderation:cli -->
<g id="node190" class="node">
<title>moderation:cli</title>
<g id="a_node190"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="2010.5" cy="-5816.31" rx="38.53" ry="18"/>
<text text-anchor="middle" x="2010.5" y="-5814.71" font-family="Times,serif" font-size="7.00">moderation:cli</text>
</a>
</g>
</g>
<!-- debug_dump:cli&#45;&gt;moderation:cli -->
<!-- clean_data:cli -->
<g id="node191" class="node">
<title>clean_data:cli</title>
<g id="a_node191"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="2655.5" cy="-5816.31" rx="37.29" ry="18"/>
<text text-anchor="middle" x="2655.5" y="-5814.71" font-family="Times,serif" font-size="7.00">clean_data:cli</text>
</a>
</g>
</g>
<!-- moderation:cli&#45;&gt;clean_data:cli -->
<!-- chop:cli -->
<g id="node192" class="node">
<title>chop:cli</title>
<g id="a_node192"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="3260.5" cy="-5816.31" rx="27" ry="18"/>
<text text-anchor="middle" x="3260.5" y="-5814.71" font-family="Times,serif" font-size="7.00">chop:cli</text>
</a>
</g>
</g>
<!-- clean_data:cli&#45;&gt;chop:cli -->
<!-- similar:cli -->
<g id="node193" class="node">
<title>similar:cli</title>
<g id="a_node193"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="4107" cy="-5816.31" rx="29.05" ry="18"/>
<text text-anchor="middle" x="4107" y="-5814.71" font-family="Times,serif" font-size="7.00">similar:cli</text>
</a>
</g>
</g>
<!-- chop:cli&#45;&gt;similar:cli -->
<!-- pending_embed:cli -->
<g id="node194" class="node">
<title>pending_embed:cli</title>
<g id="a_node194"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="141" cy="-5870.31" rx="47.39" ry="18"/>
<text text-anchor="middle" x="141" y="-5868.71" font-family="Times,serif" font-size="7.00">pending_embed:cli</text>
</a>
</g>
</g>
<!-- check_translations:cli -->
<g id="node195" class="node">
<title>check_translations:cli</title>
<g id="a_node195"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="650.5" cy="-5870.31" rx="53.05" ry="18"/>
<text text-anchor="middle" x="650.5" y="-5868.71" font-family="Times,serif" font-size="7.00">check_translations:cli</text>
</a>
</g>
</g>
<!-- pending_embed:cli&#45;&gt;check_translations:cli -->
<!-- pending_caption:cli -->
<g id="node196" class="node">
<title>pending_caption:cli</title>
<g id="a_node196"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="1375.5" cy="-5870.31" rx="48.62" ry="18"/>
<text text-anchor="middle" x="1375.5" y="-5868.71" font-family="Times,serif" font-size="7.00">pending_caption:cli</text>
</a>
</g>
</g>
<!-- check_translations:cli&#45;&gt;pending_caption:cli -->
<!-- pending_chop:cli -->
<g id="node197" class="node">
<title>pending_chop:cli</title>
<g id="a_node197"><a xlink:title="Command line entrypoint">
<ellipse fill="none" stroke="black" cx="2010.5" cy="-5870.31" rx="42.96" ry="18"/>
<text text-anchor="middle" x="2010.5" y="-5868.71" font-family="Times,serif" font-size="7.00">pending_chop:cli</text>
</a>
</g>
</g>
<!-- pending_caption:cli&#45;&gt;pending_chop:cli -->
<!-- build_site -->
<g id="node198" class="node">
<title>build_site</title>
<ellipse fill="none" stroke="black" cx="4107" cy="-571.31" rx="55.79" ry="18"/>
<text text-anchor="middle" x="4107" y="-567.61" font-family="Times,serif" font-size="14.00">build_site</text>
</g>
<!-- build_site&#45;&gt;build_site.main -->
<g id="edge337" class="edge">
<title>build_site:cli&#45;&gt;build_site.main</title>
<path fill="none" stroke="black" d="M4163.12,-571.31C4282.9,-571.31 4572.52,-571.31 4776.09,-571.31"/>
<polygon fill="black" stroke="black" points="4776.32,-574.81 4786.32,-571.31 4776.32,-567.81 4776.32,-574.81"/>
</g>
<!-- caption -->
<g id="node199" class="node">
<title>caption</title>
<ellipse fill="none" stroke="black" cx="4995.5" cy="-4728.31" rx="44.69" ry="18"/>
<text text-anchor="middle" x="4995.5" y="-4724.61" font-family="Times,serif" font-size="14.00">caption</text>
</g>
<!-- caption&#45;&gt;caption.main -->
<g id="edge338" class="edge">
<title>caption:cli&#45;&gt;caption.main</title>
<path fill="none" stroke="black" d="M5040.81,-4728.31C5135.4,-4728.31 5359.15,-4728.31 5490.81,-4728.31"/>
<polygon fill="black" stroke="black" points="5490.91,-4731.81 5500.91,-4728.31 5490.91,-4724.81 5490.91,-4731.81"/>
</g>
<!-- check_translations -->
<g id="node200" class="node">
<title>check_translations</title>
<ellipse fill="none" stroke="black" cx="141" cy="-5754.31" rx="96.68" ry="18"/>
<text text-anchor="middle" x="141" y="-5750.61" font-family="Times,serif" font-size="14.00">check_translations</text>
</g>
<!-- check_translations&#45;&gt;check_translations.check_translations -->
<g id="edge339" class="edge">
<title>check_translations:cli&#45;&gt;check_translations.check_translations</title>
<path fill="none" stroke="black" d="M238.05,-5754.31C259.3,-5754.31 282.99,-5754.31 307.97,-5754.31"/>
<polygon fill="black" stroke="black" points="307.99,-5757.81 317.99,-5754.31 307.99,-5750.81 307.99,-5757.81"/>
</g>
<!-- chop -->
<g id="node201" class="node">
<title>chop</title>
<ellipse fill="none" stroke="black" cx="4995.5" cy="-1949.31" rx="32.49" ry="18"/>
<text text-anchor="middle" x="4995.5" y="-1945.61" font-family="Times,serif" font-size="14.00">chop</text>
</g>
<!-- chop&#45;&gt;chop.main -->
<g id="edge340" class="edge">
<title>chop:cli&#45;&gt;chop.main</title>
<path fill="none" stroke="black" d="M5028.12,-1949.31C5117.31,-1949.31 5373.07,-1949.31 5507.54,-1949.31"/>
<polygon fill="black" stroke="black" points="5507.8,-1952.81 5517.8,-1949.31 5507.8,-1945.81 5507.8,-1952.81"/>
</g>
<!-- clean_data -->
<g id="node202" class="node">
<title>clean_data</title>
<ellipse fill="none" stroke="black" cx="5593.5" cy="-2692.31" rx="59.59" ry="18"/>
<text text-anchor="middle" x="5593.5" y="-2688.61" font-family="Times,serif" font-size="14.00">clean_data</text>
</g>
<!-- clean_data&#45;&gt;clean_data.main -->
<g id="edge341" class="edge">
<title>clean_data:cli&#45;&gt;clean_data.main</title>
<path fill="none" stroke="black" d="M5653.58,-2692.31C5799.48,-2692.31 6178.43,-2692.31 6363.79,-2692.31"/>
<polygon fill="black" stroke="black" points="6363.83,-2695.81 6373.83,-2692.31 6363.83,-2688.81 6363.83,-2695.81"/>
</g>
<!-- cluster_items -->
<g id="node203" class="node">
<title>cluster_items</title>
<ellipse fill="none" stroke="black" cx="4995.5" cy="-4793.31" rx="73.39" ry="18"/>
<text text-anchor="middle" x="4995.5" y="-4789.61" font-family="Times,serif" font-size="14.00">cluster_items</text>
</g>
<!-- cluster_items&#45;&gt;cluster_items.main -->
<g id="edge342" class="edge">
<title>cluster_items:cli&#45;&gt;cluster_items.main</title>
<path fill="none" stroke="black" d="M5068.99,-4793.31C5171.2,-4793.31 5358.66,-4793.31 5479.32,-4793.31"/>
<polygon fill="black" stroke="black" points="5479.34,-4796.81 5489.34,-4793.31 5479.34,-4789.81 5479.34,-4796.81"/>
</g>
<!-- debug_dump -->
<g id="node204" class="node">
<title>debug_dump</title>
<ellipse fill="none" stroke="black" cx="5593.5" cy="-4047.31" rx="70.39" ry="18"/>
<text text-anchor="middle" x="5593.5" y="-4043.61" font-family="Times,serif" font-size="14.00">debug_dump</text>
</g>
<!-- debug_dump&#45;&gt;debug_dump.main -->
<g id="edge343" class="edge">
<title>debug_dump:cli&#45;&gt;debug_dump.main</title>
<path fill="none" stroke="black" d="M5663.85,-4047.31C5782.92,-4047.31 6031.7,-4047.31 6221.4,-4047.31"/>
<polygon fill="black" stroke="black" points="6221.53,-4050.81 6231.53,-4047.31 6221.53,-4043.81 6221.53,-4050.81"/>
</g>
<!-- embed -->
<g id="node205" class="node">
<title>embed</title>
<ellipse fill="none" stroke="black" cx="5593.5" cy="-3713.31" rx="42.49" ry="18"/>
<text text-anchor="middle" x="5593.5" y="-3709.61" font-family="Times,serif" font-size="14.00">embed</text>
</g>
<!-- embed&#45;&gt;embed.main -->
<g id="edge344" class="edge">
<title>embed:cli&#45;&gt;embed.main</title>
<path fill="none" stroke="black" d="M5635.8,-3713.31C5767.69,-3713.31 6181.27,-3713.31 6371.5,-3713.31"/>
<polygon fill="black" stroke="black" points="6371.77,-3716.81 6381.77,-3713.31 6371.77,-3709.81 6371.77,-3716.81"/>
</g>
<!-- moderation -->
<g id="node206" class="node">
<title>moderation</title>
<ellipse fill="none" stroke="black" cx="6470" cy="-2165.31" rx="63.89" ry="18"/>
<text text-anchor="middle" x="6470" y="-2161.61" font-family="Times,serif" font-size="14.00">moderation</text>
</g>
<!-- moderation&#45;&gt;moderation.apply_to_history -->
<g id="edge345" class="edge">
<title>moderation:cli&#45;&gt;moderation.apply_to_history</title>
<path fill="none" stroke="black" d="M6533.81,-2165.31C6680.16,-2165.31 7050.91,-2165.31 7307.52,-2165.31"/>
<polygon fill="black" stroke="black" points="7307.74,-2168.81 7317.74,-2165.31 7307.74,-2161.81 7307.74,-2168.81"/>
</g>
<!-- pending_caption -->
<g id="node207" class="node">
<title>pending_caption</title>
<ellipse fill="none" stroke="black" cx="5593.5" cy="-1041.31" rx="87.18" ry="18"/>
<text text-anchor="middle" x="5593.5" y="-1037.61" font-family="Times,serif" font-size="14.00">pending_caption</text>
</g>
<!-- pending_caption&#45;&gt;pending_caption.main -->
<g id="edge346" class="edge">
<title>pending_caption:cli&#45;&gt;pending_caption.main</title>
<path fill="none" stroke="black" d="M5680.74,-1041.31C5806.24,-1041.31 6044.02,-1041.31 6225.74,-1041.31"/>
<polygon fill="black" stroke="black" points="6225.98,-1044.81 6235.98,-1041.31 6225.98,-1037.81 6225.98,-1044.81"/>
</g>
<!-- pending_chop -->
<g id="node208" class="node">
<title>pending_chop</title>
<ellipse fill="none" stroke="black" cx="6470" cy="-979.31" rx="74.99" ry="18"/>
<text text-anchor="middle" x="6470" y="-975.61" font-family="Times,serif" font-size="14.00">pending_chop</text>
</g>
<!-- pending_chop&#45;&gt;pending_chop.main -->
<g id="edge347" class="edge">
<title>pending_chop:cli&#45;&gt;pending_chop.main</title>
<path fill="none" stroke="black" d="M6545.02,-979.31C6718.51,-979.31 7155.21,-979.31 7399.94,-979.31"/>
<polygon fill="black" stroke="black" points="7400,-982.81 7410,-979.31 7400,-975.81 7400,-982.81"/>
</g>
<!-- pending_embed -->
<g id="node209" class="node">
<title>pending_embed</title>
<ellipse fill="none" stroke="black" cx="5593.5" cy="-2936.31" rx="83.69" ry="18"/>
<text text-anchor="middle" x="5593.5" y="-2932.61" font-family="Times,serif" font-size="14.00">pending_embed</text>
</g>
<!-- pending_embed&#45;&gt;pending_embed.main -->
<g id="edge348" class="edge">
<title>pending_embed:cli&#45;&gt;pending_embed.main</title>
<path fill="none" stroke="black" d="M5677.56,-2936.31C5795.87,-2936.31 6018.43,-2936.31 6197.48,-2936.31"/>
<polygon fill="black" stroke="black" points="6197.58,-2939.81 6207.58,-2936.31 6197.58,-2932.81 6197.58,-2939.81"/>
</g>
<!-- price_train -->
<g id="node210" class="node">
<title>price_train</title>
<ellipse fill="none" stroke="black" cx="5593.5" cy="-4655.31" rx="61.19" ry="18"/>
<text text-anchor="middle" x="5593.5" y="-4651.61" font-family="Times,serif" font-size="14.00">price_train</text>
</g>
<!-- price_train&#45;&gt;price_train.main -->
<g id="edge349" class="edge">
<title>price_train:cli&#45;&gt;price_train.main</title>
<path fill="none" stroke="black" d="M5654.61,-4655.31C5796.39,-4655.31 6154.08,-4655.31 6344.78,-4655.31"/>
<polygon fill="black" stroke="black" points="6344.86,-4658.81 6354.86,-4655.31 6344.86,-4651.81 6344.86,-4658.81"/>
</g>
<!-- scan_ontology -->
<g id="node211" class="node">
<title>scan_ontology</title>
<ellipse fill="none" stroke="black" cx="4995.5" cy="-1786.31" rx="76.09" ry="18"/>
<text text-anchor="middle" x="4995.5" y="-1782.61" font-family="Times,serif" font-size="14.00">scan_ontology</text>
</g>
<!-- scan_ontology&#45;&gt;scan_ontology.main -->
<g id="edge350" class="edge">
<title>scan_ontology:cli&#45;&gt;scan_ontology.main</title>
<path fill="none" stroke="black" d="M5071.68,-1786.31C5143.08,-1786.31 5254.26,-1786.31 5355.6,-1786.31"/>
<polygon fill="black" stroke="black" points="5355.69,-1789.81 5365.69,-1786.31 5355.69,-1782.81 5355.69,-1789.81"/>
</g>
<!-- similar -->
<g id="node212" class="node">
<title>similar</title>
<ellipse fill="none" stroke="black" cx="5593.5" cy="-5315.31" rx="42.79" ry="18"/>
<text text-anchor="middle" x="5593.5" y="-5311.61" font-family="Times,serif" font-size="14.00">similar</text>
</g>
<!-- similar&#45;&gt;similar.main -->
<g id="edge351" class="edge">
<title>similar:cli&#45;&gt;similar.main</title>
<path fill="none" stroke="black" d="M5636.09,-5312.74C5764.54,-5304.81 6158.11,-5280.51 6354.73,-5268.36"/>
<polygon fill="black" stroke="black" points="6355.04,-5271.85 6364.8,-5267.74 6354.61,-5264.87 6355.04,-5271.85"/>
</g>
<!-- telegram_bot -->
<g id="node213" class="node">
<title>telegram_bot</title>
<ellipse fill="none" stroke="black" cx="4107" cy="-5039.31" rx="72.29" ry="18"/>
<text text-anchor="middle" x="4107" y="-5035.61" font-family="Times,serif" font-size="14.00">telegram_bot</text>
</g>
<!-- telegram_bot&#45;&gt;telegram_bot.send_alert -->
<g id="edge352" class="edge">
<title>telegram_bot:cli&#45;&gt;telegram_bot.send_alert</title>
<path fill="none" stroke="black" d="M4141.67,-5055.18C4277.88,-5119.41 4788.35,-5360.11 4947.09,-5434.95"/>
<polygon fill="black" stroke="black" points="4945.61,-5438.13 4956.15,-5439.23 4948.6,-5431.8 4945.61,-5438.13"/>
</g>
<!-- telegram_bot&#45;&gt;telegram_bot.main -->
<g id="edge353" class="edge">
<title>telegram_bot:cli&#45;&gt;telegram_bot.main</title>
<path fill="none" stroke="black" d="M4177.93,-5036C4315.17,-5029.49 4623.43,-5014.89 4819.48,-5005.6"/>
<polygon fill="black" stroke="black" points="4819.78,-5009.09 4829.6,-5005.12 4819.45,-5002.1 4819.78,-5009.09"/>
</g>
<!-- tg_client -->
<g id="node214" class="node">
<title>tg_client</title>
<ellipse fill="none" stroke="black" cx="141" cy="-1387.31" rx="50.89" ry="18"/>
<text text-anchor="middle" x="141" y="-1383.61" font-family="Times,serif" font-size="14.00">tg_client</text>
</g>
<!-- tg_client&#45;&gt;tg_client.main -->
<g id="edge354" class="edge">
<title>tg_client:cli&#45;&gt;tg_client.main</title>
<path fill="none" stroke="black" d="M192.05,-1387.31C232.34,-1387.31 292.58,-1387.31 356.22,-1387.31"/>
<polygon fill="black" stroke="black" points="356.46,-1390.81 366.46,-1387.31 356.46,-1383.81 356.46,-1390.81"/>
</g>
</g>
</svg>
